/** readObject is called to restore the state of this key from ... */defaultReadObject(...)/** Replace the DES key to be serialized. ... */new KeyRep(...)KeyRep.Type.SECRETKeyRep.Type/** Ensures that the bytes of this key are ... */finalize(...)/* Copyright (c) 1997, 2015, Oracle and/or its affiliates. All rights reserved. ... */// Return a copy of the key, rather than a reference,// so that the key data cannot be modified from outsideimport SecretKeyFactorySpiimport KeySpec/** This class implements the DES key factory of the Sun provider. ... *//** Generates a <code>SecretKey</code> object from the provided key ... */new DESKey(...)getKey(...)new InvalidKeySpecException(...)InvalidKeyException e/** Returns a specification (key material) of the given key ... */new DESKeySpec(...)/** Translates a <code>SecretKey</code> object, whose provider may be ... */DESKeySpec desKeySpecengineGetKeySpec(...)engineGenerateSecret(...)InvalidKeySpecException e// Check if requested key spec is amongst the valid ones// Check if key originates from this factory// Convert key to spec// Create key from spec, and return it/** This class generates a DES key. ... *//** Generates the DES key. ... */DESKey desKeyisWeak(...)/* Does parity adjustment, using bit in position 8 as the parity bit, ... */bitCount(...)// this is never thrown/** This class implements the parameter (IV) used with the DES algorithm in ... *//** This class implements the DESede algorithm (DES-EDE, tripleDES) in ... *//** Creates an instance of DESede cipher with default ECB mode and ... */new DESedeCrypt(...)/* Copyright (c) 1997, 2010, Oracle and/or its affiliates. All rights reserved. ... */// Return the effective key length/** This class implements the Triple DES algorithm (DES encryption, followed by ... */...[] key1;/* the expanded key used in encrypt/decrypt/encrypt phase */...[] key2;...[] key3;...[] buf1, ...;/* constructor */byte[] keybufkeys.lengthkeyEquals(...)// retrieve the first key// check if the third key is the same// retrieve the second keyimport DESedeKeySpec/** This class represents a DES-EDE key. ... *//** Creates a DES-EDE key from a given key. ... *//** Uses the first 24 bytes in <code>key</code>, beginning at ... */DESedeKeySpec.DES_EDE_KEY_LEN/** Replace the DESede key to be serialized. ... *//** This class implements the DES-EDE key factory of the Sun provider. ... */new DESedeKey(...)new DESedeKeySpec(...)DESedeKeySpec desEdeKeySpec/** This class generates a Triple DES key. ... *//** Generates the Triple DES key. ... */byte[] rawkeyDESedeKey desEdeKeybyte[] tmpkeytmpkey.length// 3 intermediate keys// Do parity adjustment for each intermediate key// 2 intermediate keys// Copy the first 8 bytes into the last// this never happens/** This class implements the parameter (IV) used with the Triple DES algorithm ... *//** This class implements the CMS DESede KeyWrap algorithm as defined ... */...[] IV2;int CHECKSUM_LEN;int IV_LEN;/* iv for (re-)initializing the internal cipher object. */Key cipherKey;/* key for re-initializing the internal cipher object. *//** Creates an instance of CMS DESede KeyWrap cipher with default ... *//** Sets the mode of this cipher. Only "CBC" mode is accepted for this ... *//** Returns the block size (in bytes), i.e. 8 bytes. ... */InvalidAlgorithmParameterException iapebyte[] currIvIvParameterSpec ivSpecDESedeParameters paramsEngnew DESedeParameters(...)engineGetParameterSpec(...)String algobyte[] cksgetChecksum(...)in.lengthbyte[] out2byte tempbyte[] buffer2buffer.lengthint keyValLenbuffer2.lengthMessageDigest mddigest(...)cks.length// CHECKSUM_LEN + IV_LEN;// reverse the array content// restore cipher state to prior to this call// reverse array contentimport java.lang.*import BigIntegerimport ProviderExceptionimport KeyAgreementSpiimport KeyUtil/** This class implements the Diffie-Hellman key agreement protocol between ... */BigInteger.ZEROboolean generateSecret;BigInteger init_p;BigInteger init_g;BigInteger x;BigInteger y;// the private value/** Initializes this key agreement with the given key and source of ... *//** Initializes this key agreement with the given key, set of ... */DHPrivateKey dhPrivKeyBigInteger priv_pgetP(...)getParams(...)BigInteger priv_ggetG(...)this.x/** Executes the next phase of this key agreement with the given ... */DHPublicKey dhPubKeyBigInteger pub_pBigInteger pub_gvalidate(...)this.ybyte[] intermediatenew DHPublicKey(...)new BigInteger(...)/** Generates the shared secret and returns it in a new buffer. ... */int expectedLenbitLength(...)ShortBufferException sbe/** Generates the shared secret, and places it into the buffer ... */BigInteger modulusbyte[] secretmodPow(...)sharedSecret.lengthsecret.length/** Creates the shared secret and returns it as a secret key object ... */int keysizeSecretKeySpec skeyBlowfishConstants.BLOWFISH_MAX_KEYSIZEint idxAESConstants.AES_KEYSIZES.lengthAESConstants.AES_KEYSIZEStrimZeroes(...)// never happens, because we did not pass any parameters// ignore "random" parameter, because our implementation does not// require any source of randomness// check if private key parameters are compatible with// initialized ones// store the x value// check if public key parameters are compatible with// validate the Diffie-Hellman public key// store the y value// we've received a public key (from one of the other parties),// so we are ready to create the secret, which may be an// intermediate secret, in which case we wrap it into a// Diffie-Hellman public key object and return it.// should never happen since length are identical// Reset the key agreement after checking for ShortBufferException// above, so user can recover w/o losing internal state/* NOTE: BigInteger.toByteArray() returns a byte array containing ... */// Array too short, pad it w/ leading 0s// Array too long, check and trim off the excess// ignore the leading sign byte// DES// Triple DES// Blowfish// AES// Generate the strongest key using the shared secret// assuming the key sizes in AESConstants class are// in ascending order// remove leading zero bytes per RFC 5246 Section 8.1.2import KeyFactorySpiimport DHPublicKeySpecimport DHPrivateKeySpecimport DHParameterSpec/** This class implements the Diffie-Hellman key factory of the Sun provider. ... *//** Generates a public key object from the provided key specification ... */DHPublicKeySpec dhPubKeySpec/** Generates a private key object from the provided key specification ... */DHPrivateKeySpec dhPrivKeySpecnew DHPrivateKey(...)/** Returns a specification (key material) of the given key object ... */DHParameterSpec paramsnew DHPublicKeySpec(...)new DHPrivateKeySpec(...)/** Translates a key object, whose provider may be unknown or potentially ... */engineGeneratePublic(...)engineGeneratePrivate(...)import DHGenParameterSpecimport ParameterCache/** This class represents the key pair generator for Diffie-Hellman key pairs. ... */DHParameterSpec params;// parameters to use or null if not specifiedint pSize;// The size in bits of the prime modulusint lSize;// The size in bits of the random exponent (private value)// The source of randomnessinitialize(...)/** Initializes this key pair generator for a certain keysize and source of ... */this.pSizethis.lSizethis.params/** Initializes this key pair generator for the specified parameter ... */getL(...)/** Generates a key pair. ... */BigInteger pBigInteger gBigInteger xBigInteger pMinus2subtract(...)BigInteger yDHPublicKey pubKeyDHPrivateKey privKeygetDHParameterSpec(...)GeneralSecurityException ecompareTo(...)BigInteger.ONEnew KeyPair(...)// exponent size is optional, could be 0// Require exponentSize < primeSize// use an exponent size of (pSize / 2) but at least 384 bits// PKCS#3 section 7.1 "Private-value generation"// Repeat if either of the followings does not hold://     0 < x < p-1//     2^(lSize-1) <= x < 2^(lSize)// generate random x up to 2^lSize bits long// calculate public value y/* This class generates parameters for the Diffie-Hellman algorithm. ... */int primeSize;int exponentSize;/** Initializes this parameter generator for a certain keysize ... */InvalidAlgorithmParameterException exthis.primeSize/** Initializes this parameter generator with a set of parameter ... */DHGenParameterSpec dhParamSpecgetPrimeSize(...)getExponentSize(...)/** Generates the parameters. ... */AlgorithmParameters algParamsthis.exponentSizeAlgorithmParameterGenerator paramGenDSAParameterSpec dsaParamSpecDHParameterSpec dhParamSpecgenerateParameters(...)new DHParameterSpec(...)InvalidParameterSpecException eNoSuchAlgorithmException e// Re-uses DSA parameters and thus have the same range// this should never happen// this should never happen, because we provide it/** This class implements the parameter set used by the ... */BigInteger p;// The prime (p).BigInteger g;// The base (g).int l;// The private-value length (l)this.pthis.gthis.lDerValue encodedParamsnew DerValue(...)encodedParams.tagDerValue.tag_SequenceencodedParams.datagetBigInteger(...)getInteger(...)DerOutputStream bytesputInteger(...)engineGetEncoded(...)StringBuffer strbuf// Private-value length is OPTIONAL/** A private key in PKCS#8 format for the Diffie-Hellman key agreement ... */BigInteger PKCS8_VERSION;// only supported version of PKCS#8 PrivateKeyInfo// the private key// the key bytes, without the algorithm information...[] encodedKey;// the encoded key// the prime modulus// the base generator// the private-value length (optional)...[] DH_data;/** Make a DH private key out of a private value <code>x</code>, a prime ... */DerValue.tag_Integerthis.encodedKeyIOException e/** Make a DH private key from its DER encoding (PKCS #8). ... */InputStream inStreamnew ByteArrayInputStream(...)DerValue valBigInteger parsedVersionval.dataDerValue algidgetDerValue(...)DerInputStream derInStreamtoDerInputStream(...)ObjectIdentifier oidgetOID(...)DerValue paramsval.tagalgid.tagparams.tagDerValue.tag_Nullparams.dataparseKeyBits(...)...|.../** Returns the encoding format of this key: "PKCS#8" *//** Returns the name of the algorithm associated with this key: "DH" *//** Get the encoding of the key. */DerOutputStream tmpDerOutputStream algidDerOutputStream paramsDerValue paramSequenceDerOutputStream derKeyputOID(...)new ObjectIdentifier(...)putDerValue(...)/** Returns the private value, <code>x</code>. ... *//** Returns the key parameters. ... */DerInputStream inDHPrivateKey otherDHParameterSpec otherParams/** Replace the DH private key to be serialized. ... */KeyRep.Type.PRIVATE// version// privateKeyAlgorithm// parse the parameters// privateKey// store OID// encode parameters// wrap parameters into SEQUENCE// store parameter SEQUENCE in algid// wrap algid into SEQUENCE// make it a SEQUENCE/** A public key in X.509 format for the Diffie-Hellman key agreement algorithm. ... */// the public key/** Make a DH public key out of a public value <code>y</code>, a prime ... *//** Make a DH public key from its DER encoding (X.509). ... */DerValue derKeyValderKeyVal.dataderKeyVal.taggetBitString(...)/** Returns the encoding format of this key: "X.509" */DerOutputStream tmpDerKeyputBitString(...)/** Returns the public value, <code>y</code>. ... */DHPublicKey other/** Replace the DH public key to be serialized. ... */KeyRep.Type.PUBLIC/* Parse the algorithm identifier *//* Parse the parameters *//* Parse the key */// store oid in algid// wrap algid into SEQUENCE, and store it in key encoding// store key data// wrap algid and key into SEQUENCE/** This class represents ciphers in electronic codebook (ECB) mode. ... */import AlgorithmId/** This class implements the <code>EncryptedPrivateKeyInfo</code> type, ... */AlgorithmId algid;// the "encryptionAlgorithm" field...[] encryptedData;// the "encryptedData" field...[] encoded;// the ASN.1 encoded contents of this class/** Constructs (i.e., parses) an <code>EncryptedPrivateKeyInfo</code> from ... */DerValue[] seqnew DerValue[]this.algid...[...].datathis.encryptedDatathis.encoded/** Constructs an <code>EncryptedPrivateKeyInfo</code> from the ... *//** Returns the encryption algorithm. *//** Returns the encrypted data. *//** Returns the ASN.1 encoding of this class. */// lazy generation of encoding// encode encryption algorithm// encode encrypted data// wrap everything into a SEQUENCE/** This class represents a block cipher in one of its modes. It wraps ... */SymmetricCipher embeddedCipher;// the embedded block cipher// the block size of the embedded block cipher// the initialization vectorthis.embeddedCiphergetBlockSize(...)/** Gets the block size of the embedded cipher. ... *//** Gets the initialization vector. ... *//** Performs encryption operation for the last time. ... *//** Performs decryption operation for the last time. ... *//** @return ... */// Currently only AEAD cipher impl, e.g. GCM, buffers data// internally during decryption modeimport GCMParameterSpec/** This class implements the parameter set used with ... */// the ivint tLen;// the tag length in bytesGCMParameterSpec gpsthis.tLenint tLen// need to convert from bits to bytes for ASN.1 encoding// check if IV or paramsimport static AESConstants.AES_BLOCK_SIZE/** This class represents the GCTR function defined in NIST 800-38D ... */SymmetricCipher aes;// these fields should not change after the object has been constructed...[] icb;// the current counter value// needed for save/restore calls// NOTE: cipher should already be initializedthis.aesinitialCounterBlk.lengththis.icbthis.counter// input must be multiples of 128-bit blocks when calling updatebyte[] encryptedCntrint numOfCompleteBlocksincrement32(...)// input can be arbitrary size when calling doFinalint lastBlockSizeint completeBlkLen/** Resets the content of this object to when it's first constructed. */icb.length/** Save the current content of this object. */this.counterSave/** Restores the content of this object to the previous saved one. *//* (C) Copyright IBM Corp. 2013 */// process the complete blocks first// do the last partial block/** This class represents the GHASH function defined in NIST 800-38D ... */long result--...// Multiplies state0, state1 by V0, V1.long Z0long Z1long Xlong masklong carrylong subkeyH0, ...;// hash subkey H; should not change after the object has been constructedlong state0, ...;// buffer for storing hashlong stateSave0, ...;subkeyH.lengththis.subkeyH0this.subkeyH1/** Resets the GHASH object to its original state, i.e. blank w/ ... *//** Save the current snapshot of this GHASH object. *//** Restores this object using the saved snapshot. */blockMult(...)processBlock(...)// Separate loops for processing state0 and state1.// Zi+1 = Zi if bit i of x is 0// Save mask for conditional reduction below.// V = rightshift(V)// Conditional reduction modulo P128.// Conditional reduction.// calculate Z128// Save result./** This class represents ciphers in GaloisCounter (GCM) mode. ... */new ByteArrayOutputStream(...)int DEFAULT_TAG_LEN;int DEFAULT_IV_LEN;int MAX_BUF_SIZE;// can only be returned by the doFinal(...) call.// java byte array, e.g. Integer.MAX_VALUE, since all data// we are bound by limiting the data size to the size limit of// text can only be returned after successful tag verification,// However, given the current GCM spec requirement that recovered// around and lead to a leak of plaintext.// than (2^36 - 32) bytes. Otherwise, the counter will wrap// In NIST SP 800-38D, GCM input size is limited to be no longer// in bytesByteArrayOutputStream aadBuffer;// buffer for AAD data; if null, meaning update has been calledint sizeOfAAD;ByteArrayOutputStream ibuffer;// buffer for storing input in decryption, not used for encryptionint tagLenBytes;// in bytes; need to convert to bits (default value 128) when needed...[] subkeyH;// called, e.g. after cipher key k is set, and STAY UNCHANGED// these following 2 fields can only be initialized after init() is...[] preCounterBlock;GCTR gctrPAndC;GHASH ghashAllToS;int processed;// length of total data, i.e. len(C)...[] aadBufferSave;// additional variables for save/restore callsint sizeOfAADSave;...[] ibufferSave;int processedSave;// value must be 16-byte long; used by GCTR and GHASH as welllong ivLenlong aLenlong cLenbyte[] paddedInbyte[] j0expandToOneBlock(...)GHASH gnew GHASH(...)int lastLenbyte[] lengthBlockgetLengthBlock(...)byte[] padded/** Resets the cipher object to its original state. ... */aadBufferSave.lengthibufferSave.lengthbyte[] j0Plus1this.subkeyHgetJ0(...)new GCTR(...)this.tagLenBytes// Feed the AAD data to GHASH, pad if necessaryaad.length// Utility to process the last block; used by encryptFinal and decryptFinalbyte[] ctint ctOfscheckDataLength(...)processAAD(...)byte[] sbyte[] sOuts.lengthGCTR gctrForSToTagthis.preCounterBlockdoLastBlock(...)byte[] tagint mismatchnew AEADBadTagException(...)// return tag length in bytes/* Copyright (c) 2013, 2016, Oracle and/or its affiliates. All rights reserved. ... */// start from last byte and only go over 4 bytes, i.e. total 32 bits// 96 bits// update has already been called// process data in 'in'// store internally until decryptFinal is called because// spec mentioned that only return recovered data after tag// is successfully verified// do this check here can also catch the potential integer overflow// scenario for the subsequent output buffer capacity check.// get the trailing tag bytes from 'in'// refresh 'in' to all buffered-up bytes// check entire authentication tag for time-consistencyimport MacSpi/** This class constitutes the core of HMAC-<MD> algorithms, where ... */MessageDigest md;...[] k_ipad;...[] k_opad;// inner padding - key XORd with ipadboolean first;// outer padding - key XORd with opadint blockLen;// Is this the first data to be processed?/** Standard constructor, creates a new HmacCore instance using the ... */this.mdthis.blockLenthis.k_ipadthis.k_opad/** Standard constructor, creates a new HmacCore instance instantiating ... *//** Returns the length of the HMAC in bytes. ... */getDigestLength(...)/** Initializes the HMAC with the given secret key and algorithm parameters. ... */int siengineReset(...)/** Processes the given byte. ... *//** Processes the first <code>len</code> bytes in <code>input</code>, ... *//** Processes the <code>input.remaining()</code> bytes in the ByteBuffer ... *//** Completes the HMAC computation and resets the HMAC for further use, ... */tmp.lengthDigestException e/** Resets the HMAC for further use, maintaining the secret key that the ... *//* Clones this object. */HmacCore copycopy.mdcopy.k_ipadcopy.k_opad// nested static class for the HmacSHA224 implementation// nested static class for the HmacSHA256 implementation// nested static class for the HmacSHA384 implementation// nested static class for the HmacSHA512 implementation/* Copyright (c) 2002, 2012, Oracle and/or its affiliates. All rights reserved. ... */// if key is longer than the block length, reset it using// the message digest object.// now erase the secret// XOR k with ipad and opad, respectively// compute digest for 1st pass; start with inner pad// add the passed byte to the inner digest// add the selected part of an array of bytes to the inner digest// finish the inner digest// compute digest for 2nd pass; start with outer pad// add result of 1st hash// should never occur/** This is an implementation of the HMAC-MD5 algorithm. ... *//** Standard constructor, creates a new HmacMD5 instance. *//* Copyright (c) 1998, 2012, Oracle and/or its affiliates. All rights reserved. ... *//** This class generates a secret key for use with the HMAC-MD5 algorithm. ... *//** Generates an HMAC-MD5 key. ... */import PBEParameterSpec/** This is an implementation of the HMAC-PBESHA1 algorithm as defined ... *//** Standard constructor, creates a new HmacSHA1 instance. */char[] passwdCharsbyte[] saltint iCountbyte[] derivedKeyderive(...)engineGetMacLength(...)PKCS12PBECipherCore.MAC_KEYSecretKey cipherKeyPBEKey pbeKeygetPassword(...)getSalt(...)getIterationCount(...)byte[] passwdBytesregionMatches(...)passwdBytes.lengthpasswdChars.lengthPBEParameterSpec pbeParamssalt.length// maybe null if unspecified// maybe 0 if unspecified// should not auto-generate default values since current// javax.crypto.Mac api does not have any method for caller to// retrieve the generated defaults.// make sure the parameter values are consistent// For security purpose, we need to enforce a minimum length// for salt; just require the minimum salt length to be 8-byte// which is what PKCS#5 recommends and openssl does./** This is an implementation of the HMAC-SHA1 algorithm. ... *//** This class generates a secret key for use with the HMAC-SHA1 algorithm. ... *//** Generates an HMAC-SHA1 key. ... *//** This class implements padding as specified in the W3 XML ENC standard. ... */this.blockSize/** Adds the given number of padding bytes to the data input. ... */byte paddingOctetbyte[] padding/** Returns the index where the padding starts. ... */byte lastByteint padValueint start/** Determines how long the padding will be for a given input length. ... */int paddingOctet// this can happen if input is really a padded bufferimport DigestInputStreamimport DigestOutputStreamimport KeyStoreSpiimport KeyStoreExceptionimport UnrecoverableKeyExceptionimport Certificateimport CertificateFactoryimport CertificateExceptionimport SealedObject/** This class provides the keystore implementation referred to as "jceks". ... */new Hashtable<String,Object>(...)int JCEKS_MAGIC;int JKS_MAGIC;int VERSION_1;int VERSION_2;// Private key and supporting certificate chainDate date;...[] protectedKey;// the creation date of this entry...[] chain;// Secret keySealedObject sealedKey;// Trusted certificateCertificate cert;Hashtable<String,Object> entries;/** Private keys and certificates are stored in a hashtable. ... *//** Returns the key associated with the given alias, using the given ... */Key keyObject entrytoLowerCase(...)KeyProtector keyProtectornew KeyProtector(...)byte[] encrBytes(...).protectedKeyEncryptedPrivateKeyInfo encrInfonew EncryptedPrivateKeyInfo(...)IOException ioenew UnrecoverableKeyException(...)recover(...)unseal(...)(...).sealedKey/** Returns the certificate chain associated with the given alias. ... */Certificate[] chain(...).chain/** Returns the certificate associated with the given alias. ... */Certificate cert(...).cert/** Returns the creation date of the entry identified by the given alias. ... */Date datenew Date(...)getTime(...)(...).date/** Assigns the given key to the given alias, protecting it with the given ... */PrivateKeyEntry entrynew PrivateKeyEntry(...)entry.dateentry.protectedKeyprotect(...)chain.lengthentry.chainSecretKeyEntry entrynew SecretKeyEntry(...)entry.sealedKeyseal(...)new KeyStoreException(...)/** Assigns the given key (that has already been protected) to the given ... *//** Assigns the given certificate to the given alias. ... */TrustedCertEntry trustedCertEntrynew TrustedCertEntry(...)trustedCertEntry.certtrustedCertEntry.date/** Deletes the entry identified by the given alias from this keystore. ... *//** Lists all the alias names of this keystore. ... */keys(...)/** Checks if the given alias exists in this keystore. ... *//** Retrieves the number of entries in this keystore. ... *//** Returns true if the entry identified by the given alias is a ... */boolean isKeyboolean isCert/** Returns the (alias) name of the first keystore entry whose certificate ... */Certificate certElemEnumeration<String> ehasMoreElements(...)String aliasnextElement(...)/** Stores this keystore to the given output stream, and protects its ... */getPreKeyedHash(...)DataOutputStream dosnew DataOutputStream(...)new DigestOutputStream(...)ObjectOutputStream oosbyte[] digestPrivateKeyEntry pentryint chainLenwriteUTF(...)writeLong(...)pentry.datepentry.protectedKey.lengthpentry.protectedKeypentry.chainpentry.chain.lengthnew ObjectOutputStream(...)writeObject(...)close(...)/** Loads the keystore from the given input stream. ... */DataInputStream disCertificateFactory cfHashtable<String,CertificateFactory> cfsByteArrayInputStream baisObjectInputStream oisnew DataInputStream(...)new DigestInputStream(...)int xMagicint xVersionnew Hashtable<String,CertificateFactory>(...)int tagint numOfCertsreadUTF(...)OutOfMemoryError ereadFully(...)new Certificate[]String certTypegenerateCertificate(...)TrustedCertEntry entryentry.certnew ObjectInputStream(...)readObject(...)ClassNotFoundException cnfebyte[] computedbyte[] actualcomputed.length/** To guard against tampering with the keystore, we append a keyed ... */password.lengthgetBytes(...)/* Copyright (c) 1998, 2014, Oracle and/or its affiliates. All rights reserved. ... */// We have to create a new instance of java.util.Date because// dates are not immutable// protect the private key// clone the chain// store the entry// seal and store the key// We assume it's a private key, because there is no standard// (ASN.1) encoding format for wrapped secret keys/* KEYSTORE FORMAT: ... */// password is mandatory when storing// the certificate encoding// NOTE: don't pass dos to oos at this point or it'll corrupt// the keystore!!!// always write the latest version// write PrivateKeyEntry tag// write the alias// write the (entry creation) date// write the protected private key// write the certificate chain// write TrustedCertEntry tag// write the trusted certificate// write SecretKeyEntry tag// write the sealed key// NOTE: don't close oos here since we are still// using dos!!!/* Write the keyed hash which is used to detect tampering with ... */// NOTE: don't pass dis to ois at this point or it'll fail to load// Body format: see store method// Accept the following keystore implementations:// - JCEKS (this implementation), versions 1 and 2// - JKS (Sun's keystore implementation in JDK 1.2),//   versions 1 and 2// version 2// private-key entry// read the alias// read the (entry creation) date// read the private key// read the certificate chain// read the certificate type, and instantiate a// certificate factory of that type (reuse// existing factory if possible)// reuse certificate factory// create new certificate factory// store the certificate factory so we can// reuse it later// instantiate the certificate// Add the entry to the list// trusted certificate entry// read the trusted certificate// secret-key entry// read the sealed key// NOTE: don't close ois here since we are still// using dis!!!/* If a password has been provided, we check the keyed digest ... *//** KeyGeneratore core implementation and individual key generator ... */// algorithm name to use for the generator keysint defaultKeySize;// default key size in bits// current key size in bits// PRNG to use/** Construct a new KeyGeneratorCore object with the specified name ... */this.defaultKeySizeimplInit(...)// reset keySize to default// implementation for engineInit(), see JCE doc// we do not support any parameters// we enforce a general 40 bit minimum key size for security// generate the keybyte[] b// nested static classes for the HmacSHA-2 family of key generatorKeyGeneratorCore core;new KeyGeneratorCore(...)implGenerateKey(...)// nested static class for the RC2 key generator// nested static class for the ARCFOUR (RC4) key generatorimport Serializableimport Securityimport Providerimport GeneralSecurityExceptionimport AlgorithmParametersimport ObjectIdentifier/** This class implements a protection mechanism for private keys. In JCE, we ... */String PBE_WITH_MD5_AND_DES3_CBC_OID;// defined by SunSoft (SKI project)String KEY_PROTECTOR_OID;// keys in the keystore implementation that comes with JDK 1.2)// JavaSoft proprietary key-protection algorithm (used to protect privateint SALT_LEN;int DIGEST_LEN;// the salt length...[] password;// key protector// the password used for protecting/recovering keys passed through thisthis.password/** Protects the given cleartext private key, using the password provided at ... */PBEParameterSpec pbeSpecnew PBEParameterSpec(...)PBEKeySpec pbeKeySpecnew PBEKeySpec(...)SecretKey sKeynew PBEKey(...)PBEWithMD5AndTripleDESCipher cipherbyte[] plainbyte[] encrKeyplain.lengthAlgorithmParameters pbeParamsAlgorithmId encrAlgnew AlgorithmId(...)clearPassword(...)new PBEWithMD5AndTripleDESCipher(...)/* Recovers the cleartext version of the given key (in protected format), ... */String encrAlgString oidNamenew PrivateKeyInfo(...)KeyFactory kFacgetEncryptedData(...)byte[] encodedParamsgetEncodedParams(...)getEncryptedData(...).lengthNoSuchAlgorithmException exint numRoundsint xorOffsetint encrKeyLenbyte[] xorKeyencrKey.lengthbyte[] plainKeyprotectedKey.lengthdigest.lengthxorKey.lengthplainKey.length/** Seals the given cleartext key, using the password provided at ... */Cipher cipherPBEWithMD5AndTripleDESCipher cipherSpinew CipherForKeyProtector(...)new SealedObjectForKeyProtector(...)/** Unseals the sealed key. */SecretKey skeySealedObjectForKeyProtector soForKeyProtectorgetObject(...)/** Creates a Cipher object. ... */// create a random salt (8 bytes)// create PBE parameters from salt and iteration count// create PBE key from password// encrypt private key// wrap encrypted private key in EncryptedPrivateKeyInfo// (as defined in PKCS#8)// JDK 1.2 style recovery// parse the PBE parameters into the corresponding spec// decrypt private key// determine the private-key algorithm, and parse private key// using the appropriate key factory// Note: this catch needed to be here because of the// later catch of GeneralSecurityException// offset in xorKey where next digest will be stored// the length of the encrpyted key// Get the salt associated with this key (the first SALT_LEN bytes of// <code>protectedKey</code>)// Determine the number of digest rounds// Get the encrypted key portion and store it in "encrKey"// Set up the byte array which will be XORed with "encrKey"// Convert password to byte array, so that it can be digested// Compute the digests, and store them in "xorKey"// Copy the digest into "xorKey"// XOR "encrKey" with "xorKey", and store the result in "plainKey"// Check the integrity of the recovered key by concatenating it with// the password, digesting the concatenation, and comparing the// result of the digest operation with the digest provided at the end// of <code>protectedKey</code>. If the two digest values are// different, throw an exception.// seal keyimport sun.security.x509.*import MGF1ParameterSpecimport PSourceimport OAEPParameterSpec/** This class implements the OAEP parameters used with the RSA ... */String mdName;MGF1ParameterSpec mgfSpec;ObjectIdentifier OID_MGF1;ObjectIdentifier OID_PSpecified;OAEPParameterSpec specString mgfNamegetMGFAlgorithm(...)AlgorithmParameterSpec mgfSpecgetMGFParameters(...)PSource pSrcgetPSource(...)getDigestAlgorithm(...)this.mgfSpecPSource.PSpecifiedDerValue[] datumgetSequence(...)MGF1ParameterSpec.SHA1datum.lengthDerValue dataisContextSpecific(...)data.dataAlgorithmId valAlgorithmId paramsString mgfDigestNameMGF1ParameterSpec.SHA224MGF1ParameterSpec.SHA256MGF1ParameterSpec.SHA384MGF1ParameterSpec.SHA512DerInputStream disnew OAEPParameterSpec(...)new PSpecified(...)DerOutputStream tmp2DerOutputStream tmp3AlgorithmId mdAlgIdAlgorithmId mgfDigestIdderEncode(...)createTag(...)DerValue.TAG_CONTEXTNoSuchAlgorithmException nasep.length// should not happen// hash algid// mgf algid// pSource algid// MD// MGF// PSource// Put all together under a SEQUENCE tag/** This class represents ciphers in output-feedback (OFB) mode. ... *//* register buffer */// OFB encrypt and decrypt are identical/** This class represents password-based encryption as defined by the PKCS #5 ... */CipherCore cipher;// the encapsulated DES cipherint blkSize;String algo;...[] salt;int iCount;/** Creates an instance of PBE Cipher using the specified CipherSpi ... *//** Sets the mode of this cipher. This algorithm can only be run in CBC ... *//** Sets the padding mechanism of this cipher. This algorithm only uses ... */deriveCipherKey(...)SecretKeySpec cipherKeyderivedKey.lengthbyte[] concatbyte[] toBeHashedbyte[] kBytesIvParameterSpec ivtoBeHashed.length// get instance of MD5// create random salt and use default iteration count// salt must be 8 bytes long (by definition)// use all but the last 8 bytes as the key value// use the last 8 bytes as the IV// initialize the underlying cipher// P || S (password concatenated with salt)// digest P || S with c iterations// this resets the digest// if the 2 salt halves are the same, invert one of them// same, invert 1st half// Now digest each half (concatenated with password). For each// half, go through the loop as many times as specified by the// iteration count parameter (inner for loop).// Concatenate the output from each digest round with the// password, and use the result as the input to the next digest// operation.import PBEKeySpec/** This class represents a PBE key. ... */String type;/** Creates a PBE key from a given PBE key specification. ... */char[] passwdpasswd.lengthSecretKey thatbyte[] thatEncoded/** Replace the PBE key to be serialized. ... *//** Ensures that the password bytes of this key are ... */// Should allow an empty password.// Accept "\0" to signify "zero-length password with no terminator"./** This class implements a key factory for PBE keys according to PKCS#5, ... */new HashSet<String>(...)HashSet<String> validTypes;/** Simple constructor *//* Private proprietary algorithm for supporting JCEKS. */contains(...)PBEKeySpec ret/* Copyright (c) 1997, 2014, Oracle and/or its affiliates. All rights reserved. ... */// Proprietary algorithm.// password char[] was cloned in PBEKeySpec constructor,// so we can zero it out here/** This class implements the parameter set used with password-based ... */// the salt// the iteration countAlgorithmParameterSpec cipherParam;// the cipher parameterthis.saltthis.iCountthis.cipherParamString saltStringint DEFAULT_SALT_LENGTH;int DEFAULT_COUNT;// the encapsulated cipherint keyLength;// in bitsPBKDF2Core kdf;String pbeAlgo;String cipherAlgo;IvParameterSpec ivSpec;/** Creates an instance of PBE Scheme 2 according to the selected ... */this.cipherAlgonew HmacSHA1(...)PBKDF2Core.HmacSHA1new HmacSHA224(...)PBKDF2Core.HmacSHA224new HmacSHA256(...)PBKDF2Core.HmacSHA256new HmacSHA384(...)PBKDF2Core.HmacSHA384new HmacSHA512(...)PBKDF2Core.HmacSHA512InvalidAlgorithmParameterException iePBEKeySpec pbeSpecSecretKey sbyte[] specSaltint specICountAlgorithmParameterSpec specParamsspecSalt.lengthAlgorithmParameterSpec pbeSpec/* Copyright (c) 2012, 2015, Oracle and/or its affiliates. All rights reserved. ... */// generate random salt and use default iteration count// generate random IV// TBD: consolidate the salt, ic and IV parameter checks below// Extract salt and iteration count from the key, if present// Extract salt, iteration count and IV from the params, if present// salt and iteration count from the params take precedence...[] pkcs5PBKDF2;...[] pkcs5PBES2;...[] hmacWithSHA1;...[] hmacWithSHA224;...[] hmacWithSHA256;...[] hmacWithSHA384;...[] hmacWithSHA512;...[] aes128CBC;...[] aes192CBC;...[] aes256CBC;ObjectIdentifier pkcs5PBKDF2_OID;ObjectIdentifier pkcs5PBES2_OID;ObjectIdentifier hmacWithSHA1_OID;ObjectIdentifier hmacWithSHA224_OID;ObjectIdentifier hmacWithSHA256_OID;ObjectIdentifier hmacWithSHA384_OID;ObjectIdentifier hmacWithSHA512_OID;ObjectIdentifier aes128CBC_OID;ObjectIdentifier aes192CBC_OID;ObjectIdentifier aes256CBC_OID;String pbes2AlgorithmName;// the PBES2 algorithm nameObjectIdentifier kdfAlgo_OID;// the key derivation function (default is HmacSHA1)ObjectIdentifier cipherAlgo_OID;// the encryption function// the cipher keysize (in bits)int andString kdfAlgoString cipherAlgothis.pbes2AlgorithmNameint underscoreint slashDerValue pBES2AlgorithmsDerValue pBES2_paramspBES2Algorithms.datapBES2Algorithms.tagpBES2_params.tagparseKDF(...)pBES2_params.dataparseES(...)DerValue pBKDF2_paramskeyDerivationFunc.dataDerValue specifiedpBKDF2_params.dataDerValue keyLengthkeyDerivationFunc.tagpBKDF2_params.tagspecified.tagDerValue.tag_OctetStringkeyLength.tagDerValue prfprf.dataDerValue parameterparameter.tagencryptionScheme.dataDerOutputStream pBES2AlgorithmsDerOutputStream pBES2_paramsDerOutputStream keyDerivationFuncDerOutputStream pBKDF2_paramsDerOutputStream prfDerOutputStream encryptionSchemeputNull(...)/* Returns a formatted string describing the parameters. ... *//* Copyright (c) 2012, Oracle and/or its affiliates. All rights reserved. ... */// KDF, encryption & keysize values are set later, in engineInit(byte[])// Extract the KDF and encryption algorithm names// Check for keysize// the 'specified' ASN.1 CHOICE for 'salt' is supported// the 'otherSource' ASN.1 CHOICE for 'salt' is not supported// keysize (in bits)// parameter is 'NULL' for all HmacSHA KDFs// parameter is AES-IV 'OCTET STRING (SIZE(16))'// choice: 'specified OCTET STRING'// derived key length (in octets)// algorithm is id-hmacWithSHA1/SHA224/SHA256/SHA384/SHA512// parameters is 'NULL'// algorithm is id-aes128-CBC or id-aes256-CBC// parameters is 'AES-IV ::= OCTET STRING (SIZE(16))'import UnsupportedEncodingExceptionPBES1Core core;/** Creates an instance of this cipher, and initializes its mode (CBC) and ... */new PBES1Core(...)/** Initializes this cipher with a key and a source ... */// Always returns 56 since the encryption key// is a DES key./** This class implements a proprietary password-based encryption algorithm. ... */// set the encapsulated cipher to do triple DES/** This class implements a key factory for PBE keys derived using ... */String prfAlgo;this.prfAlgoPBEKeySpec ksnew PBKDF2KeyImpl(...)PBEKey pKeyPBEKeySpec specInvalidKeySpecException re/* Copyright (c) 2005, 2012, Oracle and/or its affiliates. All rights reserved. ... */// Check if key implements the PBEKey/* Copyright (c) 2005, 2011, Oracle and/or its affiliates. All rights reserved. ... */import ObjectStreamExceptionimport Mac/** This class represents a PBE key derived using PBKDF2 defined ... */...[] passwd;int iterCount;Mac prf;Charset utf8getPasswordBytes(...)this.passwdint keyLengthgetKeyLength(...)this.iterCountthis.prfInvalidKeySpecException ikederiveKey(...)int hlengetMacLength(...)int intLint intRbyte[] uibyte[] tiSecretKey macKeySecretKey skbyte[] ibytesui.length// Convert the password from char[] to byte[]// not gonna happen; re-throw just in case// ceiling// residue// SecretKeySpec cannot be used, since password can be empty here.// XOR the intermediate Ui's together./** This is an implementation of the PBMAC1 algorithms as defined ... */String kdfAlgo;// Need to override clone() if mutable fields are added.// NOTE: this class inherits the Cloneable interface from HmacCoreString hashAlgo;int blockLength;/** Creates an instance of PBMAC1 according to the selected ... */// in octetsthis.kdfAlgothis.hashAlgothis.blockLengthPBKDF2Core kdfgetKDFImpl(...)/** This class represents ciphers in Plaintext Cipher Block Chaining (PCBC) ... */...[] kSave;/** This class implements password-base encryption algorithm with ... */// TBD: replace CipherCore with a CipherSpi object to simplify maintenanceint CIPHER_KEY;int CIPHER_IV;int MAC_KEY;// Uses default hash algorithm (SHA-1)// Uses supplied hash algorithmchars.lengthbyte[] passwdMessageDigest shaint vint uint croundup(...)byte[] Dbyte[] Ibyte[] Aiconcat(...)BigInteger B1B.lengthI.lengthBigInteger Ijint truncint loopSymmetricCipher symmCiphernew RC2Crypt(...)NoSuchPaddingException nspebyte[] derivedIvAlgorithmParameterSpec paramSpecPKCS12PBECipherCore core;new PKCS12PBECipherCore(...)implDoFinal(...)implGetBlockSize(...)implGetIV(...)implGetKeySize(...)implGetOutputSize(...)implGetParameters(...)implSetMode(...)implSetPadding(...)implUnwrap(...)implUpdate(...)implWrap(...)int RC4_KEYSIZE;ARCFOURCipher cipher;new ARCFOURCipher(...)engineGetBlockSize(...)engineGetIV(...)engineGetOutputSize(...)engineUnwrap(...)engineWrap(...)// Add in trailing NULL terminator.  Special case:// no terminator if password is "\0".// Cipher is not initialized with parameters;// follow the recommendation in PKCS12 v1.0// section B.4 to generate salt and iCount.// generate default for salt and iteration count if necessary// salt is recommended to be ideally as long as the output// of the hash function. However, it may be too strict to// force this; so instead, we'll just require the minimum// salt length to be 8-byte which is what PKCS#5 recommends// and openssl does./** This class implements padding as specified in the PKCS#5 standard. ... *//** Padding interface. ... *//** Returns the index where padding starts. ... */import java.math.*/** This class implements the <code>PrivateKeyInfo</code> type, ... */BigInteger VERSION;// the version number defined by the PKCS #8 standard// the private-key algorithm...[] privkey;// the private-key value/** Constructs a PKCS#8 PrivateKeyInfo from its ASN.1 encoding. */this.privkey/** Returns the private-key algorithm. */// OPTIONAL attributes not supported yetimport RC2ParameterSpec/** JCE CipherSpi for the RC2(tm) algorithm as described in RFC 2268. ... */// internal CipherCore & RC2Crypt objects which do the real work.RC2Crypt embeddedCipher;initEffectiveKeyBits(...)RC2ParameterSpec rc2ParamscheckKey(...)keyBytes.length/* Copyright (c) 2003, 2011, Oracle and/or its affiliates. All rights reserved. ... *//** Implementation of the RC2(tm) algorithm as described in RFC 2268. ... */...[] PI_TABLE;// PITABLE from the RFC, used in key setup// expanded key, 64 times 16-bit wordsint effectiveKeyBits;// effective key bits/** Initializes the effective key bit size. This method is a hook to ... */this.effectiveKeyBitsbyte[] expandedKeyBytesint t8int tm/** Encrypt a single block. Note that in a few places we omit a "& 0xffff" ... */int R0int R1int R2int R3/* Copyright (c) 2003, 2007, Oracle and/or its affiliates. All rights reserved. ... */// key buffer, the L[] byte array from the spec// place key into key buffer// first loop// second loop, reduce search space to effective key bits// byte to short conversion, little endian (copy into K[])// 5 mixing rounds// 1 mashing round// 6 mixing rounds// 5 r-mixing rounds// 1 r-mashing round// 6 r-mixing rounds/** This class implements the parameter set used with RC2 ... */...[] EKB_TABLE;// size to/from encoded version number// TABLE[EKB] from section 6 of RFC 2268, used to convert effective keyint version;// the version numberint effectiveKeySize;// the effective key sizeRC2ParameterSpec rpsEKB_TABLE.lengththis.effectiveKeySize// check effective key size (a value of 0 means it is unspecified)// search table for index containing versionimport java.security.interfaces.*import sun.security.rsa.*import Providersimport TlsRsaPremasterSecretParameterSpec/** RSA cipher implementation. Supports RSA en/decryption and signing/verifying ... */...[] B0;// constant for an empty byte arrayint MODE_ENCRYPT;// mode constant for public key encryptionint MODE_DECRYPT;// mode constant for private key decryptionint MODE_SIGN;// mode constant for private key encryption (signing)int MODE_VERIFY;// mode constant for public key decryption (verifying)String PAD_NONE;// constant for raw RSAString PAD_PKCS1;// constant for PKCS#1 v1.5 RSAString PAD_OAEP_MGF1;// constant for PKCS#2 v2.0 OAEP with MGF1int mode;// current mode, one of MODE_* above. Set when init() is calledString paddingType;// active padding type, one of PAD_* above. Set by setPadding()RSAPadding padding;// padding objectAlgorithmParameterSpec spec;// cipher parameter for OAEP padding and TLS RSA premaster secret// buffer for the dataint bufOfs;// offset into the buffer (number of bytes buffered)int outputSize;// size of the outputRSAPublicKey publicKey;// the public key, if we were initialized using a public keyRSAPrivateKey privateKey;// the private key, if we were initialized using a private keyString oaepHashAlgorithm;// hash algorithm for OAEP// the source of randomness// modes do not make sense for RSA, but allow ECB// set the padding typeString lowerPaddinggetService(...)getProviderList(...)// return 0 as block size, we are not a block cipher// return the output size// no iv, return null// initialize this cipherboolean encryptRSAKey rsaKeytoRSAKey(...)getByteLength(...)getModulus(...)RSAPadding.PAD_NONEint blockTypeRSAPadding.PAD_BLOCKTYPE_2RSAPadding.PAD_BLOCKTYPE_1getMaxDataSize(...)PSource.PSpecified.DEFAULTRSAPadding.PAD_OAEP_MGF1// internal update method// internal doFinal() method. Here we perform the actual RSA operationbyte[] databyte[] verifyBufferconvert(...)byte[] decryptBufferpad(...)rsa(...)result.lengthboolean isTlsRsaPremasterSecretException failoverIllegalBlockSizeException echeckTlsPreMasterSecretKey(...)getClientVersion(...)getServerVersion(...)/* Copyright (c) 2003, 2015, Oracle and/or its affiliates. All rights reserved. ... */// "oaepwith".length() == 8// "andmgf1padding".length() == 14// check if MessageDigest appears to be available// avoid getInstance() call here// never thrown when null parameters are used;// but re-throw it just in case// must be RSAPrivateKey per check in toRSAKey// for TLS RSA premaster secret// PAD_OAEP_MGF1// should not occur// should not occur, handled with length check above// polish the TLS premaster secretsuper.encodedParamsIOException ioimport static TlsPrfGenerator.genPad/** This file contains the code for the SslMacMD5 and SslMacSHA1 implementations. ... */...[] pad1, ...;...[] secret;/** Standard constructor, creates a new SslMacCore instance instantiating ... */this.pad1this.pad2/** Returns the length of the Mac in bytes. ... *//** Initializes the Mac with the given secret key and algorithm parameters. ... *//** Completes the Mac computation and resets the Mac for further use, ... *//** Resets the Mac for further use, maintaining the secret key that the ... */// nested static class for the SslMacMD5 implementationgenPad(...)SslMacCore core;new SslMacCore(...)...[] md5Pad1;...[] md5Pad2;...[] shaPad1;...[] shaPad2;/* Copyright (c) 2005, 2009, Oracle and/or its affiliates. All rights reserved. ... *//** Defines the "SunJCE" provider. ... *//** The "SunJCE" Cryptographic Service Provider. ... */String info;String OID_PKCS12_RC4_128;String OID_PKCS12_RC4_40;String OID_PKCS12_DESede;String OID_PKCS12_RC2_128;String OID_PKCS12_RC2_40;String OID_PKCS5_MD5_DES;String OID_PKCS5_PBKDF2;String OID_PKCS5_PBES2;String OID_PKCS3;boolean debug;/* Are we debugging? -- for developers */SunJCE instance;// to find ourselves or run the risk of not being in the list.// Instance of this provider, so we don't have to call the provider list// provider has not been installed yet// lazy initialize SecureRandom to avoid potential recursion if Sunnew SecureRandom(...)SecureRandom RANDOM;SecureRandomHolder.RANDOMString BLOCK_MODESString BLOCK_MODES128String BLOCK_PADS// Return the instance of this class or create one if needed.new SunJCE(...)/* We are the "SunJCE" provider *//* Cipher engines */// PBES1//PBES2/* Key(pair) Generator engines *//* Algorithm parameter generation engines *//* Key Agreement engines *//* Algorithm Parameter engines *//* Key factories *//* Secret-key factories *//* Internal in-house crypto algorithm used for ... */// PBKDF2/* MAC */// PBMAC1/* KeyStore *//* SSL/TLS mechanisms ... *//** This abstract class represents the core of all block ciphers. It allows to ... *//** Retrieves this cipher's block size. ... *//** Initializes the cipher in the specified mode with the given key. ... *//** Encrypt one cipher block. ... *//** Decrypt one cipher block. ... */import sun.security.internal.spec.*import static TlsPrfGenerator.*/** KeyGenerator implementation for the SSL/TLS master secret derivation. ... */String MSG;TlsKeyMaterialParameterSpec spec;int protocolVersion;this.specgetMasterSecret(...)getMinorVersion(...)getMajorVersion(...)engineGenerateKey0(...)byte[] masterSecretbyte[] clientRandomgetClientRandom(...)byte[] serverRandomgetServerRandom(...)SecretKey clientMacKeySecretKey serverMacKeySecretKey clientCipherKeySecretKey serverCipherKeyIvParameterSpec clientIvIvParameterSpec serverIvint macLengthgetMacKeyLength(...)int expandedKeyLengthgetExpandedCipherKeyLength(...)boolean isExportablegetCipherKeyLength(...)int ivLengthgetIvLength(...)int keyBlockLenbyte[] keyBlockMessageDigest md5int ofsString alggetCipherAlgorithm(...)byte[] clientKeyBytesbyte[] serverKeyBytesbyte[] seeddoTLS12PRF(...)getPRFHashAlg(...)getPRFHashLength(...)getPRFBlockSize(...)doTLS10PRF(...)new TlsKeyMaterialSpec(...)byte[] block/* Copyright (c) 2005, 2013, Oracle and/or its affiliates. All rights reserved. ... */// These may be used again later for exportable suite calculations.// generate key block// TLS 1.2// TLS 1.0/1.1// SSL// partition keyblock into individual secrets// mac keys// SSL_RSA_WITH_NULL_* ciphersuites// cipher keys// IV keys if needed.// if exportable suites, calculate the alternate// cipher key expansion and IV generation// TLS 1.1+// TLS 1.0// SSLv3import TlsMasterSecretimport TlsMasterSecretParameterSpecTlsMasterSecretParameterSpec spec;getPremasterSecret(...)SecretKey premasterKeybyte[] premasterint premasterMajorint premasterMinorbyte[] masternew TlsMasterSecretKey(...)int majorVersion, ...;this.majorVersionthis.minorVersion// RSA// DH, KRB5, othersimport TlsPrfParameterSpec/** KeyGenerator implementation for the TLS PRF function. ... */genConst(...)// in this package// magic constants and utility functions, also used by other files...[] LABEL_MASTER_SECRET;...[] LABEL_KEY_EXPANSION;...[] LABEL_CLIENT_WRITE_KEY;...[] LABEL_SERVER_WRITE_KEY;...[] LABEL_IV_BLOCK;...[] HMAC_ipad64;/* TLS HMAC "inner" and "outer" padding.  This isn't a function ... */...[] HMAC_ipad128;...[] HMAC_opad64;...[] HMAC_opad128;...[] SSL3_CONST;// SSL3 magic mix constants ("A", "BB", "CCC", ...)int n1b1.lengthint n2b2.lengthbyte[][] arr// PRF implementationTlsPrfParameterSpec spec;SecretKey keygetSecret(...)byte[] labelBytesgetLabel(...)getOutputLength(...)byte[] prfBytesgetSeed(...)UnsupportedEncodingException eMessageDigest prfMDbyte[] ipadbyte[] opadnew DigestException(...)expand(...)int seclenbyte[] secKeyint keyLensecKey.length/* @param digest the MessageDigest to produce the HMAC ... */byte[] aBytes/** A KeyGenerator implementation that supports TLS 1.2. ... *//** A KeyGenerator implementation that supports TLS 1.0/1.1. */// "master secret"// "key expansion"// "client write key"// "server write key"// "IV block"// If we have a long secret, digest it first.// P_HASH(Secret, label + seed)/* Split the secret into two halves S1 and S2 of same length. ... */// P_MD5(S1, label + seed)// 64: block size of HMAC-MD5// P_SHA-1(S2, label + seed)// 64: block size of HMAC-SHA1/* modify the padding used, by XORing the key into our copy of that ... *//* compute: ... *//* compute A() ... */// inner digest// outer digest/* compute HMAC_hash() ... *//** KeyGenerator implementation for the SSL/TLS RSA premaster secret. ... */TlsRsaPremasterSecretParameterSpec spec;// Only can be used in client side to generate TLS RSA premaster secret.getEncodedSecret(...)/* Copyright (c) 2005, 2014, Oracle and/or its affiliates. All rights reserved. ... *//** This class is introduced to workaround a problem in ... *//* Copyright (c) 2001, 2007, Oracle and/or its affiliates. All rights reserved. ... *//* This class and it's methods are used by hprof when injecting bytecodes ... */int engaged;/* Master switch that activates calls to native functions. *//* At the beginning of java.jang.Object.<init>(), a call to ... *//* To track memory allocated, we need to catch object init's and arrays. */nativeObjectInit(...)/* Immediately following any of the newarray bytecodes, a call to ... */nativeNewArray(...)/* At the very beginning of every method, a call to ... *//* For cpu time spent in methods, we need to inject for every method. */nativeCallSite(...)/* Before any of the return bytecodes, a call to ... */nativeReturnSite(...)...[] compressionTypeNames;compressionTypeNames.lengthString VERSION_2;// bmp versionsString VERSION_3;String VERSION_3_NT;String VERSION_4;String VERSION_5;int LCS_CALIBRATED_RGB;// Color space typesint LCS_sRGB;int LCS_WINDOWS_COLOR_SPACE;int PROFILE_LINKED;int PROFILE_EMBEDDED;int BI_RGB;// Compression Typesint BI_RLE8;int BI_RLE4;int BI_BITFIELDS;int BI_JPEG;int BI_PNG;import Pointimport Transparencyimport ColorSpaceimport ICC_ColorSpaceimport ICC_Profileimport ColorModelimport ComponentColorModelimport ComponentSampleModelimport DataBufferimport DataBufferByteimport DataBufferIntimport DataBufferUShortimport DirectColorModelimport IndexColorModelimport MultiPixelPackedSampleModelimport PixelInterleavedSampleModelimport Rasterimport SampleModelimport SinglePixelPackedSampleModelimport WritableRasterimport IIOExceptionimport ImageIOimport ImageReaderimport ImageReadParamimport ImageTypeSpecifierimport IIOMetadataimport ImageReaderSpiimport ImageInputStreamimport IIOReadProgressListenerimport IIOReadUpdateListenerimport IIOReadWarningListenerimport java.nio.*import Iteratorimport StringTokenizerimport ImageUtilimport I18N/** This class is the Java Image IO plugin reader for BMP images. ... */int VERSION_2_1_BIT;// BMP Image typesint VERSION_2_4_BIT;int VERSION_2_8_BIT;int VERSION_2_24_BIT;int VERSION_3_1_BIT;int VERSION_3_4_BIT;int VERSION_3_8_BIT;int VERSION_3_24_BIT;int VERSION_3_NT_16_BIT;int VERSION_3_NT_32_BIT;int VERSION_4_1_BIT;int VERSION_4_4_BIT;int VERSION_4_8_BIT;int VERSION_4_16_BIT;int VERSION_4_24_BIT;int VERSION_4_32_BIT;int VERSION_3_XP_EMBEDDED;int VERSION_4_XP_EMBEDDED;int VERSION_5_XP_EMBEDDED;long bitmapFileSize;// BMP variableslong bitmapOffset;long compression;long imageSize;...[] palette;int imageType;int numBands;boolean isBottomUp;int bitsPerPixel;int redMask, ...;SampleModel sampleModel, ...;ColorModel colorModel, ...;ImageInputStream iis;/** The input stream where reads from */boolean gotHeader;/** Indicates whether the header is read. */int width;/** The original image width. */int height;/** The original image height. */Rectangle destinationRegion;/** The destination region. */Rectangle sourceRegion;/** The source region. */BMPMetadata metadata;/** The metadata from the stream. */BufferedImage bi;/** The destination image. */boolean noTransform;/** Indicates whether subsampled, subregion is required, and offset is ... */boolean seleBand;/** Indicates whether subband is selected. */int scaleX, ...;/** The scaling factors. */...[] sourceBands, ...;/** source and destination bands. *//** Constructs <code>BMPImageReader</code> from the provided ... *//** Overrides the method defined in the superclass. */setInput(...)setByteOrder(...)resetHeaderInfo(...)getString(...)readHeader(...)IllegalArgumentException enew IIOException(...)/** Process the image header. ... */int profileDataint profileSizebyte[] markerreadUnsignedInt(...)int planesreadUnsignedShort(...)ColorSpace colorSpaceColorSpace.CS_sRGBthis.metadatanew BMPMetadata(...)mark(...)read(...)skipBytes(...)readShort(...)metadata.widthmetadata.heightmetadata.bitsPerPixelint numberOfEntriesint sizeOfPalettemetadata.bmpVersionmetadata.palettemetadata.paletteSizelong xPelsPerMeterlong yPelsPerMeterlong colorsUsedlong colorsImportantmetadata.compressionmetadata.xPixelsPerMetermetadata.yPixelsPerMetermetadata.colorsUsedmetadata.colorsImportantmetadata.redMaskmetadata.greenMaskmetadata.blueMasklong csTypeint redXint redYint redZint greenXint greenYint greenZint blueXint blueYint blueZlong gammaRedlong gammaGreenlong gammaBluemetadata.intentmetadata.colorSpacemetadata.redXmetadata.redYmetadata.redZmetadata.greenXmetadata.greenYmetadata.greenZmetadata.blueXmetadata.blueYmetadata.blueZmetadata.gammaRedmetadata.gammaGreenmetadata.gammaBluemetadata.alphaMaskabs(...)byte[] profileisLinkedProfileAllowed(...)isUncOrDevicePath(...)String pathnew ICC_ColorSpace(...)byte[] rbyte[] gint[] bandOffsetsnew PixelInterleavedSampleModel(...)DataBuffer.TYPE_BYTEnew MultiPixelPackedSampleModel(...)palette.lengthisIndicesForGrayscale(...)createColorModel(...)new IndexColorModel(...)new SinglePixelPackedSampleModel(...)DataBuffer.TYPE_USHORTnew DirectColorModel(...)int[] bitMasksDataBuffer.TYPE_INTArrayList<> listnew ArrayList<>(...)new ImageTypeSpecifier(...)iterator(...)new ImageReadParam(...)WritableRaster rasterbyte[] bdatashort[] sdataint[] idataclearAbortRequest(...)processImageStarted(...)getDefaultReadParam(...)new Rectangle(...)computeRegions(...)this.widththis.heightgetDestination(...)getSourceXSubsampling(...)getSourceYSubsampling(...)getSourceBands(...)getDestinationBands(...)createCompatibleSampleModel(...)destinationRegion.xdestinationRegion.widthdestinationRegion.ydestinationRegion.heightcreateSubsetSampleModel(...)createWritableRaster(...)new Point(...)getWritableTile(...)getSampleModel(...)getColorModel(...)...&=...getDataType(...)getData(...)getDataBuffer(...)read1Bit(...)read4Bit(...)read8Bit(...)read24Bit(...)readRLE4(...)readRLE8(...)read16Bit(...)read32Bit(...)readEmbedded(...)abortRequested(...)processReadAborted(...)processImageComplete(...)BufferedImage bi// Deal with 1 Bit images using IndexColorModelsint bytesPerScanlineint paddingint lineLengthprocessImageUpdate(...)processImageProgress(...)byte[] bufint lineStridegetScanlineStride(...)int skipLengthint[] srcOffint[] destOffint[] srcPosint[] destPosint lastLinesourceRegion.ysourceRegion.x// Method to read a 4 bit BMP image data// Method to read 8 bit BMP image dataint m// Method to read 24 bit BMP image datadestBands.lengthshort[] bufint[] bufint imSizeint remainderbyte[] valuesint bytesReaddecodeRLE8(...)byte[] valboolean flagint lineNoint finishedint xoffint yoffsourceRegion.heightint currentLinesourceRegion.widthdecodeRLE4(...)int shiftceil(...)int[] alternate/** Decodes the jpeg/png image embedded in the bitmap using any jpeg ... */ImageReader readernext(...)getImageReadersByFormatName(...)byte[] buffImageReadParam paramcreateImageInputStream(...)ImageTypeSpecifier embTypegetImageTypes(...)createBufferedImage(...)addIIOReadProgressListener(...)addIIOReadUpdateListener(...)processPassComplete(...)processPassStarted(...)addIIOReadWarningListener(...)processWarningOccurred(...)setDestination(...)setDestinationBands(...)setDestinationOffset(...)getDestinationOffset(...)setSourceBands(...)setSourceRegion(...)getSourceRegion(...)setSourceSubsampling(...)getSubsamplingXOffset(...)getSubsamplingYOffset(...)Boolean isLinkedProfileDisabled;PrivilegedAction<Boolean> agetBoolean(...)Boolean isWindowsPlatform;/** Verifies whether the byte array contans a unc path. ... */String osname// Always works// read and check the magic marker// Read file size// skip the two reserved fields// Offset to the bitmap from the beginning// End File Header// Start BitmapCoreHeader//metadata.colorPlane = planes;// As BMP always has 3 rgb bands, except for Version 5,// which is bgra// Windows 2.x and OS/2 1.x// Classify the image type// Read in the palette// Windows 3.x and Windows NT// No compression// 8-bit RLE compression// 4-bit RLE compression// 0x1F;// BitsField encoding// there is a palette// Windows 4.x BMP// rgb masks, valid only if comp is BI_BITFIELDS// Only supported for 32bpp BI_RGB argb// All the new fields are valid only for this case// bottom up image// top down image// Reset Image Layout so there's only one tile.//Define the color space// the colorModel and sampleModel will be initialzed// by the  reader of embedded image// When number of bitsPerPixel is <= 8, we use IndexColorModel.// 1 and 4 bit pixels can be stored in a packed format.// Create IndexColorModel from the palette.// The number of bands in the SampleModel is determined by// the length of the mask array passed in.// Create SampleModel// Reset to the start of bitmap; then jump to the//start of image data//read header// If the destination band is set used it// If the destination is provided, then use it.  Otherwise, create new one// Get the image data.// buffer for byte data// buffer for short data// buffer for int data// the sampleModel can be null in case of embedded image// There should only be one tile.// no compression// 1-bit images cannot be compressed.// 24-bit images are not compressed// cache the values to avoid duplicated computation//get the bit and assign to the data buffer of the raster// Padding bytes at the end of each scanline// width * bitsPerPixel should be divisible by 32// If imageSize field is not provided, calculate it.// If width is not 32 bit aligned, then while uncompressing each// scanline will have padding bytes, calculate the amount of padding// Read till we have the whole image// Since data is compressed, decompress it// End-of-scanline marker// End-of-RLE marker// delta or vector marker// Move to the position xoff, yoff down// Whenever end pixels can fit into odd number of bytes,// an extra padding byte will be present, so skip that.// If End-of-RLE data, then exit the while loop// If imageSize field is not specified, calculate it.// If width is not 32 byte aligned, then while uncompressing each// Decompress the RLE4 compressed data.// Absolute mode// When end is odd, the above for loop does not// increment count, so do it now.// Encoded mode// prepare input/* no need for the check on platforms except windows *//* normalize prefix of the path */// long path: whether unc or local// device path or short unc notationimport IIORegistryimport ServiceRegistry...[] writerSpiNames;...[] formatNames;...[] entensions;...[] mimeType;boolean registered;BMPMetadata.nativeMetadataFormatNameImageInputStream streamnew BMPImageReader(...)import DataBufferShortimport BandedSampleModelimport RenderedImageimport ByteArrayOutputStreamimport ByteOrderimport IIOImageimport ImageWriteParamimport ImageWriterimport ImageWriterSpiimport ImageOutputStreamimport IIOWriteProgressListenerimport IIOWriteWarningListenerimport BMPImageWriteParam/** The Java Image IO plugin writer for encoding a binary RenderedImage into ... */ImageOutputStream stream;/** The output stream to write into */ByteArrayOutputStream embedded_stream;int compressionType;boolean isTopDown;int w, ...;int compImageSize;...[] bitMasks;...[] bitPos;...[] bpixels;...[] spixels;...[] ipixels;/** Constructs <code>BMPImageWriter</code> based on the provided ... */setOutput(...)this.streamnew BMPImageWriteParam(...)BMPMetadata metameta.bmpVersionmeta.compressiongetPreferredCompressionType(...)getCompressionMode(...)ImageWriteParam.MODE_EXPLICITgetCompressionType(...)meta.bitsPerPixelgetPixelSize(...)BMPImageWriteParam bmpParamint bitsPerPixelboolean isPaletteint paletteEntriesIndexColorModel icmRenderedImage inputRaster inputRasterboolean writeRasterhasRaster(...)Rectangle sourceRegionSampleModel sampleModelColorModel colorModelIIOMetadata imageMetadatagetMetadata(...)BMPMetadata bmpImageMetadataint scaleXint scaleYint xOffsetint yOffsetint dataTypeint minXint minYRectangle destinationRegionboolean noTransformint[] sourceBandsboolean noSubbandint numBandsgetNumBands(...)boolean bgrOrderint[] sampleSizegetSampleSize(...)int destScanlineBytesbyte[] aint fileSizeint headerSizeint imageSizeint xPelsPerMeterint yPelsPerMeterint colorsUsedint colorsImportantlong headPosgetStreamPosition(...)int scanlineBytesint[] pixelsint maxBandOffsetint[] pixelint destScanlineLengthgetDefaultWriteParam(...)getRaster(...)intersection(...)Rectangle rectgetMinX(...)getMinY(...)getRenderedImage(...)ImageTypeSpecifier imageTypegetDefaultImageMetadata(...)isEmpty(...)getBandOffsets(...)bandOffsets.lengthint[] bitOffsetsgetBitOffsets(...)bitOffsets.lengthImageWriteParam.MODE_COPY_FROM_METADATAbmpImageMetadata.compressionImageWriteParam.MODE_DEFAULTcanEncodeImage(...)int rmaskint gmaskint bmaskgetDataTypeSize(...)DirectColorModel dcmgetRedMask(...)getGreenMask(...)getBlueMask(...)writeMaskToPalette(...)firstLowBit(...)getMapSize(...)getAlphas(...)getReds(...)getGreens(...)getBlues(...)int[] sample_sizesroundBpp(...)writeFileHeader(...)isTopDown(...)writeInfoHeader(...)int masklong endPoswriteEmbedded(...)seek(...)writeSize(...)processWriteAborted(...)flushBefore(...)int rowRaster srcRectangle srcRectSampleModel smint startXsrcRect.xgetSampleModelTranslateX(...)int startYsrcRect.ygetSampleModelTranslateY(...)ComponentSampleModel csmgetOffset(...)int nbMultiPixelPackedSampleModel mppsmSinglePixelPackedSampleModel sppsmshort[] usdataDataBuffer.TYPE_SHORTwriteShorts(...)writeInts(...)bpixels.lengthgetPixels(...)srcRect.widthsrcRect.heightencodeRLE4(...)encodeRLE8(...)pixel.lengthwritePixels(...)incCompImageSize(...)int pixelbyte[] bipixelsspixels.lengthint entriesipixels.lengthint runCountint absValbyte runValbyte nextValbyte[] absBufint aisEven(...)int qbyte runVal1byte runVal2byte nextVal1byte nextVal2writeShort(...)Iterator<> iteratorgetImageWritersByFormatName(...)ImageWriter writerhasNext(...)ImageWriteParam paramaddIIOWriteProgressListener(...)addIIOWriteWarningListener(...)createImageOutputStream(...)/* Returns preferred compression type for given image. ... */getBufferedImageType(...)BufferedImage.TYPE_USHORT_565_RGB/* Check whether we can encode image of given type using compression method in question. ... */ImageTypeSpecifier imgTypeImageWriterSpi spigetOriginatingProvider(...)int biTypeint bppboolean canUseRGBboolean canUseBITFIELDSint[] sizessizes.length// validates output// Default is using 24 bits per pixel.// cache the data type;// Raw data can only handle bytes, everything greater must be ASCII.// for images with BandedSampleModel we can not work//  with raster directly and must use writePixels()// we can work with raster directly only in case of// BGR component order.// In any other case we must use writePixels()// BugId 4892214: we can not work with raster directly// if image have different color order than RGB.// We should use writePixels() for such images.// we will use getPixels() to extract pixel data for writePixels()// Please note that getPixels() provides rgb bands order.//XXX: check more// Number of bytes that a scanline for the image written out will have.// ImageWriteParam.MODE_DISABLED:// we should use 32bpp images in case of BI_BITFIELD// compression to avoid color conversion artefacts// Setting this flag to false ensures that generic// writePixels() will be used to store image data/* NB: canEncodeImage() ensures we have image of ... */// it is unlikely, but if it happens, we should throw// an exception related to unsupported image format// prepare info for writePixels procedure// handle BI_RGB compression// Cannot be written as a Palette image. So write out as// 24 bit image.// Grey scale images/* NB: the actual pixel size can be smaller than ... */// actual writing of image data// Calculate padding for each scanline// FileHeader is 14 bytes, BitmapHeader is 40 bytes,// add palette size and that is where the data will begin/* According to MSDN description, the top-down image layout ... */// compression// imageSize// xPelsPerMeter// yPelsPerMeter// Colors Used// Colors Important// palette// write palette// write masks for red, green and blue components.// Writing of actual image data// Buffer for up to 8 rows of pixels// Also create a buffer to hold one line of the data// to be written to the file, so we can use array writes.// prepare embedded buffer// update the file/image Size// Get the pixels//byte[] bdata =//    ((DataBufferByte)src.getDataBuffer()).getData();//System.out.println("bdata.length="+bdata.length);//System.arraycopy(bdata, pos, bpixels, 0, scanlineBytes);// pixel data is provided here in RGB order// Write the RLE EOF marker and// Partially filled last byte, if any// Put the last pixel of odd-length lines in the 4 MSBs/* We expect that pixel data comes in RGB order. ... *//* please note that despite other cases, ... */// Since BMP needs BGR format// Case where IndexColorModel had > 256 colors.// We have two possibilities here:// 1. we are writing the indexed image with bitfields//    compression (this covers also the case of BYTE_BINARY)//    => use icm to get actual RGB color values.// 2. we are writing the gray-scaled image with BI_BITFIELDS//    compression//    => just replicate the level of gray to color components.// Write out the padding/// Check if there was an existing Absolute Run//Padding/// Absolute Encoding for less than 3/// treated as regular encoding/// Do not include the last element since it will/// be inclued in the next encoding/run/// Only 255 values permitted/// If there was an existing run// First time..//  0-254 only// padding since 255 elts is not even// EOF scanline// Write the run// write the Absolute Run/// EOF scanline//Check if there was an existing Absolute Run// we need to exclude  last 2 elts, similarity of// which caused to enter this part of the code// if # of elts is odd - read the last element// Padding to word align absolute encoding// Even runlength/// Only EOF required now// odd runlength and the run ends here// runCount wont be > 254 since 256/255 case will// be taken care of in above code.// If end of scanline// Check for existing run// first time// only 255 elements// Padding for word align// since it will fit into 127 bytes// Handle the End of scanline for the last 2 4bits// Padding// magic value// File size// reserved1 and reserved2// offset to image data// size of header// width// height// number of planes// Bits Per Pixel//param.setDestinationBands(bmpParam.getDestinationBands());// only 4bpp images can be encoded as BI_RLE4// only 8bpp images can be encoded as BI_RLE8/* Technically we expect that we may be able to ... */...[] readerSpiNames;new BMPImageWriter(...)import IIOMetadataNodeimport IIOMetadataFormatimport IIOMetadataFormatImplimport NodeString nativeMetadataFormatName;String bmpVersion;// Fields for Image Descriptorshort bitsPerPixel;int compression;int imageSize;int xPixelsPerMeter;// Fields for PixelsPerMeterint yPixelsPerMeter;int colorsUsed;int colorsImportant;int redMask;// Fields for BI_BITFIELDS compression(Mask)int greenMask;int blueMask;int alphaMask;int colorSpace;double redX;// Fields for CIE XYZ for the LCS_CALIBRATED_RGB color spacedouble redY;double redZ;double greenX;double greenY;double greenZ;double blueX;double blueY;double blueZ;int gammaRed;// Fields for Gamma values for the LCS_CALIBRATED_RGB color spaceint gammaGreen;int gammaBlue;int intent;// Fields for the Palette and Entriesint paletteSize;int red;int green;int blue;List<> comments;// List of byte[]// Fields from CommentExtension// new ArrayList();getNativeTree(...)IIOMetadataFormatImpl.standardMetadataFormatNamegetStandardTree(...)IIOMetadataNode rootnew IIOMetadataNode(...)IIOMetadataNode nodeaddChildNode(...)int versionnew Short(...)addXYZPoints(...)int numCompsIIOMetadataNode entrynew Byte(...)// Standard tree node methodsIIOMetadataNode subNodesetAttribute(...)IIOMetadataNode subNode1appendChild(...)String bitscountBits(...)float rationew Double(...)IIOMetadataNode childsetUserObject(...)setNodeValue(...)convertObjectToString(...)// Palette// CompressionTypeNameIIOMetadataFormat instance;addElement(...)addBooleanAttribute(...)new BMPMetadataFormat(...)/* Copyright (c) 2003, 2004, Oracle and/or its affiliates. All rights reserved. ... */// root -> ImageDescriptor/// Should the max value be 1.7976931348623157e+308 ?// root -> Palette// root -> Palette -> PaletteEntry// root -> CommentExtensions// root -> CommentExtensions -> CommentExtension/* Copyright (c) 2003, 2005, Oracle and/or its affiliates. All rights reserved. ... */// Node name, followed by description/* Came from GIFEncoder initially. ... */ImageOutputStream output;int bitsLeft;boolean blocks;/** note this also indicates gif format BITFile. * */// bits left at current index that are avail./* @param output destination for output data ... */this.outputthis.blocksint numBytesint bitsWrittenint topbits// gif block count// This handles the GIF block count stuff// bits contents fit in current index byte// GIF// bits overflow from current byte to next.// if bits  > space left in current byte then the lowest order bits// of code are taken and put in current byte and rest put in next.// if bits  > space left in current byte then the highest order bits// at highest order bit location !!// ok this many bits gone off the top// next index/** A dummy <code>ColorSpace</code> to enable <code>ColorModel</code> ... *//** Return the type given the number of components. ... */int typeColorSpace.TYPE_GRAY/** Constructs a bogus <code>ColorSpace</code>. ... */// specified behavior of the methods vis-a-vis exceptions.// output array while otherwise attempting to adhere to the// The following methods simply copy the input array to thefloat[] rgbvaluecolorvalue.lengthgetNumComponents(...)new ArrayIndexOutOfBoundsException(...)float[] colorvaluergbvalue.lengthfloat[] xyzvaluexyzvalue.length/* Copyright (c) 2003, Oracle and/or its affiliates. All rights reserved. ... */// Based on the constant definitions TYPE_2CLR=12 through// TYPE_FCLR=25. This will return unknown types for// numComponents > 15.String resource_name;import InputStreamimport PropertyResourceBundleimport URL/** Class to simplify use of internationalization message strings. ... *//** Returns the message string with the specified key from the ... */PropertyResourceBundle bundleInputStream streamgetResourceAsStream(...)new PropertyResourceBundle(...)Throwable ehandleGetObject(...)// Chain the exception./** Creates a <code>ColorModel</code> that may be used with the ... *//* XXX testing only ... */DataBuffer.TYPE_FLOATDataBuffer.TYPE_DOUBLEboolean hasAlphaboolean isAlphaPremultipliedint transparencyTransparency.TRANSLUCENTTransparency.OPAQUEColorSpace.CS_GRAYnew BogusColorSpace(...)new ComponentColorModel(...)getBitMasks(...)int amaskbitMasks.lengthint bitssampleSize.lengthint bitsPerSampleint numEntriesbyte[] map/** For the case of binary data (<code>isBinary()</code> returns ... */int rectXrect.xint rectYrect.yint rectWidthrect.widthint rectHeightrect.heightDataBuffer dataBufferint dxint dyMultiPixelPackedSampleModel mppint eltOffsetint bitOffsetgetBitOffset(...)int numBytesPerRowbyte[] binaryDataArrayisBinary(...)getData(...).lengthint strideshort[] dataint xRemainingshort datumint datumint leftShiftint rightShiftint bOffsetint modint delta/** Returns the binary data unpacked into an array of bytes. ... */int maxYint maxXbyte bshort s/** Sets the supplied <code>Raster</code>'s data from an array ... */int leftShift8int mask1byte datumint remainMaskint leftShift16int mask2int leftShift32/** Copies data into the packed array of the <code>Raster</code> ... */getPixelBitStride(...)boolean useAlphaboolean premultipliedint dataTypeSizeint[] bitsbyte[] compint elementSizegetDataBitOffset(...)int maxBandOffint pixelStridegetPixelStride(...)int scanlineStrideint[] bankIndicesgetBankIndices(...)bankIndices.lengthgetTileSize(...)/** Tests whether the color indices represent a gray-scale image. ... */r.lengthg.length/** Converts the provided object to <code>String</code> */byte[] bArraybArray.lengthint[] iArrayiArray.lengthshort[] sArraysArray.length/** Checks that the provided <code>ImageWriter</code> can encode ... */ImageTypeSpecifier type/** Returns whether the image has contiguous data across rows. */WritableRaster ras//import javax.imageio.ImageTypeSpecifier;// Check the parameter.// Get the data type.// Check the data type// Return null for other types.// The return variable.// Get the sample size.// Create a Component ColorModel.// Get the number of bands.// Determine the color space.// Load the colormap with a ramp.// bitOffset != 0// bitOffset % 8 != 0// Optimal case: simply return.// when all the bits in this BYTE will be set// into the data buffer.// All the "leftShift" high bits will be set// into the data buffer.  But not all the// "rightShift" low bits will be set.// Less than "leftShift" high bits will be set.// This BYTE is set into one SHORT// Mask the bits to be set.// This BYTE will be set into two SHORTs// This BYTE will be set into two SHORTs;// But not all the low bits will be set into SHORT// Only some of the high bits will be set into// SHORTs// This BYTE is set into one INT// All the bits of this BYTE will be set into two INTs// This BYTE will be set into two INTs;// But not all the low bits will be set into INT// Only some of the high bits will be set into INT//dataType == DataBuffer.TYPE_SHORT ||// Ensure image rows samples are stored contiguously// in a single bank.// Otherwise true if and only if it's a bilevel image with// a MultiPixelPackedSampleModel, 1 bit per pixel, and 1 bit// pixel stride.ImageInputStream stream;/* Copyright (c) 2000, Oracle and/or its affiliates. All rights reserved. ... *//* Modified from original LZWCompressor to change interface to passing a ... */int codeSize;/** base underlying code size of data being compressed 8 for TIFF, 1 to 8 for GIF * */int clearCode;/** reserved clear code based on code size * */int endOfInfo;/** reserved end of data code based on code size * */int numBits;/** current number bits output for each code * *//** limit at which current number of bits code size has to be increased * */short prefix;/** the prefix code which represents the predecessor string to current input point * */BitFile bf;/** output destination for bit codes * */LZWStringTable lzss;/** general purpose LZW string table * */boolean tiffFudge;/** modify the limits of the code values in LZW encoding due to TIFF bug / feature * *//** @param ... */new BitFile(...)this.codeSizenew LZWStringTable(...)clearTable(...)writeBits(...)byte cshort indexint maxOffsetfindCharString(...)addCharString(...)/* Indicate to compressor that no more data to go so write out ... */dump(...)// set flag for GIF as NOT tiff/** General purpose LZW String Table. ... */int RES_CODES;/** codesize + Reserved Codes */short HASH_FREE;short NEXT_FIRST;int MAXBITS;int MAXSTR;short HASHSIZE;short HASHSTEP;...[] strChr;...[] strNxt;// after predecessor character...[] strHsh;// predecessor stringshort numStrings;// hash table to find  predecessor + char pairs...[] strLen;/* each entry corresponds to a code and contains the length of data ... */// next code if adding new prestring + char/* Constructor allocate memory for string store data *//* @param index value of -1 indicates no predecessor [used in initialisation] ... */int hshidx/* @param index index to prefix string ... */int nxtidx/* @param codesize the size of code to be preallocated for the ... */int w/* If expanded data doesn't fit into array only what will fit is written ... */int expandLenint codeLenint bufSpaceint skipTail// if used up all codes// return the code and inc for next code// Rob fixed used to sign extend// search// init with no prefix// just in case// DONE no more unpacked// how much data we are actually expanding// length of expanded code left// how much space left// only got this many to unpack// only > 0 if codeLen > bufSpace [left overs]// initialise to exclusive end address of buffer area// NOTE: data unpacks in reverse direction and we are placing the// unpacked data directly into the array in the correct location.// skip required of expanded data// to predecessor code// indicate what part of codeLen used// indicate length of dat unpacked/** This class implements the octree quantization method ... */int MAXLEVEL;/** maximum of tree depth */RenderedImage src;ColorModel srcColorModel;int requiredSize;ColorNode root;int numNodes;int maxNodes;int currLevel;int currSize;...[] reduceList;int transparency;ColorNode transColor;/** Creates an image representing given image ... */PaletteBuilder pbnew PaletteBuilder(...)buildPalette(...)getIndexedImage(...)/** Creates an palette representing colors from given image ... */getIndexColorModel(...)/** Returns <code>true</code> if PaletteBuilder is able to create ... */canCreatePalette(...)BufferedImage dstBufferedImage.TYPE_BYTE_INDEXEDWritableRaster wrColor aColorgetSrcColor(...)setSample(...)findColorIndex(...)this.srcthis.srcColorModelthis.srcRasterthis.transparencygetTransparency(...)this.requiredSizeint argbgetDataElements(...)getAlpha(...)aNode.isLeafaNode.paletteIndexint childIndexgetBranchIndex(...)aNode.levelaNode.childrennew ColorNode[]reduceList.lengthnew ColorNode(...)transColor.isLeafinsertNode(...)reduceTree(...)aNode.colorCountaNode.redaNode.greenaNode.blueint branchIndexaNode.childCountaNode.nextReduciblebyte[] redbyte[] greenbyte[] bluefindPaletteEntry(...)int red_indexint green_indexint blue_indexint levelColorNode thisNodeColorNode pListint minColorCountpList.colorCountint cntint leafChildCountgetLeafChildCount(...)int aDepththisNode.levelpList.nextReduciblepList.nextReducible.colorCountthisNode.nextReduciblethisNode.isLeaffreeTree(...)thisNode.childrenthisNode.childCount/** The node of color tree. */boolean isLeaf;int childCount;...[] children;int colorCount;long red;long blue;long green;int paletteIndex;int level;ColorNode nextReducible;children.length...[...].isLeaf// default transparnt pixel/* from the book *//* If transparency of given image is not opaque we assume all ... */// one slot for transparent color// we need place for transparent color;// nothing to reduce// look for element with lower color count// save pointer to first reducible node// NB: current color count for node could be changed in future// we need to process it// reduce node/** This class contains utility methods that may be useful to ImageReader ... */// Helper for computeUpdatedPixels methodboolean gotPixelint firstDstint secondDstint lastDstint srcint dst/** A utility method that computes the exact set of destination ... */int[] valscomputeUpdatedPixels(...)destinationOffset.xdestinationOffset.y// We need to satisfy the congruences:// dst = destinationOffset + (src - sourceOffset)/sourceSubsampling// src - passStart == 0 (mod passPeriod)// src - sourceOffset == 0 (mod sourceSubsampling)// subject to the inequalities:// src >= passStart// src < passStart + passExtent// src >= sourceOffset// src < sourceOffset + sourceExtent// dst >= dstMin// dst <= dstmax// where// For now we use a brute-force approach although we could// attempt to analyze the congruences.  If passPeriod and// sourceSubsamling are relatively prime, the period will be// their product.  If they share a common factor, either the// period will be equal to the larger value, or the sequences// will be completely disjoint, depending on the relationship// between passStart and sourceOffset.  Since we only have to do this// twice per image (once each for X and Y), it seems cheap enough// to do it the straightforward way.// Record smallest valid pixel// Record second smallest valid pixel// Record largest valid pixel// If we never saw a valid pixel, set width to 0// The period is given by the difference of any two adjacent pixels// Utility method for nodes with a single attribute named "value"List<> valuesaddSingleAttributeElement(...)/* Copyright (c) 2001, 2013, Oracle and/or its affiliates. All rights reserved. ... */// root -> Chroma// root -> Chroma -> ColorSpaceType// root -> Chroma -> NumChannels// root -> Chroma -> Gamma// root -> Chroma -> BlackIsZero// root -> Chroma -> Palette// root -> Chroma -> PaletteEntry// root -> Chroma -> BackgroundIndex// root -> Chroma -> BackgroundColor// root -> Compression// root -> Compression -> CompressionTypeName// root -> Compression -> Lossless// root -> Compression -> NumProgressiveScans// root -> Compression -> BitRate// root -> Data// root -> Data -> PlanarConfiguration// root -> Data -> SampleFormat// root -> Data -> BitsPerSample// root -> Data -> SignificantBitsPerSample// root -> Data -> SampleMSB// root -> Dimension// root -> Dimension -> PixelAspectRatio// root -> Dimension -> ImageOrientation// root -> Dimension -> HorizontalPixelSize// root -> Dimension -> VerticalPixelSize// root -> Dimension -> HorizontalPhysicalPixelSpacing// root -> Dimension -> VerticalPhysicalPixelSpacing// root -> Dimension -> HorizontalPosition// root -> Dimension -> VerticalPosition// root -> Dimension -> HorizontalPixelOffset// root -> Dimension -> VerticalPixelOffset// root -> Dimension -> HorizontalScreenSize// root -> Dimension -> VerticalScreenSize// root -> Document// root -> Document -> FormatVersion// root -> Document -> SubimageInterpretation// root -> Document -> ImageCreationTime// second = 60 denotes leap second// root -> Document -> ImageModificationTime// root -> Text// root -> Text -> TextEntry// root -> Transparency// root -> Transparency -> Alpha// root -> Transparency -> TransparentIndex// root -> Transparency -> TransparentColor// root -> Transparency -> TileTransparencies// root -> Transparency -> TileTransparencies -> TransparentTile// root -> Transparency -> TileOpacities// root -> Transparency -> TileOpacities -> OpaqueTile// Node name, followed by description, or// Node name + "/" + AttributeName, followed by descriptionimport ImageInputStreamImpllong startingPos;int startingLength;this.startingPosthis.startingLengthint bytes/* Copyright (c) 2000, 2005, Oracle and/or its affiliates. All rights reserved. ... */// Local EOF// Empty finalizer (for improved performance; no need to call// super.finalize() in this case)import IIOInvalidTreeException// package scope...[] disposalMethodNames;int imageLeftPosition;// Fields from Image Descriptorint imageTopPosition;int imageWidth;int imageHeight;boolean interlaceFlag;boolean sortFlag;...[] localColorTable;int disposalMethod;// Fields from Graphic Control Extensionboolean userInputFlag;boolean transparentColorFlag;int delayTime;int transparentColorIndex;boolean hasPlainTextExtension;// Fields from Plain Text Extensionint textGridLeft;int textGridTop;int textGridWidth;int textGridHeight;int characterCellWidth;int characterCellHeight;int textForegroundColor;int textBackgroundColor;...[] text;List<> applicationIDs;// Fields from ApplicationExtensionList<> authenticationCodes;List<> applicationData;int numAppExtensionsint numCommentslocalColorTable.lengthtoISO8859(...)IIOMetadataNode appExtNodebyte[] applicationIDbyte[] authenticationCodebyte[] appDataIIOMetadataNode commentNodebyte[] commentIIOMetadataNode chroma_nodeIIOMetadataNode compression_nodeIIOMetadataNode data_nodeIIOMetadataNode dimension_node// Document not in imageIterator<> commentIterIIOMetadataNode text_nodeIIOMetadataNode transparency_node// scratch node// Image descriptor// Local color table// Graphic control extension// Application extensions// Comment extensions// Gamma not in format// BackgroundIndex not in image// BackgroundColor not in format// BitRate not in format// PlanarConfiguration not in format// BitsPerSample not in image// SignificantBitsPerSample not in format// SampleMSB not in format// PixelAspectRatio not in image// HorizontalPixelSize not in format// VerticalPixelSize not in format// HorizontalPhysicalPixelSpacing not in format// VerticalPhysicalPixelSpacing not in format// HorizontalPosition not in format// VerticalPosition not in format// HorizontalScreenSize not in image// VerticalScreenSize not in image// Alpha not in format// TransparentColor not in format// TileTransparencies not in format// TileOpacities not in formatGIFImageMetadata.nativeMetadataFormatNameGIFStreamMetadata.colorTableSizesGIFImageMetadata.disposalMethodNamesaddObjectValue(...)new GIFImageMetadataFormat(...)/* Copyright (c) 2001, 2004, Oracle and/or its affiliates. All rights reserved. ... */// root -> LocalColorTable// root -> LocalColorTable -> ColorTableEntry// root -> GraphicControlExtension// root -> PlainTextExtension// root -> ApplicationExtensions// root -> ApplicationExtensions -> ApplicationExtension/* Copyright (c) 2001, 2005, Oracle and/or its affiliates. All rights reserved. ... */import EOFExceptionimport ReaderUtil// The current ImageInputStream source.// True if the file header including stream metadata has been read.// Per-stream settingsGIFStreamMetadata streamMetadata;// Global metadata, read once per input setting.int currIndex;// The current image indexGIFImageMetadata imageMetadata;// Metadata for image at 'currIndex', or null.List<> imageStartPosition;// as needed.// start of the metadata for each image.  Entries are added// A List of Longs indicating the stream positions of theint imageMetadataLength;// imageMetadata != null.// Length of metadata for image at 'currIndex', valid only ifint numImages;// The number of images in the stream, if known, otherwise -1....[] block;// Variables used by the LZW decoding processint bitPos;int nextByte;int initCodeSize;int eofCode;int next32Bits;// 32-bit lookahead bufferboolean lastBlockFound;// and we are simply draining the 32-bit buffer// Try if the end of the data blocks has been found,BufferedImage theImage;// The image to be written.WritableRaster theTile;// The image's tile.int width, ...;// The image dimensions (from the stream).int streamX, ...;// The pixel currently being decoded (in the stream's coordinates).int rowsDone;// The number of rows decodedint interlacePass;// The current interlace pass, starting with 0....[] fallbackColorTable;...[] interlaceIncrement;// Constants used to control interlacing.// End per-stream settings...[] interlaceOffset;// Take input from an ImageInputStreamresetStreamSettings(...)this.numImageslocateImage(...)// and bump minIndex if required.// Throw an IndexOutOfBoundsException if index < minIndex,readMetadata(...)imageMetadata.imageWidthimageMetadata.imageHeight// since this method is private and we pass consistent data here// We don't check all parameters as ImageTypeSpecifier.createIndexed doimageMetadata.transparentColorFlagimageMetadata.transparentColorIndexList<> lbyte[] colorTablecolorTable.lengthint lutLengthint rgbIndeximageMetadata.localColorTablestreamMetadata.globalColorTablegetDefaultPalette(...)createIndexed(...)// BEGIN LZW STUFF// When the last block is found, we continue to// and extracted from the right.// a 32-bit lookahead buffer that is filled from the left// Load a block (1-255 bytes) at a time, and maintainreadUnsignedByte(...)int nbytesint sourceXSubsampling;int sourceYSubsampling;int sourceMinProgressivePass;int sourceMaxProgressivePass;Point destinationOffset;int updateMinY;// Used only if IIOReadUpdateListeners are presentint updateYStep;boolean decodeThisRow;int destY;...[] rowBuf;int widthint destXsetDataElements(...)int[] bandsthis.decodeThisRowoutputRow(...)imageMetadata.interlaceFlagstartPass(...)this.destYcomputeDecodeThisRow(...)// END LZW STUFFthis.streamMetadatanew GIFStreamMetadata(...)byte[] signatureStringBuffer versionint packedFieldsboolean globalColorTableFlagint numGCTEntriesstreamMetadata.versionstreamMetadata.logicalScreenWidthstreamMetadata.logicalScreenHeightstreamMetadata.colorResolutionstreamMetadata.sortFlagstreamMetadata.backgroundColorIndexstreamMetadata.pixelAspectRatioint labelEOFException eLong llongValue(...)Long l1new Long(...)skipImage(...)// Read blocks of 1-255 bytes, stop at a 0-length blockbyte[] newData// Stream must be positioned at start of metadata for 'currIndex'long startPositionthis.imageMetadatanew GIFImageMetadata(...)int idPackedFieldsboolean localColorTableFlagint numLCTEntriesimageMetadata.imageLeftPositionimageMetadata.imageTopPositionimageMetadata.sortFlagthis.imageMetadataLengthint gceLengthint gcePackedFieldsint terminatorimageMetadata.disposalMethodimageMetadata.userInputFlagimageMetadata.delayTimeimageMetadata.hasPlainTextExtensionimageMetadata.textGridLeftimageMetadata.textGridTopimageMetadata.textGridWidthimageMetadata.textGridHeightimageMetadata.characterCellWidthimageMetadata.characterCellHeightimageMetadata.textForegroundColorimageMetadata.textBackgroundColorimageMetadata.textconcatenateBlocks(...)imageMetadata.commentsint blockSizebyte[] authCodebyte[] blockDatacopyData(...)byte[] applicationDataapplicationData.lengthimageMetadata.applicationIDsimageMetadata.authenticationCodesimageMetadata.applicationDataIIOException iioeint restint yStepthis.updateMinYthis.updateYStepIterator<> imageTypesthis.theImagethis.theTilethis.streamXthis.streamYthis.rowsDonethis.interlacePassthis.sourceRegionthis.destinationRegionthis.destinationOffsetthis.sourceXSubsamplingthis.sourceYSubsamplingthis.sourceMinProgressivePassgetSourceMinProgressivePass(...)this.sourceMaxProgressivePassgetSourceMaxProgressivePass(...)this.rowBufint oldCodeint[] prefixbyte[] suffixbyte[] initialint[] lengthbyte[] stringint tableIndexint codeSizeint codeMaskthis.initCodeSizethis.bitPosthis.nextBytethis.lastBlockFoundinitNext32Bits(...)this.clearCodethis.eofCodeinitializeStringTable(...)getCode(...)int newSuffixIndexint tiint ocoutputPixels(...)/** Remove all settings including global settings such as ... *//** Remove local settings based on parsing of a stream. */...[] defaultPalette;// Clear all values based on the previous stream contents// Some files erroneously have a transparent color index// of 255 even though there are fewer than 256 colors.// no color table, the spec allows to use any palette.// Normalize color table length to 2^1, 2^2, 2^4, or 2^8// Bump from 3 to 4 bits// Bump to 8 bits// Entries from length + 1 to lutLength - 1 will be 0// No more data available// Shift in a byte of new data at a time// Check if current block is out of bytes// Get next block size// Fill in the entire table for robustness against// out-of-sequence codes.// tableIndex = numEntries + 2;// codeSize = initCodeSize + 1;// codeMask = (1 << codeSize) - 1;// Clip against ImageReadParam// Update IIOReadUpdateListeners, if any// updateYStep will have been initialized if// updateListeners is non-null// Process end-of-row// Update IIOReadProgressListeners// Inform IIOReadUpdateListeners of end of pass// Determine whether pixels from this row will// be written to the destination// Create an object to store the stream metadata// Found position of metadata for image 0// Stream must be at the beginning of an image descriptor// upon exit// Skip color table if any// EOF// Find closest known index// Seek to that position// Skip images until at desired index or last image found// Create an object to store the image metadata// Image Descriptor// Read color table if any// Record length of this metadata block// Now positioned at start of LZW-compressed pixels// Extension block// Graphics Control Extension// 4// Plain text extension// Comment extension// Application extension// read available data// Init lists if necessary// Skip over unknown extension blocks// Trailer// Initialized updateMinY and updateYStep// Inform IIOReadUpdateListeners of new pass// A null ImageReadParam means we use the default// Initialize the destination image// Get source region, taking subsampling offsets into account,// and clipping against the true source bounds// Inform IIOReadProgressListeners of start of image// Read and decode the image data, fill in theImage// Read first data block// Init 32-bit buffer// Inform IIOReadProgressListeners of end of image// code == tableIndex// warning - code out of sequence// possibly data corruption// Reverse code// No need to reinitialize 'block'String vendorName;String version;...[] names;...[] suffixes;...[] MIMETypes;String readerClassName;GIFStreamMetadata.nativeMetadataFormatNamenew GIFImageReader(...)/* Copyright (c) 2000, 2010, Oracle and/or its affiliates. All rights reserved. ... */import NodeListimport LZWCompressorimport PaletteBuilderimport ByteComponentRasterGIFWritableStreamMetadata.NATIVE_FORMAT_NAMEGIFWritableImageMetadata.NATIVE_FORMAT_NAMEboolean DEBUG;String STANDARD_METADATA_NAME;// XXX false for release!String STREAM_METADATA_NAME;String IMAGE_METADATA_NAME;/** The <code>output</code> case to an <code>ImageOutputStream</code>. */boolean isWritingSequence;/** Whether a sequence is being written. */boolean wroteSequenceHeader;/** Whether the header has been written. */GIFWritableStreamMetadata theStreamMetadata;/** The stream metadata of a sequence. */int imageIndex;/** The index of the image being written. *//** The number of bits represented by the value which should be a ... */int numBits/** Compute the source region and destination dimensions taking any ... */int periodXint periodYint gridXint gridYsourceBands.lengthsetBounds(...)sourceBounds.xsourceBounds.ysourceBounds.widthsourceBounds.heightsetSize(...)destSize.widthdestSize.height/** Create a color table from the image ColorModel and SampleModel. */int mapSizeint ctSizegetGifPaletteSize(...)byte[] redsbyte[] greensbyte[] bluesint colorTableLength/** According do GIF specification size of clor table (palette here) ... *//** Merges <code>inData</code> into <code>outData</code>. The supplied ... */String formatNameString nativeFormatNamegetNativeMetadataFormatName(...)String[] extraFormatNamesgetExtraMetadataFormatNames(...)extraFormatNames.lengthisStandardMetadataFormatSupported(...)Node rootgetAsTree(...)mergeTree(...)IIOInvalidTreeException e/** Creates a default stream metadata object and merges in the ... */IIOMetadata smgetDefaultStreamMetadata(...)convertMetadata(...)/** Creates a default image metadata object and merges in the ... */GIFWritableImageMetadata imboolean isProgressiveim.interlaceFlagcanWriteProgressive(...)getProgressiveMode(...)param.MODE_COPY_FROM_METADATAwriteTrailer(...)resetLocal(...)GIFWritableImageMetadata imageMetadatanew GIFWritableImageMetadata(...)Rectangle sourceBoundsDimension destSizeImageWriteParam.MODE_DISABLEDcreateColorTable(...)int transparentIndexgetTransparentPixel(...)GIFWritableStreamMetadata streamMetadatanew GIFWritableStreamMetadata(...)new GIFImageWriteParam(...)getLocale(...)this.theStreamMetadatathis.isWritingSequence/** Resets locally defined instance variables. */this.wroteSequenceHeaderthis.imageIndexconvertStreamMetadata(...)getComponentSize(...)/** Writes any extension blocks, the Image Descriptor, the image data, ... */RenderedImage imagebyte[] globalColorTableneedToCreateIndex(...)createIndexedImage(...)setRenderedImage(...)GIFMetadata.UNDEFINED_INTEGER_VALUEgetNumBits(...)globalColorTable.lengthimageMetadata.localColorTable.lengthwriteHeader(...)theStreamMetadata.globalColorTablewriteImage(...)/** Writes any extension blocks, the Image Descriptor, and the image data ... */boolean writeGraphicsControlExtensionNodeList listgetElementsByTagName(...)IllegalArgumentException iaewriteGraphicControlExtension(...)writePlainTextExtension(...)writeApplicationExtension(...)writeCommentExtension(...)writeImageDescriptor(...)writeRasterData(...)int[] sbufbyte[] dbufRaster rastergetTile(...)getNumXTiles(...)getNumYTiles(...)getSamples(...)compress(...)int sourceXOffsetint sourceYOffsetint sourceWidthint sourceHeightint destWidthint destHeightint initCodeSizeLZWCompressor compressornew LZWCompressor(...)boolean isOptimizedCaseint numRowsWrittenint progressReportRowPeriodByteComponentRaster tilegetDataOffset(...)writeRowsOpt(...)writeRows(...)Raster tilewriteBytes(...)GIFWritableStreamMetadata smsetFromTree(...)sm.versionsm.logicalScreenWidthsm.logicalScreenHeightsm.colorResolutionsm.pixelAspectRatiosm.backgroundColorIndexsm.sortFlagsm.globalColorTableim.disposalMethodim.userInputFlagim.transparentColorFlagim.delayTimeim.transparentColorIndexim.hasPlainTextExtensionim.textGridLeftim.textGridTopim.textGridWidthim.textGridHeightim.characterCellWidthim.characterCellHeightim.textForegroundColorim.textBackgroundColorwriteBlocks(...)im.textim.applicationIDsIterator<> iterIDsIterator<> iterCodesim.authenticationCodesIterator<> iterDataim.applicationDataim.commentsIterator<> iterthis.canWriteCompressedthis.canWriteProgressivethis.compressionTypesthis.compressionTypesetCompressionMode(...)// Get source region and subsampling factors// Clip to actual image bounds// Adjust for subsampling offsets// Get subsampling factors// Compute output dimensions/** The GIF image format assumes that size of image palette ... *//** fill tail of color component arrays by replica of first color ... */// create gray-scaled color table for single-banded images// We do not have enough information here// to create well-fit color table for RGB image.// ignore// Save interlace flag state.// Undo change to interlace flag if not MODE_COPY_FROM_METADATA.// Image dimensions// Interlacing// Transparency// Save the possibly converted stream metadata as an instance variable.// Check for ability to encode image.// Determine source region and destination dimensions.// Convert any provided image metadata.// Converted rgb image can use palette different from global.// In order to avoid color artefacts we want to be sure we use// appropriate palette. For this we initialize local color table// from current color and sample models.// At this point we can guarantee that local color table can be// build because image was already converted to indexed or// gray-scale representations// in case of indexed image we should take care of// transparent pixels/* NB: transparentColorFlag might have not beed reset for ... */// Global color table values.// Write the header (Signature+Logical Screen Descriptor+// Global Color Table).// Set the version if not set.// Set the Logical Screen Desriptor if not set.// Set the Global Color Table if not set, i.e., if not// provided in the stream metadata.// Writing a sequence and a local color table was// provided in the metadata of the first image: use it.// Create a color table.// Set the Global Color Table. At this point it should be// A) the global color table provided in stream metadata, if any;// B) the local color table of the image metadata, if any, if//    writing a sequence;// C) a table created on the basis of the first image ColorModel//    and SampleModel if no local color table is available; or// D) null if none of the foregoing conditions obtain (which//    should only be if a sequence is not being written and//    a local color table is provided in image metadata).// Write the header.// Write extension blocks, Image Descriptor, and image data.// Write the trailer.// Create default metadata.// Set GraphicControlExtension flag only if there is// transparency.// Check for GraphicControlExtension element.// Set GraphicControlExtension flag if element present.// If progressive mode is not MODE_COPY_FROM_METADATA, ensure// the interlacing is set per the ImageWriteParam mode setting.// Unset local color table if equal to global color table.// Override dimensions// Write Graphics Control Extension.// Write extension blocks.// Write Image Descriptor// Write image data/* At this moment we know that input image is indexed image. ... */// take into account the raster data offset// Signature// Screen Descriptor// Width// Height// Global Color Table// Packed fields// Background color index// Pixel aspect ratioString writerClassName;ColorModel cmboolean canEncodenew GIFImageWriter(...)/* Copyright (c) 2005, 2010, Oracle and/or its affiliates. All rights reserved. ... *//** Class which adds utility DOM element attribute access methods to ... */int UNDEFINED_INTEGER_VALUE;/** Represents an undefined value of integer attributes. */// Shorthand for throwing an IIOInvalidTreeException// com.sun.imageio.plugins.png.PNGMetadata and modified.// Note: These attribute methods were shamelessly lifted fromnew IIOInvalidTreeException(...)// Get an integer-valued attributeNode attrgetNamedItem(...)getAttributes(...)getNodeValue(...)fatal(...)boolean validValuerange.lengthgetNodeName(...)getStringAttribute(...)int intValue// Get a float-valued attributeparseFloat(...)// Get a required integer-valued attributegetIntAttribute(...)// Get a required float-valued attributegetFloatAttribute(...)// Get a boolean-valued attribute// Get a required boolean-valued attributegetBooleanAttribute(...)// Get an enumerated attribute as an index into a String arraylegalNames.length// Get a required enumerated attribute as an index into a String arraygetEnumeratedAttribute(...)// Get a String-valued attribute// Get a required String-valued attributegetAttribute(...)mergeNativeTree(...)mergeStandardTree(...)int maxIndexNode entrygetFirstChild(...)getNextSibling(...)// Allow lower case booleans for backward compatibility, #5082756// TODO - document elimination of globalColorTableFlag...[] versionStrings;int logicalScreenWidth;// 87a or 89aint logicalScreenHeight;int colorResolution;int pixelAspectRatio;// 1 to 8int backgroundColorIndex;// Valid if globalColorTable != null...[] colorTableSizes;...[] globalColorTable;// Set global color table flag in header to 0 if null, 1 otherwisefloat aspectRatioIIOMetadataNode document_node/* NB: At the moment we use empty strings to support undefined ... */// Stored value plus one// NumChannels not in stream// backgroundColorIndex is valid iff there is a color table// NumProgressiveScans not in stream// PlanarConfiguration// SignificantBitsPerSample// SampleMSB// HorizontalPixelOffset not in stream// VerticalPixelOffset not in stream// SubimageInterpretation not in format// ImageCreationTime not in format// ImageModificationTime not in format// Not in streamGIFStreamMetadata.versionStringsnew GIFStreamMetadataFormat(...)// root -> Version// root -> LogicalScreenDescriptor// root -> GlobalColorTable// root -> GlobalColorTable -> ColorTableEntryString NATIVE_FORMAT_NAME;int sizeOfLocalColorTablegetColorTable(...)String disposalMethodNameString textStringfromISO8859(...)IIOMetadataNode applicationExtensionString applicationIDStringString authenticationCodeStringObject applicationExtensionDatagetUserObject(...)Node commentExtensionString commentNode childNodeString childNameint numProgressiveScansisSupported(...)/* Copyright (c) 2005, 2008, Oracle and/or its affiliates. All rights reserved. ... */// XXX The "text" attribute of the PlainTextExtension element// is not defined in the GIF image metadata format but it is// present in the GIFImageMetadata class. Consequently it is// used here but not required and with a default of "". See// bug 5082763.int sizeOfGlobalColorTableint ratioString formatVersionversionStrings.length/* The source for this class was copied verbatim from the source for ... */// XXX J2SE// initialize metadata fields by default valuesimport NamedNodeMap/** An Adobe APP14 (Application-Specific) marker segment. */int flags0;int flags1;int transform;int ID_SIZE;JPEG.APP14this.transformbuffer.bufPtrbuffer.bufbuffer.bufAvailupdateFromNativeNode(...)NamedNodeMap attrsgetAttributeValue(...)/** Writes the data for this segment to the stream in ... */byte[] idwriteTag(...)write2bytes(...)new AdobeMarkerSegment(...)printTag(...)/* Copyright (c) 2001, Oracle and/or its affiliates. All rights reserved. ... */// Skip the id// default transform will be changed// Only the transform is required/** A Comment marker segment.  Retains an array of bytes representing the ... */String ENCODING;/** Constructs a marker segment from the given buffer, which contains ... */loadData(...)/** Constructs a marker segment from a String.  This is used when ... */JPEG.COM/** Constructs a marker segment from a native tree node.  If the node ... */IIOMetadataNode ourNode/** Returns the array encoded as a String, using ISO-Latin-1 encoding. ... *//** Returns an <code>IIOMetadataNode</code> containing the data array ... */getComment(...)// Default encoding// Won't happenimport JPEGHuffmanTable/** A DHT (Define Huffman Table) marker segment. */List<> tables;JPEG.DHTnew Htable(...)JPEGHuffmanTable.StdDCLuminanceJPEGHuffmanTable.StdDCChrominanceJPEGHuffmanTable.StdACLuminanceJPEGHuffmanTable.StdACChrominanceHtable newGuynewGuy.values.lengthnewGuy.valuesdcTables.lengthacTables.lengthNodeList childrengetChildNodes(...)item(...)DHTMarkerSegment newGuynewGuy.tablesHtable tablegetNativeNode(...)/** A Huffman table within a DHT marker segment. */int tableClass;int tableID;// 0 == DC, 1 == ACint NUM_LENGTHS;// 0 - 4...[] numCodes;// # of codes of each lengthint numValuesgetLengths(...)getValues(...)JPEGHuffmanTable tableCloneNotSupportedException enewGuy.numCodesnew JPEGHuffmanTable(...)// We don't write DHT segments; the IJG library does.// won't happen/* System.out.print("Lengths:"); ... */import JPEGQTable/** A DQT (Define Quantization Table) marker segment. */// Could be 1 to 4JPEG.DQTnew Qtable(...)Qtable newGuynewGuy.data.lengthnewGuy.dataqtables.lengthDQTMarkerSegment newGuyQtable table/** Assuming the given table was generated by scaling the "standard" ... */boolean allSameluma.QTABLE_SIZEluma.datanewGuy.tableIDint largestPosfloat scaleFactorgetTable(...)JPEGQTable.K1Div2LuminanceJPEGQTable jpegTablegetScaledInstance(...)JPEGQTable.K2Div2Chrominance/** A quantization table within a DQT marker segment. */int elementPrecision;int QTABLE_SIZE;...[] data;...[] zigzag;/** The zigzag-order position of the i'th element ... */// 64 elements, in natural orderJPEGQTable baseJPEG.DEFAULT_QUALITYconvertToLinearQuality(...)JPEGQTable.K1LuminanceJPEGQTable tablenew JPEGQTable(...)// We don't write DQT segments; the IJG library does.// Determine if the table is all the same values// if so, use the same table// Otherwise, find the largest coefficient less than 255.  This is// the largest value that we know did not clamp on scaling.// Compute the scale factor by dividing it by the value in the// same position from the "standard" table.// If the given table was not generated by scaling the standard,// the resulting table will still be reasonable, as it will reflect// a comparable scaling of chrominance frequency response of the// eye.//    generate a new table// IJG is compiled for 8-bits, so this shouldn't happen// Read from zig-zag order to natural order/* for (int i = 0; i < 64; i++) { ... *//** A DRI (Define Restart Interval) marker segment. */int restartInterval;/** Restart interval, or 0 if none is specified. */JPEG.DRI// We don't write DRI segments; the IJG library does.import MemoryCacheImageOutputStream/** A JFIF (JPEG File Interchange Format) APP0 (Application-Specific) ... */int resUnits;int Xdensity;int Ydensity;int thumbWidth;int thumbHeight;JFIFThumbRGB thumb;ArrayList<> extSegments;// If presentICCMarkerSegment iccSegment;int THUMB_JPEG;// optional ICCint THUMB_PALETTE;int THUMB_UNASSIGNED;int THUMB_RGB;int DATA_SIZE;int MAX_THUMB_WIDTH;int MAX_THUMB_HEIGHT;boolean inICC;/** Set to <code>true</code> when reading the chunks of an ... */ICCMarkerSegment tempICCSegment;/** A placeholder for an ICC profile marker segment under ... *//** Default constructor.  Used to create a default JFIF header */JPEG.APP0JPEG.DENSITY_UNIT_ASPECT_RATIO/** Constructs a JFIF header by reading from a stream wrapped ... */new JFIFThumbRGB(...)/** Constructs a JFIF header from a DOM Node. *//** Returns a deep-copy clone of this object. */JFIFMarkerSegment newGuynewGuy.extSegmentsJFIFExtensionMarkerSegment jfxxnewGuy.iccSegment/** Add an JFXX extension marker segment from the stream wrapped ... */new JFIFExtensionMarkerSegment(...)/** Adds an ICC Profile APP2 segment from the stream wrapped ... */new ICCMarkerSegment(...)addData(...)/** Add an ICC Profile APP2 segment by constructing it from ... *//** Returns a tree of DOM nodes representing this object and any ... */IIOMetadataNode JFXXnodeJFIFExtensionMarkerSegment seg/** Updates the data in this object from the given DOM Node tree. ... */hasChildNodes(...)NodeList extsint extCountNode extjfxx.thumbBufferedImage retthumbnailStarted(...)getThumbnail(...)thumbnailComplete(...)int thumbWidthint thumbHeightint thumbLengthint[] thumbDatawarningOccurred(...)JPEGImageWriter.WARNING_THUMB_CLIPPEDthumbData.lengthwriteThumbnailData(...)/* Write out the values in the integer array as a sequence of bytes, ... */int progIntervalthumbnailProgress(...)/** Write out this JFIF Marker Segment, including a thumbnail or ... */writeThumb(...)ColorSpace csgetColorSpace(...)jfxx.codewriteJFXXSegment(...)BufferedImage thumbRGBconvertToIntDiscrete(...)setThumbnail(...)ColorSpace.TYPE_RGBJPEGImageWriter.WARNING_NO_RGB_THUMB_AS_INDEXEDexpandGrayThumb(...)JPEGImageWriter.WARNING_NO_GRAY_THUMB_AS_INDEXEDJPEGImageWriter.WARNING_ILLEGAL_THUMBNAIL// in order to provide more meaningful warnings.// Could put reason codes in here to be parsed in writeJFXXSegment/** Writes out a new JFXX extension segment, without saving it. */IllegalThumbException e/** Return an RGB image that is the expansion of the given grayscale ... */BufferedImage.TYPE_INT_RGBGraphics ggetGraphics(...)/** Writes out a default JFIF marker segment to the given ... */JFIFMarkerSegment jfifnew JFIFMarkerSegment(...)writeWithThumbs(...)writeICC(...)/** Prints out the contents of this object to System.out for debugging. */JFIFExtensionMarkerSegment extSegment/** A JFIF extension APP0 marker segment. */JFIFThumb thumb;new JFIFThumbJPEG(...)int thumbXint thumbYloadBuf(...)new JFIFThumbPalette(...)int csTypehasAlpha(...)new IllegalThumbException(...)new InternalError(...)JFIFExtensionMarkerSegment newGuynewGuy.thumb/** A superclass for the varieties of thumbnails that can ... */long streamPos;// Save the thumbnail pos when reading// When writingBufferedImage thumbnail;skipData(...)float percentDone/** A JFIF thumbnail stored as RGB, one byte per channel, ... */DataBufferByte buffernew DataBufferByte(...)createInterleavedRaster(...)JPEG.JCS.sRGBColorModel.OPAQUEJPEG.JCSreadByteBuffer(...)/** A JFIF thumbnail stored as an indexed palette image ... */int PALETTE_SIZE;byte[] palettefloat palettePartIndexColorModel cm/** A JFIF thumbnail stored as a JPEG stream.  No JFIF or ... */JPEGMetadata thumbMetadata;int PREAMBLE_SIZE;// Compressed image data, for writinglong finalPosbuffer.iisnew JPEGMetadata(...)setFromMarkerSequenceNode(...)int INITIAL_BUFSIZEint MAZ_BUFSIZEByteArrayOutputStream baosMemoryCacheImageOutputStream mosnew MemoryCacheImageOutputStream(...)JPEGImageWriter thumbWriternew JPEGImageWriter(...)JPEGMetadata metadataMarkerSegment jfiffindMarkerSegment(...)metadata.markerSequencenew IIOImage(...)SOFMarkerSegment sofsof.samplesPerLinesof.numLinesJPEGImageReader reader;this.readerJPEGImageReader thumbReadernew JPEGImageReader(...)new ThumbnailReadListener(...)JFIFThumbJPEG newGuynewGuy.thumbMetadata/** Write out the given profile to the stream, embedded in ... */int LENGTH_LENGTHString IDint ID_LENGTHint COUNTS_LENGTHint MAX_ICC_CHUNK_SIZEint numChunksint chunkNumint dataLengthint segLengthJPEG.APP2/** An APP2 marker segment containing an ICC profile.  In the stream ... */ArrayList<> chunks;...[] profile;// May remain null when writing// The complete profile when it's fully readint chunksRead;int numChunks;getProfile(...)readData(...)byte[] profileDataICC_Profile profICCMarkerSegment newGuynewGuy.profileint dataLenint newNumChunksboolean retvalboolean foundItint chunkbyte[] chunkDatachunkData.length/** No-op.  Profiles are never written from metadata. ... */// skip the id, we already checked it// Clone the list with a deep copy// Just one chunk// none of the attributes are required// No thumbnail// Clip if necessary and get the data in thumbData// approx. every 5%// All others write as separate JFXX segments// Just the header without any thumbnail// No thumbnails// We never write a palette image into the header// So if it's the only one, we need to write the header first// default// Expand to RGB// Handles clipping if needed// As part of the header// If this is the only one, write the header first// following constructors handle bufAvail// Now the child// Save the stream position for reading the thumbnail later// Now skip the thumbnail data// not used when writing// width and height// read the palette// Write the palette (must be 768 bytes)// Compute the final stream position// Set the stream back to the start of the thumbnail// and read its metadata (but don't decode the image)// Set the stream to the computed final position// Clear the now invalid buffer// get default metadata for the thumb// Remove the jfif segment, which should be there./* Use this if removing leaves a hole and causes trouble ... */// Now check that the size is OK// spec says it's null-terminated// Null-terminate the string// gets whole segment or fills the buffer/* Reduce the stored length by the id size.  The stored ... */// get the chunk number// get the total number of chunks// if there are no more chunks, set up the data// reduce the stored length by the two chunk numbering bytes// If we store them away, include the chunk numbering bytes// Now reduce the stored length by the// two chunk numbering bytes// May be null// skip the tag// Get the length, but not in length// Don't include length itself// skip the id// get the number of chunks, which should match// create an array for the whole thing// copy the existing chunks, releasing them// Note that they may be out of order// Right one// No-op/** A class containing JPEG-related constants, definitions, and ... */int TEM;/** For temporary use in arithmetic coding */// List of all the JPEG markers (pre-JPEG2000)int SOF0;/** Baseline DCT */// SOF markers for Nondifferential Huffman coding// Codes 0x02 - 0xBF are reservedint SOF1;/** Extended Sequential DCT */int SOF2;/** Progressive DCT */int SOF3;/** Lossless Sequential */int DHT;/** Define Huffman Tables */int SOF5;/** Differential Sequential DCT */// SOF markers for Differential Huffman codingint SOF6;/** Differential Progressive DCT */int SOF7;/** Differential Lossless */int JPG;/** Reserved for JPEG extensions */int SOF9;/** Extended Sequential DCT, Arithmetic coding */// SOF markers for Nondifferential arithmetic codingint SOF10;/** Progressive DCT, Arithmetic coding */int SOF11;/** Lossless Sequential, Arithmetic coding */int DAC;/** Define Arithmetic conditioning tables */int SOF13;/** Differential Sequential DCT, Arithmetic coding */// SOF markers for Differential arithmetic codingint SOF14;/** Differential Progressive DCT, Arithmetic coding */int SOF15;/** Differential Lossless, Arithmetic coding */int RST0;// Restart Markersint RST1;int RST2;int RST3;int RST4;int RST5;int RST6;int RST7;int RESTART_RANGE;/** Number of restart markers */int SOI;/** Start of Image */int EOI;/** End of Image */int SOS;/** Start of Scan */int DQT;/** Define Quantisation Tables */int DNL;/** Define Number of lines */int DRI;/** Define Restart Interval */int DHP;/** Define Heirarchical progression */int EXP;/** Expand reference image(s) */int APP0;/** APP0 used by JFIF */// Application markersint APP1;int APP2;int APP3;int APP4;int APP5;int APP6;int APP7;int APP8;int APP9;int APP10;int APP11;int APP12;int APP13;int APP14;/** APP14 used by Adobe */int APP15;int COM;/** Comment marker */// codes 0xF0 to 0xFD are reservedint DENSITY_UNIT_ASPECT_RATIO;/** The X and Y units simply indicate the aspect ratio of the pixels. */// JFIF Resolution unitsint DENSITY_UNIT_DOTS_INCH;/** Pixel density is in pixels per inch. */int DENSITY_UNIT_DOTS_CM;/** Pixel density is in pixels per centemeter. */int NUM_DENSITY_UNIT;/** The max known value for DENSITY_UNIT */int ADOBE_IMPOSSIBLE;// Adobe transform valuesint ADOBE_UNKNOWN;int ADOBE_YCC;int ADOBE_YCCK;String vendor;// Spi initialization stuff// Names of the formats we can read or writeString nativeImageMetadataFormatName;String nativeImageMetadataFormatClassName;String nativeStreamMetadataFormatName;String nativeStreamMetadataFormatClassName;int JCS_UNKNOWN;// IJG Color codes.int JCS_GRAYSCALE;// error/unspecifiedint JCS_RGB;// monochromeint JCS_YCbCr;// red/green/blueint JCS_CMYK;// Y/Cb/Cr (also known as YUV)int JCS_YCC;// C/M/Y/Kint JCS_RGBA;// PhotoYCCint JCS_YCbCrA;// RGB-Alphaint JCS_YCCA;// on reading anyway.  Support for writing them is being dropped, too.// 8 and 9 were old "Legacy" codes which the old code never identified// Y/Cb/Cr/Alphaint JCS_YCCK;// PhotoYCC-Alphaint NUM_JCS_CODES;// Y/Cb/Cr/K...[] bandOffsets;/** IJG can handle up to 4-channel JPEGs */...[] bOffsRGB;/* These are kept in the inner class to avoid static initialization ... */ColorSpace sRGB;ColorSpace YCC;boolean yccInited;ColorSpace.CS_PYCCfloat DEFAULT_QUALITY;// Default value for ImageWriteParam/** Returns <code>true</code> if the given <code>ColorSpace</code> ... */isCS_sRGB(...)ColorSpace.CS_CIEXYZColorSpace.CS_LINEAR_RGB/** Returns <code>true</code> if the given imageType can be used ... */int numComponentsColorSpace.TYPE_YCbCr/** Given an image type, return the Adobe transform corresponding to ... */ColorSpace.TYPE_CMYK/** Converts an ImageWriteParam (i.e. IJG) non-linear quality value ... *//** Return an array of default, visually lossless quantization tables. */JPEGQTable[] qTablesnew JPEGQTable[]/** Return an array of default Huffman tables. */JPEGHuffmanTable[] tablesnew JPEGHuffmanTable[]// PYCC.pf may not always be installed// Can't have alpha// Gray is OK, always// If it isn't gray, it must have 3 channels// Must be RGB// Must be YCbCr// The following is converted from the IJG code./** A class wrapping a buffer and its state.  For efficiency, ... */int BUFFER_SIZE;/** The size of the buffer.  This is large enough to hold all ... */...[] buf;/** The actual buffer. */int bufAvail;/** The number of bytes available for reading from the buffer. ... */int bufPtr;/** A pointer to the next available byte in the buffer.  This is ... *//** The ImageInputStream buffered. */this.iis/** Ensures that there are at least <code>count</code> bytes available ... */int retint minimum/** Fills the data array from the stream, starting with ... *//** Skips <code>count</code> bytes, leaving the buffer ... *//** Push back the remaining contents of the buffer by ... *//** Return the stream position corresponding to the next ... *//** Scan the buffer until the next 0xff byte, reloading ... */boolean foundFFJPEG.EOI/** Prints the contents of the buffer, in hex. ... */int ptr// have enough// already full// First copy any remaining bytes down to the beginning// Now fill the rest of the buffer// First see what's left in the buffer.// It's enough// Some there, but not enough// Now read the rest directly from the stream// out of inner while// Reload the buffer and keep going// Skip any remaining pad bytes// Only if it still is 0xff// Premature EOF// send out a warning, but treat it as EOI//reader.warningOccurred(JPEGImageReader.WARNING_NO_EOI);JPEGImageMetadataFormat theInstance;List<> resUnitsList<> codesList<> transformsList<> procsList<> compsList<> tabidsJPEG.nativeImageMetadataFormatNameaddStreamElements(...)addChildElement(...)isInSubtree(...)getRootName(...)isJFIFcompliant(...)new JPEGImageMetadataFormat(...)// Hex 10// Hex 11// Hex 13// All images can have these// If it is an element in the app0jfif subtree, just check// that the image type is JFIF compliant....[] imageContents;Object[][] combinedContentscommonContents.lengthimageContents.lengthint combined// return a copy of the combined commonContents and imageContents;// in theory we want a deep clone of the combined arrays,// but since it only contains (immutable) Strings, this shallow// copy is sufficientimport JPEGImageReadParamimport CMMExceptionimport ColorConvertOpimport NoSuchElementExceptionimport Disposerimport DisposerRecordnew Object(...)new CallBackLock(...)loadLibrary(...)initReaderIDs(...)long structPointer;/** The following variable contains a pointer to the IJG library ... *//** The input stream we read from */List<> imagePositions;/** List of stream positions for images, reinitialized every time ... *//** The number of images in the stream, or 0. */int WARNING_NO_EOI;/** Warning code to be passed to warningOccurred to indicate ... */// and its children.// as keys to get localized resources from JPEGImageReaderResources// The following warnings are converted to strings when usedint WARNING_NO_JFIF_IN_THUMB;int WARNING_IGNORE_INVALID_ICC;int MAX_WARNING;int currentImage;/** Image index of image for which header information ... *//** Set by setImageData native code callback */// if we are to read an image at all.// Unlike metadata, which may never be retrieved, we need this// The following is copied out from C after reading the header.int colorSpaceCode;/** Set by setImageData native code callback.  A modified ... */int outColorSpaceCode;int numComponents;ColorSpace iccCS;ColorConvertOp convert;/** If we need to post-convert in Java, convert with this op */BufferedImage image;/** The image we are going to fill */WritableRaster raster;/** An intermediate Raster to hold decoded data */WritableRaster target;/** A view of our target Raster that we can setRect to */DataBufferByte buffer;/** The databuffer for the above Raster */Rectangle destROI;/** The region in the destination where we will write pixels */...[] destinationBands;/** The list of destination bands, if any */JPEGMetadata streamMetadata;/** Stream metadata, cached, even when the stream is changed. */JPEGMetadata imageMetadata;/** Image metadata, valid for the imageMetadataIndex only. */int imageMetadataIndex;boolean haveSeeked;/** Set to true every time we seek in the stream; used to ... */...[] abbrevQTables;/** Tables that have been read from a tables-only image at the ... */...[] abbrevDCHuffmanTables;...[] abbrevACHuffmanTables;int minProgressivePass;int maxProgressivePass;int UNKNOWN;/** Variables used by progress monitoring. */int MIN_ESTIMATED_PASSES;// Number of passesint knownPassCount;// IJG defaultint pass;float percentToDate;float previousPassPercentage;int progInterval;boolean tablesOnlyChecked;/** Set to true once stream has been checked for stream metadata */Object disposerReferent;/** The referent to be registered with the Disposer. */DisposerRecord disposerRecord;/** The DisposerRecord that handles the actual disposal of this reader. *//** Sets up static C structures. */initJPEGImageReader(...)new JPEGReaderDisposerRecord(...)addRecord(...)/** Sets up per-reader C structure and returns a pointer to it. *//** Called by the native code or other classes to signal a warning. ... */lock(...)unlock(...)/** The library has it's own error facility that emits warning messages. ... */setThreadLock(...)check(...)this.ignoreMetadataresetInternalState(...)setSource(...)clearThreadLock(...)/** This method is called from native code in order to fill ... *//** This method is called from the native code in order to ... */long savePosboolean tablesOnlyreadNativeHeader(...)long poshasNextImage(...)Long posgetNumImagesOnThread(...)JPEGBuffer buffernew JPEGBuffer(...)boolean donecheckTablesOnly(...)gotoImage(...)scanForFF(...)JPEG.SOIJPEG.RST0JPEG.RST1JPEG.RST2JPEG.RST3JPEG.RST4JPEG.RST5JPEG.RST6JPEG.RST7/** Sets the input stream to the start of the requested image. ... *//** Skip over a complete image in the stream, leaving the stream ... */int byteval/** Returns <code>true</code> if there is an image beyond ... *//** Push back the given number of bytes to the input stream. ... *//** Reads header information for the given image, if possible. */readImageHeader(...)/** Read in the header information starting from the current ... *//* Called by the native code whenever an image header has been ... */ICC_Profile newProfileICC_Profile oldProfilebyte[] oldDatathis.colorSpaceCodethis.outColorSpaceCodethis.numComponentsfloat[] colorsfromRGB(...)CMMException e/** Return an ImageTypeSpecifier corresponding to the given ... *//////////// Color Conversion and Image TypesImageTypeProducer retJPEG.NUM_JCS_CODESgetTypeProducer(...)getImageType(...)getImageTypesOnThread(...)ImageTypeProducer rawArrayList<ImageTypeProducer> listnew ArrayList<ImageTypeProducer>(...)JPEG.JCS_GRAYSCALEJPEG.JCS_RGBJPEG.JCS_YCCJPEG.JCS_RGBAJPEG.JCS_YCCAJPEG.JCS_YCbCrcreateInterleaved(...)JPEG.bOffsRGBJPEG.JCS_YCbCrAnew ImageTypeIterator(...)/** Checks the implied color conversion between the stream and ... */setOutColorSpace(...)new ColorConvertOp(...)ColorSpace YCCgetYCC(...)/** Set the IJG output space to the given value.  The library will ... *//////// End of Color Conversion & Image Typesnew JPEGImageReadParam(...)readInternal(...)RuntimeException eresetLibraryState(...)WritableRaster imRasint numImageBandsint[] srcBandsJPEG.bandOffsetsint numRasterBandsRectangle srcROIint lineSizedestROI.widthint[] bandOffsint[] bandSizesboolean callbackUpdatesboolean abortedcheckColorConversion(...)checkReadParamBandSettings(...)int[] sBandssrcBands.lengthJPEGImageReadParam jparamareTablesSet(...)getQTables(...)getDCHuffmanTables(...)getACHuffmanTables(...)destROI.heightbandSizes.lengthinitProgressData(...)imageMetadata.markerSequencedestinationBands.lengthreadImage(...)srcROI.xsrcROI.ysrcROI.widthsrcROI.height/** This method is called back from C when the intermediate Raster ... */filter(...)destROI.xdestROI.yint heightfloat percentOfPassint remainingPassesint totalPassesthis.passprocessThumbnailStarted(...)// Provide access to protected superclass methodprocessThumbnailProgress(...)processThumbnailComplete(...)/** Returns <code>true</code> if the read was aborted. */abort(...)abortRead(...)/** Set the C level abort flag. Keep it atomic for thread safety. *//** Resets library state when an exception occurred during a read. */Raster retvalPoint saveDestOffsetcreateWritableTranslatedChild(...)saveDestOffset.xsaveDestOffset.ygetImageMetadata(...)jfif.thumbjfif.extSegmentsgetNumThumbnails(...)getThumbnailWidth(...)getThumbnailHeight(...)resetReader(...)this.pDatadisposeReader(...)Thread theThread;int theLockCount;Thread currThreadCallBackLock cbLock;State lockState;State.UnlockedState.Lockednew State(...)State Unlocked;State Locked;/** An internal helper class that wraps producer's iterator ... */Iterator<ImageTypeProducer> producers;ImageTypeSpecifier theNext;this.producersImageTypeSpecifier tnew NoSuchElementException(...)/** An internal helper class that provides means for deferred creation ... */new ImageTypeProducer[]ImageTypeSpecifier type;boolean failed;int csCode;this.csCodeproduce(...)...[] defaultTypes;new ImageTypeProducer(...)createFromBufferedImageType(...)BufferedImage.TYPE_BYTE_GRAYcreatePacked(...)// Read the first header// This reads the tables-only image twice, once from C// and once from Java, but only if ignoreMetadata is false// Now we are at the first image if there are any, so add it// to the list// Not tables only, so add original pos to the list// And set current image since we've read it now// locked thread// Otherwise we have to read the entire stream// FALL THROUGH to decrement buffer vars// This first set doesn't have a length// not a marker, just a data 0xff// All the others have a length// length includes itself// Search is necessary for JPEG// read to start of image, saving positions// First seek to the last position we already have, and skip the// entire image// Now add all intervening positions, skipping images// Is there an image?// Otherwise we are where we want to be// No way is native buffer still valid// We hit the end of the stream before we hit an SOI, so no image// The buffer is clear after this, so no need to set haveSeeked.// Ignore return/* Color profile data seems to be invalid. ... *//* At the moment we can't rely on the ColorSpace.equals() ... */// verify new color space/* Embedded profile seems to be corrupted. ... */// Returns null if it can't be represented// We return an iterator containing the default, any// conversions that the library provides, and// all the other default types with the same number// of components, as we can do these as a post-process.// As we convert Rasters rather than images, images// with alpha cannot be converted in a post-process.// If this image can't be interpreted, this method// returns an empty Iterator.// Get the raw ITS, if there is one.  Note that this// won't always be the same as the default.// Given the encoded colorspace, build a list of ITS's// representing outputs you could handle starting// with the default.// Might be null if PYCC.pf not installed// As there is no YCbCr ColorSpace, we can't support// the raw type.// due to 4705399, use RGB as default in order to avoid// slowing down of drawing operations with result image.// Assume it's for RGB// Default is to convert to RGBA// If we are rearranging channels at all, the default// conversions remain in place.  If the user wants// raw channels then he should do this while reading// a Raster.// Accept default conversions out of decoder, silently// XXX - We do not currently support any indexed color models,// though we could, as IJG will quantize for us.// This is a performance and memory-use issue, as// users can read RGB and then convert to indexed in Java.// Now check the ColorSpace type against outColorSpaceCode// We may want to tweak the default// Its gray in the file// We want RGB// IJG can do this for us more efficiently// Update java state according to changes// in the native part of decoder.// IJG wants to go to RGB// We want gray// If the jpeg space is YCbCr, IJG can do it// We have an ICC profile but it isn't used in the dest// image.  So convert from the profile cs to the target cs// Leave IJG conversion in place; we still need it// Target isn't sRGB, so convert from sRGB to the target// No conversions available; image must be RGBA// We can't do YCC at all// No conversions available; image must be YCCA// Anything else we can't handle at all// imageMetadataIndex will always be either a valid index or// -1, in which case imageMetadata will not be null.// So we can leave checking imageIndex for gotoImage.// don't keep a reference here// Can we read this image?// The destination may still be incompatible.// Check whether we can handle any implied color conversion// Throws IIOException if the stream and the image are// incompatible, and sets convert if a java conversion// is necessary// Check the source and destination bands in the param// Set the output color space equal to the input colorspace// This disables all conversions// Create an intermediate 1-line Raster that will hold the decoded,// subsampled, clipped, band-selected image data in a single// byte-interleaved buffer.  The above transformations// will occur in C for performance.  Every time this Raster// is filled we will call back to acceptPixels below to copy// this to whatever kind of buffer our image has.// ignore dest bands for Raster// Now that we have the Raster we'll decode to, get a view of the// target Raster that will permit a simple setRect for each scanline/* If the process is sequential, and we have restart markers, ... */// Check for update listeners (don't call back if none)// Set up progression data// if we have a metadata object, we can count the scans// and set knownPassCount// We have metadata// Finally, we are ready to read// Note that getData disables acceleration on buffer, but it is// just a 1-line intermediate data transfer buffer that will not// affect the acceleration of the resulting image.// Use the range of allowed progressive passes// Assume there are a minimum of MIN_ESTIMATED_PASSES// and that there is always one more pass// Compute the percentage as the percentage at the end// of the previous pass, plus the percentage of this// pass scaled to be the percentage of the total remaining,// assuming a minimum of MIN_ESTIMATED_PASSES passes and// that there is always one more pass.  This is monotonic// and asymptotic to 1.0, which is what we need.// including this one/** NB: we do not check the call back lock here, ... *//* This could be further optimized by not resetting the dest. ... */// For Rasters, destination offset is logical, not physical, so// set it to 0 before calling computeRegions, so that the destination// region is not clipped.// Apply the destination offset, if any, as a logical offset// checks iis state for us// Now check the jfif segments// Now we know that there is a jfif segment// Now we know that there is a jfif segment and that iis is good// reset C structures// reset local Java structures// it looks like that this reader instance is used// by multiple threads.// undefinedJPEGImageReader.WARNING_NO_EOIJPEGImageReader.WARNING_NO_JFIF_IN_THUMBJPEGImageReader.WARNING_IGNORE_INVALID_ICCJPEG.vendorJPEG.versionJPEG.namesJPEG.suffixesJPEG.MIMETypesJPEG.nativeStreamMetadataFormatNameJPEG.nativeStreamMetadataFormatClassNameJPEG.nativeImageMetadataFormatClassNameImageInputStream iisint byte1int byte2/* Copyright (c) 2000, 2004, Oracle and/or its affiliates. All rights reserved. ... */// If the first two bytes are a JPEG SOI marker, it's probably// a JPEG file.  If they aren't, it definitely isn't a JPEG file.import JPEGImageWriteParamJPEG.ADOBE_IMPOSSIBLEinitWriterIDs(...)new Dimension[]///////// Private variablesImageOutputStream ios;/** The output stream we write to */Raster srcRas;/** The Raster we will write from *//** An intermediate Raster holding compressor-friendly data */boolean indexed;/** Set to true if we are writing an image with an ... */IndexColorModel indexCM;boolean convertTosRGB;WritableRaster converted;// Used by PhotoYCC onlyboolean isAlphaPremultiplied;ColorModel srcCM;List<> thumbnails;/** If there are thumbnails to be written, this is the list. */ICC_Profile iccProfile;/** If metadata should include an icc profile, store it here. */int sourceXOffset;int sourceYOffset;int sourceWidth;...[] srcBands;int sourceHeight;/** Used when calling listeners */ColorConvertOp convertOp;...[] streamQTables;...[] streamDCHuffmanTables;...[] streamACHuffmanTables;boolean ignoreJFIF;// Parameters for writing metadataboolean forceJFIF;// If it's there, use itboolean ignoreAdobe;// Add one for the thumbnailsint newAdobeTransform;boolean writeDefaultJFIF;// Change if neededboolean writeAdobe;JPEGMetadata metadata;boolean sequencePrepared;int numScans;/** The DisposerRecord that handles the actual disposal of this writer. */int WARNING_DEST_IGNORED;///////// Protected variables///////// End of Private variablesint WARNING_STREAM_METADATA_IGNORED;int WARNING_DEST_METADATA_COMP_MISMATCH;int WARNING_DEST_METADATA_JFIF_MISMATCH;int WARNING_DEST_METADATA_ADOBE_MISMATCH;int WARNING_IMAGE_METADATA_JFIF_MISMATCH;int WARNING_IMAGE_METADATA_ADOBE_MISMATCH;int WARNING_METADATA_NOT_JPEG_FOR_RASTER;int WARNING_NO_BANDS_ON_INDEXED;int WARNING_ILLEGAL_THUMBNAIL;int WARNING_IGNORING_THUMBS;int WARNING_FORCING_JFIF;int WARNING_THUMB_CLIPPED;int WARNING_METADATA_ADJUSTED_FOR_THUMB;int WARNING_NO_RGB_THUMB_AS_INDEXED;int WARNING_NO_GRAY_THUMB_AS_INDEXED;//////// Public APIinitJPEGImageWriter(...)new JPEGWriterDisposerRecord(...)setDest(...)new JPEGImageWriteParam(...)JPEGMetadata jpegDatajpegData.isStreamconvertImageMetadataOnThread(...)Node treejfifOK(...)...[] preferredThumbSizes;convertImageMetadata(...)writeOnThread(...)boolean rasterOnlyRenderedImage rimageint numSrcBandsint numBandsUsedboolean usingBandSubsetboolean fullImageImageTypeSpecifier destTypeint imageWidthint imageHeightJPEGHuffmanTable[] DCHuffmanTablesJPEGHuffmanTable[] ACHuffmanTablesboolean optimizeHuffmanJPEGImageWriteParam jparamint progressiveModeIIOMetadata mdataint inCsTypeJPEG.JCS_UNKNOWNint outCsTypeAdobeMarkerSegment adobeboolean metadataProgressiveint[] scansint numThumbsboolean haveMetadataboolean writeDQTboolean writeDHTDQTMarkerSegment dqtDHTMarkerSegment dhtint restartIntervalint[] componentIdsint[] HsamplingFactorsint[] VsamplingFactorsint[] QtableSelectorsgetMinTileX(...)getMinTileY(...)createChild(...)isAlphaPremultiplied(...)int[] tempint[] tempSizegetDestinationType(...)Rectangle imageBoundsfloat qualitygetCompressionQuality(...)JPEGQTable.K2ChrominancegetOptimizeHuffmanTables(...)checkSOFBands(...)checkJFIF(...)isNonStandardICC(...)checkAdobe(...)int transformtransformForType(...)getSrcCSType(...)getDefaultDestCSType(...)ImageTypeSpecifier inputTypeboolean alphaadobe.transformJPEG.ADOBE_UNKNOWNjfif.iccSegmentJPEG.ADOBE_YCCint outCSgetIDencodedCSType(...)boolean subsampledisSubsampled(...)sof.componentSpecsColorSpace.TYPE_3CLRsof.tagJPEG.SOF2collectScans(...)getThumbnails(...)DRIMarkerSegment dridri.restartIntervalcollectQTablesFromMetadata(...)getDefaultQTables(...)collectHTablesFromMetadata(...)getDefaultHuffmanTables(...)...[...].componentId...[...].HsamplingFactor...[...].VsamplingFactor...[...].QtableSelectorprepareWriteSequenceOnThread(...)JPEGMetadata jmetajmeta.isStreamstreamQTables.lengthwriteTables(...)abortWrite(...)resetWriter(...)///////// Package-access API////////// End of public API///////// Metadata handling///////// Private methods///////// End of Package-access APIsof.componentSpecs.lengthint rightTransform/** Collect all the scan info from the given metadata, and ... */List<> segmentsint SCAN_SIZEint MAX_COMPS_PER_SCANint[] retvalMarkerSegment segSOSMarkerSegment sossos.componentSpecs.lengthsos.componentSpecsint compSel...[...].componentSelectorsos.startSpectralSelectionsos.endSpectralSelectionsos.approxHighsos.approxLow/** Finds all DQT marker segments and returns all the q ... */ArrayList<> tablesJPEGQTable[] retvaladdAll(...)dqt.tablesretval.length(...).dataDQTMarkerSegment.Qtable/** Finds all DHT marker segments and returns all the q ... */JPEGHuffmanTable[] retvaldht.tablesDHTMarkerSegment.HtableHtable htablehtable.tableClassHtable[] htablesnew Htable[]...[...].tableID...[...].numCodes...[...].values////////////// ColorSpace conversion/////////// End of metadata handlingJPEG.JCS_CMYKJPEG.JCS_YCCKSOFMarkerSegment.ComponentSpecint hsamp0int vsamp0specs.length/** Sets up static native structures. */////////////// Native methods and callbacks////////////// End of ColorSpace conversion/** Sets up per-writer native structure and returns a pointer to it. *//** Sets up native structures for output stream *//** Returns <code>true</code> if the write was aborted. *//** Writes the metadata out when called by the native code, ... */writeDefaultJFIF(...)writeAdobeSegment(...)writeToStream(...)/** Write out a tables-only image to the stream. *//** Put the scanline y of the source ROI view Raster into the ... */Raster sourceLineboolean forceARGBBufferedImage tempcreateCompatibleWritableRaster(...)setPixels(...)coerceData(...)/** Aborts the current write in the native code *//** Resets native structures *//** Releases native structures */disposeWriter(...)/** This method is called from native code in order to write encoder ... *//* Copyright (c) 2000, 2015, Oracle and/or its affiliates. All rights reserved. ... *////////// End of Protected variables///////// static initializer// so this will always work// Set the native destination// There isn't much we can do.  If it's one of ours, then// return it.  Otherwise just return null.  We use it only// for tables, so we can't get a default and modify it,// as this will usually not be what is intended.// If it's one of ours, just return it// Can't convert stream metadata to image metadata// XXX Maybe this should put out a warning?// If it's not one of ours, create a default and set it from// the standard tree from the input, if it exists.// Other plug-in generates bogus standard tree// If the image type and metadata are JFIF compatible, return true// metadata must have a jfif node// if streamMetadata is not null, issue a warning// Obtain the raster and image, if there is one// Use the Raster directly.// Get the unique tile.// Ensure the Raster has dimensions of the image,// as the tile dimensions might differ.// Image is tiled so get a contiguous raster by copying.// Now determine if we are using a band subset// By default, we are using all source bands// Consult the param to determine if we're writing a subset// If this is a subset, we must adjust bandSizes// All the same// 4450894 part 1: The IJG libraries are compiled so they only// handle <= 8-bit samples.  We now check the band sizes and throw// an exception for images, such as USHORT_GRAY, with > 8 bits// per sample.// 4450894 part 2: We expand IndexColorModel images to full 24-// or 32-bit in grabPixels() for each scanline.  For indexed// images such as BYTE_BINARY, we need to ensure that we update// bandSizes to account for the scaling from 1-bit band sizes// to 8-bit.// Destination type, if there is one// Ignore dest type if we are writing a complete image// Examine the param// We'll handle the metadata case later// Now examine the metadata// First set a default state// By default we'll do no conversion:// By default don't write one// PhotoYCC does this// Check the metadata against the destination type// Do we want to write an ICC profile?// no metadata, but there is a dest type// If we can add a JFIF or an Adobe marker segment, do so// re-create the metadata// no destination type// no dest, no metadata, full image// Use default metadata matching the image and param// else no dest, no metadata, not an image,// so no special headers, no color conversion// no dest type, but there is metadata// no dest, metadata, image// Check that the metadata and the image match// out colorspace remains unknown// consult the ids// if they don't resolve it,// consult the sampling factors// RGBA// PhotoYCCA// else no dest, metadata, not an image.  Defaults ok// Might still be null// determine if thumbnails can be written// If we are going to add a default JFIF marker segment,// then thumbnails can be written// If there is no metadata, then we can't write thumbnails// There is metadata// If we are writing a raster or subbands,// then the user must specify JFIF on the metadata// Or we can't include thumbnails// It is a full image, and there is metadata// Not JFIF// Can it have JFIF?// Nope, not JFIF-compatible// Set up a boolean to indicate whether we need to call back to// write metadata// Now that we have dealt with metadata, finalize our tables set up// Are we going to write tables?  By default, yes.// But if the metadata has no tables, no.// Ignored if optimizeHuffman is true// Whether we write tables or not, we need to figure out which ones// to use// Get them from metadata, or use defaults// If we are optimizing, we don't want any tables.// If they were for progressive scans, we can't use them.// By default, ids are 1 - N, no subsampling// JFIF compatible// Now override them with the contents of sof, if there is one,// else use JFIF-compatible default// Create an appropriate 1-line databuffer for writing// Create a raster from that// Call the writer, who will call back for every scanline// just a 1-line intermediate data transfer buffer that does not// affect the acceleration of the source image.// After a successful write/* from jpeg_metadata.html: ... */// write a complete tables-only image at the beginning of// the stream.// Check that we are// at the beginning of the stream, or can go there, and haven't// written out the metadata already.// Set the tables// If the metadata has no tables, use default tables.// Now write them out// In the case of JPEG this does nothing different from write/** NB: we do not check the call back lock here, we allow to abort ... */// reset the native destination// Does the metadata frame header, if any, match numBandsUsed?// type overrides metadata// num comps// out of for over sof comps// If the image has BITMASK transparency, we need to make sure// it gets converted to 32-bit ARGB, because the JPEG encoder// relies upon the full 8-bit alpha channel.// The first time through, converted is null, so// a new raster is allocated.  It is then reused// on subsequent lines.// Every 8 scanlinesJPEGImageWriter.WARNING_DEST_IGNOREDJPEGImageWriter.WARNING_STREAM_METADATA_IGNOREDJPEGImageWriter.WARNING_DEST_METADATA_COMP_MISMATCHJPEGImageWriter.WARNING_DEST_METADATA_JFIF_MISMATCHJPEGImageWriter.WARNING_DEST_METADATA_ADOBE_MISMATCHJPEGImageWriter.WARNING_IMAGE_METADATA_JFIF_MISMATCHJPEGImageWriter.WARNING_IMAGE_METADATA_ADOBE_MISMATCHJPEGImageWriter.WARNING_METADATA_NOT_JPEG_FOR_RASTERJPEGImageWriter.WARNING_NO_BANDS_ON_INDEXEDJPEGImageWriter.WARNING_IGNORING_THUMBSJPEGImageWriter.WARNING_FORCING_JFIFJPEGImageWriter.WARNING_METADATA_ADJUSTED_FOR_THUMBint bitDepth// Find the maximum bit depth across all channels// 4450894: Ensure bitDepth is between 1 and 8import ListIterator/** Metadata for the JPEG plug-in. *///////// Private variablesList<> resetSequence;/** A copy of <code>markerSequence</code>, created the first time the ... */boolean inThumb;/** Set to <code>true</code> when reading a thumbnail stored as ... */boolean hasAlpha;/** Set by the chroma node construction method to signal the ... */List<> markerSequence;/** All data is a list of <code>MarkerSegment</code> objects. ... *//////// Package-access variables//////// end of private variablesboolean isStream;/** Indicates whether this object represents stream or image ... *//** Constructor containing code shared by other constructors. *//////// Constructors/////// End of package-access variablesthis.inThumbthis.isStream/* Constructs a <code>JPEGMetadata</code> object by reading the ... */MarkerSegment newGuyJPEG.SOF0JPEG.SOF1new SOFMarkerSegment(...)new DQTMarkerSegment(...)new DHTMarkerSegment(...)new DRIMarkerSegment(...)JFIFMarkerSegment dummyaddJFXX(...)new MarkerSegment(...)addICC(...)new COMMarkerSegment(...)JPEG.SOSnew SOSMarkerSegment(...)newGuy.unknownpushBack(...)isConsistent(...)/** Constructs a default stream <code>JPEGMetadata</code> object appropriate ... *//** Constructs a default image <code>JPEGMetadata</code> object appropriate ... */boolean wantJFIFboolean wantAdobeboolean willSubsampleboolean wantICCboolean wantProgboolean wantOptimizedboolean wantExtendedboolean wantQTablesboolean wantHTablesbyte[] componentIDsgetDCHuffmanTables(...).lengthgetACHuffmanTables(...).lengthcanWriteCompressed(...)boolean hasExtraComponentsgetNumColorComponents(...)JPEG.ADOBE_YCCK/** Returns the first MarkerSegment object in the list ... */// The first ones have package access for access from the writer.// Utilities for dealing with the marker sequence.////// End of constructorsseg.tag/** Returns the first or last MarkerSegment object in the list ... */ListIterator<> iterlistIterator(...)hasPrevious(...)previous(...)/** Returns the index of the first or last MarkerSegment in the list ... */seg.unknown// Implement Cloneable, but restrict accessJPEGMetadata newGuynewGuy.markerSequencecloneSequence(...)newGuy.resetSequence/** Returns a deep copy of the current marker sequence. */List<> retval// Tree methodsIIOMetadataNode topIIOMetadataNode sequenceIIOMetadataNode headerIIOMetadataNode chromaIIOMetadataNode csTypeint numChannelsIIOMetadataNode numChanNodeboolean idsAreJFIFint hfactorint vfactorint idIIOMetadataNode compressionIIOMetadataNode nameIIOMetadataNode losslessint sosCountMarkerSegment msms.tagIIOMetadataNode progIIOMetadataNode dimIIOMetadataNode orientIIOMetadataNode aspectjfif.resUnitsjfif.Ydensityjfif.XdensityinsertBefore(...)float scaleIIOMetadataNode horizIIOMetadataNode vertIIOMetadataNode textCOMMarkerSegment comIIOMetadataNode transIIOMetadataNode alpha// EditingList<> copymergeJFIFsubtree(...)mergeSequenceSubtree(...)getLastChild(...)/** Merge a JFIF subtree into the marker sequence, if the subtree ... */Node jfifNodeJFIFMarkerSegment jfifSegmergeDQTNode(...)mergeDHTNode(...)mergeDRINode(...)mergeCOMNode(...)mergeAdobeNode(...)mergeUnknownNode(...)mergeSOFNode(...)mergeSOSNode(...)/** Merge the given DQT node into the marker sequence.  If there already ... */ArrayList<> oldDQTsint childIDDQTMarkerSegment testDQTtestDQT.tablesQtable testTabletestTable.tableIDgetQtableFromNode(...)int firstDHTfindMarkerSegmentPosition(...)int firstSOFint firstSOS/** Merge the given DHT node into the marker sequence.  If there already ... */ArrayList<> oldDHTsint childClassDHTMarkerSegment testDHTtestDHT.tablesHtable testTabletestTable.tableClassgetHtableFromNode(...)int lastDQT/** Merge the given DRI node into the marker sequence. ... */DRIMarkerSegment newGuy/** Merge the given COM node into the marker sequence. ... */COMMarkerSegment newGuyinsertCOMMarkerSegment(...)/** Insert a new COM marker segment into an appropriate place in the ... */int lastCOMboolean hasJFIFint firstAdobe/** Merge the given Adobe APP14 node into the marker sequence. ... */AdobeMarkerSegment newGuyinsertAdobeMarkerSegment(...)/** Insert the given AdobeMarkerSegment into the marker sequence, as ... */int lastUnknownfindLastUnknownMarkerSegmentPosition(...)/** Merge the given Unknown node into the marker sequence. ... *//** Merge the given SOF node into the marker sequence. ... */SOFMarkerSegment newGuy/** Merge the given SOS node into the marker sequence. ... */SOSMarkerSegment firstSOSSOSMarkerSegment lastSOSboolean transparencyDone;mergeStandardChromaNode(...)mergeStandardCompressionNode(...)mergeStandardDataNode(...)mergeStandardDimensionNode(...)mergeStandardDocumentNode(...)mergeStandardTextNode(...)mergeStandardTransparencyNode(...)/* In general, it could be possible to convert all non-pixel data to some ... */Node csTypeString csNamebyte[] idsboolean wantAlphaboolean updateQtablesboolean updateHtablesboolean progressiveint[] subsampledSelectorsint[] nonSubsampledSelectorsint[] newTableSelectorsComponentSpec[] oldCompSpecsNode transwantAlpha(...)oldCompSpecs.lengthboolean idsDifferSOSMarkerSegment targettarget.componentSpecs.lengthtarget.componentSpecsint oldSelector...[...].dcHuffTable...[...].acHuffTableList<> tableSegmentsboolean foundDQTMarkerSegment testdqtIterator<> tabitertestdqt.tablesQtable tabtab.tableIDQtable table0getChromaForLuma(...)DHTMarkerSegment testdhttestdht.tablesHtable tabDHTMarkerSegment lastDHTaddHtable(...)boolean returnValueNode alphahasAttributes(...)boolean canHaveJFIFString valueStringPoint pfindIntegerRatio(...)p.xp.yint dpcmJPEG.DENSITY_UNIT_DOTS_CM/* Return a pair of integers whose ratio (x/y) approximates the given ... */float epsilonboolean invertedfloat deltaNode compboolean copyItString compStringboolean hadAlphaComponentSpec[] newSpecsnew ComponentSpec[]byte oldFirstIDbyte newIDScanComponentSpec[] newScanSpecsnew ScanComponentSpec[]SOSMarkerSegment.ScanComponentSpecgetComponentSpec(...)getScanComponentSpec(...)setFromNativeTree(...)Node markerSequenceNodeNode JPEGvariety/** Check that this metadata object is in a consistent state and ... */int numSOFBandsint numScanBandscountScanBands(...)/** Returns the total number of bands referenced in all SOS marker ... */List<> idsScanComponentSpec[] specsInteger id///// Writer supportAdobeMarkerSegment newAdobenewAdobe.transform//// End of writer support// Supports standard format// and a native format// No other formats// But if we are stream metadata, adjust the variables// The first three bytes should be FF, SOI, FF// Next byte should be the ff before a marker// Either JFIF, JFXX, or unknown APP0// tag, length, id// Leave newGuy null// Read a dummy to skip the segment// newGuy remains null// Either an ICC profile or unknown APP2// Either Adobe or unknown APP14// Just skip it// Now that we've read up to the EOI, we need to push back// whatever is left in the buffer, so that the next read// in the native code will work.// default tables.// Defensive programming// Ignore the destination type.// The only progressive mode that makes sense here is MODE_DEFAULT// the param may not be one of ours, so it may return false.// If so, the following would throw an exception// If the param has them, metadata shouldn't// Progressive forces optimized, regardless of param setting// so consult the param re optimized only if not progressive// compression quality should determine the q tables.  Note that this// will be ignored if we already decided not to create any.// Again, the param may not be one of ours, so we must check that it// supports compression settings// We are done with the param, now for the image types// e.g. alpha// e.g. K or alpha// Not alpha, so must be K// with or without alpha// Everything else is not subsampled, gets no special marker,// and component ids are 1 - N// without alpha we just accept the JFIF defaults// then it must be K// and component ids are 0 - N// do we want an ICC profile?// Now step through the markers, consulting our variables.// Can't happen here// Adobe// dqt// dht// sof// sos// Default progression scans are done in the writer// JFIF must be first, so this skips it// Unless we find otherwise// Colorspace type - follow the rules in the spec// First get the SOF marker segment, if there is one// No image, so no chroma// get the number of channels// is there a JFIF marker segment?// How about an Adobe marker segment?// Neither marker.  Check components// Check against the letters// Finally, 3-channel subsampled are YCbCr, unsubsampled are RGB// 4-channel subsampled are YCbCrA, unsubsampled are CMYK// Not subsampled.  numChannels < 3 is taken care of above// Lossless - false// NumProgressiveScans - count sos segments// If we have a JFIF marker segment, we know a little// otherwise all we know is the orientation, which is always normal// Aspect Ratio is width of pixel / height of pixel// In this case they just encode aspect ratio directly// They are true densities (e.g. dpi) and must be inverted// Pixel size// 1 == dpi, 2 == dpc// Add a text entry for each COM Marker Segment// Always assume// Deep copy// Avoid cloning twice// JPEGvariety and markerSequence// is there already a jfif marker segment?// Add it as the first element in the list.// First collect any existing DQT nodes into a local list// JFIF is always 0// ColorSpaceType can change the target colorspace for compression// This must take any transparency node into account as well, as// that affects the number of channels (if alpha is present).  If// a transparency node is dealt with here, set a flag to indicate// this to the transparency processor below.  If we discover that// the nodes are not in order, throw an exception as the tree is// invalid.// If there is no ColorSpaceType node, we have nothing to do// We can't handle them, so don't modify any metadata// out of for// If the metadata specifies progressive, then the number of channels// must match, so that we can modify all the existing SOS marker segments.// If they don't match, we don't know what to do with SOS so we can't do// the merge.  We then just return silently.// An exception would not be appropriate.  A warning might, but we have// nowhere to send it to.// Progressive// JFIF header might be removed// Now add a JFIF if we do want one, but only if it isn't stream metadata// Adobe header might be removed or the transform modified, if it isn't// stream metadata// Keep the old componentSpecs array// SOF might be modified// Now replace the SOF with a new one; it might be the same, but// this is easier.// we never need extended// Now suss out if subsampling changed and set the boolean for// updating the q tables// if the old componentSpec q table selectors don't match// the new ones, update the qtables.  The new selectors are already// in place in the new SOF segment above.// if the component ids are different, update all the existing scans// ignore Huffman tables// update the ids in each SOS marker segment// Find the position in the old componentSpecs array// of the old component with the old selector// and replace the component selector with the// new id at the same position, as these match// the new component specs array in the SOF created// above.// htables - if the old htable selectors don't match the new ones,// update the tables.// Might be the same as the old one, but this is easier.// should be stream metadata if there isn't an SOF, but check it anyway// update tables - routines below check if it's really necessary// If there are no tables, don't add them, as the metadata encodes an// abbreviated stream.// If we are not subsampling, we just need one, so don't do anything// Is it really necessary?  There should be at least 2 tables.// If there is only one, assume it's a scaled "standard"// luminance table, extract the scaling factor, and generate a// scaled "standard" chrominance table.// Find the table with selector 1.//    find the table with selector 0.  There should be one.// Assuming that the table with id 0 is a luminance table,// compute a new chrominance table of the same quality and// add it to the last DQT segment// Is it really necessary?  There should be at least 2 dc and 2 ac// tables.  If there is only one, add a// "standard " chrominance table.// find a table with selector 1. AC/DC is irrelevant// Create new standard dc and ac chrominance tables and add them// to the last DHT segment// Alpha must be first if present// NumProgressiveScans is ignored.  Progression must be enabled on the// ImageWriteParam.// Pixel Aspect Ratio or pixel size can be incorporated if there is,// or can be, a JFIF segment// Can there be one?// Criteria:// SOF must be present with 1 or 3 channels, (stream metadata fails this)//     Component ids must be JFIF compatible.// remaining tests are negative// if Adobe present, transform = ADOBE_UNKNOWN for 1-channel,//     ADOBE_YCC for 3-channel.// If so, create one and insert it into the sequence.  Note that// default is just pixel ratio at 1:1// Convert from mm/dot to dots/cm// Normalize// Deal with min case// Deal with max case// Remember if we invert// First approximation// not close enough// Increment y and compute a new x// Convert to comments.  For the moment ignore the encoding issue.// Ignore keywords, language, and encoding (for the moment).// If compression tag is present, use only entries with "none".// This might indicate that an alpha channel is being added or removed.// The nodes must appear in order, and a Chroma node will process any// transparency, so process it here only if there was no Chroma node// Do nothing for stream metadata// do we have alpha already?  If the number of channels is 2 or 4,// we do, as we don't support CMYK, nor can we add alpha to it// The number of channels can be determined from the SOF// We can do nothing for progressive, as we don't know how to// modify the scans.// Do we already have alpha?  We can tell by the number of channels// We must have an sof, or we can't do anything further// proceed only if the old state and the new state differ// Adding alpha// If an adobe marker is present, transform must be UNKNOWN// Add a component spec with appropriate parameters to SOF// Add a component spec with appropriate parameters to SOS// Removing alpha// Remove a component spec from SOF// Remove a component spec from SOS// In this case a reset followed by a merge is correct// Build a whole new marker sequence from the tree// for all the children, add a marker segment// SOF numBands = total scan bands// No SOS is OK// If JFIF is present, component ids are 1-3, bands are 1 or 3// If both JFIF and Adobe are present,// Adobe transform == unknown for gray,// YCC for 3-chan.// stream can't have jfif, adobe, sof, or sos// Write a default JFIF segment, including thumbnails// This won't be duplicated below because forceJFIF will be// set only if there is no JFIF present already.// Not compatible, so ignore Adobe.// Iterate over each MarkerSegment// Otherwise ignore it, as requested// If adobe isn't JFIF compatible, ignore it// Otherwise no need to resetint MAX_JPEG_DATA_SIZE;// 2-byte length reduces max to 65533String resourceBaseName;setResourceBaseName(...)// Format shared between image and stream formatsList<> classes/** Returns <code>true</code> if the named element occurs in the ... */String[] childrengetChildNames(...)// Just check if it appears in the format...[] commonContents;JPEGStreamMetadataFormat theInstance;new JPEGStreamMetadataFormat(...)Object[][] commonCopy// return a copy of commonContents; in theory we want a deep clone// of commonContents, but since it only contains (immutable) Strings,// this shallow copy is sufficient/** All metadata is stored in MarkerSegments.  Marker segments ... */int LENGTH_SIZE;int tag;// length is 2 bytes// See JPEG.java/* Sometimes needed by subclasses; doesn't include ... */boolean unknown;// Raw segment data, used for unrecognized segments/** Constructor for creating <code>MarkerSegment</code>s by reading ... */// Set to true if the tag is not recognized/** Constructor used when creating segments other than by ... */this.tag/** Construct a MarkerSegment from an "unknown" DOM Node. */IIOMetadataNode iioNodeIIOInvalidTreeException newGuy/** Deep copy of data array. */this.data/** We have determined that we don't know the type, so load ... *//** Writes the marker, tag, and length.  Note that length ... */// tag plus length// JPEG length includes itself, we don't// Now that we know the true length, ensure that we've got it,// or at least a bufferful if length is too big.// The type of node should have been verified already.// get the attribute and assign it to the tag// get the user object and clone it to the data/** An SOF (Start Of Frame)  marker segment. */int samplePrecision;int numLines;int samplesPerLine;...[] componentSpecs;// Array size is num componentsint factorint qselnew ComponentSpec(...)newGuy.componentSpecscomponentSpecs.length/** A component spec within an SOF marker segment. */int componentId;int HsamplingFactor;int VsamplingFactor;int QtableSelector;//import javax.imageio.IIOException;// All attributes are optional, so setup defaults first// If samplePrecision is present, it must be 8.// This just checks.  We don't bother to assign the value.// We don't write SOF segments; the IJG library does.// Parent already did a loadBuf/** An SOS (Start Of Scan) marker segment. */int startSpectralSelection;int endSpectralSelection;int approxHigh;int approxLow;// Array size is numScanComponentsint tableSelnew ScanComponentSpec(...)SOSMarkerSegment newGuy/** A scan component spec within an SOS marker segment. */int componentSelector;int dcHuffTable;int acHuffTable;// Now the children// We don't write SOS segments; the IJG library does.// Parent already loaded the bufferimport BufferedInputStreamimport ByteArrayInputStreamimport DataInputStreamimport SequenceInputStreamimport Enumerationimport Inflaterimport InflaterInputStreamimport InputStreamAdapterimport SubImageInputStreamimport ByteInterleavedRasterboolean firstTime;new SubImageInputStream(...)new InputStreamAdapter(...)int crcPNGImageReader.IDAT_TYPEnew PNGMetadata(...)int IHDR_TYPE;// Critical chunks/* Note: The following chunk type constants are autogenerated.  Each ... */int PLTE_TYPE;int IDAT_TYPE;int IEND_TYPE;int bKGD_TYPE;// Ancillary chunksint cHRM_TYPE;int gAMA_TYPE;int hIST_TYPE;int iCCP_TYPE;int iTXt_TYPE;int pHYs_TYPE;int sBIT_TYPE;int sPLT_TYPE;int sRGB_TYPE;int tEXt_TYPE;int tIME_TYPE;int tRNS_TYPE;int zTXt_TYPE;int PNG_COLOR_GRAY;int PNG_COLOR_RGB;int PNG_COLOR_PALETTE;int PNG_COLOR_GRAY_ALPHA;int PNG_COLOR_RGB_ALPHA;...[] inputBandsForColorType;// The number of bands by PNG color typeint PNG_FILTER_NONE;int PNG_FILTER_SUB;int PNG_FILTER_UP;int PNG_FILTER_AVERAGE;int PNG_FILTER_PAETH;...[] adam7XOffset;...[] adam7YOffset;...[] adam7XSubsampling;...[] adam7YSubsampling;boolean gotMetadata;ImageReadParam lastParam;long imageStartPosition;...[] sourceBands;PNGMetadata metadata;DataInputStream pixelStream;int pixelsDone;// The number of source pixels processedint totalPixels;// The total number of pixels in the source imagenew EOFException(...)int IHDR_lengthint IHDR_typeint colorTypeint compressionMethodint filterMethodint interlaceMethodmetadata.IHDR_presentmetadata.IHDR_widthmetadata.IHDR_heightmetadata.IHDR_bitDepthmetadata.IHDR_colorTypemetadata.IHDR_compressionMethodmetadata.IHDR_filterMethodmetadata.IHDR_interlaceMethodmetadata.PLTE_presentint maxEntriesmetadata.PLTE_redmetadata.PLTE_greenmetadata.PLTE_bluemetadata.bKGD_colorTypemetadata.bKGD_indexmetadata.bKGD_graymetadata.bKGD_redmetadata.bKGD_greenmetadata.bKGD_bluemetadata.bKGD_presentmetadata.cHRM_whitePointXmetadata.cHRM_whitePointYmetadata.cHRM_redXmetadata.cHRM_redYmetadata.cHRM_greenXmetadata.cHRM_greenYmetadata.cHRM_blueXmetadata.cHRM_blueYmetadata.cHRM_presentint gammametadata.gAMA_gammametadata.gAMA_presentmetadata.hIST_histogrammetadata.hIST_histogram.lengthmetadata.hIST_presentString keywordreadNullTerminatedString(...)byte[] compressedProfilemetadata.iCCP_profileNamemetadata.iCCP_compressionMethodmetadata.iCCP_compressedProfilemetadata.iCCP_presentlong chunkStartint compressionFlagString languageTagint maxLenString translatedKeywordString textmetadata.iTXt_keywordmetadata.iTXt_compressionFlagmetadata.iTXt_compressionMethodmetadata.iTXt_languageTagmetadata.iTXt_translatedKeywordinflate(...)metadata.iTXt_textmetadata.pHYs_pixelsPerUnitXAxismetadata.pHYs_pixelsPerUnitYAxismetadata.pHYs_unitSpecifiermetadata.pHYs_presentmetadata.sBIT_grayBitsmetadata.sBIT_redBitsmetadata.sBIT_greenBitsmetadata.sBIT_blueBitsmetadata.sBIT_alphaBitsmetadata.sBIT_colorTypemetadata.sBIT_presentint sampleDepthmetadata.sPLT_paletteNamemetadata.sPLT_sampleDepthmetadata.sPLT_redmetadata.sPLT_greenmetadata.sPLT_bluemetadata.sPLT_alphametadata.sPLT_frequencymetadata.sPLT_presentmetadata.sRGB_renderingIntentmetadata.sRGB_presentmetadata.tEXt_keywordmetadata.tEXt_textmetadata.tIME_yearmetadata.tIME_monthmetadata.tIME_daymetadata.tIME_hourmetadata.tIME_minutemetadata.tIME_secondmetadata.tIME_presentmetadata.PLTE_red.lengthmetadata.tRNS_alphametadata.tRNS_colorTypemetadata.tRNS_graymetadata.tRNS_redmetadata.tRNS_greenmetadata.tRNS_bluemetadata.tRNS_presentInputStream baisInputStream iisnew InflaterInputStream(...)int methodmetadata.zTXt_keywordmetadata.zTXt_compressionMethodmetadata.zTXt_textint chunkLengthint chunkType<Label>: ...int chunkCRCStringBuilder chunkNameint ancillaryBitparse_PLTE_chunk(...)parse_bKGD_chunk(...)parse_cHRM_chunk(...)parse_gAMA_chunk(...)parse_hIST_chunk(...)parse_iCCP_chunk(...)parse_iTXt_chunk(...)parse_pHYs_chunk(...)parse_sBIT_chunk(...)parse_sPLT_chunk(...)parse_sRGB_chunk(...)parse_tEXt_chunk(...)parse_tIME_chunk(...)parse_tRNS_chunk(...)parse_zTXt_chunk(...)metadata.unknownChunkTypemetadata.unknownChunkData// Data filtering methodsint rawint priorint priorPixelint priorRowint paint pbint pcint priorRowPixelpaethPredictor(...)Point origincreatePackedRaster(...)new DataBufferUShort(...)int inputBandsint bytesPerRowint srcYint dstMinXint dstMaxXint dstMinYint dstMaxYint updateMinXint updateMinYint updateWidthint updateXStepint updateYStepint bytesPerPixelint eltsPerRowint sourceXint srcXint srcXStepbyte[] byteDatashort[] shortDatabyte[] currbyte[] priorWritableRaster passRowcreateRaster(...)int[] psgetPixel(...)boolean adjustBitDepthsint[] outputSampleSizeoutputSampleSize.lengthint[][] scaleboolean useSetRectupdateImageProgress(...)createWritableChild(...)int maxInSampleint halfMaxInSampleint maxOutSampleint filterint sourceYZipException zedecodeSubFilter(...)decodeUpFilter(...)decodeAverageFilter(...)decodePaethFilter(...)int dstYint newSrcXint dstXsetPixel(...)this.pixelsDonethis.totalPixelsdecodePass(...)int XOffsetint YOffsetint XSubsamplingint YSubsamplingint xbumpint ybumpskipPass(...)Inflater infEnumeration<InputStream> enew PNGImageDataEnumeration(...)InputStream isnew SequenceInputStream(...)Rectangle destRegionnew Inflater(...)new BufferedInputStream(...)this.pixelStreamsetLocation(...)getLocation(...)decodeImage(...)end(...)ArrayList<ImageTypeSpecifier> lnew ArrayList<ImageTypeSpecifier>(...)ColorSpace rgbColorSpace grayint plengthbyte[] alphacreateGrayscale(...)BufferedImage.TYPE_3BYTE_BGRBufferedImage.TYPE_INT_BGRmetadata.PLTE_green.lengthmetadata.PLTE_blue.lengthmetadata.tRNS_alpha.lengthred.lengthBufferedImage.TYPE_4BYTE_ABGRBufferedImage.TYPE_INT_ARGB/* Super class implementation uses first element ... */Iterator<ImageTypeSpecifier> typesImageTypeSpecifier raw// skip chunk type// gray// unused// rgb// gray + alpha// rgb + alpha// Re-use signature array to bulk-read these unsigned byte values// Skip IHDR CRC// Round array sizes up to 2^2^n// RGB or RGB_ALPHA/* According to PNG specification length of ... */// Decompress the text// Alpha table may have fewer entries than RGB palette/* Optimization: We can skip the remaining metadata if the ... */// We've reached the image data// Skip the chunk plus the 4 CRC bytes that follow// verify the chunk length// If chunk type is 'IDAT', we've reached the image data.// Read an unknown chunk// double check whether all chunk data were consumed// G// GA in GA order// RGB in RGB order// RGBA in RGBA order// Read the image row-by-row// Skip filter byte and the remaining row bytes// If read has been aborted, just return// processReadAborted will be called later// Determine which pixels will be updated in this pass// If no pixels need updating, just skip the input data// Update count of pixels read// Backwards map from destination pixels// (dstX = updateMinX + k*updateXStep)// to source pixels (sourceX), and then// to offset and skip in passRow (srcX and srcXStep)// Compute the step factor in the source// Create a 1-row tall Raster to hold the data// Create an array suitable for holding one pixel// Handle source and destination bands// Determine if all of the relevant output bands have the// same bit depth as the source data// If the bit depths differ, create a lookup table per band to perform// the conversion// Limit passRow to relevant area for the case where we// will can setRect to copy a contiguous span// Decode the (sub)image row-by-row// Read the filter type byte and a row of data// Swap curr and prior// TODO - throw a more meaningful exception// Copy data into passRow byte by byte// True Y position in source// Init default values// If an ImageReadParam is available, get values from it/* InflaterInputStream uses an Inflater instance which consumes ... *//* NB: the PNG spec declares that valid range for width ... */// At this point the header has been read and we know// how many bands are in the image, so perform checking// of the read param.// Packed grayscale// some standard types of buffered images// which can be used as destination// Component R, G, B// Need tRNS chunk/* The PLTE chunk spec says: ... */// Alpha from tRNS chunk may have fewer entries than// the RGB LUTs from the PLTE chunk; if so, pad with// 255.// Component G, A// wich can be used as destination// Component R, G, B, A (non-premultiplied)PNGMetadata.nativeMetadataFormatNamenew PNGImageReader(...)import DataOutputimport OutputStreamimport Deflaterimport DeflaterOutputStreamimport ImageOutputStreamImpl...[] crcTable;int crc;new CRC(...)long startPos;CRC crc;this.startPos// fixed length.// Compress output and write as a series of 'IDAT' chunks ofnew Deflater(...)Deflater.BEST_COMPRESSION...[] chunkType;int chunkLength;Deflater def;int bytesRemaining;this.chunkLengthstartChunk(...)this.bytesRemainingfinished(...)needsInput(...)deflate(...)finishChunk(...)byte[] wbuffinish(...)this.locale/**  */new RowFilter(...)// Factors from the ImageWriteParamint periodX;int periodY;int bpp;RowFilter rowFilter;...[] prevRow;...[] currRow;...[] filteredRows;...[] sampleSize;// given by sampleSize, and an output bit depth given by scalingBitDepth.// The tables will be designed for use with a set of input but depths// will be valid, or scaleh and scalel will be valid, but not both.// After the first call to initializeScaleTables, either scale and scale0// Per-band scaling tablesint scalingBitDepth;// Sample size per band, in bits...[] scale;// Tables for 1, 2, 4, or 8 bit output// Output bit depth of the scaling tables...[] scale0;// 8 bit table...[] scaleh;// Tables for 16 bit output// equivalent to scale[0]...[] scalel;// High bytes of output// Low bytes of output// Total number of pixels to be written by write_IDAT// Running count of pixels written by write_IDAT...[] allowedProgressivePasses;new PNGImageWriteParam(...)PNGMetadata mbyte[] magicChunkStream csnew ChunkStream(...)PNGImageReader.IHDR_TYPEPNGImageReader.cHRM_TYPEPNGImageReader.gAMA_TYPEPNGImageReader.iCCP_TYPEPNGImageReader.sBIT_TYPEPNGImageReader.PNG_COLOR_GRAYPNGImageReader.PNG_COLOR_GRAY_ALPHAPNGImageReader.PNG_COLOR_RGBPNGImageReader.PNG_COLOR_PALETTEPNGImageReader.PNG_COLOR_RGB_ALPHAPNGImageReader.sRGB_TYPEPNGImageReader.PLTE_TYPEPNGImageReader.hIST_TYPEwriteChars(...)PNGImageReader.tRNS_TYPEint chunkRedint chunkGreenint chunkBluePNGImageReader.bKGD_TYPEPNGImageReader.pHYs_TYPEPNGImageReader.sPLT_TYPEmetadata.sPLT_red.lengthPNGImageReader.tIME_TYPEIterator<> keywordIterIterator<> textIterPNGImageReader.tEXt_TYPEDeflaterOutputStream dosnew DeflaterOutputStream(...)Iterator<String> keywordIterIterator<Boolean> flagIterIterator<Integer> methodIterIterator<String> languageIterIterator<String> translatedKeywordIterIterator<String> textIterPNGImageReader.iTXt_TYPEBoolean compressedIterator<> methodIterPNGImageReader.zTXt_TYPEIterator<> typeIterIterator<> dataIterString typechunkType(...)char c0char c1char c2char c3int hpixelsint vpixelsint samplesPerByteint numSamplesint[] samplesIndexColorModel icm_gray_alphaRaster rasint[] paletteOrdermetadata.PLTE_orderint filterTypefilterRow(...)byte[] swapbyte val// Use sourceXOffset, etc.IDATOutputStream iosnew IDATOutputStream(...)encodePass(...)PNGImageReader.adam7XOffsetPNGImageReader.adam7YOffsetPNGImageReader.adam7XSubsamplingPNGImageReader.adam7YSubsamplingPNGImageReader.IEND_TYPE// if either array is null// Check two int arrays for value equality, always returns falses0.lengths1.length// output bit depth// hold the results of scaling an input value to the desired// Initialize the scale/scale0 or scaleh/scalel arrays tothis.sampleSizethis.scalingBitDepthRenderedImage imIIOMetadata imdthis.numBandsthis.sourceXOffsetthis.sourceYOffsetthis.sourceWidththis.sourceHeightthis.sourceBandsthis.periodXthis.periodYcreateFromRenderedImage(...)this.bppinitializeScaleTables(...)write_magic(...)write_IHDR(...)write_cHRM(...)write_gAMA(...)write_iCCP(...)write_sBIT(...)write_sRGB(...)write_PLTE(...)write_hIST(...)write_tRNS(...)write_bKGD(...)write_pHYs(...)write_sPLT(...)write_tIME(...)write_tEXt(...)write_iTXt(...)write_zTXt(...)writeUnknownChunks(...)write_IDAT(...)writeIEND(...)// Initialize CRC table// length, will backpatch// Write CRC// Write length// Return to end of chunk and flush to minimize buffering// TODO - deal with imageType// Write signature// Write IHDR chunk// null terminator// PLTE cannot occur in a gray image// Special case: image is RGB and chunk is Gray// Promote chunk contents to RGB// Special case: image is RGB(A) and chunk is Gray// Make a gray bKGD chunk look like RGB// Ignore status of alpha in colorType// colorType == PNGImageReader.PNG_COLOR_RGB ||// colorType == PNGImageReader.PNG_COLOR_RGB_ALPHA// sampleDepth == 16// Adjust offsets and skips based on source subsampling factors// Early exit if no data for this pass// Convert X offset and skip from pixels to samples// Create row buffers// reserve space for alpha samples// will be used to calculate alpha value for the pixel// Reorder palette data if necessary// leave first 'bpp' bytes zero// Image can only have a single band// Left shift the last byte// Perform filtering// Swap current and previous rows// If write has been aborted, just return;// processWriteAborted will be called later// If the existing tables are still valid, just return// Compute new tables// bitDepth == 16// Divide scaling table into high and low bytes// Set source region and subsampling to default values// Compute total number of pixels for progress notification// Create metadata// Use Adam7 interlacing if set in write param// MODE_COPY_FROM_METADATA should alreay be taken care of// MODE_EXPLICIT is not allowed// Initialize bitDepth and colorType// Overwrite IHDR width and height values with values from image// Initialize scaling tables for this image// Finish up and inform the listeners we are donenew PNGImageWriter(...)// Ensure bitDepth is between 1 and 16// Check number of bands, alpha// Fix 4464413: PNGTransparency reg-test was failing// because for IndexColorModels that have alpha,// numBands == 1 && hasAlpha == true, thus causing// the check below to fail and return false.new ArrayList<Boolean>(...)new ArrayList<Integer>(...)new ArrayList<byte[]>(...)String nativeMetadataFormatClassName;...[] IHDR_colorTypeNames;// Color types for IHDR chunk...[] IHDR_numChannels;...[] IHDR_bitDepths;// Bit depths for IHDR chunk...[] IHDR_compressionMethodNames;// Compression methods for IHDR chunk...[] IHDR_filterMethodNames;// Filter methods for IHDR chunk...[] IHDR_interlaceMethodNames;// Interlace methods for IHDR chunk...[] iCCP_compressionMethodNames;// Compression methods for iCCP chunk...[] zTXt_compressionMethodNames;// Compression methods for zTXt chunkint PHYS_UNIT_UNKNOWN;// "Unknown" unit for pHYs chunkint PHYS_UNIT_METER;// "Meter" unit for pHYs chunk...[] unitSpecifierNames;// Unit specifiers for pHYs chunk...[] renderingIntentNames;// Rendering intents for sRGB chunk...[] colorSpaceTypeNames;// Color space types for Chroma->ColorSpaceType nodeboolean IHDR_present;// IHDR chunkint IHDR_width;int IHDR_height;int IHDR_bitDepth;int IHDR_colorType;int IHDR_compressionMethod;int IHDR_filterMethod;int IHDR_interlaceMethod;boolean PLTE_present;// PLTE chunk// 0 == none, 1 == adam7...[] PLTE_red;...[] PLTE_green;...[] PLTE_blue;...[] PLTE_order;// IndexColorModel image type.// PLTE_order will be null unless 'initialize' is called with an// 'i' in the source should be encoded as index 'PLTE_order[i]'.// order to minimize the size of the tRNS chunk.  Thus an index of// If non-null, used to reorder palette entries during encoding inboolean bKGD_present;// always store it as gray and promote when writing// If external (non-PNG sourced) data has red = green = blue,// bKGD chunkint bKGD_colorType;int bKGD_index;// PNG_COLOR_GRAY, _RGB, or _PALETTEint bKGD_gray;int bKGD_red;int bKGD_green;int bKGD_blue;boolean cHRM_present;// cHRM chunkint cHRM_whitePointX;int cHRM_whitePointY;int cHRM_redX;int cHRM_redY;int cHRM_greenX;int cHRM_greenY;int cHRM_blueX;int cHRM_blueY;boolean gAMA_present;// gAMA chunkint gAMA_gamma;boolean hIST_present;// hIST chunk...[] hIST_histogram;boolean iCCP_present;// iCCP chunkString iCCP_profileName;int iCCP_compressionMethod;...[] iCCP_compressedProfile;ArrayList<String> iTXt_keyword;// iTXt chunkArrayList<Boolean> iTXt_compressionFlag;ArrayList<Integer> iTXt_compressionMethod;ArrayList<String> iTXt_languageTag;ArrayList<String> iTXt_translatedKeyword;ArrayList<String> iTXt_text;boolean pHYs_present;// pHYs chunkint pHYs_pixelsPerUnitXAxis;int pHYs_pixelsPerUnitYAxis;int pHYs_unitSpecifier;boolean sBIT_present;// sBIT chunk// 0 == unknown, 1 == meterint sBIT_colorType;int sBIT_grayBits;// PNG_COLOR_GRAY, _GRAY_ALPHA, _RGB, _RGB_ALPHAint sBIT_redBits;int sBIT_greenBits;int sBIT_blueBits;int sBIT_alphaBits;boolean sPLT_present;// sPLT chunkString sPLT_paletteName;int sPLT_sampleDepth;// 1-79 characters...[] sPLT_red;// 8 or 16...[] sPLT_green;...[] sPLT_blue;...[] sPLT_alpha;...[] sPLT_frequency;boolean sRGB_present;// sRGB chunkint sRGB_renderingIntent;ArrayList<String> tEXt_keyword;// tEXt chunkArrayList<String> tEXt_text;boolean tIME_present;// tIME chunkint tIME_year;int tIME_month;int tIME_day;int tIME_hour;int tIME_minute;int tIME_second;boolean tRNS_present;// tRNS chunkint tRNS_colorType;...[] tRNS_alpha;int tRNS_gray;// May have fewer entries than PLTE_red, etc.int tRNS_red;int tRNS_green;int tRNS_blue;ArrayList<String> zTXt_keyword;// zTXt chunkArrayList<Integer> zTXt_compressionMethod;ArrayList<String> zTXt_text;ArrayList<String> unknownChunkType;// Unknown chunksArrayList<byte[]> unknownChunkData;/** Sets the IHDR_bitDepth and IHDR_colorType variables. ... */boolean isGrayint scalebyte redbyte[] newAlphaalpha.lengthint numTransparentbyte[] oldRedbyte[] oldGreenbyte[] oldBlueoldRed.lengthArrayList<byte[]> list// Deep clonePNGMetadata metadatacloneBytesArrayList(...)this.unknownChunkDataIIOMetadataNode IHDR_nodeIIOMetadataNode PLTE_nodePLTE_red.lengthIIOMetadataNode bKGD_nodeIIOMetadataNode cHRM_nodeIIOMetadataNode gAMA_nodeIIOMetadataNode hIST_nodehIST_histogram.lengthIIOMetadataNode histIIOMetadataNode iCCP_nodeObject profileIIOMetadataNode iTXt_parentIIOMetadataNode iTXt_nodeIIOMetadataNode pHYs_nodeIIOMetadataNode sBIT_nodeIIOMetadataNode sPLT_nodesPLT_red.lengthIIOMetadataNode sRGB_nodeIIOMetadataNode tEXt_parentIIOMetadataNode tEXt_nodeIIOMetadataNode tIME_nodeIIOMetadataNode tRNS_nodetRNS_alpha.lengthIIOMetadataNode zTXt_parentIIOMetadataNode zTXt_nodeint cmIIOMetadataNode unknown_parentIIOMetadataNode unknown_nodegetNumChannels(...)int alphaString bitDepthrepeat(...)String sbitsint maxindexNode PLTE_entryNode bKGD_nodeString bKGD_namechar[] histNode hIST_entryObject compressedProfileNode iTXt_nodeisValidKeyword(...)boolean compressionFlagString compressionMethodNode sBIT_nodeString sBIT_nameint[] redint[] greenint[] blueint[] alphaint[] frequencyNode sPLT_entryNode tEXt_nodeNode tRNS_nodeString tRNS_nameNode tRNS_paletteEntryNode zTXt_nodeNode unknown_nodeString chunkTypeObject chunkData/* Accrding to PNG spec, keywords are restricted to 1 to 79 bytes ... */isISOLatin(...)/* According to PNG spec, keyword shall contain only printable ... */float gammaint redint greenint blueint scansStringTokenizer tnew StringTokenizer(...)int maxBitshasMoreTokens(...)nextToken(...)int numTokenscountTokens(...)boolean gotWidthboolean gotHeightboolean gotAspectRatiofloat widthfloat heightint denomint numString languageString compression// Reset all instance variables to their initial state// 0// 1// 2// 3// TODO -- implement// Initialize IHDR_bitDepth// Choose max bit depth over all channels// Fixes bug 4413109// Multi-channel images must have a bit depth of 8 or 16// Round bit depth up to a power of 2// Initialize IHDR_colorType// Determine whether the color tables are actually a gray ramp// if the color type has not been set previously// Determine whether transparency exists/* NB: PNG_COLOR_GRAY_ALPHA color type may be not optimal for images ... */// Reorder the palette so that non-opaque entries// come first.  Since the tRNS chunk does not have// to store trailing 255's, this can save a// considerable amount of space when encoding// images with only one transparent pixel value,// e.g., images from GIF sources.// Scan for non-opaque entries and assign them// positions starting at 0.// Scan for opaque entries and assign them// positions following the non-opaque entries.// Reorder the palettes// All have the same length// Copy only the transparent entries into tRNS_alpha// unknownChunkData needs deep clone// IHDR// IHDR_compressionMethod must be 0 in PNG 1.1// IHDR_filterMethod must be 0 in PNG 1.1// PLTE// bKGD// cHRM// gAMA// hIST// iCCP// iTXt// pHYs// sBIT// sPLT// sRGB// tEXt// tIME// tRNS// zTXt// Determine number of channels// Be careful about palette color with transparency// sBIT_colorType == PNGImageReader.PNG_COLOR_RGB ||// sBIT_colorType == PNGImageReader.PNG_COLOR_RGB_ALPHA// Guard against partial overwrite// silently skip invalid text entry// not printable. Check whether this is an allowed// control char//                  } else if (childName.equals("ColorSpaceType")) {//                  } else if (childName.equals("NumChannels")) {// Use Adam7 if NumProgressiveScans > 1//                  } else if (childName.equals("CompressionTypeName")) {//                  } else if (childName.equals("Lossless")) {//                  } else if (childName.equals("BitRate")) {//                      } else if (childName.equals("PlanarConfiguration")) {//                      } else if (childName.equals("SampleFormat")) {//                      } else if (childName.equals("SampleMSB")) {//                  } else if (childName.equals("ImageOrientation")) {//                  } else if//                      (childName.equals("HorizontalPhysicalPixelSpacing")) {//                      (childName.equals("VerticalPhysicalPixelSpacing")) {//                  } else if (childName.equals("HorizontalPosition")) {//                  } else if (childName.equals("VerticalPosition")) {//                  } else if (childName.equals("HorizontalPixelOffset")) {//                  } else if (childName.equals("VerticalPixelOffset")) {// Find a reasonable rational approximation//                  } else if (childName.equals("SubimageInterpretation")) {//                  } else if (childName.equals("ImageCreationTime")) {// Just ignore this node, PNG requires keywords// Use a zTXt node// Use a tEXt node// Use an iTXt node// fake it//          } else if (name.equals("Transparency")) {//              Node child = node.getFirstChild();//              while (child != null) {//                  String childName = child.getNodeName();//                  if (childName.equals("Alpha")) {//                  } else if (childName.equals("TransparentIndex")) {//                  } else if (childName.equals("TransparentColor")) {//                  } else if (childName.equals("TileTransparencies")) {//                  } else if (childName.equals("TileOpacities")) {//                  }//                  child = child.getNextSibling();//          } else {//              // fatal(node, "Unknown child of root node!");String VALUE_0;String VALUE_1;String VALUE_12;String VALUE_23;String VALUE_31;String VALUE_59;String VALUE_60;String VALUE_255;String VALUE_MAX_16;String VALUE_MAX_32;// 2^16 - 1// 2^32 - 1String[] colorTypesPNGMetadata.IHDR_bitDepthsPNGMetadata.IHDR_compressionMethodNamesPNGMetadata.IHDR_filterMethodNamesPNGMetadata.IHDR_interlaceMethodNamesPNGMetadata.iCCP_compressionMethodNamesPNGMetadata.unitSpecifierNamesPNGMetadata.renderingIntentNamesPNGMetadata.zTXt_compressionMethodNamesnew PNGMetadataFormat(...)// root -> IHDR// root -> PLTE// root -> PLTE -> PLTEEntry// root -> bKGD// root -> bKGD -> bKGD_Grayscale// root -> bKGD -> bKGD_RGB// root -> bKGD -> bKGD_Palette// root -> cHRM// root -> gAMA// root -> hIST// root -> hISTEntry// root -> iCCP// root -> iTXt// root -> iTXt -> iTXtEntry// root -> pHYS// root -> sBIT// root -> sBIT -> sBIT_Grayscale// root -> sBIT -> sBIT_GrayAlpha// root -> sBIT -> sBIT_RGB// root -> sBIT -> sBIT_RGBAlpha// root -> sBIT -> sBIT_Palette// root -> sPLT// root -> sPLT -> sPLTEntry// root -> sRGB// root -> tEXt// root -> tEXt -> tEXtEntry// root -> tIME// root -> tRNS// root -> tRNS -> tRNS_Grayscale// root -> tRNS -> tRNS_RGB// root -> tRNS -> tRNS_Palette// root -> zTXt// root -> zTXt -> zTXtEntry// root -> UnknownChunks// root -> UnknownChunks -> UnknownChunk// Returns the sum of absolute differencesint badnessint currint differenceint upint[] filterBadnessint minBadnessbyte[] subFilteredRowsubFilter(...)byte[] upFilteredRowupFilter(...)byte[] averageFilteredRowbyte[] paethFilteredRowint upleftint predictor// Use type 0 for palette images/** This class is the Java Image IO plugin reader for WBMP images. ... */int wbmpType;WBMPMetadata metadata;/** Constructs <code>WBMPImageReader</code> from the provided ... */byte fixHeaderFieldnew WBMPMetadata(...)isValidWbmpType(...)metadata.wbmpTypereadMultiByteInteger(...)BufferedImage.TYPE_BYTE_BINARYWritableRaster tileMultiPixelPackedSampleModel sm/* This method verifies that given byte is valid wbmp type marker. ... */// TypeField// check for valid wbmp image// Read image width// Read image height// Get the SampleModel.// If noTransform is necessary, read the data.int MAX_WBMP_WIDTH;int MAX_WBMP_HEIGHT;WBMPMetadata.nativeMetadataFormatNameint fixHeaderFieldlong dataLengthlong scanSizenew WBMPImageReader(...)// check WBMP "header"// while WBMP reader does not support ext WBMP headers// check image dimension// We can't verify that amount of data in the stream// corresponds to image dimension because we do not know// the length of the data stream.// Assuming that wbmp image are used for mobile devices,// let's introduce an upper limit for image dimension.// In case if exact amount of raster data is unknown,// let's reject images with dimension above the limit.// Get the number of bits required to represent an int.// Convert an int value to WBMP multi-byte format.int numBitsLeftbyte[] multiBytesmultiBytes.length/** Constructs <code>WBMPImageWriter</code> based on the provided ... */WBMPMetadata metameta.wbmpTypeSampleModel destSMboolean isWhiteZerocheckSampleModel(...)getSample(...)intToMultiByte(...)byte[] invertedint col// default wbmp level// If the data are not formatted nominally then reformat.// Check whether the image is white-is-zero.// Get the line stride, bytes per row, and data array.// Write WBMP header.// FixHeaderField// Write the data.// Write the entire image.// Write the image row-by-row.// Black-is-zero// White-is-zero: need to invert data.new WBMPImageWriter(...)new WBMPMetadataFormat(...)import Fileimport ImageInputStreamSpiimport FileImageInputStreamClass<> inputClass;new FileImageInputStream(...)import ImageOutputStreamSpiimport FileImageOutputStreamClass<> outputClass;new FileImageOutputStream(...)import FileCacheImageInputStreamimport MemoryCacheImageInputStreamnew FileCacheImageInputStream(...)new MemoryCacheImageInputStream(...)import FileCacheImageOutputStreamOutputStream osnew FileCacheImageOutputStream(...)import RandomAccessFileimport Closeable/** Convenience class that closes a given resource (e.g. RandomAccessFile), ... */Closeable closeable;this.closeable/** This class provide means to properly close hanging ... */WeakHashMap<CloseAction,Object> toCloseQueue;Thread streamCloser;new WeakHashMap<CloseAction,Object>(...)Runnable streamCloserRunnableSet<CloseAction> setkeySet(...)CloseAction[] actionsnew CloseAction[]CloseAction caperformAction(...)ThreadGroup tggetThreadGroup(...)ThreadGroup tgnnew Thread(...)setContextClassLoader(...)addShutdownHook(...)getRuntime(...)new CloseAction(...)// Make a copy of the set in order to avoid// concurrent modification (the is.close()// will in turn call removeFromQueue())/* The thread must be a member of a thread group ... *//* Set context class loader to null in order to avoid ... *//** Small class to assist in properly closing an ImageInputStream instance ... *//** This class defines a content signing service. ... *//** Generates a PKCS #7 signed data message. ... */import URIimport X509Certificateimport ZipFile/** This interface encapsulates the parameters for a ContentSigner object. ... *//** Retrieves the command-line arguments passed to the jarsigner tool. ... *//** Retrieves the identifier for a Timestamping Authority (TSA). ... *//** Retrieves the certificate for a Timestamping Authority (TSA). ... *//** Retrieves the TSAPolicyID for a Timestamping Authority (TSA). ... *//** Retrieves the JAR file's signature. ... *//** Retrieves the name of the signature algorithm. ... *//** Retrieves the signer's X.509 certificate chain. ... *//** Retrieves the content that was signed. ... *//** Retrieves the original source ZIP file before it was signed. ... *//* Copyright (c) 2014, Oracle and/or its affiliates. All rights reserved. ... *//** This package comprises the interfaces and classes used to define the ... */import java.awt.event.*import javax.accessibility.*import javax.swing.event.*import AWT/** <P>The {@code AWTEventMonitor} implements a suite of listeners that are ... */new AWTEventsListener(...)boolean runningOnJDK1_4;Component componentWithFocus;/** The current component with keyboard focus. ... */Component componentWithFocus_private;ComponentListener componentListener;/** The current list of registered ComponentListener classes. ... */// Low-level listenersComponentListener componentListener_private;ContainerListener containerListener;/** The current list of registered ContainerListener classes. ... */ContainerListener containerListener_private;FocusListener focusListener;/** The current list of registered FocusListener classes. ... */FocusListener focusListener_private;KeyListener keyListener;/** The current list of registered KeyListener classes. ... */KeyListener keyListener_private;MouseListener mouseListener;/** The current list of registered MouseListener classes. ... */MouseListener mouseListener_private;MouseMotionListener mouseMotionListener;/** The current list of registered MouseMotionListener classes. ... */MouseMotionListener mouseMotionListener_private;WindowListener windowListener;/** The current list of registered WindowListener classes. ... */WindowListener windowListener_private;ActionListener actionListener;/** The current list of registered ActionListener classes. ... */// Semantic listenersActionListener actionListener_private;AdjustmentListener adjustmentListener;/** The current list of registered AdjustmentListener classes. ... */AdjustmentListener adjustmentListener_private;ItemListener itemListener;/** The current list of registered ItemListener classes. ... */ItemListener itemListener_private;TextListener textListener;/** The current list of registered TextListener classes. ... */TextListener textListener_private;AWTEventsListener awtListener;/** The actual listener that is installed on the component instances. ... */AWTEventsListener awtListener_private;/** Returns the component that currently has keyboard focus.  The return ... *//* Check permissions */SecurityManager securitycheckPermission(...)AWT.ALL_AWT_EVENTS_PERMISSION/** Adds the specified listener to receive all {@link EventID#COMPONENT COMPONENT} ... */checkInstallPermission(...)installListeners(...)EventID.COMPONENT/** Removes the specified listener so it no longer receives ... */removeListeners(...)/** Adds the specified listener to receive all {@link EventID#CONTAINER CONTAINER} ... *//** Adds the specified listener to receive all {@link EventID#FOCUS FOCUS} events ... *//** Removes the specified listener so it no longer receives {@link EventID#FOCUS FOCUS} ... *//** Adds the specified listener to receive all {@link EventID#KEY KEY} events on each ... */EventID.KEY/** Removes the specified listener so it no longer receives {@link EventID#KEY KEY} ... *//** Adds the specified listener to receive all {@link EventID#MOUSE MOUSE} events ... */EventID.MOUSE/** Adds the specified listener to receive all mouse {@link EventID#MOTION MOTION} ... */EventID.MOTION/** Adds the specified listener to receive all {@link EventID#WINDOW WINDOW} ... */EventID.WINDOW/** Adds the specified listener to receive all {@link EventID#ACTION ACTION} ... */EventID.ACTION/** Adds the specified listener to receive all ... */EventID.ADJUSTMENT/** Adds the specified listener to receive all {@link EventID#ITEM ITEM} events ... */EventID.ITEM/** Removes the specified listener so it no longer receives {@link EventID#ITEM ITEM} ... *//** Adds the specified listener to receive all {@link EventID#TEXT TEXT} events ... */EventID.TEXT/** Removes the specified listener so it no longer receives {@link EventID#TEXT TEXT} ... *//** AWTEventsListener is the class that does all the work for AWTEventMonitor. ... */...[] actionListeners;/** internal variables for Action introspection */Method removeActionMethod;Method addActionMethod;...[] actionArgs;...[] itemListeners;/** internal variables for Item introspection */Method removeItemMethod;Method addItemMethod;...[] itemArgs;...[] textListeners;/** internal variables for Text introspection */Method removeTextMethod;Method addTextMethod;...[] textArgs;...[] windowListeners;/** internal variables for Window introspection */Method removeWindowMethod;Method addWindowMethod;...[] windowArgs;/** Create a new instance of this class and install it on each component ... */String versioninitializeIntrospection(...)addChangeListener(...)defaultManager(...)addTopLevelWindowListener(...)/** Set up all of the variables needed for introspection *//** Installs all currently registered listeners on all components based ... */Window[] topLevelWindowsgetTopLevelWindows(...)topLevelWindows.length/** Installs listeners for the given event ID on all components based ... *//** Installs all currently registered listeners to just the component. ... */EventID.CONTAINEREventID.FOCUSAWTEventMonitor.componentListener_privateAWTEventMonitor.keyListener_privateAWTEventMonitor.mouseListener_privateAWTEventMonitor.mouseMotionListener_privateAWTEventMonitor.windowListener_privateAWTEventMonitor.actionListener_privateAWTEventMonitor.adjustmentListener_privateAWTEventMonitor.itemListener_privateAWTEventMonitor.textListener_privateprocessFocusGained(...)Component focusOwnergetFocusOwner(...)getCurrentKeyboardFocusManager(...)removeChangeListener(...)MenuElement[] pathgetSelectedPath(...)path.lengthComponent penultgetComponent(...)Component last/** Installs the given listener on the component and any of its children. ... */InvocationTargetException eIllegalAccessException eSecurityException eremoveAdjustmentListener(...)addAdjustmentListener(...)removeComponentListener(...)addComponentListener(...)removeContainerListener(...)addContainerListener(...)removeFocusListener(...)addFocusListener(...)hasFocus(...)removeKeyListener(...)addKeyListener(...)removeMouseListener(...)addMouseListener(...)removeMouseMotionListener(...)addMouseMotionListener(...)getComponentCount(...)/** Removes all listeners for the given event ID on all components based ... *//** Removes all listeners for the given component and all its children. ... *//** Removes all listeners for the event ID from the component and all ... *//** Called when top level window is created. ... *//* TopLevelWindow Methods ************************************** *//** ***************************************************************** *//* Listener Interface Methods *//** Called when top level window is destroyed. ... *//** Called when an action is performed. ... *//* ActionListener Methods ************************************** */actionPerformed(...)/** Called when an adjustment is made. ... *//* AdjustmentListener Methods ********************************** */adjustmentValueChanged(...)/** Called when a component is hidden. ... *//* ComponentListener Methods *********************************** */componentHidden(...)/** Called when a component is moved. ... */componentMoved(...)/** Called when a component is resized. ... */componentResized(...)/** Called when a component is shown. ... */componentShown(...)/** Called when a component is added to a container. ... *//* ContainerListener Methods *********************************** */getChild(...)AWTEventMonitor.containerListener_privatecomponentAdded(...)/** Called when a component is removed from a container. ... */componentRemoved(...)/** Called when a component gains keyboard focus. ... *//* FocusListener Methods *************************************** */AWTEventMonitor.componentWithFocus_privategetSource(...)AWTEventMonitor.focusListener_privatefocusGained(...)/** Called when a component loses keyboard focus. ... */focusLost(...)/** Called when an item's state changes. ... *//* ItemListener Methods **************************************** */itemStateChanged(...)/** Called when a key is pressed. ... *//* KeyListener Methods ***************************************** */keyPressed(...)/** Called when a key is typed. ... */keyReleased(...)/** Called when a key is released. ... */keyTyped(...)/** Called when the mouse is clicked. ... *//* MouseListener Methods *************************************** */mouseClicked(...)/** Called when the mouse enters a component. ... */mouseEntered(...)/** Called when the mouse leaves a component. ... */mouseExited(...)/** Called when the mouse is pressed. ... */mousePressed(...)/** Called when the mouse is released. ... */mouseReleased(...)/** Called when the mouse is dragged. ... *//* MouseMotionListener Methods ********************************* */mouseDragged(...)/** Called when the mouse is moved. ... */mouseMoved(...)/** Called when a component's text value changed. ... *//* TextListener Methods **************************************** */textValueChanged(...)/** Called when a window is opened. ... *//* WindowListener Methods ************************************** */windowOpened(...)/** Called when a window is in the process of closing. ... */windowClosing(...)/** Called when a window is closed. ... */windowClosed(...)/** Called when a window is iconified. ... */windowIconified(...)/** Called when a window is deiconified. ... */windowDeiconified(...)/** Called when a window is activated. ... */windowActivated(...)/** Called when a window is deactivated. ... */windowDeactivated(...)// Container and focus listeners are always installed for our own use.// conditionally install low-level listeners// conditionally install Semantic listeners// Only menus and popup selections are handled by the JRootPane.// This is a popup with nothing in the popup// selected. The menu itself is selected.// This is a popup with an item selected// The focus owner has the selection.// install the appropriate listener hook into this component// System.out.println("Exception: " + e.toString());// not runningOnJDK1_4// [PK] CheckboxMenuItem isn't a component but it does// implement Interface ItemSelectable!!// if (c instanceof CheckboxMenuItem) {//     ((CheckboxMenuItem) c).removeItemListener(this);//     ((CheckboxMenuItem) c).addItemListener(this);// Don't bother recursing the children if this isn't going to// accomplish anything.// if this component is a container, recurse through children// conditionally remove low-level listeners// Remove semantic listeners// remove the appropriate listener hook into this component// Never remove these because we're always interested in them// for our own use.//case EventID.CONTAINER://    if (c instanceof Container) {//        ((Container) c).removeContainerListener(this);//    break;//case EventID.FOCUS://    c.removeFocusListener(this);/** <P>{@code AccessibilityEventMonitor} implements a PropertyChange listener ... */new AccessibilityListenerList(...)new AccessibilityEventListener(...)AccessibilityListenerList listenerList;/** The current list of registered {@link java.beans.PropertyChangeListener ... */// listenersAccessibilityEventListener accessibilityListener;/** Adds the specified listener to receive all PropertyChange events on ... */getListenerCount(...)/** Removes the specified listener so it no longer receives PropertyChange ... *//** AccessibilityEventListener is the class that does all the work for ... *//** Installs PropertyChange listeners on all Accessible objects based ... *//** Installs PropertyChange listeners to the Accessible object, and it's ... */getAccessibleContext(...)/** Installs PropertyChange listeners to the AccessibleContext object, ... */AccessibleStateSet statesgetAccessibleStateSet(...)AccessibleState.TRANSIENTAccessibleStateSet setAccessibleRole rolegetAccessibleRole(...)getAccessibleChildrenCount(...)_AccessibleState.MANAGES_DESCENDANTSAccessibleRole.LISTAccessibleRole.TREEAccessibleRole.TABLEAccessible childgetAccessibleChild(...)AccessibleContext ac2/** Removes PropertyChange listeners on all Accessible objects based ... *//** Removes PropertyChange listeners for the given Accessible object, ... *//** Removes PropertyChange listeners for the given AccessibleContext ... *//* PropertyChangeListener Methods ************************************* */Object[] listenersgetListenerList(...)AccessibilityEventMonitor.listenerListlisteners.lengthAccessibleContext.ACCESSIBLE_CHILD_PROPERTYgetOldValue(...)Object newValueAccessible a/* workaround for no public AccessibleState constructor */new _AccessibleState(...)_AccessibleState MANAGES_DESCENDANTS;/** Indicates this object is responsible for managing its ... *//** Creates a new AccessibleState using the given locale independent key. ... *//* Don't add listeners to transient children. Components ... */// handle Oracle tables containing tables// Listeners are not added to transient components./* Listeners are not added to transient children. Components ... */// propogate the event// handle childbirth/death// one null, not both// this Accessible is a child that's going away// this Accessible is a child was just born/** <P>The {@code AccessibilityListenerList} is a copy of the Swing ... */...[] NULL_ARRAY;/* A null array to be shared by all empty listener lists */...[] listenerList;/** The list of listener type, listener pairs *//** Passes back the event listener list as an array of listener type, listener pairs. ... *//** Returns the total number of listeners for this listener list. ... */listenerList.length/** Return the total number of listeners of the supplied type ... */Object[] lListlList.length/** Add the listener as a listener of the specified type. ... */Object[] tmp/** Remove the listener as a listener of the specified type. ... *//** Return a string representation of the {@code AccessibilityListenerList}. ... */// if this is the first listener added,// initialize the lists// Otherwise copy the array and add the new listener// Is l on the list?// If so,  remove it// Copy the list up to index// Copy from two past the index, up to// the end of tmp (which is two elements// shorter than the old list)// set the listener array to the new array or null/** EventID contains integer constants that map to event support in ... */int ACTION;/** Maps to AWT Action support (i.e., ActionListener and ActionEvent) */int ADJUSTMENT;/** Maps to AWT Adjustment support (i.e., AdjustmentListener ... */int COMPONENT;/** Maps to AWT Component support (i.e., ComponentListener ... */int CONTAINER;/** Maps to AWT Container support (i.e., ContainerListener ... */int FOCUS;/** Maps to AWT Focus support (i.e., FocusListener and FocusEvent) */int ITEM;/** Maps to AWT Item support (i.e., ItemListener and ItemEvent) */int KEY;/** Maps to AWT Key support (i.e., KeyListener and KeyEvent) */int MOUSE;/** Maps to AWT Mouse support (i.e., MouseListener and MouseEvent) */int MOTION;/** Maps to AWT MouseMotion support (i.e., MouseMotionListener ... */int TEXT;/** Maps to AWT Text support (i.e., TextListener and TextEvent) */int WINDOW;/** Maps to AWT Window support (i.e., WindowListener and WindowEvent) */int ANCESTOR;/** Maps to Swing Ancestor support (i.e., AncestorListener and ... */int CARET;/** Maps to Swing Text Caret support (i.e., CaretListener and ... */int CELLEDITOR;/** Maps to Swing CellEditor support (i.e., CellEditorListener and ... */int CHANGE;/** Maps to Swing Change support (i.e., ChangeListener and ... */int COLUMNMODEL;/** Maps to Swing TableColumnModel support (i.e., ... */int DOCUMENT;/** Maps to Swing Document support (i.e., DocumentListener and ... */int LISTDATA;/** Maps to Swing ListData support (i.e., ListDataListener and ... */int LISTSELECTION;/** Maps to Swing ListSelection support (i.e., ListSelectionListener and ... */int MENU;/** Maps to Swing Menu support (i.e., MenuListener and ... */int POPUPMENU;/** Maps to Swing PopupMenu support (i.e., PopupMenuListener and ... */int TABLEMODEL;/** Maps to Swing TableModel support (i.e., TableModelListener and ... */int TREEEXPANSION;/** Maps to Swing TreeExpansion support (i.e., TreeExpansionListener and ... */int TREEMODEL;/** Maps to Swing TreeModel support (i.e., TreeModelListener and ... */int TREESELECTION;/** Maps to Swing TreeSelection support (i.e., TreeSelectionListener and ... */int UNDOABLEEDIT;/** Maps to Swing UndoableEdit support (i.e., UndoableEditListener and ... */int PROPERTYCHANGE;/** Maps to Beans PropertyChange support (i.e., PropertyChangeListener ... */int VETOABLECHANGE;/** Maps to Beans VetoableChange support (i.e., VetoableChangeListener ... */int INTERNALFRAME;/** Maps to Swing InternalFrame support (i.e., InternalFrameListener) *//** The {@code EventQueueMonitor} class provides key core functionality for Assistive ... */new Vector<>(...)Vector<> topLevelWindows;// The stuff that is cached.//        EventQueue instances.//        we can guarantee we get the information from all of the//        in use in the same VM.  By making these properties static,//        for this is that there may be multiple EventQueue instances// NOTE:  All of the following properties are static.  The reasonWindow topLevelWindowWithFocus;Point currentMousePosition;Component currentMouseComponent;GUIInitializedListener guiInitializedListener;// Low-level listener interfacesTopLevelWindowListener topLevelWindowListener;boolean guiInitialized;/** Class variable stating whether the GUI subsystem has been initialized ... *//** Class variable stating whether the assistive technologies have ... */EventQueueMonitorItem componentEventQueue;/** Queue that holds events for later processing. */ComponentEvtDispatchThread cedt;/** Class that tells us what the component event dispatch thread is. */Object componentEventQueueLock;/** Handle the synchronization between the thing that populates the ... *//** Create a new {@code EventQueueMonitor} instance.  Normally, this will ... */new ComponentEvtDispatchThread(...)setDaemon(...)start(...)/** Queue up a {@link java.awt.event.ComponentEvent ComponentEvent} for later ... */EventQueueMonitorItem eqinew EventQueueMonitorItem(...)EventQueueMonitorItem qq.nextnotifyAll(...)/** Tell the {@code EventQueueMonitor} to start listening for events. */long eventMaskAWTEvent.MOUSE_MOTION_EVENT_MASKAWTEvent.WINDOW_EVENT_MASKAWTEvent.FOCUS_EVENT_MASKaddAWTEventListener(...)new EventQueueMonitor(...)/** Handle events as a result of registering a listener ... */processEvent(...)/** Assisitive technologies that have ... */guiInitialized(...)/** Add a Container to the list of top-level containers ... *//* Package Private Methods */Container parentaddTopLevelWindow(...)topLevelWindowCreated(...)/** Removes a container from the list of top level containers in the cache. ... */removeElement(...)topLevelWindowDestroyed(...)/** Update current mouse position. ... */Point oldMousePosPoint eventPointgetPoint(...)getLocationOnScreen(...)eventPoint.xeventPoint.y/** Process the event.  This maintains the event cache in addition ... */getID(...)FocusEvent.FOCUS_GAINEDWindowEvent.WINDOW_DEACTIVATEDqueueComponentEvent(...)WindowEvent.WINDOW_ACTIVATEDComponentEvent cemaybeNotifyAssistiveTechnologies(...)WindowEvent.WINDOW_OPENEDWindowEvent.WINDOW_CLOSEDremoveTopLevelWindow(...)/** Internal test */int ncomponentsComponent compisShowing(...)Point locationlocation.xlocation.y/** Return the Component at the given Point on the screen in the ... */Point containerLocPoint containerPointcontainerLoc.xcontainerLoc.ygetShowingComponentAt(...)containerPoint.xcontainerPoint.ygetComponentAt(...)/** Obtain the {@link javax.accessibility.Accessible Accessible} object at the given point on the Screen. ... */Window wgetTopLevelWindowWithFocus(...)Window[] winsComponent cwins.lengthAccessibleContext acAccessibleComponent acmpgetAccessibleComponent(...)move(...)getAccessibleAt(...)getAccessible(...)/** Says whether the GUI subsystem has been initialized or not. ... *//* Public Methods */maybeInitialize(...)/** Adds the specified listener to be notified when the GUI subsystem ... *//** Removes the specified listener to be notified when the GUI subsystem ... *//** Adds the specified listener to be notified when a top level window ... *//** Removes the specified listener to be notified when a top level window ... *//** Return the last recorded position of the mouse in screen coordinates. ... *//** Return the list of top level Windows in use in the Java Virtual Machine. ... */Window[] wnew Window[]elementAt(...)/** Return the top level {@code Window} that currently has keyboard focus. ... *//** Handle all Component events in a separate thread.  The reason for this is ... */EventQueueMonitor.componentEventQueueLockEventQueueMonitor.componentEventQueuewait(...)InterruptedException eEventQueueMonitor.componentEventQueue.eventEventQueueMonitor.componentEventQueue.nextupdateCurrentMousePosition(...)EventQueueMonitor.topLevelWindowWithFocus/** EventQueueMonitorItem is the basic type that handles the ... */AWTEvent event;EventQueueMonitorItem next;// Because this method is static, do not make it synchronized because// it can lock the whole class.  Instead, just lock what needs to be// locked.// Be careful here.  The component in the event might be// hidden by the time we process the event.// Dialogs fire WINDOW_ACTIVATED and FOCUS_GAINED events// before WINDOW_OPENED so we need to add topLevelListeners// for the dialog when it is first activated to get a// focus gained event for the focus component in the dialog.// handle WINDOW_OPENED and WINDOW_CLOSED events synchronously// See if the point we're being asked about is the// currentMousePosition.  If so, start with the component// that we know the currentMousePostion is over// Try the window with focus next// Try the other windows next.  [[[WDW: Stacking order???]]]/** The {@code GUIInitializedListener} interface is used by the {@link EventQueueMonitor} ... *//** Invoked when the GUI subsystem is initialized and it's OK for ... */import EventListener/** The GUIInitializedMulticaster class is used to maintain a list of ... */addInternal(...)removeInternal(...)new GUIInitializedMulticaster(...)// it's not hereimport javax.swing.table.*import javax.swing.tree.*import javax.swing.text.*import javax.swing.undo.*/** <P>{@code SwingEventMonitor} extends {@link AWTEventMonitor} by adding a suite of ... */new EventListenerList(...)new SwingEventListener(...)EventListenerList listenerList;/** The master list of all listeners registered by other classes. ... */SwingEventListener swingListener;/** Adds the specified listener to receive all {@link EventID#ANCESTOR ANCESTOR} ... */EventID.ANCESTOR/** Adds the specified listener to receive all {@link EventID#CARET CARET} events ... */EventID.CARETEventID.CELLEDITOR/** Adds the specified listener to receive all {@link EventID#CHANGE CHANGE} ... */EventID.CHANGE/** Adds the specified listener to receive all {@link EventID#COLUMNMODEL COLUMNMODEL} ... */EventID.COLUMNMODEL/** Adds the specified listener to receive all {@link EventID#DOCUMENT DOCUMENT} ... */EventID.DOCUMENT/** Adds the specified listener to receive all {@link EventID#LISTDATA LISTDATA} ... */EventID.LISTDATA/** Adds the specified listener to receive all {@link EventID#LISTSELECTION LISTSELECTION} ... */EventID.LISTSELECTION/** Adds the specified listener to receive all {@link EventID#MENU MENU} events ... */EventID.MENU/** Adds the specified listener to receive all {@link EventID#POPUPMENU POPUPMENU} ... */EventID.POPUPMENU/** Adds the specified listener to receive all {@link EventID#TABLEMODEL TABLEMODEL} ... */EventID.TABLEMODEL/** Adds the specified listener to receive all {@link EventID#TREEEXPANSION TREEEXPANSION} ... */EventID.TREEEXPANSION/** Adds the specified listener to receive all {@link EventID#TREEMODEL TREEMODEL} ... */EventID.TREEMODEL/** Adds the specified listener to receive all {@link EventID#TREESELECTION TREESELECTION} ... */EventID.TREESELECTION/** Adds the specified listener to receive all {@link EventID#UNDOABLEEDIT UNDOABLEEDIT} ... */EventID.UNDOABLEEDIT/** Adds the specified listener to receive all {@link EventID#INTERNALFRAME INTERNALFRAME} ... */EventID.INTERNALFRAME/** Adds the specified listener to receive all {@link EventID#PROPERTYCHANGE PROPERTYCHANGE} ... */EventID.PROPERTYCHANGE/** Adds the specified listener to receive all {@link EventID#VETOABLECHANGE VETOABLECHANGE} ... */EventID.VETOABLECHANGE/** SwingEventListener is the class that does all the work for ... */...[] caretListeners;/** internal variables for Caret introspection */Method removeCaretMethod;Method addCaretMethod;...[] caretArgs;...[] cellEditorListeners;/** internal variables for CellEditor introspection */Method removeCellEditorMethod;Method addCellEditorMethod;...[] cellEditorArgs;Method getCellEditorMethod;...[] changeListeners;/** internal variables for Change introspection */Method removeChangeMethod;Method addChangeMethod;...[] changeArgs;Method getColumnModelMethod;/** internal variable for ColumnModel introspection */...[] documentListeners;/** internal variables for Document introspection */Method removeDocumentMethod;Method addDocumentMethod;...[] documentArgs;Method getDocumentMethod;Method getModelMethod;/** internal variable for ListData, Table, and Tree introspection */...[] listSelectionListeners;/** internal variables for ListSelection introspection */Method removeListSelectionMethod;Method addListSelectionMethod;...[] listSelectionArgs;Method getSelectionModelMethod;...[] menuListeners;/** internal variables for Menu introspection */Method removeMenuMethod;Method addMenuMethod;...[] menuArgs;...[] popupMenuListeners;/** internal variables for PopupMenu introspection */Method removePopupMenuMethod;Method addPopupMenuMethod;...[] popupMenuArgs;Method getPopupMenuMethod;...[] treeExpansionListeners;/** internal variables for TreeExpansion introspection */Method removeTreeExpansionMethod;Method addTreeExpansionMethod;...[] treeExpansionArgs;...[] treeSelectionListeners;/** internal variables for TreeSelection introspection */Method removeTreeSelectionMethod;Method addTreeSelectionMethod;...[] treeSelectionArgs;...[] undoableEditListeners;/** internal variables for UndoableEdit introspection */Method removeUndoableEditMethod;Method addUndoableEditMethod;...[] undoableEditArgs;...[] internalFrameListeners;/** internal variables for InternalFrame introspection */Method removeInternalFrameMethod;Method addInternalFrameMethod;...[] internalFrameArgs;...[] propertyChangeListeners;/** internal variables for PropertyChange introspection */Method removePropertyChangeMethod;Method addPropertyChangeMethod;...[] propertyChangeArgs;...[] nullClass;/** internal variables for a variety of change introspections */...[] nullArgs;/** Installs all appropriate Swing listeners to just the component. ... */SwingEventMonitor.listenerList/** Installs all appropriate Swing listeners to the component and all its ... */removeAncestorListener(...)addAncestorListener(...)Object oremoveCellEditorListener(...)addCellEditorListener(...)removeColumnModelListener(...)addColumnModelListener(...)removeDocumentListener(...)addDocumentListener(...)removeListDataListener(...)addListDataListener(...)removeTableModelListener(...)addTableModelListener(...)removeTreeModelListener(...)addTreeModelListener(...)removeListSelectionListener(...)addListSelectionListener(...)removeUndoableEditListener(...)addUndoableEditListener(...)removeVetoableChangeListener(...)addVetoableChangeListener(...)/** Removes all Swing listeners for the event ID from the component and ... *//* AncestorListener Methods ***************************************** */ancestorAdded(...)ancestorRemoved(...)ancestorMoved(...)/* CaretListener Methods ***************************************** */caretUpdate(...)/* CellEditorListener Methods **************************************** */editingStopped(...)editingCanceled(...)/* ChangeListener Methods **************************************** */stateChanged(...)/* TableColumnModelListener Methods ****************************** */columnAdded(...)columnMarginChanged(...)columnMoved(...)columnRemoved(...)columnSelectionChanged(...)/* DocumentListener Methods ************************************* */changedUpdate(...)insertUpdate(...)removeUpdate(...)/* ListDataListener Methods **************************************** */contentsChanged(...)intervalAdded(...)intervalRemoved(...)/* ListSelectionListener Methods ********************************** */valueChanged(...)/* MenuListener Methods **************************************** */menuCanceled(...)menuDeselected(...)menuSelected(...)/* PopupMenuListener Methods ************************************* */popupMenuWillBecomeVisible(...)popupMenuWillBecomeInvisible(...)popupMenuCanceled(...)/* TableModelListener Methods ************************************* */tableChanged(...)/* TreeExpansionListener Methods ********************************* */treeCollapsed(...)treeExpanded(...)/* TreeModelListener Methods ********************************* */treeNodesChanged(...)treeNodesInserted(...)treeNodesRemoved(...)treeStructureChanged(...)/* TreeSelectionListener Methods ********************************** *//* UndoableEditListener Methods ************************************* */undoableEditHappened(...)/* InternalFrame Methods ********************************* */internalFrameOpened(...)internalFrameActivated(...)internalFrameDeactivated(...)internalFrameIconified(...)internalFrameDeiconified(...)internalFrameClosing(...)internalFrameClosed(...)/* PropertyChangeListener Methods ********************************* */Document cgetDocument(...)InvocationTargetException e2IllegalAccessException e2NoSuchMethodException e2SecurityException e2/* VetoableChangeListener Methods ********************************* */vetoableChange(...)// This SwingEventListener needs to be notified when a new// Swing component has been added so it can add Swing listeners// to these components.  As a result, we always need a Container// listener on every Container.// conditionally install Swing listeners// Conditionally install Beans listeners// Now install the AWT listeners if needed.//  Look for components which support the getCellEditor method//  (e.g. JTable, JTree)//  Look for components which support CellEditor listeners//  (no current example)//  [[[FIXME:  Need to add support for Style, StyleContext  -pk]]]//  Look for components which support Change listeners//  (e.g. AbstractButton, Caret, JProgressBar, JSlider,//   JTabbedpane, JTextComponent, JViewport)//  Look for components which support the getModel method//  whose model supports Change listeners//  (e.g. BoundedRangeModel, ButtonModel, SingleSelectionModel)//  Look for components which support the getDocument method//  (e.g. JTextComponent)//  Look for components which support Document listeners//  Add the monitor as a PropertyChangeListener for document//  change events from text components.//  Look for components which support ListSelectionListeners//  (e.g. JList)//  Look for selection models which support ListSelectionListeners//  (e.g. JTable's selection model)//  Look for components which support PopupMenuListeners//  (e.g. JPopupMenu)//  Look for components which support getPopupMenu//  (e.g. JMenu)//  Look for components which support UndoableEdit listeners//  Look for components which support InternalFrame listeners//  (e.g. JInternalFrame)//  Look for components which support PropertyChange listeners//  (e.g. JComponent)//  Look for components which support the getSelectionModel method// conditionaly remove the Swing listeners// conditionaly remove the beans listeners// Now remove the AWT listeners if needed.//Never remove these because we're always interested in them//  [[[FIXME:  Need to add support for Style, StyleContext -pk ]]]// Look for selection models which support// ListSelectionListeners (e.g. JTable's selection model)// Look for components which support the getSelectionModel// method (e.g. JTextComponent)// Re-add the monitor as a DocumentChangeListener if// the document changed in the text component.// System.out.println("Exception: " + e2.toString());/** The {@code TopLevelWindowListener} interface is used by the {@link EventQueueMonitor} ... *//** Invoked when a new top level window has been created. ... *//** Invoked when a top level window has been destroyed. ... *//** The TopLevelWindowMulticaster class is used to maintain a list of ... */new TopLevelWindowMulticaster(...)/** <p>The {@code Translator} class provides a translation to interface ... */Object source;/** The source object needing translating. *//** Find a translator for this class.  If one doesn't exist for this ... */Class<> tgetTranslatorClass(...)/** Obtain an object that implements interface {@code Accessible}.  If the object ... */Class<> translatorClassTranslator tnew Translator(...)/** Create a new {@code Translator}.  You must call the {@link #setSource setSource} ... *//** Create a new {@code Translator} with the source object o. ... *//** Get the source {@code Object} of the {@code Translator}. ... *//** Set the source object of the {@code Translator}. ... *//** Returns true if this object is the same as the one passed in. ... *//** Returns this object. */// Accessible methods/** Get the accessible name of this object. ... */// AccessibleContext methods/** Set the name of this object. */setLabel(...)setName(...)/** Get the accessible description of this object. ... *//** Set the accessible description of this object. ... *//** Get the role of this object. ... */AccessibleRole.UNKNOWN/** Get the state of this object, given an already populated state. ... */new AccessibleStateSet(...)Container pAccessibleState.FOCUSEDisEnabled(...)AccessibleState.ENABLEDisFocusTraversable(...)AccessibleState.FOCUSABLE/** Get the accessible parent of this object. ... *//** Get the index of this object in its accessible parent. ... */Component[] cagetComponents(...)ca.length/** Returns the number of accessible children in the object. ... */Component[] children/** Return the nth accessible child of the object. ... */setAccessibleParent(...)/** Gets the {@code Locale} of the component. If the component does not have a ... *//** Add a {@code PropertyChangeListener} to the listener list.  The listener ... *//** Remove the {@code PropertyChangeListener} from the listener list. *//** Get the background {@code Color} of this object. ... */// AccessibleComponent methodsgetBackground(...)/** Set the background {@code Color} of this object. ... *//** Get the foreground {@code Color} of this object. ... */getForeground(...)/** Set the foreground {@code Color} of this object. ... */setForeground(...)/** Get the {@code Cursor} of this object. ... */getCursor(...)/** Set the {@code Cursor} of this object. ... */setCursor(...)/** Get the {@code Font} of this object. ... *//** Set the {@code Font} of this object. ... *//** Get the {@code FontMetrics} of this object. ... *//** Determine if the object is enabled. ... *//** Set the enabled state of the object. ... */setEnabled(...)/** Determine if the object is visible. ... */isVisible(...)/** Set the visible state of the object. ... */setVisible(...)/** Determine if the object is showing.  This is determined by checking ... *//** Checks whether the specified {@code Point} is within this ... *//** Returns the location of the object on the screen. ... *//** Returns the location of the object relative to parent. ... *//** Sets the location of the object relative to parent. *//** Returns the current bounds of this object. ... *//** Sets the current bounds of this object. *//** Returns the current size of this object. ... *//** Sets the current size of this object. *//** Returns the accessible child contained at the local coordinate ... *//** Returns whether this object can accept focus or not. ... *//** Requests focus for this object. */requestFocus(...)/** Adds the specified {@code FocusListener} to receive focus events from ... *//** Removes the specified focus listener so it no longer receives focus ... */// Do not import Swing classes.  This module is intended to work// with both Swing and AWT.// import javax.swing.*;// MenuComponent doesn't do background// MenuComponent doesn't do foreground// MenuComponent doesn't do cursorimport com.sun.java.accessibility.util.*/** <p>The Translator class provides a translation to interface Accessible ... *//** Get the name of this object. ... */AccessibleRole.PUSH_BUTTON/** Get the state of this object. ... */getState(...)AccessibleState.CHECKEDAccessibleRole.CHECK_BOXAccessibleRole.LABELisMultipleMode(...)AccessibleState.MULTISELECTABLEgetSelectedItems(...).lengthgetSelectedItems(...)AccessibleState.SELECTEDAccessibleRole.TEXT/* Copyright (c) 2013, 2015 Oracle and/or its affiliates. All rights reserved. ... *//** Provides a collection of interfaces and classes that compose the Java Accessibility ... *//** Constructs a new DOMAccessException with no detail message. *//** Constructs a new DOMAccessException with the given detail message. ... *//** Constructs a new DOMAccessException with the given exception as a root clause. ... *//** Constructs a new DOMAccessException with the given exception as a root clause and the given detail message. ... */this.exthis.msg/** Returns the detail message of the error or null if there is no detail message. *//** Returns the root cause of the error or null if there is none. */Throwable ex;String msg;/** Returns the Document object of the DOM. *//** Returns a DOMImplementation object. *//** When an object implementing interface DOMAction is passed ... *//** Returns new instance of a DOMService. The implementation ... */String providernew GetPropertyAction(...)new DOMUnsupportedException(...)/** An empty constructor is provided. Implementations of this ... *//** Causes action.run() to be executed synchronously on the ... *//** Causes action.run() to be executed asynchronously on the ... *//* Copyright (c) 2000, 2001, Oracle and/or its affiliates. All rights reserved. ... *//** An empty constructor is provided. Implementations should ... *//** Returns true if the DOMService can determine the association ... *//** Returns the DOMImplemenation object of the DOM. *//** Constructs a new DOMUnsupportedException with no detail message. *//** Constructs a new DOMUnsupportedException with the given detail message. ... *//** Constructs a new DOMUnsupportedException with the given exception as a root clause. ... *//** Constructs a new DOMUnsupportedException with the given exception as a root clause and the given detail message. ... *//** @author */ProxyServiceProvider provider;/** <p>The function returns proxy information of the specified URL.</p> ... */getProxyInfo(...)/** This class is preserved for backward compatibility with JDK 6. ... */import EventQueueDelegateimport AppContextimport Callableimport Appletimport AWTEventimport EventQueueimport Containerimport Windowimport RepaintManager/** A collection of utility methods for Swing. ... */synchronizedMap(...)new WeakHashMap<Container,Boolean>(...)Object DELEGATE_REPAINT_MANAGER_KEY;/** The {@code clientProperty} key for delegate {@code RepaintManager} *//** Registers delegate RepaintManager for {@code JComponent}. */getAppContext(...)putClientProperty(...)Map<Container,Boolean> vsyncedMap;/** Sets vsyncRequested state for the {@code rootContainer}.  If ... *//** Checks if vsync painting is requested for {@code rootContainer} ... *//** Returns delegate {@code RepaintManager} for {@code component} hierarchy. */RepaintManager delegatetargetToAppContext(...)/* We use maps to avoid reflection. Hopefully it should perform better ... */setDelegate(...)new EventQueueDelegateFromMap(...)...[] afterDispatchEventArgument;...[] afterDispatchHandleArgument;Callable<Void> afterDispatchCallable;...[] beforeDispatchEventArgument;Callable<Object> beforeDispatchCallable;...[] getNextEventEventQueueArgument;Callable<AWTEvent> getNextEventCallable;Map<String,Object> methodMapcall(...)/* Copyright (c) 2002, 2010, Oracle and/or its affiliates. All rights reserved. ... *//* setting up flag in AppContext to speed up lookups in case ... */import javax.swing.colorchooser.*import javax.swing.plaf.*/** A color chooser panel mimicking that of GTK's: a color wheel showing ... */Math.PIfloat PI_3;ColorTriangle triangle;JLabel lastLabel;JLabel label;JSpinner hueSpinner;JSpinner saturationSpinner;JSpinner valueSpinner;JSpinner redSpinner;JSpinner greenSpinner;JSpinner blueSpinner;JTextField colorNameTF;boolean settingColor;float hue;// value.// The colors are mirrored to avoid creep in adjusting an individualfloat saturation;float brightness;// PENDING: remove this when a variant of this is added to awt./** Convenience method to transfer focus to the next child of component. */Container containerContainer rootAncestorgetFocusCycleRootAncestor(...)isFocusCycleRoot(...)FocusTraversalPolicy policygetFocusTraversalPolicy(...)getDefaultComponent(...)getComponentAfter(...)getComponentBefore(...)/** Returns a user presentable description of this GTKColorChooserPane. *//** Returns the mnemonic to use with <code>getDisplayName</code>. */String mNumberFormatException nfe/** Character to underline that represents the mnemonic. */uninstallChooserPanel(...)/** Builds and configures the widgets for the GTKColorChooserPanel. */Box hBoxcreateHorizontalBox(...)new ColorTriangle(...)new OpaqueLabel(...)setMinimumSize(...)setPreferredSize(...)setMaximumSize(...)new JSpinner(...)new SpinnerNumberModel(...)configureSpinner(...)new JTextField(...)new GridBagLayout(...)new JSeparator(...)new GridBagConstraints(...)GridBagConstraints.LINE_STARTGridBagConstraints.HORIZONTALGridBagConstraints.NONEGridBagConstraints.CENTER/** Configures the spinner. */JComponent editorgetEditor(...)JSpinner.DefaultEditorJFormattedTextField ftfgetTextField(...)setFocusLostBehavior(...)/** Adds the widget creating a JLabel with the specified name. */JLabel labelnew JLabel(...)String mnemonicGridBagConstraints conGridBagConstraints.FIRST_LINE_ENDString mnemonicIndexsetDisplayedMnemonic(...)setDisplayedMnemonicIndex(...)setLabelFor(...)con.insets.topcon.insetscon.gridx/** Refreshes the display from the model. */getColorFromModel(...)/** Resets the red component of the selected color. */setRGB(...)/** Resets the green component of the selected color. *//** Resets the blue component of the selected color. *//** Sets the hue of the selected color and updates the display if ... */setHSB(...)/** Returns the current amount of hue. *//** Resets the saturation. *//** Returns the saturation. *//** Sets the brightness. *//** Returns the brightness. *//** Sets the saturation and brightness and updates the display if ... *//** Resets the rgb values. *//** Resets the hsb values. */getHSBColor(...)this.huethis.saturationthis.brightness/** Rests the color. ... */String hexStringColor.BLACKfloat[] hsbRGBtoHSB(...)ColorSelectionModel modelgetColorSelectionModel(...)setSelectedColor(...)/** ChangeListener method, updates the necessary display widgets. */setHue(...)floatValue(...)setSaturation(...)setBrightness(...)setRed(...)setGreen(...)setBlue(...)int FLAGS_CHANGED_ANGLE;/** Flag indicating the angle, or hue, has changed and the triangle ... */int FLAGS_DRAGGING;/** Indicates the wheel is being dragged. */int FLAGS_DRAGGING_TRIANGLE;/** Indicates the triangle is being dragged. */int FLAGS_SETTING_COLOR;/** Indicates a color is being set and we should ignore setColor */int FLAGS_FOCUSED_WHEEL;/** Indicates the wheel has focus. */int FLAGS_FOCUSED_TRIANGLE;/** Indicates the triangle has focus. *//** Class responsible for rendering a color wheel and color triangle. */Image wheelImage;/** Cached image of the wheel. */Image triangleImage;/** Cached image of the triangle. */double angle;/** Angle triangle is rotated by. */int flags;/** Boolean bitmask. */int circleX;/** X location of selected color indicator. */int circleY;/** Y location of selected color indicator. */ActionMap mapenableEvents(...)AWTEvent.MOUSE_EVENT_MASKgetWheelRadius(...)setFocusTraversalKeysEnabled(...)getInputMap(...)getKeyStroke(...)new ActionMapUIResource(...)new ColorAction(...)getLookAndFeelDefaults(...)replaceUIActionMap(...)/** Returns the GTKColorChooserPanel. */GTKColorChooserPanel.this/** Gives focus to the wheel. */setFocusType(...)/** Gives focus to the triangle. *//** Returns true if the wheel currently has focus. */isSet(...)/** Resets the selected color. */setAngleFromHue(...)setSaturationAndBrightness(...)/** Returns the selected color. *//** Returns the x location of the selected color indicator. */getWheelXOrigin(...)getIndicatorSize(...)/** Returns the y location of the selected color indicator. */getWheelYOrigin(...)adjustHue(...)setFlag(...)adjustSB(...)FocusEvent.FOCUS_LOSTgetWheelWidth(...)Image imagegetImage(...)int lineX0cos(...)int lineY0sin(...)int lineX1int lineY1paintComponent(...)drawOval(...)toDegrees(...)Color.WHITEdrawLine(...)Graphics g2int innerRgetTriangleCircumscribedRadius(...)sqrt(...)rotate(...)/** Returns an image representing the triangle and wheel. */int triangleSizedouble rotatetoRadians(...)getWheelImage(...)paintTriangle(...)fillOval(...)float huedouble dSizetan(...)float factorfloat saturation/** Returns a color wheel image for the specified size. ... */int minSizeint doubleSizeBufferedImage imageint ySquareddouble radint rgbcolorWheelLocationToRGB(...)/** Adjusts the saturation and brightness. <code>x</code> and ... */boolean resetXYdouble x1double y1double x2double y2float maxX/** Sets the saturation and brightness. */double xdouble maxYdouble yint newCircleXint newCircleY/** Adjusts the hue based on the passed in location. ... */double angleatan(...)setHueAngle(...)getSaturation(...)getBrightness(...)/** Rotates the triangle to accommodate the passed in hue. *//** Sets the angle representing the hue. */double oldAnglethis.angle/** Returns the size of the color indicator. *//** Returns the circumscribed radius of the triangle. *//** Returns the x origin of the wheel and triangle. *//** Returns y origin of the wheel and triangle. *//** Returns the width of the wheel. *//** Sets the focus to one of: 0 no one, 1 the wheel or 2 the triangle. */int toSetint toUnset/** Returns the radius of the wheel. *//** Updates the flags bitmask. *//** Returns true if a particular flag has been set. *//** Returns the RGB color to use for the specified location. The ... */acos(...)/** Increments the hue. */getHue(...)getGTKColorChooserPanel(...)/** Action class used for colors. */int type;ColorTriangle triangleisWheelFocused(...)incrementHue(...)focusTriangle(...)compositeRequestFocus(...)int xDeltaint yDeltafocusWheel(...)getColorX(...)getColorY(...)// PENDING: when we straighten out user setting opacity, this should// be changed.// Force Integer to pad the string with 0's by adding 0x1000000 and// then removing the first character.// We want to handle tab ourself.// PENDING: this should come from the style.// Assign focus to either the wheel or triangle and attempt// to drag either the wheel or triangle.// Stopped dragging// Reset the flags to indicate no one has focus// Gained focus, reassign focus to the wheel if no one// currently has focus.// Draw the wheel and triangle// Draw the focus indicator for the wheel// Draw a line on the wheel indicating the selected hue.// Draw the focus indicator on the triangle// Draw the selected color indicator.// Invert the axis.// Rotate to origin and and verify x is valid.// Verify y location is valid.// Rotate again to determine value and scale// Map the location to an angle and reset hue// As far as I can tell, GTK doesn't allow stretching this// widget// FFFF00 - FF0000// FF0000 - FF00FF// 00FF00 - FFFF00// FF00FF - 0000FF// 00FFFF - 00FF00// 0000FF - 00FFFF// up// down// left// rightimport ColorTypenew GTKColorType(...)ColorType LIGHT;// values.// gtkrc, the rest (dark, mid, light) are calculated from these// GTK allows you to specify the foreground and background in aColorType DARK;ColorType MID;ColorType BLACK;ColorType WHITE;int MAX_COUNT;...[] HLS_COLORS;Object HLS_COLOR_LOCK;float m2float m1float rfloat gfloat bhlsValue(...)/** Converts from RGB color space to HLS colorspace. */float maxfloat minfloat lfloat s/** Creates and returns a new color derived from the passed in color. ... */float[] hlsrgbToHLS(...)hlsToRGB(...)/* Copyright (c) 2002, 2003, Oracle and/or its affiliates. All rights reserved. ... *//* calculate lightness */int UNDEFINED;/** Used to indicate a constant is not defined. *//** Java representation of native GtkIconSize enum */new IconSize(...)IconSize INVALID;IconSize MENU;IconSize SMALL_TOOLBAR;IconSize LARGE_TOOLBAR;IconSize BUTTON;IconSize DND;IconSize DIALOG;/** Java representation of native GtkTextDirection enum */new TextDirection(...)TextDirection NONE;TextDirection LTR;TextDirection RTL;/** Java representation of native GtkShadowType enum */new ShadowType(...)ShadowType NONE;ShadowType IN;ShadowType OUT;ShadowType ETCHED_IN;ShadowType ETCHED_OUT;/** Java representation of native GtkStateType enum */new StateType(...)StateType NORMAL;StateType ACTIVE;StateType PRELIGHT;StateType SELECTED;StateType INSENSITIVE;/** Java representation of native GtkExpanderStyle enum */new ExpanderStyle(...)ExpanderStyle COLLAPSED;ExpanderStyle SEMI_COLLAPSED;ExpanderStyle SEMI_EXPANDED;ExpanderStyle EXPANDED;/** Java representation of native GtkPositionType enum */new PositionType(...)PositionType LEFT;PositionType RIGHT;PositionType TOP;PositionType BOTTOM;/** Java representation of native GtkArrowType enum */new ArrowType(...)ArrowType UP;ArrowType DOWN;ArrowType LEFT;ArrowType RIGHT;/** Java representation of native GtkOrientation enum */new Orientation(...)Orientation HORIZONTAL;Orientation VERTICAL;/* Copyright (c) 2002, 2005, Oracle and/or its affiliates. All rights reserved. ... */import javax.swing.plaf.synth.*import ArrowTypeimport ExpanderStyleimport Orientationimport PositionTypeimport ShadowTypeimport TextDirectionimport SunWritableRasterimport ImageCache/** GTKEngine delegates all painting job to native GTK libraries. ... */new ImageCache(...)new GTKEngine(...)new HashMap<Region,Object>(...)new WidgetType[]WidgetType.SPINNER_ARROW_BUTTONWidgetType.COMBO_BOX_ARROW_BUTTONWidgetType.HSCROLL_BAR_BUTTON_LEFTWidgetType.HSCROLL_BAR_BUTTON_RIGHTWidgetType.VSCROLL_BAR_BUTTON_UPWidgetType.VSCROLL_BAR_BUTTON_DOWNWidgetType.BUTTONWidgetType.CHECK_BOXWidgetType.CHECK_BOX_MENU_ITEMWidgetType.COLOR_CHOOSERWidgetType.OPTION_PANEWidgetType.COMBO_BOXWidgetType.DESKTOP_ICONWidgetType.DESKTOP_PANEWidgetType.EDITOR_PANEWidgetType.FORMATTED_TEXT_FIELDWidgetType.SPINNER_TEXT_FIELDGTKRegion.HANDLE_BOXWidgetType.HANDLE_BOXWidgetType.INTERNAL_FRAMEWidgetType.INTERNAL_FRAME_TITLE_PANEWidgetType.LABELWidgetType.COMBO_BOX_TEXT_FIELDWidgetType.LISTWidgetType.MENUWidgetType.MENU_BARWidgetType.MENU_ITEMWidgetType.MENU_ITEM_ACCELERATORWidgetType.PANELWidgetType.PASSWORD_FIELDWidgetType.POPUP_MENUWidgetType.POPUP_MENU_SEPARATORWidgetType.HPROGRESS_BARWidgetType.VPROGRESS_BARWidgetType.RADIO_BUTTONWidgetType.RADIO_BUTTON_MENU_ITEMWidgetType.ROOT_PANEWidgetType.HSCROLL_BARWidgetType.VSCROLL_BARWidgetType.HSCROLL_BAR_THUMBWidgetType.VSCROLL_BAR_THUMBWidgetType.HSCROLL_BAR_TRACKWidgetType.VSCROLL_BAR_TRACKWidgetType.SCROLL_PANEWidgetType.HSEPARATORWidgetType.VSEPARATORWidgetType.HSLIDERWidgetType.VSLIDERWidgetType.HSLIDER_THUMBWidgetType.VSLIDER_THUMBWidgetType.HSLIDER_TRACKWidgetType.VSLIDER_TRACKWidgetType.SPINNERWidgetType.SPLIT_PANEWidgetType.HSPLIT_PANE_DIVIDERWidgetType.VSPLIT_PANE_DIVIDERWidgetType.TABBED_PANEWidgetType.TABBED_PANE_CONTENTWidgetType.TABBED_PANE_TABWidgetType.TABBED_PANE_TAB_AREAWidgetType.TABLEWidgetType.TABLE_HEADERWidgetType.TEXT_AREAWidgetType.TEXT_FIELDWidgetType.TEXT_PANECustomRegion.TITLED_BORDERWidgetType.TITLED_BORDERWidgetType.TOGGLE_BUTTONWidgetType.TOOL_BARRegion.TOOL_BAR_CONTENTRegion.TOOL_BAR_DRAG_WINDOWWidgetType.TOOL_BAR_DRAG_WINDOWWidgetType.TOOL_BAR_SEPARATORWidgetType.TOOL_TIPWidgetType.TREEWidgetType.TREE_CELLWidgetType.VIEWPORTnew ColorModel[]getRGBdefault(...)GTKEngine INSTANCE;int CACHE_SIZE;/** Size of the image cache *//** This enum mirrors that in gtk2_interface.h */new WidgetType(...)WidgetType BUTTON;WidgetType CHECK_BOX;WidgetType CHECK_BOX_MENU_ITEM;WidgetType COLOR_CHOOSER;WidgetType COMBO_BOX;WidgetType COMBO_BOX_ARROW_BUTTON;WidgetType COMBO_BOX_TEXT_FIELD;WidgetType DESKTOP_ICON;WidgetType DESKTOP_PANE;WidgetType EDITOR_PANE;WidgetType FORMATTED_TEXT_FIELD;WidgetType HANDLE_BOX;WidgetType HPROGRESS_BAR;WidgetType HSCROLL_BAR;WidgetType HSCROLL_BAR_BUTTON_LEFT;WidgetType HSCROLL_BAR_BUTTON_RIGHT;WidgetType HSCROLL_BAR_TRACK;WidgetType HSCROLL_BAR_THUMB;WidgetType HSEPARATOR;WidgetType HSLIDER;WidgetType HSLIDER_TRACK;WidgetType HSLIDER_THUMB;WidgetType HSPLIT_PANE_DIVIDER;WidgetType INTERNAL_FRAME;WidgetType INTERNAL_FRAME_TITLE_PANE;WidgetType IMAGE;WidgetType LABEL;WidgetType LIST;WidgetType MENU;WidgetType MENU_BAR;WidgetType MENU_ITEM;WidgetType MENU_ITEM_ACCELERATOR;WidgetType OPTION_PANE;WidgetType PANEL;WidgetType PASSWORD_FIELD;WidgetType POPUP_MENU;WidgetType POPUP_MENU_SEPARATOR;WidgetType RADIO_BUTTON;WidgetType RADIO_BUTTON_MENU_ITEM;WidgetType ROOT_PANE;WidgetType SCROLL_PANE;WidgetType SPINNER;WidgetType SPINNER_ARROW_BUTTON;WidgetType SPINNER_TEXT_FIELD;WidgetType SPLIT_PANE;WidgetType TABBED_PANE;WidgetType TABBED_PANE_TAB_AREA;WidgetType TABBED_PANE_CONTENT;WidgetType TABBED_PANE_TAB;WidgetType TABLE;WidgetType TABLE_HEADER;WidgetType TEXT_AREA;WidgetType TEXT_FIELD;WidgetType TEXT_PANE;WidgetType TITLED_BORDER;WidgetType TOGGLE_BUTTON;WidgetType TOOL_BAR;WidgetType TOOL_BAR_DRAG_WINDOW;WidgetType TOOL_BAR_SEPARATOR;WidgetType TOOL_TIP;WidgetType TREE;WidgetType TREE_CELL;WidgetType VIEWPORT;WidgetType VPROGRESS_BAR;WidgetType VSCROLL_BAR;WidgetType VSCROLL_BAR_BUTTON_UP;WidgetType VSCROLL_BAR_BUTTON_DOWN;WidgetType VSCROLL_BAR_TRACK;WidgetType VSCROLL_BAR_THUMB;WidgetType VSEPARATOR;WidgetType VSLIDER;WidgetType VSLIDER_TRACK;WidgetType VSLIDER_THUMB;WidgetType VSPLIT_PANE_DIVIDER;/** Representation of GtkSettings properties. ... */new Settings(...)Settings GTK_FONT_NAME;Settings GTK_ICON_SIZES;/* Custom regions are needed for representing regions that don't exist ... */new CustomRegion(...)Region TITLED_BORDER;/* TITLED_BORDER Region is mapped to GtkFrame class which can draw ... */HashMap<Region,Object> regionToWidgetTypeMap;ImageCache cache;int x0, ...;Graphics graphics;...[] cacheArgs;/** Translate Region and JComponent into WidgetType ordinals */WidgetType[] widgetsJSeparator separatorJSeparator.HORIZONTALJProgressBar.HORIZONTALInteger propint dirSwingConstants.WESTSwingConstants.EASTSwingConstants.NORTHSwingConstants.SOUTHTextDirection dirTextDirection.NONEJComponent compComponentOrientation cogetComponentOrientation(...)isLeftToRight(...)TextDirection.LTRTextDirection.RTLordinal(...)int widgetgetWidgetType(...)synthStateToGTKStateType(...)native_paint_arrow(...)int gtkStateint synthStategetComponentState(...)getTextDirection(...)native_paint_box(...)native_paint_box_gap(...)native_paint_check(...)native_paint_expander(...)native_paint_extension(...)native_paint_flat_box(...)native_paint_focus(...)native_paint_handle(...)native_paint_hline(...)native_paint_option(...)native_paint_shadow(...)native_paint_slider(...)native_paint_vline(...)native_paint_background(...)...[] COLOR_MODELS;...[] BAND_OFFSETS;/** Paint a cached image identified by its size and a set of additional ... */Image img/* Allocate a native offscreen buffer of the specified size. */nativeStartPainting(...)/** Convenience method that delegates to finishPainting() with ... */finishPainting(...)/** Called to indicate that painting is finished. We create a new ... */DataBufferInt dataBuffernew DataBufferInt(...)nativeFinishPainting(...)stealData(...)markDirty(...)setImage(...)/** Notify native layer of theme change, and flush cache */UNIXToolkit.GTK_LOCKnative_switch_theme(...)/* GtkSettings enum mirrors that in gtk2_interface.h */native_get_gtk_setting(...)/** Sets up the GtkAdjustment values for the native GtkRange widget ... */nativeSetRangeValue(...)/* Copyright (c) 2005, 2007, Oracle and/or its affiliates. All rights reserved. ... */// Make sure the awt toolkit is loaded so we have access to native// methods.// Initialize regionToWidgetTypeMap/* We should return correrct WidgetType if the seperator is inserted ... *//* For all ListCellRenderers we will use COMBO_BOX_TEXT_FIELD widget ... */// Transparency.OPAQUE// Transparency.BITMASK// Transparency.TRANSLUCENT// OPAQUE// BITMASK// TRANSLUCENT// look for cached image// Note that stealData() requires a markDirty() afterwards// since we modify the data in it.import MessageFormatimport javax.swing.border.*import javax.swing.filechooser.*import BasicDirectoryModelimport SwingUtilities2import sun.swing.plaf.synth.*import FilePaneimport ShellFolder/** GTK FileChooserUI. ... */new DirectoryComboBoxAction(...)new GTKFileView(...)new GTKApproveSelectionAction(...)Short.MAX_VALUEJPanel accessoryPanel;// The accessoryPanel is a container to place the JFileChooser accessory componentString newFolderButtonText;String newFolderErrorSeparator;String newFolderErrorText;String newFolderDialogText;String newFolderNoDirectoryErrorTitleText;String newFolderNoDirectoryErrorText;String deleteFileButtonText;String renameFileButtonText;String newFolderButtonToolTipText;String deleteFileButtonToolTipText;String renameFileButtonToolTipText;int newFolderButtonMnemonic;int deleteFileButtonMnemonic;int renameFileButtonMnemonic;int foldersLabelMnemonic;int filesLabelMnemonic;String renameFileDialogText;String renameFileErrorTitle;String renameFileErrorText;JComboBox<> filterComboBox;FilterComboBoxModel filterComboBoxModel;JPanel rightPanel;// From MotifJList<> directoryList;JList<> fileList;JLabel pathField;JTextField fileNameTextField;Dimension hstrut3;Dimension vstrut10;Dimension prefListSize;Dimension PREF_SIZE;int MIN_WIDTH;int MIN_HEIGHT;Dimension ZERO_ACC_SIZE;Dimension MAX_SIZE;Insets buttonMargin;String filesLabelText;String foldersLabelText;String pathLabelText;String filterLabelText;int pathLabelMnemonic;int filterLabelMnemonic;JComboBox<> directoryComboBox;DirectoryComboBoxModel directoryComboBoxModel;Action directoryComboBoxAction;JPanel bottomButtonPanel;GTKDirectoryModel model;Action newFolderAction;boolean readOnly;boolean showDirectoryIcons;boolean showFileIcons;GTKFileView fileView;PropertyChangeListener gtkFCPropertyChangeListener;Action approveSelectionAction;GTKDirectoryListModel directoryListModel;getApproveSelectionAction(...)getCancelSelectionAction(...)getChangeToParentDirectoryAction(...)getFileNameCompletionAction(...)JFileChooser fcgetFileChooser(...)String typedInNameint modegetFileSelectionMode(...)JList<> listObject[] filesgetSelectedValues(...)files.lengthVector<String> resultnew Vector<String>(...)StringBuffer bufisMultiSelectionEnabled(...)File file//      return pathField.getText();//     public String getDirectoryName() {validateFileCache(...)getModel(...)// ***********************// * FileView operations *isDirectory(...)JFileChooser filechooserJRootPane rootgetRootPane(...)getControlButtonsAreShown(...)getDefaultButton(...)setDefaultButton(...)getApproveButton(...)setDefaultCapable(...)getCancelButton(...)File fdoSelectedFileChanged(...)setFileName(...)ListSelectionModel smgetSelectionModel(...)File currentDirectorygetCurrentDirectory(...)clearSelection(...)moveLeadSelectionIndex(...)setAnchorSelectionIndex(...)setDirectoryName(...)getPath(...)getNormalizedFile(...)getAbsolutePath(...)directoryChanged(...)doDirectoryChanged(...)getAccessoryPanel(...)JComponent accessoryBorderLayout.CENTERgetPreferredSize(...)doFileSelectionModeChanged(...)setSelectionMode(...)doMultiSelectionChanged(...)doControlButtonsChanged(...)updateDefaultButton(...)selectAll(...)doAncestorChanged(...)// ********************************************// ************ Create Listeners **************new SelectionListener(...)JList<> list;this.listisLeftMouseButton(...)getClickCount(...)locationToIndex(...)getElementAt(...)IOException exisTraversable(...)rescanCurrentDirectory(...)setCurrentDirectory(...)approveSelection(...)TransferHandler th1getTransferHandler(...)TransferHandler th2setTransferHandler(...)getDragEnabled(...)setDragEnabled(...)new DoubleClickListener(...)getValueIsAdjusting(...)JFileChooser chooserFile[] filesObject[] objectsobjects.lengthchooser.DIRECTORIES_ONLYisFileSystem(...)getFileSystemView(...)setDirectorySelected(...)setDirectory(...)ArrayList<File> fListnew ArrayList<File>(...)Object objectisFileSelectionEnabled(...)isFile(...)isDirectorySelectionEnabled(...)new File[]setSelectedFiles(...)getSelectedValue(...)chooser.FILES_ONLYsetSelectedFile(...)// ComponentUI Interface Implementation methodsnew GTKFileChooserUI(...)new JPanel(...)new BorderLayout(...)installUI(...)uninstallUI(...)boolean leftToRightJPanel topButtonPanelnew FlowLayout(...)FlowLayout.LEADINGJButton deleteFileButtonnew JButton(...)RenameFileAction rfanew RenameFileAction(...)JButton renameFileButtonJPanel interiorJPanel comboBoxPanelFlowLayout.CENTERJComboBox<> comboBoxlayoutContainer(...)JPanel centerPanelJSplitPane splitPanelnew JSplitPane(...)JPanel leftPanelTableCellRenderer headerRenderergetDefaultRenderer(...)new JTableHeader(...)JLabel directoryListLabelgetTableCellRendererComponent(...)JLabel fileListLabelJComponent accessoryPanelgetAccessory(...)JPanel pathFieldPanelJLabel pathFieldLabelString curDirNameSet<AWTKeyStroke> forwardTraversalKeysgetFocusTraversalKeys(...)KeyboardFocusManager.FORWARD_TRAVERSAL_KEYSJPanel panelJLabel filterLabelJPanel pnButtonsnew GridLayout(...)JButton cancelButtonJButton approveButtoninstallComponents(...)setAlignmentX(...)JComponent.CENTER_ALIGNMENTsetBorder(...)new EmptyBorder(...)JButton newFolderButtongetNewFolderAction(...)setMnemonic(...)setToolTipText(...)align(...)new BoxLayout(...)BoxLayout.PAGE_AXIScreateDirectoryComboBoxModel(...)new JComboBox<>(...)addActionListener(...)setMaximumRowCount(...)setDividerLocation(...)PREF_SIZE.widthGridBagConstraints.WESTcreateDirectoryList(...)GridBagConstraints.EASTGridBagConstraints.BOTHcreateFilesList(...)JSplitPane.LEFTJSplitPane.RIGHTBorderLayout.AFTER_LINE_ENDScreateRigidArea(...)Dimension dgetMaximumSize(...)d.heightgetPreferredSize(...).heightnew HashSet<AWTKeyStroke>(...)KeyEvent.VK_TABsetFocusTraversalKeys(...)getActionMap(...)createFilterComboBoxModel(...)setRenderer(...)createFilterComboBoxRenderer(...)FlowLayout.TRAILINGsetMargin(...)new GTKFCPropertyChangeListener(...)getUIDefaultsInt(...)uninstallListeners(...)String propinstallDefaults(...)Locale linstallStrings(...)getMnemonic(...)uninstallStrings(...)JScrollPane scrollpanenew JScrollPane(...)new JList<>(...)AccessibleContext.ACCESSIBLE_NAME_PROPERTYsetModel(...)new GTKFileListModel(...)removeSelectionInterval(...)setCellRenderer(...)new FileCellRenderer(...)createListSelectionListener(...)createDoubleClickListener(...)setVerticalScrollBarPolicy(...)JScrollPane.VERTICAL_SCROLLBAR_ALWAYSnew DirectoryCellRenderer(...)new GTKDirectoryListModel(...)new GTKDirectoryModel(...)getSystemDisplayName(...)FileSystemView fsv;Comparator<File> fileComparator;sort(...)File curDir;getDirectories(...)fireIntervalAdded(...)getIndex0(...)getIndex1(...)fireIntervalRemoved(...)// whole list has changed.// incremental adjustment values instead of saying that the// PENDING - this is inefficient - should sent outfireContentsChanged(...)// out that everything has changed// PENDING - fire the correct interval changed - currently sendingcreateFileObject(...)getFiles(...)// PENDING - fire the interval changedgetListCellRendererComponent(...)setIcon(...)Dimension prefSizepreferredLayoutSize(...)getLayout(...)prefSize.widthgetPreferredSize(...).widthd.widthprefSize.heightJComponent.LEFT_ALIGNMENTsetAlignmentY(...)JComponent.TOP_ALIGNMENTnew NewFolderAction(...)// DataModel for DirectoryComboxboxnew DirectoryComboBoxModel(...)/** Data model for a type-face selection combo-box. */new Vector<File>(...)Vector<File> directories;File selectedDirectory;JFileChooser chooser;File dir/** Adds the directory to the model and sets it to be selected, ... */int oldSizeFile canonicalint newSizegetParentFile(...)setSelectedItem(...)this.selectedDirectory/** Acts when DirectoryComboBox has changed the selected item. *//** Creates a new folder. */FilePane.ACTION_NEW_FOLDERString dirNameshowInputDialog(...)JOptionPane.PLAIN_MESSAGEFile newDirexists(...)showMessageDialog(...)JOptionPane.ERROR_MESSAGEmkdir(...)isDirectorySelected(...)getDirectory(...)/** Renames file */FilePane.ACTION_EDIT_FILE_NAMEString newFileNamegetFileName(...)new MessageFormat(...)File oldFileFile newFilerenameFile(...)// Renderer for Filter ComboBoxnew FilterComboBoxRenderer(...)/** Render different filters */getDescription(...)// DataModel for Filter Comboboxnew FilterComboBoxModel(...)/** Data model for filter combo-box. */...[] filters;getChoosableFileFilters(...)JFileChooser.CHOOSABLE_FILE_FILTER_CHANGED_PROPERTYJFileChooser.FILE_FILTER_CHANGED_PROPERTYsetFileFilter(...)FileFilter currentFiltergetFileFilter(...)FileFilter filteraddChoosableFileFilter(...)filters.length// we return all selected file names// plus the file name typed into the text field, if not already there// construct the resulting string// PENDING// Ancestor was added, set initial focus// Strip trailing ".."// That's ok, we'll use f as is// Top row of buttons// CurrentDir ComboBox// CENTER: left, right, accessory// SPLIT PANEL: left, right// left panel - Filter & directoryList// Add the Directory List// Create a label that looks like button (should be a table header)// create files list// add the fileName field// Add the filter combo box// Add buttons// Add the current directory to the model, and make it the// selectedDirectory// Get the canonical (full) path. This has the side// benefit of removing extraneous chars from the path,// for example /foo/bar/ becomes /foo/bar// Maybe drive is not ready. Can't abort here.// create File instances of each directory leading up to the top// Ok, use f as is// As SynthComboBoxRenderer's are asked for a size BEFORE they// are parented getName is overriden to force the name to be// ComboBox.renderer if it isn't set. If we didn't do this the// wrong style could be used for size calculations.// Ensure that the current filter is in the list.// NOTE: we shouldnt' have to do this, since JFileChooser adds// the filter to the choosable filters list when the filter// is set. Lets be paranoid just in case someone overrides// setFileFilter in JFileChooser.// This shouldn't happen. Try to recover gracefully.int componentStategetRegion(...)SynthConstants.DISABLEDColor orgColorGTKColorType.WHITEpaintText(...)String themeNamegetGtkThemeName(...)shouldShadowText(...)/** Paints text at the specified location. This will not attempt to ... */Region idSynthConstants.FOCUSEDJComponent sourceisFocusPainted(...)GTKStyle styleint focusSizegetClassSpecificIntValue(...)int focusPadint totalFocusbounds.xbounds.ybounds.widthbounds.heightpaintFocus(...)GTKPainter.INSTANCEsynthStateToGTKState(...)SynthConstants.MOUSE_OVER/* Copyright (c) 2002, 2006, Oracle and/or its affiliates. All rights reserved. ... */// We don't need to paint empty strings// Metacity handles painting of text on internal frame title,// ignore this.// The "bounds" parameter encompasses only the actual text;// when drawing the focus, we need to expand that bounding// box by "focus-line-width" plus "focus-padding".  Note that// the layout process for these components will have already// taken these values into account, so there should always// be enough space allocated for drawing the focus indicator.new HashMap<String,DelegatingIcon>(...)int CHECK_ICON_EXTRA_INSET;int DEFAULT_ICON_SPACING;int DEFAULT_ICON_SIZE;int DEFAULT_TOGGLE_MENU_ITEM_SIZE;String RADIO_BUTTON_ICON;// For pre-gtk2.4String CHECK_BOX_ICON;String MENU_ARROW_ICON;String CHECK_BOX_MENU_ITEM_CHECK_ICON;String RADIO_BUTTON_MENU_ITEM_CHECK_ICON;String TREE_EXPANDED_ICON;String TREE_COLLAPSED_ICON;String ASCENDING_SORT_ICON;String DESCENDING_SORT_ICON;String TOOL_BAR_HANDLE_ICON;Map<String,DelegatingIcon> iconsPool;DelegatingIcon resultnew SynthExpanderIcon(...)new ToolBarHandleIcon(...)new MenuArrowIcon(...)new DelegatingIcon(...)// Sort arrow// Radio button// CheckBox// Menus// ToolBar HandleDelegatingIcon divalues(...)resetIconDimensions(...)...[] PARAM_TYPES;Object method;int iconDimension;paintIcon(...)getIconDimension(...)resolveMethod(...)getMethodParamTypes(...)Region regionupdateSizeIfNecessary(...)// HandleBox.// we create a unique icon per ToolBar and lookup the style for the// GTK has a separate widget for the handle box, to mirror thisOrientation.classSynthStyle style;JToolBar toolbarOrientation orientationOrientation.HORIZONTALOrientation.VERTICALJToolBar.HORIZONTALgetStyleFactory(...)new SynthContext(...)SynthConstants.ENABLEDArrowType.classArrowType arrowDirArrowType.RIGHTArrowType.LEFTimport java.lang.ref.*import DefaultEditorKitimport StateTypeimport UNIXToolkitimport OSInfoimport GetPropertyActionimport DefaultLayoutStylegetLanguage(...)getDefault(...)boolean cjkLocaleLocale.JAPANESELocale.KOREANboolean isSunDesktopgetOSType(...)Boolean valnew File(...)SunGraphicsEnvironment.isOpenSolarisnew ReferenceQueue<GTKLookAndFeel>(...)boolean IS_22;Object aaTextInfo;/** Whether or not text is drawn antialiased.  This keys off the ... */boolean isSunCJK;/** Solaris, or Linux with Sun JDS in a CJK Locale. ... */boolean gtkAAFontSettingsCond;/* Used to override if system (desktop) text anti-aliasing settings should ... */Font fallbackFont;/** Font to use in places where there is no widget. */boolean inInitialize;/** If true, GTKLookAndFeel is inside the <code>initialize</code> ... */boolean pclInstalled;/** If true, PropertyChangeListeners have been installed for the ... */GTKStyleFactory styleFactory;/** StyleFactory needs to be created only the first time. */String gtkThemeName;/** Cached theme name. Used by GTKGraphicsUtils *//** Returns true if running on system containing at least 2.2. *//** Maps a swing constant to a GTK constant. */PositionType.LEFTPositionType.RIGHTPositionType.TOPPositionType.BOTTOM/** Maps from Synth state to native GTK state using typesafe enumeration ... */StateType resultSynthConstants.PRESSEDStateType.ACTIVEStateType.PRELIGHTSynthConstants.SELECTEDStateType.SELECTEDStateType.INSENSITIVEStateType.NORMAL/** Maps from a Synth state to the corresponding GTK state. ... */UIDefaults tableinitResourceBundle(...)initSystemColorDefaults(...)initComponentDefaults(...)installPropertyChangeListeners(...)Toolkit kitWeakPCL pclnew WeakPCL(...)flushUnreferenced(...)addResourceBundle(...)Integer zeroObject zeroBordernew SwingLazyValue(...)Object focusBordernew GTKLazyValue(...)GTKStyle.GTKLazyValueObject focusSelectedBorderObject noFocusBorderGTKStyleFactory factoryGTKStyle tableStyleColor tableBggetGTKColor(...)GTKColorType.TEXT_BACKGROUNDColor tableFocusCellBgGTKColorType.BACKGROUNDColor tableFocusCellFgGTKColorType.FOREGROUNDGTKStyle progStyleint progXThicknessgetXThickness(...)int progYThicknessgetYThickness(...)int hProgWidthint hProgHeightint vProgWidthint vProgHeightInteger caretBlinkRateInsets zeroInsetsDouble defaultCaretAspectRatioColor caretColorColor controlTextObject fieldInputMapnew LazyInputMap(...)UIDefaults.LazyInputMapDefaultEditorKit.copyActionDefaultEditorKit.pasteActionDefaultEditorKit.cutActionDefaultEditorKit.selectionBackwardActionDefaultEditorKit.selectionForwardActionDefaultEditorKit.previousWordActionDefaultEditorKit.nextWordActionDefaultEditorKit.selectionPreviousWordActionDefaultEditorKit.selectionNextWordActionDefaultEditorKit.selectAllActionDefaultEditorKit.beginLineActionDefaultEditorKit.endLineActionDefaultEditorKit.selectionBeginLineActionDefaultEditorKit.selectionEndLineActionDefaultEditorKit.deletePrevCharActionDefaultEditorKit.deleteNextCharActionDefaultEditorKit.deleteNextWordActionDefaultEditorKit.deletePrevWordActionDefaultEditorKit.forwardActionDefaultEditorKit.backwardActionJTextField.notifyActionObject passwordInputMapObject editorMarginObject multilineInputMapDefaultEditorKit.upActionDefaultEditorKit.downActionDefaultEditorKit.pageUpActionDefaultEditorKit.pageDownActionDefaultEditorKit.selectionUpActionDefaultEditorKit.selectionDownActionDefaultEditorKit.insertBreakActionDefaultEditorKit.insertTabActionDefaultEditorKit.beginActionDefaultEditorKit.endActionDefaultEditorKit.selectionBeginActionDefaultEditorKit.selectionEndActionclass ...Object[] defaultsnew FontLazyValue(...)new AbstractColorChooserPanel[]new GTKColorChooserPanel(...)new TitledBorder(...)GTKPainter.TitledBordergetToolBarHandleIcon(...)Region region;this.regiongetFontForState(...)putDefaults(...)SwingUtilities2.AA_TEXT_PROPERTY_KEYGTKStyle windowStyleGTKStyle entryStyleObject caretColorgetClassSpecificValue(...)GTKStyle menuStyleGTKStyle scrollbarStyleGTKStyle infoStyleGTKStyle desktopStyleGTKStyle widgetStyleColor bgGTKColorType.TEXT_FOREGROUNDGTKStyle.BLACK_COLORGTKColorType.LIGHTGTKColorType.DARKGTKColorType.BLACKGTKColorType.MID/** Creates the GTK look and feel class for the passed in Component. */intern(...)getUIClassID(...)createUI(...)/** Returns the cached gtkThemeName */Toolkit toolkitloadGTK(...)loadStyles(...)isLocalDisplay(...)getAATextInfo(...)SwingUtilities2.AATextInfoReferenceQueue<GTKLookAndFeel> queue;Toolkit kit;String key;this.kitGTKLookAndFeel lnfgetLookAndFeel(...)invokeLater(...)Window[] appWindowsgetWindows(...)themeChanged(...)GTKEngine.INSTANCEresetIcons(...)appWindows.lengthupdateStyles(...)isNativeGTKAvailable(...)// and load the system colors.// Subclassed to pass in false to the superclass, we don't want to tryloadSystemColors(...)getDesktopProperty(...)setStyleFactory(...)getGTKStyleFactory(...)GTKEngine engineObject iconSizesgetSetting(...)GTKEngine.Settings.GTK_ICON_SIZESGTKEngine.SettingsObject fontNameFont defaultFontlookupFont(...)configIconSizes(...)GTKEngine.Settings.GTK_FONT_NAMEnew GTKStyleFactory(...)initStyles(...)String[] sizesString[] splitsString sizetrim(...)String widthString heightsplits.lengthgetIconType(...)GTKStyle.GTKStockIconInfosetIconSize(...)/** Returns whether or not the UIs should update their ... *//** {@inheritDoc} */GnomeLayoutStyle.INSTANCE/** Gnome layout style.  From: ... */new GnomeLayoutStyle(...)GnomeLayoutStyle INSTANCE;getPreferredGap(...)isLabelAndNonlabel(...)getContainerGap(...)// Backup for specifying the version, this isn't currently documented.// If you pass in anything but 2.2 you got the 2.0 colors/look.// NOTE: We're currently hard coding to use 2.2.// If we want to support both GTK 2.0 and 2.2, we'll// need to get the major/minor/micro version from the .so.// Refer to bug 4912613 for details.// If the button is SELECTED and is PRELIGHT we need to// make the state MOUSE_OVER otherwise we don't paint the// PRELIGHT.// These Regions treat FOREGROUND as TEXT.// We need to call super for basic's properties file.// SynthTabbedPaneUI supports rollover on tabs, GTK does not// Prevents Synth from setting text AA by itself// For compatibility with apps expecting certain defaults we'll// populate the table with the values from basic.// The following progress bar size calculations come from// gtkprogressbar.c (version 2.8.20), see MIN_* constants and// the gtk_progress_bar_size_request() method./* DefaultEditorKit.unselectAction *//* DefaultEditorKit.toggleComponentOrientation */// These bindings are only enabled when there is a default// button set on the rootpane.// colors specific only for GTK// It is impossible to create a simple GtkWidget without specifying the// type. So for GtkWidget we can use any appropriate concrete type of// wigdet. LABEL in this case./* We need to call loadGTK() to ensure that the native GTK ... *//* Check if system AA font settings should be used. ... */// The property was GC'ed, we're no longer interested in// PropertyChanges, remove the listener.// We are using invokeLater here because we are getting called// on the AWT-Motif thread which can cause a deadlock./* We are listening for GTK desktop text AA settings: ... */// If we are in initialize initializations will be// called later, don't do it now.// Desktop property appears to have preference over rc font.// Checks args// Indent group members 12 pixels to denote hierarchy and// association.// Fall through to related// As a basic rule of thumb, leave space between user// interface components in increments of 6 pixels, going up as// the relationship between related elements becomes more// distant. For example, between icon labels and associated// graphics within an icon, 6 pixels are adequate. Between// labels and associated components, leave 12 horizontal// pixels. For vertical spacing between groups of components,// 18 pixels is adequate.// The first part of this is handled automatically by Icon (which// won't give you 6 pixels).// A general padding of 12 pixels is// recommended between the contents of a dialog window and the// window borders.// focus-line-pattern://        indicator.// focus-padding: Integer giving padding between border and focus// focus-line-width: Integer giving size of focus border//                       outside border.// interior_focus: Indicates if focus should appear inside border, or// default_outside_border: Insets when default.// Need to support:/** @author ... */new PositionType[]new ShadowType[]ShadowType.NONEShadowType.INShadowType.OUTShadowType.ETCHED_INnew GTKPainter(...)...[] POSITIONS;...[] SHADOWS;GTKEngine ENGINE;GTKPainter INSTANCE;paintRadioButtonBackground(...)paintRadioButtonMenuItemBackground(...)// FORMATTED_TEXT_FIELDpaintTextBackground(...)// TOOL_BAR_DRAG_WINDOWpaintToolBarBackground(...)// TOOL_BARint stateint orientationpaintCachedImage(...)startPainting(...)paintBox(...)// PASSWORD_FIELD// TEXT_FIELDpaintTreeCellEditorBackground(...)// NOTE: this is called for JCheckBox too// RADIO_BUTTONpaintFlatBox(...)ShadowType.ETCHED_OUTColorType.BACKGROUND// NOTE: this is called for JCheckBoxMenuItem too// RADIO_BUTTON_MENU_ITEMShadowType shadowis2_2(...)// LABELJComponent cpaintButtonBackgroundImpl(...)// INTERNAL_FRAMEpaintFrameBorder(...)Metacity.INSTANCE// DESKTOP_PANEfillArea(...)// DESKTOP_ICONpaintButtonBackground(...)AbstractButton buttonboolean paintBGisContentAreaFilled(...)isBorderPainted(...)boolean paintFocusboolean defaultCapableisDefaultCapable(...)boolean toolButtonboolean interiorFocusgetClassSpecificBoolValue(...)int totalFocusSizeint xThicknessint yThicknessboolean paintBgInsets defaultInsetsgetClassSpecificInsetsValue(...)GTKStyle.BUTTON_DEFAULT_BORDER_INSETSSynthConstants.DEFAULTdefaultInsets.leftdefaultInsets.topdefaultInsets.rightdefaultInsets.bottomShadowType shadowType// ARROW_BUTTONArrowType arrowTypeString detailArrowType.UPArrowType.DOWNpaintArrow(...)int directionint spinStateint modyint modh// LISTint shadow// MENUpaintMenuItemBackground(...)// This is called for both MENU and MENU_ITEMpaintBackground(...)paintShadow(...)JToolBar.Separatorfloat pctSeparator sepDimension sizegetSeparatorSize(...)size.heightsize.widthInsets insetsgetInsets(...)insets.leftinsets.topinsets.rightinsets.bottompaintHline(...)paintVline(...)boolean focusedJSlider sliderdouble mingetMinimum(...)double maxgetMaximum(...)double visiblesetRangeValue(...)paintSlider(...)// SPINNER// SPLIT_PANE_DIVIDERJSplitPane splitPanepaintHandle(...)paintSplitPaneDividerForeground(...)JTabbedPane paneint selectedIndexPositionType placementSwingOrientationConstantToGTK(...)getTabPlacement(...)int gapStartint gapSizeRectangle tabBoundsgetBoundsAt(...)tabBounds.xtabBounds.widthtabBounds.ytabBounds.heightpaintBoxGap(...)int placementPositionType sidepaintExtension(...)// TEXT_PANEpaintTextAreaBackground(...)// EDITOR_PANE// TEXT_AREA// too.// NOTE: Combobox and Label, Password and FormattedTextField calls thisContainer containerParentColorType.TEXT_BACKGROUND// ROOT_PANE// TOGGLE_BUTTONJToggleButton toggleButton// SCROLL_BARint troughBorder// SCROLL_BAR_THUMBJScrollBar sbboolean rtlgetVisibleAmount(...)// TOOL_TIP// TREE_CELL// TREE// VIEWPORTIllegalAccessException iaeInvocationTargetException ite// All icon painting methods are called from under GTK_LOCKpaintExpander(...)ExpanderStyle.EXPANDEDExpanderStyle.COLLAPSEDGTKIconFactory.DEFAULT_ICON_SIZEGTKIconFactory.DEFAULT_ICON_SPACINGpaintCheck(...)paintOption(...)GTKIconFactory.DEFAULT_TOGGLE_MENU_ITEM_SIZEGTKIconFactory.CHECK_ICON_EXTRA_INSET/* Fill an area with color determined from this context's Style using the ... */// Refer to GTKLookAndFeel for details on this.boolean selectedCell;boolean focusedCell;new ListTableFocusBorder(...)this.selectedCellthis.focusedCellSynthContext contextComponentUI uigetUI(...)// TitledBorder implementation for GTK L&FGTKEngine.CustomRegion.TITLED_BORDERGTKEngine.CustomRegion/* If the label is a ListCellRenderer and it's in a container ... */// Does not call into ENGINE for better performance// Paint the default indicator// Render the box.// Toolbar buttons should only have their background painted// in the PRESSED, SELECTED, or MOUSE_OVER states.// Otherwise, always paint the button's background, unless// the user has overridden it and we're in the ENABLED state.// focus/* The ubuntulooks engine (and presumably others) expect us to ... */// Note that we don't call paintCachedImage() here.  Since the// progress bar foreground is painted differently for each value// it would be wasteful to try to cache an image for each state,// so instead we simply avoid caching in this case.// don't bother caching the image/* Note: In theory, the style's x/y thickness values would determine ... *//* GTK renders toolbar separators differently in that an ... */// For regular/menu separators, we simply subtract out the insets.// For focused sliders, we paint focus rect outside the bounds passed.// Need to adjust for that.// The ubuntulooks engine paints slider troughs differently depending// on the current slider value and its component orientation.// not used for sliders; any value will work// Note that we don't call paintCachedImage() here.  Since some// engines (e.g. ubuntulooks) paint the slider background// differently for any given slider value, it would be wasteful// to try to cache an image for each state, so instead we simply// avoid caching in this case.// This is handled in paintTextFieldBackground// Text is odd in that it uses the TEXT_BACKGROUND vs BACKGROUND.// Note: the scrollbar insets already include the "trough-border",// which is needed to position the scrollbar buttons properly.// But when we render, we need to take the trough border out// of the equation so that we paint the entire area covered by// the trough border and the scrollbar content itself.// The clearlooks engine paints scrollbar thumbs differently// depending on the current scroll value (specifically, it will avoid// rendering a certain line when the thumb is at the starting or// ending position).  Therefore, we normalize the current value to// the range [0,100] here and then pass it down to setRangeValue()// so that the native widget is configured appropriately.  Note that// there are really only four values that matter (min, middle, max,// or fill) so we restrict to one of those four values to avoid// blowing out the image cache.// In this case, the thumb fills the entire track, so it is// touching both ends at the same time// At minimum// At maximum// Somewhere in between// the string arg should alternate based on row being painted,// but we currently don't pass that in.// As far as I can tell, these don't call into the ENGINE.// Also note that you don't want this to call into the ENGINE// as if it where to paint a background JViewport wouldn't scroll// correctly.// The orientation parameter passed down by Synth refers to the// orientation of the toolbar, but the one we pass to GTK refers// to the orientation of the handle.  Therefore, we need to swap// the value here: horizontal toolbars have vertical handles, and// vice versa./** A typesafe enumeration of the distinct rendering portions specific ... */new GTKRegion(...)Region HANDLE_BOX;import SynthIconimport WidgetTypenew GTKGraphicsUtils(...)new HashMap<String,GTKStockIcon>(...)new GTKStockIcon(...)String ICON_PROPERTY_PREFIX;Color BLACK_COLOR;Color WHITE_COLOR;Font DEFAULT_FONT;Insets BUTTON_DEFAULT_BORDER_INSETS;GTKGraphicsUtils GTK_GRAPHICS;Map<String,String> CLASS_SPECIFIC_MAP;/** Maps from a key that is passed to Style.get to the equivalent class ... */Map<String,GTKStockIcon> ICONS_MAP;/** Backing style properties that are used if the style does not ... *//** The font used for this particular style, as determined at ... */int widgetType;/** Widget type used when looking up class specific values. */int xThickness, ...;/** The x/y thickness values for this particular style. */String pangoFontNameFont pangoFontthis.widgetTypenativeGetXThickness(...)nativeGetYThickness(...)nativeGetPangoFontName(...)GTKLookAndFeel.aaTextInfo/** Returns a <code>SynthPainter</code> that will route the appropriate ... */ColorType.FOCUSColorType.TEXT_FOREGROUNDColorType.FOREGROUNDgetStyleSpecificColor(...)/** Returns color specific to the current style. This method is ... */nativeGetColorForState(...)/** Returns the color for the specified state. ... */Color fggetColorForState(...)/** Returns the X thickness to use for this GTKStyle. ... *//** Returns the Y thickness to use for this GTKStyle. ... *//** Returns the Insets. If <code>insets</code> is non-null the resulting ... */JComponent componentgetSimpleInsets(...)getButtonInsets(...)getRadioInsets(...)getMenuBarInsets(...)getMenuItemInsets(...)getTextFieldInsets(...)getBorderInsets(...)getThicknessInsets(...)getScrollBarInsets(...)getSliderTrackInsets(...)getTabbedPaneTabInsets(...)getSeparatorInsets(...)int CHILD_SPACINGComponent component/* This is used for both RADIO_BUTTON and CHECK_BOX. */int internalPaddingint horizPaddingint pad// NOTE: this is called for ComboBox, and FormattedTextField alsoint spacingisFocusable(...)/** Returns the value for a class specific property for a particular ... */nativeGetClassValue(...)/** Convenience method to get a class specific integer value for ... *//** Returns the value for a class specific property. A class specific value ... *//** Convenience method to get a class specific integer value. ... *//** Convenience method to get a class specific Insets value. ... *//** Convenience method to get a class specific Boolean value. ... *//** Returns the value to initialize the opacity property of the Component ... */String classKeyGTKStockIcon stockIconJSeparator sepboolean horizWidgetType wtint sliderWidthint stepperSizeint arrowSizegetFontSize(...)int indicatorSpacingint focusLineWidthTextDirection directionIcon icongetStyleSpecificIcon(...)String propNamenew ImageIcon(...)UNIXToolkit tkgetStockIcon(...)Map<String,Integer> ICON_TYPE_MAP;Object ICON_SIZE_KEY;AppContext appContextDimension[] iconSizes/** Return the size of a particular icon type (logical size) ... */getIconSizesMap(...)iconSizes.length/** Change icon size in a type to size mapping. This is called by code ... *//** Return icon type (GtkIconSize value) given a symbolic name which can ... */Integer ninitIconTypeMap(...)new HashMap<String,Integer>(...)/** An Icon that is fetched using getStockIcon. */boolean loadedLTR;boolean loadedRTL;Icon ltrIcon;Icon rtlIcon;getIconWidth(...)getIconHeight(...)SynthStyle stylethis.style/** GTKLazyValue is a slimmed down version of <code>ProxyLaxyValue</code>. ... *//** Name of the class to create. */String methodName;this.methodNameInstantiationException ie// For the enabled state, prefer the widget's colors// If getForeground returns a non-UIResource it means the// developer has explicitly set the foreground, use it over// that of TEXT_FOREGROUND as that is typically the expected// behavior.// The following calculations are derived from gtkbutton.c// (GTK+ version 2.8.20), gtk_button_size_allocate() method.// Include the default border insets, but only for JButtons// that are default capable.  Note that// JButton.getDefaultCapable() returns true by default, but// GtkToolButtons are never default capable, so we skip this// step if the button is contained in a toolbar.// The following calculations are derived from gtkcheckbutton.c// (GTK+ version 2.8.20), gtk_check_button_size_allocate() method.// Note: GTKIconFactory.DelegateIcon will have already included the// "indicator-spacing" value in the size of the indicator icon,// which explains why we use zero as the left inset (or right inset// in the RTL case); see 6489585 for more details.// The following calculations are derived from gtkmenubar.c// (GTK+ version 2.8.20), gtk_menu_bar_size_allocate() method.// The following calculations are derived from gtkmenuitem.c// (GTK+ version 2.8.20), gtk_menu_item_size_allocate() method.// This scrollbar is part of a scrollpane; use only the// "scrollbar-spacing" style property to determine the padding// between the scrollbar and its parent scrollpane.// This is a standalone scrollbar; leave enough room for the// focus line in addition to the trough border.// See if this is a class specific value.// Is it a specific value ?// Believe it or not, the size of a spinner arrow button is// dependent upon the size of the spinner's font.  These// calculations come from gtkspinbutton.c (version 2.8.20),// spin_button_get_arrow_size() method.// For all other kinds of arrow buttons (e.g. combobox arrow// buttons), we will simply fall back on the value of// ArrowButton.size as defined in the UIDefaults for// GTKLookAndFeel when we call UIManager.get() below...// The iconTextGap value needs to include "indicator-spacing"// and it also needs to leave enough space for the focus line,// which falls between the indicator icon and the text.// See getRadioInsets() and 6489585 for more details.// Is it a stock icon ?// Is it another kind of value ?// For backward compatibility we'll fallback to the UIManager.// We don't go to the UIManager for engine as the engine is GTK// specific.// Don't call super, we don't want to pick up defaults from// SynthStyle.// First try loading a theme-specific icon using the native// GTK libraries (native GTK handles the resizing for us).// In a failure case where native GTK (unexpectedly) returns a// null icon, we can try loading a default icon as a fallback.// In an extreme failure situation, just return null (callers are// already prepared to handle a null icon, so the worst that can// happen is that an icon won't be included in the button/dialog).// GTK_ICON_SIZE_INVALID// GTK_ICON_SIZE_MENU// GTK_ICON_SIZE_SMALL_TOOLBAR// GTK_ICON_SIZE_LARGE_TOOLBAR// GTK_ICON_SIZE_BUTTON// GTK_ICON_SIZE_DND// GTK_ICON_SIZE_DIALOGMap<Object,GTKStyle> stylesCache;/** Saves all styles that have been accessed.  In most common cases, ... */Font defaultFont;new HashMap<Object,GTKStyle>(...)/** Returns the <code>GTKStyle</code> to use based on the ... */GTKStyle resultboolean spboolean ltrboolean focusablenew ComplexKey(...)JButton btnisTopLevelMenu(...)new GTKStyle(...)this.defaultFont/** Represents a hash key used for fetching GTKStyle objects from the ... */WidgetType wt;this.wtObject argComplexKey thatthat.wtthat.argsthat.args.lengthObject a1Object a2// The style/insets of a scrollbar can depend on a number of// factors (see GTKStyle.getScrollBarInsets()) so use a// complex key here.// The style/insets of a checkbox or radiobutton can depend// on the component orientation, so use a complex key here.// The style/insets of a button can depend on whether it is// default capable or in a toolbar, so use a complex key here.// Otherwise, just use the WidgetType as the key.import java.net.*import javax.xml.parsers.*import org.w3c.dom.*new TitlePaneLayout(...)new ColorizeImageFilter(...)new ArithmeticExpressionEvaluator(...)new HashMap<String,Image>(...)getUserTheme(...)new Metacity(...)FileNotFoundException exlogError(...)ParserConfigurationException exSAXException exMetacity INSTANCE;// http://art.gnome.org/theme_list.php?category=metacity// Themes:// http://developer.gnome.org/doc/tutorials/metacity/metacity-themes.html// Tutorial:...[] themeNames;boolean errorLogged;DocumentBuilder documentBuilder;Document xmlDoc;String userHome;Node frame_style_set;Map<String,Object> frameGeometry;Map<String,Map<String,Object>> frameGeometries;LayoutManager titlePaneLayout;ColorizeImageFilter imageFilter;URL themeDir;SynthContext context;String themeName;ArithmeticExpressionEvaluator aee;Map<String,Integer> variables;RoundRectClipShape roundedClipShape;// Reusable clip shape objectNodeList nodesthis.themeNamegetThemeDir(...)URL themeURLnew URL(...)getXMLDoc(...)new FileNotFoundException(...)getStringAttr(...)NumberFormatException exnew HashMap<String,Map<String,Object>>(...)HashMap<String,Object> gmString parentGMNodeList childNodesint ncputAll(...)getBooleanAttr(...)getNodeType(...)Node.ELEMENT_NODEgetIntAttr(...)getFloatAttr(...)INSTANCE.titlePaneLayoutnew RoundRectClipShape(...)setRoundedRect(...)JButton buttonString buttonNameint buttonStateJComponent titlePaneContainer titlePaneParentJInternalFrame jifboolean activeString stateString functionString locationboolean left_cornerboolean right_cornerNode framegetNode(...)updateFrameGeometry(...)this.contextint nButtonsisIconifiable(...)isMaximizable(...)isClosable(...)Node frame_styleShape oldClipgetClip(...)Point buttonLocRectangle clipBoundssetClip(...)getRoundedClipShape(...)RoundRectClipShape.TOP_RIGHTRoundRectClipShape.TOP_LEFTclipRect(...)clipBounds.xclipBounds.yclipBounds.widthclipBounds.heightdrawButton(...)Node buttonNodeNode draw_opsString draw_ops_namedraw(...)findChild(...)Rectangle titleRectcalculateTitleArea(...)JComponent menuButtonIcon frameIcongetFrameIcon(...)calculateTitleTextWidth(...)getDescent(...)boolean roundTopLeftboolean roundTopRightboolean roundBottomLeftboolean roundBottomRightint titleHeightboolean minimizedisIcon(...)int leftTitlebarEdgeint rightTitlebarEdgeint topTitlebarEdgeint bottomTitlebarEdgeRoundRectClipShape.BOTTOM_LEFTRoundRectClipShape.BOTTOM_RIGHTdrawPiece(...)titleRect.xtitleRect.ytitleRect.widthtitleRect.heightint GET_THEME_DIR;int GET_USER_THEME;int GET_IMAGE;Object arg;this.argString sepFile.separatorString[] dirsURL themeDirdirs.lengthcanRead(...)toURL(...)toURI(...)MalformedURLException exString filenameURL urlgetResource(...)String themeReader readernew InputStreamReader(...)openStream(...)char[] bufStringBuffer strBufString strLowerCaseint i2new Privileged(...)Privileged.GET_THEME_DIRPrivileged.GET_USER_THEMEGraphics2D g2Composite oldCompgetComposite(...)int swint shfloat falphas.lengthfloat alphaint swmsetComposite(...)AlphaComposite.SRC_OVERHashMap<String,Image> images;colorize(...)Privileged.GET_IMAGEdouble cr, ...;ImageProducer producernew FilteredImageSource(...)createImage(...)double grayLeveldouble rdouble gdouble bminimumLayoutSize(...)JInternalFrame frameDimension buttonDimcalculateButtonSize(...)Insets title_bordergetFrameGeometry(...)Insets button_borderbuttonDim.widthString frameTitlegetTitle(...)int title_wstringWidth(...)int title_lengthint buttonHeightbuttonDim.heighttitle_border.lefttitle_border.rightint subtitle_wtitle_border.toptitle_border.bottombutton_border.topbutton_border.bottomMap<> gmJComponent minimizeButtonJComponent maximizeButtonJComponent closeButtonbutton_border.rightbutton_border.left// end TitlePaneLayoutthis.frameGeometryInteger iBoolean bparseColor(...)evaluate(...)int start_angleint extent_angleboolean filledfillArc(...)drawArc(...)int x1int y1int x2int y2int lineWidthGraphics2D g2dStroke strokegetStroke(...)setStroke(...)new BasicStroke(...)int x0int y0int twint thclip(...)AlphaComposite acString colorStrString titleclipStringIfNecessary(...)calculateTitleArea(...).widthint buttonWidthFloat aspect_ratioRectangle rr.xr.yr.heightr.widthString arrowString shadowString stateStrArrowType directionpaintMetacityElement(...)Node[] colorNodesgetNodesByName(...)Color[] colorscolorNodes.lengthboolean horizontalboolean verticalcolors.lengthnew GradientPaint(...)String colorizeStrColor colorizeString alphaImage objectString fill_typeStringTokenizer tokenizerfloat[] alphastileImage(...)float aint oldWidthint oldHeightdrawInclude(...)drawGradient(...)drawGTKArrow(...)drawGTKBox(...)drawGTKVLine(...)drawIcon(...)drawRectangle(...)drawTint(...)drawTile(...)drawTitle(...)Node piece(...).topNode windowsetFrameGeometry(...)// XML ParsingInputStream inputStreamDocument docnewDocumentBuilder(...)ArrayList<Node> listnew ArrayList<Node>(...)new Node[]String inheritFromNode inheritFromNodeNamedNodeMap nodeAttrsboolean matchesint nAttrsattrs.lengthString aNameString aValueNode itemparseColor2(...)adjustColor(...)int i1String typeStrColorType typeparseColorString(...).../=...lookupColor(...)PeekableStringTokenizer tokenizer;new PeekableStringTokenizer(...)expression(...)getTermValue(...)String nextpeek(...)float value2getFactorValue(...)...%=...String tokenString token;String tint TOP_LEFT;int TOP_RIGHT;int BOTTOM_LEFT;int BOTTOM_RIGHT;int y;int arcwidth;int archeight;int corners;this.cornersthis.arcwidththis.archeightnew RoundishRectIterator(...)new double[][]double x, ...;AffineTransform affine;...[] ctrlpts;...[] types;double a;double b;double c;double cv;double acv;...[] CtrlPtTemplate;//                  y + v2 * h + v3 * arcHeight);//         point = (x + v0 * w + v1 * arcWidth,//     4 values for each point {v0, v1, v2, v3}:// For each array:...[] CornerFlags;this.wthis.hthis.awgetArcWidth(...)this.ahgetArcHeight(...)this.affineint cornersgetCornerFlags(...)int numedgesctrlpts.lengthdouble[] ctrlsisDone(...)ctrls.lengthtransform(...)// Initialize constants// Ignore bad value// Cache frame geometries// These don't seem to apply here, but the Galaxy theme uses them. Not sure why.// Debian/Redhat/Solaris// SuSE// System property may not be set so skip null directories.// Set userHome here because we need the privilege// Note: this is a small file (< 1024 bytes) so it's not worth// starting an XML parser or even to use a buffered reader.// Pending: verify character encoding spec for gconf// OK to just ignore. We'll use a fallback theme.//log("Bad image url: "+ themeDir + "/" + key);// Assume all rgb values are shades of gray// Calculate width.// Leave room for three characters in the title.// Calculate height.// Get colors from child nodes// ElementNode// skip right paren// Not called/* BOTTOM LEFT corner *//* BOTTOM LEFT arc start *//* BOTTOM LEFT arc curve *//* BOTTOM RIGHT corner *//* BOTTOM RIGHT arc start *//* BOTTOM RIGHT arc curve *//* TOP RIGHT corner *//* TOP RIGHT arc start *//* TOP RIGHT arc curve *//* TOP LEFT corner *//* TOP LEFT arc start *//* TOP LEFT arc curve *//* Closing path element */// Don't draw anything...// 4xCORNER_POINT, CLOSE// Add one for each corner that has a curveimport AffineTransformimport FontConfigManagerGraphicsEnvironment geisHeadless(...)GraphicsConfiguration gcAffineTransform atgetNormalizingTransform(...)getScaleY(...)String CHARS_DIGITS;double fontScale;/** Calculate a default scale factor for fonts in this L&F to match ... *//** Parses a String containing a pango font description and returns ... */StringTokenizer tokdouble dsizeint dpiString fcFamilyLCString wordmapFcName(...)Font fontFontUIResource fuirgetCompositeFontUIResource(...)/* Java 2D font point sizes are in a user-space scale of 72dpi. ... *//* 50 dpi is the minimum value gnome allows *//* The Java rasteriser assumes pts are in a user space of ... *//* If there's no property, GTK scales for the resolution ... *//* Round size to nearest integer pt size *//* family is a Fc/Pango logical font which we need to expand. *//* It's a physical font which we will create with a fallback *//* a roundabout way to set the font size in floating points */new XColor(...)new XColor[]this.redthis.greenthis.blueXColor otherXColor key;binarySearch(...)key.nametoColor(...)/* Copyright (c) 2002, Oracle and/or its affiliates. All rights reserved. ... */import FontMetrics/** Factory object that can vend Icons appropriate for the basic L & F. ... */Color darkShadow;Color lightShadow;boolean isRaised;this.isRaisedthis.darkShadowthis.lightShadowColor focus;Color control;this.controlthis.focusColor shadow;Color highlight;this.shadowthis.highlightboolean isPressedboolean hasFocusboolean canBeDefaultboolean isDefaultint bx1int by1int bx2int by2AbstractButton bButtonModel modelisArmed(...)isPressed(...)isDefaultButton(...)int thicknessdrawBezel(...)JMenuBar menuBarJComponent jcomp;Color frameHighlight;Color frameColor;Color frameShadow;int BORDER_SIZE;// The width of the border/** Constructs an FrameBorder for the JComponent <b>comp</b>. *//** Sets the FrameBorder's JComponent. *//** Returns the FrameBorder's JComponent. ... *//** Draws the FrameBorder's top border. */Rectangle titleBarRectintersects(...)getClipBounds(...)/** Draws the FrameBorder's left border. */Rectangle borderRectgetBorderInsets(...).left/** Draws the FrameBorder's right border. */getBorderInsets(...).right/** Draws the FrameBorder's bottom border. */int marginHeightgetBorderInsets(...).bottom// Returns true if the associated component has focus./** Draws the FrameBorder in the given Rect.  Calls ... */isActiveFrame(...)brighter(...)darker(...)drawTopBorder(...)drawLeftBorder(...)drawRightBorder(...)drawBottomBorder(...)JInternalFrame frame;int CORNER_SIZE;// The size of the bounding box for Motif frame corners./** Constructs an InternalFrameBorder for the InternalFrame ... *//** Sets the InternalFrameBorder's InternalFrame. *//** Returns the InternalFrameBorder's InternalFrame. ... *//** Returns the width of the InternalFrameBorder's resize controls, ... */isResizable(...)FrameBorder.BORDER_SIZE/** Draws the InternalFrameBorder's top border. */getFrameShadow(...)getFrameHighlight(...)/** Draws the InternalFrameBorder's left border. */int topYint bottomY/** Draws the InternalFrameBorder's right border. *//** Draws the InternalFrameBorder's bottom border. */// Returns true if the associated internal frame has focus.Color shadowColor;Color highlightColor;int TEXT_SPACING;// Space between the border and textint GROOVE_HEIGHT;// Space for the separator under the title/** Creates a MotifPopupMenuBorder instance */this.backgroundthis.foregroundthis.shadowColorthis.highlightColor/** Paints the border for the specified component with the ... */Font origFontColor origColorJPopupMenu popupint fontHeightint descentint ascentPoint textLocint stringWidthtextLoc.ytextLoc.xdrawGroove(...)/** Reinitialize the insets parameter with this Border's current Insets. ... */// top// bottom// this draws the MenuBar border// Draw frame// Draw highlights// Draw shadows// inner border// inner 3D border// black drop shadow  __|import javax.swing.plaf.basic.*/** Button Listener ... *//* Copyright (c) 1997, 2001, Oracle and/or its affiliates. All rights reserved. ... *//** MotifButton implementation ... */Color selectColor;boolean defaults_initialized;Object MOTIF_BUTTON_UI_KEY;// ********************************//          Create PLAFMotifButtonUI motifButtonUInew MotifButtonUI(...)//         Create Listenersnew MotifButtonListener(...)//          Install DefaultsgetPropertyPrefix(...)installProperty(...)uninstallDefaults(...)//          Default Accessors//          Paint MethodsfillContentArea(...)// Overridden to ensure we don't paint icon over button borders.Rectangle newClipgetInteriorRectangle(...)getBorder(...)computeIntersection(...)Insets margingetMargin(...)margin.leftmargin.topmargin.rightmargin.bottom/* Copyright (c) 1997, 2003, Oracle and/or its affiliates. All rights reserved. ... */// focus painting is handled by the borderimport BasicButtonListenerimport BasicCheckBoxMenuItemUI/** MotifCheckboxMenuItem implementation ... */ChangeListener changeListener;new MotifCheckBoxMenuItemUI(...)createChangeListener(...)new ChangeHandler(...)JMenuItem cnew MouseInputHandler(...)MenuSelectionManager managersetSelectedPath(...)JMenuItem menuItemclearSelectedPath(...)doClick(...)processMouseEvent(...)/* Copyright (c) 1997, 2006, Oracle and/or its affiliates. All rights reserved. ... *//** MotifCheckBox implementation ... */Object MOTIF_CHECK_BOX_UI_KEY;String propertyPrefix;//         Create PLAFMotifCheckBoxUI motifCheckBoxUInew MotifCheckBoxUI(...)//          Defaults/* Copyright (c) 1997, 1998, Oracle and/or its affiliates. All rights reserved. ... *//** ComboBox motif look and feel ... */Icon arrowIcon;int HORIZ_MARGIN;new MotifComboBoxUI(...)Runnable initCodemotifGetEditor(...)new MotifComboBoxArrowIcon(...)int buttonSizeiconAreaWidth(...)getDisplaySize(...)new MotifComboPopup(...)/** Overriden to empty the MouseMotionListener. *//** Motif combo popup should not track the mouse in the list. */createKeyListener(...)BasicComboPopup.InvocationKeyHandlerMotifComboPopup.thisaddEditor(...)removeEditor(...)rectangleForCurrentValue(...)paintCurrentValue(...)rectangleForArrowIcon(...)Border borderInsets inin.topgetBounds(...).heightin.bottomListCellRenderer<> renderergetRenderer(...)Rectangle bb.xin.leftb.yb.widthin.rightb.heightconfigureEditor(...)new ComboBoxLayoutManager(...)/** This inner class is marked &quot;public&quot; due to a compiler bug. ... */BasicComboBoxUI.ComboBoxLayoutManagerMotifComboBoxUI.thisRectangle cvbcvb.xcvb.ycvb.widthcvb.heightColor fill;this.fill/** {@inheritDoc} ... */new MotifPropertyChangeListener(...)/** This class should be made &quot;protected&quot; in future releases. */BasicComboBoxUI.PropertyChangeHandlerString propertyNameComponent editor// Draw the separation/** Motif rendition of the component. ... */Font.SANS_SERIFDesktopIconActionListener desktopIconActionListener;DesktopIconMouseListener desktopIconMouseListener;Icon defaultIcon;IconButton iconButton;IconLabel iconLabel;MotifInternalFrameTitlePane sysMenuTitlePane;// we can remove its listeners.// This is only used for its system menu, but we need a reference to it soJPopupMenu systemMenu;EventListener mml;int LABEL_HEIGHT;int LABEL_DIVIDER;Font defaultTitleFont;// padding between icon and labelnew MotifDesktopIconUI(...)MotifBorders.FrameBorderFrameBorder bordernew FrameBorder(...)setDefaultIcon(...)createIconButton(...)new MotifInternalFrameTitlePane(...)getSystemMenu(...)createIconLabel(...)putLayer(...)getLayer(...)createDesktopIconActionListener(...)createDesktopIconMouseListener(...)show(...)getDesktopIcon(...)new IconLabel(...)new IconButton(...)new DesktopIconActionListener(...)new DesktopIconMouseListener(...)removeActionListener(...)JInternalFrame iframegetBorderInsets(...).topgetMinimumSize(...)/** Returns the default desktop icon. *//** Sets the icon used as the default desktop icon. */this.frameforwardEventToParent(...)dispatchEvent(...)new MouseEvent(...)getWhen(...)getXOnScreen(...)getYOnScreen(...)isPopupTrigger(...)MouseEvent.NOBUTTONColor shadowIcon icon;this.icon// if we drag or move we should deengage the popupgetFrame(...)PropertyVetoException e2endDraggingFrame(...)getDesktopManager(...)getDesktopPane(...)/* Copyright (c) 1997, 2005, Oracle and/or its affiliates. All rights reserved. ... */// An underhanded way of creating a system popup menu.// Forward mouse events to titlebar for moves.// touch-up frame// fill background// draw text -- clipping to truncate text like CDE/Motif/* the mouse release will not get reported correctly, ... *//** <p> ... *//// DesktopPaneUI methodsnew MotifDesktopPaneUI(...)new MotifDesktopManager(...)setDesktopManager(...)adjustIcons(...)///////////////////////////////////////////////////////////////////////////////////////  DragPane class///  MotifDesktopManager classJComponent dragPane;boolean usingDragPane;JLayeredPane layeredPaneForDragPane;int iconWidth, ...;// PENDING(klobad) this should be optimizedboolean didResizecomputeUnion(...)new DragPane(...)setLayer(...)setBoundsForFrame(...)adjustBoundsForIcon(...)JLayeredPane piconifyFrame(...)/** Change positions of icons in the desktop pane so that ... */new JDesktopIcon(...)new JInternalFrame(...)Dimension iconSizeJInternalFrame[] framesgetAllFrames(...)iconSize.widthiconSize.heightframes.lengthPoint ipip.xip.y/** Change positions of icon so that it doesn't overlap ... */JDesktopPane cint maxyint lxint ygapint lygetIconAt(...)JDesktopIcon currentIconComponent[] componentscomponents.length// We need to know Motif icon size/* Fix for disappearing icons. If the y value is maxy then this ... *//* Compute the offset for the cell we are trying to go in. *//* How far are we into the cell we dropped the icon in. *//* Set coordinates for the icon. *//* Cancel the move if the x value was moved off screen. *//// END of MotifDesktopManagerimport BasicEditorPaneUI/** Provides the look and feel for an pluggable content-type text editor. ... *//** Creates a UI for the JTextPane. ... */new MotifEditorPaneUI(...)/** Creates the object to use for a caret.  By default an ... */createCaret(...)import MouseAdapterimport MouseEvent/** Motif FileChooserUI. ... */JList<File> directoryList;JList<File> fileList;JTextField pathField;JComboBox<FileFilter> filterComboBox;JTextField filenameTextField;Dimension hstrut10;Dimension WITH_ACCELERATOR_PREF_SIZE;Dimension PREF_ACC_SIZE;JPanel bottomPanel;JButton approveButton;String enterFolderNameLabelText;int enterFolderNameLabelMnemonic;String enterFileNameLabelText;int enterFileNameLabelMnemonic;JLabel fileNameLabel;fileNameString(...)JFileChooser.SELECTED_FILE_CHANGED_PROPERTYJFileChooser.SELECTED_FILES_CHANGED_PROPERTYJFileChooser.DIRECTORY_CHANGED_PROPERTYgetDirectoryName(...)JFileChooser.FILE_SELECTION_MODE_CHANGED_PROPERTYpopulateFileNameLabel(...)JFileChooser.MULTI_SELECTION_ENABLED_CHANGED_PROPERTYJFileChooser.ACCESSORY_CHANGED_PROPERTYJFileChooser.APPROVE_BUTTON_TEXT_CHANGED_PROPERTYJFileChooser.APPROVE_BUTTON_TOOL_TIP_TEXT_CHANGED_PROPERTYJFileChooser.DIALOG_TYPE_CHANGED_PROPERTYgetApproveButtonText(...)getApproveButtonToolTipText(...)JFileChooser.CONTROL_BUTTONS_ARE_SHOWN_CHANGED_PROPERTYComponentOrientation oJFileChooser ccapplyComponentOrientation(...)new MotifFileChooserUI(...)JLabel lJScrollPane spJPanel rightPanelJPanel buttonPanelJButton updateButtonMAX_SIZE.widthJButton helpButtonsetInheritsPopupMenu(...)getUpdateAction(...)BoxLayout.LINE_AXISsetFocusable(...)getVerticalScrollBar(...)getHorizontalScrollBar(...)getView(...)getViewport(...)getBottomPanel(...)createGlue(...)getApproveButtonMnemonic(...)new JList<File>(...)new MotifFileListModel(...)loc2IndexFileList(...)new MotifDirectoryListModel(...)// PENDING(jeff) - this is inefficient - should sent out// PENDING(jeff) - fire the correct interval changed - currently sending// PENDING(jeff) - fire the interval changed// DataModel for Types Comboxbox// Renderer for Types ComboBox/** Render different type sizes and styles. */// PENDING(jeff)// PENDING(jeff) - I18N// Change to folder on return// CENTER: left, right accessory// left panel - Filter & folderList// add the filter PENDING(jeff) - I18N// leftPanel.add(Box.createRigidArea(vstrut10));// Add the Folder List PENDING(jeff) - I18N// add the filename field PENDING(jeff) - I18N// Since motif doesn't have button icons, leave this empty// which overrides the supertype icon loadingimport KeyEventimport View/* @author Jeff Dinkins ... */String MAX_ACC_WIDTH;/* Client Property keys for text and accelerator text widths *//** Draws the point (<b>x</b>, <b>y</b>) in the current color. *//* Convenience method for drawing a grooved line *//** Draws <b>aString</b> in the rectangle defined by ... */drawStringInRect(...)FontMetrics fontMetricsint drawWidth/** This method is not being used to paint menu item since ... */JMenuItem bInsets iRectangle viewRectRectangle iconRectRectangle textRectRectangle acceleratorRectRectangle checkRectRectangle arrowRectFont holdfFontMetrics fmAccelKeyStroke acceleratorgetAccelerator(...)String acceleratorTextlayoutMenuItem(...)getVerticalAlignment(...)getHorizontalAlignment(...)getVerticalTextPosition(...)getHorizontalTextPosition(...)Color holdcviewRect.xi.leftviewRect.yi.topviewRect.widthi.rightviewRect.heighti.bottomint modifiersgetKeyModifiersText(...)getKeyText(...)getKeyCode(...)checkRect.xcheckRect.ygetDisabledIcon(...)getPressedIcon(...)iconRect.xiconRect.yView vint mnemIndexgetDisplayedMnemonicIndex(...)drawStringUnderlineCharAt(...)textRect.xtextRect.yint accOffsetJComponent pInteger maxValueIntMotifGraphicsUtils.MAX_ACC_WIDTHint maxValueacceleratorRect.widthacceleratorRect.xacceleratorRect.yarrowRect.xarrowRect.y/** Compute and return the location of the icons origin, the ... */Rectangle labelRunion(...)layoutCompoundLabel(...)acceleratorR.widthacceleratorR.heightcheckIconR.widthcheckIconR.heightarrowIconR.widtharrowIconR.heighttextR.xiconR.xacceleratorR.xviewR.xviewR.widthcheckIconR.xarrowIconR.xacceleratorR.ylabelR.ylabelR.heightarrowIconR.ycheckIconR.y/* Convenience function for determining ComponentOrientation.  Helps us ... *//* Copyright (c) 1997, 2008, Oracle and/or its affiliates. All rights reserved. ... */// Make no net change to g//            throw new InconsistencyException("No font set");//            throw new InconsistencyException("No metrics for Font " + font());// get Accelerator text// layout the text and icon// Paint the Check// Paint the Icon// Use default icon// Draw the Text// Once BasicHTML becomes public, use BasicHTML.propertyKey// instead of the hardcoded string below!// *** paint the text disabled// *** paint the text normally// Draw the Accelerator Text//Get the maxAccWidth from the parent to calculate the offset.//Calculate the offset, with which the accelerator texts will be drawn with.// *** paint the acceleratorText disabled// *** paint the acceleratorText normally// Paint the Arrow/* Initialize the acceelratorText bounds rectangle textR.  If a null ... *//* Initialize the checkIcon bounds rectangle checkIconR. *//* Initialize the arrowIcon bounds rectangle arrowIconR. */// Position the Accelerator text rect// Position the Check and Arrow Icons// Align the accelertor text and the check and arrow icons vertically// with the center of the label rect./* System.out.println("Layout: v=" +viewR+"  c="+checkIconR+" i="+ ... */// shadowed button regionimport Polygon/** Icon factory for the CDE/Motif Look and Feel ... */Icon checkBoxIcon;Icon radioButtonIcon;Icon menuItemCheckIcon;Icon menuItemArrowIcon;Icon menuArrowIcon;new MenuItemArrowIcon(...)new CheckBoxIcon(...)new RadioButtonIcon(...)int csize;boolean flatboolean isArmedboolean isEnabledboolean isSelectedboolean checkToggleInboolean uncheckToggleOutboolean checkInisBorderPaintedFlat(...)drawCheckBezel(...)drawCheckBezelOut(...)Color controlShadow// end class CheckBoxIconColor dot;// end class RadioButtonIcon// end class MenuItemCheckIcon// end class MenuItemArrowIcon/* Copyright (c) 1997, 2004, Oracle and/or its affiliates. All rights reserved. ... */// There are 4 "looks" to the Motif CheckBox://  drawCheckBezelOut  -  default unchecked state//  drawBezel          -  when we uncheck in toggled state//  drawCheckBezel     -  when we check in toggle state//  drawCheckBezelIn   -  selected, mouseReleased// toggled from unchecked to checked// MotifBorderFactory.drawBezel(g,x,y,csize,csize,false,false);// show checked, unpressed state//  show unchecked state//bottom//right//left//top// draw check// fill interior// These variables are kind of pointless as the following code// assumes the icon will be 10 x 10 regardless of their value.// End class MenuArrowIconimport InternalFrameEventimport VetoableChangeListenerimport PropertyVetoException/** Class that manages a Motif title bar ... */SystemButton systemButton;MinimizeButton minimizeButton;MaximizeButton maximizeButton;Title title;int BUTTON_SIZE;// The width and height of a title pane button// 17 + 1 pixel borderJMenuItem minew JPopupMenu(...)getButtonMnemonic(...)new SystemButton(...)setSelected(...)PropertyVetoException pvenew ActionEvent(...)ActionEvent.ACTION_PERFORMEDnew MinimizeButton(...)new MaximizeButton(...)new Title(...)JInternalFrame fJInternalFrame.IS_SELECTED_PROPERTYrevalidate(...)JInternalFrame.TITLE_PROPERTYenableActions(...)Dimension buttonDimension;setFocusPainted(...)setBorderPainted(...)boolean pressedint maxboolean isMaxedsetHorizontalAlignment(...)createBevelBorder(...)BevelBorder.RAISED// Get around protected method in superclass// ignore request.// draw background// draw border/** A Motif L&F implementation of InternalFrame. ... */MotifInternalFrameTitlePane titlePane;KeyStroke closeMenuKey;/** As of Java 2 platform v1.3 this previously undocumented field is no ... */new MotifInternalFrameUI(...)setColors(...)Border frameBordercreateLayoutManager(...)new InternalFrameBorder(...)MotifBorders.InternalFrameBorderinstallKeyboardActions(...)KeyEvent.VK_ESCAPEuninstallBorder(...)getScreenSize(...)uninstallKeyboardActions(...)isKeyBindingRegistered(...)JDesktopIcon direplaceUIInputMap(...)JComponent.WHEN_IN_FOCUSED_WINDOWgetUIActionMap(...)setupMenuOpenKey(...)showSystemMenu(...)isKeyBindingActive(...)InputMap diInputMapgetUIInputMap(...)ActionMap diActionMaphideSystemMenu(...)Object[] bindingsmakeComponentInputMap(...)MotifDesktopIconUI micon/** This method is called when the frame becomes selected. */activateFrame(...)/** This method is called when the frame is no longer selected. */deactivateFrame(...)// We replace the// we use JPopup in our TitlePane so need escape support// BasicInternalFrameUI creates an action with the same name, we override// it as MotifInternalFrameTitlePane has a titlePane ivar that shadows the// titlePane ivar in BasicInternalFrameUI, making supers action throw// an NPE for us.// Set up the bindings for the DesktopIcon, it is odd that// we install them, and not the desktop icon.import BasicLabelUIimport ComponentUI/** A Motif L&F implementation of LabelUI. ... */Object MOTIF_LABEL_UI_KEY;MotifLabelUI motifLabelUInew MotifLabelUI(...)import InputEventimport JTextComponentimport BasicLookAndFeelimport BasicBordersimport BasicComboBoxRendererimport BasicComboBoxEditor/** Implements the Motif Look and Feel. ... */OSInfo.OSType.SOLARISOSInfo.OSType/** Load the SystemColors into the defaults table.  The keys ... */String[] defaultSystemColorsString motifPackageNameObject[] uiDefaultsinitClassDefaults(...)/** Initialize the defaults table with the name of the ResourceBundle ... */FontUIResource dialogPlain12Font.DIALOGFontUIResource serifPlain12Font.SERIFFontUIResource sansSerifPlain12FontUIResource monospacedPlain12Font.MONOSPACEDColorUIResource redColorUIResource blackColorUIResource whiteColorUIResource lightGrayColorUIResource controlDarkerColorUIResource scrollBarTrackColorUIResource menuItemPressedBackgroundColorUIResource menuItemPressedForegroundBorder loweredBevelBordernew BevelBorder(...)MotifBorders.BevelBorderBorder raisedBevelBorderBorder marginBordernew MarginBorder(...)BasicBorders.MarginBorderBorder focusBordernew FocusBorder(...)MotifBorders.FocusBorderBorder focusBevelBordernew CompoundBorderUIResource(...)BorderUIResource.CompoundBorderUIResourceBorder comboBoxBorderBorder buttonBordernew ButtonBorder(...)MotifBorders.ButtonBorderBorder toggleButtonBordernew ToggleButtonBorder(...)MotifBorders.ToggleButtonBorderBorder textFieldBorderBorder popupMenuBordernew MotifPopupMenuBorder(...)MotifBorders.MotifPopupMenuBorderObject menuItemCheckIcongetMenuItemCheckIcon(...)Object menuItemArrowIcongetMenuItemArrowIcon(...)Object menuArrowIcongetMenuArrowIcon(...)Object checkBoxIcongetCheckBoxIcon(...)Object radioButtonIcongetRadioButtonIcon(...)Object unselectedTabBackgroundObject unselectedTabForegroundObject unselectedTabShadowColor baseObject unselectedTabHighlightObject treeOpenIconmakeIcon(...)Object treeClosedIconObject treeLeafIconloadLeafIcon(...)Object treeExpandedIconcreateExpandedIcon(...)MotifTreeUI.MotifExpandedIconObject treeCollapsedIconcreateCollapsedIcon(...)MotifTreeUI.MotifCollapsedIconBorder menuBarBordernew MenuBarBorder(...)MotifBorders.MenuBarBorderBorder menuMarginBorderBorder focusCellHighlightBordernew LineBorderUIResource(...)BorderUIResource.LineBorderUIResourceObject sliderFocusInsetsObject tabbedPaneTabInsetsObject tabbedPaneTabPadInsetsObject tabbedPaneTabAreaInsetsObject tabbedPaneContentBorderInsetsObject optionPaneBordernew EmptyBorderUIResource(...)BorderUIResource.EmptyBorderUIResourceObject optionPaneButtonAreaBorderObject optionPaneMessageAreaBordergetSystemMnemonicKeyMask(...)KeyEvent.META_MASK/* Color of the desktop background *//* Color for captions (title bars) when they are active. *//* Text color for text in captions (title bars). *//* Border color for caption (title bar) window borders. *//* Color for captions (title bars) when not active. *//* Text color for text in inactive captions (title bars). *//* Border color for inactive caption (title bar) window borders. *//* Default color for the interior of windows *//* ??? *//* Text background color *//* Text foreground color *//* Text background color when selected *//* Text color when selected *//* Text color when disabled *//* Default color for controls (buttons, sliders, etc) *//* Default color for text in controls *//* Highlight color for controls *//* Light highlight color for controls *//* Shadow color for controls *//* Dark shadow color for controls *//* Scrollbar ??? color. PENDING(jeff) foreground? background? ? */// slate blue// *** Text// *** Tree// ** for tabbedpane// ** for optionpane// Buttons// DEPRECATED - DO NOT USE!// These are a little odd, MotifInternalFrameUI isntalls em!// Spinner// default: dark slate blue// default: black// default: white// default: maroon//      "Table.background", white,  // cell background color// ToolBar.// These window InputMap bindings are used when the Menu is// selected.import BasicMenuBarUI/** A Windows L&F implementation of MenuBarUI.  This implementation ... */new MotifMenuBarUI(...)//REMIND// end classimport BasicMenuItemUI/** MotifMenuItem implementation ... */new MotifMenuItemUI(...)import MenuSelectionManager/** A default MouseListener for menu elements ... */import BasicMenuUI/** A Motif L&F implementation of MenuUI. ... */new MotifMenuUI(...)//      menuItem.removeChangeListener(changeListener);//      super.uninstallListeners();//    protected void uninstallListeners() {//        menuItem.addChangeListener(changeListener);//        changeListener = createChangeListener(menuItem);//      super.installListeners();//    protected void installListeners() {// and this class overrides createChangeListener.// These should not be necessary because BasicMenuUI does this,new MotifChangeHandler(...)JPopupMenu pmgetPopupMenu(...)me.lengthJMenu menuContainer cntMenuElement[] menew MenuElement[]MenuElement[] newPath// c.repaint();import BasicOptionPaneUI/** Provides the CDE/Motif look and feel for a JOptionPane. ... *//** Creates a new MotifOptionPaneUI instance. */new MotifOptionPaneUI(...)/** Creates and returns a Container containin the buttons. The buttons ... */Container bcreateButtonArea(...)setCentersChildren(...)/** Returns null, CDE/Motif does not impose a minimum size. *//** Creates and adds a JLabel representing the icon returned from ... */Icon sideIconJLabel iconLabelsetVerticalAlignment(...)/* Create the icon. */import BasicPasswordFieldUI/** Provides the Motif look and feel for a password field. ... *//** Creates a UI for a JPasswordField. ... */new MotifPasswordFieldUI(...)/** A Motif L&F implementation of PopupMenuSeparatorUI.  This implementation ... */new MotifPopupMenuSeparatorUI(...)Dimension ss.width/* Copyright (c) 1998, Oracle and/or its affiliates. All rights reserved. ... */import Frameimport LayoutManagerimport BasicPopupMenuUI/** A Motif L&F implementation of PopupMenuUI. ... */Border border;Font titleFont;new MotifPopupMenuUI(...)/* This has to deal with the fact that the title may be wider than ... */LayoutManager layoutMouseEvent.BUTTON3_MASKimport BasicProgressBarUI/** A Motif ProgressBarUI. ... *//** Creates the ProgressBar's UI */new MotifProgressBarUI(...)import BasicRadioButtonMenuItemUI/** MotifRadioButtonMenuItem implementation ... */new MotifRadioButtonMenuItemUI(...)import BasicRadioButtonUI/** RadioButtonUI implementation for MotifRadioButtonUI ... */Object MOTIF_RADIO_BUTTON_UI_KEY;Color focusColor;MotifRadioButtonUI motifRadioButtonUInew MotifRadioButtonUI(...)//         Paint MethodsgetFocusColor(...)import BasicArrowButton/** Motif scroll bar button. ... */this.directionsetRequestFocusEnabled(...)Color leadColor trailColor fillint cxint cyimport JButtonimport JScrollBarimport BasicScrollBarUIimport static SwingUtilities2.drawHLineimport static SwingUtilities2.drawVLine/** Implementation of ScrollBarUI for the Motif Look and Feel ... */new MotifScrollBarUI(...)new MotifScrollBarButton(...)trackBounds.xtrackBounds.ytrackBounds.widthtrackBounds.heightthumbBounds.widththumbBounds.heightthumbBounds.xthumbBounds.ydrawVLine(...)drawHLine(...)import BasicScrollPaneUI/** A CDE/Motif L&F implementation of ScrollPaneUI. ... */Border vsbMarginBorderR;Border vsbMarginBorderL;Border hsbMarginBorder;CompoundBorder vsbBorder;CompoundBorder hsbBorder;PropertyChangeListener propertyChangeHandler;createPropertyChangeHandler(...)JScrollPane paneJScrollBar vsbnew CompoundBorder(...)getInsideBorder(...)JScrollBar hsbnew MotifScrollPaneUI(...)// The Border on the verticall scrollbar matches// what we installed, reset it.import BasicSeparatorUI/** A Motif L&F implementation of SeparatorUI.  This implementation ... */new MotifSeparatorUI(...)import JSliderimport BasicSliderUI/** Motif Slider ... */Dimension PREFERRED_HORIZONTAL_SIZE;Dimension PREFERRED_VERTICAL_SIZE;Dimension MINIMUM_HORIZONTAL_SIZE;Dimension MINIMUM_VERTICAL_SIZE;/** MotifSliderUI Constructor *//** create a MotifSliderUI object */new MotifSliderUI(...)Rectangle knobBoundsknobBounds.xknobBounds.yknobBounds.widthknobBounds.heightgetHighlightColor(...)getShadowColor(...)// PENDING(jeff) - the thumb should be dithered when disabled// fill// highlight// center// shadowimport JSplitPaneimport BasicSplitPaneUIimport BasicSplitPaneDivider/** Divider used for Motif split pane. ... */getPredefinedCursor(...)Cursor.DEFAULT_CURSORCursor defaultCursor;/** Default cursor, supers is package private, so we have to have one ... */int minimumThumbSize;int defaultDividerSize;int pad;int hThumbOffset;int vThumbOffset;int hThumbWidth;int hThumbHeight;int vThumbWidth;int vThumbHeight;Color focusedColor;/** Creates a new Motif SplitPaneDivider */setDividerSize(...)/** overrides to hardcode the size of the divider ... */int borderSizegetBasicSplitPaneUI(...)// It should be dynamic.// PENDING(jeff) - the thumb's location and size is currently hard coded./** Paints the divider. */Color bgColorint center/** The minimums size is the same as the preferredSize *//** Sets the SplitPaneUI that is using the receiver. This is completely ... */getSplitPane(...)new MotifMouseHandler(...)isOneTouchExpandable(...)oneTouchExpandableChanged(...)/** Returns true if the point at <code>x</code>, <code>y</code> ... */// superclass protected ivars// Two methods are exposed so that MotifMouseHandler can see the/** MouseHandler is subclassed to only pass off to super if the mouse ... */isInThumb(...)MotifSplitPaneDivider.thisgetDragger(...)/* Copyright (c) 1997, 1999, Oracle and/or its affiliates. All rights reserved. ... */// split line// draw thumb// Constrain the mouse pressed to the thumb./** Motif rendition of a split pane. ... *//** Creates a new MotifSplitPaneUI instance */new MotifSplitPaneUI(...)/** Creates the default divider. */new MotifSplitPaneDivider(...)import BasicTabbedPaneUI/** A Motif L&F implementation of TabbedPaneUI. ... */Color unselectedTabBackground;// Instance variables initialized at installationColor unselectedTabForeground;Color unselectedTabShadow;Color unselectedTabHighlight;// UI creationnew MotifTabbedPaneUI(...)// UI Installation/De-installation// UI RenderingRectangle selRectgetTabBounds(...)selRect.xselRect.widthselRect.yselRect.heightgetBackgroundAt(...)Rectangle tabRecttabRect.xtabRect.ytabRect.widthtabRect.heighttabInsets.righttabInsets.lefttabInsets.bottomtabInsets.top/* Copyright (c) 1997, 2002, Oracle and/or its affiliates. All rights reserved. ... */// Draw unbroken line if tabs are not on TOP, OR// selected tab is not visible (SCROLL_TAB_LAYOUT)// Break line to show visual connection to selected tab// Draw unbroken line if tabs are not on BOTTOM, OR// Draw unbroken line if tabs are not on RIGHT, OR// Ensure that runover lay is not more than insets// 2 pixel offset is set from insets to each runimport BasicTextAreaUI/** Provides the look and feel for a plain text editor.  In this ... *//** Creates a UI for a JTextArea. ... */new MotifTextAreaUI(...)import BasicTextFieldUIimport Caret/** Provides the Motif look and feel for a text field. ... *//** Creates a UI for a JTextField. ... */new MotifTextFieldUI(...)import BasicTextPaneUI/** Provides the look and feel for a styled text editor. ... */new MotifTextPaneUI(...)/** Provides the look and feel features that are common across ... */new KeyBinding[]new KeyBinding(...)JTextComponent.KeyBindingKeyEvent.VK_INSERTInputEvent.CTRL_MASKInputEvent.SHIFT_MASKKeyEvent.VK_DELETEKeyEvent.VK_LEFTKeyEvent.VK_RIGHT/** Creates the object to use for a caret for all of the Motif ... */new MotifCaret(...)/** The motif caret is rendered as an I beam. ... *//** Called when the component containing the caret gains ... *//** Called when the component containing the caret loses ... *//** Damages the area surrounding the caret to cause ... *//** Renders the caret as a vertical line.  If this is reimplemented ... */JTextComponent cgetCaretColor(...)getDisabledTextColor(...)TextUI mapperint dotgetDot(...)modelToView(...)BadLocationException eint IBeamOverhang;...[] defaultBindings;/** Default bindings all keymaps implementing the Motif feel. */// can't render I guess//System.err.println("Can't render caret");/** BasicToggleButton implementation ... */Object MOTIF_TOGGLE_BUTTON_UI_KEY;MotifToggleButtonUI motifToggleButtonUInew MotifToggleButtonUI(...)getSelectColor(...)/** Motif rendered to display a tree cell. ... */new IconUIResource(...)new TreeLeafIcon(...)int LEAF_SIZE;Icon LEAF_ICON;/** Icon for a node with no children. ... */Color bg;/** Motif rendition of the tree component. ... */int HALF_SIZE;/** creates a UI object to represent a Motif Tree widget */// BasicTreeUI overrides/** The minus sign button icon. ... */Color fg;new MotifExpandedIcon(...)/** The plus sign button icon. ... */new MotifCollapsedIcon(...)new MotifTreeUI(...)/** Returns the default cell renderer that is used to do the ... */new MotifTreeCellRenderer(...)import GetBooleanActionimport UIClientPropertyKeyimport Stateimport static State.*import Partimport Propimport Skin/** A class to help mimic Vista theme animations.  The only kind of ... */new WeakHashMap<JComponent,Map<Part,AnimationState>>(...)new Timer(...)new GetBooleanAction(...)boolean VISTA_ANIMATION_DISABLED;Object ANIMATION_CONTROLLER_KEY;Map<JComponent,Map<Part,AnimationState>> animationStateMap;Timer timer;//30 repaints per second should give smooth animation affect//this timer is used to cause repaint on animated componentsObject objnew AnimationController(...)setRepeats(...)setCoalesce(...)AnimationController controllergetAnimationController(...)State oldStatePart.TP_BUTTONputState(...)State.DEFAULTEDState.HOTlong durationXPStyle xpgetXP(...)getThemeTransitionDuration(...)normalizeState(...)Prop.TRANSITIONDURATIONSstartAnimation(...)// only for up button states thus we doing this translation here.// defined by states.  It seems that theme has duration defined// for scrollbar up, down, left and right button pictures areState rvObject tmpObjectboolean isForwardAndReverseMap<Part,AnimationState> mapnew EnumMap<Part,AnimationState>(...)Part.classnew AnimationState(...)isRunning(...)paintSkinRaw(...)triggerAnimation(...)skin.partAnimationState animationStatecontroller.animationStateMappaintSkin(...)List<JComponent> componentsToRemoveList<Part> partsToRemovenew ArrayList<JComponent>(...)Part partnew ArrayList<Part>(...)stop(...)State startState;long duration;//animation duration in nanosecondslong startTime;//animatin start time in nanosecondsboolean isForward;//!forward - from 1 to 0//forward  - from 0 to 1//direction the alpha value is changingboolean isForwardAndReverse;//from 1 to 0 and so forth//forward and reverse. alpha value is changing from 0 to 1 then//if isForwardAndReverse the animation continually goesfloat progress;isEventDispatchThread(...)this.startStatethis.durationthis.startTimenanoTime(...)this.isForwardAndReverselong currentTimeupdateProgress(...)Graphics2D gAlphaComposite.SrcOvernew EnumMap<Part,PartUIClientPropertyKey>(...)Map<Part,PartUIClientPropertyKey> map;PartUIClientPropertyKey rvnew PartUIClientPropertyKey(...)Part part;this.part/* Copyright (c) 2006, 2014, Oracle and/or its affiliates. All rights reserved. ... *///we need to dispose the controller on l&f change//idk: we can not handle tabs animation because//the same (component,part) is used to handle all the tabs//and we can not track the states//Vista theme might have transition duration for toolbar buttons//but native application does not seem to animate them// it seems for DEFAULTED button state Vista does animation from// HOT//Only button might have DEFAULTED state//idk: do not know how to get the value from Vista//one second seems plausible value/* falls through *///animation is done for the component//in case time was reset// to move to a different package in the future.// NOTE: Don't rely on this class staying in this location. It is likely/** Wrapper for a value from the desktop. The value is lazily looked up, and ... */new ReferenceQueue<DesktopProperty>(...)boolean updatePending;/** Indicates if an updateUI call is pending. */ReferenceQueue<DesktopProperty> queue;/** ReferenceQueue of unreferenced WeakPCLs. */WeakPCL pcl;/** PropertyChangeListener attached to the Toolkit. *//** Key used to lookup value from desktop. *//** Value to return. */Object fallback;/** Fallback value in case we get null from desktop. *//** Cleans up any lingering state held by unrefeernced ... *//** Sets whether or not an updateUI call is pending. *//** Returns true if a UI update is pending. *//** Updates the UIs of all the known Frames. */Class<> uiClassFrame[] appFramesgetFrames(...)getPackage(...)invalidateStyle(...)Frame appFrameupdateWindowUI(...)/** Updates the UI of the passed in window and all its children. */Window[] ownedWinsgetOwnedWindows(...)updateComponentTreeUI(...)Window ownedWin/** Creates a DesktopProperty. ... */this.fallbackflushUnreferencedProperties(...)/** UIManager.LazyValue method, returns the value from the desktop ... */configureValue(...)getValueFromDesktop(...)getDefaultValue(...)/** Returns the value from the desktop. *//** Returns the value to use if the desktop property is null. *//** Invalidates the current value. ... *//** Invalides the current value so that the next invocation of ... *//** Requests that all components in the GUI hierarchy be updated ... */isUpdatePending(...)Runnable uiUpdaterupdateAllUIs(...)setUpdatePending(...)/** Configures the value as appropriate for a defaults property in ... */createValue(...)/** Returns the key used to lookup the desktop properties value. *//** As there is typically only one Toolkit, the PropertyChangeListener ... */LookAndFeel laf;this.lafDesktopProperty propertyupdateUI(...)/* Copyright (c) 2001, 2009, Oracle and/or its affiliates. All rights reserved. ... */// Check if the current UI is WindowsLookAndfeel and flush the XP style map.// Note: Change the package test if this class is moved to a different package.// The only sure fire way to clear our references is to create a// Thread and wait for a reference to be added to the queue.// Because it is so rare that you will actually change the look// and feel, this stepped is forgoed and a middle ground of// flushing references from the constructor is instead done.// The implication is that once one DesktopProperty is created// there will most likely be n (number of DesktopProperties created// by the LookAndFeel) WeakPCLs around, but this number will not// grow past n.import ThemeReader/** Implements Windows Parts and their States and Properties for the Windows Look and Feel. ... *//** An enumeration of the various Windows controls (also known as ... */new Control(...)Control BUTTON;Control COMBOBOX;Control EDIT;Control HEADER;Control LISTBOX;Control LISTVIEW;Control MENU;Control PROGRESS;Control REBAR;Control SCROLLBAR;Control SPIN;Control TAB;Control TOOLBAR;Control TRACKBAR;Control TREEVIEW;Control WINDOW;/** An enumeration of the Windows compoent parts */Control.MENUControl.BUTTONControl.COMBOBOXControl.EDITControl.HEADERControl.LISTBOXControl.LISTVIEWControl.PROGRESSControl.REBARControl.SCROLLBARControl.SPINControl.TABControl.TOOLBARControl.TRACKBARControl.TREEVIEWControl.WINDOWPart MENU;Part MP_BARBACKGROUND;// Special case, not in nativePart MP_BARITEM;Part MP_POPUPBACKGROUND;Part MP_POPUPBORDERS;Part MP_POPUPCHECK;Part MP_POPUPCHECKBACKGROUND;Part MP_POPUPGUTTER;Part MP_POPUPITEM;Part MP_POPUPSEPARATOR;Part MP_POPUPSUBMENU;Part BP_PUSHBUTTON;Part BP_RADIOBUTTON;Part BP_CHECKBOX;Part BP_GROUPBOX;Part CP_COMBOBOX;Part CP_DROPDOWNBUTTON;Part CP_BACKGROUND;Part CP_TRANSPARENTBACKGROUND;Part CP_BORDER;Part CP_READONLY;Part CP_DROPDOWNBUTTONRIGHT;Part CP_DROPDOWNBUTTONLEFT;Part CP_CUEBANNER;Part EP_EDIT;Part EP_EDITTEXT;Part HP_HEADERITEM;Part HP_HEADERSORTARROW;Part LBP_LISTBOX;Part LVP_LISTVIEW;Part PP_PROGRESS;Part PP_BAR;Part PP_BARVERT;Part PP_CHUNK;Part PP_CHUNKVERT;Part RP_GRIPPER;Part RP_GRIPPERVERT;Part SBP_SCROLLBAR;Part SBP_ARROWBTN;Part SBP_THUMBBTNHORZ;Part SBP_THUMBBTNVERT;Part SBP_LOWERTRACKHORZ;Part SBP_UPPERTRACKHORZ;Part SBP_LOWERTRACKVERT;Part SBP_UPPERTRACKVERT;Part SBP_GRIPPERHORZ;Part SBP_GRIPPERVERT;Part SBP_SIZEBOX;Part SPNP_UP;Part SPNP_DOWN;Part TABP_TABITEM;Part TABP_TABITEMLEFTEDGE;Part TABP_TABITEMRIGHTEDGE;Part TABP_PANE;Part TP_TOOLBAR;Part TP_BUTTON;Part TP_SEPARATOR;Part TP_SEPARATORVERT;Part TKP_TRACK;Part TKP_TRACKVERT;Part TKP_THUMB;Part TKP_THUMBBOTTOM;Part TKP_THUMBTOP;Part TKP_THUMBVERT;Part TKP_THUMBLEFT;Part TKP_THUMBRIGHT;Part TKP_TICS;Part TKP_TICSVERT;Part TVP_TREEVIEW;Part TVP_GLYPH;Part WP_WINDOW;Part WP_CAPTION;Part WP_MINCAPTION;Part WP_MAXCAPTION;Part WP_FRAMELEFT;Part WP_FRAMERIGHT;Part WP_FRAMEBOTTOM;Part WP_SYSBUTTON;Part WP_MDISYSBUTTON;Part WP_MINBUTTON;Part WP_MDIMINBUTTON;Part WP_MAXBUTTON;Part WP_CLOSEBUTTON;Part WP_MDICLOSEBUTTON;Part WP_RESTOREBUTTON;Part WP_MDIRESTOREBUTTON;Control control;String subAppName/** An enumeration of the possible component states */State ACTIVE;State ASSIST;State BITMAP;State CHECKED;State CHECKEDDISABLED;State CHECKEDHOT;State CHECKEDNORMAL;State CHECKEDPRESSED;State CHECKMARKNORMAL;State CHECKMARKDISABLED;State BULLETNORMAL;State BULLETDISABLED;State CLOSED;State DEFAULTED;State DISABLED;State DISABLEDHOT;State DISABLEDPUSHED;State DOWNDISABLED;State DOWNHOT;State DOWNNORMAL;State DOWNPRESSED;State FOCUSED;State HOT;State HOTCHECKED;State ICONHOT;State ICONNORMAL;State ICONPRESSED;State ICONSORTEDHOT;State ICONSORTEDNORMAL;State ICONSORTEDPRESSED;State INACTIVE;State INACTIVENORMAL;State INACTIVEHOT;// See note 1State INACTIVEPUSHED;State INACTIVEDISABLED;State LEFTDISABLED;State LEFTHOT;State LEFTNORMAL;State LEFTPRESSED;State MIXEDDISABLED;State MIXEDHOT;State MIXEDNORMAL;State MIXEDPRESSED;State NORMAL;State PRESSED;State OPENED;State PUSHED;State READONLY;State RIGHTDISABLED;State RIGHTHOT;State RIGHTNORMAL;State RIGHTPRESSED;State SELECTED;State UNCHECKEDDISABLED;State UNCHECKEDHOT;State UNCHECKEDNORMAL;State UNCHECKEDPRESSED;State UPDISABLED;State UPHOT;State UPNORMAL;State UPPRESSED;State HOVER;State UPHOVER;State DOWNHOVER;State LEFTHOVER;State RIGHTHOVER;State SORTEDDOWN;State SORTEDHOT;State SORTEDNORMAL;State SORTEDPRESSED;State SORTEDUP;EnumMap<Part,State[]> stateMap;/** A map of allowed states for each Part */State[] comboBoxStatesnew State[]State[] scrollBarStatesState[] spinnerStatesState[] frameButtonStatesState[] sliderThumbStatesState[] tabStatesState[] frameStatesState[] captionStatesnew EnumMap<Part,State[]>(...)Part.EP_EDITTEXTPart.BP_PUSHBUTTONPart.BP_RADIOBUTTONPart.BP_CHECKBOXPart.CP_COMBOBOXPart.CP_DROPDOWNBUTTONPart.CP_BACKGROUNDPart.CP_TRANSPARENTBACKGROUNDPart.CP_BORDERPart.CP_READONLYPart.CP_DROPDOWNBUTTONRIGHTPart.CP_DROPDOWNBUTTONLEFTPart.CP_CUEBANNERPart.HP_HEADERITEMPart.HP_HEADERSORTARROWPart.SBP_SCROLLBARPart.SBP_THUMBBTNVERTPart.SBP_THUMBBTNHORZPart.SBP_GRIPPERVERTPart.SBP_GRIPPERHORZPart.SBP_ARROWBTNPart.SPNP_UPPart.SPNP_DOWNPart.TVP_GLYPHPart.WP_CLOSEBUTTONProp.IMAGECOUNTPart.WP_MINBUTTONPart.WP_MAXBUTTONPart.WP_RESTOREBUTTONPart.TKP_TRACKPart.TKP_TRACKVERTPart.TKP_THUMBPart.TKP_THUMBBOTTOMPart.TKP_THUMBTOPPart.TKP_THUMBVERTPart.TKP_THUMBRIGHTPart.TABP_TABITEMPart.TABP_TABITEMLEFTEDGEPart.TABP_TABITEMRIGHTEDGEPart.WP_WINDOWPart.WP_FRAMELEFTPart.WP_FRAMERIGHTPart.WP_FRAMEBOTTOMPart.WP_CAPTIONPart.WP_MINCAPTIONPart.WP_MAXCAPTIONPart.MP_BARBACKGROUNDPart.MP_BARITEMPart.MP_POPUPCHECKPart.MP_POPUPCHECKBACKGROUNDPart.MP_POPUPITEMPart.MP_POPUPSUBMENUEnum<>[] statesinitStates(...)states.lengthState.NORMAL/** An enumeration of the possible component attributes and the ... */new Prop(...)Prop COLOR;Prop SIZE;Prop FLATMENUS;Prop BORDERONLY;Prop IMAGECOUNT;// only draw the border area of the imageProp BORDERSIZE;// the number of state images in an imagefileProp PROGRESSCHUNKSIZE;// the size of the border line for bgtype=BorderFillProp PROGRESSSPACESIZE;// size of progress control chunksProp TEXTSHADOWOFFSET;// size of progress control spacesProp NORMALSIZE;// where char shadows are drawn, relative to orig. charsProp SIZINGMARGINS;// size of dest rect that exactly sourceProp CONTENTMARGINS;// margins used for 9-grid sizingProp CAPTIONMARGINS;// margins that define where content can be placedProp BORDERCOLOR;// margins that define where caption text can be placedProp FILLCOLOR;// color of borders for BorderFillProp TEXTCOLOR;// color of bg fillProp TEXTSHADOWCOLOR;// color text is drawn inProp BGTYPE;// color of text shadowProp TEXTSHADOWTYPE;// basic drawing type for each partProp TRANSITIONDURATIONS;// type of shadow to draw with text/** An enumeration of attribute values for some Props */new TypeEnum(...)Prop.BGTYPEProp.TEXTSHADOWTYPETypeEnum BT_IMAGEFILE;TypeEnum BT_BORDERFILL;TypeEnum TST_NONE;TypeEnum TST_SINGLE;TypeEnum TST_CONTINUOUS;this.propthis.enumNameProp prop;String enumName;TypeEnum ee.prope.value/* <p>These classes are designed to be used while the ... */// Note 1: The INACTIVE frame button states apply when the frame//         is inactive. They are not defined in tmschema.h// Fix for 6316538: Vista has five frame button states// States for Slider (trackbar)// States for Tabsimport static TMSchema.*import static XPStyle.Skin/** Factory object that can vend Borders appropriate for the Windows 95 L & F. ... *//** Returns a  border instance for a Windows Progress Bar ... */Border progressBarBordernew ProgressBarBorder(...)WindowsBorders.ProgressBarBorder/** Returns a border instance for a Windows ToolBar ... */Border toolBarBordernew ToolBarBorder(...)WindowsBorders.ToolBarBorder/** Returns an new instance of a border used to indicate which cell item ... */new ComplementDashedBorder(...)Border tableHeaderBorderBasicBorders.ButtonBorderBorder internalFrameBordernew InternalFrameLineBorder(...)WindowsBorders.InternalFrameLineBorder/** A border for the ToolBar. If the ToolBar is floatable then the handle grip is drawn ... */Border xpBorderPart.TP_TOOLBARpaintBorder(...)isFloatable(...)Part.RP_GRIPPERVERTPart.RP_GRIPPERSkin skingetSkin(...)int dwint dhint gripInset/** This class is an implementation of a dashed border. ... */drawDashedRect(...)/** A dashed border that paints itself in the complementary color ... */Color origColor;Color paintColor;/** This class is an implementation of the InternalFrameLine border. ... */Color activeColor;Color inactiveColor;/* Copyright (c) 1998, 2010, Oracle and/or its affiliates. All rights reserved. ... */// draw top// draw left// draw bottom// draw right// Vertical// Set the line color so the line border gets the correct// color./* Copyright (c) 1998, 2006, Oracle and/or its affiliates. All rights reserved. ... *//* This class is currently not used, but exists in case customers ... */import static Part.*/** Windows button. ... */int dashedRectGapX;int dashedRectGapY;int dashedRectGapWidth;int dashedRectGapHeight;Object WINDOWS_BUTTON_UI_KEY;WindowsButtonUI windowsButtonUInew WindowsButtonUI(...)//            DefaultsString ppgetXPButtonType(...)/** Overridden method to render the text without the mnemonic */getTextShiftOffset(...)setTextShiftOffset(...)//          Layout MethodsRectangle viewRect;/* These rectangles/insets are allocated once for all ... */paintXPButtonBackground(...)boolean toolbarState stateState.CHECKEDDISABLEDState.UNCHECKEDDISABLEDState.CHECKEDPRESSEDState.UNCHECKEDPRESSEDisRollover(...)State.CHECKEDHOTState.UNCHECKEDHOTState.CHECKEDNORMALState.UNCHECKEDNORMALState.PRESSEDState.DISABLEDState.HOTCHECKEDState.CHECKEDgetXPButtonState(...)getOpaqueInsets(...)/** returns - b.getBorderInsets(c) if border is opaque ... */isBorderOpaque(...)CompoundBorder cbInsets iOutgetOutsideBorder(...)Insets iIniOut.topiIn.topiOut.leftiIn.leftiOut.bottomiIn.bottomiOut.rightiIn.right// focus painted same color as text on Basic??/* Ensure that the width and height of the button is odd, ... */// Note: The border may be compound, containing an outer// opaque border (supplied by the application), plus an// inner transparent margin border. We want to size the// background to fill the transparent part, but stay// inside the opaque part.// Outside border is opaque, keep looking// Inside is non-opaque, use outside insets// Found non-opaque somewhere in the inside (which is// also compound).// Outside is either all non-opaque or has non-opaque// border inside another compound border/** Windows check box menu item. ... */getPart(...)WindowsMenuItemUIAccessor accessor;new WindowsCheckBoxMenuItemUI(...)isVistaPainting(...)/** Method which renders the text of the current menu item. ... */// Uses protected field./** Windows check box. ... */Object WINDOWS_CHECK_BOX_UI_KEY;// painting changes made in MetalRadioButtonUI.// of BasicCheckBoxUI because we want to pick up all the// NOTE: MetalCheckBoxUI inherts from MetalRadioButtonUI insteadWindowsCheckBoxUI windowsCheckBoxUInew WindowsCheckBoxUI(...)/** Implements the Windows95/98/ME/NT/2000 Look and Feel. ... */import static TMSchema.Partimport static TMSchema.Stateimport DefaultLookupimport StringUIClientPropertyKey/** Windows combo box. ... */getComboBox(...)WindowsComboBoxUI comboBoxUIgetWindowsComboBoxUI(...)ButtonModel mcomboBoxUI.arrowButtonsetRollover(...)comboBoxUI.isRolloverhandleRollover(...)Object sourceJComboBox<> rvgetWindowsComboBoxUI(...).comboBoxWindowsComboBoxUI rvsetPart(...)ComponentOrientation.RIGHT_TO_LEFTMouseListener rolloverListener;boolean isRollover;PropertyChangeListener componentOrientationListener;new WindowsComboBoxUI(...)isSkinDefined(...)unconfigureEditor(...)paintXPComboBoxBackground(...)isPopupVisible(...)getXPComboBoxState(...)/** If necessary paints the currently selected item. ... */boolean shouldValidatepaintCurrentValueBackground(...)/** Creates a layout manager for managing the components which make up the ... */createPopup(...)/** Creates the default editor that will be used in editable combo boxes. ... */new WindowsComboBoxEditor(...)new WindowsComboBoxRenderer(...)createRenderer(...)/** Creates an button which will be used as the control to show or hide ... */new XPComboBoxButton(...)createArrowButton(...)XPStyle.GlyphButtonWindowsComboBoxUI.this/** Subclassed to add Windows specific Key Bindings. ... */new InvocationKeyHandler(...)WindowsComboPopup.this/** Subclassed to highlight selected item in an editable combo box. */BasicComboBoxEditor.UIResourceJTextField editorcreateEditorComponent(...)Object focussetItem(...)/** Subclassed to set opacity {@code false} on the renderer ... */BasicComboBoxRenderer.UIResourcenew StringUIClientPropertyKey(...)Object BORDER_KEY;Border NULL_BORDER;Component rvBorder dashedBordernew DashedBorder(...)WindowsBorders.DashedBorderObject storedBorder//mouse over editable ComboBox does not switch rollover//for the arrow button//we can not do it in installListeners because arrowButton//is initialized after installListeners is invoked//button glyph for LTR and RTL combobox might differ// On vista for READNLY ComboBox// color for currentValue is the same as for any other item// mostly copied from javax.swing.plaf.basic.BasicComboBoxUI.paintCurrentValue/* for non editable ComboBoxes Vista seems to have the ... *///store current border in client property if needed/** Windows icon for a minimized window on the desktop. ... */new WindowsDesktopIconUI(...)// Uninstall the listeners added by the WindowsInternalFrameTitlePaneWindowsInternalFrameTitlePane thePanenew WindowsInternalFrameTitlePane(...)/** Windows desktop icons are restricted to a width of 160 pixels by ... */Dimension dimdim.width// Windows desktop icons can not be resized.  Therefore, we should// always return the minimum size of the desktop icon. See// getMinimumSize(JComponent c).import DefaultDesktopManagerimport JLayeredPaneimport Vector/** This class implements a DesktopManager which more closely follows ... */WeakReference<JInternalFrame> currentFrameRef;/* The frame which is currently selected/activated. ... */JInternalFrame currentFramesetMaximum(...)PropertyVetoException enew WeakReference<JInternalFrame>(...)/* Copyright (c) 1998, 2008, Oracle and/or its affiliates. All rights reserved. ... */// If the current frame is maximized, transfer that// attribute to the frame being activated.//Special case.  If key binding was used to select next//frame instead of minimizing the icon via the minimize//icon./** Windows desktop pane. ... */new WindowsDesktopPaneUI(...)new WindowsDesktopManager(...)requestDefaultFocus(...)// Request focus if it isn't set./** Windows rendition of the component. ... *//** Creates a UI for a JEditorPane. ... */new WindowsEditorPaneUI(...)new WindowsCaret(...)WindowsTextUI.WindowsCaretimport FileNotFoundExceptionimport sun.swing.*/** Windows L&F implementation of a FileChooser. ... */new WindowsFileView(...)JPanel centerPanel;// Windows FileChooser L&F is not complete yet.// The following are private because the implementation of theJLabel lookInLabel;JComboBox<File> directoryComboBox;ActionListener directoryComboBoxAction;FilePane filePane;WindowsPlacesBar placesBar;JButton cancelButton;JPanel buttonPanel;Dimension vstrut4;Dimension vstrut6;Dimension vstrut8;Insets shrinkwrap;int PREF_WIDTH;// Preferred and Minimum sizes for the dialog boxint PREF_HEIGHT;int LIST_PREF_WIDTH;int LIST_PREF_HEIGHT;Dimension LIST_PREF_SIZE;int lookInLabelMnemonic;// Labels, mnemonics, and tooltips (oh my!)String lookInLabelText;String saveInLabelText;int fileNameLabelMnemonic;String fileNameLabelText;int folderNameLabelMnemonic;String folderNameLabelText;int filesOfTypeLabelMnemonic;String filesOfTypeLabelText;String upFolderToolTipText;String upFolderAccessibleName;String newFolderToolTipText;String newFolderAccessibleName;String viewMenuButtonToolTipText;String viewMenuButtonAccessibleName;BasicFileView fileView;new WindowsFileChooserUI(...)FilePane.FileChooserUIAccessorWindowsFileChooserUI.thiscreateList(...)createDetailsView(...)FileSystemView fsvJToolBar topPanelnew JToolBar(...)JButton upFolderButtoncreateToolButton(...)ButtonGroup viewButtonGroupnew ButtonGroup(...)JPopupMenu viewTypePopupMenuJRadioButtonMenuItem listViewMenuItemnew JRadioButtonMenuItem(...)getViewTypeAction(...)FilePane.VIEWTYPE_LISTJRadioButtonMenuItem detailsViewMenuItemFilePane.VIEWTYPE_DETAILSGraphics graphicsJButton viewMenuButtonJPanel labelPanelJLabel ftlJPanel fileAndFilterPanelInsets buttonMarginnew FilePane(...)new WindowsFileChooserUIAccessor(...)updateUseShellFolder(...)setFloatable(...)JLabel.TRAILINGcreateDirectoryComboBoxRenderer(...)getViewType(...)fillPolygon(...)KeyEvent.VK_SPACEaddPopupMenuListener(...)BoxLayout.Y_AXISgetSelectedFiles(...)getSelectedFile(...)new JComboBox<FileFilter>(...)getButtonPanel(...)buttonMargin.topbuttonMargin.bottombuttonMargin.leftbuttonMargin.rightaddControlButtons(...)usesShellFolder(...)new WindowsPlacesBar(...)BorderLayout.BEFORE_LINE_BEGINSActionMap actionMapcreateActionMap(...)addActionsToMap(...)getActions(...)/** Creates a selection listener for the list of files and directories. ... */// Obsolete class, not used in this version./** Returns the preferred size of the specified ... */int prefWidthPREF_SIZE.height/** Returns the minimum size of the <code>JFileChooser</code>. ... *//** Returns the maximum size of the <code>JFileChooser</code>. ... */isFileSystemRoot(...)/* The following methods are used by the PropertyChange Listener */clearIconCache(...)getDialogType(...)removeControlButtons(...)/* Listen for filechooser property changes, such as ... */doSelectedFilesChanged(...)doFilterChanged(...)doAccessoryChanged(...)doApproveButtonTextChanged(...)doDialogTypeChanged(...)JFileChooser.APPROVE_BUTTON_MNEMONIC_CHANGED_PROPERTYdoApproveButtonMnemonicChanged(...)ensureFileIsVisible(...)/** Property to remember whether a directory is currently selected in the UI. ... */new DirectoryComboBoxRenderer(...)JButton resultWindowsLookAndFeel.HI_RES_DISABLED_ICON_CLIENT_KEYsetPressed(...)// Renderer for DirectoryComboBoxnew IndentIcon(...)IndentIcon ii;File directoryii.iconii.depthgetDepth(...)int space;...[] depths;boolean useShellFolderFile[] baseFoldersgetRoots(...)getCanonicalFile(...)File sfgetShellFolder(...)Vector<File> pathint pathCountint topIndexinsertElementAt(...)calculateDepths(...)depths.lengthFile parent/* FileView type descriptions */getCachedIcon(...)getSystemIcon(...)cacheIcon(...)// ********************************* //// **** Construct the top panel **** //// Directory manipulation buttons// Add the top panel to the fileChooser// ComboBox Label// Must be small enough to not affect total width.// Up Button// New Directory Button// View button group// Popup Menu// Create icon for viewMenuButton// Details Button// Forbid keyboard actions if the button is not in rollover state// ************************************** //// ******* Add the directory pane ******* //// ********************************** //// **** Construct the bottom panel ** //// Add the bottom panel to file chooser// labels// file entry and filters// buttons// Decide whether to use the ShellFolder class to populate shortcut// panel and combobox.// Remove listeners// PENDING(jeff) - get the name from the directory combobox// PENDING(jeff) - set the name in the directory combobox// Reset other buttons// Insert chain at appropriate place in vector/** A collection of static utility methods used for rendering the Windows look ... *//** Renders a text String in Windows without the mnemonic. ... */isMnemonicHidden(...)paintXPText(...)paintClassicText(...)Color textColorTypeEnum shadowTypegetTypeEnum(...)Prop.TEXTCOLORColor enabledColorTypeEnum.TST_SINGLETypeEnum.TST_CONTINUOUSColor shadowColorProp.TEXTSHADOWCOLORPoint offsetProp.TEXTSHADOWOFFSEToffset.xoffset.y/* Repaints all the components with the mnemonics in the given window and ... */Window[] ownedWindowsownedWindows.lengthrepaintMnemonicsInWindow(...)repaintMnemonicsInContainer(...)/* Repaints all the components with the mnemonics in container. ... */getDisplayedMnemonic(...)/* Copyright (c) 2000, 2014, Oracle and/or its affiliates. All rights reserved. ... */// W2K Feature: Check to see if the Underscore should be rendered./* Draw the Text *//** * paint the text normally *//* We shall not set foreground color for selected menu or ... *//** * paint the text disabled ** */// to work around an apparent bug in Windows, use the pushbutton// color for disabled toolbar buttons if the disabled color is the// same as the enabled color// only draw shadow if developer hasn't changed the foreground color// and if the current style has text shadows.import ButtonUIimport MenuItemCheckIconFactory/** Factory object that can vend Icons appropriate for the Windows L & F. ... */Icon frame_closeIcon;Icon frame_iconifyIcon;Icon frame_maxIcon;Icon frame_minIcon;Icon frame_resizeIcon;Icon checkBoxMenuItemIcon;Icon radioButtonMenuItemIcon;VistaMenuItemCheckIconFactory menuItemCheckIconFactory;new MenuItemCheckIcon(...)new CheckBoxMenuItemIcon(...)new RadioButtonMenuItemIcon(...)new VistaMenuItemCheckIconFactory(...)new FrameButtonIcon(...)new ResizeIcon(...)getAncestorOfClass(...)boolean jifSelectedState.PUSHEDState.INACTIVEDISABLEDState.INACTIVEPUSHEDState.INACTIVEHOTState.INACTIVENORMALint thickness2getPartSize(...)JCheckBox cb// End class CheckBoxMenuItemIconfillRoundRect(...)// End class RadioButtonMenuItemIcon// End class MenuItemCheckIcon// End class MenuItemArrowIconscale(...)int OFFSET;new VistaMenuItemCheckIcon(...)(...).typeClass<? extends JMenuItem> rv/** CheckIcon for JMenuItem, JMenu, JCheckBoxMenuItem and ... */JMenuItem menuItem;Class<? extends JMenuItem> type;this.menuItemIcon lafIcongetLaFIcon(...)Part backgroundPartState backgroundStateState.BITMAPState.BULLETNORMALState.CHECKMARKNORMALState.DISABLEDPUSHEDState.BULLETDISABLEDState.CHECKMARKDISABLEDWindowsMenuItemUIAccessor rvButtonUI uiObject(...).accessorWindowsMenuItemUIAccessor accessorgetAccessor(...)State.DISABLEDHOTIcon rv/** Check if developer changed icon in the UI table. ... */typeToString(...)delete(...)// Find out if frame is inactive// Fix for XP bug where sometimes these sizes aren't updated properly// Assume for now that height is correct and derive width using the// ratio from the uxtheme part// outer bevel// Outer top/left// Outer bottom/right// Inner top.left// Inner bottom/right// inside box// paint check// outter left arc// outter right arc// inner left arc// inner right arc// indicate whether selected or not/* For debugging: ... */// use icon from the UI table if it does not match this one.// remove package name, dot and the first character// End class VistaMenuItemCheckIconFactoryimport BasicInternalFrameTitlePaneColor selectedTitleGradientColor;Color notSelectedTitleGradientColor;JPopupMenu systemPopupMenu;JLabel systemLabel;int titlePaneHeight;int buttonWidth, ...;boolean hotTrackingOn;Color activeBorderColorcreateLineBorder(...)createButtons(...)setContentAreaFilled(...)setButtonIcons(...)paintTitleBackground(...)Font newFontint baselinegetLeading(...)Rectangle lastIconBoundsint titleXint titleWint gaplastIconBounds.xgetInsets(...).rightint minTitleXlastIconBounds.widthint availableWidthgetInsets(...).leftString shadowTypeState.ACTIVEPoint shadowOffsetshadowOffset.xshadowOffset.yState.INACTIVEBoolean gradientsOngetDesktopPropertyValue(...)Paint savePaintgetPaint(...)GradientPaint titleGradientaddSystemMenuItems(...)int iconWidthint iconHeightdouble drawScaledoDefaultCloseAction(...)showSystemPopupMenu(...)dim.heightnew WindowsPropertyChangeHandler(...)new WindowsTitlePaneLayout(...)BasicInternalFrameTitlePane.TitlePaneLayoutInsets captionMargin;Insets contentMargin;XPStyle xp;WindowsInternalFrameTitlePane.thisProp.CAPTIONMARGINSProp.CONTENTMARGINSint iconSizecaptionMargin.leftcaptionMargin.rightlayoutButton(...)Part.WP_SYSBUTTON// end WindowsTitlePaneLayoutJInternalFrame.FRAME_ICON_PROPERTY/** A versatile Icon implementation which can take an array of Icon ... */// We can use an arbitrary size here because we scale to it in paintIcon()...[] icons;/** @params ... */this.iconsnew Icon[]icons.lengthint bestIndexint minDiffint diffdouble scalegetScaleX(...)getTransform(...)getBestIcon(...)/* Copyright (c) 2001, 2014, Oracle and/or its affiliates. All rights reserved. ... */// JDK-8039383: initialize these colors because getXP() may return null when theme is changed// Center text vertically.// There are no icons// Note: Don't know how to calculate height on XP,// the captionbarheight is 25 but native caption is 30 (maximized 26)// Create scratch graphics// Set drawing scale to make icon scale to our desired size// Center icon vertically// Center icon horizontally// System button// Note: this icon is square, but the buttons aren't always.// Right hand buttons// XP seems to ignore margins and offset here// Update the internal frame icon for the system menu.// Calculate how big our drawing area is in pixels// Assume we are square// Set drawing scale to make icon act true to our reported sizenew XPBorder(...)new WindowsInternalFrameUI(...)Skin leftSkin;Skin rightSkin;Skin bottomSkin;int topBorderHeightgetSize(...).heightimport JLabelObject WINDOWS_LABEL_UI_KEY;WindowsLabelUI windowsLabelUInew WindowsLabelUI(...)int mnemonicIndexColor backgroundimport ImageFilterimport ImageProducerimport FilteredImageSourceimport RGBImageFilterimport ActionEventimport ImageIconUIResourceimport SwingLazyValueimport VistaMenuItemCheckIconFactory/** Implements the Windows95/98/NT/2000 Look and Feel. ... */Object HI_RES_DISABLED_ICON_CLIENT_KEY;/** A client property that can be used with any JComponent that will end up ... */boolean useSystemFontSettings;boolean useSystemFontSizeSettings;DesktopProperty themeActive, ...;// private members to avoid being GC'd.// These properties are not used directly, but are kept asDesktopProperty aaSettings;LayoutStyle style;int baseUnitX;/** Base dialog units along the horizontal axis. */int baseUnitY;/** Base dialog units along the vertical axis. */OSInfo.OSType.WINDOWSisNativeLookAndFeel(...)String systemFontsgetWindowsVersion(...)OSInfo.WINDOWS_95addKeyEventPostProcessor(...)WindowsRootPaneUI.altProcessor/** Initialize the uiClassID to BasicComponentUI mapping. ... */String windowsPackageName// ie. Take a look at RadioButtonBorder, etc...// XXX - there are probably a lot of redundant values that could be removed.Integer twelveInteger fontPlainInteger fontBoldObject dialogPlain12Object sansSerifPlain12Object monospacedPlain12Object dialogBold12ColorUIResource grayColorUIResource darkGrayColorUIResource scrollBarTrackHighlightWindowsTreeUI.ExpandedIconWindowsTreeUI.CollapsedIconObject menuItemAcceleratorDelimiterObject ControlBackgroundColornew DesktopProperty(...)Object ControlLightColorObject ControlHighlightColorObject ControlShadowColorObject ControlDarkShadowColorObject ControlTextColorObject MenuBackgroundColorObject MenuBarBackgroundColorObject MenuTextColorObject SelectionBackgroundColorObject SelectionTextColorObject WindowBackgroundColorObject WindowTextColorObject WindowBorderWidthObject TitlePaneHeightObject TitleButtonWidthObject TitleButtonHeightObject InactiveTextColorObject ScrollbarBackgroundColorObject buttonFocusColornew FocusColorProperty(...)Object TextBackgroundnew XPColorValue(...)Part.EP_EDITProp.FILLCOLORObject ReadOnlyTextBackgroundObject DisabledTextBackgroundObject MenuFontObject FixedControlFontObject ControlFontObject MessageFontObject WindowFontObject ToolTipFontObject IconFontObject scrollBarWidthObject menuBarHeightObject hotTrackingOnObject showMnemonicsnew XPValue(...)new LazyWindowsIcon(...)new XPBorderValue(...)createFrameMaximizeIcon(...)createFrameMinimizeIcon(...)createFrameIconifyIcon(...)createFrameCloseIcon(...)new XPDLUValue(...)new ActiveWindowsIcon(...)Part.LVP_LISTVIEWnew Character(...)XPValue.NULL_VALUEPart.BP_GROUPBOXObject aaTextInfogetDesktopFontValue(...)this.aaSettingsnew FontDesktopProperty(...)SunToolkit.DESKTOPFONTHINTSnew WindowsFontSizeProperty(...)OSInfo.WINDOWS_XPthis.themeActivenew TriggerDesktopProperty(...)this.dllNamethis.colorNamethis.sizeNamegetLazyValueDefaults(...)initVistaComponentDefaults(...)OSInfo.WINDOWS_VISTAString[] menuClassesObject[] menuDefaultsmenuClasses.lengthVistaMenuItemCheckIconFactory menuItemCheckIconFactorygetMenuItemCheckIconFactory(...)InsetsUIResource insetsInteger checkIconOffsetIntegerInteger afterCheckIconGapgetSpanAfterGutter(...)getSpanBeforeGutter(...)getGutterWidth(...)Object minimumTextOffsetString POPUP_MENU_BORDERObject popupMenuBorderPart.MENUisOnVista(...)new SkinIcon(...)State.SORTEDDOWNState.SORTEDUP/** If we support loading of fonts from the desktop this will return ... */new WindowsFontProperty(...)// the updated desktop property values (colors mostly)// reinitialized in the defaults table to ensure the classes reference// When a desktop property change is detected, these classes must beObject buttonBorderObject textFieldBorderObject textFieldMarginObject spinnerBorderObject spinnerArrowInsetsObject comboBoxBorderObject focusCellHighlightBorderObject etchedBorderObject internalFrameBorderObject loweredBevelBorderObject marginBorderObject menuBarBorderObject progressBarBorderObject radioButtonBorderObject scrollPaneBorderPart.LBP_LISTBOXObject tableScrollPaneBorderObject tableHeaderBorderObject toolBarBorderObject toolTipBorderObject radioButtonMenuItemIconObject[] lazyDefaultsuninitialize(...)WindowsPopupMenuUI.mnemonicListenerremoveKeyEventPostProcessor(...)boolean isMnemonicHidden;// Toggle flag for drawing the mnemonic stateboolean isClassicWindows;// should be disabled.// Flag which indicates that the Win98/Win2k/WinME features/** Sets the state of the hide mnemonic flag. This flag is used by the ... *//** Gets the state of the hide mnemonic flag. This only has meaning ... *//** Gets the state of the flag which indicates if the old Windows ... */provideErrorFeedback(...)LayoutStyle stylenew WindowsLayoutStyle(...)/** Returns an <code>Action</code>. ... */// ********* Auditory Cue support methods and objects *********String audioKeyString audioValuenew AudioAction(...)/** Pass the name String to the super constructor. This is used ... */Runnable audioRunnable;String audioResource;/** We use the String as the name of the Action and as a pointer to ... *//** Gets an <code>Icon</code> from the native libraries if available, ... */String nativeImage;String resource;this.nativeImagethis.resource/** Gets an <code>Icon</code> from the native libraries if available. ... */String nativeImageName;String fallbackName;DesktopProperty desktopProperty;this.nativeImageNamethis.fallbackNamethis.desktopPropertynew ImageIconUIResource(...)LazyValue fallback/** Icon backed-up by XP Skin. */State state;/** Draw the icon at the specified location.  Icon implementations ... *//** Returns the icon's width. ... *//** Returns the icon's height. ... *//** DesktopProperty for fonts. If a font with the name 'MS Sans Serif' ... */(...).styleFont msFontgetScreenResolution(...)HeadlessException exfontSupportsDefaultEncoding(...)/** DesktopProperty for fonts that only gets sizes from the desktop, ... */String fontName;int fontSize;int fontStyle;this.fontNamethis.fontSizethis.fontStyle/** A value wrapper that actively retrieves values from xp or falls back ... */Object classicValue, ...;Object NULL_VALUE;// A constant that lets you specify null when using XP styles.this.xpValuethis.classicValuegetXPValue(...)getClassicValue(...)recursiveCreateValue(...)Border extraMargin;this.extraMarginnew XPColorValueKey(...)XPColorValueKey keykey.skinkey.propSkin skin;this.skinnew Skin(...)int direction;int pxdluToPixels(...)UIDefaults defaults// http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnwue/html/ch14e.asp// Windows LayoutStyle.  From:int indentgetIndent(...)getButtonGap(...)/** Converts the dialog unit argument to pixels along the specified ... */calculateBaseUnits(...)/** Calculates the dialog unit mapping. */FontMetrics metricsImageFilter filternew RGBGrayFilter(...)Image resultImagefloat avgint rgbvalObject highContrastOn// Set the flag which determines which version of Windows should// be rendered. This flag only need to be set once.// if version <= 4.0 then the classic LAF should be loaded.// Using the fonts set by the user can potentially cause// performance and compatibility issues, so allow this feature// to be switched off either at runtime or programmatically/* Background color for menus *//* LightShadow of menubutton highlight *//* Default color for foreground "text" in menu item *//* Text color for menus *//* "controlHighlight", "#E0E0E0", *//* Specular highlight (opposite of the shadow) *//* Scrollbar background (usually the "track") */// *** Shared Fonts// *** Colors// XXX - some of these doens't seem to be used//The following four lines were commented out as part of bug 4991597//This code *is* correct, however it differs from WindowsXP and is, apparently//a Windows XP bug. Until Windows fixes this bug, we shall also exhibit the same//behavior//Object ReadOnlyTextBackground = new XPColorValue(Part.EP_EDITTEXT, State.READONLY, Prop.FILLCOLOR,//                                                 ControlBackgroundColor);//Object DisabledTextBackground = new XPColorValue(Part.EP_EDITTEXT, State.DISABLED, Prop.FILLCOLOR,/* Put the desktop AA settings in the defaults. ... */// These desktop properties are not used directly, but are needed to// trigger realoading of UI's.// *** Auditory Feedback// this key defines which of the various cues to render// Overridden from BasicL&F. This L&F should play all sounds// all the time. The infrastructure decides what to play.// This is disabled until sound bugs can be resolved.// table.get("AuditoryCues.cueList"),// Button.foreground, Button.shadow, Button.darkShadow,// Button.disabledForground, and Button.disabledShadow are only// used for Windows Classic. Windows XP will use colors// from the current visual style.// W2K keyboard navigation hidding.// margin is 2 all the way around, BasicBorders.RadioButtonBorder// (checkbox uses RadioButtonBorder) is 2 all the way around too.// DeskTop.// DesktopIcon// The constructor takes one arg: an array of UIDefaults.LazyValue// representing the icons// Internal Frame Auditory Cue Mappings// Label// List.// PopupMenu// MenuBar.// Menu Item Auditory Cue Mapping// indicates that keyboard navigation won't skip disabled menu items// is 2 all the way around too.// OptionPane.// Option Pane Auditory Cue Mappings// Error// Info Plain// Question// Warning// *** Panel// *** PasswordField// for disabled// for readonly// *** ProgressBar// *** RootPane.// *** ScrollBar.// *** ScrollPane.// *** Separator// *** Slider.// *** SplitPane// *** TabbedPane// *** Table// cell text color// cell background color// grid line color// header text color// header background// use default bg from XP styles// or white bg otherwise// *** TextArea// *** TextField// *** TextPane// *** TitledBorder// *** ToggleButton// *** ToolBar// *** ToolTip// *** ToolTipManager// *** Viewport/* START handling menus for Vista *//* all the menus need to be non opaque. *//* acceleratorSelectionForeground color is the same as ... *//* they have the same MenuItemCheckIconFactory *//* height can be even *//* no margins *//* set checkIcon offset *//* set width of the gap after check icon *//* text is started after this position *//* JPopupMenu has a bit of free space around menu items *//* END handling menus for Vista *//* START table handling for Vista *//* END table handling for Vista */// For focus rectangle for cells and trees.// *** ToolTips// Do not hide mnemonics if the UI defaults do not support this// Runnable appears to block until completed playing, hence// start up another thread to handle playing.// This desktop property is needed to trigger reloading the icon.// It is kept in member variable to avoid GC.// 4950968: Workaround to mimic the way Windows maps the default// font size of 6 pts to the smallest available bitmap font size.// This happens mostly on Win 98/Me & NT.// This call adds a property change listener for the property,// which triggers a call to updateUI(). The value returned// is not interesting here.// Make sure property change listener is readded each time// Windows doesn't spec this// Fall through to related.// Between text labels and their associated controls (for// example, text boxes and list boxes): 3// NOTE: We're not honoring:// 'Text label beside a button 3 down from the top of// the button,' but I suspect that is an attempt to// enforce a baseline layout which will be handled// separately.  In order to enforce this we would need// this API to return a more complicated type (Insets,// or something else).// Between related controls: 4// Between unrelated controls: 7// This calculation comes from:// http://support.microsoft.com/default.aspx?scid=kb;EN-US;125681// The -1 comes from experimentation.// if the component has a HI_RES_DISABLED_ICON_CLIENT_KEY// client property set to Boolean.TRUE, then use the new// hi res algorithm for creating the disabled icon (used// in particular by the WindowsFileChooserUI class)// find the average of red, green, and blue// pull out the alpha channel// calc the average// turn back into rgb// Fallback value is never used because of the configureValue method doesn't return nullimport ActionMapUIResourceimport HierarchyEventimport HierarchyListenerimport WindowAdapterimport WindowEventimport WindowListenerimport WindowStateListenerimport TMSchema.*import XPStyle.*/* to be accessed on the EDT only */HierarchyListener hierarchyListener;Window window;new WindowsMenuBarUI(...)uninstallWindowListener(...)removeHierarchyListener(...)getTopLevelAncestor(...)addWindowListener(...)removeWindowListener(...)installWindowListener(...)getChangeFlags(...)HierarchyEvent.DISPLAYABILITY_CHANGEDisDisplayable(...)addHierarchyListener(...)new TakeFocus(...)/** Action that activates the menu (e.g. when F10 is pressed). ... */getMenu(...)MenuSelectionManager msmsetMnemonicHidden(...)repaintRootPane(...)isActive(...)/** Checks if component belongs to an active window. ... */JRootPane rootPane// show mnemonicsnew WindowsMenuItemUI(...)int menuWidthint menuHeight/* TODO idk can we use XPStyle.isVista? ... *//* part of it copied from WindowsGraphicsUtils.java */import JMenuItem/** Accessor interface for WindowsMenuItemUI to allow for "multiple implementation ... *//* Copyright (c) 2006, Oracle and/or its affiliates. All rights reserved. ... */import MouseInputListenerState stateTmpMenuElement menuElementgetSubElements(...)Integer menuBarHeight;new WindowsMenuUI(...)isClassicWindows(...)setRolloverEnabled(...)/** Draws the background of the menu. ... */Color highlightboolean otherMenuSelectedMenuElement[] menusmenus.lengthboolean paintRollovernew WindowsMouseInputHandler(...)/** This class implements a mouse handler that sets the rollover flag to ... */BasicMenuUI.MouseInputHandlerisRolloverEnabled(...)getPreferredMenuItemSize(...)/* Only paint rollover if no other menu on menubar is ... *///non top level menus have HOT state instead of PUSHED/* on Vista top level menu for non active frame looks disabled */// Use superclass method for the old Windows LAF,// for submenus, and for XP toplevel if selected or pressed// Draw a lowered bevel border// Only paint rollover if no other menu on menubar is selected// Draw a raised bevel border// Note: When toolbar containers (rebars) are implemented, only do// this if the JMenuBar is not in a rebar (i.e. ignore the desktop// property win.menu.height if in a rebar.)/* Copyright (c) 1997, 2000, Oracle and/or its affiliates. All rights reserved. ... *//** Creates a UI for a JPasswordField ... */new WindowsPasswordFieldUI(...)import BasicPopupMenuSeparatorUI/** Windows L&F implementation of PopupMenuSeparatorUI. ... */new WindowsPopupMenuSeparatorUI(...)Part.MP_POPUPSEPARATORint skinHeights.heightObject gutterOffsetObjectWindowsPopupMenuUI.GUTTER_OFFSET_KEY/* Copyright (c) 2004, 2014, Oracle and/or its affiliates. All rights reserved. ... *//* gutter offset is in parent's coordinates. ... */import KeyEventPostProcessorimport KeyboardFocusManagerimport static SwingUtilities2.BASICMENUITEMUI_MAX_TEXT_OFFSETMnemonicListener mnemonicListener;Object GUTTER_OFFSET_KEY;new WindowsPopupMenuUI(...)new MnemonicListener(...)/** Returns the <code>Popup</code> that will be responsible for ... */PopupFactory popupFactorygetSharedInstance(...)getPopup(...)getInvoker(...)JRootPane repaintRoot;Window wingetWindowAncestor(...)/** Returns offset for the text. ... */int rvObject maxTextOffsetint menuItemOffset/** Returns span before gutter. ... *//** Returns span after gutter. ... *//** Returns gutter width. ... */Part.MP_POPUPGUTTER/** Checks if PopupMenu is leftToRight ... */Part.MP_POPUPBACKGROUNDint textOffsetgetTextOffset(...)int gutterWidthint gutterOffset// menu was canceled -- hide mnemonics/* this is in JMenuItem coordinates. ... *//* paint gutter only for leftToRight case */import JWindow/** A class which tags a window with a particular semantic usage, ... */int UNDEFINED_WINDOW_TYPE;int TOOLTIP_WINDOW_TYPE;int MENU_WINDOW_TYPE;int SUBMENU_WINDOW_TYPE;int POPUPMENU_WINDOW_TYPE;int COMBOBOX_POPUP_WINDOW_TYPE;int windowType;setFocusableWindowState(...)hide(...)removeNotify(...)pack(...)/* Copyright (c) 2001, 2002, Oracle and/or its affiliates. All rights reserved. ... *//** We need to call removeNotify() here because hide() does ... */Rectangle previousFullBox;Insets indeterminateInsets;new WindowsProgressBarUI(...)/** Returns the baseline. ... */getBaseline(...)isStringPainted(...)getInsets(...).topPart.PP_BARgetPreferredInnerHorizontal(...)Part.PP_BARVERTgetPreferredInnerVertical(...)boolean isLeftToRightint barRectWidthint barRectHeightint amountFullgetAmountFull(...)paintXPBackground(...)BasicStroke.CAP_BUTTBasicStroke.JOIN_BEVELpaintString(...)Part.PP_CHUNKVERTPart.PP_CHUNKint chunkSizePart.PP_PROGRESSProp.PROGRESSCHUNKSIZEint spaceSizeProp.PROGRESSSPACESIZEint nChunkspaintDeterminate(...)setAnimationIndex(...)Rectangle chunkgetFullChunkBounds(...)getBoxLength(...)getBox(...)Insets insint currentFramegetAnimationIndex(...)int framecountgetFrameCount(...)ins.rightins.leftdouble deltains.topins.bottompaintIndeterminateFrame(...)paintIndeterminate(...)int chunksizePart chunkint deltaxint deltayRectangle fullBoxRectangle progbarExtentsRectangle repaintAreaXPStyle.Skin// amount of progress to draw// Paint progress// Do not paint the standard stripes from the skin, because they obscure// the text// See if we can squeeze in an extra chunk without spacing after// get the full repaint area and add it the// previous one so we can erase it// an apparently hard coded value in Windows// this code adjusts the chunk size to properly account for the// size and gap specified in the XP style. It also does it's own// box placement for the chunk animation. This is required because// the inherited algorithm from BasicProgressBarUI goes back and// forth whereas XP only goes in one direction. XP also has ghosted// trailing chunks to create the illusion of speed. This code// adjusts the pixel length of the animation to account for the// trails.// add 2x for the trails// Paint the bouncing box.// create a new graphics to keep drawing surface state// calculate the chunk offsets// Calculate the area of the chunks combined// save this box for the next time// this is the entire progress bar minus the track and borders// only paint where the chunks overlap with the progress bar drawing area// adjust the cliprect to chop the chunks when they go off the end// get the skin// do the drawing// get rid of our clip and composite changes// Paint backgroundnew WindowsRadioButtonMenuItemUI(...)Object WINDOWS_RADIO_BUTTON_UI_KEY;boolean initialized;WindowsRadioButtonUI windowsRadioButtonUInew WindowsRadioButtonUI(...)//           DefaultstextRect.widthtextRect.height/* Copyright (c) 1997, 2012, Oracle and/or its affiliates. All rights reserved. ... */import Eventimport Toolkitimport AbstractActionimport ActionMapimport InputMapimport KeyStrokeimport JRootPaneimport SwingUtilitiesimport AbstractButtonimport JFrameimport JMenuimport JMenuBarimport MenuElementimport InputMapUIResourceimport BasicRootPaneUIimport ComboPopup/** Windows implementation of RootPaneUI, there is one shared between all ... */new WindowsRootPaneUI(...)new AltProcessor(...)WindowsRootPaneUI windowsRootPaneUI;AltProcessor altProcessor;boolean altKeyPressed;boolean menuCanceledOnPress;JRootPane root;Window winAncestor;consume(...)JMenuBar mbargetJMenuBar(...)getSelectedPath(...).lengthboolean skipToolkit tkComponent originalSourcegetOriginalSource(...)getKeyEventAccessor(...)getContainingWindow(...)getWindowDeactivationTime(...)isConsumed(...)KeyEvent.VK_ALTKeyEvent.KEY_PRESSEDaltPressed(...)KeyEvent.KEY_RELEASEDaltReleased(...)/* Copyright (c) 2000, 2012, Oracle and/or its affiliates. All rights reserved. ... */// We are in ComboBox// if no menu is active, we try activating the menubar// It might happen that the altRelease event is processed// with a reasonable delay since it has been generated.// Here we check the last deactivation time of the containing// window. If this time appears to be greater than the altRelease// event time the event is skipped to avoid unexpected menu// activation. See 7121442.// Also we must ensure that original source of key event belongs// to the same window object as winAncestor. See 8001633.// do not manage consumed eventGrid thumbGrid;Grid highlightGrid;Dimension horizontalThumbSize;Dimension verticalThumbSize;/** Creates a UI for a JScrollBar. ... */new WindowsScrollBarUI(...)getMinimumThumbSize(...)configureScrollBarColors(...)getGrid(...)new WindowsArrowButton(...)isVista(...)createArrowButtonListener(...)boolean vPart.SBP_LOWERTRACKVERTPart.SBP_LOWERTRACKHORZpaintTrack(...)paintDecreaseHighlight(...)paintIncreaseHighlight(...)Part thumbPartPart gripperPartInsets gripperInsetsisThumbRollover(...)State.HOVERgripperInsets.bottomgripperInsets.topgripperInsets.rightgripperInsets.leftpaintThumb(...)Rectangle thumbRgetThumbBounds(...)thumbR.ythumbR.xthumbR.heightthumbR.widthboolean oldsetThumbRollover(...)/** WindowsArrowButton is used for the buttons to position the ... */boolean jointRolloverState.UPPRESSEDState.DOWNPRESSEDState.LEFTPRESSEDState.RIGHTPRESSEDState.UPDISABLEDState.DOWNDISABLEDState.LEFTDISABLEDState.RIGHTDISABLEDState.UPHOTState.DOWNHOTState.LEFTHOTState.RIGHTHOTState.UPHOVERState.DOWNHOVERState.LEFTHOVERState.RIGHTHOVERState.UPNORMALState.DOWNNORMALState.LEFTNORMALState.RIGHTNORMAL/** This should be pulled out into its own class if more classes need to ... */new HashMap<String,WeakReference<Grid>>(...)HashMap<String,WeakReference<Grid>> map;WeakReference<Grid> refGrid gridnew Grid(...)new WeakReference<Grid>(...)int[] cmappaintGrid(...)/** Paints the grid into the specified Graphics at the specified ... */Rectangle clipRectclipRect.xclipRect.yclipRect.widthclipRect.heightint xCounterint yCounter/** Actually renders the grid into the Graphics <code>g</code>. */// we need to repaint the entire scrollbar because state change for each// button causes a state change for the thumb and other button on Vista// Pending: Implement rollover (hot) and pressed// Paint thumb// Paint gripper// we need to repaint the entire scrollbar because state change for thumb// causes state change for incr and decr buttons on Vista// normal, rollover, pressed, disabled/** Windows Separator. ... */boolean rollover;boolean pressed;new WindowsSliderUI(...)/** Overrides to return a private track listener subclass which handles ... */new WindowsTrackListener(...)updateRollover(...)updatePressed(...)trackRect.widthtrackRect.ytrackRect.heighttrackRect.xPart.TKP_TICSProp.COLORpaintMinorTickForHorizSlider(...)paintMajorTickForHorizSlider(...)Part.TKP_TICSVERTpaintMinorTickForVertSlider(...)paintMajorTickForVertSlider(...)getXPThumbPart(...)State.FOCUSEDthumbRect.xthumbRect.ySkin sgetThumbSize(...)Boolean paintThumbArrowShapegetPaintTicks(...)Part.TKP_THUMBLEFT// You can't press a disabled slider// You can't have a rollover on a disabled slidernew WindowsSpinnerUI(...)getXPState(...)JButton xpButtonnew GlyphButton(...)getDimension(...)installPreviousButtonListeners(...)createPreviousButton(...)installNextButtonListeners(...)createNextButton(...)int counter/** Divider used for Windows split pane. ... *//** Creates a new Windows SplitPaneDivider *//** Creates a new WindowsSplitPaneUI instance */new WindowsSplitPaneUI(...)new WindowsSplitPaneDivider(...)Set<KeyStroke> managingFocusForwardTraversalKeys;/** Keys to use for forward focus traversal when the JComponent is ... */Set<KeyStroke> managingFocusBackwardTraversalKeys;/** Keys to use for backward focus traversal when the JComponent is ... */boolean contentOpaque;new HashSet<KeyStroke>(...)KeyboardFocusManager.BACKWARD_TRAVERSAL_KEYSnew WindowsTabbedPaneUI(...)int oldRolloverTabgetRolloverTab(...)Rectangle r1Rectangle r2setRolloverTab(...)getTabCount(...)Part.TABP_PANEInsets tabAreaInsetsint tabWidthcalculateTabAreaWidth(...)tabAreaInsets.bottomint tabHeightcalculateTabAreaHeight(...)paintRotatedSkin(...)paintContentBorder(...)paintTabBackground(...)int tabCountint tabRungetRunForTab(...)lastTabInRun(...)State.SELECTEDpaintTabBorder(...)// focus forward traversal key// focus backward traversal key// sets the focus forward and backward traversal keys to null// to restore the defaults// Rollover is only supported on XP// Note: don't call getTabAreaInsets(), because it causes rotation.// Make sure "TabbedPane.tabsOverlapBorder" is set to true in WindowsLookAndFeel// Expand area by tabAreaInsets.bottom to allow tabs to overlap onto the border.// Align with right edgeimport static XPStyle.*import sun.swing.table.*TableCellRenderer originalHeaderRenderer;new WindowsTableHeaderUI(...)setDefaultRenderer(...)new XPDefaultRenderer(...)getHeaderRect(...)boolean isSelected, ...;int column;Insets marginsgetContentMargin(...)int contentTopint contentLeftint contentBottomint contentRightIcon sortIconthis.isSelectedthis.hasFocusthis.columnthis.hasRollovergetRolloverColumn(...)margins.topmargins.leftmargins.bottommargins.rightSortOrder sortOrdergetColumnSortOrder(...)new IconBorder(...)int sortIconHeightTableColumn draggedColumngetDraggedColumn(...)convertColumnIndexToView(...)getColumnModel(...)getModelIndex(...)State.SORTEDNORMALState.SORTEDPRESSEDState.SORTEDHOT/** A border with an Icon at the middle of the top side. ... */int top;int left;int bottom;int right;/** Creates this border; ... */this.topthis.leftthis.bottomthis.right/* idk: ... *//* On Vista sortIcon is painted above the header's text. ... *//* on Vista there are more states for sorted columns *//* do nothing */new WindowsTextAreaUI(...)/** Provides the Windows look and feel for a text field.  This ... */new WindowsTextFieldUI(...)/** Paints a background for the view.  This will only be ... *//** Creates the caret for a field. ... */new WindowsFieldCaret(...)/** WindowsFieldCaret has different scrolling behavior than ... *//** Adjusts the visibility of the caret according to ... */new SafeScroller(...)/** Gets the painter for the Highlighter. ... */Highlighter.HighlightPainterWindowsTextUI.WindowsPainterthis.rJTextField fieldTextUI uiPosition.BiasBias biasPosition.Bias.ForwardRectangle startRectBoundedRangeModel visgetHorizontalVisibility(...)int quarterSpangetExtent(...)BadLocationException bleRectangle endRectdamage(...)Rectangle r;// PENDING: We need to expose the bias in DefaultCaret.// If we scroll, our visual location will have changed,// but we won't have updated our internal location as// the model hasn't changed. This checks for the change,// and if necessary, resets the internal location./** Creates a UI for a JTextPane. ... */new WindowsTextPaneUI(...)import Shapeimport TextUI/** Windows text rendering. ... */new WindowsHighlightPainter(...)LayeredHighlighter.LayerPainter WindowsPainter;LayeredHighlighter.LayerPainter/* public */DefaultHighlighter.DefaultHighlightPainter/** Paints a highlight. ... */// --- HighlightPainter methods ---------------------------------------Rectangle allocRectangle p0Rectangle p1boolean firstIsDotboolean secondIsDotgetSelectionColor(...)getCaretPosition(...)p0.yp1.yint p0ToMarginWidthp0.xalloc.xalloc.widthp0.heightp1.xp1.height/** Paints a portion of a highlight. ... */// --- LayerPainter methods ----------------------------getStartOffset(...)getEndOffset(...)alloc.yalloc.heightShape shapePosition.Bias.Backward// --- determine locations ---// --- render ---// same line, render a rectangle// different lines// can't render// Contained in view, can just use bounds.// Should only render part of View.// Only if exception/** A Windows toggle button. ... */Object WINDOWS_TOGGLE_BUTTON_UI_KEY;WindowsToggleButtonUI windowsToggleButtonUInew WindowsToggleButtonUI(...)Color cachedSelectedColor;Color cachedBackgroundColor;Color cachedHighlightColor;Color c1Color c2int r1int r2int g1int g2int b1int b2/** Draws Windows toolbar separators. ... */new WindowsToolBarSeparatorUI(...)Part.TP_SEPARATORPart.TP_SEPARATORVERTDimension prefpref.widthpref.heightColor tempimport JToggleButtonimport CompoundBorderimport EmptyBorderimport BasicToolBarUInew WindowsToolBarUI(...)setRolloverBorders(...)createRolloverBorder(...)createNonRolloverBorder(...)getRolloverBorder(...)/** A Windows tree. ... */new WindowsTreeUI(...)/** Ensures that the rows identified by beginRow through endRow are ... */getRowCount(...)Rectangle visRectgetVisibleRect(...)Rectangle scrollBoundsgetPathBounds(...)getPathForRow(...)scrollBounds.xvisRect.xscrollBounds.widthvisRect.widthscrollRectToVisible(...)Rectangle beginRectRectangle testRectint beginYbeginRect.yvisRect.heighttestRect.ytestRect.heightnew WindowsTreeCellRenderer(...)/** The minus sign button icon ... */new ExpandedIcon(...)Color backgroundColorState.OPENED/** The plus sign button icon ... */new CollapsedIcon(...)State.CLOSED/** Configures the renderer based on the passed in components. ... */getTreeCellRendererComponent(...)setDisabledIcon(...)getLeafIcon(...)getOpenIcon(...)getClosedIcon(...)// Windows displays the open icon when the tree item selected.import CachedPainter/** Implements Windows XP Styles for the Windows Look and Feel. ... */new SkinPainter(...)// Singleton instance of this classSkinPainter skinPainter;// Singleton instance of SkinPainterBoolean themeActive;HashMap<String,Border> borderMap;HashMap<String,Color> colorMap;boolean flatMenus;/** Static method for clearing the hashmap and loading the ... *//** Get the singleton instance of this class ... */GetPropertyAction propertyActionisThemed(...)new XPStyle(...)isXPStyleEnabled(...)/** Get a named <code>String</code> value from the current style ... */getTypeEnumName(...)int enumValuegetEnum(...)getControlName(...)/** Get a named <code>int</code> value from the current style ... *//** Get a named <code>Dimension</code> value from the current style ... */getPosition(...)/** Get a named <code>Point</code> (e.g. a location or an offset) value ... *//** Get a named <code>Insets</code> value from the current style ... */getThemeMargins(...)/** Get a named <code>Color</code> value from the current style ... */skin.state/** Get a named <code>Border</code> value from the current style ... */skin.stringnew XPFillBorder(...)String bgTypeProp.BORDERSIZEProp.BORDERCOLORnew XPStatefulFillBorder(...)Insets mProp.SIZINGMARGINSProp.BORDERONLYnew XPImageBorder(...)new XPEmptyBorder(...)JComboBox<> cbWindowsComboBoxUI wcbInsets borderInsetsborderInsets.topborderInsets.leftborderInsets.bottomborderInsets.rightm.topm.leftm.bottomm.rightisThemePartDefined(...)/** Get a <code>Skin</code> object from the current style ... *//** A class which encapsulates attributes for a given part ... */Component component;String string;Dimension size;this.componentint boundingWidthint boundingHeightgetThemeBackgroundContentMargins(...)(...).string/** Paint a skin at x, y. ... *//** Paint a skin in an area defined by a rectangle. ... *//** Paint a skin at a defined position and size ... */isGetThemeTransitionDurationDefined(...)/** Paint a skin at a defined position and size. This method ... */boolean accEnabledDataBufferInt dbiskin.component// Private constructorgetSysBoolean(...)Prop.FLATMENUSnew HashMap<String,Color>(...)new HashMap<String,Border>(...)// Special case because XP has no skin for menus// TODO: The classic border uses this color, but we should// create a new UI property called "PopupMenu.borderColor"// instead.// Will cause L&F to use classic border// Ideally we'd have an interface defined for classes which// support margins (to avoid this hackery), but we've// decided against it for simplicity// special casing for comboboxes.// there may be more special cases in the future// note. in the future this should be replaced with a call// to BasicLookAndFeel.getUIOfType()// if this is a toolbar button then ignore getMargin()// and subtract the padding added by the constructor/* idk: it seems margins are the same for all 'big enough' ... */// Note: All further access to the maps must be synchronized// We can use any widget name here, I guess.import static Constants.*/** Adaptive coding. ... */CodingMethod headCoding;int headLength;CodingMethod tailCoding;isCodableLength(...)this.headLengththis.headCodingthis.tailCoding// CodingMethod methods.writeArray(...)// writeArrayTo must be coded iteratively, not recursively:int midrun.headLengthwriteArrayTo(...)run.headCodingrun.tailCodingreadArray(...)readArrayFrom(...)int KX_MIN;int KX_MAX;int KX_LG2BASE;int KX_BASE;int KB_MIN;int KB_MAX;int KB_OFFSET;int KB_DEFAULT;int KXgetKXOf(...)int unitint K1// Is K of the form ((KB:[0..255])+1) * 16^(KX:{0..3])?ByteArrayOutputStream bytesmakeMetaCoding(...)IOException eeCodingMethod headCodingint headLengthCodingMethod tailCodingint Kint ADefint BDefint ABDefint KBgetKBOf(...)int KBFlagdecodeK(...)getMetaCoding(...)int opAdaptiveCoding prevcboolean keepGoingCodingMethod[] ACodenew CodingMethod[]CodingMethod[] BCodeAdaptiveCoding newcnew AdaptiveCoding(...)parseMetaCoding(...)prevc.tailCodingkeyString(...)StringBuilder resAdaptiveCoding run// 1st K value// This is the increment we expect to apply:// cut off stray low-order bits//assert(!isTrivial()); // can happen// See the isCodableLength restriction in CodingChooser.// arbitrary choice// tail call, to avoid deep stack recursion// backup/* public static void main(String av[]) { ... */import Entryimport Index/** Represents an attribute in a class-file. ... */new HashMap<List<Attribute>,List<Attribute>>(...)new HashMap<Layout,Attribute>(...)Map<Layout,Attribute> sddefine(...)String[] mdLayoutsnormalizeLayoutString(...)String[] typeLayoutsString defaultLayoutString annotationsLayoutString paramsLayoutString typesLayoutint ctypeexpandCaseDashNotation(...)Layout def;// Attribute instance fields.// the name and format of this attrObject fixups;// the actual bytes// reference relocations, if any are requiredbytes.lengthgetNameRef(...)this.defold.defthis.bytesold.bytesthis.fixupsold.fixupssetBytes(...)Attribute resnew Attribute(...)isCanonical(...)res.bytesres.fixupsaddContent(...)finishRefs(...)def.canonthat.defMap<List<Attribute>,List<Attribute>> canonLists;Map<Layout,Attribute> attributes;Map<Layout,Attribute> standardDefs;// always zero size.)// of some common cases.  (Note that Code attributes are// are used by trimToSize, in order to reduce footprint// Canonicalized lists of trivial attrs (Deprecated, etc.)List<Attribute> clnew ArrayList<Attribute>(...)unmodifiableList(...)// Find the canonical empty attribute with the given ctype, name, layout.Layout keymakeKey(...)Attribute acanonicalInstance(...)new Layout(...)// and with the standard layout.// Find canonical empty attribute with given ctype and name,/** Base class for any attributed object (Class, Field, Method, Code). ... */new Attribute[]// We need this abstract method to interpret embedded CP refs.List<Attribute> attributes;// defined here for convenienceArrayList<Attribute> alboolean allCanontrimToSize(...)a.fixupsgetCanonList(...)visitRefs(...)List<Attribute> noAttributes;removeAttribute(...)// Also used for testing.// Lightweight interface to hide details of band structure.undef(...)// Note:  decodeBCI goes w/ getInt/Ref; encodeBCI goes w/ putInt/Refbyte EK_INT;// Element kinds:byte EK_BCI;// B H I SH etc.byte EK_BCO;// PH POH etc.byte EK_FLAG;// OH etc.byte EK_REPL;// FH etc.byte EK_REF;// NH[...] etc.byte EK_UN;// RUH, RUNH, KQH, etc.byte EK_CASE;// TB(...)[...] etc.byte EK_CALL;// (...)[...] etc.byte EK_CBLE;// (0), (1), etc.byte EF_SIGN;// [...][...] etc.byte EF_DELTA;// INT is signedbyte EF_NULL;// BCI/BCI value is diff'ed w/ previousbyte EF_BACK;// null REF is expected/allowedint NO_BAND_INDEX;// call, callable, case is backward/** A "class" of attributes, characterized by a context-type, name ... */new Element[]int ctype;// attribute context type, e.g., ATTR_CONTEXT_CODEboolean hasRefs;// name of attributeString layout;// this kind of attr contains CP refs?int bandCount;// layout specification...[] elems;// total number of elemsAttribute canon;// tokenization of layout// canonical instance of this layoutgetUtf8Entry(...)boolean hasCallablesthis.ctypethis.layoutthis.elemstokenizeLayout(...)String[] bodiessplitBodies(...)Element[] lelemsbodies.lengthlelems.lengthElement cenew Element(...)ce.kindremoveBand(...)ce.bandIndexce.layoutce.bodyStringIndexOutOfBoundsException eeLayout defdef.ctypedef.namedef.layoutLayout.classthat.namethat.layoutthat.ctypecontextName(...)stringForDebug(...)byte flags;// spelling in the little languagebyte kind;// EF_SIGN, etc.byte len;// EK_UINT, etc.byte refKind;// scalar length of elementint bandIndex;// CONSTANT_String, etc.// which band does this element govern?...[] body;// extra parameter// extra data (for replications, unions, calls)Element[] lbodythis.bodyflagTest(...)hasBand(...)elems.length...[...].kind...[] noElems;hasCallables(...)Element[] nelems...[...].body/** Return a sequence of tokens from the given attribute bytes. ... */parseUsing(...)getEntryPoint(...)/** Given a sequence of tokens, return the attribute bytes. ... */Object[] fixupsunparseUsing(...)Package.VersionlessThan(...)def.hasRefsunparse(...)/** Remove any informal "pretty printing" from the layout string. ... */StringBuilder bufString resultint end1int end2int digString numinfo(...)Utils.log/** Parse the attribute layout language. ... *//// Subroutines for parsing and unparsing:Layout.ElementList<Element> colnew ArrayList<Element>(...)Element[] resboolean prevBCIint bodyElement ebyte kindList<Element> casesString cstrint targetself.elemstokenizeUInt(...)tokenizeSInt(...)e.flagsskipBody(...)e.bodyint begint cstrlenElement[] cbodyboolean firstCaseNumint cpint endpString cstr1int value0int value1int dashfindCaseDash(...)parseIntBefore(...)parseIntAfter(...)ce.flagsce.valuee.kinde.body.lengthmatchCase(...)self.elems.lengthe.refKindself.hasRefse.layoutList<String> bodiesint depthe.len/** Find an occurrence of hyphen '-' between two numerals. */int lastDashchar afterDash/** For compatibility with 1.5 pack, expand 1-5 into 1,2,3,4,5. */StringBuilder resultint sofar// Also used for ad hoc scanning.// Used when reading a class file (local refs resolved with local cpMap).// Parse attribute bytes, putting values into bands.  Returns new pos.int prevBCIint prevRBCIint bandIndexe.bandIndexint BCIint RBCIint localRefEntry globalRefencodeBCI(...)noteBackCall(...)Entry[] cpMapgetCPMap(...)byte tagString gottagName(...)globalRef.tagcpMap.lengthgetTag(...)String typeNamestringValue(...)getSignatureEntry(...)tagMatches(...)putRef(...)int lastjint loBitsint bitPosint hiBits// (At that point CP refs. are not yet assigned indexes.)// Used when emptying attribute bands into a package model.// Format attribute bytes, drawing values from bands.getRef(...)unparseInt(...)decodeBCI(...)addRefWithLoc(...)int codedValue//define(sd, ATTR_CONTEXT_METHOD, "Code", "HHNI[B]NH[PHPOHPOHRCNH]NH[RUHNI[B]]");//define(sd, ATTR_CONTEXT_CODE, "CharacterRangeTable", "NH[PHPOHIIH]");//define(sd, ATTR_CONTEXT_CODE, "CoverageTable", "NH[PHHII]");// Note:  Code and InnerClasses are special-cased elsewhere.// Their layout specs. are given here for completeness.// The Code spec is incomplete, in that it does not distinguish// bytecode bytes or locate CP references.// The BootstrapMethods attribute is also special-cased// elsewhere as an appendix to the local constant pool.// Metadata.// We define metadata using similar layouts// for all five kinds of metadata attributes and 2 type metadata attributes// Regular annotations are a counted list of [RSHNH[RUH(1)]][...]//   pack.method.attribute.RuntimeVisibleAnnotations=[NH[(1)]][RSHNH[RUH(1)]][TB...]// Parameter annotations are a counted list of regular annotations.//   pack.method.attribute.RuntimeVisibleParameterAnnotations=[NB[(1)]][NH[(1)]][RSHNH[RUH(1)]][TB...]// RuntimeInvisible annotations are defined similarly...// Non-method annotations are defined similarly...// Annotation are a simple tagged value [TB...]//   pack.attribute.method.AnnotationDefault=[TB...]/* RuntimeVisibleTypeAnnotation and RuntimeInvisibleTypeAnnotatation are ... */// Replace private writable attribute list// with only trivial entries by public unique// immutable attribute list with the same entries.// unfreeze it/* ignore by default */// Make the callables now, so they can be linked immediately.// Next fill them in.//System.out.println(Arrays.asList(elems));// simplest way to catch syntax errors...// Some uses do not make a fresh one for each occurrence.// For example, if layout == "", we only need one attr to share.// If -ea, print out more informative strings!// no callables at all// body of first callable// no callables; whole body// return ref-bearing cookie, if any// Disallow layout syntax in the oldest protocol version.// else the name is owned by the layout, and is processed elsewhere// quick exit// References (to a local cpMap) are embedded in the bytes.// Skip whitespace and control chars// Skip to end of line.// Map a character reference to its decimal code.// Map a hex numeral to its decimal code.//private//System.out.println("at "+i+": ..."+layout.substring(i));// strip a prefix/// layout_element: integral// unsigned_int// reparse// signed_int// bc_index// bc_index: 'PO' tokenizeUInt// must follow P or PO:// fail// move forward// bc_offset// flag// replication: 'N' uint '[' elem ... ']'// union: 'T' any_int union_case* '(' ')' '[' body ']'// Keep parsing cases until we hit the default case.// Check for duplication.// missing body, which is legal here// done with the whole union// Parse a case string.// Look for multiple case tags:// will fail parse// Check for a case range (new in 1.6).// Add a case for each value in value0..value1// all cases share one body// "backward case" repeats a body// done with this case// Duplicate tag.// call: '(' '-'? digit+ ')'// Is it a (recursive) backward call?// Yes.  Mark both caller and callee backward.// reference_type: constant_ref// new in 1.7:// schema_ref//utf8_ref//untyped_ref// further parsing of refs// reference: reference_type -><- ( 'N' )? tokenizeUInt// store the new element// Parse several independent layout bodies:  "[foo][bar]...[baz]"// throw error// No empty bodies, please.// skip balanced [...[...]...]// get before bracket// return closing bracket// minimum dash pos// maximum dash pos// matched /[0-9]--?[0-9]/; return position of dash// skip backward over a sign// no dashes (the common case)// how far have we processed the layout?// for each dash, collect everything up to the dash// skip the dash// then collect intermediate values// close off value0 numeral// close off i numeral// collect the rest// for calls to parseInt, holds 2nd result// PH, POH// PH:  transmit R(bci), store bci// POH:  transmit D(R(bci)), store bci// OH// OH:  transmit D(R(bci)), store D(bci)// already transmitted the scalar value// Adjust band offset if it is a backward call.// no additional scalar value to transmit// N.B. global null reference is -1// Cf. ClassReader.readSignatureRef.// Read in big-endian order:// sign-extend subword value// "RBCI" is R(BCI), BCI's coded representation// It's a one-element array, really an lvalue.// placeholder for fixups// fixed null value// It is not stored at all ('V' layout).// Write in big-endian order:/* /// Testing. ... */import BufferedOutputStreamimport FileOutputStreamimport FilterInputStreamimport FilterOutputStreamimport Pack200/** Define the structure and ordering of "bands" in a packed file. ... */currentPropMap(...)Utils.DEBUG_VERBOSEPack200.Packer.EFFORTPack200.PackerUtils.COM_PREFIXnew ArrayList<CPRefBand>(...)new ArrayList<Object[]>(...)new MultiBand(...)newByteBand(...)newIntBand(...)newMultiBand(...)newCPRefBand(...)new MultiBand[]new HashMap<Layout,Band[]>(...)new HashMap<Layout,Integer>(...)new FixedList<List<Layout>>(...)shortCodeLimits.lengthAttribute.LayoutLayout stackMapDeflookup(...)new ArrayList<Layout>(...)nCopies(...)predefineAttribute(...)Package.attrInnerClassesEmptynew Band[]Package.attrCodeEmptyMultiBand xxx_metadata_bandsMultiBand xxx_type_metadata_bandsof(...)getDeltaCoding(...)new Coding[]Map<Coding,Integer> mapnew HashMap<Coding,Integer>(...)basicCodings.lengthCoding cboolean checkXBCoding DB(...)L(...)int XBencodeEscapeValue(...)int MAX_EFFORT;int MIN_EFFORT;int DEFAULT_EFFORT;PropMap p200;// Inherit options from Pack200:int verbose;int effort;boolean optDumpBands;boolean optDebugBands;boolean optVaryCodings;// Various heuristic options.boolean optBigStrings;Package.Version highestClassVersion;// Local copy of highest class version./** Call this exactly once, early, to specify the archive major version. */this.highestClassVersionadjustToClassVersion(...)boolean isReader;Coding BYTE1;Coding CHAR3;Coding BCI5;// This is best used with BCI values:// Note:  Tried sharper (3,16) with no post-zip benefit.Coding BRANCH5;// mostly 1-byte offsetsCoding UNSIGNED5;// mostly forward branchesCoding UDELTA5;Coding SIGNED5;// It zips 1.1% better than "flat" (5,192)// "sharp" (5,64) zips 0.4% better than "medium" (5,128)Coding DELTA5;//sharpCoding MDELTA5;// Note:  Tried (5,128,2) and (5,192,2) with no benefit....[] basicCodings;Map<Coding,Integer> basicCodingIndexes;...[] bandHeaderBytes;int bandHeaderBytePos;// used for input onlyint bandHeaderBytePos0;// BHB read pointer, for input only// for debugCodingMethod[] resint pos2int SHORT_BAND_HEURISTIC;int NO_PHASE;int COLLECT_PHASE;// package writing phases:int FROZEN_PHASE;// collect data before writeint WRITE_PHASE;// no longer collectingint EXPECT_PHASE;// package reading phases:// ready to write bytesint READ_PHASE;// gather expected countsint DISBURSE_PHASE;// ready to read bytesint DONE_PHASE;// pass out data after read// done writing or reading/** The packed file is divided up into a number of segments. ... */int phase;int valuesExpected;long outputSize;Coding regularCoding;// cacheint seqForDebug;int elementCountForDebug;this.regularCodingthis.seqForDebugfine(...)readyToExpect(...)readyToCollect(...)// common operations/** Return -1 if data buffer not allocated, else max length. *//** Allocate data buffer to specified length. *//** Return current number of values in buffer, which must exist. *//** Write out bytes, encoding the values. */assertReadyToWriteTo(...)setPhase(...)writeDataTo(...)doneWriting(...)computeOutputSize(...)/** Expect a certain number of values. */assertPhase(...)/** Expect more values.  (Multiple calls accumulate.) *//// Phase change markers.setCapacity(...)/** Read in bytes, decoding the values. */assertReadyToReadFrom(...)valuesExpected(...)readDataFrom(...)readyToDisburse(...)assertPhaseChangeOK(...)this.phaseint lengthForDebug;// DEBUG ONLY// must be null in EXPECT phaseint valuesDisbursed;CodingMethod bandCoding;...[] metaCoding;/** Declare predicted or needed capacity. */realloc(...)assertCanChangeLength(...)this.values/** Collect one value, or store one decoded value. */canVaryCoding(...)boolean canVaryshouldVaryCoding(...)canRepresent(...)chooseCoding(...)CodingChooser.BYTE_SIZEdecodeEscapeValue(...)metaCoding.lengthcomputeByteSize(...)getCodingChooser(...)computeEscapeSize(...)int XsetD(...)long len0getCount(...)writeTo(...)dumpBand(...)readFrom(...)markSupported(...)Coding.B_MAXint p0int p1getBandHeader(...)doneDisbursing(...)PrintStream psnew PrintStream(...)getDumpStream(...)String irroutputSize(...)printArrayTo(...)OutputStream ds/** Disburse one value. */phase(...)/** Reset for another pass over the same value set. */ByteArrayOutputStream bytes;ByteArrayOutputStream bytesForDump;// input bufferInputStream in;destroy(...)int vexint nr// alternative to readFrom:this.inint chgetInputStream(...)collectorStream(...)// The usual coding for bands is 7bit/5byte/delta.addValue(...)/** Return the sum of all values in this band. */valuesRemainingForDebug(...)resetForSecondPass(...)/** Return the occurrence count of a specific value in this band. */Index index;boolean nullOK;this.nullOKsetBandIndex(...)assertValidCPRefs(...)/** Write a constant pool reference. */encodeRefOrNull(...)getCPIndex(...)warning(...)decodeRefOrNull(...)int nonNullCodeencodeRef(...)decodeRef(...)List<CPRefBand> allKQBands;// intended CP indexes, before the CP has been created.// Bootstrap support for CPRefBands.  These are needed to recordList<Object[]> needPredefIndex;int codingEntry egetEntry(...)CodingChooser codingChooser;new CodingChooser(...)codingChooser.stressList<Class> classes(...).pkg.classes(...).pkgPackage.ClassClass clsaddStressSeed(...)CodingChooser cccc.verbosechoose(...)...[] defaultMetaCoding;...[] noMetaCoding;// See section "Coding Specifier Meta-Encoding" in the JSR 200 spec.// Result is in [0..255] if XB was successfully extracted, else -1.// and yet so that a band header is likely to occupy only a byte or two.// to be confused with the initial value of a headerless band,// This representation is designed so that a band header is unlikely// and XB is X-(D.L).// the escape values are in that range,// If D.S == 0 and D includes the range [(D.L)..(D.L)+255],// and the first byte XB is -1-X.// If D.S != 0 and D includes the range [-256..-1],// first (and perhaps only) byte of a meta-coding.// If this first value X is an escape value, it actually represents the// The first value in a band is always coded with the default coding D.S(...)int L// Inverse to decodeEscapeValue()....[] bands;notePrevForAssert(...)bands.lengthByteBand bnew ByteBand(...)IntBand bnew IntBand(...)MultiBand bCPRefBand bnew CPRefBand(...)int cap;this.capBand bchooseBandCodings(...)long sumlong bsizelong preCountlong postCountlong lenbandCount(...)/** An output stream which counts the number of bytes written. */long count;// (should go public under the name CountingOutputStream?)ByteCounter outputCounter;new ByteCounter(...)long nbytesint archiveOptions;// random AO_XXX bits, decoded from the archive headerlong archiveSize0;// archiveSize1 sizes most of the archive [archive_options..file_bits).long archiveSize1;// size through archive_size_loint archiveNextCount;// size reported in archive_headerint AH_LENGTH_0;// reported in archive_headerint AH_LENGTH_MIN;// archive_header_0 = {minver, majver, options}int AH_LENGTH_S;// Length contributions from optional archive size fields:// observed in spec {header_0[3], cp_counts[8], class_counts[4]}int AH_ARCHIVE_SIZE_HI;// archive_header_S = optional {size_hi, size_lo}int AH_ARCHIVE_SIZE_LO;// offset in archive_header_Sint AH_FILE_HEADER_LEN;// Length contributions from optional header fields:int AH_SPECIAL_FORMAT_LEN;// file_counts = {{size_hi, size_lo}, next, modtime, files}int AH_CP_NUMBER_LEN;// special_counts = {layouts, band_headers}int AH_CP_EXTRA_LEN;// cp_number_counts = {int, float, long, double}int AB_FLAGS_HI;// Common structure of attribute band groups:// cp_attr_counts = {MH, MT, InDy, BSM}int AB_FLAGS_LO;int AB_ATTR_COUNT;int AB_ATTR_INDEXES;int AB_ATTR_CALLS;boolean NULL_IS_OK;MultiBand all_bands;ByteBand archive_magic;// file header (various random bytes)IntBand archive_header_0;IntBand archive_header_S;IntBand archive_header_1;ByteBand band_headers;MultiBand cp_bands;// constant pool contentsIntBand cp_Utf8_prefix;IntBand cp_Utf8_suffix;IntBand cp_Utf8_chars;IntBand cp_Utf8_big_suffix;MultiBand cp_Utf8_big_chars;IntBand cp_Int;IntBand cp_Float;IntBand cp_Long_hi;IntBand cp_Long_lo;IntBand cp_Double_hi;IntBand cp_Double_lo;CPRefBand cp_String;CPRefBand cp_Class;CPRefBand cp_Signature_form;CPRefBand cp_Signature_classes;CPRefBand cp_Descr_name;CPRefBand cp_Descr_type;CPRefBand cp_Field_class;CPRefBand cp_Field_desc;CPRefBand cp_Method_class;CPRefBand cp_Method_desc;CPRefBand cp_Imethod_class;CPRefBand cp_Imethod_desc;IntBand cp_MethodHandle_refkind;CPRefBand cp_MethodHandle_member;CPRefBand cp_MethodType;CPRefBand cp_BootstrapMethod_ref;IntBand cp_BootstrapMethod_arg_count;CPRefBand cp_BootstrapMethod_arg;CPRefBand cp_InvokeDynamic_spec;CPRefBand cp_InvokeDynamic_desc;MultiBand attr_definition_bands;// bands for carrying attribute definitions:ByteBand attr_definition_headers;CPRefBand attr_definition_name;CPRefBand attr_definition_layout;MultiBand ic_bands;// bands for hardwired InnerClasses attribute (shared across the package)CPRefBand ic_this_class;IntBand ic_flags;CPRefBand ic_outer_class;// These bands contain data only where flags sets ACC_IC_LONG_FORM:CPRefBand ic_name;MultiBand class_bands;// bands for carrying class schema information:CPRefBand class_this;CPRefBand class_super;IntBand class_interface_count;CPRefBand class_interface;IntBand class_field_count;// bands for class membersIntBand class_method_count;CPRefBand field_descr;MultiBand field_attr_bands;IntBand field_flags_hi;IntBand field_flags_lo;IntBand field_attr_count;IntBand field_attr_indexes;IntBand field_attr_calls;CPRefBand field_ConstantValue_KQ;// bands for predefined field attributesCPRefBand field_Signature_RS;MultiBand field_metadata_bands;MultiBand field_type_metadata_bands;CPRefBand method_descr;MultiBand method_attr_bands;IntBand method_flags_hi;IntBand method_flags_lo;IntBand method_attr_count;IntBand method_attr_indexes;IntBand method_attr_calls;IntBand method_Exceptions_N;// band for predefined method attributesCPRefBand method_Exceptions_RC;CPRefBand method_Signature_RS;MultiBand method_metadata_bands;IntBand method_MethodParameters_NB;// band for predefine method parametersCPRefBand method_MethodParameters_name_RUN;IntBand method_MethodParameters_flag_FH;MultiBand method_type_metadata_bands;MultiBand class_attr_bands;IntBand class_flags_hi;IntBand class_flags_lo;IntBand class_attr_count;IntBand class_attr_indexes;IntBand class_attr_calls;CPRefBand class_SourceFile_RUN;// band for predefined SourceFile and other class attributesCPRefBand class_EnclosingMethod_RC;CPRefBand class_EnclosingMethod_RDN;CPRefBand class_Signature_RS;MultiBand class_metadata_bands;IntBand class_InnerClasses_N;CPRefBand class_InnerClasses_RC;IntBand class_InnerClasses_F;CPRefBand class_InnerClasses_outer_RCN;CPRefBand class_InnerClasses_name_RUN;IntBand class_ClassFile_version_minor_H;IntBand class_ClassFile_version_major_H;MultiBand class_type_metadata_bands;MultiBand code_bands;ByteBand code_headers;IntBand code_max_stack;//BYTE1IntBand code_max_na_locals;IntBand code_handler_count;IntBand code_handler_start_P;IntBand code_handler_end_PO;IntBand code_handler_catch_PO;CPRefBand code_handler_class_RCN;MultiBand code_attr_bands;IntBand code_flags_hi;IntBand code_flags_lo;IntBand code_attr_count;IntBand code_attr_indexes;IntBand code_attr_calls;MultiBand stackmap_bands;IntBand code_StackMapTable_N;IntBand code_StackMapTable_frame_T;IntBand code_StackMapTable_local_N;IntBand code_StackMapTable_stack_N;IntBand code_StackMapTable_offset;IntBand code_StackMapTable_T;CPRefBand code_StackMapTable_RC;IntBand code_StackMapTable_P;IntBand code_LineNumberTable_N;// bands for predefined LineNumberTable attributeIntBand code_LineNumberTable_bci_P;IntBand code_LineNumberTable_line;IntBand code_LocalVariableTable_N;// bands for predefined LocalVariable{Type}Table attributesIntBand code_LocalVariableTable_bci_P;IntBand code_LocalVariableTable_span_O;CPRefBand code_LocalVariableTable_name_RU;CPRefBand code_LocalVariableTable_type_RS;IntBand code_LocalVariableTable_slot;IntBand code_LocalVariableTypeTable_N;IntBand code_LocalVariableTypeTable_bci_P;IntBand code_LocalVariableTypeTable_span_O;CPRefBand code_LocalVariableTypeTable_name_RU;CPRefBand code_LocalVariableTypeTable_type_RS;IntBand code_LocalVariableTypeTable_slot;MultiBand code_type_metadata_bands;MultiBand bc_bands;// bands for bytecodesByteBand bc_codes;IntBand bc_case_count;// remaining bands provide typed opcode fields required by the bc_codesIntBand bc_case_value;// *switchByteBand bc_byte;IntBand bc_short;//BYTE1   // bipush, iinc, *newarrayIntBand bc_local;// sipush, wide iincIntBand bc_label;// *load, *store, iinc, retCPRefBand bc_intref;// ldc* operands:// The notable exceptions are class and method references.// Most CP refs exhibit some correlation, and benefit from delta coding.// if*, goto*, jsr*, *switchCPRefBand bc_floatref;CPRefBand bc_longref;CPRefBand bc_doubleref;CPRefBand bc_stringref;CPRefBand bc_loadablevalueref;CPRefBand bc_classref;// nulls produced by bc_classref are taken to mean the current classCPRefBand bc_fieldref;// new, *anew*, c*cast, i*of, ldcCPRefBand bc_methodref;// get*, put*CPRefBand bc_imethodref;// invoke[vs]*CPRefBand bc_indyref;// invokeinterfaceCPRefBand bc_thisfield;// _self_linker_op family// invokedynamicCPRefBand bc_superfield;// any field within cur. classCPRefBand bc_thismethod;// any field within superclassCPRefBand bc_supermethod;// any method within cur. classIntBand bc_initref;// bc_invokeinit family:// any method within superclassCPRefBand bc_escref;// escapesIntBand bc_escrefsize;IntBand bc_escsize;ByteBand bc_escbyte;MultiBand file_bands;// bands for carrying resource files and file attributes:CPRefBand file_name;IntBand file_size_hi;IntBand file_size_lo;IntBand file_modtime;IntBand file_options;ByteBand file_bits;/** Given CP indexes, distribute tag-specific indexes to bands. */// End of band definitions!Object[] needByte whichsetIndex(...)byteValue(...)printCDecl(...)Index ixgetLiteralTag(...)CPRefBand xxx_KQ...[] metadataBands;// Table of bands which contain metadata....[] typeMetadataBands;// Table of bands which contains type_metadata (TypeAnnotations)int ADH_CONTEXT_MASK;// Attribute layouts.int ADH_BIT_SHIFT;// (ad_hdr & ADH_CONTEXT_MASK)int ADH_BIT_IS_LSB;// (ad_hdr >> ADH_BIT_SHIFT)int ATTR_INDEX_OVERFLOW;...[] attrIndexLimit;...[] attrFlagMask;// Which flag bits are taken over by attributes?// Each index limit is either 32 or 63, depending on AO_HAVE_XXX_FLAGS_HI....[] attrDefSeen;// Which flag bits have been taken over explicitly?...[] attrOverflowMask;// What pseudo-attribute bits are there to watch for?int attrClassFileVersionMask;Map<Layout,Band[]> attrBandTable;// Mapping from Attribute.Layout to Band[] (layout element bands).Attribute.Layout attrCodeEmpty;// Well-known attributes:Attribute.Layout attrInnerClassesEmpty;Attribute.Layout attrClassFileVersion;Attribute.Layout attrConstantValue;Map<Layout,Integer> attrIndexTable;// Mapping from Attribute.Layout to Integer (inverse of attrDefs)List<List<Layout>> attrDefs;// Mapping from attribute index (<32 are flag bits) to attributes.getHighestClassVersion(...)undefineAttribute(...)List<Layout> defListint addMorehaveFlagsHi(...)testBit(...)List<Layout> resint aiisPredefinedAttr(...)asBytes(...)bytes(...)Attribute.Layout.ElementassertBandOKForElem(...)Coding rcboolean wantIntBandAttribute.NO_BAND_INDEXAttribute.EK_INTAttribute.EF_SIGNAttribute.EK_BCIAttribute.EF_DELTAAttribute.EK_BCOAttribute.EK_FLAGAttribute.EK_REPLassertBandOKForElems(...)Attribute.EK_UNAttribute.EK_CASEAttribute.EK_CALLAttribute.EK_CBLEAttribute.EK_REF(...).nullOKAttribute.EF_NULLb.regularCodingsetAttributeLayoutIndex(...)def.bandCountab.lengthdef.elems// This version takes bandPrefix/addHere instead of prebuilt Band[] ab.ctype(...)makeNewAttributeBands(...)Band[] abdoneWithUnusedBand(...)...[] attrBands;// Bands which contain non-predefined attrs.// Create bands for all non-predefined attrs.adjustSpecialAttrMasks(...)String cnameMultiBand xxx_attr_bandslong defSeenint baseString pfxBand[] newABBand[] prevABnewAB.lengthprevAB.length// Recursive helper, operates on a "body" or other sequence of elems:Band nbint tembyte refKindboolean nullOKnewElemBand(...)Attribute.EF_BACK...[] shortCodeLimits;// encodings found in the code_headers bandint shortCodeHeader_h_limit;// return 0 if it won't encode, else a number in [1..255]code.max_stackint l0code.max_localscode.handler_class.lengthcode.handler_classint siglengetArgumentSize(...)int l1int limsint limlint scshortCodeHeader_h_base(...)shortCodeHeader_max_stack(...)shortCodeHeader_max_na_locals(...)shortCodeHeader_handler_count(...)int LONG_CODE_HEADER;int h0// utilities for accessing the bc_label band:getCPRefOpTag(...)boolean isSuperboolean isAloadint origBCboolean isFieldisFieldOp(...)isSelfLinkerOp(...)int nextSeqForDebug;File dumpDir;b.nameb.seqForDebugint seqConstantPool.TAG_ORDER...[...].tagix.cpMapix.debugNameFile dumpFilecreateTempFile(...)new BufferedOutputStream(...)new FileOutputStream(...)// DEBUG ONLY:  Validate me at each length change.b.phase// DEBUG ONLY:  Validate a phase.// DEBUG ONLY:  Tells whether verbosity is turned on.// DEBUG ONLY:  Validate me at each phase change.isReader(...)assertDoneDisbursing(...)verbose(...)MultiBand mbmb.bandCountBand submb.bandssub.phaseString ixSCoding[] knowncString[] knownsint rci(...).indexMap<Band,Band> prevForAssertMap;// DEBUG ONLY:  Record something about the band order.new HashMap<Band,Band>(...)// DEBUG ONLY:  Validate next input band, ensure bands are read in sequenceBand pphaseCmp(...)String inNameremoveFirst(...)// DEBUG ONLY:  Make sure a bunch of cprefs are correct.b.indexvalueAtForDebug(...)LinkedList<String> bandSequenceList;/* DEBUG ONLY:  write the bands to a list and read back the list in order, ... */new LinkedList<String>(...)e.tagsetLength(...)// Utilities for reallocating:Class<?> eltObject[] naa.lengthint[] nabyte[] na// Table of "Canonical BHSD Codings" from Pack200 spec.// _meta_default// Fixed-length codings:// Full-range variable-length codings:// Variable length subrange codings:// push back XB onto the band header bytes// scan forward through XB and any additional band header bytes// caller must call init// Cannot due this from the constructor, because constructor// may wish to initialize some subclass variables.// Set initial phase for reading or writing:// subclasses continue by writing their contents to output// all at once// called implicitly by constructor// subclasses continue by reading their contents from input:// Fast forward:// Only one use for this.// must have already output a dummy// decache// Can't read band_headers w/o the archive header:// BYTE1 bands can't vary codings, but the others can.// All that's needed for the initial escape is at least// 256 negative values or more than 256 non-negative values// CodingChooser failed to size it.// Compute and save the meta-coding bytes also.// Need an explicit default.// Common case:  Zero bytes of meta coding.// Compute outputSize of the escape value X, if any.// First byte XB of meta-coding is treated specially,// but any other bytes go into the band headers band.// This must be done before any other output happens.// good cache// Other bytes go into band_headers.// nothing to write// We need an explicit band header, either because// there is a non-default coding method, or because// the first value would be parsed as an escape value.//System.out.println("X="+X+" XB="+XB+" in "+this);// nothing to read// input must be buffered// Do not consume this value.  No alternate coding.// This is really used only by dumpBands.// for GC// when debugging return a zero if lengths are zero// 1st pass is complete// do this just once// No-op.// do not cache// done with the bits!// GC// Tap the stream.// assert that this is the whole pass; no other reads allowed// NNC is the coding which assumes nulls are rare// negative values are rare// If nulls are expected, increment, to make -1 code turn to 0.// Inverse to encodeRefOrNull...// Twist the random state based on my first file.// This sends each segment off in a different direction.// degenerate regular coding (BYTE1)// negative value for failure// The following exercises decodeEscapeValue also:// This is all just to keep the asserts happy:// coding decision pass// not called?// Wrap a byte-counter around the output stream.// Handle prior calls to setBandIndex:// no more predefs// I.e., attribute layouts KQ (no null) or KQN (null ok).// Not in predefinition mode; getCPIndex now works.// Typically, allKQBands is the singleton of field_ConstantValue_KQ.// just for the sake of predefs.// Add predefined attribute definitions://predefineAttribute(X_ATTR_Synthetic, ATTR_CONTEXT_CLASS, null,//                 "Synthetic", "");//predefineAttribute(X_ATTR_Synthetic, ATTR_CONTEXT_FIELD, null,//predefineAttribute(X_ATTR_Synthetic, ATTR_CONTEXT_METHOD, null,// These arguments cause the bands to be built// automatically for this complicated layout:// All contexts have these// Clear the record of having seen these definitions,// so they may be redefined without error.// Set up the special masks:// will make a final decision later// Revoke definition of pre-1.6 attribute type.// decide on it now!// all predef indexes are <32// Remove nulls and non-predefs.// unused flag bit// Overflow attrs are never predefined.// If the bit is set, it was explicitly def'd.// Clear special masks if new definitions have been seen for them.// It is possible to clear the overflow mask (bit 16).// no direct band// Use Attribute.find to get uniquification of layouts.//def.predef = true;// no redef// Let's make sure the band types match://Attribute.Layout def = Attribute.find(ctype, name, layout).layout();// Clear the def bit.  (For predefs, it's already clear.)// Retract special flag bit bindings, if they were taken over.// Note: attrDefSeen is always a subset of attrFlagMask.// empty attr// There are already predefined bands here.// debug only// We won't be using these predefined bands.//System.out.println(prevForAssertMap);// Note:  No case for BYTE1 here.// If it's not a duplicate body, make the bands.// no new band to make// Not ByteBand, please.// Overflow attribute.// Detect redefinitions:// Adding a new fixed attribute.// Remove index binding of any previous fixed attr.// s<12, l<12, e=0 [1..144]//  s<8,  l<8, e=1 [145..208]//  s<7,  l<7, e=2 [209..256]// enough locals for signature!// do not count locals required by the signature/// Writing phases:// Ready to collect data from the input classes.// Data is all collected.  Ready to write bytes to disk.// Done writing to disk.  Ready to reset, in principle./// Reading phases:// Ready to read values from disk.// Ready to disburse values.// Done disbursing values.  Ready to reset, in principle.// fail now// Any previous band must be done reading before this one starts.// die unless verbose is true// Verify synchronization between reader & writer:// System.out.println("Reading: " + name);// Any previous band must be done writing before this one starts.// System.out.println("Writing: " + b);import ClassEntryimport DescriptorEntryimport SignatureEntryimport MemberEntryimport MethodHandleEntryimport BootstrapMethodEntryimport Utf8Entryimport Classimport InnerClass/** Reader for a class file that is being incorporated into a package. ... */Package pkg;Class cls;long inPos;long constantPoolLimit;DataInputStream in;Map<Layout,Attribute> attrDefs;Map<Layout,String> attrCommands;String unknownAttrCommand;this.pkgthis.clsthis.verbosepkg.verboselong nsskip(...)this.attrDefsthis.attrCommandslong skippedlong j/** Read a 2-byte int, and return the <em>global</em> CP entry for it. */cls.cpMapreadRef(...)checkTag(...)/** Throw a ClassFormatException if the entry does not match the expected tag type. */String wherenew ClassFormatException(...)cls.file.nameStringcls.filereadRefOrNull(...)boolean okreadMagicNumbers(...)readConstantPool(...)readMembers(...)readAttributes(...)fixUnresolvedEntries(...)finishReading(...)int minverint majverString badcheckVersion(...)cls.versioncls.magicnew FormatException(...)Attribute.FormatExceptionver.majorver.minorpkg.minClassVersion.majorpkg.minClassVersionpkg.minClassVersion.minorpkg.maxClassVersion.majorpkg.maxClassVersionpkg.maxClassVersion.minorint[] fixupsint fptrnew Entry[]getLiteralEntry(...)readFloat(...)readDouble(...)int flimitint fiint cpiint refint ref2ClassEntry mclassDescriptorEntry mdescrUtf8Entry mnameUtf8Entry mtypeMemberEntry memRefDescriptorEntry idescrgetClassEntry(...)getStringEntry(...)getMemberEntry(...)getDescriptorEntry(...)getMethodTypeEntry(...)getMethodHandleEntry(...)new UnresolvedEntry(...)...[] refsOrIndexes;this.refsOrIndexesClassReader.this.haveUnresolvedEntryClassReader.thisClassReader.this.clsEntry resBootstrapMethodEntry ibootscls.bootstrapMethodsgetInvokeDynamicEntry(...)unresolved(...)boolean haveUnresolvedEntry;int nicls.flagscls.thisClasscls.superClassreadClassRefOrNull(...)cls.interfacesnew ClassEntry[]int nmreadMember(...)int mflagsreadUtf8Ref(...)SignatureEntry mtypereadSignatureRef(...)DescriptorEntry descrClass.MemberMember mnew Field(...)new Method(...)Attribute.Holderint naPackage.attrDefsboolean isStackMaplong pos0Layout lkeykeyForLookup(...)String cmdString message1String message2Code codeint TOO_BIGString messageClass.Methodm.codenew Code(...)readCode(...)FormatException iieInstruction.FormatExceptionClassReader.ClassFormatExceptionPackage.attrBootstrapMethodsEmptyreadBootstrapMethods(...)readInnerClasses(...)byte[] bytesint nhcode.bytesopcodeChecker(...)this.cls.versionsetHandlerCount(...)code.handler_startcode.handler_endcode.handler_catchBootstrapMethodEntry[] bsmsnew BootstrapMethodEntry[]bsms.lengthMethodHandleEntry bsmRefEntry[] argRefsargRefs.lengthgetBootstrapMethodEntry(...)setBootstrapMethods(...)ArrayList<InnerClass> icsnew ArrayList<InnerClass>(...)InnerClass icnew InnerClass(...)cls.innerClasses// The class file stores a Utf8, but we want a Signature.// fields// methods//System.out.println("ClassFile.version="+cls.majver+"."+cls.minver);// OK//System.err.println("reading CP, length="+length);//System.err.println("reading CP elt, i="+i);// just read the refs; do not attempt to resolve while reading// empty ref2// not a ref// Fix up refs, which might be out of order.// Defer.// Note that ref must be resolved later, using the BootstrapMethods attribute.// Must make progress./* non-static */// nothing to do here// See if there is a special command that applies.// Find canonical instance of the requested attribute.// Any zero-length attr is "known"...// We can assume an empty attr. has an empty layout.// Handles markers like Enum, Bridge, Synthetic, Deprecated.// Known attribute but with a corner case format, "pass" it.// No, we don't really know what to do this this one.// Do not compress the rare and strange "u4" and "X" cases.// Known attribute but w/o a format; pass it.// Skip the unknown attribute.// in case we want to check it// These are hardwired.// Keep empty attribute a...// Delete the attribute; it is logically part of the constant pool.// These are hardwired also.// set directly; do not use setInnerClasses.// (Later, ics may be transferred to the pkg.)import NumberEntryimport DataOutputStream/** Writer for a class file that is incorporated into a package. ... */DataOutputStream out;Index cpIndex;Index bsmIndex;this.outthis.cpIndexmakeIndex(...)this.cpIndex.flattenSigshasBootstrapMethods(...)this.bsmIndexgetBootstrapMethodMap(...)cpIndex.debugNamedumpString(...)/** Write a 2-byte int representing a CP entry, using the local cpIndex. */writeRef(...)/** Write a 2-byte int representing a CP entry, using the given cpIndex. */writeMagicNumbers(...)writeConstantPool(...)writeMembers(...)writeAttributes(...)cls.version.minorcls.version.majorisDoubleWord(...)float fvalnumberValue(...)double dvaldoubleValue(...)MethodHandleEntry mhemhe.refKindcls.interfaces.lengthList<? extends Member> memsgetFields(...)writeMember(...)m.flagsgetDescriptor(...).nameRefgetDescriptor(...)getDescriptor(...).typeRefAttribute bsmAttrAttribute icsAttrint bsmidxh.attributesint icsidxByteArrayOutputStream buf;// handy buffer for collecting attrsDataOutputStream bufOut;reorderBSMandICS(...)DataOutputStream savedOutwriteCode(...)writeBootstrapMethods(...)writeInnerClasses(...)getHandlerCount(...)code.bytes.lengthList<BootstrapMethodEntry> bsmsgetBootstrapMethods(...)BootstrapMethodEntry ee.bsmRefe.argRefs.lengthe.argRefsEntry argRefList<InnerClass> icsgetInnerClasses(...)ic.thisClassic.outerClassic.nameic.flags/* Copyright (c) 2001, 2012, Oracle and/or its affiliates. All rights reserved. ... *//* Closing here will cause all the underlying ... */// attribute size// there may be cases if an InnerClass attribute is explicit, then the// ordering could be wrong, fix the ordering before we write it out./** Represents a chunk of bytecodes. ... */ConstantPool.noRefsClass.Method m;this.mthisClass(...)ConstantPool.Entry...[] noRefs;int max_stack;// The following fields are used directly by the ClassReader, etc.int max_locals;...[] handler_class;...[] handler_start;...[] handler_end;...[] handler_catch;Fixups fixups;Object insnMap;// array of instruction boundariesint argsizehandler_class.lengthhandler_start.lengthhandler_end.lengthhandler_catch.lengththis.insnMapallocateInstructionMap(...)setInstructionMap(...)insnMap.lengthexpandInstructionMap(...)getInsnMap(...)Fixups.Fixupnew Fixups(...)int verbosegetPackage(...).verboseInstruction iinstructionAt(...)int cprefboolean shrinkMaps;// Using both bytes and shorts gives 66% savings over just ints.)// (By using bytes, we get 33% savings over just shorts and ints.// instruction boundary arrays are about a 75% overhead--tolerable.// Given an average of 1.8 bytes per instruction, this means// due to bytes, and half to shorts.  (Ints are insignificant.)// In the current scheme, half of the bulk of these arrays// to reduce the per-bytecode memory footprint.// package size, it's worth a little bit of trouble// Since bytecodes are the single largest contributor toint PClimitByte.MAX_VALUEByte.MIN_VALUEShort.MIN_VALUEshort[] mapint[] mapint[] imapmap.lengthimap.lengthcopyOfRange(...)int fillpgetPC(...)/** Encode the given BCI as an instruction boundary number. ... */Object map0int keyConstantPool.Indexat(...)Modifier.NATIVEModifier.ABSTRACT/// Fetching values from my own array.setInt(...)setShort(...)setByte(...)// caller must fill these in ASAP//int[] oldMap = null;//assert((oldMap = getInstructionMap()) != null);//assert(Arrays.equals(oldMap, getInstructionMap()));// Handle attribute list:// Build a map of instruction boundaries.// Make it byte[], short[], or int[] according to the max BCI.//assert(assertBCICodingsOK());// len == map.length// If bciCode < len, result is map[bciCode], the common and fast case.// Otherwise, let map[i] be the smallest map[*] larger than bci.// Then, required by the return statement of encodeBCI://   bciCode == len + bci - i// Thus://   bci-i == bciCode-len//   map[i]-adj-i == bciCode-len ; adj in (0..map[i]-map[i-1])// We can solve this by searching for adjacent entries// map[i-1], map[i] such that://   map[i-1]-(i-1) <= bciCode-len < map[i]-i// This can be approximated by searching map[i] for bciCode and then// linear searching backward.  Given the right i, we then have://   bci == bciCode-len + i// This linear search is at its worst case for indexes in the beginning// of a large method, but it's not clear that this is a problem in// practice, since BCIs are usually on instruction boundaries.// Code attributes are finished in ClassWriter.writeAttributes.// A method's flags force it to have a Code attribute,// if the flags are neither native nor abstract./* TEST CODE ONLY ... *//** Define the conversions between sequences of small integers and raw bytes. ... */Histogram.BitMetricbyteBitWidths.lengthceil_lg2(...)bitWidth(...)// Code-specific limits:/* Coding schema for single integers, parameterized by (B,H,S): ... */Integer.MIN_VALUEcodeRangeLong(...)long H_i/** Largest int representable by (B,H,S) in up to nMax bytes. */long rangelong maxPosint smaxdecodeSign32(...)saturate32(...)isNegativeCode(...)/** Smallest int representable by (B,H,S) in up to nMax bytes. ... */long maxNeg// the conversion to an unsigned int is the following little method:// The conversion to a signed int is just the Java cast (int), but// These must be represented in Java as longs in the range [0..2^32-1].// Some of the arithmetic below is on unsigned 32-bit integers.// Sign encoding:int Smaskint sxtoUnsigned32(...)long uxhasNegativeCode(...)// Top-level coding of single integers:encodeSign32(...)int b_i// The Stream version doesn't fetch a byte unless it is needed for coding.int B_MAX;int H_MAX;/* B: [1,5] */int S_MAX;/* H: [1,256] */int B;// END OF STATICS./* S: [0,2] */int H;// # bytes (1..5)/* 1..5 */int L;// # codes requiring a higher byte/* 1..256 */int S;/* 0..255 */int del;// # low-order bits representing sign/* 0..3 */int min;// type of delta encoding (0 == none)/* 0..2 */int max;// smallest representable valueint umin;// largest representable valueint umax;// smallest representable uns. value...[] byteMin;// largest representable uns. value...[] byteMax;// smallest repr. value, given # bytes// largest repr. value, given # bytesthis.Bthis.Hthis.Lthis.Sthis.delthis.mincodeMin(...)this.maxcodeMax(...)this.uminthis.umaxthis.byteMinthis.byteMaxint nMaxCoding thatthat.Bthat.Hthat.Sthat.delMap<Coding,Coding> codeMap;Coding x0new Coding(...)Coding x1new HashMap<Coding,Coding>(...)isSubrange(...)canRepresentUnsigned(...)canRepresentSigned(...)/** Can this coding represent a single value, possibly a delta? ... *//** Can this coding, apart from its S property, ... */// object-oriented code/decode// Stream versionsreadIntFrom(...)int[] pos// Stream/array versionsint dsteplong statereduceToUnsignedRange(...)int bufmaxint[] deltasmakeDeltas(...)deltas.length/** Tell if the range of this coding (number of distinct ... *//** Tell if this coding can represent all 32-bit values. ... *//** Return the number of values this coding (a subrange) can represent. */setH(...)/** Return a coding suitable for representing summed, modulo-reduced values. */isDelta(...)/** Reduce the given value to be within this coding's unsigned range, ... */int rangegetRange(...)reduceToSignedRange(...)/** Does this coding support at least one negative value? ... *//** Does this coding code arrays by making successive differences? */int dkey/** Heuristic measure of the difference between two codings. */int diffdelint diffSint diffBint diffHLint normint thisHLgetHL(...)int thatHL/** ceiling(log[2](x)): {1->0, 2->1, 3->2, 4->2, ...} */int lg...[] byteBitWidths;/** Number of significant bits in i, not counting sign bits. ... */int loint hi/** Create an array of successive differences. ... */isFullRange(...)int lmaxint lmin/** How many bytes are in the coding of this value? ... */int sumint longerint canonicalIndexcodingForIndex(...)int dsbint H_1int delint Sint Bint Hboolean verboseStringForDebug;String minSString maxSint prev_rangeint range_nString rngS/* Copyright (c) 2001, 2011, Oracle and/or its affiliates. All rights reserved. ... */// Code range for a all (B,H) codes of length <=nMax (<=B).// n < B:   L*Sum[i<n]( H^i )// n == B:  L*Sum[i<B]( H^i ) + H^B// no codes of zero length// special case; see (**) above//assert(S >= 0 && S <= S_MAX);// degenerate max value for empty set of codes// No positive codings at all.// check for 32-bit wraparound:// Can code negative values via 32-bit wraparound.// No negative codings at all.// can be out of 32-bit range; who cares// If S>=2 very low negatives are coded by 32-bit-wrapped positives.// The lowest negative representable by a negative coding is// ~(umax32 >> S), and the next lower number is coded by wrapping// the highest positive://    CodePos(umax32-1)  ->  (umax32-1)-((umax32-1)>>S)// which simplifies to ~(umax32 >> S)-1.// must be unsigned 32-bit number// cast to signed int// Sgn(x)  == -(x / 2^S)-1// Sgn(x)  == (x / 2^S)*(2^S-1) + (x % 2^S)// Assert special case of S==1:// unsigned 32-bit int// InvSgn(sx) = (sx / (2^S-1))*2^S + (sx % (2^S-1))// InvSgn(sx) = (-sx-1)*2^S + (2^S-1)// Report number of bytes written by updating outpos[0]:// Check right away for mis-coding.//assert(sx == readInt(out, new int[1], B, H, S));// U(b[i]: i<n) == Sum[i<n]( b[i] * H^i )//assert(sum >= 0 && sum < codeRangeLong(B, H));// Report number of bytes read by updating inpos[0]:// %%% use byte[] buffer// Reduce array values to the required range.// The following code is a buffered version of this loop://    for (int i = start; i < end; i++)//        writeTo(out, a[i]);// range includes both min & max// already in unsigned range// already in signed range// 32-bit overflow, but the next '%=' op needs to be unsigned// Distance in log space of H (<=128) and L (<128).// Double the accuracy of the log:// Follow H in log space by the multiplicative inverse of L.// x in range (int.MIN_VALUE -> 32)// change sign//assert(w == ceil_lg2(i + 1));// no overflow// Reduce delta values to the required range.// We will force the values to reduce to the right subrange.// Huge range; delta values must assume full 32-bit range.// final values must be representable// Calculate max, min:// implements BitMetric//return Coding.of(B, H, S).getLength(deltas, 0, len);// at least 1 byte per// add extra bytes for extra-long values// what is the coding interval [min..max] for n bytes?// count of guys longer than n bytes// no more passes needed// cannot represent!//assert((str = stringForDebug()) != null);import Random/** Heuristic chooser of basic encodings. ... */new Sizer(...)boolean optUseHistogram;boolean optUsePopulationCoding;boolean optUseAdaptiveCoding;boolean disablePopCoding;boolean disableRunCoding;boolean topLevel;double fuzz;// when looking to beat a best score.// Derived from effort; >1 (<1) means try more (less) experiments...[] allCodingChoices;...[] choices;ByteArrayOutputStream context;CodingChooser popHelper;CodingChooser runHelper;Random stress;// Element in sorted set of coding choices:// If not null, stress mode oracle.Coding coding;...[] distance;// index in choices// cache of distancethis.codingthis.distanceint searchOrder;// These variables are reset and reused:int minDistance;// order in which it is checkedint zipSize;// min distance from already-checked choicesint byteSize;// size of encoding in sample, zipped outputint histSize;// size of encoding in sample (debug only)// size of encoding, according to histogramPropMap p200int lstressthis.optUseHistogramthis.optUsePopulationCodingthis.optUseAdaptiveCodingthis.stressnew Random(...)this.effortthis.allCodingChoicesthis.fuzzallCodingChoices.lengthnew Choice[]int[] distancechoices.lengthCoding ci...[...].codingdistanceFrom(...)Coding cjint dij...[...].distanceChoice cdistance.lengthint start, ...;...[] deltas;// slice of valuesint min, ...;Histogram vHist;Histogram dHist;Choice regularChoice;Choice bestChoice;CodingMethod bestMethod;int bestByteSize;int bestZipSize;int targetSize;// fuzzed target byte sizethis.startthis.endthis.deltasthis.vHistthis.dHistthis.searchOrderthis.regularChoicethis.bestChoicethis.bestMethodthis.bestZipSizethis.bestByteSizethis.targetSizeint MID_EFFORT;int POP_EFFORT;int RUN_EFFORT;int BYTE_SIZE;int ZIP_SIZE;int numChoicesmarkUsableChoices(...)double searchScaleint searchOrderLimitint maxdupdateDistances(...)int zipSize1int byteSize1int dscaleCoding plainBestbestChoice.codingCodingMethod lbestMethodint[] computedcomputeSizePrivate(...)getValueHistogram(...)getDeltaHistogram(...)int randnextInt(...)CodingMethod codingc.searchOrderc.codingstressCoding(...)stressPopCoding(...)stressAdaptiveCoding(...)regularChoice.codingint XlenregularChoice.zipSizeregularChoice.byteSizeChoice nextChoiceint dhiint dloint nextMaxdfindChoiceNear(...)nextChoice.codingbestChoice.searchOrdertryPopulationCoding(...)tryAdaptiveCoding(...)pct(...)makeExtraChoice(...)// min distance to all previously evaluated choices, in this range.// evaluated choices, and at most dhi.  Try also to regulate its// Find an arbitrary choice at least dlo away from a previouslynear.distanceChoice foundc.minDistanceboolean mustComputeSizeisExtra(...)Histogram histgetHistogram(...)c.histSizegetBitLength(...)c.byteSizec.zipSizenoteSizes(...)boolean betterc.distanceChoice c2int dint mindc2.minDistancec2.searchOrder// The second is an estimate of the compressed size of these bytes.// The first int is the size in uncompressed bytes.// Compute the coded size of a sequence of values.resetData(...)getByteSize(...)getZipSize(...)computeSize(...)// This version uses the implicit local argumentsint size2countBytesToSizer(...)new Histogram(...)getDeltas(...)int approxLCoding favoredCodinggetValueCoding(...)Coding tokenCodingsetL(...)BandStructure.UNSIGNED5Coding unfavoredCodingint BAND_HEADERint currentFSizeint currentTSizeint currentUSizeint ZERO_LENint bestPopSizeint bestPopFVCint[] allFavoredValuesgetTotalLength(...)int targetLowFVCint targetHighFVCint[][] matrixgetMatrix(...)int mrowint mcolint mrowFreqint oldZipSizeint[] LValuesCodedPopulationCoding.LValuesCodedList<Coding> bestFitsnew ArrayList<Coding>(...)List<Coding> fullFitsList<Coding> longFitsint PACK_TO_MAX_SList<Coding> allFitsint maxFitsint fvcountint thisValueint thisVLenint thisVCountint thisTokenint currentSize...[...].lengthBandStructure.BYTE1int bestBboolean doFullAlsosetS(...)LValuesCoded.lengthCoding c0fitTokenCoding(...)Coding c1Coding c3Coding c2setB(...)Iterator<Coding> iIterator<Coding> jIterator<Coding> ksubList(...)Coding tcboolean packToMaxint fVlenPopulationCoding popnew PopulationCoding(...)int[] tcsizescomputePopSizePrivate(...)umax(...)setHistogram(...)setFavoredValues(...)pop.tokenCodingresortFavoredValues(...)pop.fVlenint[] favoredValuespop.fValuesint[][] valsencodeValues(...)int[] tokensint[] unfavoredValuesint[] checkSizespopHelper.topLevelpopHelper.verbosepopHelper.disablePopCodingpopHelper.disableRunCodingthis.disableRunCodingsetFavoredCoding(...)nextBoolean(...)CodingMethod tctokens.lengthsetTokenCoding(...)unfavoredValues.lengthsetUnfavoredCoding(...)pop.unfavoredCodingpop.favoredCodingwriteSequencesTo(...)int lstartint lendint[] lvaluesint totalSizedouble avgSizedouble sizeFuzzdouble sizeFuzz2double sizeFuzz3double[] dmeshesdouble logLenlog(...)int[] meshesdmeshes.lengthint mfillpint[] threshesmeshes.lengthdouble[] fuzzeslvalues.lengthexp(...)getNextK(...)int meshdouble lfuzzrunHelper.topLevelrunHelper.verboserunHelper.disableRunCodingrunHelper.disablePopCodingthis.disablePopCodingint threshint bendint bsizedouble bigSizeint nextiCodingMethod begcmCodingMethod midcmCodingMethod endcmint bend0int bsize0CodingMethod chainint[] chainSizeOutputStream out;// if non-null, copy output here alsoSizer zipSizer;Deflater zipDef;DeflaterOutputStream zipOut;Sizer byteSizer;Sizer byteOnlySizer;flushData(...)/// Stress-test helpers.setSeed(...)// Pick a random pop-coding.Coding valueCodingstressLen(...)List<Integer> popvalsint reorderint[] fvalsint[] lvalsSet<Integer> popsetnew HashSet<Integer>(...)matrix.lengthint[] rowrow.lengthshuffle(...)reverse(...)lvals.lengthint popl// Pick a random adaptive coding.Coding plainCodingint spanlenint[] allValuesCodingMethod resultint scanint splitint thisspanCodingMethod scAdaptiveCoding.KX_MAXAdaptiveCoding.KB_MAXAdaptiveCoding.KB_DEFAULT// Return a random value in [0..len], gently biased toward extremes.Coding.H_MAXCoding.S_MAXH(...)Coding dc// The following line "makes sense" but is too much// work for a simple heuristic.//if (effort > 5)  zipDef.setLevel(effort);// If effort = 9, look carefully at any solution// whose initial metrics are within 1% of the best// so far.  If effort = 1, look carefully only at// solutions whose initial metrics promise a 1% win.// Save the value array// Find all the preset choices that might be worth looking at:// Make a random choice.// Pick a totally random coding 6% of the time.// every 2 effort points doubles work// Start by evaluating the "regular" choice.// save these first-cut numbers for later// Give credit for being the default; no band header is needed.// Rather than increasing every other size value by the band// header amount, we decrement this one metric, to give it an edge.// Decreasing zipSize by a byte length is conservatively correct,// especially considering that the escape byte is not likely to// zip well with other bytes in the band.// band coding header//regularChoice.histSize -= Xlen; // keep exact byteSize//regularChoice.byteSize -= Xlen; // keep exact byteSize// Continually select a new choice to evaluate.// cycle dscale values!// Record best "plain coding" choice.// Pass back the requested information:// Mark as already visited:// arbitrary pick// already searched// Distance from "near" guy must be in bounds:// Try also to keep min-distance from other guys in bounds:// models should agree// update all minDistance values in still unevaluated choices// how far is c from everybody else?// Now maxd has the distance of the farthest outlier// from all evaluated choices.// cannot happen// assert(plainCoding.canRepresent(min, max));// Start with "reasonable" default codings.// There's going to be a band header.  Estimate conservatively large.// Keep a running model of the predicted sizes of the F/T/U sequences.// Start by assuming a degenerate favored-value length of 0,// which looks like a bunch of zero tokens followed by the// original sequence.// The {F} list ends with a repeated F value; find worst case:// The {T} list starts out a bunch of zeros, each of length 1.// The {U} list starts out a copy of the plainCoding:// Record all the values, in decreasing order of favor.//int[] allPopSizes    = new int[1+hist.getTotalLength()];// What sizes are "interesting"?// For each length, adjust the currentXSize model, and look for a win.// The {F} list gets an additional member.// Take it from the end of the current matrix row.// (It's the end, so that we get larger favored values first.)// The token list replaces occurrences of zero with a new token:// The unfavored list loses occurrences of the newly favored value.// (This is the whole point of the exercise!)//allPopSizes[fvcount] = currentSize;// Complete loss.// Now close onto a specific coding, testing more rigorously// with the zipSize metric.// Questions to decide://   1. How many favored values?//   2. What token coding (TC)?//   3. Sort favored values by value within length brackets?//   4. What favored coding?//   5. What unfavored coding?// Steps 1/2/3 are interdependent, and may be iterated.// Steps 4 and 5 may be decided independently afterward.// interleave all B greater than bestB with best and full fits// Kludge:  setS(PACK_TO_MAX_S) means packToMax here.// redundant test// predict correctly// No nested run codings.// Find good coding choices for the token and unfavored sequences.//pop.hist.print("pop-hist", null, System.out);// do not bother with size computation// Write the array of favored values.// Scan the value sequence, determining whether an interesting// run occupies too much space.  ("Too much" means, say 5% more// than the average integer size of the band as a whole.)// Try to find a better coding for those segments.//%%% not quite right!//System.out.println("len "+val+" = "+size);// for now:// double the thresh// Find some mesh scales we like.// op, KB, A, B// Threshold values for a "too big" mesh.// No nested pop codings.// Found a size bulge.// No use working further.// Prepend given salt to the test output.// this method is only for testing// Don't turn it into a pop coding if it's already something special.// Build the population from the value list.// Lose the order.// Keep the order, mostly.// Cut the list down.// Cut at end.// Cut at start.// Don't turn it into a run coding if it's already something special.// Decide how many spans we'll create.// temporary, while I decide spans// Every so often generate a value based on KX/KB format.// Try smaller and smaller codings://System.out.println("KX="+KX+" KB="+KB+" K="+thisspan);// Choose a coding for the span [split..scan).// the caboose// return to normal value// For debug only./* public static ... *//** Interface for encoding and decoding int arrays using bytewise codes. ... */// Read and write an array of ints from/to a stream.// how to express me in a band header?import AbstractList/** Representation of constant pool entries and indexes. ... */TAGS_IN_ORDER.lengthverifyTagOrder(...)// do not instantiate/** Factory for Utf8 string constants. ... */Map<String,Utf8Entry> utf8EntriesgetUtf8Entries(...)getTLGlobals(...)Utf8Entry enew Utf8Entry(...)/** Factory for Class constants. */Map<String,ClassEntry> classEntriesgetClassEntries(...)ClassEntry enew ClassEntry(...)/** Factory for literal constants (String, Integer, etc.). */Map<Object,LiteralEntry> literalEntriesgetLiteralEntries(...)LiteralEntry enew StringEntry(...)new NumberEntry(...)/** Factory for signature (type) constants. */Map<String,SignatureEntry> signatureEntriesgetSignatureEntries(...)SignatureEntry enew SignatureEntry(...)// Convenience overloading.stringValueOf(...)/** Factory for descriptor (name-and-type) constants. */Map<String,DescriptorEntry> descriptorEntriesgetDescriptorEntries(...)DescriptorEntry enew DescriptorEntry(...)/** Factory for member reference constants. */Map<String,MemberEntry> memberEntriesgetMemberEntries(...)MemberEntry enew MemberEntry(...)/** Factory for MethodHandle constants. */Map<String,MethodHandleEntry> methodHandleEntriesgetMethodHandleEntries(...)MethodHandleEntry enew MethodHandleEntry(...)/** Factory for MethodType constants. */Map<String,MethodTypeEntry> methodTypeEntriesgetMethodTypeEntries(...)MethodTypeEntry enew MethodTypeEntry(...)/** Factory for InvokeDynamic constants. */Map<String,InvokeDynamicEntry> invokeDynamicEntriesgetInvokeDynamicEntries(...)InvokeDynamicEntry enew InvokeDynamicEntry(...)/** Factory for BootstrapMethod pseudo-constants. */Map<String,BootstrapMethodEntry> bootstrapMethodEntriesgetBootstrapMethodEntries(...)new BootstrapMethodEntry(...)/** Entries in the constant pool. */byte tag;int valueHash;// a CONSTANT_foo code// cached hashCode// Equality of Entries is value-based.computeValueHash(...)Entry thatthat.tagbyte[] allowedTagsString valuePrintString value;Utf8Entry.class(...).valuesuperCompareTo(...)Number value;numberTagOf(...)NumberEntry.classComparable<Number> compValueUtf8Entry ref;this.refeq(...)StringEntry.class(...).refClassEntry.classUtf8Entry nameRef;SignatureEntry typeRef;this.nameRefthis.typeRefint hc2DescriptorEntry thatDescriptorEntry.classthat.nameRefthat.typeRefqualifiedStringValue(...)prettyString(...)isMethod(...)ClassEntry classRef;DescriptorEntry descRef;isMemberTag(...)this.classRefthis.descRefMemberEntry thatMemberEntry.classthat.classRefthat.descRefUtils.SORT_MEMBERS_DESCR_MAJORUtf8Entry formRef;...[] classRefs;Utf8Entry asUtf8Entry;classRefs.lengthString[] partsstructureSignature(...)SignatureEntry.classSignatureEntry thatcompareSignatures(...)that.valueflattenSignature(...)String formint minint S1_COMES_FIRSTint S2_COMES_FIRSTp1.lengthp2.lengthint reschar[] sigString clsgetChars(...)int firstlchar[] formint passint formPtrint partPtrint nextsemiint nextanglskipTo(...)/** @since */int refKind;MemberEntry memRef;isRefKind(...)this.refKindthis.memRefMethodHandleEntry thatMethodHandleEntry.classthat.refKindthat.memRefUtils.SORT_HANDLES_KIND_MAJORrefKindName(...)MethodTypeEntry thatMethodTypeEntry.classBootstrapMethodEntry bssRef;this.bssRefInvokeDynamicEntry thatInvokeDynamicEntry.classthat.bssRefUtils.SORT_INDY_BSS_MAJORMethodHandleEntry bsmRef;...[] argRefs;this.bsmRefthis.argRefsBootstrapMethodEntry thatBootstrapMethodEntry.classthat.bsmRefthat.argRefsUtils.SORT_BSS_BSM_MAJORcompareArgArrays(...)char nextSepboolean didOnea1.lengtha2.length// Handy constants:...[] noClassRefs;/** An Index is a mapping between CP entries and small integers. */String debugName;...[] cpMap;boolean flattenSigs;this.debugNamesetMap(...)clearIndex(...)this.cpMap// never produces them!// reports true for signatures, but the iterator()// from a Collection point of view, because contains()// treated as equivalent entries of cpMap.  This is wrong// As a special hack, if flattenSigs, signatures are// Find index of e in cpMap, or return -1 if none.int probefindIndexLocation(...)initializeIndex(...)SignatureEntry sefindIndexOf(...)asUtf8Entry(...)// Find index of e in cpMap.  Should not return -1.dumpStack(...)...[] indexKey;// internal hash table...[] indexValue;indexKey.lengthEntry e1int hsize0int hsizeint sznew Index(...)// Index methods./** Sort this index (destructively) into canonical order. *//** Return a set of indexes partitioning these entries. ... */List<List<Entry>> partsnew ArrayList<List<Entry>>(...)Index[] indexesnew Index[]List<Entry> partnew ArrayList<Entry>(...)indexes.lengthint[] keysIndex[] byTagpartition(...)byTag.length...[...].debugNameIndex[] longer/** Coherent group of constant pool indexes. */...[] indexByTag;...[] indexByTagGroup;...[] untypedFirstIndexByTag;int totalSizeQQ;...[] indexByTagAndClass;/** Index of all CP entries of all types, in definition order. */int whichuntypedIndexOf(...)int ixLenix.cpMap.length/** Index of all CP entries of a given tag. */getIndexByTagGroup(...)makeTagGroupIndex(...)/** Index of all CP entries of a given tag and class. */Index allClassesgetIndexByTag(...)Index[] perClassIndexesint whichClassnew Index[][]Index allMembersint[] whichClasseswhichClasses.lengthe.classRefperClassIndexes.lengthassertIsSorted(...)// produce the ordinal of this particular given overloading.// Given the sequence of all methods of the given name and class,getMemberIndex(...)methodRef.tagmethodRef.classRefUtf8Entry nameRefmethodRef.descRef.nameRefmethodRef.descRefint orde.descRef.nameRefe.descRef// Inverse of getOverloadingIndex/** Close the set cpRefs under the getRef(*) relation. ... */completeReferencesIn(...)ListIterator<Entry> workUtf8Entry ueBootstrapMethodEntry bsmEntry re...[] TAGS_IN_ORDER;// archive constant pool definition order...[] TAG_ORDER;...[] NUMBER_TAGS;...[] EXTRA_TAGS;...[] LOADABLE_VALUE_TAGS;...[] ANY_MEMBER_TAGS;...[] FIELD_SPECIFIC_TAGS;int prevint next// same reference// subclasses must refine this// format check also?// force computation of valueHash// Use reference equality of interned strings:// Primary key is typeRef, not nameRef.// Qualification by dot must decompose uniquely.  Second string might already be qualified.// descRef is transmitted as UDELTA5; sort it first?// Primary key is classRef.// always do this// force computation of value// Skip rest of array info./* switch (classRefs[0].stringValue()) { ... */// JDK 7 ConstantValue limited to String// fields before methods (because there are fewer of them)/* // non-classes before classes (because there are fewer of them) ... *///sig[j++] = ';';// Segment the string like sig.split("L\\([^;<]*\\)").// N.B.: Previous version of this code did a more complex match,// to next ch < ' ' or ch in [';'..'@'].  The only important// characters are ';' and '<', since they are part of the// signature syntax.// Examples://   "(Ljava/lang/Object;IJLLoo;)V" => {"(L;IJL;)V", "java/lang/Object", "Loo"}//   "Ljava/util/List<Ljava/lang/String;>;" => {"L<L;>;", "java/util/List", "java/lang/String"}// pass 0 is a sizing pass, pass 1 packs the arrays// next ';' or '<', or zero, or sigLen// sig[i-1] is 'L', while sig[j] will be the first ';' or '<' after it// each part is in sig[i .. j-1]//assert(flattenSignature(parts).equals(sig));// Primary key could be refKind.// Primary key is memRef, which is transmitted as UDELTA5.// Primary key could be bsmRef.// Primary key is descriptor, which is transmitted as UDELTA5.// Primary key is bsmRef.// Primary key is args array length, which is transmitted as UDELTA5.// Arguments are formatted as "<foo;bar;baz>" instead of "[foo,bar,baz]".// This ensures there will be no confusion if "[,]" appear inside of names.// same as get(), with covariant return type// e has unique index// %%% Should move this into class Index.// Partition by tag.// warm up untypedFirstIndexByTag// get ready for pass 2// do not init twice// It must be a homogeneous Entry set.// Special case:  First Utf8 must always be empty string.// decache indexes derived from this one:// Make an empty one by default.// pool groups:// This one does not have any fixed index, since it is context-specific.// Create the partition now.// Divide up all entries of the given tag according to their class.// Found a different overloading.  Increment the ordinal.// pop stack// Totally replace e by se.// do not descend into the sig// move it away to the side table where it belongs// fall through to recursively add refs for this entry// Recursively add the refs of e to cpRefs:// no more refs in e// output the ref// push stack, if a new ref// pseudo-tags:// cp_Int// note that String=8 precedes Class=7// cp_Descr// cp_Field// cp_Method// cp_Imethod// Constants defined in JDK 7 and later:// pseudo-tag, really stored in a class attribute/* System.out.println("TAG_ORDER[] = {"); ... */// pseudo-tag// for CONSTANT_LoadableValue// for CONSTANT_AnyMember// for CONSTANT_FieldSpecific/** Shared constants ... */int JAVA_MAGIC;Package.Version JAVA_MIN_CLASS_VERSION;/* Java Class Version numbers history ... */Package.Version JAVA5_MAX_CLASS_VERSION;Package.Version JAVA6_MAX_CLASS_VERSION;Package.Version JAVA7_MAX_CLASS_VERSION;Package.Version JAVA8_MAX_CLASS_VERSION;int JAVA_PACKAGE_MAGIC;Package.Version JAVA5_PACKAGE_VERSION;Package.Version JAVA6_PACKAGE_VERSION;Package.Version JAVA7_PACKAGE_VERSION;Package.Version JAVA8_PACKAGE_VERSION;Package.Version JAVA_MAX_CLASS_VERSION;// upper limit, should point to the latest class versionPackage.Version MAX_PACKAGE_VERSION;// upper limit should point to the latest package version, for version info!.int CONSTANT_POOL_INDEX_LIMIT;int CONSTANT_POOL_NARROW_LIMIT;String JAVA_SIGNATURE_CHARS;byte CONSTANT_Utf8;byte CONSTANT_unused2;byte CONSTANT_Integer;// unused, was Unicodebyte CONSTANT_Float;byte CONSTANT_Long;byte CONSTANT_Double;byte CONSTANT_Class;byte CONSTANT_String;byte CONSTANT_Fieldref;byte CONSTANT_Methodref;byte CONSTANT_InterfaceMethodref;byte CONSTANT_NameandType;byte CONSTANT_unused13;byte CONSTANT_unused14;byte CONSTANT_MethodHandle;byte CONSTANT_MethodType;byte CONSTANT_unused17;byte CONSTANT_InvokeDynamic;byte CONSTANT_None;// pseudo-constants:byte CONSTANT_Signature;byte CONSTANT_BootstrapMethod;byte CONSTANT_Limit;// used only in InvokeDynamic constantsbyte CONSTANT_All;byte CONSTANT_LoadableValue;// combined global mapbyte CONSTANT_AnyMember;// used for 'KL' and qldc operandsbyte CONSTANT_FieldSpecific;// union of refs to field or (interface) methodbyte CONSTANT_GroupFirst;// used only for 'KQ' ConstantValue attrsbyte CONSTANT_GroupLimit;byte REF_getField;// CONSTANT_MethodHandle reference kindsbyte REF_getStatic;byte REF_putField;byte REF_putStatic;byte REF_invokeVirtual;byte REF_invokeStatic;byte REF_invokeSpecial;byte REF_newInvokeSpecial;byte REF_invokeInterface;int ACC_IC_LONG_FORM;// pseudo-access bitsint ATTR_CONTEXT_CLASS;// attribute "context types"//for ic_flagsint ATTR_CONTEXT_FIELD;int ATTR_CONTEXT_METHOD;int ATTR_CONTEXT_CODE;int ATTR_CONTEXT_LIMIT;...[] ATTR_CONTEXT_NAME;int X_ATTR_OVERFLOW, ...;// predefined attr bitsint FO_DEFLATE_HINT;// File option bits, from LSB in ascending bit position.int FO_IS_CLASS_STUB;int AO_HAVE_SPECIAL_FORMATS;// Archive option bits, from LSB in ascending bit position:int AO_HAVE_CP_NUMBERS;int AO_HAVE_ALL_CODE_FLAGS;int AO_HAVE_CP_EXTRAS;int AO_HAVE_FILE_HEADERS;int AO_DEFLATE_HINT;int AO_HAVE_FILE_MODTIME;int AO_HAVE_FILE_OPTIONS;int AO_HAVE_FILE_SIZE_HI;int AO_HAVE_CLASS_FLAGS_HI;int AO_HAVE_FIELD_FLAGS_HI;int AO_HAVE_METHOD_FLAGS_HI;int AO_HAVE_CODE_FLAGS_HI;int AO_UNUSED_MBZ;int LG_AO_HAVE_XXX_FLAGS_HI;// option bits reserved for future useint VRM_CLASSIC;// visitRefs modes:int VRM_PACKAGE;int NO_MODTIME;...[] noInts;// some comstantly empty containers// null modtime value...[] noBytes;...[] noValues;...[] noStrings;List<Object> emptyList;int _meta_default, ...;// meta-codingint _nop, ...;// bytecodesint _end_marker;// End marker, used to terminate bytecode sequences:// 0xcaint _byte_escape;// Escapes:int _ref_escape;int _first_linker_op;// Self linker ops are enabled by Pack.selfCallVariants (true).// However, some of them are relatively useless.// For simplicity, we define the full symmetric set of variants.// There are (7 * 4) self linker ops (super or not, aload_0 or not).// Self linker ops are allowed to absorb a previous "aload_0" op.// possible targets is small, it admits a more compact encoding.// with the current class or its super.  Because the number of// A "self linker op" is a variant bytecode which works only// (But in what follows, "invokeinterface" ops are excluded.)// A "linker op" is a bytecode which links to a class member.// Self-relative pseudo-opcodes for better compression.int _last_linker_op;int _num_linker_ops;int _self_linker_op;int _self_linker_aload_flag;int _self_linker_super_flag;int _self_linker_limit;int _invokeinit_op;// Invoke init ops are enabled by Pack.initCallVariants (true).// They all take method signature references as operands.// immediately previous "newinstance" op.  There are 3 of these ops.// link to the current class, the super class, or the class of the// only with the method name "<init>".  There are variants which// An "invoke init" op is a variant of invokespecial which worksint _invokeinit_self_option;int _invokeinit_super_option;int _invokeinit_new_option;int _invokeinit_limit;int _pseudo_instruction_limit;int _xldc_op;// but they simplify the file format greatly.// Ldc variants gain us only 0.007% improvement in compression ratio,// which is a great simplification.// This lets us index constant pool entries completely according to tag,// Ldc variants support strongly typed references to constants.// linker variant limit == 202+(7*4)+3 == 233int _sldc;int _cldc;// previously named _aldcint _ildc;int _fldc;int _sldc_w;int _cldc_w;// previously named _aldc_wint _ildc_w;int _fldc_w;int _lldc2_w;int _dldc2_w;int _qldc;// anything other than primitive, string, or class must be handled with qldc:int _qldc_w;int _xldc_limit;int _invoke_int_op;// handling of InterfaceMethodRefint _invokespecial_int;int _invokestatic_int;int _invoke_int_limit;// JDK8// new in Java 6// 0x00// 0x01// 0x02// 0x03// 0x04// 0x05// 0x06// 0x07// 0x08// 0x09// 0x0a// 0x0b// 0x0c// 0x0d// 0x0e// 0x0f// 0x10// 0x11// 0x12// 0x13// 0x14// 0x15// 0x16// 0x17// 0x18// 0x19// 0x1a// 0x1b// 0x1c// 0x1d// 0x1e// 0x1f// 0x20// 0x21// 0x22// 0x23// 0x24// 0x25// 0x26// 0x27// 0x28// 0x29// 0x2a// 0x2b// 0x2c// 0x2d// 0x2e// 0x2f// 0x30// 0x31// 0x32// 0x33// 0x34// 0x35// 0x36// 0x37// 0x38// 0x39// 0x3a// 0x3b// 0x3c// 0x3d// 0x3e// 0x3f// 0x40// 0x41// 0x42// 0x43// 0x44// 0x45// 0x46// 0x47// 0x48// 0x49// 0x4a// 0x4b// 0x4c// 0x4d// 0x4e// 0x4f// 0x50// 0x51// 0x52// 0x53// 0x54// 0x55// 0x56// 0x57// 0x58// 0x59// 0x5a// 0x5b// 0x5c// 0x5d// 0x5e// 0x5f// 0x60// 0x61// 0x62// 0x63// 0x64// 0x65// 0x66// 0x67// 0x68// 0x69// 0x6a// 0x6b// 0x6c// 0x6d// 0x6e// 0x6f// 0x70// 0x71// 0x72// 0x73// 0x74// 0x75// 0x76// 0x77// 0x78// 0x79// 0x7a// 0x7b// 0x7c// 0x7d// 0x7e// 0x7f// 0x80// 0x81// 0x82// 0x83// 0x84// 0x85// 0x86// 0x87// 0x88// 0x89// 0x8a// 0x8b// 0x8c// 0x8d// 0x8e// 0x8f// 0x90// 0x91// 0x92// 0x93// 0x94// 0x95// 0x96// 0x97// 0x98// 0x99// 0x9a// 0x9b// 0x9c// 0x9d// 0x9e// 0x9f// 0xa0// 0xa1// 0xa2// 0xa3// 0xa4// 0xa5// 0xa6// 0xa7// 0xa8// 0xa9// 0xaa// 0xab// 0xac// 0xad// 0xae// 0xaf// 0xb0// 0xb1// 0xb2// 0xb3// 0xb4// 0xb5// 0xb6// 0xb7// 0xb8// 0xb9// 0xba// 0xbb// 0xbc// 0xbd// 0xbe// 0xbf// 0xc0// 0xc1// 0xc2// 0xc3// 0xc4// 0xc5// 0xc6// 0xc7// 0xc8// 0xc9import FileInputStreamimport Filesimport Pathimport Propertiesimport SortedMapimport TreeMapimport JarFileimport JarOutputStreamimport GZIPInputStreamimport GZIPOutputStream/** Command line interface for Pack200. */getBundle(...)Pack200.Packer.SEGMENT_LIMITPack200.Packer.KEEP_FILE_ORDERPack200.Packer.DEFLATE_HINTPack200.Packer.MODIFICATION_TIMEPack200.Packer.PASS_FILE_PFXPack200.Packer.UNKNOWN_ATTRIBUTEPack200.Packer.CLASS_ATTRIBUTE_PFXPack200.Packer.FIELD_ATTRIBUTE_PFXPack200.Packer.METHOD_ATTRIBUTE_PFXPack200.Packer.CODE_ATTRIBUTE_PFXPack200.Unpacker.DEFLATE_HINTUtils.UNPACK_REMOVE_PACKFILEPack200.UnpackerResourceBundle RESOURCE;List<String> avboolean doPackboolean doUnpackboolean doRepackboolean doZipString logFileString verbosePropMap<String,String> engPropsString optionMapString[] propTableMap<String,String> avPropsboolean verboseString packfileString jarfileString newfileString bakfileString tmpfilePacker jpacknewPacker(...)Unpacker junpacknewUnpacker(...)String arg0parseCommandOptions(...)Iterator<String> optiString optpropTable.lengthString valString val1String[] val2String prop1String propFileProperties filePropsnew Properties(...)InputStream propInnew FileInputStream(...)load(...)list(...)Entry<Object,Object> meMap<>.Entry<Object,Object>DriverResource.VERSIONprintUsage(...)exit(...)IllegalArgumentException eeDriverResource.BAD_ARGUMENTDriverResource.BAD_OPTIONsetErr(...)OutputStream logDriverResource.BAD_REPACK_OUTPUTproperties(...)String zipcgetZipComment(...)DriverResource.DETECTED_ZIP_COMMENTUtils.PACK_ZIP_ARCHIVE_MARKER_COMMENTDriverResource.SKIP_FOR_REPACKEDJarFile innew JarFile(...)OutputStream outsetOut(...)DriverResource.WRITE_PACK_FILEnew GZIPOutputStream(...)DriverResource.WRITE_PACKGZ_FILEFile bakfboolean okBackuprenameTo(...)DriverResource.SKIP_FOR_MOVE_FAILEDInputStream inBufferedInputStream inBufString outfileOutputStream fileOutSystem.inisGZIPMagic(...)readMagic(...)new GZIPInputStream(...)JarOutputStream outnew JarOutputStream(...)unpack(...)File jarFileFile baseFile wheregetAbsoluteFile(...)Path tmpfiletoPath(...)toFile(...)String progString[] packUsageDriverResource.PACK_HELPString[] unpackUsageDriverResource.UNPACK_HELPString[] usageusage.lengthDriverResource.MORE_INFObyte[] taillong filelenlong skiplentail.lengthString PACK200_OPTION_MAP;String UNPACK200_OPTION_MAP;// For Java version of unpacker (used for testing only):// Note: Collection options use "\0" as a delimiter between arguments....[] PACK200_PROPERTY_TO_OPTION;...[] UNPACK200_PROPERTY_TO_OPTION;/* -* ... */String resultStringTreeMap<String,String[]> optmapnew TreeMap<String,String[]>(...)ListIterator<String> argpListIterator<String> pbpString optlineString[] wordsString[] prevWordswords.lengthDriverResource.DUPLICATE_OPTIONString argint optlenboolean didActionboolean isErrorint pbpMarknextIndex(...)String[] specsSortedMap<String,String[]> pfxmapheadMap(...)lastKey(...)String specint sidxchar specopString specargString negoptString boolvalboolean appendString strvalString oldString delimDriverResource.BAD_SPEC// Non-standard, undocumented "--unpack" switch enables unpack mode.// Collect engine properties here:// Collect argument properties here:// Translate command line options to Pack200 properties:// remove opt from avProps// Normal string or boolean.// Normal boolean; convert to T/F.// Collection property: pack.pass.file.cli.NNN// See if there is any other action to take.// Deal with remaining non-engine properties://log = new BufferedOutputStream(out);// output JAR file if --repack// temporary backup of input JAR// temporary file to be deleted// The first argument is the target JAR file.// (Note:  *.pac is nonstandard, but may be necessary// if a host OS truncates file extensions.)// The optional second argument is the source JAR file.// If only one file is given, it is the only JAR.// It serves as both input and output.// no need to zip the temporary file// Accept jarfiles ending with .jar or .zip.// Accept jarfile of "-" (stdout), but only if unpacking.// Mode = Pack.// Packfile must be -, *.gz, *.pack, or *.pac.// Send warnings, etc., to stderr instead of stdout.//in.close();  // p200 closes in but not out// If the source and destination are the same,// we will move the input JAR aside while regenerating it.// This allows us to restore it if something goes wrong.// On Windows target must be deleted see 4017593// Open jarfile recovery bracket.// Mode = Unpack.// p200 closes in but not out// At this point, we have a good jarfile (or newfile, if -r)// On success, abort jarfile recovery bracket.// Close jarfile recovery bracket.// Win32 requires this, see above// In all cases, delete temporary *.pack.// Skip sig4, disks4, entries4, clen4, coff4, cmt2// Negative options as required by CLIP:// Non-Standard Options//+"--java-option=      *> = \n  -J +>  @--java-option=        = \n"// Termination:// end option sequence here// report error if -XXX present; else use stdout// report error if -XXX present; else use stdin//Pack200.Packer.PROGRESS, "--progress=",//Pack200.Unpacker.PROGRESS, "--progress=",//System.out.println(args+" // "+properties);// Convert options string into optLines dictionary.// initial word is not a spec// initial "word" is empty due to leading ' '// State machine for parsing a command line.// One trip through this loop per argument.// Multiple trips per option only if several options per argument.// No more arguments at all.// One time through this loop for each matching arg prefix.// Match some prefix of the argument to a key in optmap.// Decide on a smaller prefix to search for.// pfxmap.lastKey is no shorter than any prefix in optmap.// (Note:  We could cut opt down to its common prefix with// pfxmap.lastKey, but that wouldn't save many cycles.)// arg == opt+val// Execute the option processing specs for this opt.// If no actions are taken, then look for a shorter prefix.// in case of backtracking// Deal with '+'/'*' prefixes (spec conditions).// + means we want an non-empty val suffix.// * means we accept empty or non-empty// No condition prefix means we require an exact// match, as indicated by an empty val suffix.// terminate the option sequence// abort the option sequence// change the effective opt name// shift remaining arg val to next arg// push a new argument// negation option// leave placeholder// normal "boolean" option// If there is a given spec token, store it.// Increment any previous value as a numeral.// "string" option// "collection" option// Read an option.// Append new val to old with embedded delim.// Done processing specs.// The specs should have done something, but did not.// Remove anything pushed during these specs.// We cannot try a shorter matching option.// If we come here, there was no matching option.// So, push back the argument, and return to caller.// Report number of arguments consumed.// Report any unconsumed partial argument.//System.out.println(args+" // "+properties+" -> "+resultString);String VERSION;String BAD_ARGUMENT;String BAD_OPTION;String BAD_REPACK_OUTPUT;String DETECTED_ZIP_COMMENT;String SKIP_FOR_REPACKED;String WRITE_PACK_FILE;String WRITE_PACKGZ_FILE;String SKIP_FOR_MOVE_FAILED;String PACK_HELP;String UNPACK_HELP;String MORE_INFO;String DUPLICATE_OPTION;String BAD_SPEC;...[] resource;/* The following are the output of 'pack200' and 'unpack200' commands. ... */// parameter 0:class name;parameter 1: version value// parameter 0:option name;parameter 1:option value// parameter 0:filename// parameter 0:comment// parameter 0:command name// parameter 0:option// parameter 0:option;parameter 1:specifier/* This class provides an ArrayList implementation which has a fixed size, ... *//* @author ksrini */ArrayList<E> flist;new ArrayList<E>(...)containsAll(...)// initialize the list to nullimport AbstractCollection/** Collection of relocatable constant pool references. ... */int head;// the subject of the relocationsint tail;// desc locating first reloc// desc locating last reloc...[] entries;// number of relocations...[] bigDescs;// [0..size-1] relocations// it is kept in the bigDescs array.// or if the "desc" is too large to encode in the bytes,// link this data structure together.  If the bytes are missing,// patching, bytes addressed by descs may also be used to// and format.  Every fixup occurs at a "desc".  Until final// A "desc" (descriptor) is a bit-encoded pair of a location// descs which cannot be stored in the bytesint MINBIGSIZE;...[] noBigDescs;// cleverly share empty bigDescs:int bigSizeentries.lengthEntry[] oldEntriesbigDescs.lengthint[] oldBigDescsFixup fxstoreIndex(...)location(...)ArrayList<Fixup> oldnew ArrayList<Fixup>(...)ArrayList<Fixup> saveint LOC_SHIFT;int FMT_MASK;byte UNUSED_BYTE;byte OVERFLOW_BYTE;int BIGSIZE;// fill pointer of bigDescs array is in element [0]int U2_FORMAT;// Format values:int U1_FORMAT;int SPECIAL_LOC;// Special values for the static methods.int SPECIAL_FMT;descLoc(...)fmtLen(...)descFmt(...)int descbyte b1byte b2fetchDesc(...)/** Simple and necessary tuple to present each fixup. */int desc;Entry entry;// location and format of reloc// which entry to plug into the bytesthis.descthis.entrymakeDesc(...)Fixup thatthat.descthat.entryint bigIndex;// index into entriesint next;// index into bigDescs// desc pointing to next fixupint thisIndexnew Fixup(...)nextDesc(...)int thisDescint locint fmtnew Itr(...)addDesc(...)f.descf.entryFixups thatEntry[] thatEntriesthat.entriesthat.sizegrowEntries(...)Itr ii.index// Here is how things get added:int prevDescint prevLocint prevFmtint prevLenint thisLocbadOverlap(...)storeDesc(...)growBigDescs(...)oldEntries.lengtholdBigDescs.length/// Static methods that optimize the use of this class.Fixups fEntry firstEntryf.bytes// Iterate over all the references in this set of fixups.// by a hardcoded coding of its reference, drawn from ix.// Clear out this set of fixups by replacing each referencefx.entry// If there are no bytes, all descs are kept in bigDescs.// Clean the bytes://System.out.println("clean "+fx);// do not trim to size, however// One or the other representations is deficient.// Construct a checkpoint.// assume newBytes is some sort of bitwise copy of the old bytes// Stored loc field is difference between its own loc and next loc.// Failure.  Caller must allocate a bigDesc.// Ordering depends only on location.// Fetch next desc eagerly, in case this fixup gets finalized.// The unused extra byte is "asserted" to be equal to BI.// This helps keep the overflow descs in sync.// Use knowledge of Itr structure to avoid building little structs.// presize exactly// Store new desc in previous tail.// The collection must go in ascending order, and not overlap.// overflow//System.out.println("bigDescs["+bigSize+"] = "+thisDesc);// Special convention:  If the attribute has a// U2 relocation at position zero, store the Entry// rather than building a Fixups structure.// Recognize the special convention:// Special convention; see above.//System.out.println("finish "+fx+" = "+index);// Note that the iterator has already fetched the// bytes we are about to overwrite.// Further iterations should do nothing:// do not clean them/** Histogram derived from an integer array of events (int[]). ... */Histogram.this...[] matrix;// plus 5 words per distinct count.// Compact histogram representation:  4 bytes per distinct value,int totalWeight;// multi-row matrix {{counti,valueij...}}// They cost another 8 bytes per distinct value.// These are created eagerly also, since that saves work.// sum of all counts// unique values, sorted by valuelong LOW32;// counts, same order as values/** Build a histogram given a sequence of values. ... */long[] hist2colcomputeHistogram2Col(...)maybeSort(...)int[][] tablemakeTable(...)this.matrixmakeMatrix(...)this.totalWeightvalueSequence.lengthassertWellFormed(...)sortedSlice(...)/** Build a histogram given a compact matrix of counts and values. */int weightnormalizeMatrix(...)int rowLengthhist2col.length/** Histogram of int values, reported compactly as a ragged matrix, ... */getRowFrequency(...)getRowLength(...)/** Returns an array of all values, sorted. *//** Returns an array parallel with {@link #getValues}, ... */double log2;double probgetTotalWeight(...)getFrequency(...)BitMetric bitMetric;/** bit-length is negative entropy:  -H(matrix). */double sumgetRowBitLength(...)getRowWeight(...)/** bit-length in to another coding (cross-entropy) *//** Sort rows and columns. ... */long[] rowMapint[][] newMatrixint prevCountint fillp1int fillp2long rowMapEntryrowMap.lengthint[] row1int rfillpint[] row0row0.lengthisSorted(...)int jfillprow1.lengthint[] newRow1int totalUniqueint ltotalWeightString[] histTitlesint cumWeightint cumUniqueint uniquelong wpctlong upctdouble len/** Print a report of this histogram. */getRowTitles(...)double tlendouble avgLendouble avgint[] countslong[] countHistcountHist.lengthint histpint countpcounts.lengthlong countAndRepint repeatlong countAndValue/** Simple two-column histogram.  Contains repeated counts. ... */long[] histsortedValues.lengthboolean sizeOnlyint prevIndexint prevValue/** Regroup the histogram, so that it becomes an approximate histogram ... */long oldEntrieslong newEntriesgroups.lengthint jMinint jMaxint newlenlong okint[] newGroupslong excessint groupLengthint[] grouplong groupWeightint njFillgroup.lengthint[] tallytally.length/** Slice and sort the given input array. */int[] sliceslice.length/** Tell if an array is sorted. *//** Clone and sort the array, if not already sorted. *//// Debug stuff follows.// sort the rows// clone and sort// sort key is value, so put it in the high 32!//backwards// close it off// Close off previous run.// previously visited row// cloned & consolidated row// Detect and squeeze out duplicates.// Reallocate because of lost duplicates.// no unfinished business// Now drop missing rows.// Sort by increasing count, then by increasing value.// cursor into hist2col (increasing count, value)// cursor into countHist (increasing count)// Do a join between hist2col (resorted) and countHist.// what is the value count?// # times repeated?// Break apart the entries in hist2col.// table[0] gets values, table[1] gets entries.// force a difference// force a difference at end// Found a new value.// Save away previous value.// Finished the sizing pass.  Allocate the histogram.// done// Fill pointers.// into matrix// count of all in new group// compute average count of new group:// Build a matrix.// found witness to disorder// no witness => sorted/* // Sanity check. ... *//** A parsed bytecode instruction. ... */new String[][]String namesdef(...)int bcint spint pc;int bc;// location of this instructionint w;// opcode of this instruction// 0 if normal, 1 if a _wide prefix at pcboolean special;// bytes in this instructionthis.pcthis.bcint npcisNonstandard(...)/** A fake instruction at this pc whose next() will be at nextpc. */int llengthnew Instruction(...)int prefixnew TableSwitch(...)new LookupSwitch(...)reuse.special// Return the constant pool reference type, or 0 if none.// Return the constant pool index, or -1 if none.int indexLoc// Return the slot of the affected local, or -1 if none.int slotLoc// Return the target of the branch, or -1 if none.int branchLocgetBranchLabel(...)// Return 0 if there is none.// Return the trailing constant in the instruction (as a signed value).int conLocgetConstant(...)// Each case is a (value, label) pair, indexed 0 <= n < caseCountintAt(...)setIntAt(...)int apc;// aligned pc (table base)this.apcalignPC(...)this.specialgetCaseCount(...)int caseCountlabstr(...)getDefaultLabel(...)getCaseValue(...)getCaseLabel(...)// apc:  (df, lo, hi, (hi-lo+1)*(label))getLowCase(...)setHighCase(...)setLowCase(...)setCaseCount(...)// apc:  (df, nc, nc*(case, label))/** Two instructions are equal if they have the same bytes. */that.pcthat.bcthat.wthat.lengththat.bytesString bcnameBC_NAME.lengthgetCPTag(...)int sltgetLocalSlot(...)int labint con/// Fetching values from byte arrays://public static byte constantPoolTagFor(int bc) { return BC_TAG[0][bc]; }// some bytecode classifiers...[] BC_LENGTH;/// Format definitions....[] BC_INDEX;...[] BC_TAG;...[] BC_BRANCH;...[] BC_SLOT;...[] BC_CON;...[] BC_NAME;...[] BC_FORMAT;String inameisInvokeInitOp(...)int BW;// width of classification fieldString[] fmtsint branchint slotint opcodegetBC(...)getCPRef(...)boolean matchgreaterThan(...)i.bcConstants.JAVA7_MAX_CLASS_VERSION// Hard cases:// unknown instruction; treat as one byte// Speed hack:  Instruction.next reuses self if possible.// _ldc opcode only/* w *//* length */// keep invariant// do not pack// pack oo// pack all ints, omit padding// pack kf (base=Field)// pack kn (base=Method)// pack ki (base=IMethod), omit xx// pack ky (base=Any), omit xx// pack kc// pack oooo//System.out.println(i+": l="+BC_LENGTH[0][i]+" i="+BC_INDEX[0][i]);//assert(BC_LENGTH[0][i] != -1);// unknown opcode// Have a complete mapping, to support spurious _wide prefixes.// not both branch & local// not both branch & cp// not both local & cpimport CRC32import ZipEntryimport ZipOutputStreamnew CRC32(...)initIDs(...)long unpackerPtr;// Pointer to the native unpacker objBufferedInputStream in;// Input stream.// Returns (s<<32|f), the number of following segments and files.// If the buffer is null, the readInputFn callback is used to get bytes.// Starts processing at the indicated position in the buffer.// Returns true if there's another, and fills in the parts.// Returns total number of bytes consumed by the engine.// Resets the engine and frees all resources.// Setting state in the unpacker.int _verbose;long _byteCount;// State for progress bar:int _segCount;// bytes read in current segmentint _fileCount;// number of segs scannedlong _estByteLimit;// number of files writtenint _estSegLimit;// estimate of eventual totalint _estFileLimit;// dittoint _prevPercent;CRC32 _crc32;// for monotonicity...[] _buf;UnpackerImpl _p200;PropMap _props;p200.propsp200._nunp// for JNI callbacksUnpackerImpl p200// Callback from the unpacker engine to get more data.long maxlenlong numreadint stepsint readlen_buf.lengthdouble READ_WTdouble WRITE_WTdouble readProgressdouble writeProgressdouble scaledProgressint percentsetInteger(...)Pack200.Unpacker.PROGRESSboolean setsetOption(...)BufferedInputStream in0int modtimeConstants.NO_MODTIMEPack200.Packer.KEEPUtils.UNPACK_MODIFICATION_TIMEcopyInOption(...)long countsint nextSegint nextFiledouble filesAfterThisSegint[] intPartsObject[] partslong consumedgetNextFile(...)long mtimeboolean deflateHintByteBuffer data0ByteBuffer data1writeEntry(...)getUnusedInput(...)isPackMagic(...)run(...)ByteBuffer mappedFileFileInputStream fisCRC32 crc32ZipEntry znew ZipEntry(...)int size0int size1setTime(...)setMethod(...)ZipOutputStream.STOREDsetCrc(...)setCompressedSize(...)Deflater.DEFLATEDputNextEntry(...)closeEntry(...)zeString(...)// If loading from stand alone build uncomment this.// System.loadLibrary("unpack");// nothing is readable// don't talk nonsense// read available input, up to buf.length or maxlen// %%% get rid of this extra copy by using nio?// Progress is a combination of segment reading and file writing.// for readInputFn to see// Fix for BugId: 4902477, -unpack.modification.time = 1059010598000// TODO eliminate and fix in unpack.cpp// Don't pass KEEP && NOW// reset progress bar// Read the packed bits.// reset partial scan counts// just finished scanning a whole segment...// Estimate eventual total number of segments and files.// Write the files.//    intParts = {size.hi/lo, mod, defl}//       parts = { {intParts}, name, data0/1 }//BandStructure.printArrayTo(System.out, intParts, 0, parts.length);// %%% maybe memory-map the file, and pass it straight into unpacker// Note:  caller is responsible to finish with jstream.// Fill in rest of data from the stream itself.import Layoutimport LiteralEntryimport Comparator/** Define the main data structure transmitted by pack/unpack. ... */new IndexGroup(...)ConstantPool.IndexGroupnew ArrayList<Class>(...)PropMap pmapMap<Layout,Attribute> adunmodifiableMap(...)new Field[]Class.Fieldnew Method[]new InnerClass[]int magic;int default_modtime;int default_options;Version defaultClassVersion;// FO_DEFLATE_HINTVersion minClassVersion;// These fields can be adjusted by driver properties.Version maxClassVersion;Version packageVersion;// null, indicates that consensus rules during package writeVersion observedHighestClassVersion;ConstantPool.IndexGroup cp;// What constants are used in this unit?/* typically used by the PackageReader to set the defaults, in which ... *//* Typically used by the PackerImpl during before packing, the defaults are ... */this.minClassVersionthis.maxClassVersionthis.packageVersionBandStructure.nextSeqForDebug// Special empty versions of Code and InnerClasses, used for markers.Attribute.Layout attrBootstrapMethodsEmpty;Attribute.Layout attrSourceFileSpecial;/** Return the highest version number of all classes, ... */Version resVersion vergetVersion(...)setHighestClassVersion(...)ArrayList<Class> classes;// What Java classes are in this unit?Package.thisFile file;// Optional file characteristics and data source (a "class stub")// File headerVersion version;// Local constant pool (one-way mapping of index => package cp).ClassEntry thisClass;//int flags;  // in Attribute.Holder.this.flags// Class headerClassEntry superClass;ArrayList<Field> fields;// Class partsArrayList<Method> methods;ArrayList<InnerClass> innerClasses;// Note that InnerClasses may be collected at the package level.//ArrayList attributes;  // in Attribute.Holder.this.attributesArrayList<BootstrapMethodEntry> bootstrapMethods;boolean addedthis.magicthis.versionthis.flagsthis.thisClassthis.superClassthis.interfacesinitFile(...)newStub(...)// Note:  equals and hashCode are identity-based.String n0String n1getObviousSourceFile(...)Attribute oldaString obviousList<Entry> refUtf8Entry sfNameObject fgetRefString(...)addRefWithBytes(...)List<Attribute> newAttrsint wheresetAttributes(...)transformSourceFile(...)new ArrayList<BootstrapMethodEntry>(...)/** Given a global map of ICs (keyed by thisClass), ... */Set<Entry> cpRefsnew HashSet<Entry>(...)Set<Entry> icRefsArrayList<InnerClass> impliedICsArrayList<InnerClass> innerClassesSavedgetGlobalInnerClass(...)// Computes a symmetric difference.// Helper for both minimizing and expanding.List<InnerClass> impliedICscomputeGloballyImpliedICs(...)List<InnerClass> actualICsSet<InnerClass> centernew HashSet<InnerClass>(...)emptyList(...)retainAll(...)/** When packing, anticipate the effect of expandLocalICs. ... */List<InnerClass> diffcomputeICdiff(...)List<InnerClass> localICssetInnerClasses(...)/** When unpacking, undo the effect of minimizeLocalICs. ... */int changedDescriptorEntry descriptor;this.descriptorClass.thisdescriptor.nameRefdescriptor.typeRefint order;// Order is significant for fields:  It is visible to reflection.new ArrayList<Field>(...)Field thatthis.orderthat.orderCode code;// Code attribute is specially hardwired.new ArrayList<Method>(...)int argSizeint thisSize// Sort methods in a canonical order (by type, then by name).Method thatstrip(...)int isMArrayList<? extends Member> membersvisitInnerClassRefs(...)// Hook called by ClassReader when it's done.maybeChooseFileName(...)this.filecanonicalFileName(...)isClassStub(...)file.stubClassString canonNamefile.nameStringfile.nameString fnameFile.separatorCharc.fileaddFile(...)ArrayList<File> files;// What non-class files are in this unit?List<File> classStubsString nameString;Utf8Entry name;// true name of this fileint modtime;int options;Class stubClass;// random flag bits, such as deflate_hintArrayList<byte[]> prepend;// if this is a stub, here's the classByteArrayOutputStream append;// list of byte[]this.nameStringfixupFileName(...)// (Note:  The name might be "", in the case of a trivial class stub.)// The nameString is the key.  Ignore other things.File thatthat.nameString// Simple alphabetic sort.  PackageWriter uses a better comparator.getFileLength(...)String lnameaddBytes(...)block.lengthList<InputStream> isanew ArrayList<InputStream>(...)enumeration(...)File stubstub.optionsstub.prependstub.appendList<InnerClass> allInnerClasses;// Is there a globally declared table of inner classes?Map<ClassEntry,InnerClass> allInnerClassesByThis;new HashMap<ClassEntry,InnerClass>(...)Object pic/** Return a global inner class record for the given thisClass. */ClassEntry outerClass;boolean predictable;// Can name and outerClass be derived from thisClass?// Nearly all have predictable outers and names.// About 60% are class members; the rest are named locals.// About 30% of inner classes are anonymous (in rt.jar).this.outerClassthis.predictablecomputePredictable(...)String[] parseparseInnerClassName(...)String pkgOuterString haveNameString haveOuterboolean lpredictableInnerClass thatInnerClass.classthat.thisClassthat.outerClassthat.flags// Helper for building InnerClasses attributes.InnerClass cString numberint dollar1int dollar2int nlenint pkglenisDigitString(...)int SLASH_MIN;int SLASH_MAX;int DOLLAR_MIN;int DOLLAR_MAX;String nint cutoff/* static { ... */stripConstantFields(...)Class cIterator<Field> jc.fieldsField fisFinal(...)f.flags// are useless.// file order.  It also removes JAR directory entries, which// compress better.  It also moves classes to the end of the// It sorts files into a new order which seems likely to// Use this before writing the package file.List<File> stubsgetClassStubs(...)Iterator<File> iString f0r0.nameStringString f1r1.nameStringString x0String x1JarFile.MANIFEST_NAMEListIterator<File> iisTrivialClassStub(...)Index cpAllUIndex[] byTagUpartitionByTag(...)ConstantPool.TAGS_IN_ORDER.lengthConstantPool.TAGS_IN_ORDERinitIndexByTag(...)byTagU.length// Use this before writing the class files.Set<File> fileSetnew HashSet<File>(...)List<Object> noObjects;List<Field> noFields;List<Method> noMethods;List<InnerClass> noInnerClasses;short major;short minor;this.majorthis.minor(...).major(...).minorint minorint majorshort minorshort majorint maj// Fill in permitted range of major/minor version numbers.// initial low value// A blank class; must be read with a ClassReader, etc.// Replace "obvious" SourceFile by null.// no SourceFile attr.// A pair of zero bytes.  Cannot use predef. layout.// Expand null attribute to the obvious string.// Replace by an all-zero attribute.// do not do this twice// Edit the attribute list, if necessary.// This block temporarily displaces this.innerClasses.// ignore for the moment// Restrict cpRefs to InnerClasses entries only.// For every IC reference, add its outers also.// If we add A$B$C to the mix, we must also add A$B.// This loop is structured this way so as to accumulate// entries into impliedICs in an order which reflects// the order of allInnerClasses.// This one is locally relevant if it describes// a member of the current class, or if the current// class uses it somehow.  In the particular case// where thisClass is an inner class, it will already// be a member of icRefs.// Add every relevant class to the IC attribute:// Symmetric difference is calculated from I, A like this://  diff = (I+A) - (I*A)// Note that the center C is unordered, but the result// preserves the original ordering of I and A.// Class file rules require that outers precede inners.// So, add I before A, in case A$B$Z is local, but A$B// is implicit.  The reverse is never the case.// Diff is I since A is empty.// Diff is A since I is empty.// (I*A) is non-trivial// Diff is now I^A = (I+A)-(I*A).// will be the diff, modulo edge cases// No diff, so transmit no attribute.// Odd case:  No implied ICs, and a zero length attr.// Do not support it directly.// No local IC attribute, even though some are implied.// Signal with trivial attribute.// Transmit a non-empty diff, which will create// a local ICs attribute.// Reduce the set to the symmetric difference.// Diff was empty.  (Common case.)// added more tuples// It was a non-empty diff, but the local ICs were absent.// [] => null, no tuple change// Non-trivial diff was transmitted.// If we only added more ICs, return +1.// Careful:  The descriptor is used by the package,// but the classfile breaks it into component refs.// set-once// Build a trivial stub.// do not choose yet// The file name is predictable.  Transmit "".// If name has not yet been looked up, find it now.// Make sure the class is represented in the total file order:// caller must fill in contents// JAR directory.  Useless.//if (name.startsWith("./"))  name = name.substring(2);// do not collect data// Make an index:// caller must ensure key uniqueness!//System.out.println("computePredictable "+outerClass+" "+this.name);//String number = parse[1];//System.out.println("computePredictable => "+predictable);// If the name can be demangled, the package omits// the products of demangling.  Otherwise, include them.// no attribute; nothing to do// Count the entries themselves://System.out.println("parseInnerClassName "+n);// pointers to $ in the pattern// parse n = (<pkg>/)*<outer>($<number>)?($<name>)?// n = (<pkg>/)*<outer>$<number>// n = (<pkg>/)*<outer>$<number>$<name>// n = (<pkg>/)*<outer>$<name>//System.out.println("parseInnerClassName parses "+pkgOuter+" "+number+" "+name);// null string// Work backwards, finding all '$', '#', etc.// what is one of { Debug, Compile, Constant, Exceptions, InnerClasses }// Keep the inner classes normally.// Although they have no effect on execution,// the Reflection API exposes them, and JCK checks them.// NO: // strip("InnerClasses");// Keep the exceptions normally.// do not strip non-static finals:// First reorder the classes, if that is allowed.// In one test with rt.jar, this trick gained 0.7%// Remove stubs from resources; maybe we'll add them on at the end,// if there are some non-trivial ones.  The best case is that// modtimes and options are not transmitted, and the stub files// for class files do not need to be transmitted at all.// Also// Sort the remaining non-class files.// We sort them by file type.// This keeps files of similar format near each other.// Put class files at the end, keeping their fixed order.// Be sure the JAR file's required manifest stays at the front. (4893051)// Get the file name.// Extract file basename.// Extract basename extension.// Primary sort key is file extension.// Add back the class stubs after sorting, before trimStubs.// Restore enough non-trivial stubs to carry the needed class modtimes.// uconditionally present// Work on all entries of a given kind.// done with it// all consumed// Add to the end of ths list:import ConstantPool.*/** Reader for a package file. ... */int k0getOutputIndex(...)int k1new HashMap<Class,Set<Entry>>(...)LimitedBuffer in;Package.Version packageVersion;new LimitedBuffer(...)/** A buffered input stream which is careful not to ... */long served;int servedPos;// total number of charburgers servedlong limit;// ...as of this value of super.poslong buffered;// current declared limitboolean zgetBytesServed(...)super.inlong remainingClass[] classesreadClasses(...)readFileHeader(...)readBandHeaders(...)readAttrDefs(...)readByteCodes(...)readFiles(...)atLimit(...)reconstructClass(...)Exception eein.limitin.buffered...[] tagCount;// Temporary count values, until band decoding gets rolling.int numFiles;int numAttrDefs;int numInnerClasses;int numClasses;readArchiveMagic(...)readArchiveHeader(...)// in the file_header:// Local routine used to parse fixed-format scalarsint MAGIC_BYTES;int magicgetMagicInt32(...)setReadLimit(...)expectLength(...)pkg.magic// Fixed 6211177, converted to throw IOExceptionVersion versionFoundVersion vnew Version[]String expVerboolean haveSpecialboolean haveFilesboolean haveNumbersboolean haveCPExtraint remainingHeaderscheckArchiveVersion(...)initHighestClassVersion(...)initAttrIndexLimit(...)long sizeHilong sizeLopkg.default_modtimereadConstantPoolCounts(...)pkg.defaultClassVersionpkg.default_optionsbandHeaderBytes.lengthpkg.cpIndex indexinitCPIndex(...)int totalArgCountgetIntTotal(...)readUtf8Bands(...)float fxlong hilong lodouble dxreadSignatureBands(...)Entry refEntry ref2readMemberRefs(...)checkLegacy(...)SignatureEntry typeRefBootstrapMethodEntry bssMethodHandleEntry bsmint argcindex.cpMapindex.cpMap.lengthindex.debugNamesetBandIndexes(...)int SUFFIX_SKIP_1int PREFIX_SKIP_2char[][] suffixCharsint bigSuffixCountint maxCharsint suffixIntBand packedMap<Utf8Entry,SignatureEntry> utf8Signatures;int[] numSigClassesUtf8Entry formRefcountClassParts(...)new HashMap<Utf8Entry,SignatureEntry>(...)ClassEntry[] classRefsint optionsboolean haveSizeHiboolean haveModtimeboolean haveOptionsIterator<Class> nextClassgetClasses(...)long totalFileLengthlong[] fileLengthssetInputStreamFrom(...)getReadLimit(...)Utf8Entry namelong toReadfile.modtimefile.optionscls.file.modtimePrintStream dumpint headerUtf8Entry layoutString pvLayoutlayoutForClassVersion(...)int longICCountList<InnerClass> icListint flagsboolean longFormClassEntry thisClassClassEntry outerClassUtf8Entry thisNameic.predictablesetAllInnerClasses(...)ClassEntry outerint NO_FLAGS_YET;// placeholder for later flag read-innew Class[]ClassEntry superClassClassEntry[] interfacesnew Class(...)interfaces.lengthcountAndReadAttrs(...)readCodeHeaders(...)Entry seComparator<Entry> entryOutputOrder;Attribute retroVersionparseClassFileVersionAttr(...)expandSourceFile(...)setCPMap(...)reconstructLocalCPMap(...)Set<Entry> ldcRefsArrayList<BootstrapMethodEntry> bsmsexpandLocalICs(...)int numDoublesSet<Entry> wideRefsint narrowLimitint revpcls.attributesint totalNFint totalNMList<Field> fieldsList<Method> methodsint nfbuildCodeAttrs(...)...[] allCodes;List<Code> codesWithFlags;Map<Class,Set<Entry>> ldcRefMap;List<Code> codesnew ArrayList<Code>(...)Code[] anew Code[]boolean attrsOKList<Code> longCodesallCodes.lengthCode csetMaxStack(...)setMaxNALocals(...)shortCodeHeader(...)readCodeHandlers(...)countAttrs(...)ValueBand[] code_handler_bandsnew ValueBand[]code_handler_bands.lengthint jmaxc.handler_classc.handler_startc.handler_endc.handler_catch// of attribute "customers".// The holders is a global list, already collected,// classes, fields, methods, and codes.// Generic routines for reading attributes ofreadAttrs(...)// on the given holders.// Read flags and count the attributes that are to be placedlong flagMaskLayout[] defsnew Layout[]IntBand xxx_flags_higetAttrBand(...)IntBand xxx_flags_loIntBand xxx_attr_countIntBand xxx_attr_indexesIntBand xxx_attr_callsint overflowMaskint overflowHolderCountboolean haveLongFlagsint[] totalCountsdefs.lengthint callCountsHolder hh.flagslong attrBitsint noalong overflowBitint nfalong bitsList<Attribute> haAttribute canonicalbadAttrIndex(...)boolean predefint totalCountElement[] cblesgetCallables(...)cbles.lengthint tupleCountgetIntCount(...)readAttrBands(...)int[] forwardCountsint entryCountSet<Layout> sawDefsnew HashSet<Layout>(...)ByteArrayOutputStream bufListIterator<Attribute> jboolean isCVObject fixupsAttribute.ValueStreamreadLocalInnerClasses(...)setConstantValueIndex(...)Band eBandint repCountint remainingCountint j0...[...].valueBand[] operand_bandsbc_codes.elementCountForDebugreadByteCodeOps(...)operand_bands.lengthexpandByteCodeOps(...)fixupCodeHandlers(...)List<Integer> allSwitchOpsboolean isWideexpectMoreLength(...)getCPRefOpBand(...)CPRefBand bc_whichselfOpRefBand(...)isBranchOp(...)isCPRefOp(...)isLocalSlotOp(...)c.bytesint[] insnMapint[] labelsFixups fixupBufbyte[] codeOpsClass curClassSet<Entry> ldcRefSetcurClass.thisClasscurClass.superClassClassEntry newClassint numInsnsint numLabelsboolean hasEscsInstruction ibrcodeOps.lengthint curPClabels.lengthInstruction.SwitchSwitch iswsetCaseValue(...)getNextPC(...)int localaddU1(...)addU2(...)ClassEntry classRefMemberEntry refgetOverloadingForIndex(...)opLength(...)ClassEntry which_clsIndex which_ixint nextPC(...).descRef.typeRef(...).descRefint iValbyteName(...)setDefaultLabel(...)setCaseLabel(...)setBranchLabel(...)addFixups(...)// fast path//assert(served <= limit || limit == -1);//  pack200_archive://        file_header//        *band_headers :BYTE1//        cp_bands//        attr_definition_bands//        ic_bands//        class_bands//        bc_bands//        file_bands// cp_bands// file_bands// As a post-pass, build constant pools and inner classes.//if (verbose > 0)  ee.printStackTrace();//  file_header://        archive_magic archive_header// Read a minimum of bytes in the first gulp.//  archive_magic://        #archive_magic_word :BYTE1[4]// read and check magic numbers://  archive_header://        #archive_minver :UNSIGNED5[1]//        #archive_majver :UNSIGNED5[1]//        #archive_options :UNSIGNED5[1]//        (archive_file_counts) ** (#have_file_headers)//        (archive_special_counts) ** (#have_special_formats)//        cp_counts//        class_counts//  archive_file_counts://        #archive_size_hi :UNSIGNED5[1]//        #archive_size_lo :UNSIGNED5[1]//        #archive_next_count :UNSIGNED5[1]//        #archive_modtime :UNSIGNED5[1]//        #file_count :UNSIGNED5[1]//  class_counts://        #ic_count :UNSIGNED5[1]//        #default_class_minver :UNSIGNED5[1]//        #default_class_majver :UNSIGNED5[1]//        #class_count :UNSIGNED5[1]//  archive_special_counts://        #band_headers_size :UNSIGNED5[1]//        #attr_definition_count :UNSIGNED5[1]// detect archive optional fields in archive header// now we are ready to use the data:// Set the limit, now, up to the file_bits.// for debug only// remove limitation// set some derived archive bits// Leave room to pushback the initial XB byte.// size the constant pools://  cp_counts://        #cp_Utf8_count :UNSIGNED5[1]//        (cp_number_counts) ** (#have_cp_numbers)//        #cp_String_count :UNSIGNED5[1]//        #cp_Class_count :UNSIGNED5[1]//        #cp_Signature_count :UNSIGNED5[1]//        #cp_Descr_count :UNSIGNED5[1]//        #cp_Field_count :UNSIGNED5[1]//        #cp_Method_count :UNSIGNED5[1]//        #cp_Imethod_count :UNSIGNED5[1]//        (cp_attr_counts) ** (#have_cp_attr_counts)//  cp_number_counts://        #cp_Int_count :UNSIGNED5[1]//        #cp_Float_count :UNSIGNED5[1]//        #cp_Long_count :UNSIGNED5[1]//        #cp_Double_count :UNSIGNED5[1]//  cp_extra_counts://        #cp_MethodHandle_count :UNSIGNED5[1]//        #cp_MethodType_count :UNSIGNED5[1]//        #cp_InvokeDynamic_count :UNSIGNED5[1]//        #cp_BootstrapMethod_count :UNSIGNED5[1]// These four counts are optional.//  cp_bands://        cp_Utf8//        *cp_Int :UDELTA5//        *cp_Float :UDELTA5//        cp_Long//        cp_Double//        *cp_String :UDELTA5  (cp_Utf8)//        *cp_Class :UDELTA5  (cp_Utf8)//        cp_Signature//        cp_Descr//        cp_Field//        cp_Method//        cp_Imethod// coding handles signs OK//  cp_Long://        *cp_Long_hi :UDELTA5//        *cp_Long_lo :DELTA5//  cp_Double://        *cp_Double_hi :UDELTA5//        *cp_Double_lo :DELTA5//  cp_Descr://        *cp_Descr_type :DELTA5  (cp_Signature)//        *cp_Descr_name :UDELTA5  (cp_Utf8)//  cp_Utf8://        *cp_Utf8_prefix :DELTA5//        *cp_Utf8_suffix :UNSIGNED5//        *cp_Utf8_chars :CHAR3//        *cp_Utf8_big_suffix :DELTA5//        (*cp_Utf8_big_chars :DELTA5)//          ** length(cp_Utf8_big_suffix)// Bands have implicit leading zeroes, for the empty string:// First band:  Read lengths of shared prefixes.// Second band:  Read lengths of unshared suffixes:// Third band:  Read the char values in the unshared suffixes:// chars are packed in cp_Utf8_big_chars// Fourth band:  Go back and size the specially packed strings.// Fifth band(s):  Get the specially packed characters.// already input// Do not bother to add an empty "(Utf8_big_0)" band.// Finally, sew together all the prefixes and suffixes.// by induction, the buffer is already filled with the prefix//  cp_Signature://        *cp_Signature_form :DELTA5  (cp_Utf8)//        *cp_Signature_classes :UDELTA5  (cp_Class)//  cp_Field://        *cp_Field_class :DELTA5  (cp_Class)//        *cp_Field_desc :UDELTA5  (cp_Descr)//  cp_Method://        *cp_Method_class :DELTA5  (cp_Class)//        *cp_Method_desc :UDELTA5  (cp_Descr)//  cp_Imethod://        *cp_Imethod_class :DELTA5  (cp_Class)//        *cp_Imethod_desc :UDELTA5  (cp_Descr)//  file_bands://        *file_name :UNSIGNED5  (cp_Utf8)//        *file_size_hi :UNSIGNED5//        *file_size_lo :UNSIGNED5//        *file_modtime :DELTA5//        *file_options :UNSIGNED5//        *file_bits :BYTE1// Compute file lengths before reading any file bits.// %%% Use a big temp file for file bits?// Do the rest of the classes.// implicitly initialize to a trivial one//  attr_definition_bands://        *attr_definition_headers :BYTE1//        *attr_definition_name :UNSIGNED5  (cp_Utf8)//        *attr_definition_layout :UNSIGNED5  (cp_Utf8)// Check layout string for Java 6 extensions.// Attribute layouts define bands, one per layout element.// Create them now, all at once.//  ic_bands://        *ic_this_class :UDELTA5  (cp_Class)//        *ic_flags :UNSIGNED5//        *ic_outer_class :DELTA5  (null or cp_Class)//        *ic_name :DELTA5  (null or cp_Utf8)// A zero flag means copy a global IC here.// must be a valid global IC reference// clear the marker bit// cls.expandLocalICs may add more tuples to ics also,// or may even delete tuples.// We cannot do that now, because we do not know the// full contents of the local constant pool yet.//  class_bands://        *class_this :DELTA5  (cp_Class)//        *class_super :DELTA5  (cp_Class)//        *class_interface_count :DELTA5//        *class_interface :DELTA5  (cp_Class)//        ...(member bands)...//        class_attr_bands//        code_bands// Packer encoded rare case of null superClass as thisClass://code_bands.doneDisbursing(); // still need to read code attrs//class_bands.doneDisbursing(); // still need to read code attrs// Output CPs do not contain signatures.// In the output ordering, input signatures can serve// in place of Utf8s.// If both have keys, use the keys.// If neither have keys, use their native tags & spellings.// Otherwise, the guy with the key comes first.// check for local .ClassFile.version// Replace null SourceFile by "obvious" string.// record the local cp:// look for constant pool entries:/* BootstrapMethod(BSMs) are added here before InnerClasses(ICs), ... */// flesh out the local constant pool// Now that we know all our local class references,// compute the InnerClasses attribute.// Just visit the expanded InnerClasses attr.// Have to recompute from scratch, because of deletions.// flesh out the local constant pool, again// remove the attr previously set, otherwise add the bsm and// references as required// construct a local constant pool// Add all ldc operands first.// Next add all the two-byte references.// do not use!// Now repack backwards, introducing null elements.// do not process the initial null//        ...//        *class_field_count :DELTA5//        *class_method_count :DELTA5//        *field_descr :DELTA5  (cp_Descr)//        field_attr_bands//        *method_descr :MDELTA5  (cp_Descr)//        method_attr_bands// Make a pre-pass over field and method counts to size the descrs:// release to GC// Up to this point, Code attributes look like empty attributes.// Now we start to special-case them.  The empty canonical Code// attributes stay in the method attribute lists, however.//  code_bands://        *code_headers :BYTE1//        *code_max_stack :UNSIGNED5//        *code_max_na_locals :UNSIGNED5//        *code_handler_count :UNSIGNED5//        code_attr_bands// We will read ms/ml/nh/flags from bands shortly.// Short code header is the usual case:// Do the long headers now.// Code attributes are common (debug info not stripped).// Code attributes are very sparse (debug info is stripped).// do readAttrs later, after BCs are scanned//        *code_handler_start_P :BCI5//        *code_handler_end_PO :BRANCH5//        *code_handler_catch_PO :BRANCH5//        *code_handler_class_RCN :UNSIGNED5  (null or cp_Class)// For now, just record the raw BCI codes.// We must wait until we have instruction boundaries.// Actually decode (renumber) the BCIs now.//  class_attr_bands://        *class_flags :UNSIGNED5//        *class_attr_count :UNSIGNED5//        *class_attr_indexes :UNSIGNED5//        *class_attr_calls :UNSIGNED5//        *class_Signature_RS :UNSIGNED5 (cp_Signature)//        class_metadata_bands//        *class_SourceFile_RU :UNSIGNED5 (cp_Utf8)//        *class_EnclosingMethod_RM :UNSIGNED5 (cp_Method)//        ic_local_bands//        *class_ClassFile_version_minor_H :UNSIGNED5//        *class_ClassFile_version_major_H :UNSIGNED5//        class_type_metadata_bands//  field_attr_bands://        *field_flags :UNSIGNED5//        *field_attr_count :UNSIGNED5//        *field_attr_indexes :UNSIGNED5//        *field_attr_calls :UNSIGNED5//        *field_Signature_RS :UNSIGNED5 (cp_Signature)//        field_metadata_bands//        *field_ConstantValue_KQ :UNSIGNED5 (cp_Int, etc.; see note)//        field_type_metadata_bands//  method_attr_bands://        *method_flags :UNSIGNED5//        *method_attr_count :UNSIGNED5//        *method_attr_indexes :UNSIGNED5//        *method_attr_calls :UNSIGNED5//        *method_Signature_RS :UNSIGNED5 (cp_Signature)//        method_metadata_bands//        *method_Exceptions_N :UNSIGNED5//        *method_Exceptions_RC :UNSIGNED5  (cp_Class)//        *method_MethodParameters_NB: BYTE1//        *method_MethodParameters_RUN: UNSIGNED5 (cp_Utf8)//        *method_MethodParameters_FH:  UNSIGNED5 (flag)//        method_type_metadata_bands//  code_attr_bands://        *code_flags :UNSIGNED5//        *code_attr_count :UNSIGNED5//        *code_attr_indexes :UNSIGNED5//        *code_attr_calls :UNSIGNED5//        *code_LineNumberTable_N :UNSIGNED5//        *code_LineNumberTable_bci_P :BCI5//        *code_LineNumberTable_line :UNSIGNED5//        *code_LocalVariableTable_N :UNSIGNED5//        *code_LocalVariableTable_bci_P :BCI5//        *code_LocalVariableTable_span_O :BRANCH5//        *code_LocalVariableTable_name_RU :UNSIGNED5 (cp_Utf8)//        *code_LocalVariableTable_type_RS :UNSIGNED5 (cp_Signature)//        *code_LocalVariableTable_slot :UNSIGNED5//        code_type_metadata_bands// Here, xxx stands for one of class, field, method, code.// Fetch the attribute layout definitions which govern the bands// we are about to read.// Count up the number of holders which have overflow attrs.// For each holder with overflow attrs, read a count.// Now it's time to check flag bits that indicate attributes.// We accumulate (a) a list of attribute types for each holder// (class/field/method/code), and also we accumulate (b) a total// count for each attribute type.// System.out.println("flags="+h.flags+" using fm="+flagMask);// Clean up the flags now.// strip attr bits// 16 bits only now// no attrs on this guy// number of overflow attrs// number of flag attrs// iterate again// This definition index is live in this holder.// Now each holder has a list of canonical attribute instances.// For layouts with no elements, we are done.  However, for// layouts with bands, we must replace each canonical (empty)// instance with a value-bearing one, initialized from the// appropriate bands.// Make a small pass to detect and read backward call counts.// unused index// wrong pass// irrelevant// Finally, size all the attribute bands.// Special case.// Size the bands as if using the following layout://    [RCH TI[ (0)[] ()[RCNH RUNH] ]].// Drop remaining columns wherever flags are zero:// Expect no elements at all.  Skip quickly. however if we// are debugging bands, read all bands regardless// Read these bands in sequence.// At first, record initial calls.// Later, forward calls may also accumulate here:// No more, please!// mark them read,  to satisfy asserts// Decode band values into attributes.// Special logic to read this attr.// Canonical empty attr works fine (e.g., Synthetic).// Read one attribute of type def from ab into a byte array.// Replace the canonical attr with the one just read.// clean up// Mark the bands we just used as done disbursing.// Recursive call.// Note:  getIntTotal makes an extra pass over this band.// back up to last occurrence of this body// Backward calls are pre-counted, but forwards are not.// Push the present count forward.//  bc_bands://        *bc_codes :BYTE1//        *bc_case_count :UNSIGNED5//        *bc_case_value :DELTA5//        *bc_byte :BYTE1//        *bc_short :DELTA5//        *bc_local :UNSIGNED5//        *bc_label :BRANCH5//        *bc_intref :DELTA5  (cp_Int)//        *bc_floatref :DELTA5  (cp_Float)//        *bc_longref :DELTA5  (cp_Long)//        *bc_doubleref :DELTA5  (cp_Double)//        *bc_stringref :DELTA5  (cp_String)//        *bc_classref :UNSIGNED5  (current class or cp_Class)//        *bc_fieldref :DELTA5  (cp_Field)//        *bc_methodref :UNSIGNED5  (cp_Method)//        *bc_imethodref :DELTA5  (cp_Imethod)//        *bc_thisfield :UNSIGNED5 (cp_Field, only for current class)//        *bc_superfield :UNSIGNED5 (cp_Field, only for current super)//        *bc_thismethod :UNSIGNED5 (cp_Method, only for current class)//        *bc_supermethod :UNSIGNED5 (cp_Method, only for current super)//        *bc_initref :UNSIGNED5 (cp_Field, only for most recent new)//        *bc_escref :UNSIGNED5 (cp_All)//        *bc_escrefsize :UNSIGNED5//        *bc_escsize :UNSIGNED5//        *bc_escbyte :BYTE1// reads from bc_codes and bc_case_count// All the operand bands have now been sized.  Read them all in turn.// Done fetching values from operand bands:// We must delay the parsing of Code attributes until we// have a complete model of bytecodes, for BCI encodings.// Ditto for exception handlers in codes.// Now we can finish with class_bands; cf. readClasses().// scratch buffer for collecting code::// record of all switch opcodes (these are variable-length)// Adjust expectations of various band sizes.// bc_escbyte will have to be counted too// handled elsewhere// Transfer from buf to a more permanent place:// To size instruction bands correctly, we need info on switches:// default label + cases// scratch buffer for collecting code:// scratch buffer for collecting instruction boundaries:// list of label carriers, for label decoding post-pass:// scratch buffer for registering CP refs:// just for now, while we accumulate bits// class of last _new opcode// fill pointer in buf; actual bytecode PC//initialize apc, df, lo, hi bytes to reasonable bits://isw.setDefaultLabel(getLabel(bc_label, code, curPC));// Make our getLabel calls later.// Note that insnMap has one entry for this.// Note that insnMap has one entry for all these bytes.// Find the nth overloading of <init> in classRef.// Note: insnMap keeps the _aload_0 separate.// no wide prefix for branches//Instruction.at(buf, curPC).setBranchLabel(getLabel(bc_label, code, curPC));// Shorthand for class self-references.// Copy the trailing byte also.// Random bytecode.  Just copy it.// now make a permanent copy of the bytecodes// fix up labels, now that code has its insnMap// temporary branch instruction// (Note:  Passing ibr in allows reuse, a speed hack.)/** Writer for a package file. ... */OutputStream finalOut;this.finalOutsetup(...)writeFiles(...)writeAttrDefs(...)writeClassesAndByteCodes(...)writeAttrCounts(...)printCodeHist(...)writeAllBandsTo(...)Set<Entry> requiredEntries;Map<Layout,int[]> backCountTable;// for the CP...[] attrCounts;// for layout callables// count attr. occurrencessetArchiveOptions(...)trimClassAttributes(...)collectAttributeLayouts(...)buildGlobalConstantPool(...)collectInnerClasses(...)/* Convenience function to choose an archive version based ... */Version highVpkg.packageVersionhaveExtraTags(...)int minModtimeint maxModtimeint minOptionsint maxOptionsMap<Version,int[]> verCountsnew HashMap<Version,int[]>(...)int bestCountVersion bestVersionint cost0int cost1pkg.filespkg.classesVersion versionint[] varmakeClassFileVersionAttr(...)attributeSize(...)toBinaryString(...)chooseDefaultPackageVersion(...)writeArchiveMagic(...)writeArchiveHeader(...)// Local routine used to format fixed-format scalarsputMagicInt32(...)int headerSizeForDebugint DUMMYattrDefsWritten.lengthhaveNumbers(...)packageVersion.minorpackageVersion.majorwriteConstantPoolCounts(...)getAllInnerClasses(...)pkg.defaultClassVersion.minorpkg.defaultClassVersion.majorint archiveSizeHiint archiveSizeLoint zeroLenpatchValue(...)// with a zipped unbanded file.// delta-encoded constant pool saves over 11% (of the total file size) compared// a zipped non-delta-encoded package.  Thus, in the zipped file, a banded,// zipping is even better:  A zipped delta-encoded package is 8% smaller than// Because a typical delta usees much less data than a byte, the savings after// Delta encoding saves an extra 5% in the output size (13% of the CP itself).// each band.  (This is especially useful if we sort the constant pool first.)// After moving similar data into bands, it becomes natural to delta-encode// unzipped sizes are the same (only the byte order differs).// The difference in zipped size is 4%, which is remarkable since the// compressor to issue significantly shorter indexes for repeated data.// Note:  Keeping the data separate in passes (or "bands") allows the// applying the benefits more broadly.)// applied the banding technique to every part of the package file,// "banding" the constant pool itself.  Later revisions of this algorithm// (The following observations are out of date; they apply only toIndexGroup cpwriteUtf8Bands(...)NumberEntry efloatToIntBits(...)doubleToLongBits(...)StringEntry ee.refwriteSignatureBands(...)e.nameRefe.typeRefwriteMemberRefs(...)e.memRefe.bssRefchar[][] charsint[] prefixeschar[] prevCharschar[] curCharscurChars.lengthprevChars.lengthchar[] strstr.lengthboolean isPackedint numWidetryAlternateEncoding(...)int normCharCountint packCharCountint charCountint[] cvalsCoding bigRegularcp_Utf8_big_chars.regularCodingString bandNameint BYTE_SIZEint ZIP_SIZECodingChooser.ZIP_SIZECodingMethod specialCoding charRegularcp_Utf8_chars.regularCodingint specialZipSizeint[] normalSizesint normalZipSizeint minWinIntBand biginitializeValues(...)e.formRefe.classRefs.lengthe.classRefsint numFilesnew FixedList<Map<Layout,int[]>>(...)new HashMap<Layout,int[]>(...)visitAttributeLayoutsIn(...)int nlint TOO_MANY_ATTRSlong avHiBitsint nextLoBitMap<Layout,int[]> defMapEntry<Layout,int[]>[] layoutsAndCountsnew Entry<>[]Map<>.Entry<>Map<>.Entry<Layout,int[]>layoutsAndCounts.lengthEntry<Layout,int[]> eInteger predefIndexint[] bcEntry neString layoutEntry le...[] maxFlags;// Scratch variables for processing attributes and flags.List<Map<Layout,int[]>> allLayouts;int[] count...[] attrDefsWritten;List<Object[]> defListint numAttrDefsObject[][] defsInteger ind0Integer ind1int[] indexForDebugboolean debugint hdrIndexint realIndexbc.lengthint backCountminimizeSourceFile(...)Map<ClassEntry,InnerClass> allICMapInnerClass[] allICshasInnerClasses(...)InnerClass picpic.predictablepic.thisClassminimizeLocalICs(...)/** If there are any extra InnerClasses entries to write which are ... */int nwrittenwriteAttrs(...)writeCodeHeader(...)writeByteCodes(...)c.max_localsc.max_stackgetMaxStack(...)getMaxNALocals(...)writeCodeHandlers(...)// Generic routines for writing attributes and flags oflong flagsToAddint overflowCountwriteLocalInnerClasses(...)getCallables(...).lengthCode curCode;// temporary scratch variables for processing code blocksClass curClass;...[] curCPMap;c.m// else -1.// Return an _invokeinit_op variant, if the instruction matches one,ClassEntry refClassref.classRefref.descRef.nameRefref.descRef// Return a _self_linker_op variant, if the instruction matches one,int self_bctagEquals(...)boolean prevAloadEntry newClassbeginCode(...)int init_bcinitOpVariant(...)selfOpVariant(...)String complaintisWide(...)Instruction nigetOverloadingIndex(...)ref.tagint apcgetAlignedPC(...)putLabel(...)int vbcbc_which.indexendCode(...)...[] codeHist;...[] ldcHist;String[] histcodeHist.lengthint totalBytesString countString pcthist.lengthldcHist.length// Caller has specified maximum class file version in the package:// writeFileHeader() is done last, since it has ultimate counts// writeBandHeaders() is called after all other bands are done// choose codings (fill band_headers if needed)// now we can write the headers:// Write partial output only if we are verbose.// set the package version now// There are only old classfiles in this segment or resources// force down the package version if we have jdk7 classes without// any Indy references, this is because jdk7 class file (51.0) without// Indy is identical to jdk6 class file (50.0).// Normal case.  Use the newest archive format, when available// this bit was reserved for future use in previous versions// Decide on some archive options early.// Does not decide on: AO_HAVE_SPECIAL_FORMATS,// AO_HAVE_CP_NUMBERS, AO_HAVE_FILE_HEADERS.// Also, AO_HAVE_FILE_OPTIONS may be forced on later.// Import defaults from package (deflate hint, etc.).// Make everything else be a positive offset from here.// Put them into a band.// If the archive deflation is set do not bother with each file.// Every file has the deflate_hint set.// Set it for the whole archive, and omit options.// Decide on default version number (majority rule).//System.out.println("version="+version+" count="+count);// degenerate case// Now add explicit pseudo-attrs. to classes with odd versions.// Note:  Does not add in "natural" order.  (Who cares?)// Decide if we are transmitting a huge resource file:// Decide if code attributes typically have sub-attributes.// In that case, to preserve compact 1-byte code headers,// we must declare unconditional presence of code flags.// cost of a useless unconditional flags byte// cost of inflating a short header// for debug only:  number of words optimized away// AO_HAVE_SPECIAL_FORMATS is set if non-default// coding techniques are used, or if there are// compressor-defined attributes transmitted.// AO_HAVE_FILE_HEADERS is set if there is any// file or segment envelope information present.// AO_HAVE_CP_NUMBERS is set if there are any numbers// in the global constant pool.  (Numbers are in 15% of classes.)// AO_HAVE_CP_EXTRAS is set if there are constant pool entries// beyond the Java 6 version of the class file format.// the archiveOptions are all initialized, sanity check now!.// controls header format// (archiveSize1 >>> 32)// (archiveSize1 >>> 0)// Done with unsized part of header....// usually zero// Sanity:  Make sure we came out to 29 (less optional fields):// Figure out all the sizes now, first cut:// Second cut:// Make the adjustments:// Patch the header:// The null string is always first.// Omit counts for numbers if possible.// Omit counts for newer entities if possible.// The first element must always be the empty string.// Fetch the char arrays, first of all.// First band:  Write lengths of shared prefixes.// includes 2 skipped zeroes// Second band:  Write lengths of unshared suffixes.// Third band:  Write the char values in the unshared suffixes.// Zero suffix length is special flag to indicate// separate treatment in cp_Utf8_big bands.// This suffix length never occurs naturally,// except in the one case of a zero-length string.// (If it occurs, it is the first, due to sorting.)// The zero length string must, paradoxically, be// encoded as a zero-length cp_Utf8_big band.// This wastes exactly (& tolerably) one null byte.// Also, the initial empty string does not require a band.// Try packing the chars with an alternate encoding.// No output.// Mark packed string with zero-length suffix count.// This tells the unpacker to go elsewhere for the suffix bits.// Fourth band:  Write unshared suffix with alternate coding.// would be ambiguous// Normal string.  Save suffix in third and fourth bands.// Collect maxFlags and allLayouts.// If there are many species of attributes, use 63-bit flags./* int flag size *//* typical flag bits in use *//* typical number of OK overflows */// heuristic// Standard indexes can never conflict with flag bits.  Assert it.// Collect counts for both predefs. and custom defs.// Decide on custom, local attribute definitions.// Now the remaining defs in allLayouts[i] need attr. indexes.// Fill up unused flag bits with new defs.// Unused bits are those which are not used by predefined attrs,// and which are always clear in the classfiles.// all bits fit into a Java long// Sort by count, most frequent first.// Predefs. participate in this sort, though it does not matter.// Primary sort key is count, reversed.// The index is already set.// clear low bit; we are using it now// Update attrIndexTable:// Now that we know the index, record the count of this def.// For all callables in the def, keep a tally of back-calls.// no count to accumulate here// Make sure the package CP can name the local attribute.// Later, when emitting attr_definition_bands, we will look at// attrDefSeen and attrDefs at position 32/63 and beyond.// The attrIndexTable will provide elements of xxx_attr_indexes bands.// Done with scratch variables:// Make note of which flags appear in the class file.// Set them in maxFlags.// ctype// must fit into a byte// (...else header is simply ctype, with zero high bits.)// either undefined or predefined; nothing to write// Sort the new attr defs into some "natural" order.// Primary sort key is attr def header.// Secondary sort key is attribute index.// (This must be so, in order to keep overflow attr order.)// Check that we are transmitting that correct attribute index:// Write the four xxx_attr_calls bands.// close out; do not collect further counts// Replace "obvious" SourceFile attrs by null.// BootstrapMethods should never have been inserted.// Capture inner classes, removing them from individual classes.// Irregular inner classes must stay local, though.// First, collect a consistent global set.// Different ICs.  Choose the better to make global.// Note: The InnerClasses attribute must be in a valid order,// so that A$B always occurs earlier than A$B$C.  This is an// important side-effect of sorting lexically by class name.// put in canonical order// Next, empty out of every local set the consistent entries.// Calculate whether there is any remaining need to have a local// set, and whether it needs to be locked.// Is it redundant with the global version?// force it to be non-zero// Note:  This code respects the order in which caller put classes.// Collect the class body, sans bytecodes.// Encode rare case of null superClass as thisClass:// bad class file!?// We must write flags, and can only do so for long headers.// null OK// Encode end as offset from start, and catch as offset from end,// because they are strongly correlated.// no extra bits to set here// which flags are attr bits?// do not use this bit twice here// an overflow attr.// System.out.println("overflow @"+index);// Special logic to write this attr.// Empty attr; nothing more to write here.// Write one attribute of type def into ab.// do not optimize this case, simply fall back to regular coding// true if the previous instruction is an aload to absorb// class of most recent new; helps compress <init> calls// %%% Add a stress mode which issues _ref/_byte_escape.// Crash and burn with a complaint if there are funny// bytecodes in this class file.// Begin "bc_linker" compression.// Try to group aload_0 with a following operation.// Test for <init> invocations:// get rid of it//used up// Write special bytecode.// Write operand to a separate band.// Write field or method ref to a separate band.// End "bc_linker" compression.// Normal bytecode.// Note that we do not write the alignment bytes.// write a length specification into the bytecode stream// Transmit case values in their own band.// Done with the switch.// CONSTANT_MethodHandle, etc.// Use a special shorthand for the current class:// references for this bytecode instruction.// Example:  invokestatic of a CONSTANT_InterfaceMethodref.// handle trailing junk// Just dump the byte into the bipush pile// Make sure the discarded bytes are sane:// last 2 bytes MBZ// Make sure there is nothing else to write.// Generic instruction.  Copy the body.// Do a few remaining multi-byte instructions.// that's itimport TimeZoneimport JarEntryimport JarInputStream/* Implementation of the Pack provider. ... *//** Constructs a Packer object and sets the initial state of ... *//** Get the set of options for the pack and unpack engines. ... *//** Takes a JarFile and converts into a pack-stream. ... *///Driver routinesboolean needUTCUtils.PACK_DEFAULT_TIMEZONEUtils.currentInstancechangeDefaultTimeZoneToUtc(...)copyJarFile(...)new DoPack(...)restoreDefaultTimeZone(...)/** Takes a JarInputStream and converts into a pack-stream. ... *//** Register a listener for changes to options. ... */addListener(...)/** Remove a listener for the PropertyChange event. ... */removeListener(...)// The packer worker.// All the worker bees.....new Package(...)makeVersion(...)Utils.PACK_KEEP_CLASS_ORDERPack200.Packer.LATESTPack200.Packer.PROGRESSString uaModePack200.Packer.PASSPack200.Packer.STRIPPack200.Packer.ERRORString fmtModeUtils.CLASS_FORMAT_ERRORMap<Layout,Attribute> lattrDefsMap<Layout,String> lattrCommandsnew HashMap<Layout,String>(...)String[] keysint[] ctypesConstants.ATTR_CONTEXT_CLASSConstants.ATTR_CONTEXT_FIELDConstants.ATTR_CONTEXT_METHODConstants.ATTR_CONTEXT_CODEctypes.lengthMap<String,String> mapprefixMap(...)Constants.ATTR_CONTEXT_NAMEboolean deflate_hintConstants.AO_DEFLATE_HINTlong limitLong.MAX_VALUEListIterator<String> iString filegetJarEntryName(...)int opt// initialize the version numbers now.// Here's where the bits are collected before getting packed, we alsoString classFormatCommand;boolean keepFileOrder;boolean keepClassOrder;boolean keepModtime;boolean latestModtime;boolean keepDeflateHint;long totalOutputSize;int segmentCount;long segmentTotalSize;long segmentSize;long segmentLimit;// running counterList<String> passFiles;// (Done collecting options from props.)int chopUtils.METAINF// Get a new package, based on the old one.JarFile jf;JarEntry je;File f;int timeSecsgetModtime(...)lastModified(...)this.fthis.jfthis.jethis.modtimeJarEntry.DEFLATEDConstants.FO_DEFLATE_HINTlong secondsPackage.Fileint nread;// used only if (verbose > 0)f.namegetManifest(...)ByteArrayOutputStream tmpInputStream tmpInreadFile(...)JarEntry jegetNextJarEntry(...)InFile inFilenew InFile(...)inFile.nameFile bitslong inflenisMetaInfFile(...)getInputLength(...)int nextCountflushPartial(...)isClassFile(...)readClass(...)copyTo(...)noteRead(...)flushAll(...)List<InFile> inFilesscanJar(...)int numDoneInputStream strmfloat filesDonefloat segsDonefloat filesToDofloat segsToDoClassReader readernew ClassReader(...)setAttrDefs(...)setAttrCommands(...)reader.unknownAttrCommandFormatException eeee.layoutClassFormatException ceaddClass(...)// Read raw data.flushPackage(...)makeNextPackage(...)/** Write all information in the current package segment ... */int nfilesPackageWriter pwnew PackageWriter(...)boolean stripDirectoriesreorderFiles(...)List<File> restrimStubs(...)stripAttributeKind(...)pw.archiveNextCountlong outSizepw.archiveSize0pw.archiveSize1long inSizenew ArrayList<InFile>(...)entries(...)IllegalStateException isegetLocalizedMessage(...)// parsed pack.pass.file options// Which class files will be passed through?// normalize '\\' to '/'// Hook for testing:  Forces use of special archive modes.// Bump size by pathname length and modtime/def-hint bytes.// Convert milliseconds to seconds.// First thing we do is get the manifest, as JIS does// not provide the Manifest as an entry.// (5078608) : discount the resource files in META-INF// from segment computation.// don't know; it's a stream// (5078608) : discount the resource files completely from segmenting// Estimate number of remaining segments:// tidy up// He passed up the category to us in layout.// Otherwise, it must be an error.// do not flush an empty segment// In case there will be another segment:// Keeping the order of classes costs about 1%// Keeping the order of all files costs something more.// Package builder must have created a stub for each class.// Order of stubs in file list must agree with classes.// Do some stripping, maybe.// Collect jar entries, preserving order.// This tactic alone reduces the final zipped rt.jar by about a percent./** Population-based coding. ... */...[] fValues;// histogram of all valuesint fVlen;// list of favored values...[] symtab;// inclusive max indexCodingMethod favoredCoding;// int map of favored value -> token [1..#fValues]CodingMethod tokenCoding;CodingMethod unfavoredCoding;//preferred L value for tokenCodingthis.fValuesthis.fVlenint lfVlenfValues.lengthCoding longestCoding shorterthis.favoredCodingthis.tokenCodingthis.unfavoredCodingint nmaxbyteMax(...)int midTargetint prevLimitbyteMin(...)makeSymtab(...)symtab.lengthint nuvint tokgetToken(...)long[] lsymtabint token(...).tailCodinggetTailCoding(...)computeSentinelValue(...)uValues.lengthCoding fcint lastint endValmoreCentral(...)int headpint tailpint uVlenint[] uValuesreadFavoredValuesFrom(...)int nextpint[] lfValuesSet<Integer> uniqueValuesForDebugCodingMethod fcmAdaptiveCoding acac.headLengthint newFillplfValues.lengthac.headCodingac.tailCodingint kxint kyint xymoreCentralSlow(...)//  }//      return min;//      if (x + y == 0)  return (x > y? x : y);//      // (also mentioned in the spec.) breaks ties in favor of negatives.//      // in favor of positive numbers, but the suggested implementation//      // The bug is that the spec. says absolute-value ties are broken//      // Strict implementation of buggy 150.7 specification.//  private static int moreCentral2(int x, int y, int min) {int axint ay...[] LValuesCoded;int LCodedCodingMethod tokenDfltint FDefint UDefint TDefint TDefLCodingMethod[] FCodeCodingMethod[] TCodeCodingMethod[] UCodepop.L// Note:  {f} is allFavoredValues[1..fvlen], not [0..fvlen-1].// This is because zero is an exceptional favored value index.// must be empty// reassert// Find the smallest B s.t. (B,H,0) covers fVlen.// H/L do not matter when B==1// failure; L is too sharp and fVlen too large// shorten it by reducing B// Otherwise, it's a non-default coding.// Make a local copy before reordering.// Resort favoredValues within each byte-size cadre.// skip initial zero// Divide the values into cadres, and sort within each.// For the single-byte encoding, keep strict order// among frequency groups.// Find a single inflection point// close to the middle of the byte-size cadre.// Sort up to the midpoint, if any.// Reset symtab.// Compute token sequence.// Compute unfavored value sequence.// reset// already covered// Index by value:// repeat the last favored value, using delta=0// else repeat the shorter of the min or last value// (remember that fVlen is an inclusive limit in fValues)// Parameters are fCode, L, uCode.// Read the tokens.  Read them into the final array, for the moment.// Decode the favored tokens.// Make a linked list, and decode in a second pass.// Walk the linked list of "zero" locations, decoding unfavored vals.// realloc as needed// The set uniqueValuesForDebug records all favored values.// As each new value is added, we assert that the value// was not already in the set.// farthest from the center//int min2 = Integer.MIN_VALUE;  // emulate buggy 150.7 spec.//min2 = moreCentral2(min2, val, min);// Read a new value://|| val == min2//min2 = moreCentral(min2, val);// bias kx/ky to get an unsigned comparison:// assert that this ALU-ish version is the same://x is MIN_VALUE//y is MIN_VALUE// At this point the absolute values agree, and the negative wins.// A simple L value is enough to recover the tokenCoding.// might be -1// might be null!import PrintWriter/** Control block for publishing Pack200 options to the other classes. */new TreeMap<String,String>(...)Properties propsHashMap<String,String> tempnew HashMap<>(...)Utils.DEBUG_DISABLE_NATIVEPack200.Packer.TRUEInputStream propStrEntry<Object,Object> eTreeMap<String,String> theMap;List<Object> listenerList;// type is erased, elements are of type java.beans.PropertyChangeListenerisPropertyChangeListener(...)// Override:String oldValueObject eventnewPropertyChangeEvent(...)isBeansPresent(...)Object listenerinvokePropertyChange(...)Map<String,String> defaultProps;// get by with generic SortedMap functionality.// Outide clients of Pack200 do not need to use it; they can// All this other stuff is private to the current package.// the map is sorted, and has a subMap accessor.// that begin with the given prefix.  This is easy because// Return a view of this map which includes only propertieschar nextchString limitsubMap(...)// Get sequence of props for "prefix", and "prefix.*".Collection<String> valuesList<String> restoBoolean(...)toInteger(...)Pack200.Packer.FALSEparseLong(...)toLong(...)String svallong lvallong recentSecondCountUtils.NOWcurrentTimeMillis(...)PrintWriter outwnew PrintWriter(...)Set<Entry<String,String>> defaultsMap<>.Entry<String,String>Entry<String,String> econtainsValue(...)comparator(...)tailMap(...)firstKey(...)/** A class that provides access to the java.beans.PropertyChangeListener ... */Class<?> propertyChangeListenerClass;Class<?> propertyChangeEventClass;Method propertyChangeMethod;Constructor<?> propertyEventCtor;NoSuchMethodException x/** Returns {@code true} if java.beans is present. *//** Returns {@code true} if the given object is a PropertyChangeListener *//** Returns a new PropertyChangeEvent with the given source, property ... */ReflectiveOperationException x/** Invokes the given PropertyChangeListener's propertyChange method ... */// Post the property change event.// Allow implementation selected via -Dpack.disable.native=true// Set the DEBUG_VERBOSE from system// Set the PACK_TIMEZONE_NO_UTC// The segment size is unlimited// Preserve file ordering by default.// Preserve all modification times by default.// Preserve deflation hints by default.// Pass through files with unrecognized attributes by default.// Pass through files with unrecognized format by default, also// allow system property to be set// Default effort is 5, midway between 1 and 9.// Define certain attribute layouts by default.// Do this after the previous props are put in place,// to allow override if necessary.// shrink to fit//System.out.println(prefix+" => "+subMap(prefix, limit));import MethodTypeEntryimport InvokeDynamicEntry/* This class provides a container to hold the global variables, for packer ... */PropMap props;// Global environmentMap<String,Utf8Entry> utf8Entries;// Needed by ConstantPool.javaMap<String,ClassEntry> classEntries;Map<Object,LiteralEntry> literalEntries;Map<String,SignatureEntry> signatureEntries;Map<String,DescriptorEntry> descriptorEntries;Map<String,MemberEntry> memberEntries;Map<String,MethodHandleEntry> methodHandleEntries;Map<String,MethodTypeEntry> methodTypeEntries;Map<String,InvokeDynamicEntry> invokeDynamicEntries;Map<String,BootstrapMethodEntry> bootstrapMethodEntries;new HashMap<String,Utf8Entry>(...)new HashMap<String,ClassEntry>(...)new HashMap<Object,LiteralEntry>(...)new HashMap<String,SignatureEntry>(...)new HashMap<String,DescriptorEntry>(...)new HashMap<String,MemberEntry>(...)new HashMap<String,MethodHandleEntry>(...)new HashMap<String,MethodTypeEntry>(...)new HashMap<String,InvokeDynamicEntry>(...)new HashMap<String,BootstrapMethodEntry>(...)new PropMap(...)/* Copyright (c) 2010, 2012, Oracle and/or its affiliates. All rights reserved. ... */import CheckedOutputStreamObject _nunp;// Back-pointer to NativeUnpacker, when active.getVersionString(...)/** Takes a packed-stream InputStream, and writes to a JarOutputStream. Internally ... */// The unpack worker...isJarMagic(...)new JarInputStream(...)new DoUnpack(...)markJarFile(...)new NativeUnpack(...)LinkageError ex/** Takes an input File containing the pack file, and generates a JarOutputStream. ... */FileInputStream instrnew CheckedOutputStream(...)// Here's where the bits are read from disk:boolean deflateHint;CRC32 crc;// Checksum apparatus.ByteArrayOutputStream bufOut;OutputStream crcOut;int segunpackSegment(...)Set<Class> classesToWritenew HashSet<Class>(...)new PackageReader(...)ensureAllClassFiles(...)new JarEntry(...)boolean deflateboolean needCRCgetStubClass(...)new ClassWriter(...)JarEntry.STORED// failover to java implementation// Use the stream-based implementation.// %%% Reconsider if native unpacker learns to memory-map the file.// Try to get another segment.// Process the output directory or jar output.// Now write out the files.// STORE mode requires CRC// for an error check// collect data & maybe CRC// Convert back to milliseconds// reset for the next segment, if anyimport Datenew ThreadLocal<TLGlobals>(...)new Pack200Logger(...)String COM_PREFIX;String METAINF;String DEBUG_VERBOSE;/* Outputs various diagnostic support information. ... */String DEBUG_DISABLE_NATIVE;/* Disables use of native code, prefers the Java-coded implementation. ... */String PACK_DEFAULT_TIMEZONE;/* Use the default working TimeZone instead of UTC. ... */String UNPACK_MODIFICATION_TIME;/* Property indicating that the unpacker should ... */String UNPACK_STRIP_DEBUG;/* Property indicating that the unpacker strip the ... */String UNPACK_REMOVE_PACKFILE;/* Remove the input file after unpacking. ... */String NOW;/* A possible value for MODIFICATION_TIME */String PACK_KEEP_CLASS_ORDER;/* If this property is set to {@link #TRUE}, the packer will preserve ... *///   com...no.big.strings=false   turn off "big string" feature//   com...no.vary.codings=false  turn off coding variation heuristics//   com...dump.bands=false       dump band contents to local disk//   com...debug.bands=false      add band IDs to pack file, to verify sync// Other debug options:String PACK_ZIP_ARCHIVE_MARKER_COMMENT;/* This string PACK200 is given as a zip comment on all JAR files ... */String CLASS_FORMAT_ERROR;/* behaviour when we hit a class format error, but not necessarily ... */ThreadLocal<TLGlobals> currentInstance;// to the engine code, especially the native code.// This makes it simpler to supply environmental options// Keep a TLS point to the global data and environment.TimeZone tz;int workingPackerCount;// convenience method to access the TL globals(...).propsboolean nolog;boolean SORT_MEMBERS_DESCR_MAJOR;boolean SORT_HANDLES_KIND_MAJOR;boolean SORT_INDY_BSS_MAJOR;boolean SORT_BSS_BSM_MAJOR;PlatformLogger log;getLogger(...)setDefault(...)getTimeZone(...)Pack200Logger log;// Returns the Max Version String of this implementationConstants.MAX_PACKAGE_VERSIONsetComment(...)// -0 mode helperZipEntry meInputStream einnew NonCloser(...)JarOutputStream jout// Wrapper to prevent closing of client-supplied stream.int storegetCompressedSize(...)getCrc(...)magic.length// magic number recognizers// only first thread saves default TZ// reset timezone when all the packer/unpacker instances have terminated// add PACK200 comment// 4947205 : Peformance is slow when using pack-effort=0// protect from JarOutputStream.close()// Follow unzip -lv output// read 1 byte at a time, so we always get 4// fourth byte is variable "flg" field/** Thrown to indicate line number or variable information is not available. ... *//** Provides information on the accessibility of a type or type component. ... *//** Returns the Java<sup><font size=-2>TM</font></sup> ... *//** Determines if this object mirrors a private item. ... *//** Determines if this object mirrors a package private item. ... *//** Determines if this object mirrors a protected item. ... *//** Determines if this object mirrors a public item. ... *//** Provides access to an array object and its components in the target VM. ... *//** Returns the number of components in this array. ... *//** Returns an array component value. ... *//** Returns all of the components in this array. ... *//** Returns a range of array components. ... *//** Replaces an array component with another value. ... *//** Replaces all array components with other values. If the given ... *//** Replaces a range of array components with other values. ... *//** Provides access to the class of an array and the type of ... *//** Creates a new instance of this array class in the target VM. ... *//** Gets the JNI signature of the components of this ... *//** Returns a text representation of the component ... *//** Returns the component type of this array, ... *//** The type of all primitive <code>boolean</code> values ... *//** Provides access to a primitive <code>boolean</code> value in ... *//** Returns this BooleanValue as a boolean. ... *//** Compares the specified Object with this BooleanValue for equality. ... *//** Returns the hash code value for this BooleanValue. ... *//** Initial class that provides access to the default implementation ... *//** Returns the virtual machine manager. ... */virtualMachineManager(...)/** The type of all primitive byte values accessed in ... *//** Provides access to a primitive <code>byte</code> value in the target VM. ... *//** Returns this ByteValue as a <code>byte</code>. ... *//** Compares the specified Object with this ByteValue for equality. ... *//** The type of all primitive char values accessed in ... *//** Provides access to a primitive <code>char</code> value in ... *//** Returns this CharValue as a <code>char</code>. ... *//** Compares the specified Object with this CharValue for equality. ... *//** Returns the hash code value for this CharValue. ... *//** A class loader object from the target VM. ... *//** Returns a list of all loaded classes that were defined by this ... *//** Returns a list of all classes for which this class loader has ... *//** Thrown to indicate that the requested class has ... *//** Thrown to indicate that the requested operation cannot be ... *//** An instance of java.lang.Class from the target VM. ... *//** Returns the {@link ReferenceType} corresponding to this ... *//** A mirror of a class in the target VM. A ClassType is a refinement ... *//** Gets the superclass of this class. ... *//** Gets the interfaces directly implemented by this class. ... *//** Gets the interfaces directly and indirectly implemented ... *//** Gets the currently loaded, direct subclasses of this class. ... *//** Determine if this class was declared as an enum. ... *//** Assigns a value to a static field. ... *//** Perform method invocation with only the invoking thread resumed *//** Invokes the specified static {@link Method} in the ... *//** Constructs a new instance of this type, using ... *//** Returns a the single non-abstract {@link Method} visible from ... *//** The type of all primitive double values accessed in ... *//** Provides access to a primitive <code>double</code> value in ... *//** Returns this DoubleValue as a <code>double</code>. ... *//** Compares the specified Object with this DoubleValue for equality. ... *//** Returns the hash code value for this DoubleValue. ... *//** A class or instance variable in the target VM. ... *//** Returns a text representation of the type ... *//** Returns the type of this field. ... *//** Determine if this is a transient field. ... *//** Determine if this is a volatile field. ... *//** Determine if this is a field that represents an enum constant. ... *//** Compares the specified Object with this field for equality. ... *//** Returns the hash code value for this Field. ... *//** The type of all primitive float values accessed in ... *//** Provides access to a primitive <code>float</code> value in ... *//** Returns this FloatValue as a float. ... *//** Compares the specified Object with this FloatValue for equality. ... *//** Returns the hash code value for this FloatValue. ... *//** Thrown to indicate that there is an inconistency in the debug ... *//** The type of all primitive <code>int</code> values ... *//** Provides access to a primitive <code>int</code> value in ... *//** Returns this IntegerValue as an int. ... *//** Compares the specified Object with this IntegerValue for equality. ... *//** Returns the hash code value for this IntegerValue. ... *//** A mirror of an interface in the target VM. An InterfaceType is ... *//** Gets the interfaces directly extended by this interface. ... *//** Gets the currently prepared interfaces which directly extend this ... *//** Gets the currently prepared classes which directly implement this ... *//** Thrown to indicate that an unexpected internal error has ... */int errorCode;this.errorCode/** Thrown to indicate a type mismatch in setting the value of a field ... *//** Thrown to indicate an exception occurred in an invoked method within ... */ObjectReference exception;this.exception/** The <code>JDIPermission</code> class represents access rights to ... *//** The <code>JDIPermission</code> class represents access rights to the ... *//** Constructs a new JDIPermission object. ... *//** A local variable in the target VM. Each variable declared within a ... *//** Gets the name of the local variable. ... *//** Returns the type of this variable. ... *//** Gets the JNI signature of the local variable. ... *//** Gets the generic signature for this variable if there is one. ... *//** Determines whether this variable can be accessed from the given ... *//** Determines if this variable is an argument to its method. ... *//** Compares the specified Object with this LocalVariable for equality. ... *//** Returns the hash code value for this LocalVariable. ... *//** A mirror that has a {@link Location}. ... *//** Returns the {@link Location} of this mirror, if there ... *//** A point within the executing code of the target VM. ... *//** Gets the type to which this Location belongs. Normally ... *//** Gets the method containing this Location. ... *//** Gets the code position within this location's method. ... *//** Gets an identifing name for the source corresponding to ... *//** Gets the path to the source corresponding to this ... *//** Gets the line number of this Location. ... *//** The line number of this Location.  The line number is ... *//** Compares the specified Object with this Location for equality. ... *//** Returns the hash code value for this Location. ... *//** The type of all primitive <code>long</code> values ... *//** Provides access to a primitive <code>long</code> value in ... *//** Returns this LongValue as a long. ... *//** Compares the specified Object with this LongValue for equality. ... *//** Returns the hash code value for this LongValue. ... *//** A static or instance method in the target VM. See {@link TypeComponent} ... *//** Returns a text representation of the return type, ... *//** Returns the return type, ... *//** Returns a list containing a text representation of the type ... *//** Returns a list containing the type ... *//** Determine if this method is abstract. ... *//** Determine if this method is a default method ... *//** Determine if this method is synchronized. ... *//** Determine if this method is native. ... *//** Determine if this method accepts a variable number of arguments. ... *//** Determine if this method is a bridge method. Bridge ... *//** Determine if this method is a constructor. ... *//** Determine if this method is a static initializer. ... *//** Determine if this method is obsolete. ... *//** Returns a list containing a {@link Location} object for ... *//** Returns a List containing all {@link Location} objects ... *//** Returns a {@link Location} for the given code index. ... *//** Returns a list containing each {@link LocalVariable} declared ... *//** Returns a list containing each {@link LocalVariable} of a ... *//** Returns a list containing each {@link LocalVariable} that is ... *//** Returns an array containing the bytecodes for this method. ... *//** Returns the {@link Location} of this method, if there ... *//** Compares the specified Object with this method for equality. ... *//** Returns the hash code value for this Method. ... *//** A proxy used by a debugger to examine or manipulate some entity ... *//** Gets the VirtualMachine to which this ... *//** Returns a String describing this mirror ... *//** Information about a monitor owned by a thread. ... *//** Returns the {@link ObjectReference} object for the monitor. ... *//** Returns the stack depth at which this monitor was ... *//** Returns a {@link ThreadReference} object for the thread that ... *//** Thrown to indicate an operation cannot be completed because ... *//** An object that currently exists in the target VM. An ObjectReference ... *//** Gets the {@link ReferenceType} that mirrors the type ... *//** Gets the value of a given instance or static field in this object. ... *//** Gets the value of multiple instance and/or static fields in this object. ... *//** Sets the value of a given instance or static field in this object. ... *//** Perform non-virtual method invocation *//** Invokes the specified {@link Method} on this object in the ... *//** Prevents garbage collection for this object. By default all ... *//** Determines if this object has been garbage collected in the target ... *//** Returns a unique identifier for this ObjectReference. ... *//** Returns a List containing a {@link ThreadReference} for ... *//** Returns an {@link ThreadReference} for the thread, if any, ... *//** Returns the number times this object's monitor has been ... *//** Compares the specified Object with this ObjectReference for equality. ... *//** Returns the hash code value for this ObjectReference. ... *//** A virtual machine which searches for classes through paths ... *//** Get the class path for this virtual machine. ... *//** Get the boot class path for this virtual machine. ... *//** Get the base directory used for path searching. Relative directories ... *//** The type associated with non-object values in a target VM. ... *//** The value assigned to a field or variable of primitive type in a ... *//** Converts this value to a BooleanValue and returns the result ... *//** Converts this value to a ByteValue and returns the result ... *//** Converts this value to a CharValue and returns the result ... *//** Converts this value to a ShortValue and returns the result ... *//** Converts this value to an IntegerValue and returns the result ... *//** Converts this value to a LongValue and returns the result ... *//** Converts this value to a FloatValue and returns the result ... *//** Converts this value to a DoubleValue and returns the result ... *//** The type of an object in a target VM. ReferenceType encompasses ... *//** Gets the fully qualified name of this type. The returned name ... *//** Gets the generic signature for this type if there is one. ... *//** Gets the classloader object which loaded the class corresponding ... *//** Gets an identifying name for the source corresponding to the ... *//** Gets the identifying names for all the source corresponding to the ... *//** Gets the paths to the source corresponding to the ... *//** Get the source debug extension of this type. ... *//** Determines if this type was declared static. Only nested types, ... *//** Determines if this type was declared abstract. ... *//** Determines if this type was declared final. ... *//** Determines if this type has been prepared. See the JVM ... *//** Determines if this type has been verified. See the JVM ... *//** Determines if this type has been initialized. See the JVM ... *//** Determines if initialization failed for this class. See the JVM ... *//** Returns a list containing each {@link Field} declared in this type. ... *//** Returns a list containing each unhidden and unambiguous {@link Field} ... *//** Returns a list containing each {@link Field} declared in this type, ... *//** Finds the visible {@link Field} with the given ... *//** Returns a list containing each {@link Method} declared ... *//** Returns a list containing each {@link Method} ... *//** Returns a list containing each {@link Method} declared in this type, ... *//** Returns a List containing each visible {@link Method} that ... *//** Returns a List containing {@link ReferenceType} objects that are ... *//** Gets the {@link Value} of a given static {@link Field} in this type. ... *//** Returns a map containing the {@link Value} of each ... *//** Returns the class object that corresponds to this type in the ... *//** Returns a list containing a {@link Location} object ... *//** Return the available strata for this reference type. ... *//** Returns the default stratum for this reference type. ... *//** Returns instances of this ReferenceType. ... *//** Compares the specified Object with this ReferenceType for equality. ... *//** Returns the class major version number, as defined in the class file format ... *//** Returns the class minor version number, as defined in the class file format ... *//** Returns the number of entries in the constant pool plus one. ... *//** Returns the raw bytes of the constant pool in the format of the ... *//** The type of all primitive <code>short</code> values ... *//** Provides access to a primitive <code>short</code> value in ... *//** Returns this ShortValue as a short. ... *//** Compares the specified Object with this ShortValue for equality. ... *//** Returns the hash code value for this ShortValue. ... *//** The state of one method invocation on a thread's call stack. ... *//** Returns the {@link Location} of the current instruction in the frame. ... *//** Returns the thread under which this frame's method is running. ... *//** Returns the value of 'this' for the current frame. ... *//** Returns a list containing each {@link LocalVariable} ... *//** Finds a {@link LocalVariable} that matches the given name and is ... *//** Gets the {@link Value} of a {@link LocalVariable} in this frame. ... *//** Returns the values of multiple local variables in this frame. ... *//** Sets the {@link Value} of a {@link LocalVariable} in this frame. ... *//** Returns the values of all arguments in this frame.  Values are ... *//** A string object from the target VM. ... *//** Returns the StringReference as a String. The returned string ... *//** A thread group object from the target VM. ... *//** Returns the name of this thread group. ... *//** Returns the parent of this thread group. ... *//** Suspends all threads in this thread group. Each thread ... *//** Resumes all threads in this thread group. Each thread ... *//** Returns a List containing a {@link ThreadReference} for each live thread ... *//** Returns a List containing each active {@link ThreadGroupReference} in this ... *//** A thread object from the target VM. ... */int THREAD_STATUS_UNKNOWN;/** Thread status is unknown */int THREAD_STATUS_ZOMBIE;/** Thread has completed execution */int THREAD_STATUS_RUNNING;/** Thread is runnable */int THREAD_STATUS_SLEEPING;/** Thread is sleeping - Thread.sleep() or JVM_Sleep() was called */int THREAD_STATUS_MONITOR;/** Thread is waiting on a java monitor */int THREAD_STATUS_WAIT;/** Thread is waiting - Object.wait() or JVM_MonitorWait() was called */int THREAD_STATUS_NOT_STARTED;/** Thread has not yet been started *//** Returns the name of this thread. ... *//** Suspends this thread. The thread can be resumed through ... *//** Resumes this thread. If this thread was not previously suspended ... *//** Returns the number of pending suspends for this thread. See ... *//** Stops this thread with an asynchronous exception. ... *//** Interrupts this thread unless the thread has been suspended by the ... *//** Returns the thread's status. If the thread is not suspended the ... *//** Determines whether the thread has been suspended by the ... *//** Determines whether the thread is suspended at a breakpoint. ... *//** Returns this thread's thread group. ... *//** Returns the number of stack frames in the thread's current ... *//** Returns a List containing each {@link StackFrame} in the ... *//** Returns the {@link StackFrame} at the given index in the ... *//** Returns a List containing a range of {@link StackFrame} mirrors ... *//** Returns a List containing an {@link ObjectReference} for ... *//** Returns a List containing a {@link MonitorInfo} object for ... *//** Returns an {@link ObjectReference} for the monitor, if any, ... *//** Pop stack frames. ... *//** The mirror for a type in the target VM. ... *//** Returns the JNI-style signature for this type. ... *//** An entity declared within a user defined ... *//** Gets the name of this type component. ... *//** Gets the JNI-style signature for this type component. The ... *//** Gets the generic signature for this TypeComponent if there is one. ... *//** Returns the type in which this component was declared. The ... *//** Determines if this TypeComponent is static. ... *//** Determines if this TypeComponent is final. ... *//** Determines if this TypeComponent is synthetic. Synthetic members ... *//** Thrown to indicate that the operation is invalid because it would ... *//** Unchecked exception thrown to indicate that the ... *//** The mirror for a value in the target VM. ... *//** Returns the run-time type of this value. ... */import EventRequestManager/** A virtual machine targeted for debugging. ... *//** Returns the loaded reference types that ... *//** Returns all loaded types. For each loaded type in the target ... *//** All classes given are redefined according to the ... *//** Returns a list of the currently running threads. For each ... *//** Suspends the execution of the application running in this ... *//** Continues the execution of the application running in this ... *//** Returns each thread group which does not have a parent. For each ... *//** Returns the event queue for this virtual machine. ... *//** Returns the event request manager for this virtual machine. ... *//** Creates a {@link BooleanValue} for the given value. This value ... *//** Creates a {@link ByteValue} for the given value. This value ... *//** Creates a {@link CharValue} for the given value. This value ... *//** Creates a {@link ShortValue} for the given value. This value ... *//** Creates an {@link IntegerValue} for the given value. This value ... *//** Creates a {@link LongValue} for the given value. This value ... *//** Creates a {@link FloatValue} for the given value. This value ... *//** Creates a {@link DoubleValue} for the given value. This value ... *//** Creates a string in this virtual machine. ... *//** Creates a {@link VoidValue}.  This value ... *//** Returns the {@link java.lang.Process} object for this ... *//** Causes the mirrored VM to terminate with the given error code. ... *//** Determines if the target VM supports watchpoints ... *//** Determines if the target VM supports the retrieval ... *//** Determines if the target VM supports the query ... *//** Determines if the target VM supports filtering ... *//** Determines if the target VM supports any level ... *//** Determines if the target VM supports the addition ... *//** Determines if the target VM supports unrestricted ... *//** Determines if the target VM supports popping ... *//** Determines if the target VM supports getting ... *//** Determines if the target VM supports the creation of ... *//** Determines if the target VM supports the inclusion of return values ... *//** Determines if the target VM supports the accessing of class instances, ... *//** Determines if the target VM supports the filtering of ... *//** Determines if the target VM supports the forcing of a method to ... *//** Determines if the target VM is a read-only VM.  If a method which ... *//** Determines if the target VM supports getting which ... *//** Determines if the target VM supports reading class file ... *//** Determines if the target VM supports getting constant pool ... *//** Set this VM's default stratum (see {@link Location} for a ... *//** Return this VM's default stratum. ... *//** Returns the number of instances of each ReferenceType in the 'refTypes' ... *//** Returns text information on the target VM and the ... *//** Returns the version of the Java Runtime Environment in the target ... *//** Returns the name of the target VM as reported by the ... */int TRACE_NONE;/** All tracing is disabled. */int TRACE_SENDS;/** Tracing enabled for JDWP packets sent to target VM. */int TRACE_RECEIVES;/** Tracing enabled for JDWP packets received from target VM. */int TRACE_EVENTS;/** Tracing enabled for internal event handling. */int TRACE_REFTYPES;/** Tracing enabled for internal managment of reference types. */int TRACE_OBJREFS;/** Tracing enabled for internal management of object references. */int TRACE_ALL;/** All tracing is enabled. *//** Traces the activities performed by the com.sun.jdi implementation. ... */import com.sun.jdi.connect.*import Connection/** A manager of connections to target virtual machines. The ... *//** Identifies the default connector. This connector should ... *//** Returns the list of known {@link com.sun.jdi.connect.LaunchingConnector} objects. ... *//** Returns the list of known {@link com.sun.jdi.connect.AttachingConnector} objects. ... *//** Returns the list of known {@link com.sun.jdi.connect.ListeningConnector} objects. ... *//** Returns the list of all known {@link com.sun.jdi.connect.Connector} objects. ... *//** Lists all target VMs which are connected to the debugger. ... *//** Returns the major version number of the JDI interface. ... *//** Returns the minor version number of the JDI interface. ... *//** Create a virtual machine mirror for a target VM. ... *//** Creates a new virtual machine. ... *//** The type of all primitive <code>void</code> values ... *//** Provides access to a primitive <code>void</code> value in ... *//** Compares the specified Object with this VoidValue for equality. ... *//** Returns the hash code value for this VoidValue. ... */import VirtualMachine/** A connector which attaches to a previously running target VM. ... *//** Attaches to a running application and and returns a ... *//** A method of connection between a debugger and a target VM. ... *//** Returns a short identifier for the connector. Connector implementors ... *//** Returns a human-readable description of this connector ... *//** Returns the transport mechanism used by this connector to establish ... *//** Returns the arguments accepted by this Connector and their ... *//** Specification for and value of a Connector argument. ... *//** Returns a short, unique identifier for the argument. ... *//** Returns a short human-readable label for this argument. ... *//** Returns a human-readable description of this argument ... *//** Returns the current value of the argument. Initially, the ... *//** Sets the value of the argument. ... *//** Performs basic sanity check of argument. ... *//** Indicates whether the argument must be specified. If true, ... *//** Specification for and value of a Connector argument, ... *//** Sets the value of the argument. *//** Return the string representation of the <code>value</code> ... *//** Return the value of the argument as a boolean.  Since ... *//** Return the value of the argument as a int.  Since ... *//** The upper bound for the value. ... *//** The lower bound for the value. ... *//** Return the possible values for the argument ... *//** Thrown to indicate an invalid argument or ... */List<String> names;/** Construct an <code>IllegalConnectorArgumentsException</code> ... */this.names/** Return a <code>List</code> containing the names of the ... *//** A connector which can launch a target VM before connecting to it. ... *//** Launches an application and connects to its VM. Properties ... *//** A connector which listens for a connection initiated by a target VM. ... *//** Indicates whether this listening connector supports multiple ... *//** Listens for one or more connections initiated by target VMs. ... *//** Cancels listening for connections. The given argument map should match ... *//** Waits for a target VM to attach to this connector. ... */import TransportService/** A method of communication between a debugger and a target VM. ... */// for javadoc/** Returns a short identifier for the transport. ... *//** This exception may be thrown as a result of a timeout ... *//** Constructs a <tt>TransportTimeoutException</tt> with no detail ... *//** Constructs a <tt>TransportTimeoutException</tt> with the ... *//** A target VM was successfully launched, but terminated with an ... */Process process;this.process/** This package defines connections between the virtual machine ... *//** This exception may be thrown as a result of an asynchronous ... *//** Constructs a <tt>ClosedConnectionException</tt> with no detail ... *//** Constructs a <tt>ClosedConnectionException</tt> with the ... *//** A connection between a debugger and a target VM which it debugs. ... *//** Reads a packet from the target VM. ... *//** Writes a packet to the target VM. ... *//** Closes this connection. ... *//** Tells whether or not this connection is open.  </p> ... */import TransportTimeoutException/** A transport service for connections between a debugger and ... *//** Returns a name to identify the transport service. ... *//** Returns a description of the transport service. ... *//** The transport service capabilities. *//** Tells whether or not this transport service can support ... *//** Tell whether or not this transport service supports a timeout ... *//** Tell whether or not this transport service supports a ... *//** Tells whether or not this transport service supports a ... *//** Returns the capabilities of the transport service. ... *//** Attaches to the specified address. ... *//** A <i>listen key</i>. ... *//** Returns a string representation of the listen key. *//** Listens on the specified address for inbound connections. ... *//** Listens on an address chosen by the transport service. ... *//** Stop listening for inbound connections. ... *//** Accept a connection from a target VM. ... *//** This package comprises the interfaces and classes used to ... *//** Notification of a field access in the target VM. Field modifications ... *//** Notification of a breakpoint in the target VM. ... *//** Returns the thread in which this event has occurred. ... *//** Returns the reference type for which this event was generated. ... *//** Returns the name of the class that has been unloaded. *//** Returns the JNI-style signature of the class that has been unloaded. */import EventRequest/** An occurrence in a target VM that is of interest to a debugger. Event is ... *//** EventIterators are unmodifiable. ... *//** Manager of incoming debugger events for a target VM. ... *//** Waits forever for the next available event. ... *//** Waits a specified time for the next available event. ... *//** Several {@link Event} objects may be created at a given time by ... *//** Returns the policy used to suspend threads in the target VM ... *//** Return an iterator specific to {@link Event} objects. *//** Resumes threads suspended by this event set. If the {@link #suspendPolicy} ... *//** Notification of an exception in the target VM. When an exception ... *//** Gets the thrown exception object. The exception object is ... *//** Gets the location where the exception will be caught. An exception ... *//** Abstract superinterface of events which have both location ... *//** Returns the method that was entered. ... *//** Returns the method that was exited. ... *//** Returns the value that the method will return. ... *//** Notification of a field modification in the ... *//** Value that will be assigned to the field when the instruction ... *//** Notification that a thread in the target VM is entering a monitor ... *//** Returns the monitor that was entered. ... *//** Notification that a thread in the target VM is about to ... *//** Returns the thread in which monitor wait event has occurred. ... *//** Returns the monitor object that the thread about to wait. ... *//** Returns the number of millisecond the thread will wait. ... *//** Notification that a thread in the target VM has finished ... *//** Returns the monitor object this thread waited on. ... *//** Returns whether the wait has timed out or been interrupted. ... *//** Notification of step completion in the target VM. ... *//** Returns the thread which is terminating. ... *//** Returns the thread which has started. ... *//** Notification of target VM termination. ... *//** Notification of disconnection from target VM. ... *//** Returns the initial thread of the VM which has started. ... *//** Notification of a field triggered event encountered by a thread in the ... *//** Returns the field that is about to be accessed/modified. ... *//** Returns the object whose field is about to be accessed/modified. ... *//** Current value of the field. ... *//** This package defines JDI events and event processing. ... *//** This is the core package of the Java Debug ... *//** Request for notification when the contents of a field are accessed ... *//** Identifies a {@link Location} in the target VM at which ... *//** Returns the location of the requested breakpoint. ... *//** Restricts the events generated by this request to those in ... *//** Request for notification when a class is prepared in the target VM. ... *//** Restricts the events generated by this request to be the ... *//** Restricts the events generated by this request to the ... *//** Request for notification when a class is unloaded in the target VM. ... *//** Thrown to indicate a duplicate event request. ... *//** Represents a request for notification of an event.  Examples include ... *//** Determines if this event request is currently enabled. ... *//** Enables or disables this event request. While this event request is ... *//** Same as {@link #setEnabled <CODE>setEnabled(true)</CODE>}. ... *//** Same as {@link #setEnabled <CODE>setEnabled(false)</CODE>}. ... */int SUSPEND_NONE;/** Suspend no threads when the event occurs */int SUSPEND_EVENT_THREAD;/** Suspend only the thread which generated the event when the event occurs */int SUSPEND_ALL;/** Suspend all threads when the event occurs *//** Determines the threads to suspend when the requested event occurs ... *//** Returns a value which describes the threads to suspend when the ... *//** Add an arbitrary key/value "property" to this request. ... *//** Returns the value of the property with the specified key.  Only ... *//** Manages the creation and deletion of {@link EventRequest}s. A single ... *//** Creates a new disabled {@link ClassPrepareRequest}. ... *//** Creates a new disabled {@link ClassUnloadRequest}. ... *//** Creates a new disabled {@link ThreadStartRequest}. ... *//** Creates a new disabled {@link ThreadDeathRequest}. ... *//** Creates a new disabled {@link ExceptionRequest}. ... *//** Creates a new disabled {@link MethodEntryRequest}. ... *//** Creates a new disabled {@link MethodExitRequest}. ... *//** Creates a new disabled {@link MonitorContendedEnterRequest}. ... *//** Creates a new disabled {@link MonitorContendedEnteredRequest}. ... *//** Creates a new disabled {@link MonitorWaitRequest}. ... *//** Creates a new disabled {@link MonitorWaitedRequest}. ... *//** Creates a new disabled {@link StepRequest}. ... *//** Creates a new disabled {@link BreakpointRequest}. ... *//** Creates a new disabled watchpoint which watches accesses to the ... *//** Creates a new disabled {@link VMDeathRequest}. ... *//** Removes an eventRequest. The eventRequest is disabled and ... *//** Removes a list of {@link EventRequest}s. ... *//** Remove all breakpoints managed by this EventRequestManager. ... *//** Return an unmodifiable list of the enabled and disabled step requests. ... *//** Return an unmodifiable list of the enabled and disabled class prepare requests. ... *//** Return an unmodifiable list of the enabled and disabled class unload requests. ... *//** Return an unmodifiable list of the enabled and disabled thread start requests. ... *//** Return an unmodifiable list of the enabled and disabled thread death requests. ... *//** Return an unmodifiable list of the enabled and disabled exception requests. ... *//** Return an unmodifiable list of the enabled and disabled breakpoint requests. ... *//** Return an unmodifiable list of the enabled and disabled access ... *//** Return an unmodifiable list of the enabled and disabled modification ... *//** Return an unmodifiable list of the enabled and disabled method entry requests. ... *//** Return an unmodifiable list of the enabled and disabled method exit requests. ... *//** Return an unmodifiable list of the enabled and disabled monitor contended enter requests. ... *//** Return an unmodifiable list of the enabled and disabled monitor contended entered requests. ... *//** Return an unmodifiable list of the enabled and disabled monitor wait requests. ... *//** Return an unmodifiable list of the enabled and disabled monitor waited requests. ... *//** Return an unmodifiable list of the enabled and disabled VM death requests. ... *//** Request for notification when an exception occurs in the target VM. ... *//** Returns exception type for which exception events are requested. ... *//** Returns whether caught exceptions of the requested type ... *//** Returns whether uncaught exceptions of the requested type ... *//** Restricts the events generated by this request to those whose ... *//** Restricts the events generated by this request to those ... *//** Thrown to indicate that the requested event cannot be modified ... *//** Request for notification when a method is invoked in the target VM. ... *//** Request for notification when a method returns in the target VM. ... *//** Request for notification when a field is set. ... *//** Request for notification of a thread in the target VM ... *//** Request for notification of a thread in the target VM entering a monitor ... *//** Request for notification when a thread in the target VM is about to ... *//** Request for notification when a thread in the target VM has finished waiting on ... *//** Request for notification when a step occurs in the target VM. ... */int STEP_INTO;/** Step into any newly pushed frames */int STEP_OVER;/** Step over any newly pushed frames */int STEP_OUT;/** Step out of the current frame */int STEP_MIN;/** Step to the next available location */int STEP_LINE;/** Step to the next location on a different line *//** Request for notification when a thread terminates in the target VM. ... *//** Request for notification when a thread starts execution in the target VM. ... *//** Request for notification when the target VM terminates. ... *//** Identifies a {@link Field} in the target VM being watched. ... *//** Gets the Field being watched by this WatchpointRequest. ... *//** This package is used to request that a JDI ... */import Logger/** This contains the property list defined for this ... */// private constructor defined to "hide" the default public constructorString JMX_INITIAL_BUILDER;/** References the property that specifies the directory where ... *///------------------------// PUBLIC STATIC CONSTANTSString MLET_LIB_DIR;String JMX_SPEC_NAME;/** References the property that specifies the full name of the JMX ... */String JMX_SPEC_VERSION;/** References the property that specifies the version of the JMX ... */String JMX_SPEC_VENDOR;/** References the property that specifies the vendor of the JMX ... */String JMX_IMPL_NAME;/** References the property that specifies the full name of this product ... */String JMX_IMPL_VENDOR;/** References the property that specifies the name of the vendor of this ... */String JMX_IMPL_VERSION;/** References the property that specifies the version of this product ... */String MBEANSERVER_LOGGER_NAME;/** Logger name for MBean Server information. */Logger MBEANSERVER_LOGGER;/** Logger for MBean Server information. */String MLET_LOGGER_NAME;/** Logger name for MLet service information. */Logger MLET_LOGGER;/** Logger for MLet service information. */String MONITOR_LOGGER_NAME;/** Logger name for Monitor information. */Logger MONITOR_LOGGER;/** Logger for Monitor information. */String TIMER_LOGGER_NAME;/** Logger name for Timer information. */Logger TIMER_LOGGER;/** Logger for Timer information. */String NOTIFICATION_LOGGER_NAME;/** Logger name for Event Management information. */Logger NOTIFICATION_LOGGER;/** Logger for Event Management information. */String RELATION_LOGGER_NAME;/** Logger name for Relation Service. */Logger RELATION_LOGGER;/** Logger for Relation Service. */String MODELMBEAN_LOGGER_NAME;/** Logger name for Model MBean. */Logger MODELMBEAN_LOGGER;/** Logger for Model MBean. */String MISC_LOGGER_NAME;/** Logger name for all other JMX classes. */Logger MISC_LOGGER;/** Logger for all other JMX classes. */String SNMP_LOGGER_NAME;/** Logger name for SNMP. */Logger SNMP_LOGGER;/** Logger for SNMP. */String SNMP_ADAPTOR_LOGGER_NAME;/** Logger name for SNMP Adaptor. */Logger SNMP_ADAPTOR_LOGGER;/** Logger for SNMP Adaptor. *//* Copyright (c) 1999, 2007, Oracle and/or its affiliates. All rights reserved. ... *//** Used for storing default values used by JMX services. ... */String DELEGATE;/** The object name of the MBeanServer delegate object ... */String MLET;/** The default key properties for registering the class loader of the ... */String DOMAIN;/** The default domain. ... *//** The name of the JMX specification implemented by this product. ... *//** The version of the JMX specification implemented by this product. ... *//** The vendor of the JMX specification implemented by this product. ... *//** The name of this product implementing the  JMX specification. ... *//** The name of the vendor of this product implementing the ... *//* Copyright (c) 1999, 2008, Oracle and/or its affiliates. All rights reserved. ... */import static JmxProperties.MBEANSERVER_LOGGERimport DynamicMBean2import MBeanInstantiatorimport ModifiableClassLoaderRepositoryimport NamedObjectimport Repositoryimport RegistrationContextimport Utilimport EnvHelpimport ObjectInputStreamimport Permissionimport ProtectionDomainimport Levelimport Attributeimport AttributeListimport AttributeNotFoundExceptionimport DynamicMBeanimport InstanceAlreadyExistsExceptionimport InstanceNotFoundExceptionimport InvalidAttributeValueExceptionimport JMRuntimeExceptionimport ListenerNotFoundExceptionimport MBeanExceptionimport MBeanInfoimport MBeanPermissionimport MBeanRegistrationimport MBeanRegistrationExceptionimport MBeanServerimport MBeanServerDelegateimport MBeanServerNotificationimport MBeanTrustPermissionimport NotCompliantMBeanExceptionimport Notificationimport NotificationBroadcasterimport NotificationEmitterimport NotificationFilterimport NotificationListenerimport ObjectInstanceimport ObjectNameimport OperationsExceptionimport QueryEvalimport QueryExpimport ReflectionExceptionimport RuntimeErrorExceptionimport RuntimeMBeanExceptionimport RuntimeOperationsExceptionimport ClassLoaderRepository/** This is the default class for MBean manipulation on the agent side. It ... */new WeakHashMap<ListenerWrapper,WeakReference<ListenerWrapper>>(...)new HashSet<ObjectName>(...)MBeanInstantiator instantiator;/** The MBeanInstantiator object used by the ... */MBeanServer server;/** The MBean server object that is associated to the ... */MBeanServerDelegate delegate;/** The MBean server delegate object that is associated to the ... */Repository repository;/** The Repository object used by the DefaultMBeanServerInterceptor */WeakHashMap<ListenerWrapper,WeakReference<ListenerWrapper>> listenerWrappers;/* See the comment before addNotificationListener below. *//** Wrappers for client listeners. */String domain;/** The default domain of the object names *//** Creates a DefaultMBeanServerInterceptor with the specified ... */// private int sequenceNumber=0;// Now sequence number is handled by MBeanServerDelegate./** The sequence number identifying the notifications sent */this.serverthis.delegatethis.instantiatorthis.repositorythis.domaingetDefaultDomain(...)createMBean(...)InstanceNotFoundException eClass<?> theClassObject moiString infoClassNamegetNewMBeanClassName(...)RuntimeException wrappednew RuntimeOperationsException(...)isPattern(...)String msgnonDefaultDomain(...)checkMBeanPermission(...)isLoggable(...)Level.FINERlogp(...)findClassWithDefaultLoaderRepository(...)checkMBeanTrustPermission(...)testCreation(...)checkCompliance(...)registerObject(...)DynamicMBean mbeangetClassName(...)getMBeanInfo(...)NotCompliantMBeanException ncmbenew NotCompliantMBeanException(...)Set<ObjectName> beingUnregistered;new MBeanRegistrationException(...)exclusiveUnregisterMBean(...)DynamicMBean instancegetMBean(...)Object resourceResourceContext contextunregisterFromRepository(...)preDeregisterInvoke(...)postDeregisterInvoke(...)done(...)String classNamenew ObjectInstance(...)SecurityManager smSet<ObjectInstance> listqueryMBeansImpl(...)Set<ObjectInstance> allowedListnew HashSet<ObjectInstance>(...)ObjectInstance oigetObjectName(...)filterListOfObjectInstances(...)Set<NamedObject> listquery(...)objectInstancesFromFilteredNamedObjects(...)Set<ObjectName> queryListSet<ObjectInstance> queryObjectInstanceListqueryNamesImpl(...)objectNamesFromFilteredNamedObjects(...)String[] domainsgetDomains(...)List<String> resultdomains.lengthObjectName domnewObjectName(...)AttributeNotFoundException eThrowable trethrowMaybeMBeanException(...)String[] allowedAttributesString classnameList<String> allowedListattributes.lengthString attrrethrow(...)InvalidAttributeValueException eAttributeList allowedAttributesnew AttributeList(...)Attribute attribute/* Centralize some of the tedious exception wrapping demanded by the JMX ... */ReflectionException eRuntimeOperationsException eRuntimeErrorException enew RuntimeMBeanException(...)Error enew RuntimeErrorException(...)Throwable t2/** Register <code>object</code> in the repository, with the ... */makeDynamicMBean(...)registerDynamicMBean(...)ObjectName logicalNamepreRegister(...)boolean registeredboolean registerFailedpreRegister2(...)registerWithRepository(...)postRegister(...)ObjectName newNamethrowMBeanRegistrationException(...)registerFailed(...)Error erpreDeregister(...)postDeregister(...)/** Gets a specific MBean controlled by the DefaultMBeanServerInterceptor. ... */DynamicMBean objretrieve(...)new InstanceNotFoundException(...)String completeNamegetDomain(...)/* Notification handling. ... */NotificationBroadcaster broadcastergetNotificationBroadcaster(...)NotificationListener listenerWrappergetListenerWrapper(...)addNotificationListener(...)getCanonicalName(...)removeNotificationListener(...)NotificationListener instancegetListener(...)new ListenerNotFoundException(...)RuntimeException excClass<? extends NotificationBroadcaster> reqClassNotificationEmitter emitterDynamicMBean moiMBeanInfo mbiRuntimeMBeanException enew JMRuntimeException(...)String resourceClassNameClassLoader clClass<?> classNameClassClass<?> resourceClassException xLevel.FINEST/** <p>Return the {@link java.lang.ClassLoader} that was used for ... *//** <p>Return the named {@link java.lang.ClassLoader}. ... *//** Sends an MBeanServerNotifications with the specified type for the ... */MBeanServerNotification notifnew MBeanServerNotification(...)MBeanServerDelegate.DELEGATE_NAMEsendNotification(...)/** Applies the specified queries to the set of NamedObjects. */Set<ObjectName> resultNamedObject noMBeanServer oldServergetMBeanServer(...)setMBeanServer(...)boolean resapply(...)Set<ObjectInstance> resultsafeGetClassName(...)/** Applies the specified queries to the set of ObjectInstances. *//* Get the existing wrapper for this listener, name, and mbean, if ... */ListenerWrapper wrappernew ListenerWrapper(...)WeakReference<ListenerWrapper> refNotificationListener existingnew WeakReference<ListenerWrapper>(...)this.mbeanhandleNotification(...)ListenerWrapper ww.listenerw.mbeanw.nameNotificationListener listener;ObjectName name;Object mbean;//----------------// SECURITY CHECKSPermission permnew MBeanPermission(...)new MBeanTrustPermission(...)PrivilegedAction<ProtectionDomain> actgetProtectionDomain(...)ProtectionDomain pdAccessControlContext accnew AccessControlContext(...)new ProtectionDomain[]/** A RegistrationContext that makes it possible to perform additional ... */// ------------------------------------------------------------------// Dealing with registration of special MBeans in the repository.ResourceContext NONE;/** An empty ResourceContext which does nothing * *//** Adds a MBean in the repository, ... */makeResourceContextFor(...)addMBean(...)MBeanServerNotification.REGISTRATION_NOTIFICATION/** Removes a MBean in the repository, ... */MBeanServerNotification.UNREGISTRATION_NOTIFICATION/** Registers a ClassLoader with the CLR. ... */ModifiableClassLoaderRepository clrgetInstantiatorCLR(...)addClassLoader(...)/** Unregisters a ClassLoader from the CLR. ... */removeClassLoader(...)/** Creates a ResourceContext for a ClassLoader MBean. ... *//** Creates a ResourceContext for the given resource. ... */createClassLoaderContext(...)ResourceContext.NONEgetClassLoaderRepository(...)// JMX RI// JMX import/* Can only happen if loaderName doesn't exist, but we just ... *//* Load the appropriate class. */// Check that the MBean can be instantiated by the MBeanServer.// Check the JMX MBean compliance of the class// ------------------------------// Includes case where getMBeanInfo() returns null/* The semantics of preDeregister are tricky.  If it throws an ... */// pretend the exception came from preDeregister;// in another execution sequence it could have// may throw InstanceNotFoundException// Unregisters the MBean from the repository.// Returns the resource context that was used.// The returned context does nothing for regular MBeans.// For ClassLoader MBeans and JMXNamespace (and JMXDomain)// MBeans - the context makes it possible to unregister these// objects from the appropriate framework artifacts, such as// the CLR or the dispatcher, from within the repository lock.// In case of success, we also need to call context.done() at the// end of this method.// Check if the caller has the right to invoke 'queryMBeans'// Perform query without "query".// on each specific classname/objectname in the list.// OK: Do not add this ObjectInstance to the list// Apply query to allowed MBeans only.// Perform query.// Query the MBeans on the repository// Check if the caller has the right to invoke 'queryNames'/* No Permission check */// isRegistered is always unchecked as per JMX spec.// Check if the caller has the right to invoke 'getDomains'// Return domains// on each specific domain in the list.// OK: Do not add this domain to the list// Make an array from result.// not reached// Check if the caller has the right to invoke 'getAttribute'// on each specific attribute// OK: Do not add this attribute to the list// Check if the caller has the right to invoke 'setAttribute'// preRegister returned successfully, so from this point on we// must call postRegister(false) if there is any problem.// until we succeed// Register the MBean with the repository.// For ClassLoader MBeans the context makes it possible to register these// objects with the appropriate framework artifacts, such as// the CLR, from within the repository lock.// neither Error nor Exception??/* The ObjectName looks like ":a=b", and that's what its ... */// ------------------// Check listener// ----------------// Get listener object// Add a listener on an MBean/* We could simplify the code by assigning broadcaster after ... *//* Could be SecurityException or ClassNotFoundException *//* Check if the given MBean is a ClassLoader */// ---------------------// Create notification// No query ...// Access the filter/* query.setMBeanServer is probably ... */// Null query.// Access the filter./* Listeners are not supposed to throw exceptions.  If ... *//* We compare all three, in case the same MBean object ... *//* We do not include name.hashCode() in the hash because ... */// Creates a registration context, if needed.// May throw InstanceAlreadyExistsException// Send create event// Send deletion event/** Called when the newly registered MBean is a ClassLoader ... *//** Removes the  MBean from the default loader repository. *//** <p>This interface specifies the behavior to be implemented by an ... *//** This method should never be called. ... *//* Copyright (c) 2002, 2008, Oracle and/or its affiliates. All rights reserved. ... */import Hashtableimport PrivateClassLoaderimport ReflectUtil/** This class keeps the list of Class Loaders registered in the MBean Server. ... */new Hashtable<String,List<ClassLoader>>(...)new Hashtable<ObjectName,ClassLoader>(...)new LoaderEntry[]/* We associate an optional ObjectName with each entry so that ... */ClassLoader loader;// can be null...[] EMPTY_LOADER_ARRAY;...[] loaders;/** List of class loaders ... *//** Same behavior as add(Object o) in {@link java.util.List}. ... */List<LoaderEntry> lnew ArrayList<LoaderEntry>(...)new LoaderEntry(...)/** Same behavior as remove(Object o) in {@link java.util.List}. ... */loaders.lengthLoaderEntry entryentry.loaderentry.nameLoaderEntry[] newloadersMap<String,List<ClassLoader>> search;/** List of valid search */Map<ObjectName,ClassLoader> loadersWithNames;/** List of named class loaders. */// from javax.management.loading.DefaultLoaderRepositoryloadClass(...)startValidSearch(...)stopValidSearch(...)list.length...[...].loadernew ClassNotFoundException(...)List<ClassLoader> excludednew ArrayList<ClassLoader>(...)ClassLoader instance// without is null => just behave as loadClass// We must try to load the class without the given loader.// bootstrap class loader/* We used to have a special case for "instanceof ... */// OK: continue with next class// Check if we have such a current search// Add an entry// Retrieve the search.import InvalidObjectExceptionimport Descriptorimport OpenDataExceptionimport OpenTypenew ConvertingMethod(...)OpenDataException odedescriptorForElement(...)getGenericReturnType(...)getOpenType(...)OpenType<?>[] typesnew OpenType<?>[]paramMappings.length/* Check that this method will be callable when we are going from ... */MXBeanMapping paramConvertercheckReconstructible(...)InvalidObjectException eString[] siggetOpenClass(...)toOpenValue(...)fromOpenValue(...)Object[] oparamsObject[] jparamsMXBeanLookup oldgetLookup(...)setLookup(...)invokeWithOpenReturn(...)Object[] javaParamsObject javaReturnfromOpenParameters(...)methodName(...)new MBeanException(...)OpenDataException eMXBeanMappingFactory mappingFactoryMXBeanMappingFactory.DEFAULTboolean identitymappingForType(...)new MXBeanMapping[]isIdentity(...)Method method;MXBeanMapping returnMapping;...[] paramMappings;boolean paramConversionIsIdentity;// probably can't happenimport static Util.*import static MXBeanIntrospector.typeNameimport static SimpleType.*import Annotationimport ElementTypeimport Proxyimport BitSetimport SortedSetimport TreeSetimport JMXimport ArrayTypeimport CompositeDataimport CompositeDataInvocationHandlerimport CompositeDataSupportimport CompositeDataViewimport CompositeTypeimport SimpleTypeimport TabularDataimport TabularDataSupportimport TabularType/** <p>A converter between Java types and the limited set of classes ... */new Mappings(...)newList(...)OpenType<?>[] simpleTypessimpleTypes.lengthOpenType<?> tClass<?> cMXBeanMapping mappingnew IdentityMapping(...)putPermanentMapping(...)Field typeFieldClass<?> primitiveTypeMXBeanMapping primitiveMappingClass<?> primitiveArrayTypeOpenType<?> primitiveArrayOpenTypegetPrimitiveArrayType(...)MXBeanMapping primitiveArrayMappingNoSuchFieldException enewIdentityHashMap(...)fromNonNullOpenValue(...)toNonNullOpenValue(...)/** <p>True if and only if this MXBeanMapping's toOpenValue and ... */Mappings mappings;List<MXBeanMapping> permanentMappings;/** Following List simply serves to keep a reference to predefined ... */WeakReference<MXBeanMapping> wrnew WeakReference<MXBeanMapping>(...)putMapping(...)/** Get the converter for the given Java type, creating it if necessary. */new OpenDataException(...)typeName(...)getMapping(...)makeMapping(...)openDataException(...)Type componentTypemakeArrayOrCollectionMapping(...)Class<?> objClassisEnum(...)makeEnumMapping(...)isMXBeanInterface(...)makeMXBeanRefMapping(...)makeCompositeMapping(...)makeParameterizedTypeMapping(...)new EnumMapping<T>(...)/* Make the converter for an array type, or a collection such as ... */MXBeanMapping elementMappingOpenType<?> elementOpenTypeArrayType<?> openTypegetArrayType(...)Class<?> elementOpenClassClass<?> openArrayClassString openArrayClassNamenew CollectionMapping(...)new ArrayMapping(...)...[] keyArray;...[] keyValueArray;String objTypeNameMXBeanMapping keyMappingMXBeanMapping valueMappingOpenType<?> keyOpenTypeOpenType<?> valueOpenTypeCompositeType rowTypenew CompositeType(...)TabularType tabularTypenew TabularType(...)new TabularMapping(...)/* We know how to translate List<E>, Set<E>, SortedSet<E>, ... */Type rawTypeList<>.classSet<>.classSortedSet<>.classmustBeComparable(...)boolean sortedMapSortedMap<>.classMap<>.classmakeTabularMapping(...)new MXBeanRefMapping(...)boolean gcInfoHackeliminateCovariantMethods(...)SortedMap<String,Method> getterMapnewSortedMap(...)int nitemsMethod[] gettersString[] itemNamesOpenType<?>[] openTypesCompositeType compositeTypepropertyName(...)Method olddecapitalize(...)Entry<String,Method> entryMap<>.Entry<String,Method>Method getterType retTypenew CompositeMapping(...)/* Converter for classes where the open data is identical to the ... */SimpleType<>.STRINGthis.enumClassinvalidObjectException(...)Class<T> enumClass;this.elementMappingObject[] valueArrayvalueArray.lengthObject[] openArrayType javaTypegetJavaType(...)openArray.lengthMXBeanMapping elementMapping;/** DefaultMXBeanMappingFactory for the elements of this array.  If this is an ... */Type rawClass<?> collCArrayList<>.classHashSet<>.classTreeSet<>.classCollection<?> valueCollectionComparator<?> comparatorCollection<Object> valueCollectionnew InvalidObjectException(...)Class<? extends Collection<?>> collectionClass;SimpleType<>.OBJECTNAMEMXBeanLookup lookuplookupNotNull(...)ObjectName namemxbeanToObjectName(...)Object mxbeanobjectNameToMXBean(...)T excConstructor<T> conthis.sortedMapthis.keyMappingthis.valueMappingMap<Object,Object> valueMapTabularData tablenew TabularDataSupport(...)getRowType(...)Entry<Object,Object> entryObject openKeyObject openValueCompositeData rownew CompositeDataSupport(...)Collection<CompositeData> rowsnewInsertionOrderMap(...)boolean sortedMap;MXBeanMapping keyMapping;MXBeanMapping valueMapping;itemNames.lengthgetters.lengththis.itemNamesthis.gettersthis.getterMappingsCompositeType cttoCompositeData(...)Object got/** Determine how to convert back from the CompositeData into ... */Class<?> targetClassCompositeBuilder[][] buildersnew CompositeBuilder[][]new CompositeBuilderViaFrom(...)new CompositeBuilderViaConstructor(...)new CompositeBuilderCheckGetters(...)new CompositeBuilderViaSetters(...)new CompositeBuilderViaProxy(...)CompositeBuilder foundBuilderStringBuilder whyNotsThrowable possibleCauseCompositeBuilder[] relatedBuildersrelatedBuilders.lengthCompositeBuilder builderString whyNotapplicable(...)possibleCause(...)makeCompositeBuilder(...)fromCompositeData(...)...[] itemNames;...[] getters;...[] getterMappings;CompositeBuilder compositeBuilder;/** Converts from a CompositeData to an instance of the targetClass. */this.targetClass/** If the subclass is appropriate for targetClass, then the ... *//** If the subclass returns an explanation of why it is not applicable, ... */Class<?> targetClass;/** Builder for when the target class has a method "public static ... */getTargetClass(...)Method fromMethodthis.fromMethodMethod fromMethod;/** This builder never actually returns success.  It simply serves ... */this.getterConverters...[] getterConverters;Throwable possibleCause;/** Builder for when the target class has a setter for every getter. */Method[] settersConstructor<?> cClass<?> returnTypeString setterNameMethod setterthis.settersObject openItemObject javaItem...[] setters;/** Builder for when the target class has a constructor that is ... */findConstructorPropertiesClass(...)Class<? extends Annotation> constructorPropertiesClass;Method valueMethod;ClassNotFoundException cnfAnnotation agetAnnotation(...)isAvailable(...)Constructor<?>[] constrsList<Constructor<?>> annotatedConstrListMap<String,Integer> getterMapnewMap(...)getItemNames(...)Set<BitSet> getterIndexSetsnewSet(...)Constructor<?> constrgetPropertyNames(...)String[] propertyNamesType[] paramTypesint[] paramIndexesBitSet presentnew BitSet(...)Constr cnew Constr(...)paramTypes.lengthpropertyNames.lengthint getterIndexType propertyTypeString getterNameBitSet aboolean seenBitSet bBitSet uor(...)Set<String> namesnew TreeSet<String>(...)nextSetBit(...)getCompositeType(...)Constr maxObject[] paramscardinality(...)max.presentParamsConstr constrsubset(...)constr.presentParamsmax.paramIndexesmax.constructorBitSet subcopyandNot(...)Constructor<?> constructor;...[] paramIndexes;BitSet presentParams;this.constructorthis.paramIndexesthis.presentParamsList<Constr> annotatedConstructors;/** Builder for when the target class is an interface and contains ... */Set<Method> methodsString mnameClass<?>[] mparamsMethod omnewProxyInstance(...)new CompositeDataInvocationHandler(...)Comparable<>.class/** Utility method to take a string and convert it to normal Java variable ... */int offset1offsetByCodePoints(...)isUpperCase(...)codePointAt(...)/** Reverse operation for java.beans.Introspector.decapitalize.  For any s, ... */String restgetParameterTypes(...).lengthMap<Type,Type> inProgress;/* Set up the mappings for Java types that map to SimpleType. */// the classes that these predefined types declare must exist!// OK: must not be a primitive wrapper// Should not reach here/* It's not yet worth formalizing these tests by having for example ... */// Huge hack to avoid compiler warnings here.  The ElementType// parameter is ignored but allows us to obtain a type variable// T that matches <T extends Enum<T>>.// For historical reasons GcInfo implements CompositeData but we// shouldn't count its CompositeData.getCompositeType() field as// an item in the computed CompositeType./* Select public methods that look like "T getX()" or "boolean ... */// field names// field descriptions/* Determine the concrete class to be used when converting ... */// can't happen/* In this 2D array, each subarray is a set of builders where ... *//* We try to make a meaningful exception message by ... */// skip other builders in this group// See if it has a method "T from(CompositeData)"// as is conventional for a CompositeDataView// success!// OK: it doesn't have the method// java.beans not present// should not reach here// Applicable if and only if there are any annotated constructors// Now check that all the annotated constructors are valid// and throw an exception if not.// First link the itemNames to their getter indexes.// Run through the constructors making the checks in the spec.// For each constructor, remember the correspondence between its// parameters and the items.  The int[] for a constructor says// what parameter index should get what item.  For example,// if element 0 is 2 then that means that item 0 in the// CompositeData goes to parameter 2 of the constructor.  If an// element is -1, that item isn't given to the constructor.// Also remember the set of properties in that constructor// so we can test unambiguity./* Check that no possible set of items could lead to an ambiguous ... */// The CompositeData might come from an earlier version where// not all the items were present.  We look for a constructor// that accepts just the items that are present.  Because of// the ambiguity check in applicable(), we know there must be// at most one maximally applicable constructor./* If the interface has any methods left over, they better be ... *//* We don't catch SecurityException since it shouldn't ... */// Should be name.offsetByCodePoints but 6242664 makes this fail// really an IdentityHashSet but that doesn't existimport ImmutableDescriptornew WeakHashMap<ImmutableDescriptor,WeakReference<ImmutableDescriptor>>(...)new DescriptorCache(...)WeakReference<ImmutableDescriptor> wrImmutableDescriptor gotnew WeakReference<ImmutableDescriptor>(...)DescriptorCache instance;WeakHashMap<ImmutableDescriptor,WeakReference<ImmutableDescriptor>> map;/** A dynamic MBean that wraps an underlying resource.  A version of this ... *//** The resource corresponding to this MBean.  This is the object whose ... *//** The name of this MBean's class, as used by permission checks. ... *//** Additional registration hook.  This method is called after ... *//** Additional registration hook.  This method is called if preRegister ... *//** Utility class to be used by the method <tt>AccessControler.doPrivileged</tt> ... *//* Copyright (c) 2002, 2004, Oracle and/or its affiliates. All rights reserved. ... */import AnnotatedElementimport UndeclaredThrowableExceptionimport DescriptorKey/** This class contains the methods for performing all the tests needed to verify ... */parseBoolean(...)boolean ALLOW_NONPUBLIC_MBEAN;/* ------------------------------------------ ... *//** Tell whether a MBean of the given class is a Dynamic MBean. ... *//** Basic method for testing that a MBean of a given class can be ... */int modsConstructor<?>[] consListconsList.lengthException mbeanExceptionException mxbeanExceptiongetStandardMBeanInterface(...)NotCompliantMBeanException egetMXBeanInterface(...)Class<?> mbeanClassClass<? super T> cnew StandardMBeanSupport(...)new MXBeanSupport(...)/** Basic method for testing if a given class is a JMX compliant MBean. ... */isDynamic(...)testCompliance(...)/** Tests the given interface class for being a compliant MXBean interface. ... */getAnalyzer(...)/** Tests the given interface class for being a compliant MBean interface. ... *//** Basic method for testing if a given class is a JMX compliant ... */MBeanIntrospector<?> introspectorgetClassMBeanInfo(...)PerInterface<M> perInterfacegetPerInterface(...)/** Get the MBean interface implemented by a JMX Standard ... *//** Get the MBean interface implemented by a JMX Standard MBean class. ... */Class<? super T> currentClass<? super T> mbeanInterfacefindMBeanInterface(...)/** Get the MXBean interface implemented by a JMX MXBean class. ... */findMXBeanInterface(...)/** Try to find the MBean interface corresponding to the class aName ... */Class<?>[] interfacesgetInterfaces(...)Class<? super T> interimplementsMBean(...)Annotation[] annotsgetAnnotations(...)ImmutableDescriptor.EMPTY_DESCRIPTORdescriptorForAnnotations(...)Map<String,Object> descriptorMapannots.lengthClass<? extends Annotation> cannotationType(...)Method[] elementsboolean packageAccessMethod elementDescriptorKey keyvalue(...)new UndeclaredThrowableException(...)annotationToField(...)new ImmutableDescriptor(...)/** Throws a NotCompliantMBeanException or a SecurityException. ... */String reasonNotCompliantMBeanException res// will produce a Descriptor field value "java.lang.String"// E.g. with @interface Foo {class value()} an annotation @Foo(String.class)// Convert a value from an annotation element to a descriptor field valueObject[] xxString[] ssxx.lengthisProxyClass(...)// often so this inefficient check should be enough.// ImmutableDescriptor.union.  But we don't expect to be called very// This must be consistent with the check for duplicate field values indeepEquals(...)/** Returns the XXMBean interface or null if no such interface exists ... */String clMBeanNameClass<?> clazzObject biObject[] pdsObject pdnew AttributeNotFoundException(...)/** A simple introspector that uses reflection to analyze a class and ... */new WeakHashMap<Class<?>,SoftReference<List<Method>>>(...)String GET_METHOD_PREFIX;String IS_METHOD_PREFIX;Map<Class<?>,SoftReference<List<Method>>> cache;// cache to avoid repeated lookups/** Returns the list of methods cached for the given class, or {@code null} ... */SoftReference<List<Method>> refList<Method> cached/** Returns {@code true} if the given method is a "getter" method (where ... */Class<?>[] paramTypesint paramCount/** Returns the list of "getter" methods for the given class. The list ... */List<Method> cachedResultgetCachedMethods(...)List<Method> resultnew LinkedList<Method>(...)isReadMethod(...)new SoftReference<List<Method>>(...)/** Returns the "getter" to read the given property from the given class or ... */String getMethodString isMethodgetReadMethods(...)/** A class that provides access to the JavaBeans Introspector and ... */Class<>.classClass<?> introspectorClass;Class<?> beanInfoClass;Class<?> getPropertyDescriptorClass;Method getBeanInfo;Method getPropertyDescriptors;Method getPropertyName;Method getReadMethod;/** Returns {@code true} if java.beans is available. *//** Invokes java.beans.Introspector.getBeanInfo(Class) *//** Invokes java.beans.BeanInfo.getPropertyDescriptors() *//** Invokes java.beans.PropertyDescriptor.getName() *//** Invokes java.beans.PropertyDescriptor.getReadMethod() */// Check if the MBean implements the DynamicMBean interface// Check if the class is a concrete class// Check if the MBean has a public constructor// Is DynamicMBean?// Is Standard MBean?// Is MXBean?// Ignore exception - we need to check whether// mbean is an MXBean first.// Ignore exception - we cannot decide whether mbean was supposed// to be an MBean or an MXBean. We will call checkCompliance()// to generate the appropriate exception.// Check if the MBean implements the MBean or the Dynamic// MBean interface// Check if the given class implements the MBean interface// or the Dynamic MBean interface// Avoid checking access more than once per annotation// we don't expect this - except for possibly// security exceptions?// RuntimeExceptions shouldn't be "UndeclaredThrowable".// anyway...// we don't expect this// An annotation element cannot have a null value but never mind// Remaining possibilities: array of primitive (e.g. int[]),// enum, class, array of enum or class.// The only other possibility is that the value is another// annotation, or that the language has evolved since this code// was written.  We don't allow for either of those currently.// If it is indeed another annotation, then x will be a proxy// with an unhelpful name like $Proxy2.  So we extract the// proxy's interface to use that in the exception message.// array "can't be empty"// Java Beans introspection// Java Beans not available so use simple introspection// to locate method// return cached methods if possible// ignore static methods// boolean isXXX()// getXXX()// return cached result if available// get list of public methods, filtering out methods that have// been overridden to return a more specific type.// filter out the non-getter methods// favor isXXX over getXXX// add result to cache// first character in uppercase (compatibility with JavaBeans)import DefaultMBeanServerInterceptorimport MBeanServerInterceptorimport PrivilegedExceptionActionimport MBeanServerPermission/** This is the base class for MBean manipulation on the agent side. It ... */boolean DEFAULT_FAIR_LOCK_POLICY;/** Control the default locking policy of the repository. ... */SecureClassLoaderRepository secureClr;boolean interceptorsEnabled;/** true if interceptors are enabled * */MBeanServer outerShell;MBeanServer mbsInterceptor;MBeanServerDelegate mBeanServerDelegateObject;/** The MBeanServerDelegate object representing the MBean Server *//** <b>Package:</b> Creates an MBeanServer with the ... *//** <b>Package:</b> Creates an MBeanServer. ... */MBeanInstantiator fInstantiatorRepository repositorynew Repository(...)new ClassLoaderRepositorySupport(...)new MBeanInstantiator(...)this.secureClrnew SecureClassLoaderRepository(...)new MBeanServerDelegateImpl(...)this.mBeanServerDelegateObjectthis.outerShellthis.mbsInterceptornew DefaultMBeanServerInterceptor(...)this.interceptorsEnabled/** Tell whether {@link MBeanServerInterceptor}s are enabled on this ... *//** Return the MBeanInstantiator associated to this MBeanServer. ... *//** Instantiates and registers an MBean in the MBean server. ... */cloneObjectName(...)/** Registers a pre-existing object as an MBean with the MBean server. ... */registerMBean(...)/** De-registers an MBean from the MBean server. The MBean is identified by ... */unregisterMBean(...)/** Gets the <CODE>ObjectInstance</CODE> for a given MBean registered ... */getObjectInstance(...)/** Gets MBeans controlled by the MBean server. This method allows any ... */queryMBeans(...)/** Gets the names of MBeans controlled by the MBean server. This method ... */queryNames(...)/** Checks whether an MBean, identified by its object name, is already ... */isRegistered(...)/** Returns the number of MBeans registered in the MBean server. */getMBeanCount(...)/** Gets the value of a specific attribute of a named MBean. The MBean ... *//** Enables the values of several attributes of a named MBean. The MBean ... *//** Sets the value of a specific attribute of a named MBean. The MBean ... */cloneAttribute(...)/** Sets the values of several attributes of a named MBean. The MBean is ... */cloneAttributeList(...)/** Invokes an operation on an MBean. ... *//** Returns the default domain used for naming the MBean. ... */// From MBeanServer/** Adds a listener to a registered MBean. ... *//** This method discovers the attributes and operations that an MBean exposes ... *//** Instantiates an object using the list of all class loaders registered ... *//** Instantiates an object using the class Loader specified by its ... */ClassLoader myLoader/** Instantiates an object. The class loader to be used is identified ... *//** Returns true if the MBean specified is an instance of the specified ... */isInstanceOf(...)/** De-serializes a byte array in the context of the class loader ... */getClassLoaderFor(...)deserialize(...)/** De-serializes a byte array in the context of a given MBean class loader. ... */ClassLoaderRepository clrnew ReflectionException(...)/** Initializes this MBeanServer, registering the MBeanServerDelegate. ... */ModifiableClassLoaderRepository loadersClassLoader systemLoader/** Return the MBeanServerInterceptor. ... *//** Set the MBeanServerInterceptor. ... *//** <p>Return the ClassLoaderRepository for that MBeanServer. ... *//** This method creates a new MBeanServerDelegate for a new MBeanServer. ... */// These methods are called by the JMX MBeanServerBuilder./** This method creates a new MBeanServer implementation object. ... */boolean fairLockcheckNewMBeanServerPermission(...)new JmxMBeanServer(...)/** Clone object name. *///-------------------// JMX OBJECT CLONING/** Clone attribute. *//** Clone attribute list. */List<Attribute> alistAttributeList newListnew MBeanServerPermission(...)/* Permission check */// This call requires MBeanPermission 'getClassLoaderFor'// This call requires MBeanPermission 'getClassLoaderRepository'// Clone ObjectName// Make this call just to force the 'getClassLoader'// permission check// Registers the MBeanServer identification MBean/* Add my class loader to the repository ... *//* Add the system class loader, so that if the MBean server is ... */// Determine whether to use fair locking for the repository.// Default is true.// This constructor happens to disregard the value of the interceptors// flag - that is, it always uses the default value - false.// This is admitedly a bug, but we chose not to fix it for now// since we would rather not have anybody depending on the Sun private// interceptor APIs - which is most probably going to be removed and// replaced by a public (javax) feature in the future.// Create new attribute list// Iterate through list and replace non JMX attributesimport MBeanServerBuilder/** This class represents a builder that creates ... */newMBeanServerDelegate(...)newMBeanServer(...)/** <p>An analyzer for a given MBean interface.  The analyzer can ... */Entry<String,AttrMethods<M>> entryMap<>.Entry<String,AttrMethods<M>>AttrMethods<M> amvisitAttribute(...)am.getteram.setterEntry<String,List<M>> entryMap<>.Entry<String,List<M>>M mvisitOperation(...)Map<String,List<M>> opMap;/* Map op name to method */Map<String,AttrMethods<M>> attrMap;/* Map attr name to getter and/or setter */M getter;M setter;// same interface.// an analyzer will not be recreated for a second MBean using the// cached PerInterface object for an MBean interface means that// really impacts proxy generation.  For MBean creation, the// Currently it's two different but equivalent objects.  This only/** <p>Return an MBeanAnalyzer for the given MBean interface and ... */new MBeanAnalyzer<M>(...)Introspector.ALLOW_NONPUBLIC_MBEANinitMaps(...)// Introspect the mbeanInterface and initialize this object's maps.List<Method> methods1int nParamsM cmmFrom(...)String attrNamenew AttrMethods<M>(...)List<M> cmsconsistent(...)/** A comparator that defines a total order so that methods have the ... */new MethodOrder(...)Class<?>[] aparamsClass<?>[] bparamsClass<?> aretClass<?> bretaparams.lengthbparams.lengthMethodOrder instance;/* Eliminate methods that are overridden with a covariant return type. ... */Method[] sortedSet<Method> overriddenMethodOrder.instanceMethod m0Method m1// visit attributes// visit operations/* Run through the methods to detect inconsistencies and to enable ... */// It's a getter// Check we don't have both isX and getX// It's a setter// It's an operation/* Check that getters and setters are consistent. */// Super type comes first: Object, Number, Integer// could assert bret.isAssignableFrom(aret)// We are assuming that you never have very many methods with the// same name, so it is OK to use algorithms that are quadratic// in the number of methods with the same name.// Methods that don't have the same name can't override each other// Methods that have the same name and same signature override// each other. In that case, the second method overrides the first,// due to the way we have sorted them in MethodOrder.import Permissionsimport ConstructorUtil/** Implements the MBeanInstantiator interface. Provides methods for ... */ModifiableClassLoaderRepository clr;//    private MetaData meta = null;this.clr/** This methods tests if the MBean class makes it possible to ... *//** Loads the class with the specified name using this object's ... */ClassNotFoundException ee/** Gets the class for the specified class name using the MBean ... *//** Gets the class for the specified class name using the specified ... *//** Return an array of Class corresponding to the given signature, using ... */ClassLoader aLoadersignature.lengthClass<?>[] tabClass<?> primCla/** Instantiates an object given its class, using its empty constructor. ... */Constructor<?> consensureClassAccess(...)getTargetException(...)NoSuchMethodError errorInstantiationException e/** Instantiates an object given its class, the parameters and ... */findSignatureClasses(...)Throwable th/** De-serializes a byte array in the context of a classloader. ... */ByteArrayInputStream bInObjectInputStream objInnew ObjectInputStreamWithLoader(...)new OperationsException(...)/** Instantiates an object. The class loader to be used is identified by its ... *//** Return the Default Loader Repository used by this instantiator object. *//** Load a class with the specified loader, or with this object ... *//** Load the classes specified in the signature with the given loader, ... */Map<String,Class<?>> primitiveClasses;new IllegalAccessException(...)Permissions permissionsnew Permissions(...)ProtectionDomain protectionDomainnew ProtectionDomain(...)ProtectionDomain[] domainsAccessControlContext ctx// Retrieve the class loader from the repository// Start handling primitive types (int. boolean and so// forth)// Ok we do not have a primitive type ! We need to build// the signature of the method// We need to load the class through the class// loader of the target object.// Load through the default class loader// Instantiate the new object// Wrap the exception.// Build the signature of the method// Exception IllegalArgumentException raised in Jdk1.1.8// Query the metadata service to get the right constructor// Check parameter validity// Object deserialization// Load the class using the agent class loader// Get the class loader MBean// Restrict to getClassLoader permission onlyimport MBeanAttributeInfoimport MBeanConstructorInfoimport MBeanNotificationInfoimport MBeanOperationInfo/* Using a type parameter <M> allows us to deal with the fact that ... *//** An introspector for MBeans of a certain type.  There is one instance ... *//** The map from interface to PerInterface for this type of MBean. *//** The map from concrete implementation class and interface to ... *//** Make an interface analyzer for this type of MBean. *//** True if MBeans with this kind of introspector are MXBeans. *//** Find the M corresponding to the given Method. *//** Get the name of this method. *//** Get the return type of this method.  This is the return type ... *//** Get the parameter types of this method in the Java interface ... *//** Get the signature of this method as a caller would have to supply ... *//** Check that this method is valid.  For example, a method in an ... *//* It would be cleaner if the type of the cookie were a ... *//** Invoke the method with the given target and arguments. ... *//** Test whether the given value is valid for the given parameter of this ... *//** Construct an MBeanAttributeInfo for the given attribute based on the ... *//** Construct an MBeanOperationInfo for the given operation based on ... *//** Get a Descriptor containing fields that MBeans of this kind will ... *//** Get a Descriptor containing additional fields beyond the ones ... *//** Get the methods to be analyzed to build the MBean interface. */PerInterfaceMap<M> mapgetPerInterfaceMap(...)WeakReference<PerInterface<M>> wrPerInterface<M> piMBeanAnalyzer<M> analyzerMBeanInfo mbeanInfomakeInterfaceMBeanInfo(...)new PerInterface<M>(...)new WeakReference<PerInterface<M>>(...)/** Make the MBeanInfo skeleton for the given MBean interface using ... */MBeanInfoMaker makernew MBeanInfoMaker(...)String descriptionvisit(...)makeMBeanInfo(...)/** True if the given getter and setter are consistent. *//** Invoke the given M on the given target with the given args and cookie. ... */invokeM2(...)unwrapInvocationTargetException(...)/* If the value is of the wrong type for the method we are about to ... *//** Invoke the given setter on the given target with the given argument ... */maybeInvalidParameter(...)validParameter(...)new InvalidAttributeValueException(...)Object a/** A visitor that constructs the per-interface MBeanInfo. */MBeanAnalyzer<>.MBeanVisitor<M>MBeanAttributeInfo mbaigetMBeanAttributeInfo(...)MBeanOperationInfo mboigetMBeanOperationInfo(...)/** Make an MBeanInfo based on the attributes and operations ... */MBeanAttributeInfo[] attrArraynew MBeanAttributeInfo[]MBeanOperationInfo[] opArraynew MBeanOperationInfo[]String interfaceClassNameDescriptor classNameDescriptorDescriptor mbeanDescriptorgetBasicMBeanDescriptor(...)Descriptor annotatedDescriptorDescriptor descriptornew MBeanInfo(...)List<MBeanAttributeInfo> attrs;List<MBeanOperationInfo> ops;/* Looking up the MBeanInfo for a given base class (implementation class) ... *//** Return the MBeanInfo for the given resource, based on the given ... */MBeanNotificationInfo[] notifsfindNotifications(...)notifs.lengthgetOperations(...)/** Return the basic MBeanInfo for resources of the given class and ... */MBeanInfoMap mapgetMBeanInfoMap(...)WeakHashMap<Class<?>,MBeanInfo> intfMapClass<?> intfClassgetMBeanInterface(...)new WeakHashMap<Class<?>,MBeanInfo>(...)MBeanInfo imbigetMBeanDescriptor(...)findConstructors(...)MBeanNotificationInfo[] mbngetNotificationInfo(...)MBeanNotificationInfo[] resultnew MBeanNotificationInfo[]mbn.lengthMBeanNotificationInfo niConstructor<?>[] consMBeanConstructorInfo[] mbcnew MBeanConstructorInfo[]cons.lengthString descrnew MBeanConstructorInfo(...)/* We do not catch and wrap RuntimeException or Error, ... */// Following is expensive but we only call this method to determine// if an exception is due to an incompatible parameter type.// Plain old c.isInstance doesn't work for primitive types./** This class is the MBean implementation of the MBeanServerDelegate. ... */new MBeanAttributeInfo(...)...[] attributeNames;...[] attributeInfos;MBeanInfo delegateInfo;MBeanServerDelegateImpl.attributeInfos/** Obtains the value of a specific attribute of the MBeanServerDelegate. ... */getMBeanServerId(...)getSpecificationName(...)getSpecificationVersion(...)getSpecificationVendor(...)getImplementationName(...)getImplementationVersion(...)getImplementationVendor(...)AttributeNotFoundException xJMRuntimeException jSecurityException s/** This method always fail since all MBeanServerDelegateMBean attributes ... */String attnameObject valRuntimeException r/** Makes it possible to get the values of several attributes of ... */String[] attnattn.lengthAttributeList list/** This method always return an empty list since all ... *//** Always fails since the MBeanServerDelegate MBean has no operation. ... *//** Provides the MBeanInfo describing the MBeanServerDelegate. ... */// attribute must not be null// Extract the requested attribute from file// Unknown attribute// Now we will always fail:// Either because the attribute is null or because it is not// accessible (or does not exist).// This is a hack: we call getAttribute in order to generate an// AttributeNotFoundException if the attribute does not exist.// If we reach this point, we know that the requested attribute// exists. However, since all attributes are read-only, we throw// an AttributeNotFoundException.// If attributes is null, the get all attributes.// Prepare the result list.// Get each requested attribute.// Skip the attribute that couldn't be obtained.// Finally return the result.// Check that operation name is not null.import MXBeanMappingFactory/* We maintain a couple of caches to increase sharing between ... *//** Base class for MBeans.  There is one instance of this class for ... */MBeanIntrospector<M> introspectorgetMBeanIntrospector(...)this.perInterfacethis.mbeanInfo/** Return the appropriate introspector for this type of MBean. *//** Return a cookie for this MBean.  This cookie will be passed to ... */isMXBean(...)// call the contained object's preRegister etc methods even if it has them// preRegister and postRegister, given that it is not supposed to// Methods that javax.management.StandardMBean should call from itsunregister(...)getCookie(...)AttributeList resultObject attrValueObject attrObjAttribute attr// Overridden by StandardMBeanSupportMBeanInfo mbeanInfo;Object resource;PerInterface<M> perInterface;// Undo any work from registration.  We do this in postDeregister// not preDeregister, because if the user preDeregister throws an// exception then the MBean is not unregistered.// OK: attribute is not included in returned list, per spec// XXX: log the exception// We can't use AttributeList.asList because it has side-effectsimport MBeanInfoMapimport PerInterfaceMapimport MBeanParameterInfoimport OpenMBeanAttributeInfoSupportimport OpenMBeanOperationInfoSupportimport OpenMBeanParameterInfoimport OpenMBeanParameterInfoSupport/** Introspector for MXBeans.  There is exactly one instance of this class. ... */new PerInterfaceMap<ConvertingMethod>(...)new MXBeanIntrospector(...)new MBeanInfoMap(...)MXBeanIntrospector instance;analyzer(...)from(...)getOpenSignature(...)checkCallFromOpen(...)Type tObject vfromOpenParameter(...)isValidParameter(...)boolean isReadableboolean isWritableboolean isIsOpenType<?> openTypeType originalTypetypeDescriptor(...)MBeanAttributeInfo aigetOpenReturnType(...)getOpenParameterTypes(...)canUseOpenInfo(...)new OpenMBeanAttributeInfoSupport(...)originalTypeString(...)int impactMBeanOperationInfo.UNKNOWNOpenType<?> returnTypeType originalReturnTypeOpenType<?>[] paramTypesType[] originalParamTypesMBeanParameterInfo[] paramsnew MBeanParameterInfo[]boolean openReturnTypeboolean openParameterTypesAnnotation[][] annotsgetParameterAnnotations(...)MBeanOperationInfo oiString paramNameString paramDescriptionMBeanParameterInfo pinew OpenMBeanParameterInfoSupport(...)new MBeanParameterInfo(...)OpenMBeanParameterInfo[] oparamsnew OpenMBeanParameterInfo[]new OpenMBeanOperationInfoSupport(...)new MBeanOperationInfo(...)/** <p>True if this type can be faithfully represented in an ... */PerInterfaceMap<ConvertingMethod> perInterfaceMap;MBeanInfoMap mbeanInfoMap;// Null is a valid value for all OpenTypes, even though// OpenType.isValue(null) will return false.  It can always be// matched to the corresponding Java type, except when that// type is primitive.// Ignore the exception and let MBeanIntrospector.invokeSetter()// throw the initial exception.// could also consult annotations for defaultValue,// minValue, maxValue, legalValues/* Ideally this would be an empty string, but ... *//* If the return value and all the parameters can be faithfully ... *//* We already have immutableInfo=true in the Descriptor ... */import InvocationHandlerimport MBeanServerConnectionimport MBeanServerInvocationHandler/* This class handles the mapping between MXBean references and ... */new ThreadLocal<MXBeanLookup>(...)this.mbscWeakReference<MXBeanLookup> weakLookupnew MXBeanLookup(...)new WeakReference<MXBeanLookup>(...)WeakReference<Object> wrT proxynewMXBeanProxy(...)Object proxynew WeakReference<Object>(...)String wrongInvocationHandler ihgetInvocationHandler(...)MBeanServerInvocationHandler mbsihgetMBeanServerConnection(...)ObjectName existingString multinamenew InstanceAlreadyExistsException(...)ThreadLocal<MXBeanLookup> currentLookup;MBeanServerConnection mbsc;WeakIdentityHashMap<Object,ObjectName> mxbeanToObjectName;Map<ObjectName,WeakReference<Object>> objectNameToProxy;WeakIdentityHashMap<MBeanServerConnection,WeakReference<MXBeanLookup>> mbscToLookup;// Message will be strange if mxbean is null but it is not// supposed to be./* removeReference can be called when the above condition fails, ... *//** <p>A custom mapping between Java types and Open types for use in MXBeans. ... */Type javaType;OpenType<?> openType;Class<?> openClass;/** <p>Construct a mapping between the given Java type and the given ... */this.javaTypethis.openTypethis.openClassmakeOpenClass(...)/** <p>The Java type that was supplied to the constructor.</p> ... *//** <p>The Open Type that was supplied to the constructor.</p> ... *//** <p>The Java class that corresponds to instances of the ... *//** <p>Convert an instance of the Open Type into the Java type. ... *//** <p>Convert an instance of the Java type into the Open Type. ... *//** <p>Throw an appropriate InvalidObjectException if we will not ... *//* Copyright (c) 2007, 2012, Oracle and/or its affiliates. All rights reserved. ... */import javax.management.openmbean.*import MXBeanMappingimport DefaultMXBeanMappingFactory/** <p>Defines how types are mapped for a given MXBean or set of MXBeans. ... */new DefaultMXBeanMappingFactory(...)/** <p>Construct an instance of this class.</p> */MXBeanMappingFactory DEFAULT;/** <p>Mapping factory that applies the default rules for MXBean ... *//** <p>Return the mapping for the given Java type.  Typically, a ... *//* Copyright (c) 2007, 2008, Oracle and/or its affiliates. All rights reserved. ... *//** <p>Helper class for an {@link InvocationHandler} that forwards methods from an ... */MBeanAnalyzer<ConvertingMethod> analyzernew Visitor(...)MBeanAnalyzer<>.MBeanVisitor<ConvertingMethod>Method getterMethodcheckCallToOpen(...)new GetHandler(...)Method setterMethodnew SetHandler(...)Method operationMethodnew InvokeHandler(...)this.convertingMethodConvertingMethod convertingMethod;this.signature...[] signature;Handler handlerConvertingMethod cmgetConvertingMethod(...)lookupFor(...)MXBeanLookup oldLookupObject[] openArgstoOpenParameters(...)Object resultfromOpenReturnValue(...)Map<Method,Handler> handlerMap;// return type is void, no need for checkCallToOpen/** Base class for MXBeans. ... *//** <p>Construct an MXBean that wraps the given resource using the ... */Set<Class<?>> intfstransitiveInterfaces(...)Set<Class<?>> candidatesClass<?> intfIterator<Class<?>> itClass<?> intf2/* Return all interfaces inherited by this class, directly or ... */Set<Class<?>> setClass<?> sup/* The sequence of events for tracking inter-MXBean references is ... */this.mxbeanLookupaddReference(...)this.objectNameremoveReference(...)Object lock;MXBeanLookup mxbeanLookup;// for mxbeanLookup and objectNameObjectName objectName;// eventually we could have some logic to supply a default name/** This interface keeps the list of Class Loaders registered in the ... *//** Add an anonymous ClassLoader to the repository. *//** Remove the specified ClassLoader to the repository. ... *//** Add a named ClassLoader to the repository. *//** Remove a named ClassLoader from the repository. *//** Get a named ClassLoader from the repository. */import javax.management.*/** This class is used for storing a pair (name, object) where name is ... *//** Object name. */DynamicMBean object;/** Object reference. *//** Allows a named object to be created. ... */ObjectName objNamenew ObjectName(...)/** Compares the current object name with another object name. ... *//** Returns a hash code for this named object. *//** Get the object name. *//** Get the object */import ObjectStreamClass/** This class deserializes an object in the context of a specific class loader. ... *//** @exception ... */// Java import// Query the class loader .../** Per-MBean-interface behavior.  A single instance of this class can be shared ... */this.mbeanInterfacethis.introspectornew InitMaps(...)invokeM(...)invokeSetter(...)List<MethodAndSig> listMethodAndSig foundnoSuchMethod(...)MethodAndSig masmas.signatureString badSigsigString(...)get(...).signaturefound.method/* This method is called when invoke doesn't find the named method. ... */ReflectionException exceptionGetPropertyAction actString invokeGettersSMap<String,M> methodsM methodString[] msiggetSignature(...)msig.lengthStringBuilder b/** Visitor that sets up the method maps (operations, getters, setters). */Object oldcheckMethod(...)new MethodAndSig(...)mas.methodsingletonList(...)M method;Class<?> mbeanInterface;MBeanIntrospector<M> introspector;Map<String,M> getters;Map<String,M> setters;Map<String,List<MethodAndSig>> ops;// helpful exception message// Construct the exception that we will probably throw// No compatibility requirement here// Is the compatibility property set?// We don't expect an exception here but if we get one then// we'll simply assume that the property is not set.import ServiceNameimport ReentrantReadWriteLock/** This repository does not support persistency. ... *//** An interface that allows the caller to get some control ... *//** Called by {@link #addMBean}. ... *//** Called by {@link #remove}. ... */Map<String,Map<String,NamedObject>> domainTb;/** The structure for storing the objects is very basic. ... */// Private fields -------------------------------------------->int nbElements;/** Number of elements contained in the Repository *//** Domain name of the server the repository is attached to. ... */ReentrantReadWriteLock lock;/** We use a global reentrant read write lock to protect the repository. ... *//* This class is used to match an ObjectName against a pattern. */// Private methods --------------------------------------------->// Private fields <=============================================...[] keys;String properties;boolean isPropertyListPattern;boolean isPropertyValuePattern;ObjectName pattern;/** The ObjectName pattern against which ObjectNames are matched. *//** Builds a new ObjectNamePattern object from an ObjectName pattern. ... */isPropertyListPattern(...)isPropertyValuePattern(...)getCanonicalKeyPropertyListString(...)getKeyPropertyList(...)/** Builds a new ObjectNamePattern object from an ObjectName pattern ... */this.isPropertyListPatternthis.isPropertyValuePatternthis.propertiesthis.keysEntry<String,String> entrythis.pattern/** Return true if the given ObjectName matches the ObjectName pattern ... */String p1String p2String vgetKeyProperty(...)wildmatch(...)/** Add all the matching objects from the given hashtable in the ... */ObjectName onmatchKeys(...)Map<String,NamedObject> moiTbnew HashMap<String,NamedObject>(...)addMoiToTb(...)registering(...)RuntimeOperationsException xRuntimeException xunregistered(...)Level.FINEnew NamedObject(...)/** Retrieves the named object contained in repository ... */String dom/** Construct a new repository with the given default domain. */// Public methods --------------------------------------------->// Protected methods <=============================================// Protected methods --------------------------------------------->// Private methods <=============================================new ReentrantReadWriteLock(...)new HashMap<String,Map<String,NamedObject>>(...)ServiceName.DOMAIN/** Returns the list of domains in which any MBean is currently ... */readLock(...)Entry<String,Map<String,NamedObject>> entryMap<>.Entry<String,Map<String,NamedObject>>Map<String,NamedObject> t/** Stores an MBean associated with its object name in the repository. ... */boolean to_default_domainwriteLock(...)addNewDomMoi(...)NamedObject elmt/** Checks whether an MBean of the name specified is already stored in ... */retrieveNamedObject(...)/** Retrieves the MBean of the name specified from the repository. The ... *//** Selects and retrieves the list of MBeans whose names match the specified ... */Set<NamedObject> resultnew HashSet<NamedObject>(...)ObjectName.WILDCARDString canonical_key_property_list_stringboolean allNamesObjectNamePattern namePatternnew ObjectNamePattern(...)String dom2MatchaddAllMatching(...)isDomainPattern(...)emptySet(...)/** Removes an MBean from the repository. ... */unregistering(...)/** Gets the number of MBeans stored in the repository. ... *//** Gets the name of the domain currently used by default in the ... */// If key property value pattern but not key property list// pattern, then the number of key properties must be equal// If key property value pattern or key property list pattern,// then every property inside pattern should exist in name// Find value in given object name for key at current// index in receiver// Did we find a value for this key ?// If this property is ok (same key, same value), go to next// wildmatch key property values// values[i] is the pattern;// v is the string// If no pattern, then canonical names must be equal// if all couples (property, value) are contained// shouldn't come here...// No patterns inside reposit// Extract the domain name.// Default domain case// No domain containing registered object names// we use == domain later on...// Creates a new hashtable for the default domain// Temporary list// Skip domains that are in the table but have no// MBean registered in them// in particular the default domain may be like this// Set domain to default if domain is empty and not already set// Do we have default domain ?// ES: OK (dom & domain are interned)// Validate name for an object// Domain cannot be JMImplementation if entry does not exist// If domain does not already exist, add it to the hash table// Add instance if not already present// Calls internal retrieve method to get the named object// The following filter cases are considered:// null, "", "*:*" : names in all domains// ":*", ":[key=value],*" : names in defaultDomain// "domain:*", "domain:[key=value],*" : names in the specified domain// Surely one of the most frequent cases ... query on the whole world// If pattern is not a pattern, retrieve this mbean !// All names in all domains// All names in default domain// Pattern matching in the domain name (*, ?)// Debugging stuff// Extract domain name.// Find the domain subtable// Remove the corresponding element// We removed it !// No more object for this domain, we remove this domain hashtable// set a new default domain table (always present)// need to reinstantiate a hashtable because of possible// big buckets array size inside table, never cleared,// thus the new !// ES: OK dom and domain are interned.// Public methods <=============================================/** Fix security hole in ClassLoaderRepository. This class wraps ... */ClassLoaderRepository clr;/** Creates a new secure ClassLoaderRepository wrapping an ... */loadClassWithout(...)loadClassBefore(...)import NotificationBroadcasterSupportnew StandardMBeanIntrospector(...)new WeakHashMap<Class<?>,Boolean>(...)new PerInterfaceMap<Method>(...)StandardMBeanIntrospector instance;boolean immutableisDefinitelyImmutableInfo(...)/* Return true if and only if we can be sure that the given MBean implementation ... */Boolean immutableClass<NotificationBroadcasterSupport> nbsWeakHashMap<Class<?>,Boolean> definitelyImmutable;PerInterfaceMap<Method> perInterfaceMap;/* We don't bother saying mxbean=false, and we can't know whether ... */// Too bad, we'll say no for now./** Base class for Standard MBeans. ... *//** <p>Construct a Standard MBean that wraps the given resource using the ... *//* Standard MBeans that are NotificationBroadcasters can return a different ... *//** Extends the MBeanServer interface to ... *//** <p>Return the MBeanServerDelegate representing the MBeanServer. ... *//* Copyright (c) 2000, 2008, Oracle and/or its affiliates. All rights reserved. ... */import IdentityHashMapimport LinkedHashMapimport MalformedObjectNameExceptionMalformedObjectNameException enew HashMap<K,V>(...)new IdentityHashMap<K,V>(...)Map<K,V> mapnew TreeMap<K,V>(...)new LinkedHashMap<K,V>(...)new HashSet<E>(...)/* This method can be used by code that is deliberately violating the ... *//** Computes a descriptor hashcode from its names and values. ... */names.lengthdeepHashCode(...)/* The algorithm is a classical one.  We advance pointers in ... *//** Match a part of a string against a shell-style pattern. ... */int starstriint starpatichar patc/** Match a string against a shell-style pattern.  The only pattern ... */// hashcode of a list containing just v is// v.hashCode() + 31, see List.hashCode()// System.out.println("matching "+pat.substring(pati,patend)+//        " against "+str.substring(stri, strend));// index for backtrack if "*" attempt fails// index for backtrack if "*" attempt fails, +1/* On each pass through this loop, we either advance pati, ... */// Mismatched, can we backtrack to a "*"?// Retry the match one position later in str/* The approach ... *//** <p>A map where keys are compared using identity comparison (like ... */new ReferenceQueue<K>(...)new WeakIdentityHashMap<K,V>(...)WeakReference<K> keyrefmakeReference(...)expunge(...)Reference<? extends K> refnew IdentityWeakReference<K>(...)/** WeakReference where equals and hashCode are based on the ... */this.hashCodeIdentityWeakReference<?> wrint hashCode;Map<WeakReference<K>,V> map;ReferenceQueue<K> refQueue;import PrivilegedActionExceptionimport NotificationFilterSupportimport NotificationResultimport TargetedNotificationimport ClassLogger/* There is one instance of ArrayNotificationBuffer for every ... *//** A circular buffer of notifications received from an MBean server. */new HashSet<ShareBuffer>(...)new BufferListener(...)debug(...)createdNotification(...)new HashMap<MBeanServer,ArrayNotificationBuffer>(...)new BroadcasterQuery(...)NotificationFilterSupport nfsnew NotificationFilterSupport(...)enableType(...)new ClassLogger(...)boolean disposed;Object globalLock;// FACTORY STUFF, INCLUDING SHARINGHashMap<MBeanServer,ArrayNotificationBuffer> mbsToBuffer;Collection<ShareBuffer> sharers;int queueSizegetNotifBufferSize(...)ArrayNotificationBuffer bufboolean createNotificationBuffer shareremptyMap(...)new ArrayNotificationBuffer(...)new ShareBuffer(...)createListeners(...)/* Ensure that this buffer is no longer the one that will be returned by ... */boolean emptyremoveNotificationBuffer(...)ShareBuffer bufint bufsizedestroyListeners(...)dropNotification(...)addSharer(...)NotificationBuffer bufArrayNotificationBuffer.thisfetchNotifications(...)removeSharer(...)// ARRAYNOTIFICATIONBUFFER IMPLEMENTATIONtraceOn(...)trace(...)this.mBeanServerthis.queueSizenew ArrayQueue<NamedNotification>(...)this.earliestSequenceNumberthis.nextSequenceNumber// supposed to be accessing this class.// The JDK doesn't contain any such calls and users are not// We no longer support calling this method from outside./** <p>Fetch notifications that match the given listeners.</p> ... */long endTimelong earliestSeqlong nextSeqList<TargetedNotification> notifsnew ArrayList<TargetedNotification>(...)int nnotifsTargetedNotification[] resultNotifsnew TargetedNotification[]NotificationResult nrnew NotificationResult(...)isDisposed(...)earliestSequenceNumber(...)nextSequenceNumber(...)debugOn(...)NamedNotification candidateNotification notifgetNotification(...)List<TargetedNotification> matchedNotifsnotificationAt(...)ServerNotifForwarder.NotifForwarderBufferFilterlong toWaitlong indexthis.senderthis.notificationObjectName sender;Notification notification;/* Add our listener to every NotificationBroadcaster MBean ... */Set<ObjectName> namesRuntimeException readdBufferListener(...)checkNoLocks(...)extractException(...)PrivilegedAction<Set<ObjectName>> actPrivilegedExceptionAction<Boolean> act/* This method must not be synchronized.  See the comment on the ... */String shouldEqualgetMBeanName(...)removeBufferListener(...)addNotification(...)new NamedNotification(...)NotificationListener bufferListener;MBeanServer mbsQueryExp broadcasterQuery;NotificationFilter creationFilter;NotificationListener creationListener;holdsLock(...)/** Iterate until we extract the real exception ... */ClassLogger logger;MBeanServer mBeanServer;ArrayQueue<NamedNotification> queue;int queueSize;long earliestSequenceNumber;long nextSequenceNumber;Set<ObjectName> createdDuringQuery;String broadcasterClass;//Find out queue size/* We avoid holding any locks while calling createListeners. ... */// Notify potential waiting fetchNotification call// Check arg validity/* Determine the end time corresponding to the timeout value. ... *//* We set earliestSeq the first time through the loop.  If we ... *//* On exit from this loop, notifs, earliestSeq, and nextSeq must ... *//* Get the next available notification regardless of filters, ... *//* First time through.  The current earliestSequenceNumber ... *//* If many notifications have been dropped since the ... */// Skip security check if NotificationBufferFilter is not overloaded/* nextSeq is the largest sequence number.  If we ... *//* dispose called *//* We have a candidate notification.  See if it matches ... *//* We only check the max size now, so that our ... */// end while/* Construct and return the result. *//* Spec doesn't say whether Set returned by QueryNames can be modified ... *//* This can happen if the MBean was unregistered just ... */newArray(...)this.headthis.tailT[] newqueueint newtailT removed...[] queue;// we did add something// Can't use % here because it's not mod: -3 % 2 is -1, not +1.import InterruptedIOExceptionlong threadNo;this.periodThread tnew Checker(...)/** Called by a client to inform of getting an IOException. */restart(...)/** Called by this class to check a client connection. *//** Tells a client to re-start again. *//** Tells a client to stop because failing to call checkConnection. *//** Terminates this object. */InterruptedException ireInterruptedIOException iioenew InterruptedIOException(...)doStart(...)doStop(...)Exception eeeterminate(...)// --------------------------------------------------------------// private varaiblesisInterrupted(...)sleep(...)checkConnection(...)gotIOException(...)interrupt(...)Thread myThread;Checker checker;// private variableslong period;int CONNECTED;// stateint RE_CONNECTING;int FAILED;int TERMINATED;...[] lock;// check state// already failed to re-start by another thread// restart process has been called by another thread// we need to wait// be asked to give up// restarted is failed by another thread// re-starting// OK.// We know there is a problem.// We will check the state at the following steps// XXX stop checking?import Subject/** <p>An identified listener.  A listener has an Integer id that is ... */this.listenerIDthis.filterthis.handbackthis.delegationSubjectgetNotificationFilter(...)getHandback(...)Integer listenerID;NotificationFilter filter;Object handback;Subject delegationSubject;import NotSerializableExceptionimport Executorimport UnmarshalExceptionnew HashMap<Integer,ClientListenerInfo>(...)int threadId;/* An Executor that allows at most one executing and one pending ... */this.commandRunnable rLinearExecutor.thisLinearExecutor.this.commandRunnable command;Thread thread;Executor exgetMaxFetchNotifNumber(...)getFetchTimeout(...)new LinearExecutor(...)this.defaultClassLoaderthis.executor/** Called to to fetch notifications from a server. *//** Used to send out a notification about lost notifs */new ClientListenerInfo(...)List<Integer> idsList<ClientListenerInfo> valuesnew ArrayList<ClientListenerInfo>(...)beforeRemove(...)ClientListenerInfo lisameAs(...)getListenerID(...)new Integer[]/* Called when a connector is doing reconnection. Like <code>postReconnection</code>, ... */ClientListenerInfo[] tmpnew ClientListenerInfo[]/** Called after reconnection is finished. ... */boolean tracelistenerInfos.lengthaddListenerForMBeanRemovedNotif(...)setState(...)// -------------------------------------------------// private classesboolean alreadyLogged;config(...)// Set new context class loader, returns previous one.AccessControlContext ctxtClientNotifForwarder.this.accClientNotifForwarder.thislogOnce(...)ClassLoader previousSecurityException xdoRun(...)shouldStop(...)fetchNotifs(...)TargetedNotification[] notifsgetTargetedNotifications(...)Map<Integer,ClientListenerInfo> listenersInteger myListenerIDlong missedgetEarliestSequenceNumber(...)getNextSequenceNumber(...)TargetedNotification tnInteger listenerIDString unregMBeanServerNotification mbsnlostNotifs(...)dispatchNotification(...)removeListenerForMBeanRemovedNotif(...)execute(...)NotificationListener lObject hfetchOneNotif(...)error(...)/* Fetch one notification when we suspect that it might be a ... */ClientNotifForwarder cnflong startSequenceNumberint notFoundCountNotificationResult resultlong firstEarliest// private methods/* Called to decide whether need to start a thread for fetching notifs. ... */new NotifFetcher(...)/** Import: should not remove a listener during reconnection, the reconnection ... */ClassLoader defaultClassLoader;Executor executor;Map<Integer,ClientListenerInfo> infoList;long clientSequenceNumber;// notif stuffint maxNotifications;Integer mbeanRemovedNotifID;Thread currentFetchThread;int STARTING;/** This state means that a thread is being created for fetching and forwarding notifications. */int STARTED;/** This state tells that a thread has been started for fetching and forwarding notifications. */int STOPPING;/** This state means that the fetching thread is informed to stop. */int STOPPED;/** This state means that the fetching thread is already stopped. *//** This state means that this object is terminated and no more thread will be created ... */boolean beingReconnected;/** This variable is used to tell whether a connector (RMIConnector or ClientIntermediary) ... *//* You can supply an Executor in which the remote call to ... */// should never// doing or waiting reconnection// only update mbeanRemovedNotifID// old listeners are re-added// not update clientSequenceNumber// only new listeners added during reconnection// need update clientSequenceNumber// Log only once.// if ctxt is null, log a config message and throw a// SecurityException.// get context class loader - may throw// SecurityException - though unlikely.// if nothing needs to be done, break here...// reset context class loader - may throw// SecurityException// nr == null means got exception// check sequence number.// check if an mbean unregistration notif// forward// tell that the thread is REALLY stopped// no more fetching// 0 notifs to update startSequenceNumber// 1 notif to skip possible missing class// Even if result.getEarliestSequenceNumber() is now greater than// it was initially, meaning some notifs have been dropped// from the buffer, we don't want the caller to see that// because it is then likely to renotify about the lost notifs.// So we put back the first value of earliestSequenceNumber// that we saw.// no more listener, stop fetching// wait for another thread to do, which is doing reconnection// make sure only one fetching thread.// re-call this method to check the state again,// the state can be other value like TERMINATED.// init the clientSequenceNumber if not reconnected.// JDK-8038940// reconnection must happen during// fetchNotifs(-1, 0, 0), and a new// thread takes over the fetching job// for cleaning// start fetching// should notimport Remoteimport NoSuchObjectException/** A helper class for RMI-IIOP and CORBA APIs. */String IMPL_CLASS;// loads IIOPProxy implementation class if availableIIOPProxy proxy;/** Returns true if RMI-IIOP and CORBA is available. *//** Returns true if the given object is a Stub. */isStub(...)/** Returns the Delegate to which the given Stub delegates. */ensureAvailable(...)getDelegate(...)/** Sets the Delegate for a given Stub. *//** Returns the ORB associated with the given stub ... */getOrb(...)/** Connects the Stub to the given ORB. */connect(...)/** Returns true if the given object is an ORB. */isOrb(...)/** Creates, and returns, a new ORB instance. */createOrb(...)/** Converts a string, produced by the object_to_string method, back ... */stringToObject(...)/** Converts the given CORBA object reference to a string. */objectToString(...)/** Checks to ensure that an object of a remote or abstract interface ... */narrow(...)/** Makes a server object ready to receive remote calls */exportObject(...)/** Deregisters a server object from the runtime. */new NoSuchObjectException(...)unexportObject(...)/** Returns a stub for the given server object. */toStub(...)import RemoteException/** An interface to a subset of the RMI-IIOP and CORBA APIs to avoid a ... *//* Copyright (c) 2009, Oracle and/or its affiliates. All rights reserved. ... *//** A buffer of notifications received from an MBean server. *//** <p>Discard this buffer.</p> *//** Add the given notification coming from the given MBean to the list ... */import ObjectInputimport ObjectOutputimport RemoteObjectimport RemoteRefreadExternal(...)writeExternal(...)/** @deprecated */getRefClass(...)newCall(...)remoteEquals(...)remoteHashCode(...)remoteToString(...)RemoteRef ref;/* Copyright (c) 2003, 2008, Oracle and/or its affiliates. All rights reserved. ... */import RMIClientSocketFactoryimport RMIServerSocketFactoryimport UnicastRemoteObject/** <p>Unpublished interface controlling how the RMI Connector Server ... */String EXPORTER_ATTRIBUTE;this.timeoutRunnable timeoutTasknew Timeout(...)getId(...)/** Tells that a new request message is received. ... *//** Tells that a response is sent out for a received request. ... */logtime(...)notify(...)/** Called by this class to tell an implementation to do stop. *//** Terminates this object. ... */boolean stoppinglong elapsedlong timestamp;int currentJobs;boolean terminated;// state issueClassLogger timelogger;// If you change this name you will need to change a unit test// (NoServerTimeoutTest)// tells the adminor to restart waiting with timeout// tell Timeout to terminate// wait until there is no more job// stoppingimport NotificationAccessControllernew NotifForwarderBufferFilter(...)new HashMap<ObjectName,Set<IdAndFilter>>(...)String stringBooleanthis.mbeanServerthis.notifBufferthis.connectionIdgetServerConnectionTimeout(...)computeBooleanFromString(...)getNotificationAccessController(...)ObjectName nncheckState(...)getSubject(...)boolean instanceOfPrivilegedActionException eMalformedObjectNameException mfoeIdAndFilter idafnew IdAndFilter(...)Set<IdAndFilter> setsingleton(...)new HashSet<IdAndFilter>(...)Exception relistenerIDs.lengthNotifForwarderBufferFilter bufferFilter;/* This is the object that will apply our filtering to candidate ... */IdAndFilter[] candidatesnew IdAndFilter[]NotificationFilter nfgetFilter(...)isNotificationEnabled(...)new TargetedNotification(...)allowNotificationEmission(...)long tsnoopOnUnregister(...)// See 6957378.// so that we can know too, and remove the corresponding entry from the listenerMap.// in order to be told when MBeans are unregistered.  We snoop on fetched notifications// The standard RMI connector client will register a listener on the MBeanServerDelegateList<IdAndFilter> copySet<IdAndFilter> delegateSetnew ArrayList<IdAndFilter>(...)idaf.idNotification nObjectName gone// PRIVATE METHODS/** Explicitly check the MBeanPermission for ... */MBeanPermission perm/** Check if the caller has the right to get the following notifications. */fetchNotification(...)Integer id;MBeanServer mbeanServer;//------------------// PRIVATE VARIABLESString connectionId;long connectionTimeout;int listenerCounter;...[] listenerCounterLock;NotificationBuffer notifBuffer;Map<ObjectName,Set<IdAndFilter>> listenerMap;...[] terminationLock;boolean checkNotificationEmission;NotificationAccessController notificationAccessController;// Explicitly check MBeanPermission for addNotificationListener// 6238731: set the default domain if no domain is set.// impossible, but...// Tread carefully because if set.size() == 1 it may be the// Collections.singleton we make here, which is unmodifiable.// Explicitly check MBeanPermission for removeNotificationListener// Give back the first exception// Tread carefully because if set.size() == 1 it may be a// Collections.singleton, which is unmodifiable.// We proceed in two stages here, to avoid holding the listenerMap// lock while invoking the filters (which are user code).// We don't synchronize on targetedNotifs, because it is a local// variable of our caller and no other thread can see it.// This is a notification from the MBeanServerDelegate.import MarshalledObjectimport MalformedURLExceptionimport JMXConnectorProviderimport JMXConnectorimport JMXServiceURLimport RMIConnectorgetProtocol(...)new MalformedURLException(...)new RMIConnector(...)import ORBimport Delegateimport PortableRemoteObjectimport Stubimport IIOPProxyimport SerializablePermission/** An implementation of IIOPProxy that simply delegates to the appropriate ... */Permissions pnew SerializablePermission(...)AccessControlContext STUB_ACC;// the only allowed privilege is SerializablePermission("enableSubclassImplementation")// special ACC used to initialize the IIOP stub_get_delegate(...)_set_delegate(...)_orb(...)BAD_OPERATION xstring_to_object(...)object_to_string(...)/* Copyright (c) 2009,2013, Oracle and/or its affiliates. All rights reserved. ... */import BigDecimalimport Anyimport Contextimport NO_IMPLEMENTimport TypeCodeimport BoxedValueHelperread_boolean(...)read_char(...)read_wchar(...)read_octet(...)read_short(...)read_ushort(...)read_long(...)read_ulong(...)read_longlong(...)read_ulonglong(...)read_float(...)read_double(...)read_string(...)read_wstring(...)read_boolean_array(...)read_char_array(...)read_wchar_array(...)read_octet_array(...)read_short_array(...)read_ushort_array(...)read_long_array(...)read_ulong_array(...)read_longlong_array(...)read_ulonglong_array(...)read_float_array(...)read_double_array(...)read_Object(...)read_TypeCode(...)read_any(...)read_Principal(...)read_fixed(...)read_Context(...)orb(...)read_value(...)read_abstract_interface(...)new NO_IMPLEMENT(...)import JMXConnectorServerimport JMXConnectorServerProviderimport RMIConnectorServernew RMIConnectorServer(...)import FilePermissionimport AccessControlExceptionimport javax.security.auth.*import javax.security.auth.callback.*import javax.security.auth.login.*import javax.security.auth.spi.*import JMXPrincipalimport ConnectorBootstrap/** This {@link LoginModule} performs file-based authentication. ... */ConnectorBootstrap.DefaultValues.PASSWORD_FILE_NAMEConnectorBootstrap.DefaultValuesString DEFAULT_PASSWORD_FILE_NAME;// Location of the default password fileString USERNAME_KEY;// Key to retrieve the stored usernameString PASSWORD_KEY;// Key to retrieve the stored password// Log messagesboolean useFirstPass;// Configurable optionsboolean tryFirstPass;boolean storePass;boolean clearPass;boolean succeeded;// Authentication statusboolean commitSucceeded;String username;// Supplied username and passwordJMXPrincipal user;// Initial stateCallbackHandler callbackHandler;Map<String,Object> sharedState;Map<String,?> options;String passwordFile;String passwordFileDisplayName;boolean userSuppliedPasswordFile;boolean hasJavaHomePermission;Properties userCredentials;/** Initialize this <code>LoginModule</code>. ... */this.subjectthis.callbackHandlerthis.sharedStatethis.options/** Begin user authentication (Authentication Phase 1). ... */loadPasswordFile(...)LoginException lenew LoginException(...)attemptAuthentication(...)cleanState(...)/** Complete user authentication (Authentication Phase 2). ... */getPrincipals(...)/** Abort user authentication (Authentication Phase 2). ... */logout(...)/** Logout a user. ... *//** Attempt authentication ... */String localPasswordgetUsernamePassword(...)new FailedLoginException(...)new JMXPrincipal(...)/* Read the password file. */FilePermission fpnew FilePermission(...)AccessControlException acenew AccessControlException(...)setStackTrace(...)getStackTrace(...)BufferedInputStream bis/** Get the username and password. ... */Callback[] callbacksnew Callback[]new NameCallback(...)new PasswordCallback(...)char[] tmpPasswordhandle(...)tmpPassword.lengthUnsupportedCallbackException ucegetCallback(...)/** Clean out state because of a failed authentication attempt *//* Copyright (c) 2004, 2008, Oracle and/or its affiliates. All rights reserved. ... */// initialize any configured options// set the location of the password file// attempt the authentication// attempt the authentication by getting the// username and password from shared state// authentication succeeded// authentication failed -- try again below by prompting// authentication failed// attempt the authentication using the supplied username and password// add Principals to the Subject// in any case, clean out state// Clean out state// overall authentication succeeded and commit succeeded,// but someone else's commit failed// clean out state// sharedState used as Map<String,Object>// get the username and password// userCredentials is initialized in login()// username not found or passwords do not match// Save the username and password in the shared state// only if authentication succeeded// Create a new user principal// use the password saved by the first module in the stack// acquire username and passwordimport Principalimport JMXAuthenticatorimport AuthPermissionimport AppConfigurationEntryimport Configurationimport LoginContextimport LoginExceptionimport LoginModule/** <p>This class represents a ... *//** Creates an instance of <code>JMXPluggableAuthenticator</code> ... */String loginConfigNameString passwordFilenew LoginContext(...)new JMXCallbackHandler(...)String pfnew AuthPermission(...)new FileLoginConfig(...)PrivilegedActionException paeauthenticationFailure(...)SecurityException se/** Authenticate the <code>MBeanServerConnection</code> client ... */String[] aCredentialsaCredentials.lengthSubject subjectlogin(...)setReadOnly(...)logException(...)LoginContext loginContext;String password;String LOGIN_CONFIG_PROP;String LOGIN_CONFIG_NAME;String PASSWORD_FILE_PROP;/** This callback handler supplies the username and password (which was ... *//** Sets the username and password in the appropriate Callback object. */callbacks.lengthsetPassword(...)new UnsupportedCallbackException(...)/** This class defines the JAAS configuration for file-based authentication. ... */// The JAAS configuration for file-based authenticationString FILE_LOGIN_MODULE;// The classname of the login module for file-based authenticationString PASSWORD_FILE_OPTION;// The option that identifies the password file to use/** Creates an instance of <code>FileLoginConfig</code> ... */Map<String,String> optionsnew AppConfigurationEntry[]new AppConfigurationEntry(...)AppConfigurationEntry.LoginModuleControlFlag.REQUIREDAppConfigurationEntry.LoginModuleControlFlag/** Gets the JAAS configuration for file-based authentication *//** Refreshes the configuration. */// use the supplied JAAS login configuration// use the default JAAS login configuration (file-based)// Verify that credentials is of type String[].// Special case for null so we get a more informative message// Verify that the array contains two elements.// Verify that username exists and the associated// password matches the one supplied by the client.// Perform authentication// the configuration is fixedimport CodeSourceimport SubjectDomainCombiner/** <p>This class represents an extension to the {@link SubjectDomainCombiner} ... */new CodeSource(...)ProtectionDomain[] newCurrentcurrent.lengthcombine(...)CodeSource nullCodeSource;/** A null CodeSource. */ProtectionDomain pdNoPerms;/** A ProtectionDomain with a null CodeSource and an empty permission set. *//** Get the current AccessControlContext combined with the supplied subject. */new JMXSubjectDomainCombiner(...)/** Get the AccessControlContext of the domain combiner created with ... */// Add a new ProtectionDomain with the null codesource/signers, and// the empty permission set, to the end of the array containing the// 'current' protections domains, i.e. the ones that will be augmented// with the permissions granted to the set of principals present in// the supplied subject.import MBeanServerForwarder/** <p>An object of this class implements the MBeanServer interface ... */this.mbs/** Check if the caller can do read operations. This method does ... *//** Check if the caller can do write operations.  This method does ... *//** Check if the caller can create the named class.  The default ... */checkWrite(...)/** Check if the caller can unregister the named MBean.  The default ... *//** Call <code>checkRead()</code>, then forward this method to the ... *///--------------------------------------------// Implementation of the MBeanServer interfacecheckRead(...)/** Call <code>checkCreate(className)</code>, then forward this method to the ... */checkCreate(...)checkClassLoader(...)/** Call <code>checkWrite()</code>, then forward this method to the ... */checkMLetMethods(...)/** Call <code>checkUnregister()</code>, then forward this method to the ... */checkUnregister(...)GetPropertyAction propActionString propValueboolean allowGetMBeansFromURL// Check if security manager installed// Check for addURL and getMBeansFromURL methods// Check if MBean is instance of MLet// Throw security exception// addURL// getMBeansFromURL// Whether or not calling getMBeansFromURL is allowed is controlled// by the value of the "jmx.remote.x.mlet.allow.getMBeansFromURL"// system property. If the value of this property is true, calling// the MLet's getMBeansFromURL method is allowed. The default value// for this property is false.import Pattern/** <p>An object of this class implements the MBeanServerAccessController ... */String READONLY;String READWRITE;String CREATE;String UNREGISTER;new AccessType(...)AccessType READ;AccessType WRITE;AccessType CREATE;AccessType UNREGISTER;boolean write;...[] createPatterns;boolean unregister;int npatsthis.writethis.createPatternsthis.unregister...[] NO_STRINGS;/** <p>Create a new MBeanServerAccessController that forwards all the ... */propertiesFromFile(...)this.accessFileNameparseProperties(...)checkAccess(...)AccessType.READAccessType.WRITE/** Check if the caller can create MBeans or instances of the given class. ... */AccessType.CREATE/** Check if the caller can do unregister operations.  This method does ... */AccessType.UNREGISTER/** <p>Refresh the set of username/access level entries.</p> ... */FileInputStream finProperties pSubject sSet<> principalsString newPropertyValueIterator<> iPrincipal pAccess accessaccess.writeaccess.unregistercheckCreateAccess(...)SecurityException se2String classNamePatternaccess.createPatternsclassNameMatch(...)StringTokenizer stokString tokquote(...)this.accessMapnew HashMap<String,Access>(...)String identityString accessStringparseAccess(...)isWhitespace(...)int EOS;String identity;// just for better error messagesint len;// the string we're parsing// s.length()int c;// 16 bits for Unicode.// "supplementary characters", the ones that don't fit in the original// (if unlikely) that a classname in a create clause might contain// c is EOS.  We use int rather than char because it is conceivable// At any point, either c is s.codePointAt(i), or i == len andthis.lenthis.ithis.cnew Parser(...)parseWord(...)skipSpace(...)new Access(...)parseReadWrite(...)syntax(...)List<String> createClassesboolean unregisterparseCreate(...)parseClassName(...)boolean dotOKisJavaIdentifierPart(...)// Advance c and i to the next character, unless already at EOS.charCount(...)Map<String,Access> accessMap;Properties originalProps;String accessFileName;/* security has not been enabled */// all access entries imply read// Add some more information to help people with deployments that// worked before we required explicit create clauses. We're not giving// any information to the bad guys, other than that the access control// is based on a file, which they could have worked out from the stack// trace anyway.// We studiously avoided regexes when parsing the properties file,// because that is done whenever the VM is started with the// appropriate -Dcom.sun.management options, even if nobody ever// creates an MBean.  We don't want to incur the overhead of loading// all the regex code whenever those options are specified, but if we// get as far as here then the VM is already running and somebody is// doing the very unusual operation of remotely creating an MBean.// Because that operation is so unusual, we don't try to optimize// by hand-matching or by caching compiled Pattern objects.// pseudo-codepoint "end of string"// We don't check that classname components begin with suitable// characters (so we accept 1.2.3 for example).  This means that// there are only two states, which we can call dotOK and !dotOK// according as a dot (.) is legal or not.  Initially we're in// !dotOK since a classname can't start with a dot; after a dot// we're in !dotOK again; and after any other characters we're in// dotOK.  The classname is only accepted if we end in dotOK,// so we reject an empty name or a name that ends with a dot./** <p>This interface allows to control remote access to the ... *//** This method is called when a remote ... *//** This method is called before the ... */import SubjectDelegationPermission/* Return the AccessControlContext appropriate to execute an ... */Collection<Principal> psgetSubjectPrincipals(...)Collection<Permission> permissionsnew ArrayList<Permission>(...)PrivilegedAction<Void> actionPermission sdpString pnamenew SubjectDelegationPermission(...)getDelegatedAcc(...)getDomainCombinerContext(...)/** Check if the connector server creator can assume the identity of each ... *//** Retrieves the {@linkplain Subject} principals ... */List<Principal> principalsnew Principal[]/* Copyright (c) 2003, 2014, Oracle and/or its affiliates. All rights reserved. ... */// Check if the subject delegation permission allows the// authenticated subject to assume the identity of each// principal in the delegated subjectthis.cl2ClassNotFoundException cneClassLoaderRepository repository;ClassLoader cl2;boolean loadedboolean ok;Logger logger;finerOn(...)finestOn(...)Level.WARNINGLevel.INFOLevel.CONFIGfiner(...)severe(...)Level.SEVERE/* We attempt to work even if we are running in J2SE 1.3, where ... */// java.util.logger package is not available in this jvm.import ObjectOutputStreamimport JMXConnectorFactoryimport JMXConnectorServerFactoryJMXConnectorFactory.DEFAULT_CLASS_LOADERJMXConnectorServerFactory.DEFAULT_CLASS_LOADER_NAMEString CREDENTIAL_TYPES;/** Name of the attribute that specifies a list of class names acceptable ... */String DEFAULT_CLASS_LOADER;/** <p>Name of the attribute that specifies a default class loader ... */String DEFAULT_CLASS_LOADER_NAME;/** Get the Connector Server default class loader. ... */Object loaderObject name/** Get the Connector Client default class loader. ... *//** Initialize the cause field of a {@code Throwable} object. ... *//** Returns the cause field of a {@code Throwable} object. ... */Throwable retMethod getCauseString BUFFER_SIZE_PROPERTY;/** <p>Name of the attribute that specifies the size of a notification ... *//** Returns the size of a notification buffer for a connector server. ... */int defaultQueueSizeString oldPgetIntegerAttribute(...)String MAX_FETCH_NOTIFS;/** <p>Name of the attribute that specifies the maximum number of ... *//** Returns the maximum notification number which a client will ... */String FETCH_TIMEOUT;/** <p>Name of the attribute that specifies the timeout for a ... *//** Returns the timeout for a client to fetch notifications. */String NOTIF_ACCESS_CONTROLLER;/** <p>Name of the attribute that specifies an object that will check ... *//** Get an integer-valued attribute with name <code>name</code> ... */String DEFAULT_ORB;/* Check that all attributes have a key that is a String. ... *//* Return a writable map containing only those attributes that are ... */SortedMap<String,V> mapnew TreeMap<String,V>(...)purgeUnserializable(...)hideAttributes(...)/** Remove from the given Collection any element that is not a ... */Iterator<?> itnew SinkOutputStream(...)String HIDDEN_ATTRIBUTES;/** The value of this attribute, if present, is a string specifying ... */String DEFAULT_HIDDEN_ATTRIBUTES;/* This list is copied directly from the spec, plus ... *//** Default list of attributes not to show. ... */SortedSet<String> defaultHiddenStrings;SortedSet<String> defaultHiddenPrefixes;SortedSet<String> hiddenStringsSortedSet<String> hiddenPrefixesString hideString sentinelKeyIterator<String> keyIteratorIterator<String> stringIteratorIterator<String> prefixIteratorString nextStringString nextPrefixparseHiddenAttributes(...)String SERVER_CONNECTION_TIMEOUT;/** <p>Name of the attribute that specifies the timeout to keep a ... *//** Returns the server side connection timeout. */String CLIENT_CONNECTION_CHECK_PERIOD;/** <p>Name of the attribute that specifies the period in ... *//** Returns the client connection check period. *//** Computes a boolean value from a string value retrieved from a ... *//** Converts a map into a valid hash table, i.e. ... */HashMap<K,V> mIterator<?> inew Hashtable<K,V>(...)String JMX_SERVER_DAEMON;/** <p>Name of the attribute that specifies whether a connector server ... *//** Returns true if {@value SERVER_DAEMON} is specified in the {@code env} ... *//* Copyright (c) 2003, 2016, Oracle and/or its affiliates. All rights reserved. ... */// it must be older than 1.4.// default value// keep it for the compability for the fix:// 6174229: Environment parameter should be notification.buffer.size// instead of buffer.size// the default value re-specified in the system// try the old one/* May throw a NumberFormatException, which is an ... */// ObjectOutputStream invalid after exception/* Construct a string that is greater than any key in the map. ... *//* Read each key in sorted order and, if it matches a string ... *//* Continue through string-match values until we find one ... *//* Continue through the prefix values until we find one ... */// returns a default value of 'false' if no property is found...import javax.naming.*import NamingManagerimport org.omg.CosNaming.*/** Implements the JNDI NamingEnumeration interface for COS ... */int DEFAULT_BATCHSIZE;BindingListHolder _bindingList;BindingIterator _bindingIter;// list of bindings// iterator for getting list of bindingsint batchsize;// pointer in _bindingListCNCtx _ctx;// how many to ask for each timeHashtable<?,?> _env;// ctx to listboolean more;// environment for getObjectInstanceboolean isLookedUpCtx;// iterator done?/** Creates a CNBindingEnumeration object. ... */// iterating on a context beneath this context ?String batchContext.BATCHSIZEBindingIteratorHolder _bindingIterHnew BindingIteratorHolder(...)incEnumCount(...)this.isLookedUpCtxnew BindingListHolder(...)_ctx._nc_bindingIterH.valuenext_n(...)/** Returns the next binding in the list. ... */_bindingList.value.length_bindingList.valuegetMore(...)Binding bndgmapBinding(...)/** Returns true or false depending on whether there are more bindings. ... */hasMore(...)NamingException eNamingException nedecEnumCount(...)/** Get the next batch using _bindingIter. Update the 'more' field. */new NamingException(...)setRootCause(...)/** Constructs a JNDI Binding object from the COS Naming binding ... */callResolve(...)bndg.binding_nameName cnamecosNameToName(...)String cnameStrBinding jbndgnew Binding(...)NameComponent[] compsmakeFullName(...)String fullNamecosNameToInsString(...)setNameInNamespace(...)/* Copyright (c) 1999, 2011, Oracle and/or its affiliates. All rights reserved. ... */// Get batch size to use// Perform listing and request that bindings be returned in _bindingIter// Upon return,_bindingList returns a zero length list// Get first batch using _bindingIter// If there's more, check whether current bindingList has been exhausted,// and if so, try to get more.// If no more, just say so./** context was obtained by CNCtx, the user doesn't have a handle to ... */// ignore failures// Use cname.toString() instead of bindingName because the name// in the binding should be a composite nameimport ResolveResultimport InputStreamReaderimport BufferedReaderimport org.omg.CosNaming.NamingContextPackage.*import org.omg.CORBA.*import CorbaUtils/** Provides a bridge to the CosNaming server provided by ... */new CNNameParser(...)ORB _defaultOrb;/* Implement one shared ORB among all CNCtx.  However, there is a public constructor ... */ORB _orb;NamingContext _nc;// used by ExceptionMapper and RMI/IIOP factory// public for accessing underlying NamingContext...[] _name;Hashtable<String,Object> _env;CNNameParser parser;// used by ExceptionMapperString FED_PROP;boolean federation;OrbReuseTracker orbTracker;// Reference counter for tracking _orb referencesint enumCount;boolean isCloseCalled;/** Create a CNCtx object. Gets the initial naming ... */initOrbAndRootContext(...)/** This method is used by the iiop and iiopname URL Context factories. */CNCtx ctxnew CNCtx(...)initUsingUrl(...)ctx._envnew ResolveResult(...)/** Creates a CNCtx object which supports the javax.naming ... */new ConfigurationException(...)getDefaultOrb(...)NameComponent[] answernew NameComponent[]_name.lengthchild.length/** These are the URL schemes that need to be processed. ... *//** Initializes the COS Naming Service. ... */ORB inOrbString ncIorString provUrlContext.PROVIDER_URLisCorbaUrl(...)getStringifiedIor(...)setOrbAndRootContext(...)String insNamenameToCosName(...)BAD_PARAM emapException(...)initUsingIiopUrl(...)initUsingCorbanameUrl(...)/** Handles "iiop" and "iiopname" URLs (INS 98-10-11) */IiopUrl parsedUrlnew IiopUrl(...)NamingException savedExceptionAddress addrIiopUrl.AddressgetAddresses(...)String tmpUrladdr.portaddr.hostObject rootCtxgetStringName(...)MalformedURLException e/** Initializes using "corbaname" URL (INS 99-12-03) */CorbanameUrl parsedUrlnew CorbanameUrl(...)String corbalocString cosNameObject ncRefresolve_initial_references(...)InvalidName inCOMM_FAILURE enew CommunicationException(...)INV_OBJREF eURL uBufferedReader bufinnew BufferedReader(...)readLine(...)/** Does the job of calling the COS Naming API, ... */NamingContext ncSystemException e/** Converts the "String" name into a CompositeName ... */new CompositeName(...)/** Converts the "Name" name into a NameComponent[] object and ... */NameComponent[] pathObject answerCannotProceedException cpeContext cctxgetContinuationContext(...)getRemainingName(...)/** Performs bind or rebind in the context depending on whether the ... */getStateToBind(...)(...)._ncNamingContext nobjrebind_context(...)bind_context(...)rebind(...)bind(...)new NotContextException(...)new InvalidNameException(...)callBindOrRebind(...)CannotProceedException eObject resObjgetResolvedObj(...)Reference refRefAddr addrgetContent(...)new NameNotFoundException(...)getRootCause(...)setRemainingName(...)/** Converts the "String" name into a CompositeName object and ... *//** Calls the unbind api of COS Naming and uses the exception mapper ... */unbind(...)NotFound eleafNotFound(...)NameComponent restNotFoundReason._missing_nodee.whye.rest_of_name.lengthe.rest_of_name(...).idleaf.idrest.kindleaf.kindcallUnbind(...)/** Renames an object. Since COS Naming does not support a rename ... */rename(...)/** Returns a NameClassEnumeration object which has a list of name ... */listBindings(...)/** Returns a BindingEnumeration object which has a list of name ... */new CNBindingEnumeration(...)/** Calls the destroy on the COS Naming Server ... *//** Uses the callDestroy function to destroy the context. If name is ... */destroySubcontext(...)/** Uses the callDestroy function to destroy the context. Destroys ... */NamingContext the_ncContext ctxCNCtx cnccnc._ncClassCastException eNameNotFoundException ecallDestroy(...)/** Calls the bind_new_context COS naming api to create a new subcontext. ... */NamingContext nctxbind_new_context(...)/** Uses the callBindNewContext convenience function to create a new ... */createSubcontext(...)callBindNewContext(...)/** Is mapped to resolve in the COS Naming api. ... */lookupLink(...)/** Allow access to the name parser object. ... *//** Returns the current environment. ... */composeName(...)Name result/** Adds to the environment for the current context. ... */// Record change but do not reinitialize ORB/* Copyright (c) 1999, 2012, Oracle and/or its affiliates. All rights reserved. ... */// Needed for creating default ORB// rest is the INS name// Return the parsed form to prevent subsequent lookup// from parsing the string as a composite name// The caller should be aware that a toString() of the name,// which came from the environment will yield its INS syntax,// rather than a composite syntax// parent// child// will create a default ORB if none exists// Extract PROVIDER_URL from environment// Initialize the root naming context by using the IOR supplied// in the PROVIDER_URL// Initialize the root naming context by using the URL supplied// If name supplied in URL, resolve it to a NamingContext// No PROVIDER_URL supplied; initialize using defaults// keep going// Get ORB// Assign to fields// %%% should clone() so that env can be changed// Call state factories to convert// Use naming context object reference// probably narrow() failed?// If leaf is the one missing, return success// as per JNDI spec// do nothing// This test is not foolproof because some name servers// always just return one component in rest_of_name// so you might not be able to tell whether that is// the leaf (e.g. aa/aa/aa, which one is missing?)//remove the reference to the context// leaf missing OK// copy-on-write// Never destroy an orb in CNCtx.// The orb we have is either the shared/default orb, or one passed in to a constructor// from elsewhere, so that orb is somebody else's reponsibility.import InitialContextFactory/** Implements the JNDI SPI InitialContextFactory interface used to ... *//** Creates the InitialContext object. Properties parameter should ... *//* Copyright (c) 1999, 2004, Oracle and/or its affiliates. All rights reserved. ... */import NameComponent/** Parsing routines for NameParser as well as COS Naming stringified names. ... */Properties mySyntax;char kindSeparator;char compSeparator;char escapeChar;/** Constructs a new name parser for parsing names in INS syntax. *//** Returns a CompoundName given a string in INS syntax. ... */Vector<String> compsinsStringToStringifiedComps(...)new CNCompoundName(...)elements(...)/** Creates a NameComponent[] from a Name structure. ... */parseComponent(...)/** Returns the INS stringified form of a NameComponent[]. ... */StringBuffer strcname.lengthstringifyComponent(...)/** Creates a CompositeName from a NameComponent[]. ... */Name nmInvalidNameException e/** Converts an INS-syntax string name into a Vector in which ... */Vector<String> componentschar[] idchar[] kindint idCountint kindCountboolean idModeisMeta(...)new NameComponent(...)/** Return a NameComponent given its stringified form. */NameComponent compint kindSepchar[] newStrboolean escapedcomp.idcomp.kindStringBuffer oneescape(...)/** Returns a string with '.', '\', '/' escaped. Used when ... *//** In INS, there are three meta characters: '.', '/' and '\'. *//** An implementation of CompoundName that bypasses the parsing ... */CNNameParser.mySyntaxgetAll(...)Enumeration<String> compsgetPrefix(...)getSuffix(...)// reset for new component// always start off parsing id// skip escape and let meta through// just look for the first kindSeparator// skip kind separator// skip separator// Find the kind separator// Set id// Set kind// no kind separator// unescape kind// if neither id nor kind specified// no meta characters to escape// escape meta character// Convert Name to NameComponent[] then stringify/* private static void print(String input) { ... */import Nameimport NamingExceptionimport UrlUtil/** Extract components of a "corbaname" URL. ... */String stringName;String location;/** Returns a possibly empty but non-null string that is the "string_name" ... */CNCtx.parserint addrStartint addrEndint keyStart// "corbaname:"// Has key string/* // for testing only ... */import javax.naming.directory.*import javax.naming.spi.*/** A convenience class to map the COS Naming exceptions to the JNDI exceptions. ... */// ensure no instancectx.federationtryFed(...)(...).cxtNameComponent[] rest(...).rest_of_namenew CannotProceedException(...)inputName.lengthrest.lengthNameComponent[] resolvedNameresolvedName.lengthsetResolvedObj(...)ctx._orbctx.orbTrackernew NameAlreadyBoundException(...)new ContextNotEmptyException(...)Object resolvedObjNameComponent lastIn...[...].idlastIn.idlastIn.kindNotFoundReason.not_contextNameComponent[] tmpsetEnvironment(...)new Reference(...)CompositeName cnamesetAltName(...)setAltNameCtx(...)Object resolvedObj2NamingException geException geObject rf2// %%% We assume that rest returns *all* unprocessed components.// Don't' know if that is a good assumption, given// NotFound doesn't set rest as expected. -RL// Wrap resolved NamingContext inside a CNCtx// Guess that its name (which is relative to ctx)// is the part of inputName minus rest_of_name// %%% Using 1.2 & 1.3 Sun's tnameserv, 'rest' contains only the first// component that failed, not *rest* as advertized. This is useless// because what if you have something like aa/aa/aa/aa/aa.// If one of those is not found, you get "aa" as 'rest'.// Check that we're not talking to 1.2/1.3 Sun tnameserv// Might be legit// Due to 1.2/1.3 bug that always returns single-item 'rest'// Fixed in 1.4; perform calculations based on correct (1.4) behavior// Calculate the components of the name that has been resolved// First component of rest is found but not a context; keep it// as part of resolved name// Remove resolved component from rest// No more remaining// Create CPE and set common fields// Lookup resolved name to get resolved object// obj is a context and child is not found// try getting its nns dynamically by constructing// a Reference containing obj.// Resolved name has trailing slash to indicate nns// add trailing slash// Not a context, use object factory to transform object.// If a context, continue operation with context// Add trailing slash// Create nns reference/** Extract components of an "iiop" or "iiopname" URL. ... */int DEFAULT_IIOPNAME_PORT;int DEFAULT_IIOP_PORT;String DEFAULT_HOST;Vector<Address> addresses;int major, ...;int atint bracint colonint hostEndboolean oldFormatnew Vector<Address>(...)new Address(...)StringTokenizer tokens// [version host [":" port]]// Parse version// start at the beginning// skip '@' sign// Parse host and port// at IPv6 literal// include brackets// at hostname or IPv4// skip past host// parse port// skip past ":"// Only one host:port part, not multiple/* public static void main(String[] args) { ... *//** This class keeps track of references to the shared ORB object ... */int referenceCnt;ORB orb;this.orbimport StateFactoryimport ExportException/** StateFactory that turns java.rmi.Remote objects to org.omg.CORBA.Object. ... */// for RMI-IIOP/** Returns the CORBA object for a Remote object. ... */remoteToCorba(...)(...)._orb// Already a CORBA object, just use it// Turn remote object into org.omg.CORBA.Object// Returns null if JRMP; let next factory try// CNCtx will eventually throw IllegalArgumentException if// no CORBA object gotten// RMI-IIOP library not available// pass and let next state factory tryimport DatagramSocketimport DatagramPacketimport InetAddressimport JCAUtil/** The DnsClient class performs DNS client operations in support of DnsContext. */// use by caveh@eng 6/97.// originally by sritchie@eng 1/96.  It was first hacked up for JNDI// Some of this code began life as part of sun.javaos.net.DnsClientgetSecureRandom(...)int IDENT_OFFSET;// DNS packet header field offsetsint FLAGS_OFFSET;int NUMQ_OFFSET;int NUMANS_OFFSET;int NUMAUTH_OFFSET;int NUMADD_OFFSET;int DNS_HDR_SIZE;int NO_ERROR;// DNS response codesint FORMAT_ERROR;int SERVER_FAILURE;int NAME_ERROR;int NOT_IMPL;int REFUSED;...[] rcodeDescription;int DEFAULT_PORT;int TRANSACTION_ID_BOUND;...[] servers;...[] serverPorts;int timeout;int retries;// initial timeout on UDP queries in msDatagramSocket udpSocket;// number of UDP retriesMap<Integer,ResourceRecord> reqs;// Requests sentMap<Integer,byte[]> resps;// Responses received/* Each server is of the form "server[:port]".  IPv6 literal host names ... *///-------------------------------------------------------------------------this.retriesnew DatagramSocket(...)SocketException ethis.serversnew InetAddress[]servers.lengthString servergetByName(...)UnknownHostException enew HashMap<Integer,ResourceRecord>(...)new HashMap<Integer,byte[]>(...)Object queuesLock;// A lock to access the request and response queues in tandem./* If recursion is true, recursion is requested on the query. ... */int xidPacket pktResourceRecord collisionException caughtExceptionboolean[] doNotRetrynew boolean[]makeQueryPacket(...)putIfAbsent(...)new ResourceRecord(...)Header.HEADER_SIZEint retrybyte[] msgHeader hdrnew Header(...)msg.lengthdprint(...)doUdpQuery(...)lookupResponse(...)hdr.authoritativehdr.truncatedint ijTcp tcpnew Tcp(...)byte[] msg2Header hdr2msg2.lengthdoTcpQuery(...)hdr2.querycheckResponseCode(...)hdr2.authoritativenew ResourceRecords(...)CommunicationException eResourceRecord.QTYPE_AXFRResourceRecords rrsgetFirstAnsType(...)ResourceRecord.TYPE_SOArrs.answergetLastAnsType(...)continueTcpQuery(...)removeElementAt(...)/** Tries to retreive an UDP packet matching the given xid ... */int minTimeoutDatagramPacket opktnew DatagramPacket(...)DatagramPacket ipktint pktTimeoutint timeoutLeftlong startlong endsetSoTimeout(...)receive(...)isMatchResponse(...)disconnect(...)/* Sends a TCP query, and returns the first DNS message in the response. */tcp.out/* Returns the next DNS message from the TCP socket, or null on EOF. */int lenHitcp.inint lenLoint qnameLengetOctets(...)int pktLennew Packet(...)short flagsHeader.RD_BITmakeQueryName(...)// Builds a query name in pkt according to the RFC spec.String labelhasRootLabel(...)byte[] pktpkt.length/* Checks the header of an incoming DNS response. ... */hdr.queryhdr.xidhdr.numQuestionsResourceRecord rrResourceRecord queryint qtypeint qclassgetRrclass(...)DnsName qnameResourceRecord.QTYPE_STARResourceRecord.QCLASS_STAR/* Throws an exception if appropriate for the response code of a ... */int rcodehdr.rcodercodeDescription.lengthnew ServiceUnavailableException(...)new OperationNotSupportedException(...)Socket sock;new Socket(...)setTcpNoDelay(...)getOutputStream(...)/* javaos emulation -cj */// Is optional port given?// Generate a random transaction ID// enqueue the outstanding request// The UDP retry strategy is to try the 1st server, and then// each server in order. If no answer, double the timeout// and try each server again.// Try each name server.// send the request packet and wait for a response.// If the matching response is not got within the// given timeout, check if the response was enqueued// by some other thread, if not proceed with the next// server or retry.// try next server or retry// message is truncated -- try TCP// Try each server, starting with the one that just// provided the truncated message.// Got a valid response// Try next server, or use UDP response// servers// Use reflection to allow pre-1.4 compilation.// This won't be needed much longer.// This is authoritative, so return immediately// retries// cleanup// A network timeout or other error occurred.// Check only rcode as per// draft-ietf-dnsext-axfr-clarify-04// The response is split into multiple DNS messages.// Delete the duplicate SOA record.// msec after which there are no retries.// Packets may only be sent to or received from this server address// timeout remaining after successive 'receive()'// no matching packet received within the timeout// Send 2-byte message length, then send message.// high-order byte of response length// low-order byte of response length// next unfilled position in msg// Loop through labels, least-significant first.// Check the queued responses: some other thread in between// received the response for this request.// already received, ignore the response// common case- the request sent matches the subsequent response read// Retrieve the original query// Check that the type/class/name in the query section of the// response match those in the original query// Remove the response for the xid if received by some other// thread.// xid mis-match: enqueue the response, it may belong to some other// thread that has not yet had a chance to read its response.// enqueue only the first response, responses for retries are ignored.// enqueue only the first responseimport DirectoryManagerimport com.sun.jndi.toolkit.ctx.*/** A DnsContext is a directory context representing a DNS node. ... */new DnsNameParser(...)new ZoneNode(...)DnsName domain;Hashtable<Object,Object> environment;// with a root (empty) label at position 0// fully-qualified domain name of this context,boolean envShared;boolean parentIsDns;// and so must be copied on write// true if environment is possibly shared// another?  see composeName()// was this DnsContext created byResolver resolver;boolean authoritative;boolean recursion;// must all responses be authoritative?// request recursion on queries?NameParser nameParser;int DEFAULT_INIT_TIMEOUT;// these defaults.// retries, and name the environment properties used to override// the defaults for the initial timeout (in ms) and the number of// is for twice as long as the last.  The following constants set// Timeouts for UDP queries use exponential backoff:  each retryint DEFAULT_RETRIES;String INIT_TIMEOUT;String RETRIES;CT lookupCT;// property used to modify them// The resource record type and class to use for lookups, and theString LOOKUP_ATTR;String RECURSION;// Property used to disallow recursion on queriesint ANY;// ANY == ResourceRecord.QCLASS_STAR == ResourceRecord.QTYPE_STARZoneNode zoneTree;// The zone tree used for list operations/** Returns a DNS context for a given domain and servers. ... */new DnsName(...)initFromEnvironment(...)/* Returns a clone of a DNS context, just like DnsContext(DnsContext) ... *//* Returns a clone of a DNS context.  The context's modifiable ... */ctx.environmentctx.envSharedctx.parentIsDnsctx.domainctx.serversctx.resolverctx.authoritativectx.recursionctx.timeoutctx.retriesctx.lookupCT/* Override default with a noncloning version. *///---------- Environment operationsgetLookupCT(...)Context.AUTHORITATIVE/* Update PROVIDER_URL property.  Call this only when environment ... *//* Read environment properties and set parameters. */new CT(...)fromAttrId(...)ResourceRecord.CLASS_INTERNETResourceRecord.TYPE_TXT//---------- Naming operationssetSuccess(...)DnsContext ctxnew DnsContext(...)new Resolver(...)DnsName fqdnfullyQualify(...)getResolver(...)lookupCT.rrclasslookupCT.rrtypeAttributes attrsrrsToAttrs(...)setError(...)fillInException(...)c_lookup(...)NameNode nnodegetNameNode(...)new NameClassPairEnumeration(...)getChildren(...)new BindingEnumeration(...)//---------- Directory operationsCT[] ctsattrIdsToClassesAndTypes(...)CT ctgetClassAndTypeToQuery(...)ct.rrclassct.rrtype//---------- Name-related operationsName prefixCName nameCint prefixLastDnsName dnsComp/* Resolver is not created until needed, to allow time for updates ... *///---------- Helper methods/* Returns the fully-qualified domain name of a name given ... */DnsName dnsName/* Converts resource records to an attribute set.  Only resource ... */BasicAttributes attrsnew BasicAttributes(...)int rrtypeint rrclassString attrIdtoAttrId(...)classAndTypeMatch(...)new BasicAttribute(...)getRdata(...)/* Returns true if rrclass and rrtype match some element of cts. ... */cts.lengthboolean classMatchboolean typeMatch/* Returns the attribute ID for a resource record given its class ... */getTypeName(...)getRrclassName(...)/* Returns the class and type values corresponding to an attribute ... */int spacenew InvalidAttributeIdentifierException(...)/* Returns an array of the classes and types corresponding to a ... */new CT[]attrIds.length/* Returns the most restrictive resource record class and type ... */...[...].rrclass...[...].rrtype/* Returns the node in the zone tree corresponding to a ... *//* Synchronization notes: ... *///---------- Support for list operationsZoneNode znodeDnsName zoneNameNode topOfZonegetDeepestPopulated(...)getContents(...)depth(...)isZoneCut(...)boolean currentisZoneCurrent(...)boolean restartdepopulate(...)findZoneName(...)isPopulated(...)populateZone(...)/* Does a zone transfer to [re]populate a zone in the zone tree. ... */queryZone(...)populate(...)/* Determine if a ZoneNode's data is current. ... */ResourceRecord soafindSoa(...)compareSerialNumberTo(...)//---------- Debugging/* A pairing of a resource record class and a resource record type. ... *///----------int rrclass;int rrtype;this.rrclassthis.rrtype/* Common base class for NameClassPairEnumeration and BindingEnumeration. */Enumeration<NameNode> nodes;DnsContext ctx;// nodes to be enumerated, or null if none// context being enumeratedthis.nodes/* ctx will be set to null when no longer needed by the enumeration. */boolean moreNoSuchElementException nsee/* An enumeration of name/classname pairs. ... */Name compNameNameClassPair ncpnew NameClassPair(...)/* An enumeration of Bindings. *///      close();//  protected void finalize() {// Finalizer not needed since it's safe to leave ctx unclosed.String compNameStrDnsContext childchild.environmentBinding binding// shared environment, copy-on-write// shared servers, no write operation// copy on write// assert !envShared;// clone for parallelism// Any name that's not a CompositeName is assumed to be a DNS// compound name.  Convert each to a DnsName for syntax checking.// Each of prefix and name is now either a DnsName or a CompositeName.// If we have two DnsNames, simply join them together.// Wrap compound names in composite names.// Let toolkit do the work at namespace boundaries.// prefixC is already a clone// parse name// clone & check syntax// Be overly generous and allow root label if we're in root domain.// class// type// Query all records.// No records are requested, but we need to ask for something.// Find deepest related zone in zone tree.// If fqdn is in znode's zone, is not at a zone cut, and// is current, we're done.// +1 for root// Zone was modified while we were examining it.// All bets are off.// cache hit!// Cache miss...  do it the expensive way.// Find fqdn's zone and add it to the tree.// "1" to skip root// If znode is now populated we know -- because the first half of// getNodeName() didn't find it -- that it was populated by another// thread during this method call.  Assume then that it's current.// Desired node should now be in znode's populated zone.  Find it.// assert Thread.holdsLock(znode);// former version:  return !znode.isExpired();// Clone ctx to create the child context.import ResolverConfiguration/** A DnsContextFactory serves as the initial context factory for DNS. ... */// available since 1.4.1String DEFAULT_URL;new Hashtable<Object,Object>(...)urlToContext(...)getInitCtxUrl(...)/* "urls" are used to determine the servers, but any domain ... */String[] serversserversForUrls(...)platformServersUsed(...)setProviderUrl(...)constructProviderUrl(...)/* Public for use by product test suite. */filterNameServers(...)nameservers(...)open(...)DnsUrl[] urlsString domainfromList(...)urls.length/* Returns all the servers specified in a set of URLs. ... */List<String> serversgetHost(...)int portgetPort(...)List<String> platformServers/* Returns true if serversForUrls(urls) would make use of servers ... */platformServersAvailable(...)/* Returns a value for the PROVIDER_URL property (space-separated URL ... *//* Reads environment to find URL(s) of initial context. ... */String url/** Removes any DNS server that's not permitted to access ... */List<String> outputString platformServercheckConnect(...)/* Copyright (c) 2000, 2011, Oracle and/or its affiliates. All rights reserved. ... */// If multiple urls, all must have the same domain.// No server or port given, so look to underlying platform.// ResolverConfiguration does some limited caching, so the// following is reasonably efficient even if called rapid-fire.// on to next URL (if any, which is unlikely)// assert false : "ISO-Latin-1 charset unavailable";/** <tt>DnsName</tt> implements compound names for DNS as specified by ... */// If non-null, the domain name represented by this DnsName.ArrayList<String> labels;// this is the reverse of the ordering used by the Name interface.// corresponds to the leftmost (least significant) label:  note that// The labels of this domain name, as a list of strings.  Index 0short octets;// number of non-root labels, plus 1.  Must remain less than 256.// packet.  Equal to the sum of the lengths of each label, plus the// The number of octets needed to carry this domain name in a DNS/** Constructs a <tt>DnsName</tt> representing the empty domain name. *//** Constructs a <tt>DnsName</tt> representing a given domain name. ... *//* Returns a new DnsName with its name components initialized to ... */int en.labelsn.domainn.octets/** Does this domain name follow <em>host name</em> syntax? */isHostNameLabel(...)Name ncompareRange(...)int pos;verifyLabel(...)DnsName dnshort newOctetsdn.octetsdn.labelsdn.domain/* Helper method for public comparison methods.  Lexicographically ... */String label1String label2compareLabels(...)/* Returns a key suitable for hashing the label at index i. ... */keyForLabel(...)/* Parses a domain name, setting the values of instance vars accordingly. */StringBuffer labelgetEscapedOctet(...)/* Returns (as a char) the octet indicated by the escape sequence ... */IndexOutOfBoundsException e/* Checks that this label is valid. ... *//* Does this label conform to host name syntax? */isHostNameChar(...)/* Append a label to buf, escaping as needed. *//* Compares two labels, ignoring case for ASCII values. ... *//* Returns a key suitable for hashing a label.  Two labels map to ... *//** Serializes only the domain name string, for compactness and to avoid ... */new StreamCorruptedException(...)// Compute indexes into "labels", which has least-significant label// at index 0 (opposite to the convention used for "beg" and "end").// shortcut:  do sizes differ?// never 0 if sizes differ// index of "pos" component in "labels"// index of element to remove in "labels"// invalidate "domain"// Check for empty labels:  may have only one, and only at end.// Check total name length.// index for insertion into "labels"// "n" is a DnsName so we can insert it as a whole, rather than// verifying and inserting it component-by-component.// More code, but less work.// Preserve "domain" if we're appending or prepending,// otherwise invalidate it.// force ClassCastException// "n" is a compound name, but not a DnsName.// Add labels least-significant first:  sometimes more efficient.// Loop through labels, starting with most significant.// index of label1 in "labels"// assert (label1 == labels.get(j));// longer range wins// label being parsed// found an escape sequence// sequence is \DDD// consume remaining digits// an unescaped octet// found '.' separator// check syntax, then add label//   to end of name// clear buffer for next label// If name is neither "." nor "", the octets (zero or more)// from the rightmost dot onward are now added as the final// label of the name.  Those two are special cases in that for// all other domain names, the number of labels is one greater// than the number of dot separators.// do this last, since add() sets it to null// assert (name.charAt(pos) == '\\');// sequence is `\DDD'// sequence is `\C'// Check for two-byte characters.// to lower case// the longer one wins// shouldn't happen/** A name parser for DNS names. ... */// Every DnsNameParser is created equal.import Uri/** A DnsUrl represents a DNS pseudo-URL of the form ... *//** Given a space-separated list of DNS URLs, returns an array of DnsUrl ... */// domain name of the contextnew DnsUrl[]StringTokenizer stDnsUrl[] trimmednew DnsUrl(...)/** Returns the domain of this URL, or "." if none is provided. ... *//* Copyright (c) 2000, 2002, Oracle and/or its affiliates. All rights reserved. ... */// next available index in urls// System.out.println("host=" + host + " port=" + port +//                    " domain=" + domain);/* // Debug ... *//** The Header class represents the header of a DNS message. ... */int HEADER_SIZE;short QR_BIT;// Masks and shift amounts for DNS header flag fields.// octets in a DNS headershort OPCODE_MASK;int OPCODE_SHIFT;short AA_BIT;short TC_BIT;short RD_BIT;short RA_BIT;short RCODE_MASK;int xid;boolean query;// ID:  16-bit query identifierint opcode;// QR:  true if query, false if response// OPCODE:  4-bit opcodeboolean truncated;// AAboolean recursionDesired;// TCboolean recursionAvail;// RDint rcode;// RAint numQuestions;// RCODE:  4-bit response codeint numAnswers;int numAuthorities;int numAdditionals;/* Returns a representation of a decoded DNS message header. ... *//* Decodes a DNS message header.  Does not modify or store a ... *//* Returns the 2-byte unsigned value at msg[pos].  The high ... */// current offset into msg// Flags// RR counts/** A NameNode represents a node in the DNS namespace.  Each node ... */String label;Hashtable<String,NameNode> children;// parent, or null for root of a tree// name of this node relative to itsboolean isZoneCut;// child nodes// true if this node is a zone cut// depth in tree (0 for root)this.label/* Returns a newly-allocated NameNode.  Used to allocate new nodes ... */new NameNode(...)/* Returns the name of this node relative to its parent, or null for ... *//* Returns the depth of this node in the tree.  The depth of the root ... */this.isZoneCut/* Returns the children of this node, or null if there are none. ... *//* Returns the child node given the hash key (the down-cased label) ... *//* Returns the node at the end of a path, or null if the ... */NameNode node/* Returns the node at the end of a path, creating it and any ... */NameNode childnode.childrennew Hashtable<String,NameNode>(...)newNameNode(...)child.depthnode.depth/** The Resolver class performs DNS client operations in support of DnsContext. ... */DnsClient dnsClient;/* Constructs a new Resolver given its servers and timeout parameters. ... */new DnsClient(...)/* Queries resource records of a particular class and type for a ... *//* Queries all resource records of a zone given its domain name and class. ... */DnsClient clfindNameServers(...)/* Finds the zone of a given domain name.  The method is to look ... */rrs.authority/* Finds a zone's SOA record.  Returns null if no SOA is found (in ... *//* Finds the name servers of a zone.  <tt>zone</tt> is a fully-qualified ... */ResourceRecord.TYPE_NSString[] nsns.length// while below root// Ignore error and keep searching up the tree.// found zone's SOA// Look for an SOA record giving the zone's top node.// one step rootward// no SOA found below root, so// return root// %%% As an optimization, could look in authority section of// findZoneName() response first.// Server name will be passed to InetAddress.getByName(), which// may not be able to handle a trailing dot.// assert ns[i].endsWith(".");import InvalidNameException/** The ResourceRecord class represents a DNS resource record. ... */int TYPE_A;/* Resource record type codes */int TYPE_NS;int TYPE_CNAME;int TYPE_SOA;int TYPE_PTR;int TYPE_HINFO;int TYPE_MX;int TYPE_TXT;int TYPE_AAAA;int TYPE_SRV;int TYPE_NAPTR;int QTYPE_AXFR;int QTYPE_STAR;// zone transfer...[] rrTypeNames;/* Mapping from resource record type codes to type name strings. */// query type "*"int CLASS_INTERNET;/* Resource record class codes */int CLASS_HESIOD;int QCLASS_STAR;...[] rrClassNames;/* Mapping from resource record type codes to class name strings. */// query class "*"...[] msg;int msgLen;// DNS messageboolean qSection;// msg size (in octets)// and therefore has no ttl or rdata// true if this RR is part of question sectionint rrlen;// offset of RR w/in msgDnsName name;// number of octets in encoded RR// name field of RR, including root labelString rrtypeName;// type field of RR// name of of rrtypeString rrclassName;// class field of RRint ttl;// name of rrclassint rdlen;// ttl field of RRObject rdata;// number of octets of rdata/* Constructs a new ResourceRecord.  The encoded data of the DNS ... */// rdata -- most are String, unknown are byte[]this.msgLenthis.qSection/* Returns the name field of this RR, including the root label. *//* Returns the number of octets in the encoded RR. */valueToName(...)nameToValue(...)/* Compares two SOA record serial numbers using 32-bit serial number ... */long diff/* Decodes the binary format of the RR. ... */decodeName(...)getUShort(...)rrTypeNames.lengthrrClassNames.lengthdecodeRdata(...)/* Returns the 1-byte unsigned value at msg[pos]. *//* Returns the 4-byte signed value at msg[pos].  The high ... *//* Returns the 4-byte unsigned value at msg[pos].  The high ... *//* Returns the name encoded at msg[pos], including the root label. */DnsName n/* Prepends to "n" the domain name encoded at msg[pos], including the root ... *//* Returns the rdata encoded at msg[pos].  The format is dependent ... */byte[] rddecodeA(...)decodeAAAA(...)decodeMx(...)decodeSoa(...)decodeSrv(...)decodeNaptr(...)decodeTxt(...)decodeHinfo(...)/* Returns the rdata of an MX record that is encoded at msg[pos]. */int preferenceDnsName name/* Returns the rdata of an SOA record that is encoded at msg[pos]. */DnsName mnameDnsName rnamelong serialgetUInt(...)long refreshlong retrylong expirelong minimum/* Returns the rdata of an SRV record that is encoded at msg[pos]. ... */int priorityDnsName target/* Returns the rdata of an NAPTR record that is encoded at msg[pos]. ... */int orderStringBuffer flagsStringBuffer servicesStringBuffer regexpDnsName replacementdecodeCharString(...)/* Returns the rdata of a TXT record that is encoded at msg[pos]. ... *//* Returns the rdata of an HINFO record that is encoded at msg[pos]. ... *//* Decodes the <character-string> at msg[pos] and adds it to buf. ... */getUByte(...)boolean quotedinsert(...)/* Returns the rdata of an A record, in dotted-decimal format, ... *//* Returns the rdata of an AAAA record, in colon-separated format, ... */int[] addr6int curBaseint curLenint bestBaseint bestLenboolean compress// QTYPE_STAR == QCLASS_STAR// invalid name// unknown name// index of next unread octet// NAME// TYPE// CLASS// TTL// RDLENGTH// RDATA// free up for GC// end of name// name compression// append a label// Unknown RR type/class// now used as negative TTL// starting index of this string// encoded string length// quote string if empty// size includes initial octet// the unsigned 16-bit words of the address// Find longest sequence of two or more zeros, to compress them.// new sequence// extend sequence// not in sequence// If addr begins with at least 6 zeros and is not :: or ::1,// or with 5 zeros followed by 0xffff, use the text format for// IPv4-compatible or IPv4-mapped addresses.// If bestBase != -1, compress zeros in [bestBase, bestBase+bestLen)// first compressed zero/** The ResourceRecords class represents the resource records in the ... */new Vector<ResourceRecord>(...)Vector<ResourceRecord> question;// resource records, although this isn't technically how it's defined.// The question section is treated as being made up of (shortened)// Four sections:  question, answer, authority, additional.Vector<ResourceRecord> answer;Vector<ResourceRecord> authority;Vector<ResourceRecord> additional;boolean zoneXfer;/* True if these resource records are from a zone transfer.  In ... *//* Returns a representation of the resource records in a DNS message. ... */ensureCapacity(...)this.zoneXfer/* Returns the type field of the first answer record, or -1 if ... */firstElement(...)/* Returns the type field of the last answer record, or -1 if ... */lastElement(...)/* Decodes the resource records in a DNS message and adds ... */hdr.numAnswershdr.numAuthorities// an arbitrary "large" number// The additional records section is currently ignored./** ZoneNode extends NameNode to represent a tree of the zones in the ... */SoftReference<NameNode> contentsRef;long serialNumber;// the zone's namespaceDate expiration;// the zone data's serial number// time when the zone's data expires/* Clears the contents of this node.  If the node was flagged as ... *//* Is this node currently populated? *//* Returns the zone's contents, or null if the zone is not populated. *//* Has this zone's data expired? */before(...)/* Returns the deepest populated zone on the path specified by a ... */ZoneNode popNode/* Populates (or repopulates) a zone given its own fully-qualified ... */NameNode newContentssetZoneCut(...)new SoftReference<NameNode>(...)getSerialNumber(...)setExpiration(...)getMinimumTtl(...)/* Set this zone's data to expire in <tt>secsToExpiration</tt> seconds. *//* Returns an SOA record's minimum TTL field. */String rdata/* Compares this zone's serial number with that of an SOA record. ... */compareSerialNumbers(...)/* Returns an SOA record's serial number. *///     "i=1" to skip root label// assert zone.get(0).equals("");               // zone has root label// assert (zone.size() == (depth() + 1));       // +1 due to root label// Ignore resource records whose names aren't within the zone's// domain.  Also skip records of the zone's top node, since// the zone's root NameNode is already in place.// The zone's SOA record is the first record in the answer section.// assert isPopulated();// An SOA record ends with:  serial refresh retry expire minimum.// Set "beg" to the space before serial, and "end" to the space after.// We go "backward" to avoid dealing with escaped spaces in names.import Continuation/** Basic enumeration for NameClassPair, Binding, and SearchResults. */Name listArg;boolean cleaned;LdapResult res;LdapClient enumClnt;Continuation cont;Vector<LdapEntry> entries;// used to fill in exceptionsint posn;LdapCtx homeCtx;LdapReferralException refEx;NamingException errEx;/* Record the next set of entries and/or referrals. */answer.statusLdapClient.LDAP_SUCCESSLdapClient.LDAP_SIZE_LIMIT_EXCEEDEDLdapClient.LDAP_TIME_LIMIT_EXCEEDEDLdapClient.LDAP_ADMIN_LIMIT_EXCEEDEDLdapClient.LDAP_REFERRALLdapClient.LDAP_PARTIAL_RESULTSgetErrorMessage(...)answer.errorMessageanswer.entriesthis.listArgthis.contanswer.refExthis.homeCtxhomeCtx.clntcleanup(...)/* Retrieve the next set of entries and/or referrals. */getSearchReply(...)res.entriesres.statusres.referralsprocessReturnCode(...)setNamingException(...)res.refExappendUnprocessedReferrals(...)res.resControlshomeCtx.respCtlsboolean hasMoreCalled;// assume we have something to start with/* Test if unprocessed entries or referrals exist. */hasMoreImpl(...)/* Retrieve the next entry. */nextImpl(...)getNextBatch(...)hasMoreReferrals(...)PartialResultException prenew PartialResultException(...)nextAux(...)LdapEntry resultcreateItem(...)result.DNresult.attributesresult.respCtlsName parsednew LdapName(...)/* Append the supplied (chain of) referrals onto the ... *//* Iterate through the URLs of a referral. If successful then perform ... */hasMoreReferralExceptions(...)homeCtx.handleReferralsLdapClient.LDAP_REF_THROWfillInStackTrace(...)LdapReferralContext refCtxgetReferralContext(...)homeCtx.envpropshomeCtx.reqCtlsgetReferredResults(...)LdapReferralException regetNamingException(...)/* Merge the entries and/or referrals from the supplied enumeration ... */ne.homeCtxne.enumClntne.posnne.limitne.resne.entriesne.refExne.listArgclearSearchReply(...)// These checks are to accommodate referrals and limit exceptions// which will generate an enumeration and defer the exception// to be thrown at the end of the enumeration.// All other exceptions are thrown immediately.// Exceptions shouldn't be thrown here anyhow because// process_return_code() is called before the constructor// is called, so these are just safety checks.// %%% need to deal with referral// otherwise continue// handle empty set// Ensures that context won't get closed from underneath us// remember// can't throw exception// mimimize the number of calls to processReturnCode()// (expensive when batchSize is small and there are many results)// convert referrals into a chain of LdapReferralException// merge any newly received referrals with any current referrals// when page size is supported, this// might generate an exception while attempting// to fetch the next batch to determine// whether there are any more elements// test if the current set of entries has been processed// test if any unprocessed entries exist// try to process another referral// updates posn and limit// gets and outputs DN from the entry// need to strip off all but lowest component of dn// so that is relative to current context (currentDN)// process the referrals sequentially// record a previous exception// Make sure we close referral context// Cleanup previous context first// New enum will have already incremented enum count and recorded clnt// Do this to prevent referral enumeration (ne) from decrementing// enum count because we'll be doing that here from this// enumeration.// Record rest of information from new enum// been there; done thatimport javax.naming.ldap.*/** This class provides a basic implementation of the <tt>Control</tt> ... *//** The control's object identifier string. ... */boolean criticality;/** The control's criticality. ... */...[] value;/** The control's ASN.1 BER encoded value. ... *//** Constructs a new instance of BasicControl. ... */this.criticality/** Retrieves the control's object identifier string. ... *//** Determines the control's criticality. ... *//** Retrieves the control's ASN.1 BER encoded value. ... *//** Base class that defines common fields, constants, and debug method. ... */int bufsize;IOException e2int ASN_BOOLEAN;// some ASN definesint ASN_INTEGER;int ASN_BIT_STRING;int ASN_SIMPLE_STRING;int ASN_OCTET_STR;int ASN_NULL;int ASN_OBJECT_ID;int ASN_SEQUENCE;int ASN_SET;int ASN_PRIMITIVE;int ASN_UNIVERSAL;int ASN_CONSTRUCTOR;int ASN_APPLICATION;int ASN_CONTEXT;int ASN_PRIVATE;int ASN_ENUMERATED;/** A BER decoder. Contains methods to parse a BER buffer. ... */int origOffset;/** Creates a BER decoder that reads bytes from the specified buffer. */// The start point in buf to decodethis.bufthis.bufsizethis.origOffset/** Resets this decode to start parsing from the initial offset ... *//** Returns the current parse position. ... *//** Parses a possibly variable length field. */int lengthbyteparseByte(...)new DecodeException(...)/** Parses the next sequence in this BER buffer. ... */parseLength(...)/** Used to skip bytes. Usually used when trying to recover from parse error. ... *//** Parses the next byte in this BER buffer. ... *//** Returns the next byte in this BER buffer without consuming it. ... *//** Parses an ASN_BOOLEAN tagged integer from this BER buffer. ... */parseIntWithTag(...)/** Parses an ASN_ENUMERATED tagged integer from this BER buffer. ... *//** Parses an ASN_INTEGER tagged integer from this BER buffer. ... *//** Parses an integer that's preceded by a tag. ... */byte fb/** Parses a string. */parseStringWithTag(...)/** Parses a string of a given tag from this BER buffer. ... */int stint origOffsetString retstrbyte[] buf2/** Parses an octet string of a given type(tag) from this BER buffer. ... */byte[] retarr/** Returns the number of unparsed bytes in this BER buffer. */// shared buffer, be careful to use this class/* first byte already read *//** A BER encoder. ... */int curSeqIndex;...[] seqOffset;int INITIAL_SEQUENCES;int DEFAULT_BUFSIZE;int BUF_GROWTH_FACTOR;// When buf is full, expand its size by the following factor./** Creates a BER buffer for encoding. *//** Creates a BER buffer of a specified size for encoding. ... *//** Resets encoder to state when newly constructed.  Zeros out ... *//** Gets the number of encoded bytes in this BER buffer. */// ------------------ Accessor methods ------------/** Gets the buffer that contains the BER encoding. Throws an ... *//** Gets the buffer that contains the BER encoding, trimming unused bytes. ... */getDataLen(...)byte[] trimBufgetBuf(...)/** Begin encoding a sequence with a tag. */// -------------- encoding methods -------------seqOffset.lengthint[] seqOffsetTmpencodeByte(...)ensureFreeBytes(...)/** Terminate a BER sequence. */shiftSeqData(...)new EncodeException(...)/** Shifts contents of buf in the range [start,start+len) a specified amount. ... *//** Encode a single byte. *//* Encodes an int. ... *//* private void deleteByte() { ... */encodeInt(...)/** Encodes an int and a tag. ... */int intsize// encodes an int using numbytes for the actual encoding./** Encodes a boolean. ... */encodeBoolean(...)/** Encodes a boolean and a tag ... *//** Encodes a string. ... */encodeString(...)/** Encodes a string and a tag. ... */encodeLength(...)/** Encodes a portion of an octet string and a tag. *//** Encodes an octet string and a tag. */encodeOctetString(...)tb.length/** Encodes an array of strings. */strs.length/** Ensures that there are at least "len" unused bytes in "buf". ... *//* private void encodeNull() { ... */int newsizebyte[] newbuf// shared buffer, be careful to use this method.// Double the size of the SEQUENCE array if it overflows// Save space for sequence length.// %%% Currently we save enough space for sequences up to 64k.//     For larger sequences we'll need to shift the data to the right//     in endSeq().  If we could instead pad the length field with//     zeros, it would be a big win.// index beyond length field// integer ::= 0x02 asnlength byte {byte}*// worst case// Only copy bytes in the range [0, offset)...[] controls;this.controls/* Copyright (c) 1999, 2002, Oracle and/or its affiliates. All rights reserved. ... */import SocketFactory/** Represents identity information about an anonymous LDAP connection. ... */String hostname;String protocol;...[] bindCtls;OutputStream trace;String socketFactory;int myHash;int ctlHash;SocketFactory factory;Method sockComparator;boolean isDefaultSockFactory;this.hostnamethis.portthis.protocolthis.bindCtlsthis.tracethis.socketFactoryLdapCtx.DEFAULT_SSL_FACTORYClass<?> socketFactoryClassObj.helperMethod getDefaultthis.sockComparatorthis.factoryhashCodeControls(...)ClientId otherequalsSockFactory(...)equalsControls(...)other.myHashother.versionother.portother.traceother.hostnameother.protocolother.ctlHashother.bindCtlsc.lengthisCritical(...)getEncodedValue(...)this.isDefaultSockFactoryother.isDefaultSockFactoryinvokeComparator(...)// as there is no enough information here, to do the comparison// delegate the comparison work to the SocketFactory classObject retc1.sockComparatorc1.factoryc1.socketFactoryc2.socketFactoryctls.lengthtoStringControls(...)// JDK 1.2// ignore case// Needed for custom socket factory pooling// Ignore it here, the same exceptions are/will be handled by// LdapPoolManager and Connection classes.// The SocketFactory field is not used in the myHash// computation as there is no right way to compute the hash code// for this field. There is no harm in skipping it from the hash// computation// both null or same// one is non-null// Failed to invoke the comparator; flag unequalityimport SSLSocketimport CommunicationExceptionimport ServiceUnavailableExceptionimport InterruptedNamingExceptionimport IOUtils/** A thread that creates a connection to an LDAP server. ... *///import javax.net.SocketFactory;int dump;Thread worker;// > 0 r, > 1 rwboolean v3;// Initialized in constructor// Set in setV3()// used by StartTlsResponse when creating an SSL socket// used by LdapClient for generating exception messagesboolean bound;OutputStream traceFile;// All three are initialized in constructor and read-only afterwards// Set in setBound()String traceTagIn;String traceTagOut;InputStream inStream;// Updated in replaceStreams() during "quiet", unshared, period// Initialized in constructor; read and used externally (LdapSasl);OutputStream outStream;// Updated in replaceOutputStream() during "quiet", unshared, period// must be public; used by LdapSasl// get new IO streams; closed during cleanup// Initialized in constructor; read and used externally (TLS) toLdapClient parent;// For processing "disconnect" unsolicited notification// for TLSint outMsgId;// Incremented and returned in sync getMsgId()LdapRequest pendingRequests;// Accessed only within sync methods// The list of ldapRequests pending on this bindingIOException closureReason;boolean useable;int readTimeout;// is Connection still useableint connectTimeout;// when connection is "quiet" and not shared; no need to synchronize// Called in LdapClient.authenticate() (which is synchronized)// true means v3; false means v2// When cleaning up, remember to do an UNBIND// A BIND request has been successfully made on this connection// Create an LDAP Binding object and bind to a particular serverthis.hostthis.readTimeoutthis.connectTimeoutThrowable realExceptionCommunicationException cecreateThread(...)/* Create an InetSocketAddress using the specified hostname and port number. */Class<?> inetSocketAddressClassConstructor<?> inetSocketAddressConsReflectiveOperationException e/* Create a Socket object using the specified socket factory and time limit. ... */Socket socketObject factoryMethod createSocketMethod connectObject endpointcreateInetSocketAddress(...)Constructor<Socket> socketConsSSLSocket sslSocketint socketTimeoutgetSoTimeout(...)startHandshake(...)// Methods to IO to the LDAP serverwriteRequest(...)LdapRequest reqnew LdapRequest(...)addRequest(...)dumpBER(...)unpauseReader(...)/** Reads a reply; waits until one is ready. */BerDecoder rberlong elapsedMillilong elapsedNanogetReplyBer(...)long beginNanoInterruptedException exnew InterruptedNamingException(...)abandonRequest(...)// Methods to add, find, delete, and abandon requests made to serverLdapRequest ldrldapRequest.nextldr.msgIdldr.nextLdapRequest ldrprevcancel(...)ldrprev.nextBerEncoder bernew BerEncoder(...)int abandonMsgIdgetMsgId(...)removeRequest(...)beginSeq(...)Ber.ASN_SEQUENCEBer.ASN_CONSTRUCTORLdapClient.LDAP_REQ_ABANDONencodeControls(...)endSeq(...)// destroyed.// Methods to unbind from server and clear up resources when object isint unbindMsgIdLdapClient.LDAP_REQ_UNBINDboolean nparentabandonOutstandingReqs(...)ldapUnbind(...)IOException ieprocessConnectionClosure(...)// Use streamLock instead for synchronizing update to stream// "synchronize" might lead to deadlock so don't synchronize method// Assume everything is "quiet"/** Used by Connection thread to read inStream into a local variable. ... */Object pauseLock;/* The main idea is to mark requests that need the reader thread to ... */// Code for pausing/unpausing the reader thread ('worker')boolean paused;// lock for reader to wait on while paused/* Unpauses reader thread if it was paused */// paused state of reader/* Pauses reader so that it stops reading from the input stream. ... */// on the same TCP connection.// The LDAP Binding thread. It does the mux/demux of multiple requestsbyte[] inbufint inMsgIdint bytesreadint brint seqlenint seqlenlenboolean eosBerDecoder retBerbyte[] leftleft.lengthboolean needPausenew BerDecoder(...)parseSeq(...)processUnsolicited(...)findRequest(...)addReplyBer(...)pauseReader(...)DecodeException eBer.DecodeException/* Copyright (c) 1999, 2014, Oracle and/or its affiliates. All rights reserved. ... */// Connect to server// realException.printStackTrace();// Class.forName() seems to do more error checking// and will throw IllegalArgumentException and such.// That's why we need to have a catch all here and// ignore generic exceptions.// Also catches all IO errors generated by socket creation.// create the factory// create the socket// unconnected socket// connected socket// continue (but ignore connectTimeout)// For LDAP connect timeouts on LDAP over SSL connections must treat// the SSL handshake following socket connection as part of the timeout.// So explicitly set a socket read timeout, trigger the SSL handshake,// then reset the timeout.// reuse full timeout value/* pauseAfterReceipt */// unpause reader so that it can get response// NOTE: Must do this before writing request, otherwise might// create a race condition where the writer unblocks its own response// rethrow// Track down elapsed time to workaround spurious wakeups// If socket closed, don't even try// check if condition has changed since our last check// Socket read timeout is specified// will be woken up before readTimeout if reply is// available// no timeout is set so we wait infinitely until// a response is received// https://docs.oracle.com/javase/8/docs/technotes/guides/jndi/jndi-ldap.html#PROP// Remove from queue// build the abandon request.//System.err.println("ldap.abandon: " + ex);// Don't expect any response for the abandon request.// build the unbind request.// IMPLICIT TAGS//System.err.println("ldap.unbind: " + ex);// Don't expect any response for the unbind request.// Cleanup old stream// Replace stream// notified by unpauseReader// Buffer for reading incoming bytes// Message id of incoming response// Number of bytes in inbuf// Temp; number of bytes read from stream// Offset of where to store bytes in inbuf// Length of ASN sequence// Number of sequence length bytes// End of stream// Decoder for ASN.1 BER data from inbuf// type and length (at most 128 octets for long form)// check that it is the beginning of a sequence// a new stream to try// get length of sequence// if high bit is on, length is encoded in the// subsequent length bytes and the number of length bytes// is equal to & 0x80 (i.e. length byte with high bit off).// number of length bytes// Read all length bytes// end-of-stream reached before length bytes are read// Add contents of length bytes to determine length// read in seqlen bytes/* if (dump > 0) { ... */// reset offset// Unsolicited Notification/** Grab pauseLock before making reply available ... *//* Go into paused state; release ... */// else release pauseLock// System.err.println("Cannot find" +//              "LdapRequest for " + inMsgId);//System.err.println("Cannot parse Ber");// A new stream to try// Go to top of loop and continue// rethrow exception// This code must be uncommented to run the LdapAbandonTest./* public void sendSearchReqs(String dn, int numReqs) { ... *//** This class represents a factory for creating LDAPv3 response controls. ... *//** Constructs a new instance of the response control factory. *//** Creates an instance of a response control class from a more ... */String idSortResponseControl.OIDnew SortResponseControl(...)PagedResultsResponseControl.OIDnew PagedResultsResponseControl(...)EntryChangeResponseControl.OIDnew EntryChangeResponseControl(...)/* Copyright (c) 1999, 2003, Oracle and/or its affiliates. All rights reserved. ... *///System.out.println(id);/** Extends SimpleClientId to add property values specific for Digest-MD5. ... */...[] SASL_PROPS;...[] propvals;int pHash;SASL_PROPS.lengthDigestClientId otherother.pHashother.propvalspropvals.length// Could be smarter and apply default values for props// but for now, we just record and check exact matches/** This class implements the LDAPv3 Response Control for entry-change ... */String OID;/** The entry-change response control's assigned object identifier ... */int ADD;/** Indicates an entry which has been added. */int DELETE;/** Indicates an entry which has been deleted. */int MODIFY;/** Indicates an entry which has been modified. */int RENAME;/** Indicates an entry which has been renamed. */int changeType;/** The type of change that occurred. ... */String previousDN;/** The previous distinguished name (only applies to RENAME changes). ... */long changeNumber;/** The change number (if supported by the server). ... *//** Constructs a new instance of EntryChangeResponseControl. ... */BerDecoder berparseEnumeration(...)bytesLeft(...)peekByte(...)Ber.ASN_OCTET_STRparseString(...)Ber.ASN_INTEGER/** Retrieves the type of change that occurred. ... *//** Retrieves the previous distinguished name of the entry before it was ... *//** Retrieves the change number assigned by the server for this change. ... */// decode valueimport EventObjectimport NamingEventimport NamingExceptionEventimport NamingListenerimport UnsolicitedNotificationEventimport UnsolicitedNotificationListener/** Package private class used by EventSupport to dispatch events. ... */QueueElement next;QueueElement prev;EventObject event;Vector<NamingListener> vector;this.eventthis.vectorQueueElement head;QueueElement tail;Thread qThread;// package private/** Enqueue an event. ... */// package private;QueueElement newEltnew QueueElement(...)newElt.nexthead.prev/** Dequeue the oldest object on the queue. ... */QueueElement eltelt.prevtail.nextelt.next/** Pull events off the queue and dispatch them. */QueueElement qedequeue(...)EventObject eqe.eventVector<NamingListener> vqe.vectordispatch(...)/** Stop the dispatcher so we can be destroyed. */// package private; used by EventSupport;// not a user thread// Dispatch to corresponding NamingListener// The listener should only be getting the event that// it is interested in. (No need to check mask or// instanceof subinterfaces.)// It is the responsibility of the enqueuer to// only enqueue events with listseners of the correct type.// An exception occurred: if notify all naming listeners// just die// kill our threadimport javax.naming.event.*import SearchControlsimport UnsolicitedNotification/** This is a utility class that can be used by a context that supports ... */new Hashtable<NotifierArgs,NamingEventNotifier>(...)LdapCtx ctx;Hashtable<NotifierArgs,NamingEventNotifier> notifiers;/** NamingEventNotifiers; hashed by search arguments; */Vector<UnsolicitedNotificationListener> unsolicited;/** List of unsolicited notification listeners. *//** Constructs EventSupport for ctx. ... *//* Make the add/removeNamingListeners synchronized to: ... *//** Adds <tt>l</tt> to list of listeners interested in <tt>nm</tt>. */NotifierArgs argsnew NotifierArgs(...)NamingEventNotifier notifiernew NamingEventNotifier(...)addNamingListener(...)new Vector<UnsolicitedNotificationListener>(...)/** Adds <tt>l</tt> to list of listeners interested in <tt>nm</tt> ... *//** Removes <tt>l</tt> from all notifiers in this context. */removeNamingListener(...)hasNamingListeners(...)notifier.info/** package private; ... */info.name/** Fire an event to unsolicited listeners. ... */UnsolicitedNotificationEvent evtnew UnsolicitedNotificationEvent(...)queueEvent(...)NamingExceptionEvent evtnew NamingExceptionEvent(...)/** Stops notifier threads that are collecting event data and ... */EventQueue eventQueue;/* The queue of events to be delivered. *//** Add the event and vector of listeners to the queue to be delivered. ... */new EventQueue(...)enqueue(...)// Add listener to this's list of unsolicited notifiers// Go through list of notifiers, remove 'l' from each.// If 'l' is notifier's only listener, remove notifier too.// Remove from list of unsolicited notifier// This shouldn't really happen, but might in case// there is a timing problem that removes a listener// before a fired event event reaches here.// Fire UnsolicitedNotification to unsolicited listeners// Fire NamingExceptionEvent to unsolicited listeners.// When an exception occurs, the unsolicited listeners// are automatically deregistered.// When LdapClient.processUnsolicited() fires a NamingException,// it will update its listener list so we don't have to.// Likewise for LdapCtx.// %%% Should we fire NamingExceptionEvents to unsolicited listeners?/* Copy the vector in order to freeze the state of the set ... */// clone()// No finalize() needed because EventSupport is always owned by// an LdapCtx. LdapCtx's finalize() and close() always call cleanup() so// there is no need for EventSupport to have a finalize().import InvalidSearchFilterException/** LDAP (RFC-1960) and LDAPv3 (RFC-2254) search filters. ... *//** First convert filter string into byte[]. ... */byte[] filterint filterLennew InvalidSearchFilterException(...)filter.lengthencodeFilter(...)int nextOffsetint parensint balanceboolean escapeint[] filtOffsetencodeComplexFilter(...)encodeSimpleFilter(...)/** convert character 'c' that represents a hexadecimal digit to an integer. ... */// called by the LdapClient.compare methodboolean escStartint ivalbyte chbyte[] tbufbyte[] answerhexchar2int(...)int backSlashPosint backSlashCntint valueStartint valueEndint typeStartint typeEndint eqint ftypeint optionsStartint extensibleStartboolean isNumericOidboolean isMatchingRulefindUnescaped(...)encodeSubstringFilter(...)encodeExtensibleMatch(...)unescapeFilterValue(...)int previndexLdapClient.LBER_SEQUENCE// The filtOffset[0] pointing to the '&', '|', or '!'.//     "!(type=val)"//     "|(type=val)(type=val)"//     "&(type=val)(type=val)"// The complex filter types look like:int[] parensfindRightParen(...)encodeFilterList(...)// point to char after right paren// and return substring between the parens. Adjust filtOffset[0] to// filter at filtOffset[0] - 1 points to a (. Find ) that matches itint[] tmp// Encode filter list of type "(filter1)(filter2)..."int listNumberbyte[] newfilterisSpaceChar(...)newfilter.length// Encode extensible matchboolean matchDNint colon2boolean dbg;// the filter generation code// some debug print code that does indenting. Useful for debuggingint dbgIndent;String dstrint LDAP_FILTER_AND;/////////////// Constants used for encoding filter //////////////int LDAP_FILTER_OR;int LDAP_FILTER_NOT;int LDAP_FILTER_EQUALITY;int LDAP_FILTER_SUBSTRINGS;int LDAP_FILTER_GE;int LDAP_FILTER_LE;int LDAP_FILTER_PRESENT;int LDAP_FILTER_APPROX;int LDAP_FILTER_EXT;int LDAP_FILTER_EXT_RULE;// LDAPv3int LDAP_FILTER_EXT_TYPE;int LDAP_FILTER_EXT_VAL;int LDAP_FILTER_EXT_DN;int LDAP_SUBSTRING_INITIAL;int LDAP_SUBSTRING_ANY;int LDAP_SUBSTRING_FINAL;// filtOffset[0] has pointed to char after right paren// points to the char after right paren.// End of sequence// assume simple type=value filter// force break from outer// Try LDAP V3 escape (\xx)/** If there is no hex char following a '\' when ... */// V2: \* \( \)// escaping already started but we can't find 2nd hex/* Count the immediate preceding '\' to find out if ... */// if at start of string, or not there at all, or if not escaped// start search after escaped star// value starts after equal sign// beginning of string//initializing ftype to make the compiler happy// check validity of type// RFC4512 defines the type as the following ABNF://     attr = attributedescription//     attributedescription = attributetype options//     attributetype = oid//     oid = descr / numericoid//     descr = keystring//     keystring = leadkeychar *keychar//     leadkeychar = ALPHA//     keychar = ALPHA / DIGIT / HYPHEN//     numericoid = number 1*( DOT number )//     number  = DIGIT / ( LDIGIT 1*DIGIT )//     options = *( SEMI option )//     option = 1*keychar// And RFC4515 defines the extensible type as the following ABNF://     attr [dnattrs] [matchingrule] / [dnattrs] matchingrule// ';' is an indicator of attribute options// attribute options// ':' is an indicator of extensible rules// extensible matching// numeric object identifier// descriptor// The underscore ("_") character is not allowed by// the LDAP specification. We allow it here to// tolerate the incorrect use in practice.// check attribute options// check extensible matching// allows no more than two extensible rules// ensure the latest byte is not isolated// filter type is of "equal"// String tmp = filter.substring(filtOffset[0], nextOffset);// add enclosing parens// test for colon separator// test for match DN// test for matching rule// test for attribute type/* This element is defined in RFC-2251 with an ASN.1 DEFAULT tag. ... *//** This subclass is used by LDAP to implement the schema calls. ... */DirContext baseCtx;Name rdn;String baseCtxURL;// been serialized (// these two are used to reconstruct the baseCtx if this attribute hasHashtable<String,? super String> baseCtxEnv;LdapAttribute attrnew LdapAttribute(...)this.attrIDattr.values/** Adds a new value to this attribute. ... *//** Constructs a new instance of an attribute. ... */this.baseCtxthis.rdn/** Sets the baseCtx and rdn used to find the attribute's schema ... *//** returns the ctx this attribute came from. This call allows ... */new Hashtable<String,String>(...)Context.INITIAL_CONTEXT_FACTORYnew InitialDirContext(...)/** This is called when the object is serialized. It is ... */setBaseCtxInfo(...)defaultWriteObject(...)/** sets the information needed to reconstruct the baseCtx if ... */Hashtable<String,Object> realEnvHashtable<String,Object> secureEnv(...).envpropsthis.baseCtxURLgetURL(...)this.baseCtxEnv/** Retrieves the syntax definition associated with this attribute. ... */DirContext schemagetSchema(...)getBaseCtx(...)DirContext attrDefLdapSchemaParser.ATTRIBUTE_DEFINITION_NAMEAttribute syntaxAttrString syntaxNameLdapSchemaParser.SYNTAX_DEFINITION_NAME/** Retrieves this attribute's schema definition. ... */// LDAP attributes don't contain duplicate values so there's no need// to check if the value already exists before adding it.// setup internal state// let the ObjectOutpurStream do the real work of serialization// remove any security credentials - otherwise the serialized form// would store them in the clear//if we need to remove props, we must do it to a clone//of the environment. cloning is expensive, so we only do//it if we have to.// set baseCtxEnv depending on whether we removed props or not// get the syntax id from the attribute def// look in the schema tree for the syntax definitionString atomgetAtom(...)CompositeName cnObj.JAVA_ATTRIBUTESObj.CLASSNAMEdecodeObject(...)new LdapCtx(...)new BindingWithControls(...)convertControls(...)// serialized object or object reference// DirContext object// repeat the original operation at the new contextimport PooledConnectionimport PoolCallbackimport LdapSaslimport SaslInputStream/** LDAP (RFC-1777) and LDAPv3 (RFC-2251) compliant client ... */new Vector<LdapCtx>(...)new Hashtable<String,Boolean>(...)int debug;// ---------------------- Constants ----------------------------------boolean caseIgnore;Hashtable<String,Boolean> defaultBinaryAttrs;// Default list of binary attributesString DISCONNECT_OID;boolean isLdapv3;// ----------------------- instance fields ------------------------int referenceCount;// Used by LdapCtxConnection conn;// Used by LdapCtx for check for sharingPoolCallback pcb;// used by LdapCtx for StartTLS// Connection to server; has reader threadboolean pooled;boolean authenticateCalled;// constructor: Create an authenticated connection to servernew Connection(...)this.pcbint readTimeoutconn.readTimeoutLdapResult resconn.connectTimeoutensureOpen(...)ldapBind(...)conn.portconn.hostnew LdapResult(...)byte[] encodedPwencodePassword(...)encodedPw.lengthsaslBind(...)new AuthenticationNotSupportedException(...)LdapClient.LDAP_PROTOCOL_ERRORLdapClient.LDAP_VERSION3_VERSION2LdapClient.LDAP_NO_SUCH_OBJECTnew AuthenticationException(...)res.errorMessagesetV3(...)/** Sends an LDAP Bind request. ... */int curMsgIdreadReply(...)LdapClient.LDAP_REQ_BINDBer.ASN_CONTEXTparseResult(...)res.serverCredsparseOctetString(...)parseControls(...)/** Determines whether SASL encryption/integrity is in progress. ... */conn.inStream/** Returns the encoded password. */new Throwable(...)removePooledConnection(...)releasePooledConnection(...)// NOTE: Should NOT be synchronized otherwise won't be able to closeforceClose(...)/* Used by connection pooling to close physical connection. *//** Called by Connection.cleanup(). LdapClient should ... */notifyUnsolicited(...)int SCOPE_BASE_OBJECT;// LDAP search. also includes methods to encode rfc 1558 compliant filtersint SCOPE_ONE_LEVEL;int SCOPE_SUBTREE;encodeFilterString(...)encodeStringArray(...)res.msgId/* Abandon the search operation and remove it from the message queue. */hasSearchCompleted(...)/* Retrieve the next batch of entries and/or referrals. */BerDecoder replyBerAttributes lattrsAttribute laString DNLdapEntry leint[] seqlenint endseqnew Vector<LdapEntry>(...)new LdapEntry(...)getParsePosition(...)parseAttribute(...)le.respCtlsVector<String> URLsnew Vector<Vector<String>>(...)parseExtResponse(...)int[] lenString attridboolean hasBinaryValuesisBinaryValued(...)int attrlenparseAttributeValue(...)// returns number of bytes that were parsed. Adds the values to attrBer.ASN_SIMPLE_STRING// package entry point; used by Connectionres.matchedDNVector<Control> ctlsnew Vector<Control>(...)String controlOIDboolean criticalitybyte[] controlValueBer.ASN_BOOLEANnew BasicControl(...)res.extensionIdres.extensionValue// Encode LDAPv3 controlsbyte[] controlValreqCtls.lengthLdapClient.LDAP_CONTROLS/** Reads the next reply corresponding to msgId, outstanding on requestBer. ... *///          reqCtls - array of request controls//          attrs - array of Attribute//          operations - add, delete or replace//          dn - DN to modify//  attrs[0];//  ie, operations[0] is the operation to be performed on//  Modify the DN dn with the operations on attributes attrs.// LDAP modify:int REPLACE;operations.lengthhasNoValue(...)encodeAttribute(...)processReply(...)NamingEnumeration<?> enum_//          Adds entry to the Directory// LDAP addNamingEnumeration<? extends Attribute> enum_entry.attributesentry.DN//          deletes entry from the Directory// LDAP delete//                        (ignored if server is LDAPv2)//          newSuperior - new place to put the entry in the tree//          deleteoldrdn - boolean whether to delete old attrs or not//          newrdn - new RDN to rename to//          dn - DN to change//  Changes the last element of DN to newrdn// LDAP modrdnboolean changeSuperior//  Compare attribute->value pairs in dn// LDAP compareval.length// LDAP extended operationint LDAP_VERSION3_VERSION2;// Some BER definitions convenient for LDAPint LDAP_VERSION2;int LDAP_VERSION3;int LDAP_VERSION;int LDAP_REF_FOLLOW;int LDAP_REF_THROW;// follow referralsint LDAP_REF_IGNORE;// throw referral ex.String LDAP_URL;// ignore referralsString LDAPS_URL;int LBER_BOOLEAN;int LBER_INTEGER;int LBER_BITSTRING;int LBER_OCTETSTRING;int LBER_NULL;int LBER_ENUMERATED;int LBER_SEQUENCE;int LBER_SET;int LDAP_SUPERIOR_DN;int LDAP_REQ_BIND;int LDAP_REQ_UNBIND;// app + constructedint LDAP_REQ_SEARCH;// app + primitiveint LDAP_REQ_MODIFY;int LDAP_REQ_ADD;int LDAP_REQ_DELETE;int LDAP_REQ_MODRDN;int LDAP_REQ_COMPARE;int LDAP_REQ_ABANDON;int LDAP_REQ_EXTENSION;int LDAP_REP_BIND;// app + constructed    (LDAPv3)int LDAP_REP_SEARCH;// app + constructed | 1int LDAP_REP_SEARCH_REF;// app + constructed | 4int LDAP_REP_RESULT;int LDAP_REP_MODIFY;// app + constructed | 5int LDAP_REP_ADD;// app + constructed | 7int LDAP_REP_DELETE;// app + constructed | 9int LDAP_REP_MODRDN;// app + primitive | bint LDAP_REP_COMPARE;// app + primitive | dint LDAP_REP_EXTENSION;// app + primitive | fint LDAP_REP_REFERRAL;int LDAP_REP_EXT_OID;// ctx + constructed    (LDAPv3)int LDAP_REP_EXT_VAL;// ctx + primitive      (LDAPv3)int LDAP_CONTROLS;// LDAPv3 ControlsString LDAP_CONTROL_MANAGE_DSA_IT;String LDAP_CONTROL_PREFERRED_LANG;String LDAP_CONTROL_PAGED_RESULTS;String LDAP_CONTROL_SERVER_SORT_REQ;String LDAP_CONTROL_SERVER_SORT_RES;int LDAP_SUCCESS;// return codesint LDAP_OPERATIONS_ERROR;int LDAP_PROTOCOL_ERROR;int LDAP_TIME_LIMIT_EXCEEDED;int LDAP_SIZE_LIMIT_EXCEEDED;int LDAP_COMPARE_FALSE;int LDAP_COMPARE_TRUE;int LDAP_AUTH_METHOD_NOT_SUPPORTED;int LDAP_STRONG_AUTH_REQUIRED;int LDAP_PARTIAL_RESULTS;int LDAP_REFERRAL;// Slapdint LDAP_ADMIN_LIMIT_EXCEEDED;int LDAP_UNAVAILABLE_CRITICAL_EXTENSION;int LDAP_CONFIDENTIALITY_REQUIRED;int LDAP_SASL_BIND_IN_PROGRESS;int LDAP_NO_SUCH_ATTRIBUTE;int LDAP_UNDEFINED_ATTRIBUTE_TYPE;int LDAP_INAPPROPRIATE_MATCHING;int LDAP_CONSTRAINT_VIOLATION;int LDAP_ATTRIBUTE_OR_VALUE_EXISTS;int LDAP_INVALID_ATTRIBUTE_SYNTAX;int LDAP_NO_SUCH_OBJECT;int LDAP_ALIAS_PROBLEM;int LDAP_INVALID_DN_SYNTAX;int LDAP_IS_LEAF;int LDAP_ALIAS_DEREFERENCING_PROBLEM;int LDAP_INAPPROPRIATE_AUTHENTICATION;int LDAP_INVALID_CREDENTIALS;int LDAP_INSUFFICIENT_ACCESS_RIGHTS;int LDAP_BUSY;int LDAP_UNAVAILABLE;int LDAP_UNWILLING_TO_PERFORM;int LDAP_LOOP_DETECT;int LDAP_NAMING_VIOLATION;int LDAP_OBJECT_CLASS_VIOLATION;int LDAP_NOT_ALLOWED_ON_NON_LEAF;int LDAP_NOT_ALLOWED_ON_RDN;int LDAP_ENTRY_ALREADY_EXISTS;int LDAP_OBJECT_CLASS_MODS_PROHIBITED;int LDAP_AFFECTS_MULTIPLE_DSAS;int LDAP_OTHER;...[] ldap_error_message;/* Generate an error message from the LDAP error code and error diagnostic. ... */ArrayIndexOutOfBoundsException exVector<LdapCtx> unsolicited;// removeUnsolicited() is invoked to remove an LdapCtx from this client.// time a method is invoked on LdapClient, an IOException is thrown.// When the connection is closed out-of-band like this, the next// NamingExceptionEvent is fired to the listeners.// If it is a DISCONNECT notification, the connection is closed and a// and informs each LdapCtx to fire an event for the notification.// LdapClient creates an UnsolicitedNotification from the response// parses the Extended Response. If there are registered listeners,// it invokes LdapClient.processUnsolicited(). processUnsolicited()// When Connection receives an unsolicited notification (msgid == 0),// When addUnsolicited() is invoked, the LdapCtx is added to the list.// LdapClient might be shared among multiple contexts.// for UnsolicitedNotifications. This is a list because a single// An LdapClient maintains a list of LdapCtx that have registered// Unsolicited notification support.// by the reader thread in Connection. Instead, sync on 'unsolicited' Vector.// NOTE: Cannot be synchronized because this is called asynchronouslyLdapCtx firstUnsolicitedNotification noticenew UnsolicitedResponseImpl(...)Vector<LdapCtx> unsolicitedCopyfireUnsolicited(...)conn.useableconn.closureReason// package private (used by LdapCtx)isPoolingAllowed(...)LdapClient answergetLdapClient(...)answer.referenceCountnew LdapClient(...)//2.5.4.35//1.3.6.1.4.1.42.2.27.4.1.8// 1.3.6.1.4.1.42.2.27.4.1.2//0.9.2342.19200300.100.1.60//0.9.2342.19200300.100.1.55//1.3.6.1.4.1.1466.101.120.35//1.3.6.1.4.1.1466.101.120.36//2.5.4.36//2.5.4.37//2.5.4.39//2.5.4.38//2.5.4.40//0.9.2342.19200300.100.1.7//0.9.2342.19200300.100.1.53//2.5.4.45// Perform LDAP bind if we are reauthenticating, using LDAPv2,// supporting failover to LDAPv2, or controls have been supplied.// anonymous bind; update name/pw for LDAPv2 retry// Skip LDAP bind for LDAPv3 anonymous bind// simple authentication// If pw was copied to a new array, clear that array as// a security precaution.// SASL authentication// re-try login using v2 if failing over// principal name not found// (map NameNotFoundException to AuthenticationException)// %%% This is a workaround for Netscape servers returning// %%% no such object when the principal name is not found// %%% Note that when this workaround is applied, it does not allow// %%% response controls to be recorded by the calling context// flush outstanding requests// build the bind request.// if authentication mechanism specified, it is SASL// SASL mechanism// Encode controls// clear internally-stored password// Read reply// init seq// msg id// handle server's credentials (if present)// Not being pooled; continue with closing// Pooled// Is this a real close or a request to return conn to pool// force closing of connection// this is a pool callback so no need to clean pool// Notify listeners// Remove from pool//optimistic// get first reply// Only send an LDAP abandon operation when clearing the search// reply from a one-level or subtree search.// OK if req got removed after check; double removal attempt// but otherwise no harm done// Send an LDAP abandon only if the search operation has not yet// completed.// clear the (previous) set of entries// clear the (previous) set of referrals// Decoder for response// Request id// Attribute set read from response// Attribute read from response// DN read from response// LDAP entry representing response// Holder for response length// Position of end of response// process search reply// req id// handle LDAPv3 search entries// handle LDAPv3 search reference// %%% Although not strictly correct, some LDAP servers//     encode the SEQUENCE OF tag in the SearchResultRef// Save referral and continue to get next search result//%%% ignore for now// Done with search// Skip the rest of the sequence because it is not what we want// handle LDAPv3 referrals (if present)// handle LDAPv3 controls (if present)// optional// control OID// critical control// Done with operation// zero values is not permitted for the add op.// no attribute value// zero values is not permitted//System.err.println("changin superior");// replace any escaped characters in the value//[0]//[1]// always v3// 5// 6// 7// 8// 10// 11// 12// 13// 14// 16// 17// 18// 19// 20// 21// 32// 33// 34// 36// 48// 49// 50// 51// 52// 53// 54// 64// 65// 66// 67// 68// 69// 71// 80// append error message from the server// append built-in error message// Parse the response// msg id; should be 0; ignored// Create an UnsolicitedNotification using the parsed data// Need a 'ctx' object because we want to use the context's// list of provider control factories.// Fire UnsolicitedNotification events to listeners// If "disconnect" notification,// notify unsolicited listeners via NamingException// no more listeners after exception// always one when starting outimport PooledConnectionFactory/** Creates an LdapClient. Encapsulates the parameters required to create ... */int connTimeout;this.connTimeoutimport LdapNameimport Rdnimport HierMemDirCtximport SearchFilterimport StartTlsResponseImpl/** The LDAP context implementation. ... */LdapClient.LDAP_REF_IGNOREnew LdapNameParser(...)new DefaultResponseControlFactory(...)new ManageReferralControl(...)new HierMemDirCtx(...)new SchemaViolationException(...)/* Used to store arguments to the search method. */String filter;SearchControls cons;...[] reqAttrs;// those attributes originally requestedthis.consthis.reqAttrsboolean HARD_CLOSE;boolean SOFT_CLOSE;// -----------------  Constants  -----------------int DEFAULT_SSL_PORT;boolean DEFAULT_DELETE_RDN;boolean DEFAULT_TYPES_ONLY;int DEFAULT_DEREF_ALIASES;int DEFAULT_LDAP_VERSION;// always derefint DEFAULT_BATCH_SIZE;int DEFAULT_REFERRAL_MODE;char DEFAULT_REF_SEPARATOR;String DEFAULT_SSL_FACTORY;// Used by LdapPoolManagerint DEFAULT_REFERRAL_LIMIT;// use Sun's SSLString STARTTLS_REQ_OID;...[] SCHEMA_ATTRIBUTES;// schema operational and user attributes// LDAP protocol version: "2", "3"// --------------- Environment property names ----------String BINARY_ATTRIBUTES;// Binary-valued attributes. Space separated string of attribute names.String DELETE_RDN;// Delete old RDN during modifyDN: "true", "false"String DEREF_ALIASES;// De-reference aliases: "never", "searching", "finding", "always"String TYPES_ONLY;// Return only attribute types (no values)String REF_SEPARATOR;// Separator character for encoding Reference's RefAddrs; default is '#'String SOCKET_FACTORY;// Socket factoryString BIND_CONTROLS;// Bind Controls (used by LdapReferralException)String REFERRAL_LIMIT;String TRACE_BER;// trace BER (java.io.OutputStream)String NETSCAPE_SCHEMA_BUG;// Get around Netscape Schema BugsString OLD_NETSCAPE_SCHEMA_BUG;// deprecatedString CONNECT_TIMEOUT;// Timeout for socket connect// for backward compatibilityString READ_TIMEOUT;// Timeout for reading responsesString ENABLE_POOL;// Environment property for connection poolingString DOMAIN_NAME;// Environment property for the domain name (derived from this context's DN)String WAIT_FOR_REPLY;// Block until the first search reply is receivedString REPLY_QUEUE_SIZE;// Size of the queue of unprocessed search repliesNameParser parser;// ----------------- Fields that don't change -----------------------ControlFactory myResponseControlFactory;// controls that Provider needsControl manageReferralControl;HierMemDirCtx EMPTY_SCHEMA;int port_number;// ------- Inherited by derived context instances// Cannot be private; used by enums// ------------ Package private instance variables ----------------// port number of serverLdapClient clnt;//   for IPv6 literals)// host name of server (no bracketsHashtable<String,Object> envprops;// connection handleint handleReferrals;// environment properties of contextboolean hasLdapsScheme;// how referral is handledString currentDN;// ------- Not inherited by derived context instances//  using an LDAPS URL.// true if the context was createdName currentParsedDN;// DN of this contextVector<Control> respCtls;...[] reqCtls;// Response controls read// ------------- Private instance variables ------------------------// Controls to be sent with each requestboolean netscapeSchemaBug;// output stream for BER debug output// workaroundint referralHopLimit;// Controls to be sent with LDAP "bind"Hashtable<String,DirContext> schemaTrees;// max referralint batchSize;// schema root of this contextboolean deleteRDN;// batch size for search resultsboolean typesOnly;// delete the old RDN when modifying DNint derefAliases;// return attribute types (no values)char addrEncodingSeparator;// de-reference alias entries during searchingHashtable<String,Boolean> binaryAttrs;// encoding RefAddr// attr values returned as byte[]// no timeout valueboolean waitForReply;int replyQueueSize;// wait for search responseboolean useSsl;// unlimited queue sizeboolean useDefaultPortNumber;// true if SSL protocol is activeboolean parentIsLdapCtx;// True if this context was created by another LdapCtx.// no port number was suppliedint hopCount;// see composeName()String url;// current referral hop countEventSupport eventSupport;// URL of context; see getURL()boolean unsolicited;// Event support helper for this ctxboolean sharable;// if there unsolicited listeners// -------------- Constructors  -----------------------------------// can share connection with other ctxthis.useSslthis.hasLdapsSchemeContext.SECURITY_PROTOCOLthis.port_numberthis.useDefaultPortNumbernew Hashtable<String,DirContext>(...)initEnv(...)Exception e2existing.useSslexisting.hasLdapsSchemeexisting.useDefaultPortNumberexisting.hostnameexisting.port_numberexisting.currentDNexisting.currentParsedDNexisting.envpropsexisting.schemaTreesexisting.clntincRefCount(...)existing.parentIsLdapCtxexisting.traceexisting.netscapeSchemaBugLdapContext clonesetRequestControls(...)// -- createSubcontext/destroySubcontext// -- rename// -- bind/rebind/unbind// --------------- Namespace Updates ---------------------c_bind(...)/* attrs == null ... */Attributes inputAttrsString newDNfullyQualifiedName(...)LdapEntry entryLdapResult answerdetermineBindAttrs(...)addRdnAttributes(...)answer.resControlsLdapReferralException eNamingException e2c_rebind(...)Attributes origAttrsAttributes keepAttrsException addExc_getAttributes(...)Attribute origObjectClassObj.OBJECT_CLASSObj.JAVA_OBJECT_CLASSES.lengthObj.JAVA_OBJECT_CLASSESObj.JAVA_OBJECT_CLASSES_LOWERObj.JAVA_ATTRIBUTES.lengthappendVector(...)Exception aeLdapResult answer2answer2.resControlsadjustDeleteStatus(...)Name oldParsedName newParsedName oldParentName newParentString newRDNString newSuperiormoddn(...)clnt.isLdapv3setNewRdn(...)c_createSubcontext(...)Attribute ocObj.STRUCTURAL/** Adds attributes from RDN to attrs if not already present. ... */List<Rdn> rdnListgetRdns(...)Rdn rdnAttributes nameAttrstoAttributes(...)Attribute nameAttrcontainsIgnoreCase(...)isCaseIgnored(...)getIDs(...)String strEntryanswer.matchedDNName origName matched/* Append the the second Vector onto the first Vector ... */// list/listBindings// lookup/lookupLink// ------------- Lookups and Browsing -------------------------SearchControls consnew SearchControls(...)doSearchOnce(...)setSearchScope(...)SearchControls.OBJECT_SCOPEsetReturningAttributes(...)setReturningObjFlag(...)LdapClient.caseIgnoreVector<Control> entryCtlsentry.respCtlsString[] classAttrsdoSearch(...)answer.referralsnew LdapNamingEnumeration(...)LimitExceededException eLdapNamingEnumeration resPartialResultException enew LdapBindingEnumeration(...)LdapBindingEnumeration res// -- getNameParser/getNameInNamespace/composeName// --------------- Name-related Methods -----------------------String ldapCompconcatNames(...)// used by LdapSearchEnumeration// getAttributes/modifyAttributes// --------------- Reading and Updating AttributessetParents(...)int jmod_opconvertToLdapModCode(...)int[] jmodsAttribute[] jattrsNamingEnumeration<? extends Attribute> aemodify(...)jmods.lengthmodifyAttributes(...)mods.lengthModificationItem modgetModificationOp(...)LdapClient.ADDLdapClient.REPLACELdapClient.DELETE// ------------------- Schema -----------------------getSchemaTree(...)Attribute objectClassAttrContext ocSchemac_getSchema(...)LdapSchemaParser.OBJECTCLASS_DEFINITION_NAMEHierMemDirCtx objectClassCtxDirContext objectClassDefString objectClassNameEnumeration<?> objectClasses/* getSchemaTree first looks to see if we have already built a ... */String subschemasubentrygetSchemaEntry(...)DirContext schemaTreebuildSchemaTree(...)/* buildSchemaTree builds the schema tree corresponding to the ... */SearchControls constraintsName sseNamingEnumeration<SearchResult> resultssearchAux(...)new Continuation(...)SearchResult resultcreateSchemaTree(...)/* getSchemaEntree returns the DN of the subschemasubentree for the ... */Attribute schemaEntryAttr// asked for their schema// Set attributes to point to this context in case some one// package-private; used by search enum./* Returns the URL associated with this context; used by LdapAttribute ... */toUrlString(...)// --------------------- Searches -----------------------------c_search(...)String filtercloneSearchControls(...)String strfilter// Used by NamingNotifierString[] tokensString[] reqAttrsLdapCtx.SearchArgsSearchArgs argsnew SearchArgs(...)getReturningAttributes(...)getReturningObjFlag(...)boolean hasWildcardreqAttrs.lengthString[] totalAttrssearchToCompare(...)compareToSearchResult(...)new LdapSearchEnumeration(...)search(...)LdapSearchEnumeration res// Perform a search. Expect 1 SearchResultEntry and the SearchResultDone.int savedBatchSizeint scopeString[] retattrsString nmint msecLimitgetTimeLimit(...)int secLimitgetCountLimit(...)getSearchScope(...)LdapClient.SCOPE_BASE_OBJECTSearchControls.ONELEVEL_SCOPELdapClient.SCOPE_ONE_LEVELSearchControls.SUBTREE_SCOPELdapClient.SCOPE_SUBTREEretattrs.length// for when to turn a search into a compare.// This function uses the documents JNDI Compare example as a model// e.g. filter "cn=Jon Ruiz" becomes, type "cn" and value "Jon Ruiz"// tokens[0] and tokens[1] to the type and value respectively.// returns true if a search can be caried out as a compare, and sets/* Certain simple JNDI searches are automatically converted to ... */String[] attrsfilterToAssertion(...)// precondition: tokens[] must be initialized and be at least of size 2.// the first and second elements of tokens respectively.// filterToAssertion will return true and pass the type and value as// (enclosing parentheses are permitted) then// If the supplied filter is a simple assertion i.e. "<type>=<value>"StringTokenizer assertionTokenizerboolean hasParensStringTokenizer illegalCharsTokenizerString[] retAttrsretAttrs.lengthgetDerefLinkFlag(...)/** Override with noncloning version. */// -------------- Environment Properties ------------------Context.REFERRALsetReferralMode(...)setBinaryAttributes(...)closeConnection(...)Context.SECURITY_AUTHENTICATIONContext.SECURITY_PRINCIPALContext.SECURITY_CREDENTIALSremoveFromEnvironment(...)setRefSeparator(...)setTypesOnly(...)setDeleteRDN(...)setDerefAliases(...)setBatchSize(...)setReferralLimit(...)setConnectTimeout(...)setReadTimeout(...)setWaitForReply(...)setReplyQueueSize(...)/** Sets the URL that created the context in the java.naming.provider.url ... *//** Sets the domain name for the context in the com.sun.jndi.ldap.domainname ... */cloneControls(...)/** Sets the batch size of this context; *//** Sets the referral mode of this context to 'follow', 'throw' or 'ignore'. ... */LdapClient.LDAP_REF_FOLLOWaddControl(...)removeControl(...)/** Set whether aliases are derefereced during resolution and searches. *//** Sets the limit on referral chains */// For counting referral hopsthis.hopCount/** Sets the connect timeout value *//** Sets the size of the queue of unprocessed search replies *//** Sets the flag that controls whether to block until the first search ... *//** Sets the read timeout value *//* Extract URLs from a string. The format of the string is: ... */int separatorint urlCountVector<Vector<String>> referralsint iURLVector<String> referral/* Argument is a space-separated list of attribute IDs ... */// ----------------- Connection  ---------------------removeUnsolicited(...)usingSaslStreams(...)clnt.referenceCountString userObject passwdString secProtocolString socketFactoryString authMechanismString verint ldapVersionboolean usePoolboolean initialauthenticate(...)authenticateCalled(...)LdapClient.LDAP_VERSION3String referralLdapURL urlNamingException saved_exgetNextReferral(...)new LdapURL(...)// Used by Enum classes to track whether it still needs contextboolean closeRequested;// ------------ Return code and Error messages  -----------------------LdapReferralException rint contRefCountLdapReferralException headLdapReferralException ptrnew LdapReferralException(...)setReferralInfo(...)setHopCount(...)ptr.nextReferralExNamingException leenew LimitExceededException(...)extractURLs(...)LdapClient.LDAP_INVALID_DN_SYNTAXLdapClient.LDAP_NAMING_VIOLATIONmapErrorCode(...)setResolvedName(...)/** Maps an LDAP error code to an appropriate NamingException. ... */LdapClient.LDAP_ALIAS_DEREFERENCING_PROBLEMLdapClient.LDAP_ALIAS_PROBLEMLdapClient.LDAP_ATTRIBUTE_OR_VALUE_EXISTSnew AttributeInUseException(...)LdapClient.LDAP_AUTH_METHOD_NOT_SUPPORTEDLdapClient.LDAP_CONFIDENTIALITY_REQUIREDLdapClient.LDAP_STRONG_AUTH_REQUIREDLdapClient.LDAP_INAPPROPRIATE_AUTHENTICATIONLdapClient.LDAP_ENTRY_ALREADY_EXISTSLdapClient.LDAP_INVALID_CREDENTIALSLdapClient.LDAP_SASL_BIND_IN_PROGRESSLdapClient.LDAP_INAPPROPRIATE_MATCHINGLdapClient.LDAP_INSUFFICIENT_ACCESS_RIGHTSnew NoPermissionException(...)LdapClient.LDAP_INVALID_ATTRIBUTE_SYNTAXLdapClient.LDAP_CONSTRAINT_VIOLATIONLdapClient.LDAP_LOOP_DETECTLdapClient.LDAP_NO_SUCH_ATTRIBUTEnew NoSuchAttributeException(...)LdapClient.LDAP_OBJECT_CLASS_MODS_PROHIBITEDLdapClient.LDAP_OBJECT_CLASS_VIOLATIONLdapClient.LDAP_NOT_ALLOWED_ON_RDNLdapClient.LDAP_NOT_ALLOWED_ON_NON_LEAFLdapClient.LDAP_OPERATIONS_ERRORLdapClient.LDAP_OTHERnew SizeLimitExceededException(...)new TimeLimitExceededException(...)LdapClient.LDAP_UNAVAILABLE_CRITICAL_EXTENSIONLdapClient.LDAP_UNAVAILABLELdapClient.LDAP_BUSYLdapClient.LDAP_UNDEFINED_ATTRIBUTE_TYPELdapClient.LDAP_UNWILLING_TO_PERFORMLdapClient.LDAP_COMPARE_FALSELdapClient.LDAP_COMPARE_TRUELdapClient.LDAP_IS_LEAF// ----------------- Extensions and Controls -------------------boolean startTLSextendedOp(...)answer.extensionValue.lengthanswer.extensionValueExtendedResponse ercreateExtendedResponse(...)answer.extensionIdString domainNamesetConnection(...)clnt.connextendedOperation(...)this.reqCtls/** Narrow controls using own default factory and ControlFactory. ... */Control[] controlsnew Control[]getControlInstance(...)int foundfindControl(...)Control[] newCtlsprevCtls.lengthControl[] copiedCtls/* Access to eventSupport need not be synchronized even though the ... */// -------------------- Events ------------------------getTargetName(...)new EventSupport(...)addUnsolicited(...)hasUnsolicited(...)/** Retrieves the target name for which the listener is registering. ... *//** Registers this context with the underlying LdapClient. ... */// package private methods for handling unsolicited notification// ------------------ Unsolicited Notification ---------------/** Removes this context from registering interest in unsolicited ... *//** Uses EventSupport to fire an event related to an unsolicited notification. ... */// SSL env prop overrides the useSsl argument// %%% These are only examined when the context is created// %%% because they are only for debugging or workaround purposes.// Nothing// inherit these debugging/workaround flags// Connection controls are inherited from environment// Set clone's request controls// setRequestControls() will clone reqCtls// Attributes supplied by caller// not cloned// retrieve response controls// Check if name is bound// Name not bound, just add it// there's an object there already, need to figure out// what to do about its attributes// we're not changing any attrs, leave old attributes alone// Remove Java-related object classes from objectclass attribute// clone so that keepAttrs is not affected// update;// remove all Java-related attributes except objectclass// remove entry// add it back using updated attrs// Attempt to restore old entry// Rethrow exception// assert (oldName instanceOf CompositeName);// permit oldName to be empty (for processing referral contexts)// extract DN & parse// CompoundName/LdapName is already parsed// Record the new RDN (for use after the referral is followed).// Cannot continue when a referral has been received and a// newSuperior name was supplied (because the newSuperior is// relative to a naming context BEFORE the referral is followed).// add structural objectclass; name needs to have "cn"// case ignore// creation successful, get back live object// Handle the empty name// Parse string name into list of RDNs// Get leaf RDN// Add attributes of RDN to attrs if not already there// If attrs already has the attribute, don't change or add to it/** When attrs.isCaseIgnored() is false, attrs.get() will ... */// %%% RL: are there any implications for referrals?// ask for all attributes// need values to construct obj// should get back 1 SearchResponse and 1 SearchResult// found it but got no attributes// retrieve entry controls// concatenate controls// set this flag to override the typesOnly flag// list result may contain continuation references// listBindings result may contain continuation references// ignore name, always return same parser// Handle compound names.  A pair of LdapNames is an easy case.// get attributes from result// do this so attributes can find their schema// nothing to do// construct mod list// retrieve the objectClass attribute from LDAP// retrieve the root of the ObjectClass schema tree// create a context to hold the schema objects representing the object// classes// %%% Should we fail if not found, or just continue?// Make context read-only// get the schema entry itself// DO ask for return object here because we need it to// create context. Since asking for all attrs, we won't// be transmitting any specific attrIDs (like Java-specific ones)./* count and time limits *//* return schema attrs *//* return obj *//* deref link *//* schema entry *//* schema attributes */// Asks for operational attribute "subschemasubentry"/* attr to return *//* returning obj */// we got an error looking for a root entry on an ldapv2// server. The server must not support schema.//System.err.println("schema entry attrs: " + schemaEntryAttr);// the server doesn't have a subschemasubentry in its root DSE.// therefore, it doesn't support schema.// return schema entry name// stores ldap compare op. values// remember what was asked// if objects are requested then request the Java attributes too// so that the objects can be constructed// check for presence of "*" (user attributes wildcard)// see if this can be done as a compare, otherwise do a search//System.err.println("compare triggered");// search result may contain referrals// ensureOpen() won't work here because// session was associated with previous connection// %%% RL: we can actually allow the enumeration to continue// using the old handle but other weird things might happen// when we hit a referral// 2 protocol elements// If cons.getReturningObjFlag() then caller should already// have make sure to request the appropriate attrs// Ldap treats null and empty array the same// need to replace with single element array// JNDI unit is milliseconds, LDAP unit is seconds.// Zero means no limit.// if scope is not object-scope, it's really a search// if attributes are to be returned, it's really a search// if the filter not a simple assertion, it's really a search// it can be converted to a compare// find the left and right half of the assertion// make sure the value does not contain a wildcard// test for enclosing parenthesis// unbalanced// make sure the left and right half are not expresions themselves// strip off enclosing parenthesis, if present// not there; just return// The following properties affect the connection// De-activate SSL and reset the context's url and port number// Update environment; reconnection will use new props// If adding null, call remove// Activate SSL and reset the context's url and port number// called by LdapCtxFactory// Make sure that referrals are to their default// Set batch size// Set separator used for encoding RefAddr// Set whether RDN is removed when renaming object// Set whether types are returned only// Set how aliases are dereferenced// Set the limit on referral chains// set referral handling// Set the connect timeout// Set the read timeout// Set the flag that controls whether to block until the first reply// is received// Set the size of the queue of unprocessed search replies// When connection is created, it will use these and other// properties from the environment// set batchsize// First determine the referral mode// If ignoring referrals, add manageReferralControl// If we're update an existing context, remove the control// else, leave alone; need not update// never de-reference aliases// de-reference aliases during searching// de-reference during name resolution// always de-reference aliases// set referral limit// a zero setting indicates no limit// disallow an empty queue// unlimited// count the number of URLs// Event (normal and unsolicited)// idempotent// Enumerations that are keeping the connection alive// %%%: RL: There is no need to set these to null, as they're just// variables whose contents and references will automatically// be cleaned up when they're no longer referenced.// Also, setting these to null creates problems for the attribute// schema-related methods, which need these to work./* schemaTrees = null; ... */// Update environment// can't share with existing contexts// open or reauthenticated// reset the cache before a new connection is established// connection is now either new or single-use// OK for others to start sharing again// authenticating user// password for authenticating user// security protocol (e.g. "ssl")// socket factory// authentication mechanism// LDAP protocol version// enable connection pooling// Whether to use connection pooling// Required for LdapClient constructor// Required for basic client identity// Required for simple client identity// Required for SASL client identity/** Pooled connections are preauthenticated; ... */// no authentication required// reauthenticating over existing connection;// only v3 supports this// retrieve (bind) response controls// hard close// Process the referrals sequentially (top level) and// recursively (per referral)// No more referrals to follow// No saved exception, something must have gone wrong// Use host/port number from referral// Try to connect again using new host/port number// follow another referral// handle Search continuation references// handle multiple sets of URLs// make a chain of LdapReferralExceptions// append ex. to end of chain// check the hop limit// only one set of URLs is present/* Handle SLAPD-style referrals. ... */// extract SLAPD-style referrals from errorMessage// build exception/* %%% ... */// %%% need new exception ?// these are really not exceptions and this code probably// never gets executed// %%% verify request.getID() == answer.extensionId// Pass the connection handle to StartTlsResponseImpl// Try own factory first// Try assigned factories if own produced null// Find it// no need to do it again// not there// Remove it// If first time asking for unsol// no activity before, so just return// If removing an Unsol listener and it is the last one, let clnt know// treat as compound name// addNamingListener must have created EventSupport already// No need to notify clnt because clnt is the// only one that can fire a NamingException to// unsol listeners and it will handle its own cleanupimport ObjectFactoryimport ldapURLContextFactoryString ADDRESS_TYPE;/** The type of each address in an LDAP reference. */// ----------------- ObjectFactory interface --------------------ObjectFactory factorynew ldapURLContextFactory(...)String[] urlsgetURLs(...)isLdapRef(...)// ----------------- InitialContext interface  --------------------String providerUrlLdapCtx.DEFAULT_HOSTLdapCtx.DEFAULT_PORTgetLdapCtxInstance(...)Control[] bindCtlsLdapCtx.BIND_CONTROLS/** Returns true if argument is an LDAP reference. */String thisClassNamegetFactoryClassName(...)/** Returns the URLs contained within an LDAP reference. */Enumeration<RefAddr> addrsString[] urls2// ------------ Utilities used by other classes ----------------getUsingURL(...)getUsingURLs(...)DirContext ctxLdapURL ldapUrlString dngetDN(...)String hostString[] hostportsmapDnToDomainName(...)getLdapService(...)String schemegetScheme(...)String[] newUrlshostports.lengthString querygetQuery(...)String urlSuffixsetDomainName(...)useSsl(...)/* Try each URL until one of them succeeds. ... */AuthenticationException e/** Used by Obj and obj/RemoteToAttrs too so must be public */Vector<String> vString[] typesgetTypeNames(...)BasicAttribute tAttrObj.TYPENAMEClass<?>[] membersString[] retgetClassesAux(...)members.length// If URL not in environment, use defaults// Extract URL(s)// Generate an LDAP context// number of URLs// Trim URL array down to size.// handle a URL with no hostport (ldap:/// or ldaps:///)// locate the LDAP service using the URL's distinguished name// Generate new URLs that include the discovered hostports.// Reuse the original URL scheme.// Associate the derived domain name with the context// Record the URL that created the context/** A holder for an LDAP entry read from an LDAP server. ... */String DN;Attributes attributes;this.DNthis.attributesthis.respCtlsimport BasicAttributes/** <code>LdapName</code> implements compound names for LDAP v3 as ... */String unparsed;Vector<Rdn> rdns;// if non-null, the DN in unparsed formboolean valuesCaseSensitive;// parsed name components/** Constructs an LDAP name from the given DN. ... *//* Constructs an LDAP name given its parsed components and, optionally ... */this.rdns/* Constructs an LDAP name given its parsed components (the elements ... */new Vector<Rdn>(...)LdapName thatthat.rdnsthat.unparsedRdn rdn1Rdn rdn2Enumeration<Rdn> enum_int len1int len2/** Controls whether string-values are treated as case-sensitive ... *//* Helper method for startsWith() and endsWith(). ... */LdapName lnln.rdnsString rdnStringgetRdn(...)new DnParser(...)/* If "suffix" is not an LdapName, each of its components is parsed as ... */LdapName ss.rdnsDnParser pString compgetDn(...)/* Best guess as to what RFC 2253 means by "whitespace". *//** Given the value of an attribute, returns a string suitable ... */escapeValue(...)/** Given an attribute value formated according to RFC 2253, ... */unescapeValue(...)/** Serializes only the unparsed DN, for compactness and to avoid ... *//* DnParser implements a recursive descent parser for a single DN. */...[] chars;// DN being parsed// characters in LDAP name being parsedint cur;// length of "chars"// index of first unconsumed char in "chars"/* Given an LDAP DN in string form, returns a parser for it. */this.valuesCaseSensitive/* Parses the DN, returning a Vector of its RDNs. */Vector<Rdn> rdnsparseRdn(...)/* Parses the DN, if it is known to contain a single RDN. *//* Parses the next RDN and returns it.  Throws an exception if ... */new Rdn(...)String attrTypeparseAttrType(...)parseAttrValue(...)consumeWhitespace(...)new TypeAndValue(...)/* Returns the attribute type that begins at the next unconsumed ... */isLetterOrDigit(...)/* Returns the attribute value that begins at the next unconsumed ... */parseBinaryAttrValue(...)parseQuotedAttrValue(...)parseStringAttrValue(...)int escatTerminator(...)/* Returns true if next unconsumed character is one that terminates ... *//* Class Rdn represents a set of TypeAndValue. */new Vector<TypeAndValue>(...)Vector<TypeAndValue> tvs;/* A vector of the TypeAndValue elements of this Rdn. ... */// Compare TypeAndValue components one by one, lexicographically.Rdn thatthat.tvsTypeAndValue tvgetUnescapedValue(...)/* Class TypeAndValue represents an attribute type and its ... */boolean binary;// value, escaped or quotedboolean valueCaseSensitive;String comparable;// for comparison using String.compareTo().// If non-null, a canonical represention of the value suitablethis.valueCaseSensitiveTypeAndValue thatcompareToIgnoreCase(...)that.typegetValueComparable(...)/* Returns the type. *//* Returns the unescaped value. *//* Returns a canonical representation of "value" suitable for ... *//* Given the value of an attribute, returns a string suitable ... */escapeBinaryValue(...)escapeStringValue(...)/* Given the value of a string-valued attribute, returns a ... */String escapeesint leadint trail/* Given the value of a binary attribute, returns a string ... */forDigit(...)/* Given an attribute value formated according to RFC 2253, ... */decodeHexPairs(...)byte[] utf8getUtf8Octets(...)utf8.length/* Given an array of chars (with starting and ending indexes into it) ... *//* Given an array of chars (with starting and ending indexes into it), ... */byte[] res// check possible shortcuts// Compare RDNs one by one, lexicographically.// Compare a single pair of RDNs.// longer DN wins// Sum up the hash codes of the components.// For each RDN...// clear any cached information// no longer valid// leave room for growth// consume '='// consume '+'// Back out any trailing spaces.// consume '#'// consume '"'// consume backslash, then what follows// no closing quote// consume closing quote// index of the most recently escaped character// 'twas backslash followed by nothing// Trim off (unescaped) trailing whitespace.// Set i to index of first element greater than tv, or to// tvs.size() if there is none.// tv is a duplicate:  ignore it// Compare a single pair of type/value pairs.// longer RDN wins// For each type/value pair...// NB: Any change here affecting equality must be//     reflected in hashCode().// try shortcut// NB:  Any change here must be reflected in hashCode().// If two objects are equal, their hash codes must match.// return cached result// cache result// Find leading and trailing whitespace.// index of first char that is not leading whitespace// index of last char that is not trailing whitespace// Trim off leading and trailing whitespace.// Add back the trailing whitespace with a preceding '\'// (escaped or unescaped) that was taken off in the above// loop. Whether or not to retain this whitespace is// decided below.// Value is binary (eg: "#CEB1DF80").// Trim off quotes.// index of the last escaped character// skip backslash// snarf escaped char// Convert hex-encoded UTF-8 to 16-bit chars.// snarf unescaped char// Get rid of the unescaped trailing whitespace with the// preceding '\' character that was previously added back.// allow enough room// index of first unused byte in utf8/* For testing. */String defaultClassName;new NameClassPairWithControls(...)// use the Java classname if presentimport PoolCleanerimport Pool/** Contains utilities for managing connection pools of LdapClient. ... */new Pool[]StringTokenizer parserString mechString protofindPool(...)new Pool(...)new PoolCleaner(...)showStats(...)String DEBUG;boolean trace;String POOL_AUTH;// Authentication mechanisms of connections that may be pooled// ---------- System properties for connection poolingString POOL_PROTOCOL;// Protocol types of connections that may be pooledString MAX_POOL_SIZE;// Maximum number of identical connections per poolString PREF_POOL_SIZE;// Preferred number of identical connections per poolString INIT_POOL_SIZE;// Initial number of identical connections per poolString POOL_TIMEOUT;// Milliseconds to wait before closing idle connectionsString SASL_CALLBACK;// Properties for DIGESTint DEFAULT_MAX_POOL_SIZE;// --------- Constantsint DEFAULT_PREF_POOL_SIZE;int DEFAULT_INIT_POOL_SIZE;int DEFAULT_TIMEOUT;String DEFAULT_AUTH_MECHS;// no timeoutString DEFAULT_PROTOCOLS;int SIMPLE;// indices into poolsint DIGEST;long idleTimeout;// --------- static fieldsint maxSize;// ms to wait before closing idle connint prefSize;// max num of identical conns/poolint initSize;// preferred num of identical conns/poolboolean supportPlainProtocol;// initial num of identical conns/poolboolean supportSslProtocol;...[] pools;// List of pools used for different auth types// Cannot instantiate one of these/** Find the index of the pool for the specified mechanism. If not ... *//** Determines whether pooling is allowed given information on how ... */String COMPARATORboolean foundSockCmpd(...)/** Obtains a pooled connection that either already exists or is ... */ClientId idPool poolnew ClientId(...)new SimpleClientId(...)new DigestClientId(...)getPooledConnection(...)new LdapClientFactory(...)pools.length/** Closes idle connections idle since specified time. ... */expire(...)Integer valLong val// Determine supported authentication mechanisms// Determine supported protocols// Create cleaner to expire idle connections// Requesting plain protocol but it is not supported// Requesting ssl protocol but it is not supported// pooling of custom socket factory is possible only if the// socket factory interface implements java.util.comparator// Cannot use pooling if authMech is not a supported mechs// Cannot use pooling if authMech contains multiple mechs// Provider won't be able to determine connection identity// if an alternate callback handler is used// Create base identity for LdapClient// Add identity information used in simple authentication// Add user/passwd/realm/authzid/qop/strength/maxbuf/mutual/policy*/** A context for handling referrals. ... */DirContext refCtx;Name urlName;String urlAttrs;// override the supplied nameString urlScope;// override attributesString urlFilter;// override scope// override filterboolean skipThisReferral;NamingException previousEx;this.skipThisReferralnew Hashtable<String,Control[]>(...)connCtls.lengthnew StringRefAddr(...)initDefaults(...)String urlStringgetScope(...)toName(...)overrideName(...)getNewRdn(...)NamingEnumeration<NameClassPair> nesetNameResolved(...)NamingEnumeration<Binding> begetNameParser(...)addToEnvironment(...)getEnvironment(...)getSchemaClassDefinition(...)NamingEnumeration<SearchResult> seoverrideFilter(...)overrideAttributesAndScope(...)// ---------------------- LdapContext ---------------------reconnect(...)getConnectControls(...)getRequestControls(...)getResponseControls(...)// ---------------------- Private methods  ---------------------/* Use the DN component from the LDAP URL (if present) to override the ... *//* Use the attributes and scope components from the LDAP URL (if present) ... */SearchControls urlCons/* Use the filter component from the LDAP URL (if present) to override the ... */// don't create a DirContext for this referral// Make copies of environment and connect controls for our own use.// Remove old connect controls from environment, unless we have new// ones that will override them anyway.// Add copied controls to environment, replacing any old ones.// Create a Reference containing the referral URL.// mask the exception and save it for later// parse URL// Not an LDAP URL; use original URL// reuse original name if URL DN is absent// concatenate with remaining name if URL DN is present// append (referrals from) the exception that generated this// context to the new search results, so that referral processing// can continue// context to the new exception, so that referral processing// record the exception if there are no remaining referrals// %%% VR - setNameResolved(true);/** This exception is raised when a referral to an alternative context ... */// ----------- fields initialized in constructor ---------------Hashtable<?,?> envprops;String nextName;Vector<?> referrals;// ----------- fields that have defaults -----------------------int referralIndex;// alternatives,set by setReferralInfo()int referralCount;// index into referralsboolean foundEntry;// count of referrals// will stop when entry is foundNamingException errorEx;String newRdn;LdapReferralException nextReferralEx;/** Constructs a new instance of LdapReferralException. ... */// referral ex. chainthis.envpropsthis.nextNamethis.handleReferrals/** Gets a context at which to continue processing. ... */new LdapReferralContext(...)/** Gets referral information. *//** Marks the current referral as one to be retried. *//** Marks the current referral as one to be ignored. ... */ReferralException e/** Sets referral information. */this.referrals/** Gets the next referral. When the current set of referrals have ... *//** Appends the supplied (chain of) referral exception onto the end of ... */LdapReferralException frontback.nextReferralEx/** Tests if there are any referrals remaining to be processed. ... *//** Tests if there are any referral exceptions remaining to be processed. *//** Sets the counter which records the number of hops that result ... *//** Sets the flag to indicate that the target name has been resolved. *//** Sets the exception generated while processing a referral. ... *//** Gets the new RDN name. *//** Sets the new RDN name so that the rename operation can be completed ... */this.newRdn/** Gets the exception generated while processing a referral. *//** Display the state of each element in a chain of LdapReferralException ... */dumpState(...)/** Display the state of this LdapReferralException object. */// If following referral, request controls are passed to referral ctx// decrement index// advance to next referral// mask the referral exception// %%% continuationRef is currently ignored// trim//advance the saved exception// don't append onto itself// Locate the end of the current chain// append//record the referral exception that caused itimport BlockingQueueimport LinkedBlockingQueueLdapRequest next;int msgId;// Set/read in synchronized Connection methodsint gotten;// read-onlyBlockingQueue<BerDecoder> replies;int highWatermark;boolean cancelled;boolean pauseAfterReceipt;boolean completed;this.msgIdthis.pauseAfterReceiptthis.repliesnew LinkedBlockingQueue<BerDecoder>(...)LdapClient.LDAP_REP_RESULTBerDecoder reply// 80% capacity// Unblock reader of pending request// Should only ever have atmost one waiter// Add a new reply to the queue of unprocessed replies.// peek at the BER buffer to check if it is a SearchResultDone PDU// notify anyone waiting for reply/* If a queue capacity has been set then trigger a pause when the ... */// trigger the pause/* Remove a reply if the queue is not empty. ... *//** %%% public for use by LdapSasl %%% */String matchedDN;// %%% public for use by LdapSaslString errorMessage;Vector<Vector<String>> referrals;// Vector<String | Vector<String>>Vector<Control> resControls;...[] serverCreds;String extensionId;...[] extensionValue;// string OID// result that looks like it came from a search.// carried out as a compare. In this case, the client still expects a// useful when the caller asked the context to do a search, but it was// into one that looks like it came from a search operation. This is// This function turns an LdapResult that came from a compare operation// BER OCTET STRINGboolean successful/** This is the class used to implement LDAP's GetSchema call. ... */int LEAF;int SCHEMA_ROOT;// schema object (e.g. attribute type defn)int OBJECTCLASS_ROOT;// schema tree rootint ATTRIBUTE_ROOT;// root of object class subtreeint SYNTAX_ROOT;// root of attribute type subtreeint MATCHRULE_ROOT;// root of syntax subtreeint OBJECTCLASS;// root of matching rule subtreeint ATTRIBUTE;// an object class definitionint SYNTAX;// an attribute type definitionint MATCHRULE;// a syntax definitionSchemaInfo info;// a matching rule definitionboolean setupMode;int objectType;LdapSchemaParser parsernew LdapSchemaParser(...)SchemaInfo allinfonew SchemaInfo(...)LdapSchemaCtx rootnew LdapSchemaCtx(...)LDAP2JNDISchema(...)// Called by createNewCtxthis.objectTypethis.info// override HierMemDirCtx.close to prevent premature GC of shared data// treat same as createSubcontext// override to ignore obj and use attrsLdapSchemaCtx newEntrydoCreateSubcontext(...)addServerSchema(...)doBind(...)// override to use bind() insteaddoLookup(...)doRebind(...)LdapSchemaCtx targetdeleteServerSchema(...)target.attrsdoUnbind(...)doRename(...)doDestroySubcontext(...)// Called to create oc, attr, syntax or matching rule roots and leaf entriesLdapSchemaCtx answeranswer.objectTypeanswer.setupModeBasicAttributes copyNamingEnumeration<? extends Attribute> attrsdoModifyAttributes(...)Attributes copydeepClone(...)applyMods(...)modifyServerSchema(...)// if necessary// Default is to create LEAF objects; caller will change after creation// we override this so the superclass creates the right kind of contextsLdapSchemaCtx ctxAttribute schemaAttrAttributes holderstringifyObjDesc(...)info.parserstringifyAttrDesc(...)stringifySyntaxDesc(...)stringifyMatchRuleDesc(...)/** When we delete an entry, we use the original to make sure that ... */Attribute origAttrValModificationItem[] modsnew ModificationItem[]new ModificationItem(...)/** When we modify an entry, we use the original attribute value ... */Attribute newAttrValLdapCtx schemaEntry;String schemaEntryName;LdapSchemaParser parser;this.schemaEntryNamethis.schemaEntrythis.parserschemaEntry.port_numberschemaEntry.hostnameschemaEntry.hasLdapsSchemereopenEntry(...)// Update server// Update in-memory copy// always ignore factories// Lookup entry from memory// Apply modifications to copy// Update server copy//System.err.println((String)schemaAttr.get());// Use subschemasubentry name as DN/** Netscape's 3.1 servers have some schema bugs: ... */// do debuggingString OBJECTCLASSDESC_ATTR_ID;// names of attribute IDs in the LDAP schema entryString ATTRIBUTEDESC_ATTR_ID;String SYNTAXDESC_ATTR_ID;String MATCHRULEDESC_ATTR_ID;String OBJECTCLASS_DEFINITION_NAME;// information for creating internal nodes in JNDI schema tree...[] CLASS_DEF_ATTRS;String ATTRIBUTE_DEFINITION_NAME;...[] ATTR_DEF_ATTRS;String SYNTAX_DEFINITION_NAME;...[] SYNTAX_DEF_ATTRS;String MATCHRULE_DEFINITION_NAME;...[] MATCHRULE_DEF_ATTRS;char SINGLE_QUOTE;// special tokens used in LDAP schema descriptionschar WHSP;char OID_LIST_BEGIN;char OID_LIST_END;char OID_SEPARATOR;String NUMERICOID_ID;// common IDsString NAME_ID;String DESC_ID;String OBSOLETE_ID;String SUP_ID;String PRIVATE_ID;String ABSTRACT_ID;// Object Class specific IDsString STRUCTURAL_ID;String AUXILARY_ID;String MUST_ID;String MAY_ID;String EQUALITY_ID;// Attribute Type specific IDsString ORDERING_ID;String SUBSTR_ID;String SYNTAX_ID;String SINGLE_VAL_ID;String COLLECTIVE_ID;String NO_USER_MOD_ID;String USAGE_ID;String SCHEMA_TRUE_VALUE;// The string value we give to boolean variablesboolean netscapeBug;// To get around writing schemas that crash Netscape serverthis.netscapeBugAttribute objectClassesAttrAttribute attributeDefAttrAttribute syntaxDefAttrAttribute matchRuleDefAttrobjectDescs2ClassDefs(...)attrDescs2AttrDefs(...)syntaxDescs2SyntaxDefs(...)matchRuleDescs2MatchRuleDefs(...)NamingEnumeration<?> objDescsAttributes objDefLdapSchemaCtx classDefTreeString currentNameLdapSchemaCtx.OBJECTCLASS_ROOTString objDescObject[] defdesc2Def(...)LdapSchemaCtx.OBJECTCLASSNamingEnumeration<?> attrDescsAttributes attrDefLdapSchemaCtx attrDefTreeLdapSchemaCtx.ATTRIBUTE_ROOTString attrDescLdapSchemaCtx.ATTRIBUTENamingEnumeration<?> syntaxDescsAttributes syntaxDefLdapSchemaCtx syntaxDefTreeLdapSchemaCtx.SYNTAX_ROOTString syntaxDescLdapSchemaCtx.SYNTAXNamingEnumeration<?> matchRuleDescsAttributes matchRuleDefLdapSchemaCtx matchRuleDefTreeLdapSchemaCtx.MATCHRULE_ROOTString matchRuleDescLdapSchemaCtx.MATCHRULEboolean moreTagsreadNumericOID(...)skipWhitespace(...)readNextTag(...)// sequince ending at the given position.// returns the index of the first whitespace char of a linear whitspaceint beginString tagNameString[] valuesint trailingSpacereadTag(...)readQDescrs(...)readQDString(...)readWOID(...)readOIDs(...)readQDStrings(...)/** dstring         = 1*utf8 ... *//** ; object descriptors used as schema element names ... */readQDescrList(...)/** qdescrlist      = [ qdescr *( qdescr ) ] ... */Vector<String> valuesString[] answerString[] oneanswer.length/* oids            = woid / ( "(" oidlist ")" ) ... */int curint wsBeginfindTrailingWhitespace(...)/** Translate attributes that describe an object class into the ... *//* static Attributes JNDI2LDAPSchema(DirContext schemaRoot) ... */// into RFC2252 format for storage back into the LDAP directory// Methods that are used for translating a node in the schema tree// ----------------- "unparser" methodsStringBuffer objectDescwriteNumericOID(...)writeQDescrs(...)writeQDString(...)writeOIDs(...)writeQDStrings(...)/** Translate attributes that describe an attribute definition into the ... */StringBuffer attrDescwriteWOID(...)/** Translate attributes that describe an attribute syntax definition into the ... */StringBuffer syntaxDesc/** Translate attributes that describe an attribute matching rule ... */StringBuffer matchRuleDesc/* qdescr          = whsp "'" descr "'" whsp *//** qdescrs         = qdescr / ( whsp "(" qdescrlist ")" whsp ) ... */StringBuffer qdListNamingEnumeration<?> valuesStringBuffer oidList/** Returns an attribute for updating the Object Class Definition schema ... */Attribute objDescAttrclassDef2ObjectDesc(...)/** Returns an attribute for updating the Attribute Definition schema attribute */Attribute attrDescAttrattrDef2AttrDesc(...)/** Returns an attribute for updating the Syntax schema attribute */Attribute syntaxDescAttrsyntaxDef2SyntaxDesc(...)/** Returns an attribute for updating the Matching Rule schema attribute */Attribute matchRuleDescAttrmatchRuleDef2MatchRuleDesc(...)// create the class def subtree// error occurred while parsing, ignore current entry// create the AttributeDef subtree// create the SyntaxDef subtree// create the MatchRuleDef subtree//System.err.println(desc);// tolerate missing leading space// Always begins with <whsp numericoid whsp>// name is OID by default// use NAME attribute as name// get the name and values of the attribute to return// tolerate a schema that omits the trailing space// make sure at least one value was returned// create the attribute, using the first value// add other values if there are any// move parser past tag name// names[0] is NAME// oid list for object class; WOID for attribute// otherwise it's a schema element with a quoted string value// make sure the qdstring end symbol is there// skip '('// skip ')'// %%% workaround for Netscape schema bug// Single OID// Multiple OIDs// extract attributes by ID to guarantee ordering// process any remaining attributes// use enumeration because attribute ID is not known// skip those already processed// opening parens// add closing parens// write QDList// %%% write out as list to avoid crashing server// write OID ListName startName;LdapCtx.SearchArgs searchArgs;// prefix of names of search resultsargs.nameString relStartString relHomeboolean relativeCompositeName rcnSearchResult srhomeCtx.currentParsedDNhomeCtx.hostnamehomeCtx.port_numberhomeCtx.hasLdapsSchemesearchArgs.conssearchArgs.reqAttrsAttributes rattrsnew SearchResultWithControls(...)new SearchResult(...)searchArgs.namesearchArgs.filterLdapSearchEnumeration sese.startName/* listArg */// fully qualified name of starting context of search// name relative to starting search context// name relative to homeCtx.currentDN// whether relative to currentDN// System.err.println("dn string: " + dn);// System.err.println("dn name: " + parsed);// could not parse name// Name relative to search context// Name relative to homeCtx//System.err.println("relStart: " + cn);//System.err.println("relHome: " + rcn);// Fix attributes to be able to get schema// only generate object when requested// Entry contains Java-object attributes (ser/ref object)// Call getObjectInstance before removing unrequested attributes// rcn is either relative to homeCtx or a fully qualified DN// remove Java attributes from result, if necessary// Even if CLASSNAME attr not there, there might be some// residual attributes// create an attribute set for those requested// caseignore// Remove Java-object attributes if not requested/* name in search result is either the stringified composite name ... */// a referral has been followed so do not create relative names// Update search-specific variables//VR - keep original args, don't overwite with current args//      searchArgs = se.searchArgs;/* Extract components of an LDAP URL. ... */String attributes;String scope;String extensions;/** Creates an LdapURL object from an LDAP URL string. */parsePathAndQuery(...)/** Returns true if the URL is an LDAPS URL. *//** Returns the LDAP URL's distinguished name. *//** Returns the LDAP URL's attributes. *//** Returns the LDAP URL's scope. *//** Returns the LDAP URL's filter. *//** Returns the LDAP URL's extensions. *//** Given a space-separated list of LDAP URLs, returns an array of strings. */String[] trimmed/** Derermines whether an LDAP URL has query components. *//* Assembles an LDAP or LDAPS URL string from its components. ... */String hString pString d/* Parses the path and query components of an URL and sets this ... */int currentIndexint nextQmark// scheme, host, port, path, query// DN, attributes, scope, filter, extensions// IPv6 literal// UTF8 should always be supported// path begins with a '/' or is empty// query begins with a '?' or is null// attributes:// scope:// filter:// extensions:/* public static void main(String[] args) throws Exception { ... *//** This class implements the LDAPv3 Request Control for manageDsaIT as ... *//** The manage referral control's assigned object identifier ... *//** Constructs a manage referral critical control. *//** Constructs a manage referral control. ... *//** Gathers information to generate events by using the Persistent Search ... */Vector<NamingListener> namingListeners;LdapCtx context;EventContext eventSrc;EventSupport support;NamingEnumeration<SearchResult> results;NotifierArgs info;// package private; used by EventSupport to remove itControl psearchthis.supportnew PersistentSearchControl(...)info.maskControl.CRITICALnew Vector<NamingListener>(...)// package private; used by EventSupport; namingListener already synchronized/** Execute "persistent search". ... */Continuation contSearchResult siControl[] respctlsEntryChangeResponseControl eclong changeNuminfo.filterinfo.controlssetStartName(...)context.currentParsedDNgetControls(...)respctls.lengthgetChangeNumber(...)getChangeType(...)EntryChangeResponseControl.ADDfireObjectAdded(...)EntryChangeResponseControl.DELETEfireObjectRemoved(...)EntryChangeResponseControl.MODIFYfireObjectChanged(...)EntryChangeResponseControl.RENAMEfireObjectRenamed(...)getPreviousDN(...)InterruptedNamingException efireNamingException(...)removeDeadNotifier(...)/** Stop the dispatcher so we can be destroyed. ... *//** Fire an "object added" event to registered NamingListeners. */NamingEvent enew NamingEvent(...)NamingEvent.OBJECT_ADDED/** Fire an "object removed" event to registered NamingListeners. */NamingEvent.OBJECT_REMOVED/** Fires an "object changed" event to registered NamingListeners. */Binding oldBdisRelative(...)NamingEvent.OBJECT_CHANGED/** Fires an "object renamed" to registered NamingListeners. */NamingEvent.OBJECT_RENAMEDLdapName dnString relDN/* no info about original entry(s) *//* additional info about changes */// Add psearch control to existing list// Change root of search results so that it will generate// names relative to the event context instead of that// named by nm// Just process ECs; ignore all the rest// %%% Should be checking OID instead of class// %%% in case using someone else's  EC ctl// Fire event to notify NamingExceptionEvent listeners// This notifier is no longer valid// this will abandon the search// Name hasn't changed; construct old binding using name from new binding/* not relative name *//** This class holds the information in an event registration/deregistration ... */int ADDED_MASK;int REMOVED_MASK;int CHANGED_MASK;int RENAMED_MASK;// these fields are package private; used by NamingEventNotifierSearchControls controls;int mask;EventContext.ONELEVEL_SCOPE// checks name, filter, controlsNotifierArgs targetcheckControls(...)target.masktarget.nametarget.filtertarget.controlscheckStringArrays(...)s2.lengthint sum;// save from having to recalculate each timecontrolsCode(...)// used in calculating hash code// if scope is not default, create search ctl and set it// ctls are nonempty// both are nonnullimport DirStateFactoryimport BASE64Encoderimport BASE64Decoder/** Class containing static methods and constants for dealing with ... */getVersionHelper(...)VersionHelper helper;// package private; used by Connection// Make sure no one can create one...[] JAVA_ATTRIBUTES;// LDAP attributes used to support Java objects.int OBJECT_CLASS;int SERIALIZED_DATA;int CLASSNAME;int FACTORY;int CODEBASE;int REF_ADDR;int TYPENAME;int REMOTE_LOC;...[] JAVA_OBJECT_CLASSES;// LDAP object classes to support Java objects...[] JAVA_OBJECT_CLASSES_LOWER;int STRUCTURAL;int BASE_OBJECT;// structural object classint REF_OBJECT;// auxiliary java object classint SER_OBJECT;// auxiliary reference object classint MAR_OBJECT;// auxiliary serialized object class/** Encode an object in LDAP attributes. ... */// auxiliary marshalled object classboolean structuralencodeReference(...)getReference(...)serializeObject(...)Attribute tAttrcreateTypeNameAttr(...)/** Each value in javaCodebase contains a list of space-separated ... */Vector<String> vec/* Decode an object from LDAP attribute(s). ... */String[] codebasesgetCodebases(...)getURLClassLoader(...)deserializeObject(...)decodeRmiObject(...)decodeReference(...)/** Convert a Reference object into several LDAP attributes. ... */getFactoryClassLocation(...)Attribute refAttrRefAddr refAddrBASE64Encoder encodernew BASE64Encoder(...)/* A RMI object is stored in the directory as ... *//* Restore a Reference object from several LDAP attributes */String factorynew InvalidAttributesException(...)String posnStrchar separatorint sepint posnBASE64Decoder decoderVector<RefAddr> refAddrListnew Vector<RefAddr>(...)NamingEnumeration<?> valssetElementAt(...)RefAddr radecodeBuffer(...)new BASE64Decoder(...)/* Serialize an object into a byte array */ObjectOutputStream serial/* Deserializes a byte array into an object. */ByteArrayInputStream bytesObjectInputStream deserialnew LoaderInputStream(...)/** Returns the attributes to bind given an object and its attributes. */DirStateFactory.ResultResult resboolean ocNeedsCloningAttribute objectClassencodeObject(...)/** An ObjectInputStream that uses a class loader to find classes. */ClassLoader classLoader;ClassLoader nonPublicLoaderboolean hasNonPublicInterfaceClass<?>[] classObjsModifier.PUBLICnew IllegalAccessError(...)getProxyClass(...)// Deprecated// References// Serializable Object// DirContext Object//      System.err.println(attrs);// Get codebase, which is used in all 3 cases.// For backward compatibility only// Get original object's types if caller has not explicitly// specified other type names/* string encoding of a RefAddr is either: ... *//* Temporary Vector for decoded RefAddr addresses - used to ensure ... */// first character denotes encoding separator// skip over separator// extract position within Reference// skip over position and trailing separator// extract type// skip over type and trailing separator// extract content// Empty content// Double separators indicate a non-StringRefAddr// Content is a Base64-encoded serialized RefAddr// skip over consecutive separator// %%% RL: exception if empty after double separator// Single separator indicates a StringRefAddr// Copy to real reference// Create ObjectInputStream for deserialization// Call state factories to convert object and attrs// We're only storing attributes; no further processing required//if object to be bound is a DirContext extract its attributes// Create "objectClass" attribute// No objectclasses supplied, use "top" to start// Get existing objectclass attribute// %%% workaround// convert the supplied object into LDAP attributes// System.err.println("Determined: " + attrs);// %%% Should use Class.forName(desc.getName(), false, classLoader);// except we can't because that is only available on JDK1.2// define proxy in class loader of non-public interface(s), if any/** This class implements the LDAPv3 Request Control for the persistent search ... *//** The persistent search control's assigned object identifier ... *//** Indicates interest in entries which have been added. *//** Indicates interest in entries which have been deleted. *//** Indicates interest in entries which have been modified. *//** Indicates interest in entries which have been renamed. *//** Indicates interest in entries which have been added, deleted, ... */int changeTypes;/** The change types of interest. All changes, by default. ... */boolean changesOnly;/** Return original entries and changed entries or only changed entries. ... */boolean returnControls;/** Return entry change controls. ... *//** Constructs a persistent search non-critical control. ... */super.valuesetEncodedValue(...)/** Constructs a persistent search control. ... */this.changeTypesthis.changesOnlythis.returnControls/* Sets the ASN.1 BER encoded value of the persistent search control. ... */getTrimmedBuf(...)// build the ASN.1 encodingimport NamingEnumeration/** This class discovers the location of LDAP services by querying DNS. ... */String SRV_RR;...[] SRV_RR_ATTR;Random random;/** Maps a distinguished name (RFC 2253) to a fully qualified domain name. ... */StringBuffer domainLdapName ldapNameObject attrval/** Locates the LDAP service for a given domain. ... */String dnsUrlgetURLContext(...)int numRecordsSrvRecord[] srvRecordsnew SrvRecord[]new SrvRecord(...)SrvRecord[] trimmedextractHostports(...)/** Extract hosts and port numbers from a list of SRV records. ... */int headint tailint sublistLengthsrvRecords.length...[...].priorityselectHostport(...)/* Randomly select a service record in the range [head, tail] and return ... */String hostport...[...].hostport...[...].weight...[...].sum/** This class holds a DNS service (SRV) record. ... */int priority;int weight;String hostport;/** Creates a service record object from a string record. ... */String port/* Sort records in ascending order of priority value. For records with ... */that.prioritythat.weight// process RDNs left-to-right//List<Rdn> rdnList = ldapName.getRdns();//Rdn rdn = rdnList.get(i);// single-valued RDN with a DC attribute// reset (when current or previous//        RDN value is "DC=.")// reset (when binary-valued attribute)// reset (when multi-valued RDN or non-DC)// Create the DNS context using NamingManager rather than using// the initial context constructor. This avoids having the initial// context constructor call itself (when processing the URL// argument in the getAttributes call).// cannot create a DNS context// create the service records// ignore bad value// Sort the service records in ascending order of their// priority value. For records with equal priority, move// those with weight 0 to the top of the list.// extract the host and port number from each service record// find the head and tail of the list of records having the same// priority value.// select hostports from the sublist// compute the running sum for records between head and tail// If all records have zero weight, select first available one;// otherwise, randomly select a record according to its weight// make this record unavailable// this > that// this < that// this == that/** Represents the identity of a 'simple' authenticated LDAP connection. ... */Object passwd;this.usernameSimpleClientId otherother.usernameother.passwd// JDK1.2// omit password for security/** A concrete implementation of an UnsolicitedNotification. ... */String oid;...[] referrals;NamingException exception;this.oidthis.extensionValue/** Retrieves the object identifier of the response. ... *//** Retrieves the ASN.1 BER encoded value of the LDAP extended operation ... *//** Retrieves the referral(s) sent by the server. ... *//** Retrieves the exception as constructed using information ... */// ref is a list of single-String Vectors// matchedDN ignored for now; could be used to set resolvedName// exception.setResolvedName(new CompositeName().add(matchedDN));URL[] urlArraynew URL[]url.lengthurlArray.length// Disallow anyone from creating one of these.// 1.2 test// Use 1.1 helper if 1.2 test fails, or if we cannot create 1.2 helperimport URLClassLoaderString TRUST_URL_CODEBASE_PROPERTY;// arbitrary URL code base.// System property to control whether classes may be loaded from anString trustURLCodebase;// Determine whether classes may be loaded from an arbitrary URL code base.// Disallow external from creating one of these.ClassLoader parentgetUrlArray(...)newThreadWithAcc(...)getJavaLangAccess(...)/* Classes may only be loaded from an arbitrary URL code base when ... */// 4290486: doPrivileged is needed to create a thread in// an environment that restricts "modifyThreadGroup".import SSLSessionimport SSLSocketFactoryimport SSLPeerUnverifiedExceptionimport HostnameVerifierimport HostnameChecker/** This class implements the LDAPv3 Extended Response for StartTLS as ... */int DNSNAME_TYPE;/* The dNSName type in a subjectAltName extension of an X.509 certificate *//* The server's hostname. */Connection ldapConnection;/* The LDAP socket. */InputStream originalInputStream;/* The original input stream. */OutputStream originalOutputStream;/* The original output stream. */SSLSocket sslSocket;/* The SSL socket. */SSLSocketFactory defaultFactory;/* The SSL socket factories. */SSLSocketFactory currentFactory;...[] suites;/* The list of cipher suites to be enabled. */HostnameVerifier verifier;/* The hostname verifier callback. */boolean isClosed;/* The flag to indicate that the TLS connection is closed. */// public no-arg constructor required by JDK's Service Provider API./** Overrides the default list of cipher suites enabled for use on the ... */this.suites/** Overrides the default hostname verifier used by <tt>negotiate()</tt> ... */this.verifier/** Negotiates a TLS session using the default SSL socket factory. ... */negotiate(...)/** Negotiates a TLS session using an SSL socket factory. ... */SSLSession sslSessiongetSession(...)SSLPeerUnverifiedException verifExcepgetDefaultFactory(...)verify(...)SSLPeerUnverifiedException enew SSLPeerUnverifiedException(...)/** Closes the TLS connection gracefully and reverts back to the underlying ... */replaceStreams(...)/** Sets the connection for TLS to use. The TLS connection will be attached ... */this.ldapConnectionldapConnection.hostldapConnection.inStreamldapConnection.outStream/* Returns the default SSL socket factory. ... *//* Start the TLS handshake and manipulate the input and output streams. ... */ldapConnection.sockldapConnection.portsetEnabledCipherSuites(...)/* Verifies that the hostname in the server's certificate matches the ... */Certificate[] certsHostnameChecker checkerHostnameChecker.TYPE_LDAPgetCipherSuite(...)Principal principalgetPeerPrincipal(...)match(...)X509Certificate peerCertgetPeerCertificates(...)String cipherCertificateException e/* Get the peer principal from the session */AbstractMethodError e// The impl does accept null suites, although the spec requires// a non-null list.// Save to return the cause// Verification failed// Replace SSL streams with the original streams// Create SSL socket layered over the existing connection// Connection must be quite for handshake to proceed// Replace original streams with the new SSL streams// pass up exception// if IPv6 strip off the "[]"// Use ciphersuite to determine whether Kerberos is active.// X.509// get the subject's certificate// no exception means verification passed/* The application may enable an anonymous SSL cipher suite, and ... *//* Pass up the cause of the failure */// if the JSSE provider does not support it, return null, since// we need it only for Kerberos./** Represents a description of PooledConnection in Connections. ... */Pool.debugbyte BUSY;// Package private because used by Pool.showStats()byte IDLE;byte EXPIRED;PooledConnection conn;byte state;long idleSince;// initial statelong useCount;// for stats & debugging onlythis.conn/** Two desc are equal if their PooledConnections are the same. ... */(...).conn/** Hashcode is that of PooledConnection to facilitate ... *//** Changes the state of a ConnectionDesc from BUSY to IDLE and ... *//** If ConnectionDesc is IDLE, change its state to BUSY and return ... *//** If ConnectionDesc is IDLE and has expired, close the corresponding ... */// Used by Pool.showStats()// Connection released, ready for reuse// Connection wasn't busy to begin with// Close real connection// Expiration successful// Expiration did not occur// Package private: accessed only by Pool/** Represents a list of PooledConnections (actually, ConnectionDescs) with the ... */LdapPoolManager.traceint DEFAULT_SIZE;List<ConnectionDesc> conns;boolean closed;Reference<Object> ref;// Closed for business// maintains reference to id to prevent premature GCPooledConnection connthis.maxSizethis.prefSizenew ArrayList<ConnectionDesc>(...)new SoftReference<Object>(...)createPooledConnection(...)td(...)new ConnectionDesc(...)/** Retrieves a PooledConnection from this list of connections. ... */long waittimegetOrCreateConnection(...)long now/** Retrieves an idle connection from this list if one is available. ... */ConnectionDesc entrytryUse(...)/** Releases connection back into list. ... */release(...)/** Removes PooledConnection from list of connections. ... *//** Goes through all entries in list, removes and closes ones that have been ... */Iterator<ConnectionDesc> iter/** Called when this instance of Connections has been removed from Pool. ... */int idleint busyint expiredlong usegetUseCount(...)ConnectionDesc.BUSYConnectionDesc.IDLEConnectionDesc.EXPIRED// prefSize and initSize cannot exceed specified maxSize// Maintain soft ref to id so that this Connections' entry in// Pool doesn't get GC'ed prematurely// Create initial connections// Add new idle conn to pool// Wait until one is released or removed// Check whether we timed out// Current number of idle/nonidle conns// If no prefSize specified, or list size already meets or// exceeds prefSize, then first look for an idle connection// Check if list size already at maxSize specified// List size is at limit; cannot create any more// Add new conn to pool// Found entry// If list size exceeds prefSize, close connection// size must be >= 2 so don't worry about empty list// Get ConnectionDesc from list to get correct state info// Return connection to list, ready for reuse// Remove softref to make pool entry eligible for GC.// Once ref has been removed, it cannot be reinstated.// remove from pool// Don't need to call notify() because we're// removing only idle connections. If there were// idle connections, then there should be no waiters.// whether whole list has 'expired'// Expire idle connections// Close in-use connections when they are returned// redo test to avoid object creation/** Is a reference to Connections that is stored in Pool. ... */Connections conns;this.conns/* This class defines a WeakReference to the ConnectionRef (the referent). ... */getConnections(...)/** A map of pool ids to Connections. ... */LdapPoolManager.debugnew ReferenceQueue<ConnectionsRef>(...)synchronizedList(...)new LinkedList<Reference<ConnectionsRef>>(...)ReferenceQueue<ConnectionsRef> queue;/* Used for connections cleanup */Collection<Reference<ConnectionsRef>> weakRefs;// max num of identical conn per pool// preferred num of identical conn per poolMap<Object,ConnectionsRef> map;// initial number of identical conn to createnew WeakHashMap<Object,ConnectionsRef>(...)this.initSize/** Gets a pooled connection for id. The pooled connection might be ... */Connections connsexpungeStaleConnections(...)ConnectionsRef connsRefnew ConnectionsRef(...)Reference<ConnectionsRef> weakRefnew ConnectionsWeakRef(...)new Connections(...)ConnectionsRef ref/** Goes through the connections in this Pool and expires ones that ... */Iterator<ConnectionsRef> iter/* Closes the connections contained in the ConnectionsRef object that ... */ConnectionsWeakRef releaseRefObject idEntry<Object,ConnectionsRef> entryMap<>.Entry<Object,ConnectionsRef>getStats(...)// No connections for this id so create a new list// Create a weak reference to ConnectionsRef// Keep the weak reference through the element of a linked list// get one connection from list/** Represents a callback used to release or remove a PooledConnection back ... *//** Releases a useable connection back to the pool. ... *//** Removes a connection from the pool. The connection should not be reused. ... *//** Thread that wakes up periodically and closes expired, unused connections. ... */this.poolslong thresholdInterruptedException ignore// Wait for duration of period ms// Connections idle since threshold have expired/** Represents a connection that is managed in a pool. The connection ... *//** Closes the physical connection. *//** Represents a factory that creates PooledConnection. ... *//** Creates a pooled connection. ... */import RealmCallbackimport RealmChoiceCallback/** DefaultCallbackHandler for satisfying NameCallback and ... */String authenticationID;String authRealm;String origString[] choicesgetChoices(...)int selectedStringBuffer allChoicessetSelectedIndex(...)RealmCallback rcbString defaultRealmgetDefaultText(...)// assume UTF-8 encoding/* Deals with a choice of realms */// no realm chosen/* 1 or 0 realms specified in challenge */// Use what user supplied// Use what server supplied// Specify no realmimport AuthenticationExceptionimport AuthenticationNotSupportedExceptionimport CallbackHandlerimport javax.security.sasl.*import LdapClientimport LdapResult/** Handles SASL support. ... */// SASL stuffString SASL_AUTHZ_ID;String SASL_REALM;/** Performs SASL bind. ... */SaslClient saslClntboolean cleanupHandlerCallbackHandler cbhString authzIdString[] mechsgetSaslMechanismNames(...)new DefaultCallbackHandler(...)String mechNamegetMechanismName(...)byte[] responsehasInitialResponse(...)evaluateChallenge(...)createSaslClient(...)isComplete(...)String qopgetNegotiatedProperty(...)Sasl.QOPInputStream newInnew SaslInputStream(...)OutputStream newOutnew SaslOutputStream(...)conn.outStreamSaslException e/** Returns an array of SASL mechanisms given a string of space ... */Vector<String> mechsString[] mechNames...[] NO_BYTES;// Use supplied callback handler or create default// Prepare parameters for creating SASL client// Create SASL client to use using SASL package// If negotiated integrity or privacy,import Saslimport SaslClientimport SaslException/** This class is used by clients of Java SASL that need to create an input stream ... */...[] saslBuffer;...[] lenBuf;// buffer for storing raw bytes// buffer for storing lengthint bufPos;// Initialized to empty buffer// buffer for storing processed bytes// read position in bufSaslClient sc;// underlying input streamint recvMaxBufSize;Sasl.MAX_BUFFERthis.scnew SaslException(...)byte[] inBufint availint actual/** Fills the buf with more data by reading a SASL buffer, unwrapping it, ... */networkByteOrderToInt(...)/** Read requested number of bytes before returning. ... */SaslException save// Copied from com.sun.security.sasl.util.SaslImpl./** Returns the integer represented by  4 bytes in network byte order. */int answer/* Copyright (c) 2001, 2003, Oracle and/or its affiliates. All rights reserved. ... */// read and unwrap next SASL buffer// ignore zero length content// Requesting more that we have stored// Return all that we have; next invocation of read() will// trigger fill()// Requesting less than we have stored// Return all that was requested// Read in length of buffer// Read SASL buffer// Unwrap// Dispose of SaslClient's state// Save exception for throwing after closing 'in'// Close underlying input streamint rawSendSize;Sasl.RAW_SEND_SIZE// super.write(int) simply calls out.write(int)// Override this method to call write(byte[], int, int) counterpart/** Override this method to "wrap" the outgoing buffer before ... */byte[] wrappedTokenbyte[] saslBufferintToNetworkByteOrder(...)wrappedToken.length/** Encodes an integer into 4 bytes in network byte order in the buffer ... */// Copied from com.sun.security.sasl.util.SaslImpl// "Packetize" buffer to be within rawSendSize// Calculate length of current "packet"// Generate wrapped token// Write out length// Write out wrapped token// Close underlying output streamimport java.rmi.*/** The ReferenceWrapper class is a Remote wrapper for Reference ... */Reference wrappee;// reference being wrappedthis.wrappeeimport java.rmi.server.*import Registryimport LocateRegistry/** A RegistryContext is a context representing a remote RMI registry. ... */new AtomicNameParser(...)Hashtable<String,Object> environment;Registry registry;Reference reference;String SECURITY_MGR;// manager should be installed (if none is already in place).// Environment property that, if set, indicates that a security// ref used to create this context, if any/** Returns a context for the registry at a given host and port. ... */RMIClientSocketFactory socketFactoryinstallSecurityMgr(...)getRegistry(...)// %%% Alternatively, this could be done with a clone() method./** Returns a clone of a registry context.  The context's private state ... */ctx.registryctx.hostctx.portctx.referenceRemote objnew RegistryContext(...)NotBoundException eRemoteException ewrapRemoteException(...)/** If the object to be bound is both Remote and Referenceable, binds the ... */AlreadyBoundException e/** Rename is implemented by this sequence of operations: ... */String[] names/** Returns an RMI registry reference for this context. ... */RegistryContextFactory.ADDRESS_TYPE/** Wrap a RemoteException inside a NamingException. */re.detail/** Returns the registry at a given host, port and socket factory. ... *//** Attempts to install a security manager if none is currently in ... */setSecurityManager(...)new RMISecurityManager(...)/** Encodes an object prior to binding it in the registry.  First, ... */new ReferenceWrapper(...)/** Decodes an object that has been retrieved from the registry. ... *//** A name parser for case-sensitive atomic names. */Properties syntax;new CompoundName(...)/** An enumeration of name / class-name pairs. */int nextName;// index into "names"/** An enumeration of Bindings. ... */RegistryContext ctx;// chop off '[' and ']' in an IPv6 literal address// method is idempotent// &&& If we were caching registry connections, we would probably// uncache this one now.// Registry has an empty name// %%% clone the addrs too?// Enclose IPv6 literal address in '[' and ']'// %%% We could cache registry connections here.  The transport layer// may already reuse connections.// Convert name to a one-element composite name, so embedded// meta-characters are properly escaped.// Clone ctx in case someone closes it before we're through.import rmiURLContextFactory/** A RegistryContextFactory takes an RMI registry reference, and ... *//** The type of each address in an RMI registry reference. */URLToContext(...)getInitCtxURL(...)URLsToObject(...)isRegistryRef(...)RegistryContext ctxrmiURLContextFactory factorynew rmiURLContextFactory(...)/** Reads environment to find URL of initial context. ... */String defaultURL/** Returns true if argument is an RMI registry reference. *//** Returns the URLs contained within an RMI registry reference. *//* No need to clone env here.  If getObjectInstance() ... *//** The RemoteReference interface wraps a Reference in a Remote wrapper. ... *//* Copyright (c) 1999, Oracle and/or its affiliates. All rights reserved. ... */import ConfigurationException/** Contains utilities for performing CORBA-related tasks: ... *//** Returns the CORBA object reference associated with a Remote ... */Object stubinitMethodHandles(...)ConfigurationException ce/** Get ORB using given server and port number, and properties from environment. ... */Properties orbPropEnumeration<?> envPropObject appletContext.APPLETinitAppletORB(...)/** This method returns a new ORB instance for the given applet ... */Class<?> appletClassnew ClassCastException(...)Method toStubMethod;// Fields used for reflection of RMI-IIOPMethod connectMethod;Class<?> corbaStubClass;/** Initializes reflection method handles for RMI-IIOP. ... */Class<?> proClass// Needed for RMI/IIOP// First, get remoteObj's stub// javax.rmi.CORBA.Stub stub = PortableRemoteObject.toStub(remoteObj);// Next, make sure that the stub is javax.rmi.CORBA.Stub// JRMP implementation or JRMP stub// Next, make sure that the stub is connected// Invoke stub.connect(orb)// ignore RemoteException because stub might have already// been connected// Finally, return stub// See if we can get info from environment// Extract any org.omg.CORBA properties from environment// Already a Properties, just clone// Get all String properties// Get Applet from environment// Create ORBs for an applet// Create ORBs using orbProp for a standalone application// invoke the static method ORB.init(applet, orbProp);// java.applet.Applet doesn't exist and the applet parameter is// non-null; so throw CCE// Get javax.rmi.CORBA.Stub class// Get javax.rmi.CORBA.Stub.connect(org.omg.CORBA.ORB) method// Get javax.rmi.PortableRemoteObject class// Get javax.rmi.PortableRemoteObject.toStub(java.rmi.Remote) method/** Clients: deal only with names for its own naming service ... *//* Equivalent to Context methods */// ------ Abstract methods whose implementation are provided by subclasses/** Parse 'inputName' into two parts: ... *//* Parsing *//** Resolves the nns for 'name' when the named context is acting ... *//* Resolution method for supporting federation */// ------ Methods that need to be overridden by subclassa_lookup(...)setContinueNNS(...)CompositeName resNamesetContinue(...)appendRemainingComponent(...)// then it should override these a_*_nns methods.// the same meaning as the same name without a trailing slash,// If a context wants to accept a trailing slash as having// throws a NameNotFoundException for such names.// have an implicit nns.  The default implementation here// the trailing slash is meaningless because a junction does not// For naming systems that support junctions (explicit nns),// For such naming systems, override these a_*_nns methods.// the trailing slash signifies the implicit nns.// For naming systems that support implicit nns,// are invoked with a name that has a trailing slash.// The following methods are called when the DirContext methods/* Equivalent of Context Methods for supporting nns */a_processJunction_nns(...)/* Equivalent to methods in  Context interface */// ------ the corresponding a_ and a_*_nns methods// ------ implementations of c_  and c_*_nns methods usingresolve_to_penultimate_context(...)a_lookupLink(...)resolve_to_context(...)a_list(...)a_listBindings(...)a_bind(...)a_rebind(...)a_unbind(...)a_destroySubcontext(...)a_createSubcontext(...)a_rename(...)a_getNameParser(...)/* From ComponentContext *//* The following are overridden only for AtomicContexts. ... */resolve_to_penultimate_context_nns(...)a_resolveIntermediate_nns(...)c_resolveIntermediate_nns(...)/* Equivalent to methods in Context interface for nns */a_lookup_nns(...)c_lookup_nns(...)resolve_to_nns_and_continue(...)c_lookupLink_nns(...)c_list_nns(...)c_listBindings_nns(...)a_bind_nns(...)c_bind_nns(...)a_rebind_nns(...)c_rebind_nns(...)a_unbind_nns(...)c_unbind_nns(...)a_createSubcontext_nns(...)c_createSubcontext_nns(...)a_destroySubcontext_nns(...)c_destroySubcontext_nns(...)a_rename_nns(...)c_rename_nns(...)c_getNameParser_nns(...)/** This function is used when implementing a naming system that ... *//* Handles nns for junctions */// --------------    internal methods used by this classsetErrorNNS(...)Object targetisContinue(...)AtomicContext.this/** Resolve to context named by 'name'. ... *//* *********** core resolution routines ******************* */String targetStringHeadTail htc_parseComponent(...)String tailgetTail(...)String headgetHead(...)Object headCtx/** Resolves to penultimate context named by 'name'. ... *//** This function is similar to resolve_to_penultimate_context() ... */boolean answer/** Resolves to nns associated with 'name' and set Continuation ... */Object nns// Do not append "" to Continuation 'cont' even if set// because the intention is to ignore the nns// If "obj" is in the same type as this object, it must// not be a junction. Continue the lookup with "/".// obj is not even a context, so try to find its nns// dynamically by constructing a Reference containing obj.// Set continuation leave it to// PartialCompositeContext.getPCContext() to throw CPE.// Do not use setContinueNNS() because we've already// consumed "/" (i.e., moved it to resName).// add nns back// use ComponentContext// %%% check logic// use COmponentContext// lookup name to continue operation in nns// Construct a new Reference that contains this context.// Set continuation leave it to PartialCompositeContext.getPCContext()// to throw the exception.// Do not use setContinueNNS() because we've are// setting relativeResolvedName to "/".// something is wrong; no name at all// if there is head is a non-empty name// this means more resolution to be done//              System.out.println("answer " + headCtx);// clear// more components; hence not at penultimate context yet// already at penultimate context// resolve_to_penultimate_context() only calls a_lookup().// Any continuation it sets is lacking the nns, so// we need to add it back// Any exceptions it throws is lacking the nns, so// we need to add it back./** Direct subclasses of AtomicDirContext must provide implementations for ... */// ------ Abstract methods whose implementations come from subclass//  default implementations of a_*_nns methods// ------- a_ and a_*_nns methods// ------- implementations of c_ DirContext methods using correspondinga_getAttributes(...)a_modifyAttributes(...)a_search(...)a_getSchema(...)a_getSchemaClassDefinition(...)/* equivalent to methods in DirContext interface for nns */a_getAttributes_nns(...)a_modifyAttributes_nns(...)a_search_nns(...)/** Provides implementation of p_* operations using ... *//* Equivalent methods in Context interface */// ------ Abstract methods whose implementation are provided by subclass/** Determines which of the first components of 'name' belong ... *//* Parsing method */// ------ Methods that may need to be overridden by subclassName headName tailnew HeadTail(...)// c_processJunction_nns() for details.// default implementations here throw an exception.  See// For naming systems that do not support implicit nns, the// For such naming systems, override these c_*_nns methods.// The following methods are called when the Context methodsc_processJunction_nns(...)/** Locates the nns using the default policy.  This policy fully ... */// ------ internal method used by ComponentContextComponentContext.thisbyte USE_CONTINUATION;byte TERMINAL_COMPONENT;byte TERMINAL_NNS_COMPONENT;/** Determine whether 'name' is a terminal component in ... */HeadTail pp_parseComponent(...)checkAndAdjustRemainingName(...)appendRemainingName(...)isAllEmpty(...)Name newTailsetStatus(...)// to be "/c.b.a" and so must keep the trailing slash (empty name).// is extraneous.  When merging "" and "c.b.a", we want the result// the result to be "eng/c.b.a" because the trailing slash in eng// correctly. For example, when merging "eng/" and "c.b.a", we want// before appending tail so that composition of the names work// component of remaining name is empty; delete empty component// component to the remaining name (e.g. "eng/"). If last// its continuation, to indicate "nns", it appends an empty// When c_resolveIntermediate_nns() or c_lookup_nns() sets up// Returns true if n contains only empty components/* implementation for Resolver method */// ------ corresponding c_ and c_*_nns methods// ------ implementations of p_ Resolver and Context methods usingResolveResult retHeadTail resp_resolveIntermediate(...)getStatus(...)p_lookup(...)/* implementations of p_ Context methods */NamingEnumeration<NameClassPair> retc_list(...)NamingEnumeration<Binding> retc_listBindings(...)c_unbind(...)c_destroySubcontext(...)Context retc_rename(...)NameParser retc_getNameParser(...)c_lookupLink(...)// if no name to parse, or if we're already at boundary// treat like compound name// Consume "/" and continue// initialize//System.out.println("terminal : " + head);// tail does not begin with "/"/* if (head.isEmpty()) { ... */// head is being used as intermediate context,// resolve head and set Continuation with tail//System.out.println("resInter : " + head + "=" + obj);/* } */// tail begins with "/"//System.out.println("terminal_nns : " + head);// resolve nns of head and continue with tail.getSuffix(1)//System.out.println("lookup_nns : " + head + "=" + obj);//                      Name rname = cont.getRemainingName();//System.out.println("cont.rname" + rname);// head is being used as intermediate context// resolve and set continuation to tail//System.out.println("resInter2 : " + head + "=" + obj);// no contextType found; return null/* USE_CONTINUATION *//* pcont already set or exception thrown *//* cont already set or exception thrown *//* How p_resolveIntermediate() should behave for various test cases ... *//* Direct subclasses of ComponentDirContext must provide implementations for ... *//* Equivalent to methods in DirContext */// ------ Abstract methods whose implementations are provided by subclass// See ComponentContext for details.// then it should override these c_*_nns methods.// ------- default implementations of c_*_nns methods from DirContext/* Implements for abstract methods declared in PartialCompositeDirContext */// ------- DirContext c_ and c_*_nns methods// ------- implementations of p_ DirContext methods using correspondingAttributes answerc_getAttributes_nns(...)c_modifyAttributes_nns(...)c_modifyAttributes(...)DirContext answerNamingEnumeration<SearchResult> answerc_search_nns(...)c_getSchema_nns(...)c_getSchemaClassDefinition_nns(...)c_getSchemaClassDefinition(...)/** This class contains information required to continue ... */Name starter;/** The name that we started out with. It is initialized by the constructor ... */Object followingLink;/** Whether links were encountered. */Hashtable<?,?> environment;/** The environment used by the caller. Initialized by constructor and ... */boolean continuing;/** Indicates whether the Continuation instance indicates that the operation ... */Context resolvedContext;/** The last resolved context. Used to set the "AltNameCtx" in a ... */Name relativeResolvedName;/** The resolved name relative to resolvedContext. Used to set the ... *//** Constructs a new instance of Continuation. ... *//** Determines whether this Continuation contains data that should be ... *//** Sets this Continuation to indicate successful completion. ... *//** Fills in an exception's fields using data from this Continuation. ... */Hashtable<?,?> env/** Sets this Continuation to indicated that an error has occurred, ... */setErrorAux(...)/** Form that accepts a String name instead of a Name name. ... */CompositeName rname/** Sets this Continuation to indicated that an error has occurred ... */setContinueLink(...)/** Sets this Continuation with the supplied data, and set remaining name ... */PartialCompositeContext._NNS_NAME/** Overloaded form that accesses String names. ... */CompositeName relnamesetContinueAux(...)PartialCompositeContext._EMPTY_NAME/** Sets this Continuation with the supplied data. ... */this.remainingName/** String overload. ... *//** %%% This method is kept only for backward compatibility. Delete when ... *//** Sets this Continuation to process a linkRef. ... */this.followingLinkthis.resolvedObjthis.relativeResolvedNamethis.resolvedContextthis.continuing// For Hashtable clone: environment.clone()// ignore; can't happen for composite name// ignore, can't happen for composite name/** A class for returning the result of p_parseComponent(); ... */Name head;Name tail;this.statusimport Resolver/** PartialCompositeContext implements Context operations on ... */int _PARTIAL;int _COMPONENT;int _ATOMIC;int _contextType;CompositeName _EMPTY_NAME;CompositeName _NNS_NAME;/* Equivalent to method in  Resolver interface */// ------ Abstract methods whose implementations come from subclasses/* Equivalent to methods in Context interface *//** A cheap way of getting the environment. ... */// ------ not abstract only for backward compatibility// ------ should be overridden by subclass;/* implementations for method in Resolver interface using p_ method */// ------ using corresponding p_ methods provided by subclass// ------ implementations of methods in Resolver and ContextresolveToClass(...)PartialCompositeContext ctxp_getEnvironment(...)ResolveResult answerp_resolveToClass(...)getPCContext(...)/* implementations for methods in Context interface using p_ methods */p_bind(...)p_rebind(...)p_unbind(...)p_rename(...)getRemainingNewName(...)NamingEnumeration<NameClassPair> answerp_list(...)NamingEnumeration<Binding> answerp_listBindings(...)p_destroySubcontext(...)Context answerp_createSubcontext(...)p_lookupLink(...)NameParser answerp_getNameParser(...)Name fullName/** This default implementation simply concatenates the two names. ... */Name resString elideallEmpty(...)/** Tests whether a name contains a nonempty component. */// ------ internal methods used by PartialCompositeContextEnumeration<String> enum_/** Retrieves a PartialCompositeContext for the resolved object in ... */PartialCompositeContext pctx// %%% e.getRemainingNewName() should never be null// Just cast if octx already is PartialCompositeContext// %%% ignoring environment for now/* Inherit from AtomicContext so that subclasses of PartialCompositeDirContext ... *//* Equivalent to DirContext methods */// ------ Abstract methods whose implementation come from subclasses// ------ corresponding p_ methods// ------ implementation for DirContext methods usingPartialCompositeDirContext ctxp_getAttributes(...)getPCDirContext(...)DirContext cctxgetContinuationDirContext(...)p_modifyAttributes(...)p_search(...)p_getSchema(...)p_getSchemaClassDefinition(...)/** Retrieves a PartialCompositeDirContext for the resolved object in ... */// ------ internal method used by PartialCompositeDirContext/* Dummy implementations defined here so that direct subclasses ... *///------ Compensation for inheriting from AtomicContextOperationNotSupportedException e/** A class for returning the result of c_parseComponent(). ... */String head;String tail;/** Is implemented by classes that can perform filter checks on ... *//** Determines whether an attribute passes the filter. */Attributes matchingAttrs;// returns true if superset contains subsetNamingEnumeration<? extends Attribute> mAttribute targetAttribute fromSuper/** Supports checking an attribute set satisfies a filter ... */// an empty set is always a subset// contains nothing// check whether attribute values match/** A class for recursively enumerating the contents of a Context; ... */NamingEnumeration<Binding> children;Binding currentChild;boolean currentReturned;Context root;ContextEnumerator currentChildEnum;boolean currentChildExpanded;boolean rootProcessed;int scope;String contextName;getImmediateChildren(...)this.scopethis.contextNameprepNextChild(...)// Subclass should override if it wants to avoid calling obj factory// Subclass should override so that instance is of same type as subclassnew ContextEnumerator(...)hasMoreDescendants(...)getNextDescendant(...)Binding oldBindingBinding newBindingNameParser parserName newNamehasMoreChildren(...)getNextChild(...)newEnumerator(...)// return this object except when searching single-level// No need to list children if we're only searching object// pretend root is processed, if we're not supposed to return ourself// if the name is relative, we need to add it to the name of this// context to keep it relative w.r.t. the root context we are// enumerating// if the current child is expanded, see if it has more elements// returning parent// if the current child is expanded, use it's enumerator// Ready to go onto next child/** A class for searching DirContexts ... */new LazySearchEnumerationImpl(...)new ContainmentFilter(...)new SearchFilter(...)/** A sample service provider that implements a hierarchical directory in memory. ... */new HierarchicalNameParser(...)NameParser defaultParser;Hashtable<String,Object> myEnv;Hashtable<Name,Object> bindings;Attributes attrs;boolean ignoreCase;NamingException readOnlyEx;NameParser myParser;boolean alwaysUseFactory;this.ignoreCasethis.alwaysUseFactorynew Hashtable<Name,Object>(...)canonizeName(...)HierMemDirCtx ctx(...).attrsgetInternalName(...)doBindAux(...)getLeafName(...)doRebindAux(...)Object oldBindingdoList(...)new FlatNames(...)doListBindings(...)new FlatBindings(...)HierMemDirCtx newCtxcreateNewCtx(...)doGetAttributes(...)this.attrsNamingEnumeration<? extends Attribute> attrEnumAttribute existingAttrAttribute modAttrNamingEnumeration<?> modValsnew AttributeModificationException(...)HierMemDirCtx targetDirContext targetSearchFilter stringfilternew HierContextEnumerator(...)// and return object of their own kind.// this is used so that if anyone subclasses us, they can override this// This function is called whenever a new object needs to be created.// is its first component.// If the supplied name is a composite name, return the name thatName canonicalNamenew HierarchicalName(...)// Set context in readonly mode; throw e when update operation attempted.// Set context to support case-insensitive names/* Common base class for FlatNames and FlatBindings. */Enumeration<Name> names;// Class for enumerating name/class pairsName name// Class for enumerating bindingsHashtable<Name,Object> bds;Hashtable<String,Object> env;boolean useFactory;this.envthis.bdsthis.useFactoryHierMemDirCtx objHierMemDirCtx.this// the hash value.// hash function. We'll make up for the performance hit by caching// The only prupose of this subclass is to have a more discerning// CompundNames's HashCode() method isn't good enough for many string.int hashValue;// Creates an empty nameHierarchicalNameParser.mySyntax// just like String.hashCode, only it pays no attention to lengthchar[] val// This is the default name parser (used if setNameParser is not called)// name is empty, caller wants this object// name is atomic, caller wants one of this object's bindings// name is compound, delegate to child context// attrs == null -> use attrs from obj// attrs != null -> use attrs// %%% Strictly speaking, when attrs is non-null, we should// take the explicit step of removing obj's attrs.// We don't do that currently.// attrs will also be removed along with ctx// Check if new name exists// Check if old name is bound// This context does not treat links specially// Flat namespace; no federation; just call string version// turn it into a modification Enumeration and pass it on// Add new attribute values to existing attribute// Remove attribute values from existing attribute// alwaysUseFactory ignored because objReturnFlag == false// If name is not of the correct type, make copy// only method available//mySyntax.put("jndi.syntax.separator.ava", "+");//mySyntax.put("jndi.syntax.separator.typeval", "=");NamingEnumeration<Binding> candidates;SearchResult nextMatch;AttrFilter filter;Context context;this.candidatesfindNextMatch(...)SearchResult answerBinding nextAttributes targetAttrsselectAttributes(...)/** Given an enumeration of candidates, check whether each ... */// For Hashtable clone: env.clone()// find and do not remove from list// find and remove from list// need to find next match// Give name only if context non-null,// otherewise, name will be interpreted relative// to initial context (not what we want)/** A class for parsing LDAP search filters (defined in RFC 1960, 2254) ... */// %%% "filter" and "pos" are not declared "private" due to bug 4064984.StringFilter rootFilter;char BEGIN_FILTER_TOKEN;char END_FILTER_TOKEN;char AND_TOKEN;char OR_TOKEN;char NOT_TOKEN;char EQUAL_TOKEN;char APPROX_TOKEN;char LESS_TOKEN;char GREATER_TOKEN;char EXTEND_TOKEN;char WILDCARD_TOKEN;normalizeFilter(...)createNextFilter(...)// Returns true if targetAttrs passes the filter// what the parser expects. This only needs to be called once.// does some pre-processing on the string to make it look exactly lik/* Utility routines used by member classes */skipWhiteSpace(...)getCurrentChar(...)consumeChar(...)StringFilter filternew CompoundFilter(...)new NotFilter(...)new AtomicFilter(...)InvalidSearchFilterException e/** A class for dealing with compound filters ("and" & "or" filters). */Vector<StringFilter> subFilters;boolean polarity;new Vector<StringFilter>(...)this.polaritySearchFilter.this/** A class for dealing with NOT filters *//* CompoundFilter */StringFilter filter;int EQUAL_MATCH;// note: declared here since member classes can't have static variables/* notFilter */int APPROX_MATCH;int GREATER_MATCH;int LESS_MATCH;/** A class for dealing wtih atomic filters */String attrID;int matchType;int endPosrelIndexOf(...)int qualifierrelCharAt(...)relSubstring(...)consumeChars(...)InvalidSearchFilterException sfeSearchFilter.this.filterSearchFilter.this.posEnumeration<?> candidatessubstringMatch(...)// used for substring comparisons (where proto has "*" wildcardsint currentPosStringTokenizer subStrsString currentStr/** Creates an LDAP filter as a conjuction of the attributes supplied. */// ----- or object array// ----- static methods for producing string filters given attribute set/* AtomicFilter */String answerNamingEnumeration<? extends Attribute> eNamingEnumeration<?> vegetEncodedStringRep(...)// Writes the hex representation of a byte to a StringBuffer./** Returns the string representation of an object (such as an attr value). ... */StringBuffer b1hexDigit(...)/** Finds the first occurrence of <tt>ch</tt> in <tt>val</tt> starting ... *//** Formats the expression <tt>expr</tt> using arguments from the array ... */int paramStringBuffer answerint pstartint pend/* returns an Attributes instance containing only attributeIDs given in ... */Attributes resultattrIDs.length// get rid of any leading whitespaces// Sometimes, search filters don't have "(" and ")" - add them// this would be a good place to strip whitespace if desired// make sure every filter starts with "("// skip past the "("// use the next character to determine the type of filter// make sure every filter ends with ")"// skip past the ")"// just rethrow these// catch all - any uncaught exception while parsing will end up here// consume the "&"// consume the "!"// find the end//determine the match type//update our position// simple case 1: "*" means attribute presence is being tested// simple case 2: if there are no wildcards, call String.equals()// do the work: make sure all the substrings are present// do we need to begin with the first token?// do we need to end with the last token?// only checking presence of attribute//System.out.println("filter: " + answer);// binary data must be encoded as \hh where hh is a hex char// skip '{'// at this point, pend should be pointing at '}'// skip '}'/* For testing filter ... *//** This abstract class is a generic URL context that accepts as the ... *//** Resolves 'name' into a target context with remaining name. ... *//** Returns the suffix of the url. The result should be identical to ... */String suffix/** Finds the prefix of a URL. ... *//** Determines whether two URLs are the same. ... *//** Gets the context in which to continue the operation. This method ... */ResolveResult resgetRootURLContext(...)String oldPrefixgetURLPrefix(...)String newPrefixurlEquals(...)getURLSuffix(...)// Expect Hashtable<String, Object>// context that is not tied to any specific URL// %%% check this out: A URL context's name is ""// skip leading slash// skip ':'// skip double slash// find last slash// rest of URL// else 0 or 1 iniitial slashes; start is unchanged// > 1 component with 1st one being URL// URLs must be identical; cannot deal with diff URLs/* // To test, declare getURLPrefix and getURLSuffix static. ... *//** This abstract class is a generic URL DirContext that accepts as the ... *//** A Uri object represents an absolute Uniform Resource Identifier ... */String uri;String scheme;boolean hasAuthority;String path;String query;/** Creates a Uri object given a URI string. *//** Creates an uninitialized Uri object. The init() method must ... *//** Initializes a Uri object given a URI string. ... */this.uri/** Returns the URI's scheme. *//** Returns the host from the URI's authority part, or null ... *//** Returns the port from the URI's authority part, or -1 if ... *//** Returns the URI's path.  The path is never null.  Note that a ... *//** Returns the URI's query part, or null if no query is provided. ... *//** Returns the URI as a string. *//* Parses a URI string and sets this object's fields accordingly. */int qmark// index into URI// parse scheme// parse "//host:port"// skip past "//"// skip past "[...]"// at host name or IPv4// skip to path// look for queryimport URLDecoder/** Utilities for dealing with URLs. ... */// To prevent creation of this static class/** Decode a URI string (according to RFC 2396). *//** Decode a URI string (according to RFC 2396). ... */MalformedURLException mue/** Encode a string for inclusion in a URI (according to RFC 2396). ... */String allowed// ISO-Latin-1 should always be available?/* From RFC 2396: ... */// '?' is omitted// a..z// A..Z// 0..9import iiopURLContextFactory/** A corbaname URL context factory. ... */import com.sun.jndi.dns.*import GenericURLDirContext/** A DNS URL context resolves names that are DNS pseudo-URLs. ... *//** Resolves the host and port of "url" to a root context connected ... */DnsUrl dnsUrl/** A DNS URL context factory creates contexts that can resolve names ... */new dnsURLContext(...)dnsURLContext urlCtx/* Try each URL until lookup() succeeds for one of them. ... */// failure:  throw one of the exceptions caughtimport IiopUrlimport CorbanameUrl/** An IIOP URL context. ... */getUsingURLIgnoreRest(...)/** Return the suffix of an "iiop", "iiopname", or "corbaname" url. ... */getCosName(...)import CNCtx/** An IIOP URL context factory. ... */new iiopURLContext(...)createUsingURL(...)//System.out.println("iiopURLContextFactory " + urlInfo);// %%% exception??/** An iiopname URL context factory. ... */import LdapURL/** An LDAP URL context. ... */getUsingURLIgnoreRootDN(...)/** Return the suffix of an ldap url. ... */CompositeName remaining/* Override context operations. ... */hasQueryComponents(...)// divert the search operation when the LDAP URL has query componentssearchUsingURL(...)// divert the search operation when name has a single component// LDAP URL query components override the search argments.// Search using the LDAP URL in name.setFilterUsingURL(...)setSearchControlsUsingURL(...)/* Initialize a String filter using the LDAP URL filter component. ... *//* Initialize a SearchControls object using LDAP URL query components. ... */String scopeString attributes// Represent DN as empty or single-component composite name.// if nonempty, add component//default valueimport DirContextimport LdapCtximport LdapCtxFactory/** An LDAP URL context factory. ... */new ldapURLContext(...)import com.sun.jndi.url.ldap.*/** An LDAP URL context factory that creates secure LDAP contexts (using SSL). ... */import GenericURLContextimport RegistryContext/** An RMI URL context resolves names that are URLs of the form ... *//** Resolves the registry portion of "url" to the corresponding ... */String objNameContext regCtx// Parse the URL.// index into url, following the "rmi:"// skip "/" before object name// Represent object name as empty or single-component composite name.//System.out.println("host=" + host + " port=" + port +//                 " objName=" + remaining.toString() + "\n");// Create a registry context./** An RMI URL context factory creates contexts that can resolve names ... */new rmiURLContext(...)rmiURLContext urlCtximport PlatformManagedObject/** Management interface for the diagnostic commands for the HotSpot Virtual Machine. ... */import GarbageCollectionNotifInfoCompositeData/** The information about a garbage collection ... */String gcName;String gcAction;String gcCause;GcInfo gcInfo;CompositeData cdata;String GARBAGE_COLLECTION_NOTIFICATION;/** Notification type denoting that ... *//** Constructs a {@code GarbageCollectionNotificationInfo} object. ... */this.gcNamethis.gcActionthis.gcCausethis.gcInfothis.cdatanew GarbageCollectionNotifInfoCompositeData(...)validateCompositeData(...)getGcName(...)getGcAction(...)getGcCause(...)getGcInfo(...)/** Returns the name of the garbage collector used to perform the collection ... *//** Returns the action of the performed by the garbage collector ... *//** Returns the cause  the garbage collection ... *//** Returns the GC information related to the last garbage collection ... *//** Returns a {@code GarbageCollectionNotificationInfo} object represented by the ... */getGarbageCollectionNotifInfo(...)new GarbageCollectionNotificationInfo(...)/* Copyright (c) 2011, 2013, Oracle and/or its affiliates. All rights reserved. ... *//** Platform-specific management interface for a garbage collector ... *//** Returns the GC information about the most recent GC. ... */import MemoryUsageimport GcInfoCompositeDataimport GcInfoBuilder/** Garbage collection information.  It contains the following ... */long index;long endTime;Map<String,MemoryUsage> usageBeforeGc;Map<String,MemoryUsage> usageAfterGc;...[] extAttributes;GcInfoBuilder builder;String[] poolNamesgetPoolNames(...)this.builderthis.endTimethis.usageBeforeGcnew HashMap<String,MemoryUsage>(...)poolNames.lengththis.usageAfterGcthis.extAttributesnew GcInfoCompositeData(...)getStartTime(...)getEndTime(...)getMemoryUsageBeforeGc(...)getMemoryUsageAfterGc(...)/** Returns the identifier of this garbage collection which is ... *//** Returns the start time of this GC in milliseconds ... *//** Returns the end time of this GC in milliseconds ... *//** Returns the elapsed time of this GC in milliseconds. ... *//** Returns the memory usage of all memory pools ... *//** Returns a <tt>GcInfo</tt> object represented by the ... */new GcInfo(...)// Implementation of the CompositeData interface/** <p>Return the {@code CompositeData} representation of this ... *//** Diagnostic management interface for the HotSpot Virtual Machine. ... *//** Dumps the heap to the <tt>outputFile</tt> file in the same ... *//** Returns a list of <tt>VMOption</tt> objects for all diagnostic options. ... *//** Returns a <tt>VMOption</tt> object for a VM option of the given ... *//** Sets a VM option of the given name to the specified value. ... *//** Platform-specific management interface for the operating system ... *//** Returns the amount of virtual memory that is guaranteed to ... *//** Returns the total amount of swap space in bytes. ... *//** Returns the amount of free swap space in bytes. ... *//** Returns the CPU time used by the process on which the Java ... *//** Returns the amount of free physical memory in bytes. ... *//** Returns the total amount of physical memory in bytes. ... *//** Returns the "recent cpu usage" for the whole system. This value is a ... *//** Returns the "recent cpu usage" for the Java Virtual Machine process. ... *//** Platform-specific management interface for the thread system ... *//** Returns the total CPU time for each thread whose ID is ... *//** Returns the CPU time that each thread whose ID is in the input array ... *//** Returns an approximation of the total amount of memory, in bytes, ... *//** Tests if the Java virtual machine implementation supports thread memory ... *//** Tests if thread memory allocation measurement is enabled. ... *//** Enables or disables thread memory allocation measurement.  The default ... *//** Platform-specific management interface for the Unix ... *//** Returns the number of open file descriptors. ... *//** Returns the maximum number of file descriptors. ... */import VMOptionCompositeData/** Information about a VM option including its value and ... */boolean writeable;Origin origin;/** Origin of the value of a VM option.  It tells where the ... */new Origin(...)Origin DEFAULT;/** The VM option has not been set and its value ... */Origin VM_CREATION;/** The VM option was set at VM creation time typically ... */Origin ENVIRON_VAR;/** The VM option was set via an environment variable. */Origin CONFIG_FILE;/** The VM option was set via a configuration file. */Origin MANAGEMENT;/** The VM option was set via the management interface after the VM ... */Origin ERGONOMIC;/** The VM option was set via the VM ergonomic support. */Origin OTHER;/** The VM option was set via some other mechanism. *//** Constructs a <tt>VMOption</tt>. ... */this.writeablethis.origin/** Constructs a <tt>VMOption</tt> object from a ... */isWriteable(...)getOrigin(...)/** Returns the name of this VM option. ... *//** Returns the value of this VM option at the time when ... *//** Returns the origin of the value of this VM option. That is, ... *//** Tests if this VM option is writeable.  If this VM option is writeable, ... *//** Returns a <tt>VMOption</tt> object represented by the ... */getVMOption(...)new VMOption(...)// validate the input composite data/** This package contains Oracle Corporation's platform extension to ... */import AudioFormatimport AudioSystemimport DataLineimport LineEventimport LineUnavailableException/** AbstractDataLine ... */AudioFormat defaultFormat;// default format// DEFAULTSint defaultBufferSize;// default buffer size in bytes// the lock for synchronizationAudioFormat format;// current format// STATEint bufferSize;// current buffer size in bytesboolean running;boolean started;boolean active;/** Constructs a new AbstractLine. */DataLine.InfoAudioSystem.NOT_SPECIFIEDnew AudioFormat(...)isBigEndian(...)getFrameSize(...)getFrameRate(...)this.formatthis.bufferSize// DATA LINE METHODSPrinter.traceisOpen(...)isFullySpecifiedAudioFormat(...)Printer.debugimplOpen(...)setOpen(...)LineUnavailableException egetBufferSize(...)setBufferSize(...)/** This implementation always returns 0. *//** This implementation does nothing. */isStartedRunning(...)implStart(...)implStop(...)setStarted(...)// code as possible to change isStarted() back to isRunning().// in MixerSourceLine and MixerClip, and I want to touch as little// the variable names at this point, since 'running' is accessed// isStartedRunning() method, defined below.  I have not changed// start() and stop().  This state is accessed now through the// Note that the 'running' variable is true between calls to// This state is what should be returned by isRunning() in the API.// It is changed throughout the implementation with setStarted().// The 'started' variable is false when playback of data stops.// the change to isStarted() is technically an unapproved API change.// Per the denied RFE 4297981,// $$jb: 12.10.99: The official API for this is isRunning().long microsecondsgetLongFramePosition(...)frames2micros(...)/** This implementation does NOT change the buffer size *//** This implementation returns AudioSystem.NOT_SPECIFIED. */// change denied in RFE 4297981.// it to isStartedRunning().  This is part of backing out the// use this method throughout the implementation, I am renaming// the official API that was once called isStarted().  Since we// $$jb: 12.10.99: calling this method isRunning() conflicts with/** running is true after start is called and before stop is called, ... */// HELPER METHODS/** This method sets the active state and generates ... */this.active/** This method sets the started state and generates ... */boolean sendEventslong positionthis.startedsendEvents(...)new LineEvent(...)LineEvent.Type.STARTLineEvent.TypeLineEvent.Type.STOP/** This method generates a STOP event and sets the started state to false. ... *//** Try to open the line with the current format and buffer size values. ... */// OVERRIDES OF ABSTRACT LINE METHODS/** This should also stop the line.  The closed line should not be running or active. ... */implClose(...)// ABSTRACT METHODS// IMPLEMENTATIONS OF ABSTRACT LINE ABSTRACE METHODS// record the default values// default CD-quality// 0.5 seconds buffer// set the initial values to the defaults//$$fb 2001-10-09: Bug #4517739: avoiding deadlock by synchronizing to mixer !// if the line is not currently open, try to open it with this format and buffer size// make sure that the format is specified correctly// $$fb part of fix for 4679187: Clip.open() throws unexpected Exceptions// reserve mixer resources for this line//mixer.open(this, format, bufferSize);// open the data line.  may throw LineUnavailableException.// if we succeeded, set the open state to true and send events// release mixer resources for this line and then throw the exception// if the line is already open and the requested format differs from the// current settings, throw an IllegalStateException//$$fb 2002-04-02: fix for 4661602: Buffersize is checked when re-opening line//$$fb 2002-07-26: allow changing the buffersize of already open lines// $$kk: 06.06.99: if not open, this doesn't work....???// $$kk: 06.06.99: if not open, this doesn't work.// $$kk: 11.10.99: this is not exactly correct, but will probably work//boolean sendEvents = false;//long position = getLongFramePosition();//if (Printer.debug) Printer.debug("    AbstractDataLine: setActive: this.active: " + this.active);//if (Printer.debug) Printer.debug("                                 active: " + active);//sendEvents = true;//if (Printer.debug) Printer.debug("                                 this.active: " + this.active);//if (Printer.debug) Printer.debug("                                 sendEvents: " + sendEvents);// $$kk: 11.19.99: take ACTIVE / INACTIVE / EOM events out;// putting them in is technically an API change.// do not generate ACTIVE / INACTIVE events for now// if (sendEvents) {//      if (active) {//              sendEvents(new LineEvent(this, LineEvent.Type.ACTIVE, position));//      } else {//              sendEvents(new LineEvent(this, LineEvent.Type.INACTIVE, position));//if (Printer.debug) Printer.debug("    AbstractDataLine: setStarted: this.started: " + this.started);//if (Printer.debug) Printer.debug("                                  started: " + started);//if (Printer.debug) Printer.debug("                                  this.started: " + this.started);//if (Printer.debug) Printer.debug("                                  sendEvents: " + sendEvents);//$$fb 2002-04-21: sometimes, 2 STOP events are generated.// better use setStarted() to send STOP event.// this may throw a LineUnavailableException.// stop// set the open state to false and send events// close resources for this line// release mixer resources for this line// reset format and buffer size to the defaultsimport Lineimport LineListener/** AbstractLine ... */new WeakHashMap<ThreadGroup,EventDispatcher>(...)Line.Info info;AbstractMixer mixer;boolean open;Vector<> listeners;Map<ThreadGroup,EventDispatcher> dispatchers;/** Contains event dispatcher per thread group. *//** Constructs a new AbstractLine. ... */this.mixer// LINE METHODS/** Removes an audio listener. ... *//** Obtains the set of controls supported by the ... */Control[] returnedArraycontrols.lengthControl.Type/** This method sets the open state and generates ... */this.openLineEvent.Type.OPENLineEvent.Type.CLOSE/** Send line events. */sendAudioEvents(...)getEventDispatcher(...)/** This is an error in the API: getFramePosition ... *//** Return the frame position in a long value ... */// this on line and should be fixed!!// this is a hold-over from when there was a public method like// $$kk: 06.03.99: returns the mixer used in construction.EventDispatcher eventDispatchernew EventDispatcher(...)// protect against a NullPointerException// create and start the global event thread//TODO  need a way to stop this thread when the engine is doneimport javax.sound.midi.*/** Abstract AbstractMidiDevice class representing functionality shared by ... */boolean TRACE_TRANSMITTER;// STATIC VARIABLESArrayList<Receiver> receiverList;// INSTANCE VARIABLESTransmitterList transmitterList;Object traRecLock;// synchronizing to the class instance// reduces possibility of deadlock, compared to// from simultaneous creation and destruction// lock to protect receiverList and transmitterListMidiDevice.Info info;MidiDevice.Info// DEVICE ATTRIBUTES// DEVICE STATEint openRefCount;List<> openKeepingObjects;/** List of Receivers and Transmitters that opened the device implicitely. */long id;/** This is the device handle returned from native code *//* The initial mode and and only supported mode default to OMNI_ON_POLY. *//** Constructs an AbstractMidiDevice with the specified info object. ... */// CONSTRUCTOR// MIDI DEVICE METHODS/** Open the device from an application program. ... */doOpen(...)/** Open the device implicitly. ... */getOpenKeepingObjects(...)doClose(...)/** Close the device for an object that implicitely opened it. ... *//** This implementation always returns -1. ... *//** Return the maximum number of Receivers supported by this device. ... */hasReceivers(...)/** Return the maximum number of Transmitters supported by this device. ... */hasTransmitters(...)/** Retrieve a Receiver for this device. ... */Receiver receivercreateReceiver(...)getReceiverList(...)List<Receiver> recsnew ArrayList<Receiver>(...)/** This implementation uses createTransmitter, which may throw an exception. ... */Transmitter transmittercreateTransmitter(...)getTransmitterList(...)List<Transmitter> trastransmitterList.transmittersnew ArrayList<Transmitter>(...)/** Retrieve a Receiver and open the device implicitly. ... */// REFERENCE COUNTINGgetReceiver(...)openInternal(...)AbstractMidiDevice.this/** Retrieve a Transmitter and open the device implicitly. ... */getTransmitter(...)/** Return the list of objects that have opened the device implicitely. *//** Return the internal list of Receivers, possibly creating it first. */// RECEIVER HANDLING METHODS/** Returns if this device supports Receivers. ... *//** Create a Receiver object. ... */new MidiUnavailableException(...)/** Return the internal list of Transmitters, possibly creating it first. */// TRANSMITTER HANDLINGnew TransmitterList(...)/** Returns if this device supports Transmitters. ... *//** Create a Transmitter object. ... *//** close this device if discarded by the garbage collector *//** Base class for Receivers. ... */// INNER CLASSES/** Deliver a MidiMessage. ... */implSend(...)/** Close the Receiver. ... */AbstractMidiDevice.this.traRecLockcloseInternal(...)/** Transmitter base class. ... */// class AbstractReceiverReceiver receiver;TransmitterList tlist;this.tlistthis.receiverreceiverChanged(...)/** Close the Transmitter. ... *//** a class to manage a list of transmitters */// class BasicTransmitterArrayList<Transmitter> transmitters;MidiOutDevice.MidiOutReceiver midiOutReceiver;MidiOutDevice.MidiOutReceiverint optimizedReceiverCount;// handling// how many transmitters must be present for optimizedsetTransmitterList(...)/** closes all transmitters and empties the list *//** Send this message to all receivers ... */sendPackedMidiMessage(...)new FastShortMessage(...)InvalidMidiDataException enew FastSysexMessage(...)/** Send this message to all transmitters */sendMessage(...)getPackedMsg(...)// double calls to doOpens() will be catched by the open flag.// close all receivers// close all transmitters// may throw MidiUnavailableException/* Keep this order of commands! If getReceiver() throws an exception, ... *//* Keep this order of commands! If getTransmitter() throws an exception, ... *///$$fb is that a good idea?//protected void finalize() {//    close();// some optimization// more potential for optimization here// this happens when invalid data comes over the wire. Ignore it.//$$fb 2002-04-02: SysexMessages are mutable, so// an application could change the contents of this object,// or try to use the object later. So we can't get around object creation// But the array need not be unique for each FastSysexMessage object,// because it cannot be modified.//$$fb 2002-04-02: ShortMessages are mutable, so// or try to use the object later.// We violate this spec here, to avoid costly (and gc-intensive)// object creation for potentially hundred of messages per second.// The spec should be changed to allow Immutable MidiMessages// (i.e. throws InvalidStateException or so in setMessage)// TransmitterListimport MidiDeviceimport MidiDeviceProvider/** Super class for MIDI input or output device provider. ... */isMidiIOEnabled(...)boolean enabled;Info[] infosgetInfoCache(...)MidiDevice[] devicesgetDeviceCache(...)int oldNumDevicesinfos.lengthint newNumDevicesgetNumDevices(...)setInfoCache(...)new Info[]setDeviceCache(...)new MidiDevice[]Info[] newInfosMidiDevice[] newDevicesInfo newInfocreateInfo(...)int iiInfo infoequalStrings(...)Info[] localArrayreadDeviceInfos(...)Info thisInfogetIndex(...)createDevice(...)/** Info class for MidiDevices.  Adds an index value for ... */getVendor(...)// class Info/** Create objects representing all MIDI output devices on the system. */// $$fb number of MIDI devices may change with time// also for memory's sake, do not initialize the arrays here// initialize the arrays// in case that we are re-reading devices, try to find// the previous one and reuse it// new info matches the still existing info. Use old one// prevent re-use// the remaining MidiDevice.Info instances in the infos array// have become obsolete.// disable this device info// what to do with the MidiDevice instances that are left// in the devices array ?? Close them ?// commit new list of infos.import Mixer//$$fb 2002-07-26: let AbstractMixer be an AbstractLine and NOT an AbstractDataLine!/** Abstract Mixer.  Implements Mixer (with abstract methods) and specifies ... */int PCM;//  STATIC VARIABLESint ULAW;int ALAW;Mixer.Info mixerInfo;/** Info object describing this mixer. */// IMMUTABLE PROPERTIES...[] sourceLineInfo;/** source lines provided by this mixer */...[] targetLineInfo;/** target lines provided by this mixer *//** if any line of this mixer is started */boolean manuallyOpened;/** if this mixer had been opened manually with open() ... */Vector<> sourceLines;/** Source lines (ports) currently open */// STATE VARIABLES//protected Vector formats = new Vector();//$$fb DELETE/** Supported formats for the mixer. */Vector<> targetLines;/** Target lines currently open. *//** Constructs a new AbstractMixer. ... */new Info(...)this.mixerInfothis.sourceLineInfothis.targetLineInfo// MIXER METHODSsourceLineInfo.lengthtargetLineInfo.lengthVector<> vecInfo[] returnedArrayreturnedArray.lengthLine[] localLinesnew Line[]localLines.length/** Default implementation always throws an exception. *//** Default implementation always returns false. *//** This implementation tries to open the mixer with its current format and buffer size settings. */// OVERRIDES OF ABSTRACT DATA LINE METHODS/** The default implementation of this method just determines whether ... */// METHOD FOR INTERNAL IMPLEMENTATION USEisSourceLine(...)getLineInfo(...)isTargetLine(...)Printer.errerr(...)/** Removes this line from the list of open source lines and ... *//** Close all lines and then close this mixer. */getSourceLines(...)getTargetLines(...)/** Starts the mixer. *//** Stops the mixer if this was the last running line. */Vector<> localSourceLinesVector<> localTargetLinesAbstractDataLine sourceLineAbstractDataLine targetLine/** Determines whether this is a source line for this mixer. ... *//** Determines whether this is a target line for this mixer. ... *//** Returns the first complete Line.Info object it finds that ... */// Line.Info, AbstractMixer, Control[]// setup the line part// setup the mixer part// if the mixer is not currently open, set open to true and send event// $$kk: 06.11.99: ignore ourselves for now// source line?// call the no-arg open method for the mixer; it should open at its// default format if it is not open yet// we opened successfully! add the line to the list// target line?// we opened successfully!  add the line to the list// close all source lines// close all target lines// we just start the mixer regardless of anything else here.// if any other open line is running, return// this covers clips and source data lines// this covers target data lines// otherwise, stop// $$kk: 05.31.99: need to change this so that// the format and buffer size get set in the// returned info object for data lines??import AudioFileFormat/** AIFF file format. ... */int AIFF_MAGIC;int AIFC_MAGIC;// for writing AIFFint AIFF_MAGIC2;// 'AIFC'int FVER_MAGIC;// 'AIFF'int FVER_TIMESTAMP;// 'FVER'int COMM_MAGIC;// timestamp of last AIFF-C updateint SSND_MAGIC;// 'COMM'int AIFC_PCM;// compression codes// 'SSND'int AIFC_ACE2;// 'NONE' PCMint AIFC_ACE8;// 'ACE2' ACE 2:1 compressionint AIFC_MAC3;// 'ACE8' ACE 8:3 compressionint AIFC_MAC6;// 'MAC3' MACE 3:1 compressionint AIFC_ULAW;// 'MAC6' MACE 6:1 compressionint AIFC_IMA4;// 'ulaw' ITU G.711 u-Lawint AIFF_HEADERSIZE;// $$fb static approach not good, but needed for estimation// 'ima4' IMA ADPCMint headerSize;/** header size in bytes *///$$fb 2001-07-13: added management of header size in this classint commChunkSize;/** comm chunk size in bytes, inclusive magic and length field */int fverChunkSize;/** FVER chunk size in bytes, inclusive magic and length field */getFrameLength(...)getHeaderSize(...)import AudioInputStreamimport UnsupportedAudioFileException/** AIFF file reader and writer. ... */int MAX_READ_LENGTH;/** Obtains the audio file format of the input stream provided.  The stream must ... */// METHODS TO IMPLEMENT AudioFileReaderAudioFileFormat affgetCOMM(...)/** Obtains the audio file format of the URL provided.  The URL must ... */AudioFileFormat fileFormatInputStream urlStream/** Obtains the audio file format of the File provided.  The File must ... *//** Obtains an audio stream from the input stream provided.  The stream must ... */new AudioInputStream(...)/** Obtains an audio stream from the URL provided.  The URL must ... *//** Obtains an audio stream from the File provided.  The File must ... *///--------------------------------------------------------------------int fileReadAudioFormat formatint iffTypeint totallengthboolean aifcboolean ssndFoundAudioFileFormat.TypeType typeAudioFileFormat.Type.AIFCAudioFileFormat.Type.AIFFAiffFileFormat.AIFF_MAGICnew UnsupportedAudioFileException(...)AiffFileFormat.AIFC_MAGICint chunkNameint chunkLenint chunkReadint channelsint sampleSizeInBitsfloat sampleRateread_ieee_extended(...)AudioFormat.EncodingEncoding encodingAudioFormat.Encoding.PCM_SIGNEDint frameSizecalculatePCMFrameSize(...)int dataOffsetint blocksizeAiffFileFormat.FVER_MAGICAiffFileFormat.COMM_MAGICint encAiffFileFormat.AIFC_PCMAiffFileFormat.AIFC_ULAWAudioFormat.Encoding.ULAWAiffFileFormat.SSND_MAGICint toSkipnew AiffFileFormat(...)/** write_ieee_extended(DataOutputStream dos, double f) throws IOException { ... */int exponentdouble highMantissa/** read_ieee_extended ... */double fint exponlong hiMantlong loMantlong t1long t2double HUGEpow(...)// fix for 4489272: AudioSystem.getAudioFileFormat() fails for InputStream, but works for URL// the following is not strictly necessary - but was implemented like that in 1.3.0 - 1.4.1// so I leave it as it was. May remove this for 1.5.0// throws IOException// part of fix for 4325421// getCOMM leaves the input stream at the beginning of the audio data// throws UnsupportedAudioFileException, IOException// we've got everything, and the stream is at the// beginning of the audio data, so return an AudioInputStream.// assumes a stream at the beginning of the file which has already// passed the magic number test...// leaves the input stream at the beginning of the audio data// Read the magic number// $$fb: fix for 4369044: javax.sound.sampled.AudioSystem.getAudioInputStream() works wrong with Cp037// not AIFF, throw exception// Is this an AIFC or just plain AIFF file.// Loop through the AIFF chunks until// we get to the SSND chunk.// Read the chunk name// Switch on the chunk name.// Ignore format version for now.// AIFF vs. AIFC// $$fb: fix for 4399551: Repost of bug candidate: cannot replay aif file (Review ID: 108108)// Read header info.// numSampleFrames// If this is not AIFC then we assume it's// a linearly encoded file.// Java Sound convention//$fb what's that ??//if (sampleSizeInBits == 8) {//    encoding = AudioFormat.Encoding.PCM_SIGNED;// Data chunk.// we are getting *weird* numbers for chunkLen sometimes;// this really should be the size of the data chunk....// okay, now we are done reading the header.  we need to set the size// of the data segment.  we know that sometimes the value we get for// the chunksize is absurd.  this is the best i can think of:if the// value seems okay, use it.  otherwise, we get our value of// length by assuming that everything left is the data segment;// its length should be our original length (for all AIFF data chunks)// minus what we've read so far.// $$kk: we should be able to get length for the data chunk right after// we find "SSND."  however, some aiff files give *weird* numbers.  what// is going on??// $$kk: 11.03.98: this seems dangerous!// switch// skip the remainder of this chunk// while// For now write the integer portion of f// $$jb: 03.30.99: stay in synch with JMF on this!!!!// low Mantissa/** AIFF file writer. ... *///$$fb this class is buggy. Should be replaced in future./** Constructs a new AiffFileWriter object. */// METHODS TO IMPLEMENT AudioFileWriterType[] filetypesgetEncoding(...)AudioFormat.Encoding.ALAWAudioFormat.Encoding.PCM_UNSIGNEDAiffFileFormat aiffFileFormatgetAudioFileFormat(...)int bytesWrittenwriteAiffFile(...)FileOutputStream fosBufferedOutputStream bosint ssndBlockSizegetChannels(...)getSampleSizeInBits(...)int aiffLengthint ssndChunkSizelong dataSizeint numFramesRandomAccessFile rafnew RandomAccessFile(...)getFverChunkSize(...)/** Returns the AudioFileFormat describing the file that will be written from this AudioInputStream. ... */// -----------------------------------------------------------------------AiffFileFormat fileFormatAudioFormat streamFormatEncoding streamEncodingfloat frameRateboolean convert8to16getSampleRate(...)AiffFileFormat.AIFF_HEADERSIZEInputStream fileStreamgetFileStream(...)int maxLengthint fverChunkSizeint commChunkSizegetCommChunkSize(...)int ssndOffsetgetSsndChunkOffset(...)short channelsshort sampleSizefloat sampleFramesPerSecondint compCodebyte[] headerByteArrayInputStream headerStreamSequenceInputStream aiffStreamInputStream codedAudioStreamgetAudioInputStream(...)AiffFileFormat.AIFF_MAGIC2write_ieee_extended(...)new NoCloseInputStream(...)int DOUBLE_MANTISSA_LENGTH;int DOUBLE_EXPONENT_LENGTH;long DOUBLE_SIGN_MASK;long DOUBLE_EXPONENT_MASK;long DOUBLE_MANTISSA_MASK;int DOUBLE_EXPONENT_OFFSET;int EXTENDED_EXPONENT_OFFSET;int EXTENDED_MANTISSA_LENGTH;int EXTENDED_EXPONENT_LENGTH;long EXTENDED_INTEGER_MASK;/** Extended precision IEEE floating-point conversion routine. ... */long doubleBitslong signlong doubleExponentlong doubleMantissalong extendedExponentlong extendedMantissalong extendedSignshort extendedBits79To64long extendedBits63To0// make sure we can write this stream//$$fb the following check must come first ! Otherwise// the next frame length check may throw an IOException and// interrupt iterating File Writers. (see bug 4351296)// throws IllegalArgumentException if not supported// we must know the total data length to calculate the file length// first write the file without worrying about length fields// now, if length fields were not specified, calculate them,// open as a random access file, write the appropriate fields,// close again....// $$kk: 10.22.99: jan: please either implement this or throw an exception!// $$fb: 2001-07-13: done. Fixes Bug 4479981// skip FORM magic// skip aiff2 magic, fver chunk, comm magic, comm size, channel count,// write frame count// skip sample size, samplerate, SSND magic// that's all// can't convert non-8-bit ALAW,ULAW// AIFF is big endian// private method ... assumes aiffFileFormat is a supported file format//$$fb a little bit nicer handling of constants//int headerSize          = 54;//int fverChunkSize       = 0;//int commChunkSize       = 26;//int ssndOffset                        = headerSize - 16;// if we need to do any format conversion, do it here....// $$jb: Note that AIFF samples are ALWAYS signed// plug in the transcoder to convert to PCM_SIGNED. big endian//$$fb 2001-07-13: this is probably not what we want://     writing PCM when ULAW/ALAW is requested. AIFC is able to write ULAW !// plug in the transcoder to convert to PCM_SIGNED_BIG_ENDIAN// Now create an AIFF stream header...// Write the outer FORM chunk// Write a FVER chunk - only for AIFC//dos.writeInt(FVER_MAGIC);//dos.writeInt( (fverChunkSize-8) );//dos.writeInt(FVER_TIMESTAMP);// Write a COMM chunk// 10 bytes//Only for AIFC//dos.writeInt(compCode);//dos.writeShort(0);// Write the SSND chunk header// ssndOffset and ssndBlockSize set to 0 upon// recommendation in "Sound Manager" chapter in// "Inside Macintosh Sound", pp 2-87  (from Babu)// ssndOffset// ssndBlockSize// Concat this with the audioStream and return it/* The special cases NaN, Infinity and Zero are ignored, since ... *//** A-law encodes linear data, and decodes a-law data to linear data. ... */new Encoding[]int inputint mantissaint segment...[] ALAW_TABH;/* Tables used for A-law decoding */...[] ALAW_TABL;...[] alawEncodings;...[] seg_end;/** Constructs a new ALAW codec object. */// NEW CODEEncoding[] encgetOutputFormats(...)new AudioFormat[]AudioFormat sourceFormatEncoding sourceEncodingAudioFormat targetFormatisConversionSupported(...)/** use old code... */getConvertedStream(...)/* public AudioInputStream getConvertedStream(AudioFormat outputFormat, AudioInputStream stream) { *//** Opens the codec with the specified parameters. ... */// OLD CODEAudioInputStream csAudioFormat inputFormatnew AlawCodecStream(...)/* public AudioFormat[] getOutputFormats(AudioFormat inputFormat) { *//** Obtains the set of output formats supported by the codec ... */Vector<> formatsAudioFormat[] formatArrayformatArray.lengthint tempBufferSize;// tempBuffer required only for encoding (when encode is true)...[] tempBuffer;boolean encode;/** True to encode to a-law, false to decode to linear */AudioFormat encodeFormat;AudioFormat decodeFormat;...[] tabByte1;...[] tabByte2;int highByte;int lowByte;boolean PCMIsBigEndian/* $$jb 2/23/99 ... */short i/** Note that this won't actually read anything; must read in ... */short QUANT_MASKshort SEG_SHIFTshort maskshort segint adjshort samplebyte encint readCountint readLeftint readLenint readOffset/** Initializes the decode tables */// throw an IllegalArgumentException if not ok//$$fb 2002-07-18: fix for 4714846: JavaSound ULAW (8-bit) encoder erroneously depends on endian-ness// determine whether we are encoding or decoding// set the AudioInputStream length in frames if we know it// set framePos to zero// don't read fractional frames/* Get the sample from the tempBuffer *//* Convert the scaled magnitude to segment number. *//* Combine the sign, segment, quantization bits *//* out of range, return maximum value. *//* Now put the encoded sample where it belongs *//* And update pointers and counters for next iteration */// EOF or error/* Number of bytes written to new buffer */// end class AlawCodecStream// end class ALAW/** AU file format. ... */int AU_SUN_MAGIC;// magic numbersint AU_SUN_INV_MAGIC;int AU_DEC_MAGIC;int AU_DEC_INV_MAGIC;int AU_ULAW_8;// encodingsint AU_LINEAR_8;/* 8-bit ISDN u-law */int AU_LINEAR_16;/* 8-bit linear PCM */int AU_LINEAR_24;/* 16-bit linear PCM */int AU_LINEAR_32;/* 24-bit linear PCM */int AU_FLOAT;/* 32-bit linear PCM */int AU_DOUBLE;/* 32-bit IEEE floating point */int AU_ADPCM_G721;/* 64-bit IEEE floating point */int AU_ADPCM_G722;/* 4-bit CCITT g.721 ADPCM */int AU_ADPCM_G723_3;/* CCITT g.722 ADPCM */int AU_ADPCM_G723_5;/* CCITT g.723 3-bit ADPCM */int AU_ALAW_8;/* CCITT g.723 5-bit ADPCM */int AU_HEADERSIZE;/* 8-bit ISDN A-law */int auType;/** AU file reader. ... */AuFileFormat fileFormatint maxReadLengthboolean bigendianint dataSizeint encoding_localint sampleRateint frameRateint nreadAuFileFormat.AU_SUN_MAGICAuFileFormat.AU_DEC_MAGICAuFileFormat.AU_SUN_INV_MAGICAuFileFormat.AU_DEC_INV_MAGICrllong(...)AuFileFormat.AU_ULAW_8AuFileFormat.AU_ALAW_8AuFileFormat.AU_LINEAR_8AuFileFormat.AU_LINEAR_16AuFileFormat.AU_LINEAR_24AuFileFormat.AU_LINEAR_32new AuFileFormat(...)AudioFileFormat.Type.AUAudioInputStream result// not AU, reset the stream, place into exception, throw exception// otherwise little-endian// $$jb: 04.29.99: 8bit linear is *signed*, not *unsigned*// $jb: 03.19.99: we don't support these .../* case AuFileFormat.AU_FLOAT: ... */// unsupported filetype, throw exception//$$fb 2002-11-02: fix for 4629669: AU file reader: problems with empty files//$$fb 2003-10-20: fix for 4940459: AudioInputStream.getFrameLength() returns 0 instead of NOT_SPECIFIED// Throws IOException// throws UnsupportedAudioFileException// if we passed this call, we have an AU file.// now seek past the header// magic// we've got everything, and the stream should be at the// beginning of the data chunk, so return an AudioInputStream./** AU file writer. ... */int UNKNOWN_SIZE;//$$fb value for length field if length is not known/** Constructs a new AuFileWriter object. */AuFileFormat auFileFormatwriteAuFile(...)AuFileFormat.AU_HEADERSIZE// -------------------------------------------------------------long dataSizeInBytesgetAuType(...)SequenceInputStream auStreamAudioFormat audioStreamFormatbig2little(...)//$$fb 2001-07-13: fix for bug 4351296: do not throw an exception//if( stream.getFrameLength() == AudioSystem.NOT_SPECIFIED ) {//      throw new IOException("stream length not specified");// skip AU magic and data offset field// AU is always big endian// private method ... assumes auFileFormat is a supported file type//$$fb fix for Bug 4351296//int dataSizeInBytes = dataSize * format.getFrameSize();//$$fb below is the fix for 4297100.//boolean bigendian      = format.isBigEndian();// force bigendian// if we need to do any format conversion, do it here.//$$ fb 2001-07-13: Bug 4391108// plug in the transcoder to convert to PCM_SIGNED, bigendian// NOTE: little endian AU is not common, so we're always converting//       to big endian unless the passed in audioFileFormat is little.// $$fb this NOTE is superseded. We always write big endian au files, this is by far the standard.// Now create a new InputStream from headerStream and the InputStream// in audioStreamimport InvalidMidiDataExceptionimport Soundbankimport SoundbankReader/** Soundbank reader that uses audio files as soundbanks. ... */AudioInputStream aisSoundbank sbkgetSoundbank(...)UnsupportedAudioFileException eModelByteBufferWavetable oscnew ModelByteBufferWavetable(...)new ModelByteBuffer(...)ModelPerformer performernew ModelPerformer(...)SimpleSoundbank sbknew SimpleSoundbank(...)SimpleInstrument insnew SimpleInstrument(...)getOscillators(...)addInstrument(...)UnsupportedAudioFileException e1/* Copyright (c) 2007, 2013, Oracle and/or its affiliates. All rights reserved. ... */import DoubleBufferimport FloatBufferimport Encoding/** This class is used to convert between 8,16,24,32,32+ bit signed/unsigned ... *//** ************************************************************************* ... */AudioFloatConverter converter;int stepsize;byte mask;...[] mask_buffer;boolean bigEndianint lsb_bitsthis.converterbyte[] retint out_offset_endint in_offset_endfloat[] rettoFloatArray(...)mask_buffer.lengthin_buff.length// PCM 64 bit float, little-endianByteBuffer bytebuffer;DoubleBuffer floatbuffer;...[] double_buff;int in_lenasDoubleBuffer(...)double_buff.lengthint out_len// PCM 64 bit float, big-endian// PCM 32 bit float, little-endianFloatBuffer floatbuffer;asFloatBuffer(...)// PCM 32 bit float, big-endian// PCM 8 bit, signedint ixint ox// PCM 8 bit, unsigned// PCM 16 bit, signed, little-endian// PCM 16 bit, signed, big-endian// PCM 16 bit, unsigned, little-endian// PCM 16 bit, unsigned, big-endian// PCM 24 bit, signed, little-endian// PCM 24 bit, signed, big-endian// PCM 24 bit, unsigned, little-endian// PCM 24 bit, unsigned, big-endian// PCM 32 bit, signed, little-endian// PCM 32 bit, signed, big-endian// PCM 32 bit, unsigned, little-endian// PCM 32 bit, unsigned, big-endian// PCM 32+ bit, signed, little-endianint xbytes;this.xbytes// PCM 32+ bit, signed, big-endian// PCM 32+ bit, unsigned, little-endian// PCM 32+ bit, unsigned, big-endianAudioFloatConverter convEncoding.PCM_SIGNEDnew AudioFloatConversion8S(...)new AudioFloatConversion16SB(...)new AudioFloatConversion24SB(...)new AudioFloatConversion32SB(...)new AudioFloatConversion32xSB(...)new AudioFloatConversion16SL(...)new AudioFloatConversion24SL(...)new AudioFloatConversion32SL(...)new AudioFloatConversion32xSL(...)Encoding.PCM_UNSIGNEDnew AudioFloatConversion8U(...)new AudioFloatConversion16UB(...)new AudioFloatConversion24UB(...)new AudioFloatConversion32UB(...)new AudioFloatConversion32xUB(...)new AudioFloatConversion16UL(...)new AudioFloatConversion24UL(...)new AudioFloatConversion32UL(...)new AudioFloatConversion32xUL(...)Encoding.PCM_FLOATnew AudioFloatConversion32B(...)new AudioFloatConversion32L(...)new AudioFloatConversion64B(...)new AudioFloatConversion64L(...)new AudioFloatLSBFilter(...)conv.formatout_buff.lengthimport FormatConversionProvider/** This class is used to convert between 8,16,24,32 bit signed/unsigned ... */AudioFloatInputStream stream;...[] readfloatbuffer;int fsize;getConverter(...)int flenreadfloatbuffer.lengthlong retint targetChannels;int sourceChannels;AudioFloatInputStream ais;AudioFormat targetFormat;...[] conversion_buffer;this.sourceChannelsthis.targetChannelsthis.aisconversion_buffer.lengthint csfloat volint minChannelsint off_lenint ct...[] skipbuffer;SoftAbstractResampler resampler;...[] pitch;...[] ibuffer2;...[] ibuffer;float ibuffer_index;int ibuffer_len;int nrofchannels;...[] cbuffer;int buffer_len;int pad2;...[] ix;...[] ox;...[] mark_ibuffer;float mark_ibuffer_index;int mark_ibuffer_len;Object interpolationString resamplerTypethis.resamplernew SoftPointResampler(...)new SoftLinearResampler2(...)new SoftLinearResampler(...)new SoftCubicResampler(...)new SoftLanczosResampler(...)new SoftSincResampler(...)getPadding(...)new float[][]ibuffer.lengthfloat[] fromfloat[] toto.lengthint ibuffer2_lenibuffer2.lengthfloat[] buffint buffer_len_padint offlenint remainint destPosint in_endint preDestPosreadNextBuffer(...)interpolate(...)float[] l_skipbufferlong remainskipbuffer.length...[] formats;float sampleratenew AudioFloatInputStreamChannelMixer(...)new AudioFloatInputStreamResampler(...)new AudioFloatFormatConverterInputStream(...)ArrayList<AudioFormat> formatsnew ArrayList<AudioFormat>(...)formats.length// new// SoftLinearResampler2();// ais.getFrameLength();/** This class is used to create AudioFloatInputStream from AudioInputStream and ... */int markpos;int buffer_offset;int framesize_pc;this.bufferthis.buffer_offsetthis.buffer_lenAudioInputStream stream;// framesize / channelsAudioFormat newformatAudioFormat[] formatsgetTargetFormats(...)int samplesizeinbitsint framesizefloat framerateint b_lenlong b_lennew DirectAudioFloatInputStream(...)AudioFloatConverter converterAudioInputStream astreamnew BytaArrayAudioFloatInputStream(...)float[] b// / format.getFrameSize();import MidiUnavailableExceptionimport Synthesizerimport SourceDataLine/** <code>AudioSynthesizer</code> is a <code>Synthesizer</code> ... *//** Obtains the current format (encoding, sample rate, number of channels, ... *//** Gets information about the possible properties for the synthesizer. ... *//** Opens the synthesizer and starts rendering audio into ... *//** Opens the synthesizer and renders audio into returned ... *//* Copyright (c) 2007, Oracle and/or its affiliates. All rights reserved. ... *//** Information about property used in  opening <code>AudioSynthesizer</code>. ... *//** Constructs a <code>AudioSynthesizerPropertyInfo</code> object with a given ... *//** The name of the property. *//** A brief description of the property, which may be null. *//** The <code>value</code> field specifies the current value of ... */Class<> valueClass;/** The <code>valueClass</code> field specifies class ... *//** An array of possible values if the value for the field ... */import Clip/** Interface for Clip objects that close themselves automatically ... *//** Indicates whether this clip instance is auto closing. ... *//** Sets whether this Clip instance is auto closing or not. ... */import Receiver/** Interface for Sequencers that are able to do the auto-connect ... *//** Set the receiver that this device is ... *//** This class is used to store information  to describe soundbanks, instruments ... *//** (INAM) Title or subject. */String creationDate;/** (ICRD) Date of creation, the format is: YYYY-MM-DD. ... */String engineers;/** (IENG) Name of engineer who created the object. */String product;/** (IPRD) Name of the product which the object is intended for. */String copyright;/** (ICOP) Copyright information. */String comments;/** (ICMT) General comments. Doesn't contain newline characters. */String tools;/** (ISFT) Name of software package used to create the file. */String archival_location;/** (IARL) Where content is archived. */String artist;/** (IART) Artists of original content. */String commissioned;/** (ICMS) Names of persons or orginizations who commissioned the file. */String genre;/** (IGNR) Genre of the work. ... */String keywords;/** (IKEY) List of keyword that describe the content. ... */String medium;/** (IMED) Describes original medium of the data. ... */String subject;/** (ISBJ) Description of the content. */String source;/** (ISRC) Name of person or orginization who supplied ... */String source_form;/** (ISRF) Source media for sample data is from. ... */String technician;/** (ITCH) Technician who sample the file/object. */import Patch/** This class is used to store information to describe instrument. ... */new DLSInfo(...)new ArrayList<DLSRegion>(...)new ArrayList<DLSModulator>(...)int preset;int bank;boolean druminstrument;...[] guid;DLSInfo info;List<DLSRegion> regions;List<DLSModulator> modulators;new ModelPatch(...)isPercussion(...)getBank(...)getProgram(...)DLSModulator.CONN_DST_NONEDLSModulator.CONN_DST_GAINModelDestination.DESTINATION_GAINDLSModulator.CONN_DST_PITCHModelDestination.DESTINATION_PITCHDLSModulator.CONN_DST_PANModelDestination.DESTINATION_PANDLSModulator.CONN_DST_LFO_FREQUENCYModelDestination.DESTINATION_LFO1_FREQDLSModulator.CONN_DST_LFO_STARTDELAYModelDestination.DESTINATION_LFO1_DELAYDLSModulator.CONN_DST_EG1_ATTACKTIMEModelDestination.DESTINATION_EG1_ATTACKDLSModulator.CONN_DST_EG1_DECAYTIMEModelDestination.DESTINATION_EG1_DECAYDLSModulator.CONN_DST_EG1_RELEASETIMEModelDestination.DESTINATION_EG1_RELEASEDLSModulator.CONN_DST_EG1_SUSTAINLEVELModelDestination.DESTINATION_EG1_SUSTAINDLSModulator.CONN_DST_EG2_ATTACKTIMEModelDestination.DESTINATION_EG2_ATTACKDLSModulator.CONN_DST_EG2_DECAYTIMEModelDestination.DESTINATION_EG2_DECAYDLSModulator.CONN_DST_EG2_RELEASETIMEModelDestination.DESTINATION_EG2_RELEASEDLSModulator.CONN_DST_EG2_SUSTAINLEVELModelDestination.DESTINATION_EG2_SUSTAINDLSModulator.CONN_DST_KEYNUMBERModelDestination.DESTINATION_KEYNUMBERDLSModulator.CONN_DST_CHORUSModelDestination.DESTINATION_CHORUSDLSModulator.CONN_DST_REVERBModelDestination.DESTINATION_REVERBDLSModulator.CONN_DST_VIB_FREQUENCYModelDestination.DESTINATION_LFO2_FREQDLSModulator.CONN_DST_VIB_STARTDELAYModelDestination.DESTINATION_LFO2_DELAYDLSModulator.CONN_DST_EG1_DELAYTIMEModelDestination.DESTINATION_EG1_DELAYDLSModulator.CONN_DST_EG1_HOLDTIMEModelDestination.DESTINATION_EG1_HOLDDLSModulator.CONN_DST_EG1_SHUTDOWNTIMEModelDestination.DESTINATION_EG1_SHUTDOWNDLSModulator.CONN_DST_EG2_DELAYTIMEModelDestination.DESTINATION_EG2_DELAYDLSModulator.CONN_DST_EG2_HOLDTIMEModelDestination.DESTINATION_EG2_HOLDDLSModulator.CONN_DST_FILTER_CUTOFFModelDestination.DESTINATION_FILTER_FREQDLSModulator.CONN_DST_FILTER_QModelDestination.DESTINATION_FILTER_QDLSModulator.CONN_SRC_NONEDLSModulator.CONN_SRC_LFOModelSource.SOURCE_LFO1DLSModulator.CONN_SRC_KEYONVELOCITYModelSource.SOURCE_NOTEON_VELOCITYDLSModulator.CONN_SRC_KEYNUMBERModelSource.SOURCE_NOTEON_KEYNUMBERDLSModulator.CONN_SRC_EG1ModelSource.SOURCE_EG1DLSModulator.CONN_SRC_EG2ModelSource.SOURCE_EG2DLSModulator.CONN_SRC_PITCHWHEELModelSource.SOURCE_MIDI_PITCHDLSModulator.CONN_SRC_CC1new ModelIdentifier(...)DLSModulator.CONN_SRC_CC7DLSModulator.CONN_SRC_CC10DLSModulator.CONN_SRC_CC11DLSModulator.CONN_SRC_RPN0DLSModulator.CONN_SRC_RPN1DLSModulator.CONN_SRC_POLYPRESSUREModelSource.SOURCE_MIDI_POLY_PRESSUREDLSModulator.CONN_SRC_CHANNELPRESSUREModelSource.SOURCE_MIDI_CHANNEL_PRESSUREDLSModulator.CONN_SRC_VIBRATOModelSource.SOURCE_LFO2DLSModulator.CONN_SRC_MONOPRESSUREDLSModulator.CONN_SRC_CC91DLSModulator.CONN_SRC_CC93ModelIdentifier sourceconvertToModelSrc(...)ModelIdentifier controlgetControl(...)ModelIdentifier destination_idconvertToModelDest(...)getScale(...)double f_scaleDouble.NEGATIVE_INFINITYModelSource srcModelSource ctrlModelConnectionBlock blocknew ModelConnectionBlock(...)ModelDestination destinationnew ModelDestination(...)ModelSource snew ModelSource(...)setPolarity(...)ModelStandardTransform.POLARITY_BIPOLARsetIdentifier(...)addSource(...)DLSModulator.CONN_TRN_CONCAVEsetTransform(...)ModelStandardTransform.TRANSFORM_CONCAVEsetDirection(...)ModelStandardTransform.DIRECTION_MAX2MINint src_transform_invertint src_transform_bipolarint src_transformint ctr_transform_invertint ctr_transform_bipolarint ctr_transformint transModelStandardTransform.TRANSFORM_LINEARDLSModulator.CONN_TRN_SWITCHModelStandardTransform.TRANSFORM_SWITCHDLSModulator.CONN_TRN_CONVEXModelStandardTransform.TRANSFORM_CONVEXsetScale(...)List<ModelPerformer> performersnew ArrayList<ModelPerformer>(...)Map<String,DLSModulator> modmapnew HashMap<String,DLSModulator>(...)Map<String,DLSModulator> insmodmapDLSModulator modgetModulators(...)DLSRegion zoneList<ModelConnectionBlock> blocksgetConnectionBlocks(...)DLSSample sampleDLSSampleOptions sampleoptgetSampleoptions(...)ModelByteBuffer bufffloat pitchcorrectionsampleopt.finetunesampleopt.unitynotesetSelfNonExclusive(...)getFusoptions(...)DLSRegion.OPTION_SELFNONEXCLUSIVEsetExclusiveClass(...)getExclusiveClass(...)setKeyFrom(...)getKeyfrom(...)setKeyTo(...)getKeyto(...)setVelFrom(...)getVelfrom(...)setVelTo(...)getVelto(...)ModelConnectionBlock pconvertToModel(...)setAttenuation(...)getAttenuation(...)getLoops(...)DLSSampleLoop loopsetLoopStart(...)getStart(...)setLoopLength(...)DLSSampleLoop.LOOP_TYPE_FORWARDsetLoopType(...)ModelWavetable.LOOP_TYPE_FORWARDDLSSampleLoop.LOOP_TYPE_RELEASEModelWavetable.LOOP_TYPE_RELEASESoftFilter.FILTERTYPE_LP12new ModelPerformer[]guid.lengththis.guid// DLS2 Destinations//if (mod.getTransform() ==  DLSModulator.CONN_TRN_CONCAVE) {//    ((ModelStandardTransform)destination.getTransform())//            .setTransform(//            ModelStandardTransform.TRANSFORM_CONCAVE);/* No output transforms are defined the DLS Level 2 ... *//** This class is used to store modulator/artiuclation data. ... */int CONN_DST_NONE;// DLS1 Destinationsint CONN_DST_GAIN;int CONN_DST_PITCH;// cBint CONN_DST_PAN;// centint CONN_DST_LFO_FREQUENCY;// 0.1%int CONN_DST_LFO_STARTDELAY;// cent (default 5 Hz)int CONN_DST_EG1_ATTACKTIME;// timecentint CONN_DST_EG1_DECAYTIME;int CONN_DST_EG1_RELEASETIME;int CONN_DST_EG1_SUSTAINLEVEL;int CONN_DST_EG2_ATTACKTIME;int CONN_DST_EG2_DECAYTIME;int CONN_DST_EG2_RELEASETIME;int CONN_DST_EG2_SUSTAINLEVEL;int CONN_DST_KEYNUMBER;int CONN_DST_LEFT;int CONN_DST_RIGHT;int CONN_DST_CENTER;int CONN_DST_LEFTREAR;int CONN_DST_RIGHTREAR;int CONN_DST_LFE_CHANNEL;int CONN_DST_CHORUS;int CONN_DST_REVERB;int CONN_DST_VIB_FREQUENCY;int CONN_DST_VIB_STARTDELAY;int CONN_DST_EG1_DELAYTIME;// dBint CONN_DST_EG1_HOLDTIME;int CONN_DST_EG1_SHUTDOWNTIME;int CONN_DST_EG2_DELAYTIME;int CONN_DST_EG2_HOLDTIME;int CONN_DST_FILTER_CUTOFF;int CONN_DST_FILTER_Q;int CONN_SRC_NONE;// DLS1 Sourcesint CONN_SRC_LFO;int CONN_SRC_KEYONVELOCITY;// linear (sine wave)int CONN_SRC_KEYNUMBER;// ??db or velocity??int CONN_SRC_EG1;// ??cent or keynumber??int CONN_SRC_EG2;// linear direct from egint CONN_SRC_PITCHWHEEL;int CONN_SRC_CC1;// linear -1..1int CONN_SRC_CC7;// linear 0..1int CONN_SRC_CC10;int CONN_SRC_CC11;int CONN_SRC_RPN0;int CONN_SRC_RPN1;// ?? // Pitch Bend Rangeint CONN_SRC_RPN2;// ?? // Fine Tuneint CONN_SRC_POLYPRESSURE;// DLS2 Sources// ?? // Course Tuneint CONN_SRC_CHANNELPRESSURE;int CONN_SRC_VIBRATO;int CONN_SRC_MONOPRESSURE;int CONN_SRC_CC91;int CONN_SRC_CC93;int CONN_TRN_NONE;// DLS1 Transformsint CONN_TRN_CONCAVE;int CONN_TRN_CONVEX;// DLS2 Transformsint CONN_TRN_SWITCH;int DST_FORMAT_CB;int DST_FORMAT_CENT;int DST_FORMAT_TIMECENT;int DST_FORMAT_PERCENT;int source;int control;int destination;int scale;this.destinationthis.scalethis.source// NOT SURE WITHOUT DLS 2 SPEC/** This class is used to store region parts for instrument. ... */int OPTION_SELFNONEXCLUSIVE;int keyfrom;int keyto;int velfrom;int velto;int exclusiveClass;int fusoptions;int phasegroup;long channel;DLSSample sample;DLSSampleOptions sampleoptions;this.channelthis.exclusiveClassthis.fusoptionsthis.keyfromthis.keytothis.phasegroupthis.samplethis.velfromthis.veltothis.modulatorsthis.sampleoptionsimport SoundbankResource/** This class is used to store the sample data itself. ... */ModelByteBuffer data;/** This class is used to store loop points inside DLSSampleOptions class. ... */int LOOP_TYPE_FORWARD;int LOOP_TYPE_RELEASE;long type;long length;/** This class stores options how to playback sampled data like pitch/tuning, ... */new ArrayList<DLSSampleLoop>(...)int unitynote;short finetune;int attenuation;long options;List<DLSSampleLoop> loops;this.attenuationthis.finetunethis.unitynoteimport Stackimport Instrument/** A DLS Level 1 and Level 2 soundbank reader (from files/url/streams). ... */new ArrayList<DLSInstrument>(...)new ArrayList<DLSSample>(...)new HashMap<DLSRegion,Long>(...)new DLSID(...)long i1;int s1;int s2;int x1;int x2;int x3;int x4;int x5;int x6;int x7;int x8;this.i1this.s1this.s2this.x1this.x2this.x3this.x4this.x5this.x6this.x7this.x8DLSID dd.i1d.s1d.s2d.x1d.x2d.x3d.x4d.x5d.x6d.x7d.x8DLSID tt.i1t.s1t.s2t.x1t.x2t.x3t.x4t.x5t.x6t.x7t.x8int DLS_CDL_AND;/** X = X & Y */int DLS_CDL_OR;/** X = X | Y */int DLS_CDL_XOR;/** X = X ^ Y */int DLS_CDL_ADD;/** X = X + Y */int DLS_CDL_SUBTRACT;/** X = X - Y */int DLS_CDL_MULTIPLY;/** X = X * Y */int DLS_CDL_DIVIDE;/** X = X / Y */int DLS_CDL_LOGICAL_AND;/** X = X && Y */int DLS_CDL_LOGICAL_OR;/** X = X || Y */int DLS_CDL_LT;/** X = (X < Y) */int DLS_CDL_LE;/** X = (X <= Y) */int DLS_CDL_GT;/** X = (X > Y) */int DLS_CDL_GE;/** X = (X >= Y) */int DLS_CDL_EQ;/** X = (X == Y) */int DLS_CDL_NOT;/** X = !X */int DLS_CDL_CONST;/** 32-bit constant */int DLS_CDL_QUERY;/** 32-bit value returned from query */int DLS_CDL_QUERYSUPPORTED;DLSID DLSID_GMInHardware;DLSID DLSID_GSInHardware;DLSID DLSID_XGInHardware;DLSID DLSID_SupportsDLS1;DLSID DLSID_SupportsDLS2;DLSID DLSID_SampleMemorySize;DLSID DLSID_ManufacturersID;DLSID DLSID_ProductID;DLSID DLSID_SamplePlaybackRate;long major;long minor;List<DLSInstrument> instruments;List<DLSSample> samples;boolean largeFormat;File sampleFile;readSoundbank(...)RIFFReader riffnew RIFFReader(...)new RIFFInvalidFormatException(...)hasNextChunk(...)RIFFReader chunknextChunk(...)readInfoChunk(...)readLinsChunk(...)readWvplChunk(...)readCdlChunk(...)Entry<DLSRegion,Long> entryMap<>.Entry<DLSRegion,Long>getKey(...).sampletotalMemory(...)// "cdl " chunk can only appear inside : DLS,lart,lar2,rgn,rgn2// Reading cdl-ck ChunkDLSID uuidStack<Long> stacknew Stack<Long>(...)pop(...)push(...)cdlQuery(...)cdlIsQuerySupported(...)info.creationDateinfo.engineersinfo.productinfo.copyrightinfo.commentsinfo.toolsinfo.archival_locationinfo.artistinfo.commissionedinfo.genreinfo.keywordsinfo.mediuminfo.subjectinfo.sourceinfo.source_forminfo.technicianreadInsChunk(...)DLSInstrument instrumentnew DLSInstrument(...)readInsInfoChunk(...)RIFFReader subchunkDLSRegion splitnew DLSRegion(...)readRgnChunk(...)getRegions(...)List<DLSModulator> modlistreadArt1Chunk(...)readArt2Chunk(...)instrument.guidint bankint druminsinstrument.bankinstrument.presetinstrument.druminstrumentlong countDLSModulator modulatornew DLSModulator(...)modulator.versionmodulator.sourcemodulator.controlmodulator.destinationmodulator.transformmodulator.scaleMap<DLSRegion,Long> temp_rgnassign;split.keyfromsplit.keytosplit.velfromsplit.veltosplit.optionssplit.exclusiveClasslong sampleidsplit.fusoptionssplit.phasegroupsplit.channelsplit.sampleoptionsnew DLSSampleOptions(...)readWsmpChunk(...)long loopssampleOptions.unitynotesampleOptions.finetunesampleOptions.attenuationsampleOptions.optionsnew DLSSampleLoop(...)long size2loop.typeloop.startloop.lengthsampleOptions.loopsdlsinstrument.info.namedlsinstrument.infodlsinstrument.info.creationDatedlsinstrument.info.engineersdlsinstrument.info.productdlsinstrument.info.copyrightdlsinstrument.info.commentsdlsinstrument.info.toolsdlsinstrument.info.archival_locationdlsinstrument.info.artistdlsinstrument.info.commissioneddlsinstrument.info.genredlsinstrument.info.keywordsdlsinstrument.info.mediumdlsinstrument.info.subjectdlsinstrument.info.sourcedlsinstrument.info.source_formdlsinstrument.info.technicianreadWaveChunk(...)new DLSSample(...)readWaveInfoChunk(...)sample.guidint sampleformatlong samplerateAudioFormat audioformatnew RIFFInvalidDataException(...)sample.formatsetData(...)getFilePointer(...)int readsample.sampleoptionsdlssample.info.namedlssample.infodlssample.info.creationDatedlssample.info.engineersdlssample.info.productdlssample.info.copyrightdlssample.info.commentsdlssample.info.toolsdlssample.info.archival_locationdlssample.info.artistdlssample.info.commissioneddlssample.info.genredlssample.info.keywordsdlssample.info.mediumdlssample.info.subjectdlssample.info.sourcedlssample.info.source_formdlssample.info.technicianwriteSoundbank(...)new RIFFWriter(...)RIFFWriter colh_chunkwriteChunk(...)RIFFWriter ptbllong ptbl_offsetRIFFWriter wvplwriteList(...)long offList<Long> offsettablenew ArrayList<Long>(...)long bakwriteUnsignedInt(...)RIFFWriter vers_chunkwriteInstruments(...)writeSample(...)setWriteOverride(...)Long offsetwriteInfo(...)boolean convert_neededRIFFWriter fmt_chunklong sratewriteUnsignedShort(...)writeSampleOptions(...)RIFFWriter data_chunkAudioInputStream streamModelByteBuffer databuffsample.infowriteInstrument(...)int art1_countint art2_countRIFFWriter insh_chunkRIFFWriter lrgnDLSRegion regioninstrument.regionswriteRegion(...)writeArticulators(...)instrument.infoRIFFWriter lar1RIFFWriter art1RIFFWriter lar2RIFFWriter art2RIFFWriter rgnsRIFFWriter rgnhregion.keyfromregion.keytoregion.velfromregion.veltoregion.optionsregion.exclusiveClassregion.sampleoptionsregion.sampleRIFFWriter wlnkregion.fusoptionsregion.phasegroupregion.channelsampleoptions.unitynotesampleoptions.finetunesampleoptions.attenuationsampleoptions.optionssampleoptions.loopsRIFFWriter chunkgetBytes(...).lengthwriteInfoStringChunk(...)SoundbankResource[] resourcesnew SoundbankResource[]DLSInstrument[] inslist_arraynew DLSInstrument[]new ModelInstrumentComparator(...)new DLSSample[]int programboolean percussionInstrument instrumentPatch patch2getPatch(...)int program2int bank2boolean percussion2// skipped because we will load the entire bank into memory// long instrumentcount = chunk.readUnsignedInt();// System.out.println("instrumentcount = "+ instrumentcount);// Pool Table Chunk// support for DLS level 2 regions// support for DLS level 2 ART// Read Region Count - ignored// LSB// MSB// Read Reserved byte// Drum Instrument// Read only first 7 bits//System.out.println("bank="+bank+" drumkit="+drumkit//        +" id="+id);// bytes per sec/* long framerate = */// block align, framesize//  chunk.read(buffer);// small cheat, we are going to rewrite data back in wvpl// fmt/* data_chunk.write(databuff.array(), ... *//** This class is used to connect the DLSSoundBank class ... */new DLSSoundbank(...)RIFFInvalidFormatException eimport javax.sound.sampled.*/** Class to write an AudioInputStream to a SourceDataLine. ... */int AUTO_CLOSE_TIME;SourceDataLine source;AudioInputStream ais;// stream as source data...[] audioData;// byte array as source dataint audioDataByteLength;int newPos;boolean looping;Thread pushThread;int wantedState;int threadState;int STATE_NONE;int STATE_PLAYING;int STATE_WAITING;int STATE_STOPPING;int STATE_STOPPED;this.audioDataByteLengththis.audioDataaudioData.lengthint maxWaitCount/** Write data to the source data line. */boolean useStreamint toWriteInterruptedException iedrain(...)// wait that the thread has finished stopping// name// daemon// priority// doStart// 5 seconds//try {// wait for 5 seconds - maybe the clip is to be played again// always write from beginning of buffer// don't use read(byte[]), because some streams// may not override that method// end of stream// end of "stream"// class DataPusher/** A Mixer which provides direct access to audio devices ... */// to improve this class's thread safety.// java.util.concurrent.locks.ReentrantLock and other new classes/methods// Use java.util.concurrent.Semaphore,// IDEA:int CLIP_BUFFER_TIME;// CONSTANTSint DEFAULT_LINE_BUFFER_TIME;// in millisecondsint deviceCountOpened;/** number of opened lines */int deviceCountStarted;/** number of started lines */DirectAudioDeviceProvider.DirectAudioDeviceInfoDirectDLI srcLineInfocreateDataLineInfo(...)Info dstLineInfonew DirectDLI(...)getFormats(...)getHardwareFormats(...)AudioFormat[] hardwareFormatArraynGetFormats(...)getMixerIndex(...)getDeviceID(...)int formatArraySizeint formatArrayIndexboolean isSignedboolean isUnsigned// ABSTRACT MIXER: ABSTRACT METHOD IMPLEMENTATIONSInfo fullInfoInfo dataLineInfoAudioFormat lineFormatint lineBufferSizeAudioFormat[] supportedFormatsgetMaxBufferSize(...)supportedFormats.lengthisFullySpecifiedPCMFormat(...)getLineClass(...)DirectSDL.classnew DirectSDL(...)DirectClip.classnew DirectClip(...)DirectTDL.classnew DirectTDL(...)getMaxSimulLines(...)// IMPLEMENTATION HELPERSgetMixerInfo(...)Encoding enc/** Private inner class for the DataLine.Info objects ... */...[] hardwareFormats;this.hardwareFormatshardwareFormats.length/* public boolean isFormatSupported(AudioFormat format) { ... *//** Private inner class as base class for direct lines */EventDispatcher.LineMonitornew Gain(...)new Mute(...)new Balance(...)new Pan(...)int mixerIndex;int deviceID;int waitTime;boolean flushing;boolean isSource;long bytePosition;// true for SourceDataLine, false for TargetDataLineboolean doIO;boolean stoppedWritten;// true in between start() and stop() callsboolean drained;// true if a write occurred in stopped stateboolean monitoring;// set to true when drain function returns, set to false in write()int softwareConversionSize;// is set to the framesize// if native needs to manually swap samples/convert sign, thisAudioFormat hardwareFormat;Gain gainControl;Mute muteControl;Balance balanceControl;Pan panControl;float leftGain, ...;boolean noService;Object lockNative;// Guards all native calls.// do not run the nService methodthis.mixerIndexthis.deviceIDthis.waitTimethis.isSource// ABSTRACT LINE / DATALINE// ABSTRACT METHOD IMPLEMENTATIONSint encodingDirectDLI ddlicheckRecordPermission(...)millis2bytes(...)isFormatSupportedInHardware(...)AudioFormat newFormatgetSignOrEndianChangedFormat(...)nOpen(...)new LineUnavailableException(...)nGetBufferSize(...)bytes2millis(...)calcVolume(...)nStart(...)requiresServicing(...)addLineMonitor(...)setActive(...)removeLineMonitor(...)nStop(...)long oldIDnClose(...)// METHOD OVERRIDESnAvailable(...)long startPosboolean posChangednIsStillDraining(...)long thisFramePosnFlush(...)// replacement for getFramePosition (see AbstractDataLine)nGetBytePosition(...)/* write() belongs into SourceDataLine and Clip, ... */int writtenint thisWrittennWrite(...)nRequiresServicing(...)// called from event dispatcher for lines that need servicingnService(...)float gaingetLinearGain(...)float bal/////////////////// CONTROLS /////////////////////////////float linearGain;FloatControl.Type.MASTER_GAINFloatControl.TypelinearToDB(...)float newLinearGaindBToLinear(...)// class GainBooleanControl.Type.MUTEBooleanControl.Type// class MuteFloatControl.Type.BALANCEsetValueImpl(...)// class BalanceFloatControl.Type.PAN/** Private inner class representing a SourceDataLine */// class DirectDL/** Private inner class representing a TargetDataLine */int thisReadnRead(...)/** Private inner class representing a Clip ... */int frameSize;int m_lengthInFrames;// size of one frame in bytesint loopCount;int clipBytePosition;int newFramePosition;// index in the audioData array at current playbackint loopStartFrame;// set in setFramePosition()int loopEndFrame;boolean autoclosing;// auto closing clip support// the last sample included in the loop// CLIP METHODS// this method does not copy the data arrayThread.NORM_PRIORITYThread.MAX_PRIORITYthis.frameSizethis.m_lengthInFramesLineUnavailableException lueisAutoClosing(...)autoClosingClipOpened(...)byte[] streamDataint lengthInFramesint arraysizeint bytesRemainingyield(...)int MAX_READ_LIMITDirectBAOS dbaosnew DirectBAOS(...)getInternalBuffer(...)nSetBytePosition(...)long framesmicros2frames(...)setFramePosition(...)// ABSTRACT LINEThread oldThreadjoin(...)autoClosingClipClosed(...)// main playback loopint endFramelong framePosint toWriteFramesint toWriteBytes/* $$mp 2003-10-01 ... */// AUTO CLOSING CLIP SUPPORT/* private inner class representing a ByteArrayOutputStream ... */// DirectClip// class DirectBAOS// javaPos is number of bytes read/written in Java layer// returns if the native implementation needs regular calls to nService()// called in irregular intervals// pass in Line.Info, mixer, controls// Mixer.Info// Control[]// Line.Info[] sourceLineInfo// Line.Info[] targetLineInfo// source lines// SourcedataLine// Clip// arbitrary minimum buffer size// TargetDataLine/* true:SourceDataLine/Clip, false:TargetDataLine */// will insert a magically converted format here// add convenience formats (automatic conversion)// add the other signed'ness for 8-bit// add the other endian'ness for more than 8-bit//System.out.println("Adding "+v.get(v.size()-1));// todo: find out more about the buffer size ?// if a format is specified by the info class passed in, use it.// otherwise use a format from fullInfo.// use the default format// use the last format specified in the line.info object passed// in by the app// if something is not specified, use default format// if it's not supported at all, return 0.// DirectAudioDevices should mix !// if this is PCM_SIGNED and 16-bit or higher, then try with endian-ness magic// if this is PCM and 8-bit, then try with signed-ness magic// 10 milliseconds default wait time// check for record permission/* set up controls */// no controls for non-PCM formats */// no support for more than 2 channels or more than 16 bits/* to keep compatibility with apps that rely on ... *//* some magic to account for not-supported endianness or signed-ness */// apparently, the new format can be used.// So do endian/sign conversion in software// align buffer to full frames// TODO: nicer error messages...// this is an error!// wait time = 1/4 of buffer time// we have seen large buffer sizes!// never wait for more than a second// check for monitoring/servicing// need to set Active and Started// note: the current API always requires that//       Started and Active are set at the same time...// wake up any waiting threads// need to set doIO to false before notifying the// read/write thread, that's why isStartedRunning()// cannot be used// be sure to remove this monitor// additional safeguard against draining forever// this occurred on Solaris 8 x86, probably due to a bug// in the audio driver// check every now and then for a new position// when some time elapsed, check that the frame position// really changed// first stop ongoing read/write method// then flush native buffers// hack because ALSA sometimes reports wrong framepos// this is not exactly correct... would be nicer// if the native sub system sent a callback when IO really starts// error in native layer// trivial case: only use gain// need to combine gain and balance// adjust value within range ?? spec says IllegalArgumentException//newValue = Math.min(newValue, getMaximum());//newValue = Math.max(newValue, getMinimum());// if no exception, commit to our new gain// class Pan// initialize loop selection with full range// means: do not set to a new readFramePos// means: play the clip irrespective of loop points from beginning to end// use DirectDL's open method to open it// one second buffer// if we got this far, we can instanciate the thread// cannot start in createThread, because the thread// uses the "thread" variable as indicator if it should// continue to run// read the data from the stream into an array in one fell swoop.// read data from the stream until we reach the end of the stream// we use a slightly modified version of ByteArrayOutputStream// to get direct access to the byte array (we don't want a new array// to be allocated)// now try to open the device// synchronized// fix for failing test050// $$fb although getFramePosition should return the number of rendered// frames, it is intuitive that setFramePosition will modify that// cease currently playing buffer// set new native position (if necessary)// this must come after the flush!/* $$fb ... */// take into account the case that a new position was set...//if (!doIO && newFramePosition >= 0) {//return newFramePosition;// if the end position is less than the start position, throw IllegalArgumentException// slight race condition with the run() method, but not a big problem// note: when count reaches 0, it means that the entire clip// will be played, i.e. it will play past the loop end point// only if audioData wasn't set in a calling open(format, byte[], frameSize)// this call is allowed.// dispose of thread// wake up the thread if it's in wait()// wait for the thread to terminate itself,// but max. 2 seconds. Must not be synchronized!// remove audioData reference and hand it over to gc// remove this instance from the list of auto closing clips// reset loopCount field so that playback will be normal with// next call to start()// doIO is volatile, but we could check it, then get// pre-empted while another thread changes doIO and notifies,// before we wait (so we sleep in wait forever).// increases bytePosition// make sure nobody called setFramePosition, or stop() during the write() call// since endFrame is the last frame to be played,// framePos is after endFrame when all frames, including framePos,// are played.// at end of playback. If looping is on, loop back to the beginning.// no looping, stop playback// no need for servicing for Clipsimport MixerProvider/** DirectAudioDevice provider. ... */...[] infos;/** Set of info objects for all port input devices on the system. */...[] devices;/** Set of all port input devices on the system. *//** Required public no-arg constructor. */isDirectAudioEnabled(...)new DirectAudioDeviceInfo[]new DirectAudioDevice[]int numDevicesnGetNumDevices(...)nNewDirectAudioDeviceInfo(...)Mixer mixergetDevice(...)getSourceLineInfo(...).lengthgetSourceLineInfo(...)new DirectAudioDevice(...)/** Info class for DirectAudioDevices.  Adds an index value and a string for ... */int maxSimulLines;// For ALSA, the deviceID contains the encoded card index, device index, and sub-device-indexthis.maxSimulLines// NATIVE METHODS// class DirectAudioDeviceInfo// index: [0..nGetNumDevices()-1]// STATIC// get the number of input devices// fill in the info objects now.// if the default device is asked, we provide the mixer// with SourceDataLine's// otherwise get the first mixer that matches// the requested info object/** Emergency Soundbank generator. ... */...[] general_midi_instruments;SF2Soundbank sf2new SF2Soundbank(...)SF2Layer bass_drumnew_bass_drum(...)SF2Layer snare_drumnew_snare_drum(...)SF2Layer tomnew_tom(...)SF2Layer open_hihatnew_open_hihat(...)SF2Layer closed_hihatnew_closed_hihat(...)SF2Layer crash_cymbalnew_crash_cymbal(...)SF2Layer side_sticknew_side_stick(...)SF2Layer[] drumsnew SF2Layer[]SF2Instrument drum_instrumentnew SF2Instrument(...)SF2Layer gpianonew_gpiano(...)SF2Layer gpiano2new_gpiano2(...)SF2Layer gpiano_hammernew_piano_hammer(...)SF2Layer piano1new_piano1(...)SF2Layer epiano1new_epiano1(...)SF2Layer epiano2new_epiano2(...)SF2Layer guitarnew_guitar1(...)SF2Layer guitar_picknew_guitar_pick(...)SF2Layer guitar_distnew_guitar_dist(...)SF2Layer bass1new_bass1(...)SF2Layer bass2new_bass2(...)SF2Layer synthbassnew_synthbass(...)SF2Layer string2new_string2(...)SF2Layer orchhitnew_orchhit(...)SF2Layer choirnew_choir(...)SF2Layer solostringnew_solostring(...)SF2Layer organnew_organ(...)SF2Layer ch_organnew_ch_organ(...)SF2Layer bellnew_bell(...)SF2Layer flutenew_flute(...)SF2Layer timpaninew_timpani(...)SF2Layer melodic_tomsnew_melodic_toms(...)SF2Layer trumpetnew_trumpet(...)SF2Layer trombonenew_trombone(...)SF2Layer brass_sectionnew_brass_section(...)SF2Layer hornnew_horn(...)SF2Layer saxnew_sax(...)SF2Layer oboenew_oboe(...)SF2Layer bassoonnew_bassoon(...)SF2Layer clarinetnew_clarinet(...)SF2Layer reverse_cymbalnew_reverse_cymbal(...)SF2Layer defaultsoundSF2Instrument slow_stringsnewInstrument(...)new Patch(...)SF2InstrumentRegion regionsetVendor(...)setDescription(...)setPatch(...)drums.lengthnew SF2InstrumentRegion(...)putBytes(...)SF2InstrumentRegion.GENERATOR_KEYRANGESF2Instrument insSF2Region.GENERATOR_INITIALFILTERFCSF2Region.GENERATOR_FINETUNESF2Region.GENERATOR_ATTACKVOLENVSF2Region.GENERATOR_RELEASEVOLENVSF2Region.GENERATOR_COARSETUNESF2Region.GENERATOR_INITIALATTENUATIONSF2Region.GENERATOR_SUSTAINVOLENVSF2Region.GENERATOR_DECAYVOLENVSF2Instrument instrumentgetInstruments(...)Patch patchRandom randomint fftsizedouble[] datadouble basedouble start_wdouble end_wdouble start_adouble end_adouble adouble a_stepSF2Sample samplenewSimpleFFTSample(...)SF2Layer layernewLayer(...)SF2Region regiondouble detunenextDouble(...)double wcomplexGaussianDist(...)SF2Region.GENERATOR_SAMPLEMODESSF2Region.GENERATOR_ATTACKMODENVSF2Region.GENERATOR_RELEASEMODENVSF2Region.GENERATOR_MODENVTOFILTERFCdouble[] aanewSimpleFFTSample_dist(...)double[] databnewSimpleDrumSample(...)new SF2Layer(...)SF2GlobalRegion globalnew SF2GlobalRegion(...)SF2LayerRegion regionnew SF2LayerRegion(...)int fftlendouble gainfft(...)randomPhase(...)ifft(...)normalize(...)realPart(...)fadeUp(...)setGlobalZone(...)addResource(...)double aiint adjustSF2Region.GENERATOR_INITIALFILTERQaa.lengthSF2Region.GENERATOR_FREQVIBLFOSF2Region.GENERATOR_VIBLFOTOPITCHdouble[] datahdouble d_lendatah.lengthsetOriginalPitch(...)SF2Region.GENERATOR_SCALETUNINGSF2Region.GENERATOR_EXCLUSIVECLASSdouble basefreqfloat[] fdatatoFloat(...)toBytes(...)new SF2Sample(...)double orgnoteloopExtend(...)fdata.lengthsetStartLoop(...)setEndLoop(...)setSampleRate(...)setPitchCorrection(...)signum(...)layers.lengthSF2InstrumentRegion insregionnew FFT(...)cdata.lengthdouble phaserandom(...)double ddouble maxvaluedouble[] outfloat[] outdouble dsamplesdouble[] outdataint p_lenint p_psoutdata.lengthfloat[] outdata/* percussion instruments */// Use side_stick for missing drums:/* melodic instruments *///region.putInteger(SF2Region.GENERATOR_DECAYVOLENV, 2400);//region.putInteger(SF2Region.GENERATOR_SUSTAINVOLENV, 200);//region.putInteger(SF2Region.GENERATOR_ATTACKMODENV, -100);//region.putInteger(SF2Region.GENERATOR_RELEASEMODENV, 12000);//region.putInteger(SF2Region.GENERATOR_MODENVTOFILTERFC, -1000);//region.putInteger(SF2Region.GENERATOR_INITIALATTENUATION, -20);// Make treble part// Remove all negative frequency//region.putInteger(SF2Region.GENERATOR_SCALETUNING, 0);//        region.putInteger(SF2Region.GENERATOR_INITIALATTENUATION, -100);/* region.putInteger(SF2Region.GENERATOR_ATTACKMODENV, 0); ... *///Random random = new Random(302030201);//aa[2] *= 0.1;//double detune = 1 + (random.nextDouble()*2 - 1)*0.0001;//*= w_step;// Make Bass Part/* Create SoundFont2 sample. *//* Create SoundFont2 instrument. *//* Create region for instrument. */import ControllerEventListenerimport MetaEventListenerimport MetaMessageimport ShortMessage/** EventDispatcher.  Used by various classes in the Java Sound implementation ... */new ArrayList<ClipInfo>(...)new ArrayList<LineMonitor>(...)/** time of inactivity until the auto closing clips ... */ArrayList<> eventQueue;/** List of events *//** Thread object for this EventDispatcher instance */ArrayList<ClipInfo> autoClosingClips;/* support for auto-closing Clips */ArrayList<LineMonitor> lineMonitors;/* support for monitoring data lines */int LINE_MONITOR_TIME;/** Approximate interval between calls to LineMonitor.checkLine *//** This start() method starts an event thread if one is not already active. *//** Invoked when there is at least one event in the queue. ... */getEvent(...)LineEvent eventMetaMessage eventmeta(...)ShortMessage eventint statuscontrolChange(...)/** Wait until there is something in the event queue to process.  Then ... */EventInfo eventInfoint waitTimecloseAutoClosingClips(...)monitorLines(...)/** Queue the given event in the event queue. *//** A loop to dispatch events. */dispatchEvents(...)/** Send audio and MIDI events. */new EventInfo(...)postEvent(...)/* go through the list of registered auto-closing ... */long currTimeClipInfo infoisExpired(...)AutoClosingClip clip/** called from auto-closing clips when one of their open() method is called */getAutoClosingClipIndex(...)new ClipInfo(...)/** called from auto-closing clips when their closed() method is called *//* go through the list of registered line monitors ... */// ////////////////////////// Line Monitoring Support /////////////////// //checkLine(...)/** Add this LineMonitor instance to the list of monitors *//** Remove this LineMonitor instance from the list of monitors *//** Container for an event and a set of listeners to deliver it to. */// /////////////////////////////////// INNER CLASSES ////////////////////////////////////////// //Object event;...[] listeners;/** Create a new instance of this event Info class ... *//** Container for a clip with its expiration time */// class EventInfoAutoClosingClip clip;long expiration;/** Create a new instance of this clip Info class */this.clipthis.expiration/** Interface that a class that wants to get regular ... */// class ClipInfo/** Called by event dispatcher in regular intervals */// process an LineEvent// process a MetaMessage// process a Controller or Mode Event// Controller and Mode events have status byte 0xBc, where// c is the channel they are sent on.// Wait till there is an event in the event queue.// Remove the event from the queue and dispatch it to the listeners.// end of synchronized// sanity check// this is only for the case that the first clip is set to autoclosing,// and it is already open, and nothing is done with it.// EventDispatcher.process() method would block in wait() and// never close this first clip, keeping the device open.// nothing to do -- is removed from arraylist above// need to interrupt the infinite wait()// class EventDispatcher/** Fast Fourier Transformer. ... */...[] w;int fftFrameSize;int sign;...[] bitm_array;int fftFrameSize2;// Framesize must be power of 2// The order is: real (sin), complex (cos)// Data = Interlaced double array to be transformed.// Sign = -1 is FFT, 1 is IFFT (inverse FFT)computeTwiddleFactors(...)this.fftFrameSizethis.signint bitmbitreversal(...)calc(...)int imaxdouble[] warrayint w_indexint nstepdouble wrdouble widouble argdouble wfrdouble wfidouble temprint w_index2warray.lengthdouble wr1double wi1int fftFrameSize2calcF4F(...)calcF4I(...)double datam_rdouble datam_idouble datan_rdouble datan_idouble tempi// complex operators// Perform Factor-4 Decomposition with 3 * complex operators and 8 +/-int w_lenw.lengthint nnstepint iiicalcF4FE(...)calcF2E(...)double datam1_rdouble datam1_idouble datan1_rdouble datan1_idouble datam2_rdouble datam2_idouble datan2_rdouble datan2_idouble n2w1rdouble n2w1idouble m2ww1rdouble m2ww1idouble wwr1double wwi1calcF4IE(...)int inverse// Pre-process Bit-Reversal// PRECOMPUTATION of wwr1, wwi1 for factor 4 Decomposition (3 * complex// operators and 8 +/- complex operators)// 2*fftFrameSize;// Factor-4 Decomposition// Goto Factor-4 Final Decomposition// calcF4E(data, i, nstep, -1, w);// Factor-4 Decomposition not possible// double wwr1 = wr * wr1 - wi * wi1; // these numbers can be// precomputed!!!// double wwi1 = wr * wi1 + wi * wr1;// calcF4E(data, i, nstep, 1, w);// Performing Bit-Reversal, even v.s. even, O(2N)// COMPLEX: SWAP(data[n], data[m])// Real Part// Imagery Part// Performing Bit-Reversal, odd v.s. even, O(N)// bitm_array[i+2];/** an optimized ShortMessage that does not need an array ... */int packedMsg;this.packedMsggetDataLength(...)/** Creates a FastShortMessage from this ShortMessage */getData1(...)getData2(...)byte[] returnedArrayInvalidMidiDataException imdesetMessage(...)/** Creates a new object of the same class and with the same contents ... */// to check for validity// fix for bug 4851018: MidiMessage.getLength and .getData return wrong values// fix for bug 4890405: Reading MidiMessage byte array fails in 1.4.2// check for valid values// can throw InvalidMidiDataException// throws Exception// class FastShortMsg/** optimized FastSysexMessage that doesn't copy the array upon instantiation ... *//** The returned array may be larger than this message is. ... */// which is shared among all transmitters, cannot be modified// overwrite this method so that the original data array,// will throw Exception// class FastSysexMessage/** This exception is used when a file contains illegal or unexpected data. ... *//** This exception is used when a reader is used to read file of a format ... *//** JarSoundbankReader is used to read soundbank object from jar files. ... */ArrayList<Soundbank> soundbanksnew ArrayList<Soundbank>(...)URLClassLoader uclisZIP(...)BufferedReader rString lineClassNotFoundException ignoredInstantiationException ignoredIllegalAccessException ignoredSoundbank soundbankaddAllInstruments(...)import Sequencerimport Transmitterimport MidiFileReaderimport MidiFileWriterimport Portimport TargetDataLineimport AudioFileReaderimport AudioFileWriter/** JDK13Services uses the Service class in JDK 1.3 to discover a list of service ... */String PROPERTIES_FILENAME;/** Filename of the properties file for default provider properties. This ... */Properties properties;/** Properties loaded from the properties file for default provider ... *//** Private, no-args constructor to ensure against instantiation. *//** Obtains a List containing installed instances of the providers for the ... */List<?> providersgetProviders(...)/** Obtain the provider class name part of a default provider property. ... */String defaultProviderSpecgetDefaultProvider(...)int hashpos/** Obtain the instance name part of a default provider property. ... *//** Obtain the value of a default provider property. ... */new PrivilegedAction<String>(...) { ... }/** Obtain a properties bundle containing property values from the ... */loadProperties(...)// instance name only; leave value as nullimport ServiceLoaderimport AudioPermission/** Managing security in the Java Sound implementation. ... *//** Prevent instantiation. *//** Checks if the VM currently has a SecurityManager installed. ... */new AudioPermission(...)/** Load properties from a file. ... */hasSecurityManager(...)loadPropertiesImpl(...)BufferedInputStream bingetCanonicalPath(...)/** Create a Thread in the current ThreadGroup. */Thread threadsetPriority(...)List<T> pnew ArrayList<T>(...)PrivilegedAction<Iterator<T>> psActionIterator<T> psPrivilegedAction<Boolean> hasNextActionT provider// invoke the privileged action using 1.2 security// try without using JDK 1.2 security// not JDK 1.2 security, assume we already have permission// ServiceLoader creates "lazy" iterator instance, but it ensures that// next/hasNext run with permissions that are restricted by whatever// creates the ServiceLoader instance, so it requires to be called from// privileged section// the iterator's hasNext() method looks through classpath for// the provider class names, so it requires read permissions// the iterator's next() method creates instances of the// providers and it should be called in the current security// context// $$mp 2003-08-22// Always adding at the beginning reverses the// order of the providers. So we no longer have// to do this in AudioSystem and MidiSystem.//$$fb 2002-11-07: do not fail on SPI not foundimport AudioClipimport MidiSystemimport MidiFileFormatimport Sequence/** Java Sound audio clip; ... */long lastPlayCall;// number of bytes written each time to the source data lineint MINIMUM_PLAY_DELAY;...[] loadedAudio;int loadedAudioByteLength;AudioFormat loadedAudioFormat;boolean clipLooping;DataPusher datapusher;Sequencer sequencer;Sequence sequence;boolean sequencerloop;long CLIP_THRESHOLD;/** used for determining how many samples is the ... */int STREAM_BUFFER_SIZE;//private final static long CLIP_THRESHOLD = 1;boolean successAudioInputStream asloadAudioData(...)createClip(...)createSourceDataLine(...)MidiFileFormat mffgetMidiFileFormat(...)createSequencer(...)InvalidMidiDataException e1startImpl(...)loop(...)Clip.LOOP_CONTINUOUSLYsetMicrosecondPosition(...)setSequence(...)MidiUnavailableException e2addMetaEventListener(...)Exception e1Exception e3Exception e4// Event handlers (for debugging)// handle MIDI track end meta events for looping// FILE LOADING METHODSlong frameLenlong byteLengetPCMConvertedAudioInputStream(...)readStream(...)int intLenDirectBAOS baosint totalBytesRead// METHODS FOR CREATING THE DEVICEObject linegetLine(...)isLineSupported(...)setAutoClosing(...)addLineListener(...)SourceDataLine sourcenew DataPusher(...)getSequencer(...)MidiUnavailableException me// load the stream data into memory// not an audio file// hack for some applets that call the start method very rapidly...// need to stop in case the looped status changed//notifyAll();//$$fb 2001-09-26: may improve situation related to bug #4302884// first possibly convert this stream to PCM// if the stream length is known, it can be efficiently loaded into memory// otherwise we use a ByteArrayOutputStream to load it into memory// if everything went fine, we have now the audio data in// loadedAudio, and the byte length in loadedAudioByteLength// arrays "only" max. 2GB// this loop may throw an IOException// fail silently// fail -> will try with SourceDataLine// get the sequencer/** Helper class which allows to convert {@code Receiver} ... */MidiDevice device;/** Creates a new {@code MidiDeviceReceiverEnvelope} object which ... */this.device// Receiver implementation// MidiDeviceReceiver implementation/** Obtains the receiver enveloped ... *//** Helper class which allows to convert {@code Transmitter} ... */Transmitter transmitter;/** Creates a new {@code MidiDeviceTransmitterEnvelope} object which ... */this.transmitter// Transmitter implementationsetReceiver(...)/** Obtains the transmitter enveloped ... *//** MidiInDevice class representing functionality of MidiIn devices. ... */Thread midiInThread;AbstractMidiDeviceProvider.Info// may want to separate these??// $$kk: 06.24.99: i have this both opening and starting the midi in device.// IMPLEMENTATION OF ABSTRACT MIDI DEVICE METHODSMidiInDeviceProvider.MidiInDeviceInfogetDeviceInfo(...)// $$kk: 06.24.99: i have this both stopping and closing the midi in device.long oldIdlong timestampnGetTimeStamp(...)// OVERRIDES OF ABSTRACT MIDI DEVICE METHODSnew MidiInTransmitter(...)/** An own class to distinguish the class name from ... */// RUNNABLE METHODnGetMessages(...)Printer.verbose/** Callback from native code when a short MIDI event is received from hardware. ... */// CALLBACKS FROM NATIVE// go into native code and get messages. May be blocking// can throw MidiUnavailableException// create / start a thread to get messages// close the device// IGNORE EXCEPTION// while the device is started, keep trying to get messages.// this thread returns from native code whenever stop() or close() is called// go into native code and retrieve messages// let the thread exit/* if(Printer.verbose) { ... *//** MIDI input device provider. ... *//** Cache of info objects for all MIDI output devices on the system. *//** Cache of open MIDI input devices on the system. */// implementation of abstract methods in AbstractMidiDeviceProvidernew MidiInDeviceInfo(...)new MidiInDevice(...)this.devicesthis.infos/** Info class for MidiInDevices.  Adds the ... */Class<> providerClass;nGetName(...)nGetVendor(...)nGetDescription(...)nGetVersion(...)this.providerClass// class MidiInDeviceInfo/** MidiOutDevice class representing functionality of MidiOut devices. ... */new MidiOutReceiver(...)int packedMsgShortMessage msgnSendShortMessage(...)getReadOnlyMessage(...)nSendLongMessage(...)/** shortcut for the Sun implementation */// class MidiOutReceiver// prevent further action/* We handle meta messages here. The message ... */// class MidiOutDevice/** MIDI output device provider. ... *//** Cache of open MIDI output devices on the system. */new MidiOutDeviceInfo(...)new MidiOutDevice(...)/** Info class for MidiOutDevices.  Adds the ... */// class MidiOutDeviceInfo/** Some utilities for MIDI (some stuff is used from javax.sound.midi) ... */// - define and use a global symbolic constant for 60000000 (see convertTempo)// TODO:int DEFAULT_TEMPO_MPQ;int META_END_OF_TRACK_TYPE;// 120bpmint META_TEMPO_TYPE;/** Suppresses default constructor, ensuring non-instantiability. *//** return true if the passed message is Meta End Of Track */MetaMessage.META/** return if the given message is a meta tempo message *//** parses this message for a META tempo message and returns ... */int tempo/** converts<br> ... *//** convert tick to microsecond with given tempo. ... *//** convert tempo to microsecond with given tempo ... *//** Given a tick, convert to microsecond ... */int resolutiongetResolution(...)long[] tickscache.ticksint[] temposcache.temposint cacheCounttempos.lengthint snapshotIndexcache.snapshotIndexint snapshotMicrocache.snapshotMicrolong usgetDivisionType(...)Sequence.PPQdouble secondsnew TempoCache(...)ticks2microsec(...)/** Given a microsecond time, convert to tick. ... */long tickint newReadPosdouble dTickcache.currTempogetTempoMPQAt(...)long nextTimemicrosec2ticks(...)/** Binary search for the event indexes of the track ... */getTick(...)...[] ticks;...[] tempos;int snapshotIndex;// index in ticks/tempos at the snapshot// in MPQint snapshotMicro;// microsecond at the snapshotint currTempo;boolean firstTempoIsFake;// MPQ, used as return value for microsecond2tickrefresh(...)Track[] tracksgetTracks(...)tracks.lengthTrack trackMidiEvent evMidiMessage msgisMetaTempo(...)MidiEvent evtgetTempoMPQ(...)ticks.length// first check if it is a META message at all// now get message and check for end of track// now get message and check for tempo// meta type must be 0x51, and data length must be 3// do not round to nearest tick//return (long) Math.round((((double)us) * resolution) / tempoMPQ);// optimization to not always go through entire list of tempo events// walk through all tempo changes and add time for the respective blocks// microsecond// this implementation needs a tempo event at tick 0!// to find the right tick// this loop requires that the first tempo Event is at time 0//if (Printer.debug) Printer.debug("   -> convert back = " + (tick2microsecond(seq, tick, null) / 1000)+" microseconds");// take the middle event as estimate// tick of estimate// estimate too low// "or after tick"// if (t>tick)// estimate too high// just some defaults, to prevents weird stuff// tempo events only occur in track 0// found a tempo event. Add it to the list// do not need to add an initial tempo event at the beginning// add tempo 120 at beginning/** ModelAbstractChannelMixer is ready for use class to implement ... */import MidiChannelimport VoiceStatus/** A abstract class used to simplify creating custom ModelOscillator. ... */float pitch;float samplerate;MidiChannel channel;VoiceStatus voice;int noteNumber;int velocity;boolean on;this.voicethis.noteNumberthis.velocitythis.pitchthis.samplerateModelAbstractOscillator oscsgetPerformer(...)getInstrument(...)Instrument insPatch pnew Instrument[]// Create performer for my custom oscillirator// Create Instrument object around my performer// Create Soundbank object around the instrument/** This class is a pointer to a binary array either in memory or on disk. ... */ModelByteBuffer root;long fileoffset;long offset;long len;RandomAccessFile raf;long left;long mark;long markleft;root.fileroot.fileoffsetlong plong parent_lenparent.lenthis.rootparent.rootroot.bufferthis.fileoffsetnew RandomFileInputStream(...)subbuffer(...)File selfileModelByteBuffer mbuffmbuff.rootmbuff.filembuff.buffermbuff.fileoffsetmbuff.offsetDataInputStream isunload(...)//e.printStackTrace();/** Wavetable oscillator for pre-loaded data. ... */boolean bigendian;int pos2;int markpos2;byte[] buff1byte[] buff2float loopStart;float loopLength;ModelByteBuffer buffer;ModelByteBuffer buffer8;float pitchcorrection;float attenuation;int loopType;this.pitchcorrectionnew Buffer8PlusInputStream(...)AudioFormat format2// attenuation is in cBthis.loopLengththis.loopStartthis.loopType// ModelWavetableOscillator doesn't support ModelOscillatorStream/** ModelChannelMixer is used to process channel voice mix output before going ... */// Used to process input audio from voices mix.// and it should fade out.// Is used to trigger that this mixer is not be used/** Connection blocks are used to connect source variable ... */new ModelSource[]...[] no_sources;//   source1 * source2 * scale -> destination...[] sources;double scale;ModelDestination destination;this.sourcessources.lengthsource.lengthModelSource[] oldsourcesoldsources.length/** This class is used to identify destinations in connection blocks, ... */new ModelStandardTransform(...)ModelIdentifier DESTINATION_NONE;ModelIdentifier DESTINATION_KEYNUMBER;ModelIdentifier DESTINATION_VELOCITY;ModelIdentifier DESTINATION_PITCH;ModelIdentifier DESTINATION_GAIN;ModelIdentifier DESTINATION_PAN;ModelIdentifier DESTINATION_REVERB;// 0.1 %ModelIdentifier DESTINATION_CHORUS;ModelIdentifier DESTINATION_LFO1_DELAY;ModelIdentifier DESTINATION_LFO1_FREQ;ModelIdentifier DESTINATION_LFO2_DELAY;ModelIdentifier DESTINATION_LFO2_FREQ;ModelIdentifier DESTINATION_EG1_DELAY;ModelIdentifier DESTINATION_EG1_ATTACK;ModelIdentifier DESTINATION_EG1_HOLD;ModelIdentifier DESTINATION_EG1_DECAY;ModelIdentifier DESTINATION_EG1_SUSTAIN;ModelIdentifier DESTINATION_EG1_RELEASE;// 0.1 % (I want this to be value not %)ModelIdentifier DESTINATION_EG1_SHUTDOWN;ModelIdentifier DESTINATION_EG2_DELAY;ModelIdentifier DESTINATION_EG2_ATTACK;ModelIdentifier DESTINATION_EG2_HOLD;ModelIdentifier DESTINATION_EG2_DECAY;ModelIdentifier DESTINATION_EG2_SUSTAIN;ModelIdentifier DESTINATION_EG2_RELEASE;// 0.1 % ( I want this to be value not %)ModelIdentifier DESTINATION_EG2_SHUTDOWN;ModelIdentifier DESTINATION_FILTER_FREQ;ModelIdentifier DESTINATION_FILTER_Q;ModelIdentifier destination;ModelTransform transform;/** ModelDirectedPlayer is the one who is directed by ModelDirector ... *//** A director chooses what performers should be  played for each note on ... *//** This class stores the identity of source and destinations in connection ... */String object;/* Object    Variable ... */String variable;int instance;this.variableint hashcodeModelIdentifier mobjmobj.objectmobj.variable/** The model instrument class. ... */new ModelStandardIndexedDirector(...)// Get General MIDI 2 Alias patch for this instrument.// returned from getPerformers().// This information is generated from ModelPerformer.getName()// Return name of all the keys.getPerformers(...)getKeyFrom(...)getKeyTo(...)// on General MIDI synthesizer.// Return what channels this instrument will probably responseboolean[] chch.length// Check if instrument is percussion.// Check if instrument uses General MIDI 2 default banks./** Instrument comparator class. ... */Patch p0Patch p1/** This class is used to map instrument to another patch. ... */ModelInstrument ins;getDataClass(...)this.insgetDirector(...)getChannelMixer(...)/** This interface is used for oscillators. ... *//** Attenuation is in cB. ... *//** This interface is used for audio streams from ModelOscillator. ... */// Pitch is in cents!/** A extended patch object that has isPercussion function. ... */boolean percussion;this.percussion/** This class is used to define how to synthesize audio in universal maner ... */new ArrayList<ModelOscillator>(...)new ArrayList<ModelConnectionBlock>(...)List<ModelOscillator> oscillators;List<ModelConnectionBlock> connectionBlocks;int keyFrom;int keyTo;int velFrom;int velTo;boolean releaseTrigger;boolean selfNonExclusive;Object userObject;boolean addDefaultConnections;this.connectionBlocksthis.selfNonExclusivethis.keyFromthis.keyTothis.velFromthis.velTothis.releaseTriggerthis.addDefaultConnections/** This class is used to identify sources in connection blocks, ... */ModelIdentifier SOURCE_NONE;ModelIdentifier SOURCE_NOTEON_KEYNUMBER;ModelIdentifier SOURCE_NOTEON_VELOCITY;// midi keynumberModelIdentifier SOURCE_EG1;// midi velocityModelIdentifier SOURCE_EG2;ModelIdentifier SOURCE_LFO1;ModelIdentifier SOURCE_LFO2;ModelIdentifier SOURCE_MIDI_PITCH;ModelIdentifier SOURCE_MIDI_CHANNEL_PRESSURE;// (0..16383)ModelIdentifier SOURCE_MIDI_POLY_PRESSURE;//            new ModelIdentifier("midi","mono_pressure",0);    // (0..127)//    public static final ModelIdentifier SOURCE_MIDI_MONO_PRESSURE =// (0..127)ModelIdentifier SOURCE_MIDI_CC_0;ModelIdentifier SOURCE_MIDI_RPN_0;ModelIdentifier source;/** A standard director who chooses performers ... */...[] performers;ModelDirectedPlayer player;boolean noteOnUsed;boolean noteOffUsed;this.performersperformers.lengththis.playerModelPerformer pisReleaseTriggered(...)getVelFrom(...)getVelTo(...)play(...)/** A standard indexed director who chooses performers ... */...[] trantables;// Variables needed for index...[] counters;...[] mat;buildindex(...)int xtint yttrantables.lengthint keyFromint keyToint velFromint velTorestrict(...)byte[] trantableint transizetrantable.lengthint x_fromint x_toint y_fromint y_toint[] mprevint[] mnewmprev.lengthmnew.lengthint[] plistlookupIndex(...)/** A standard transformer used in connection blocks. ... */boolean DIRECTION_MIN2MAX;boolean DIRECTION_MAX2MIN;boolean POLARITY_UNIPOLAR;boolean POLARITY_BIPOLAR;int TRANSFORM_LINEAR;int TRANSFORM_CONCAVE;// concave: output = (20*log10(127^2/value^2)) / 96int TRANSFORM_CONVEX;// convex: same as concave except that start and end point are reversed.int TRANSFORM_SWITCH;// switch: if value > avg(max,min) then max else minint TRANSFORM_ABSOLUTE;boolean direction;double s/** Model transform interface. ... *//** This is a wavetable oscillator interface. ... */int LOOP_TYPE_OFF;int LOOP_TYPE_PINGPONG;int LOOP_TYPE_REVERSE;/** Converts among signed/unsigned and little/big endianness of sampled. ... */...[] inputEncodings;...[] outputEncodings;/** Constructs a new PCMtoPCM codec object. */Encoding[] encsVector<> newFormats/** use old code */new PCMtoPCMCodecStream(...)int sampleSizeboolean isBigEndianint PCM_SWITCH_SIGNED_8BIT;int PCM_SWITCH_ENDIAN;int PCM_SWITCH_SIGNED_LE;int PCM_SWITCH_SIGNED_BE;int PCM_UNSIGNED_LE2SIGNED_BE;int PCM_SIGNED_LE2UNSIGNED_BE;int PCM_UNSIGNED_BE2SIGNED_LE;int PCM_SIGNED_BE2UNSIGNED_LE;int sampleSizeInBytes;int conversionType;Encoding inputEncodingEncoding outputEncodingboolean inputIsBigEndianboolean outputIsBigEndian/** Note that this only works for sign conversions. ... */byte tempbytebyte tempByteswitchSigned8bit(...)switchEndian(...)switchSignedLE(...)switchSignedBE(...)// filter out targetEncoding from the old getOutputFormats( sourceFormat ) method// determine conversion to perform// set the audio stream length in frames if we know it// $$jb: do we want to implement this function?// $$jb: what to return here?// don't read past our own set length// now do the conversions// we've done the conversion, just return the readCount// end class PCMtoPCMCodecStream// end class PCMtoPCMCodec/** Audio configuration class for exposing attributes specific to the platform or system. ... */loadLibraries(...)readProperties(...)String libNameMain;// native library we need to load// STATIC FINAL CHARACTERISTICSString libNameALSA;String libNameDSound;int LIB_MAIN;// extra libs handling: bit flags for each different libraryint LIB_ALSA;int LIB_DSOUND;int loadedLibs;// bit field of the constants above. Willbe set in loadLibrariesint FEATURE_MIDIIO;// contained in which lib// features: the main native library jsound reports which feature isint FEATURE_PORTS;int FEATURE_DIRECT_AUDIO;boolean signed8;// $$kk: 03.11.99: i think solaris takes unsigned 8-bit or signed 16-bit data....// wait, is that true?  i'm not sure.  i think solaris takes unsigned data?// we'll leave it here as a variable; in the future we may need this in java.// the solaris sbpro card.// signed8 (use signed 8-bit values) is true for everything we support except for// vary according to hardware architecture// SYSTEM CHARACTERISTICS// intel is little-endian.  sparc is big-endian./** Private constructor. *//** Dummy method for forcing initialization. */// METHODS FOR INTERNAL IMPLEMENTATION USE/** Determine whether the system is big-endian. *//** Determine whether the system takes signed 8-bit data. *//** Load the native library or libraries. */String extraLibsnGetExtraLibraries(...)new PrivilegedAction<Void>(...) { ... }String libisFeatureLibLoaded(...)int requiredLibnGetLibraryForFeature(...)boolean isLoaded// the following native methods are implemented in Platform.c/** Read the required system properties. */nIsBigEndian(...)nIsSigned8(...)// load the main library// just for the heck of it...// now try to load extra libs. They are defined at compile time in the Makefile// with the define EXTRA_SOUND_JNI_LIBS// the string is the libraries, separated by white space// $$fb 2002-03-06: implement check for endianness in native. Facilitates porting !// Solaris on Sparc: signed, all others unsignedimport BooleanControlimport CompoundControlimport FloatControl/** A Mixer which only provides Ports. ... */int SRC_UNKNOWN;int SRC_MICROPHONE;int SRC_LINE_IN;int SRC_COMPACT_DISC;int SRC_MASK;int DST_UNKNOWN;int DST_SPEAKER;int DST_HEADPHONE;int DST_LINE_OUT;int DST_MASK;...[] portInfos;Port.Info...[] ports;// cache of instantiated ports// instance ID of the native implementationPortMixerProvider.PortMixerInfoint srcLineCountint dstLineCountnGetPortCount(...)nGetPortType(...)getPortInfo(...)isSource(...)portInfos.lengthlong thisIDports.lengthdisposeControls(...)new PortInfo(...)nGetPortName(...)Port.Info.MICROPHONEPort.Info.LINE_INPort.Info.COMPACT_DISCPort.Info.SPEAKERPort.Info.HEADPHONEPort.Info.LINE_OUTnew PortMixerPort[]new PortMixerPort(...)/** Private inner class representing a Port for the PortMixer. */int portIndex;this.portIndexlong newIDVector<> vectornGetControls(...)enableControls(...)(...).closedgetMemberControls(...)// this is very similar to open(AudioFormat, int) in AbstractDataLine...// this is very similar to close() in AbstractDataLine.../** Private inner class representing a BooleanControl for PortMixerPort */// class PortMixerPortlong controlID;// the handle to the native control functionnew BCT(...)createType(...)this.controlIDnControlSetIntValue(...)nControlGetIntValue(...)/** inner class for custom types *//** Private inner class representing a CompoundControl for PortMixerPort */new CCT(...)/** inner class for custom compound control types */CompoundControl.TypeFloatControl.Type.VOLUME...[] FLOAT_CONTROL_TYPES;// predefined float control types. See also Ports.hnew FCT(...)nControlSetFloatValue(...)nControlGetFloatValue(...)/** Private inner class representing a port info */// open the mixer with the given index. Returns a handle ID// gets the number of ports for this mixer// gets the type of the port with this index// gets the name of the port with this index// fills the vector with the controls for this port// getters/setters for controls// fill sourceLineInfo and targetLineInfos with copies of the ones in portInfos//return AudioSystem.NOT_SPECIFIED; // if several instances of PortMixerPort// open the mixer device// close the mixer device// should never happen...// $$fb TODO: return (Port) (ports[index].clone());// get rid of controls// open the line.  may throw LineUnavailableException.// $$fb add as new static type?//return BooleanControl.Type.SELECT;// never use any cached values// ??/** Port provider. ... */isPortsEnabled(...)new PortMixerInfo[]new PortMixer[]nNewPortMixerInfo(...)new PortMixer(...)/** Info class for PortMixers.  Adds an index value for ... */// class PortMixerInfo// we'll fill in the device objects as they're requested./** Printer allows you to set up global debugging status and print ... */boolean err;boolean release;boolean SHOW_THREADID;boolean SHOW_TIMESTAMP;/* static void setErrorPrint(boolean on) { ... */String prepend/** This exception is used when a RIFF file contains illegal or unexpected data. ... *//** This exception is used when a reader is used to read RIFF file of a format it ... *//** Resource Interchange File Format (RIFF) stream decoder. ... */RIFFReader root;long filepointer;String fourcc;String riff_type;long ckSize;InputStream stream;long avail;RIFFReader lastiterator;byte[] fourcc(...).rootthis.fourccbyte[] formatthis.riff_typeroot.filepointerint rlenlong s// Read ASCII chars from streamOutOfMemoryError oombuff.length// Read 8 bit signed integer from stream// Read 16 bit signed integer from streamint ch1int ch2// Read 32 bit signed integer from streamint ch3int ch4// Read 64 bit signed integer from streamlong ch1long ch2long ch3long ch4long ch5long ch6long ch7long ch8// Read 8 bit unsigned integer from stream// Read 16 bit unsigned integer from stream// Read 32 bit unsigned integer from stream/* Copyright (c) 2007, 2014, Oracle and/or its affiliates. All rights reserved. ... */// Check for RIFF null paddings,// don't put null value into fourcc,// because it is expected to// always contain a string value/** Resource Interchange File Format (RIFF) stream encoder. ... */this.raf...[] buff;...[] s;OutputStream stream;byte[] newbuffint chunktype;RandomAccessWriter raf;// 0=RIFF, 1=LIST; 2=CHUNKlong chunksizepointer;long startpointer;RIFFWriter childchunk;boolean writeoverride;new RandomAccessFileWriter(...)new RandomAccessByteWriter(...)getPointer(...)this.chunktypethis.writeoverrideint bakchunktypelong fpointer// Write ASCII chars to stream// Write 8 bit signed integer to stream// Write 16 bit signed integer to stream// Write 32 bit signed integer to stream// Write 64 bit signed integer to stream// Write 8 bit unsigned integer to stream// Write 16 bit unsigned integer to stream// Write 32 bit unsigned integer to stream/* TODO: ... *//** A Real Time Sequencer ... */MidiUtils.TempoCachenew RealTimeSequencerInfo(...)new SyncMode[]Sequencer.SyncMode.INTERNAL_CLOCKSequencer.SyncMode.NO_SYNCboolean DEBUG_PUMP;/** debugging flags */boolean DEBUG_PUMP_ALL;/** Event Dispatcher thread. Should be using a shared event ... */RealTimeSequencerInfo info;/** All RealTimeSequencers share this info object. */...[] masterSyncModes;...[] slaveSyncModes;Sequencer.SyncMode masterSyncMode;Sequencer.SyncMode slaveSyncMode;/** Sequence on which this sequencer is operating. */double cacheTempoMPQ;/** Same for setTempoInMPQ... ... */// cachesfloat cacheTempoFactor;/** cache value for tempo factor until sequence is set ... */...[] trackMuted;/** if a particular track is muted */...[] trackSolo;/** if a particular track is solo */MidiUtils.TempoCache tempoCache;/** tempo cache for getMicrosecondPosition *//** True if the sequence is running. */PlayThread playThread;/** the thread for pushing out the MIDI messages */boolean recording;/** True if we are recording */List<> recordingTracks;/** List of tracks to which we're recording */long loopStart;long loopEnd;ArrayList<> metaEventListeners;/** Meta event listeners */ArrayList<> controllerEventListeners;/** Control change listeners */boolean autoConnect;/** automatic connection support */boolean doAutoConnectAtNextOpen;/** if we need to autoconnect at next open */Receiver autoConnectedReceiver;/** the receiver that this device is auto-connected to *//* ****************************** CONSTRUCTOR ****************************** *//* ****************************** SEQUENCER METHODS ******************** */this.sequencesetCaches(...)getDataPump(...)setTickPos(...)resetLoopCount(...)setTickPosition(...)propagateCaches(...)Sequence seqstopRecording(...)findTrack(...)RecordingTrack rcrc.channelnew RecordingTrack(...)convertTempo(...)getTempoInMPQ(...)setTempoInMPQ(...)needCaching(...)getTickPosition(...)MidiUtils.DEFAULT_TEMPO_MPQsetTempoMPQ(...)setTempoFactor(...)getTempoFactor(...)getTickLength(...)getTickPos(...)getMicrosecondLength(...)tick2microsecond(...)microsecond2tick(...)SyncMode[] returnedModesmasterSyncModes.lengthslaveSyncModes.lengthgetTracks(...).lengthint trackCountgetTrackCount(...)ensureBoolArraySize(...)muteSoloChanged(...)trackMuted.lengthtrackSolo.lengthControllerListElement cvecve.listeneraddControllers(...)new ControllerListElement(...)getControllers(...)removeControllers(...)////////////////// LOOPING (added in 1.5) ////////////////////////* *********************************** play control ************************* */new PlayThread(...)doAutoConnect(...)Receiver recSynthesizer synthgetSynthesizer(...)getReceiverReferenceCounting(...)/** populate the caches with the current values *//** Send midi player events. ... *//** Send midi player events. */int controllerList<> sendToListenerscve.controllers.lengthcve.controllers/** return the data pump instance, owned by play thread ... */boolean[] newArray// for recordingnew SequencerReceiver(...)new SequencerTransmitter(...)// interface AutoConnectSequencerthis.autoConnectthis.autoConnectedReceiverlong tickPosShortMessage smgetChannel(...)MidiEvent menew MidiEvent(...)...[] controllers;//       ints into objects to use a Vector//       easier to deal with than turning all the// $$jb: using an array for controllers b/c itsControllerEventListener listener;this.controllerscontrollers.lengthint elementsint[] newcint[] c// class ControllerListElementTrack track;int channel;this.trackRecordingTrack currentcurrent.trackcurrent.channelnew DataPump(...)boolean interrupted;/** true if playback is interrupted (in close) */boolean isPumping;DataPump dataPump;/** start thread and pump. Requires up-to-date tempoCache */hasCachedTempo(...)dataPump.checkPointMillisclearNoteOnCache(...)dataPump.needReindex// waits until stoppedplayThreadImplStop(...)/** Main process loop driving the media flow. ... */boolean EOMboolean wasRunningpump(...)notesOff(...)MetaMessage messagenew MetaMessage(...)MidiUtils.META_END_OF_TRACK_TYPEsendMetaEvents(...)/** class that does the actual dispatching of events, ... */float currTempo;float tempoFactor;// MPQ tempofloat inverseTempoFactor;// 1.0 is defaultlong ignoreTempoEventAt;// = 1.0 / tempoFactorint resolution;// ignore next META tempo during playback at this tick pos onlyfloat divisionType;long checkPointMillis;long checkPointTick;// microseconds at checkoint...[] noteOnCache;// ticks at checkpoint...[] tracks;// bit-mask of notes that are currently on...[] trackDisabled;...[] trackReadPos;// if true, do not play this tracklong lastTick;// read index per trackboolean needReindex;int currLoopCounter;//private long perfFreq = perf.highResFrequency();//private sun.misc.Perf perf = sun.misc.Perf.getPerf();long oldLastTickchaseEvents(...)getTempoCache(...)// hasCachedTempo is only valid if it is the current position// this method is also used internally in the pump!this.currTempothis.tempoFactorboolean[] newDisabledmakeDisabledArray(...)applyDisabledTracks(...)int doneint channelMaskShortMessage.NOTE_ONShortMessage.CONTROL_CHANGEboolean[] newTrackDisabledboolean[] soloboolean[] muteboolean hasSoloRealTimeSequencer.thissolo.lengthnewTrackDisabled.lengthmute.length/** chase all events from beginning of Track ... */MidiEvent eventint noteShortMessage smsgint bitArrayIndexOutOfBoundsException aioobe/** Runtime application of mute/solo: ... */byte[][] tempArraynewDisabled.lengtholdDisabled.lengthsendNoteOffIfOn(...)chaseTrackEvents(...)/** go through all events from startTick to endTick ... */byte[] progsint numControllersSentint cotrackReadPos.lengthShortMessage.PROGRAM_CHANGEbyte controllerValueShortMessage.PITCH_BEND/** chase controllers and program for all tracks */trackDisabled.length// playback related methods (pumping)double dMillistick2index(...)/* returns if changes are pending */boolean changesPendingMidiMessage messageint msgStatusint msgLenint newTempoShortMessage.NOTE_OFFint velsendControllerEvents(...)/** the main pump method ... */long currMillislong targetTickMidiEvent currEventboolean doLoopint finishedTracksgetCurrentTimeMillis(...)ReindexTrack(...)millis2tick(...)boolean disabledTrack thisTrackint readPosisMetaEndOfTrack(...)dispatchMessage(...)long oldCheckPointMillislong loopEndTicktick2millis(...)// initialize some non-cached values// store this sequence (do not copy - we want to give the possibility// of modifying the sequence at runtime)// rewind to the beginning// propagate caches// can throw IOException, InvalidMidiDataException// sequencer not open: throw an exception// sequence not available: throw an exception// already running: return quietly// start playback// not running; just return// stop playback// should throw IllegalArgumentException// if the sequencer is closed, return cached value// if sequence is set, return current tempo// last resort: return a standard tempo: 120bpm// cache the value// set the native tempo in MPQ// reset the tempoInBPM and tempoInMPQ values so we won't use them again// don't need cache anymore// throw new InvalidStateException("cannot set position in closed state");// throw new InvalidStateException("cannot set position if sequence is not set");// not supported// $$fb wish there was a nicer way to get the number of tracks...// first find the listener.  if we have one, add the controllers// if not, create a new element for it.// and return all the controllers this listener is interested in//openInternalSynth();// create PlayThread//id = nOpen();//if (id == 0) {//    throw new MidiUnavailableException("unable to open sequencer");// first try to connect to the default synthesizer// IMPORTANT: this code needs to be synch'ed with//            MidiSystem.getSequencer(boolean), because the same//            algorithm needs to be used!// make sure that the synth is properly closed// something went wrong with synth// then try to connect to the default Receiver// something went wrong. Nothing to do then!// only set caches if open and sequence is set// Interrupt playback loop./** if this sequencer is set to autoconnect, need to ... *///if (Printer.debug) Printer.debug("sending a meta event");//if (Printer.debug) Printer.debug("sending a controller event");// convert timeStamp to ticks// and record to the first matching Track// do not record real-time events// see 5048381: NullPointerException when saving a MIDI sequence// all real-time messages have 0xF in the high nibble of the status byte// $$jb: where to record meta, sysex events?// $$fb: the first recording track// create a copy of this message// create new MidiEvent// first add what we have// now add the new controllers only if we don't already have them// now keep only the elements we need// now keep only the elements remaining// return a copy of our array of controllers,// so others can't mess with it// nearly MAX_PRIORITY// mark the sequencer running// means restarted// notify the thread// don't wait for more than 2 seconds//break;// send EOT event (mis-used for end of media)// wake up a waiting stop() method// end of while(!EOM && !interrupted && running)// will also reindex// treat this as if it is a real time tempo change// trigger re-configuration// re-calculate check point// trigger re-initialization// send note on with velocity 0/* all notes off *//* sustain off *//* reset all controllers */// if one track is solo, then only play solo// only the channels with solo play, regardless of mute// mute the selected channels// only consider Note On with velocity > 0// the bit is set. Send Note Off// clear the bit// this happens when messages are removed// from the track while this method executes// case that a track gets muted: need to// send appropriate note off events to prevent// hanging notes// case that a track was muted and is now unmuted// need to chase events and re-index this track// start from the beginning// init temp array with impossible values// now send out the aggregated controllers and program changes// send program change *after* controllers, to// correctly initialize banks// reset pitch bend on this channel (E0 00 40)// reset sustain pedal on this channel// if track is not disabled, chase the events for it//return perf.highResCounter() * 1000 / perfFreq;// a meta message. Do not send it to the device.// 0xFF with length=1 is a MIDI realtime message// which shouldn't be in a Sequence, but we play it// nonetheless.// see if this is a tempo message. Only on track 0.// sets ignoreTempoEventAt!// next loop, do not ignore anymore tempo events.// send to listeners// not meta, send to device// note off - clear the bit in the noteOnCache array// note on// if velocity > 0 set the bit in the noteOnCache array// if velocity = 0 clear the bit in the noteOnCache array// if controller message, send controller listeners// need to re-find indexes in tracks?// get target tick from current time in millis// new check point// calculate current tick based on current time in milliseconds// need to loop!// only play until loop end// play all events that are due until targetTick// do not send out this message. Finished with this track// TODO: some kind of heuristics if the MIDI messages have changed// significantly (i.e. deleted or inserted a bunch of messages)// since last time. Would need to set needReindex = true then// only play this event if the track is enabled,// or if it is a tempo message on track 0// Note: cannot put this check outside//       this inner loop in order to detect end of file// need to loop back!// now patch the checkPointMillis so that// it points to the exact beginning of when the loop was finished// $$fb TODO: although this is mathematically correct (i.e. the loop position//            is correct, and doesn't drift away with several repetition,//            there is a slight lag when looping back, probably caused//            by the chasing.// no need for reindexing, is done in setTickPos// reset doLoop flag// class DataPump/** Provider for RealTimeSequencer objects. ... */RealTimeSequencer.infonew RealTimeSequencer(...)MidiUnavailableException e/** MidiDevice that can use reference counting for open/close. ... *//** Retrieve a Receiver that opens the device implicitly. ... *//** Retrieve a Transmitter that opens the device implicitly. ... *//** Soundfont global region. ... *//** Soundfont instrument. ... */new ArrayList<SF2InstrumentRegion>(...)long library;long genre;long morphology;SF2GlobalRegion globalregion;List<SF2InstrumentRegion> regions;this.genrethis.librarythis.morphologyint performercountModelPerformer[] performersint piSF2GlobalRegion presetglobalSF2InstrumentRegion presetzoneMap<Integer,Short> pgeneratorsnew HashMap<Integer,Short>(...)SF2GlobalRegion layerglobalgetGlobalRegion(...)getGenerators(...)SF2LayerRegion layerzoneint keyfromint keytoint velfromint veltoint startAddrsOffsetSF2Region.GENERATOR_STARTADDRSOFFSETint endAddrsOffsetSF2Region.GENERATOR_ENDADDRSOFFSETint startloopAddrsOffsetSF2Region.GENERATOR_STARTLOOPADDRSOFFSETint endloopAddrsOffsetSF2Region.GENERATOR_ENDLOOPADDRSOFFSETint rootkeysample.originalPitchsample.pitchCorrectionModelByteBuffer buff24getData24Buffer(...)Map<Integer,Short> generatorsint sampleModegetGeneratorValue(...)short volDelaySF2Region.GENERATOR_DELAYVOLENVshort volAttackshort volHoldSF2Region.GENERATOR_HOLDVOLENVshort volDecayshort volSustainshort volReleaseshort vib_freqshort vib_delaySF2Region.GENERATOR_DELAYVIBLFOint tuneSF2Region.GENERATOR_KEYRANGESF2Region.GENERATOR_VELRANGESF2Region.GENERATOR_STARTADDRSCOARSEOFFSETSF2Region.GENERATOR_ENDADDRSCOARSEOFFSETSF2Region.GENERATOR_STARTLOOPADDRSCOARSEOFFSETSF2Region.GENERATOR_ENDLOOPADDRSCOARSEOFFSETSF2Region.GENERATOR_OVERRIDINGROOTKEYset8BitExtensionBuffer(...)Entry<Integer,Short> genMap<>.Entry<Integer,Short>short valsample.startLoopsample.endLoopshort volKeyNumToHoldSF2Region.GENERATOR_KEYNUMTOVOLENVHOLDfloat fvalueModelIdentifier srcModelIdentifier destshort volKeyNumToDecaySF2Region.GENERATOR_KEYNUMTOVOLENVDECAYaddTimecentValue(...)SF2Region.GENERATOR_MODENVTOPITCHshort modDelaySF2Region.GENERATOR_DELAYMODENVshort modAttackshort modHoldSF2Region.GENERATOR_HOLDMODENVshort modDecaySF2Region.GENERATOR_DECAYMODENVshort modSustainSF2Region.GENERATOR_SUSTAINMODENVshort modReleaseshort modKeyNumToHoldSF2Region.GENERATOR_KEYNUMTOMODENVHOLDshort modKeyNumToDecaySF2Region.GENERATOR_KEYNUMTOMODENVDECAYdouble fvalueSF2Region.GENERATOR_MODLFOTOFILTERFCSF2Region.GENERATOR_MODLFOTOPITCHSF2Region.GENERATOR_MODLFOTOVOLUMEshort lfo_freqSF2Region.GENERATOR_FREQMODLFOshort lfo_delaySF2Region.GENERATOR_DELAYMODLFOModelStandardTransform.DIRECTION_MIN2MAXSF2Region.GENERATOR_KEYNUMdouble valSF2Region.GENERATOR_VELOCITYModelDestination.DESTINATION_VELOCITYshort filter_freqshort filter_qSF2Region.GENERATOR_PANSF2Region.GENERATOR_CHORUSEFFECTSSENDSF2Region.GENERATOR_REVERBEFFECTSSENDshort fvalueModelStandardTransform.POLARITY_UNIPOLARSF2Modulator modulatorconvertModulator(...)ModelSource src1convertSource(...)getSourceOperator(...)ModelSource src2getAmountSourceOperator(...)double amountgetAmount(...)double[] amountcorrectionModelSource[] extrasrcModelDestination dstconvertDestination(...)getDestinationOperator(...)ModelConnectionBlock conngetTransportOperator(...)SF2Modulator.TRANSFORM_ABSOLUTEModelStandardTransform.TRANSFORM_ABSOLUTEModelIdentifier idint idsrcModelSource msrcModelStandardTransform transformSF2Modulator.SOURCE_MIDI_CONTROLSF2Modulator.SOURCE_NOTE_ON_VELOCITYSF2Modulator.SOURCE_NOTE_ON_KEYNUMBERSF2Modulator.SOURCE_POLY_PRESSURESF2Modulator.SOURCE_CHANNEL_PRESSURESF2Modulator.SOURCE_PITCH_WHEELSF2Modulator.SOURCE_PITCH_SENSITIVITYSF2Modulator.SOURCE_DIRECTION_MAX_MINSF2Modulator.SOURCE_POLARITY_BIPOLARSF2Modulator.SOURCE_TYPE_CONCAVESF2Modulator.SOURCE_TYPE_CONVEXSF2Modulator.SOURCE_TYPE_SWITCH/* if (startAddrsOffset < 0) ... */// SampleMode:// 0 indicates a sound reproduced with no loop// 1 indicates a sound which loops continuously// 2 is unused but should be interpreted as indicating no loop// 3 indicates a sound which loops for the duration of key//   depression then proceeds to play the remainder of the sample.//float fvolsustain = (960-volSustain)*(1000.0f/960.0f);/** Soundfont instrument region. ... */SF2Layer layer;this.layer/** Soundfont layer. ... */new ArrayList<SF2LayerRegion>(...)List<SF2LayerRegion> regions;/** Soundfont layer region. ... */SF2Sample sample;/** Soundfont modulator container. ... */int SOURCE_NONE;int SOURCE_NOTE_ON_VELOCITY;int SOURCE_NOTE_ON_KEYNUMBER;int SOURCE_POLY_PRESSURE;int SOURCE_CHANNEL_PRESSURE;int SOURCE_PITCH_WHEEL;int SOURCE_PITCH_SENSITIVITY;int SOURCE_MIDI_CONTROL;int SOURCE_DIRECTION_MIN_MAX;int SOURCE_DIRECTION_MAX_MIN;int SOURCE_POLARITY_UNIPOLAR;int SOURCE_POLARITY_BIPOLAR;int SOURCE_TYPE_LINEAR;int SOURCE_TYPE_CONCAVE;int SOURCE_TYPE_CONVEX;int SOURCE_TYPE_SWITCH;int sourceOperator;int destinationOperator;short amount;int amountSourceOperator;int transportOperator;this.amountthis.amountSourceOperatorthis.transportOperatorthis.destinationOperatorthis.sourceOperator/** Soundfont general region. ... */new ArrayList<SF2Modulator>(...)int GENERATOR_STARTADDRSOFFSET;int GENERATOR_ENDADDRSOFFSET;int GENERATOR_STARTLOOPADDRSOFFSET;int GENERATOR_ENDLOOPADDRSOFFSET;int GENERATOR_STARTADDRSCOARSEOFFSET;int GENERATOR_MODLFOTOPITCH;int GENERATOR_VIBLFOTOPITCH;int GENERATOR_MODENVTOPITCH;int GENERATOR_INITIALFILTERFC;int GENERATOR_INITIALFILTERQ;int GENERATOR_MODLFOTOFILTERFC;int GENERATOR_MODENVTOFILTERFC;int GENERATOR_ENDADDRSCOARSEOFFSET;int GENERATOR_MODLFOTOVOLUME;int GENERATOR_UNUSED1;int GENERATOR_CHORUSEFFECTSSEND;int GENERATOR_REVERBEFFECTSSEND;int GENERATOR_PAN;int GENERATOR_UNUSED2;int GENERATOR_UNUSED3;int GENERATOR_UNUSED4;int GENERATOR_DELAYMODLFO;int GENERATOR_FREQMODLFO;int GENERATOR_DELAYVIBLFO;int GENERATOR_FREQVIBLFO;int GENERATOR_DELAYMODENV;int GENERATOR_ATTACKMODENV;int GENERATOR_HOLDMODENV;int GENERATOR_DECAYMODENV;int GENERATOR_SUSTAINMODENV;int GENERATOR_RELEASEMODENV;int GENERATOR_KEYNUMTOMODENVHOLD;int GENERATOR_KEYNUMTOMODENVDECAY;int GENERATOR_DELAYVOLENV;int GENERATOR_ATTACKVOLENV;int GENERATOR_HOLDVOLENV;int GENERATOR_DECAYVOLENV;int GENERATOR_SUSTAINVOLENV;int GENERATOR_RELEASEVOLENV;int GENERATOR_KEYNUMTOVOLENVHOLD;int GENERATOR_KEYNUMTOVOLENVDECAY;int GENERATOR_INSTRUMENT;int GENERATOR_RESERVED1;int GENERATOR_KEYRANGE;int GENERATOR_VELRANGE;int GENERATOR_STARTLOOPADDRSCOARSEOFFSET;int GENERATOR_KEYNUM;int GENERATOR_VELOCITY;int GENERATOR_INITIALATTENUATION;int GENERATOR_RESERVED2;int GENERATOR_ENDLOOPADDRSCOARSEOFFSET;int GENERATOR_COARSETUNE;int GENERATOR_FINETUNE;int GENERATOR_SAMPLEID;int GENERATOR_SAMPLEMODES;int GENERATOR_RESERVED3;int GENERATOR_SCALETUNING;int GENERATOR_EXCLUSIVECLASS;int GENERATOR_OVERRIDINGROOTKEY;int GENERATOR_UNUSED5;int GENERATOR_ENDOPR;Map<Integer,Short> generators;List<SF2Modulator> modulators;/** Soundfont sample storage. ... */long startLoop;long endLoop;long sampleRate;int originalPitch;byte pitchCorrection;int sampleLink;int sampleType;ModelByteBuffer data24;this.data24/* public void setData(File file, int offset, int length) { ... */this.endLoopthis.originalPitchthis.pitchCorrectionthis.sampleLinkthis.sampleRatethis.sampleTypethis.startLoop/* if (sampleFile != null) { ... *//** A SoundFont 2.04 soundbank reader. ... */new ArrayList<SF2Instrument>(...)new ArrayList<SF2Layer>(...)new ArrayList<SF2Sample>(...)int major;// version of the Sound Font RIFF fileint minor;String targetEngine;// target Sound Engine// Sound Font Bank NameString romName;// Sound ROM Nameint romVersionMajor;// Sound ROM Versionint romVersionMinor;// Date of Creation of the Bank// Sound Designers and Engineers for the Bank// Product for which the Bank was intended// Copyright message// Comments// The SoundFont tools used to create and alter the bankModelByteBuffer sampleData;// The Sample Data loaded from the SoundFontModelByteBuffer sampleData24;List<SF2Instrument> instruments;List<SF2Layer> layers;List<SF2Sample> samples;readSdtaChunk(...)readPdtaChunk(...)this.targetEnginethis.romNamethis.creationDatethis.engineersthis.productthis.copyrightthis.commentsthis.toolsbyte[] sampleDatathis.sampleDatabyte[] sampleData24this.sampleData24List<SF2Instrument> presetsList<Integer> presets_bagNdxList<SF2InstrumentRegion> presets_splits_genList<SF2InstrumentRegion> presets_splits_modList<SF2Layer> instrumentsList<Integer> instruments_bagNdxList<SF2LayerRegion> instruments_splits_genList<SF2LayerRegion> instruments_splits_modIterator<SF2Layer> literthis.layersIterator<SF2Instrument> iiterthis.instrumentsSF2Instrument presetpreset.namepreset.presetpreset.bankpreset.librarypreset.genrepreset.morphologyint gencountint modcountint zone_countSF2InstrumentRegion splitpreset.regionsnew SF2Modulator(...)modulator.sourceOperatormodulator.destinationOperatormodulator.amountmodulator.amountSourceOperatormodulator.transportOperatorsplit.modulatorsint operatorshort amountsplit.generatorslayer.nameSF2LayerRegion splitlayer.regionssample.namesample.datasample.data24sample.sampleRatesample.sampleLinksample.sampleTypethis.samplesIterator<SF2LayerRegion> siterSF2Region globalsplitSF2LayerRegion.GENERATOR_SAMPLEIDint sampleidsplit.sampleSF2GlobalRegion gsplitgsplit.generatorsglobalsplit.generatorsgsplit.modulatorsglobalsplit.modulatorsIterator<SF2InstrumentRegion> siterSF2LayerRegion.GENERATOR_INSTRUMENTint instrumentidSF2InstrumentRegion.GENERATOR_INSTRUMENTsplit.layerwriteSdtaChunk(...)writePdtaChunk(...)RIFFWriter ifil_chunkRIFFWriter iver_chunkthis.romVersionMajorthis.romVersionMinorbyte[] padRIFFWriter smpl_chunkRIFFWriter sm24_chunkModelByteBuffer dataModelByteBuffer data24Short keyrangeShort velrangeEntry<Integer,Short> generatorRIFFWriter phdr_chunkint phdr_zone_countRIFFWriter pbag_chunkint pbag_gencountint pbag_modcountRIFFWriter pmod_chunkRIFFWriter pgen_chunkRIFFWriter inst_chunkint inst_zone_countRIFFWriter ibag_chunkint ibag_gencountint ibag_modcountRIFFWriter imod_chunkRIFFWriter igen_chunkRIFFWriter shdr_chunklong sample_posregion.layerwriteModulators(...)writeGenerators(...)SF2Region.GENERATOR_INSTRUMENTSF2Layer instrumentinstrument.nameSF2Region.GENERATOR_SAMPLEIDlong startLooplong endLoopwriteUnsignedByte(...)SF2Instrument[] inslist_arraynew SF2Instrument[]new SF2Sample[]//chunk.read(sampleData);//chunk.read(sampleData24);// Preset Header / Instrument// Preset Zones / Instruments splits// Skip first record// Offset should be 0 (but just case)// Preset Modulators / Split Modulators// Preset Generators / Split Generators// Instrument Header / Layers// Instrument Zones / Layer splits// Instrument Modulators / Split Modulators// Instrument Generators / Split Generators// Sample Headers/* sample.data = new ModelByteBuffer(sampleData, (int)(start*2), ... *//* smpl_chunk.write(data.array(), ... *//* sm24_chunk.write(data.array(), ... */// One generator is used to reference to instrument record/** This class is used to connect the SF2SoundBank class ... *//** A simple instrument that is made of other ModelInstrument, ModelPerformer ... */new ArrayList<SimpleInstrumentPart>(...)List<SimpleInstrumentPart> parts;SimpleInstrumentPart partnew SimpleInstrumentPart(...)part.performerspart.keyFrompart.keyTopart.velFrompart.velTopart.exclusiveClassint percountpart.performers.lengthModelPerformer mperfmsetDefaultConnectionsEnabled(...)isDefaultConnectionsEnabled(...)isSelfNonExclusive(...)setReleaseTriggered(...)/** A simple soundbank that contains instruments and soundbankresources. ... */new ArrayList<SoundbankResource>(...)new ArrayList<Instrument>(...)List<SoundbankResource> resources;List<Instrument> instruments;this.descriptionthis.vendorInstrument[] inslist_arrayremoveInstrument(...)/** Abstract resampler class. ... */boolean stream_eof;int loopmode;boolean loopdirection;float loopstart;// true = forwardfloat looplen;float target_pitch;...[] current_pitch;boolean eof;int sector_pos;int sector_size;int sector_loopstart;boolean markset;int marklimit;int streampos;boolean noteOff_flag;boolean ibuffer_order;...[] sbuffer;float samplerateconv;getPitchcorrection(...)getLoopLength(...)getLoopStart(...)getLoopType(...)nextBuffer(...)this.target_pitchint skipsfloat[] cbufferint slenint sretsbuffer.lengthint ix_stepfloat[] cbuffcbuff.lengthfloat pitchstepfloat[] current_pitchthis.current_pitchint[] oxthis.oxint ox_endfloat ixendfloat bak_ixint bak_oxfloat bak_pitchreverseBuffers(...)new ModelAbstractResamplerStream(...)// loopmode = 0;/* this.pitch = (float) Math.pow(2f, ... */// reset to target sector// and go one sector backward// If we are in backward playing part of pingpong// or reverse loop// Ping pong loop, change loopdirection// Ping pong or revese loop, change loopdirection/** This class is used to store audio buffer. ... */boolean empty;...[] converter_buffer;int bak_sizefloat[] bak_bufferboolean bak_emptyAudioFormat bak_formatAudioFloatConverter bak_converterbyte[] bak_converter_bufferswap.sizeswap.bufferswap.emptyswap.formatswap.converterswap.converter_bufferint framesize_pcint c_lenconverter_buffer.lengthint z_stepoverint k_stepoverint z/** Audio processor interface. ... *//** This is a processor object that writes into SourceDataLine ... */SourceDataLine sourceDataLine;Thread audiothread;this.sourceDataLineSoftAudioPusher.this.bufferSoftAudioPusher.thisSoftAudioPusher.this.aisSourceDataLine sourceDataLineSoftAudioPusher.this.sourceDataLine// Read from audio source// Write byte buffer to source output/** Software Synthesizer MIDI channel class. ... */new SoftTuning(...)new SoftControl[]...[] cc;new HashMap<Integer,int[]>(...)new HashMap<Integer,double[]>(...)Map<Integer,double[]> rpn;int inamedouble[] vMap<Integer,double[]> nrpn;co_midi.lengthnew MidiControlObject(...)dontResetControls.length...[] dontResetControls;int RPN_NULL_VALUE;int rpn_control;int nrpn_control;double portamento_time;...[] portamento_lastnote;// keyschanges per control buffer timeint portamento_lastnote_ix;boolean portamento;boolean mono;boolean mute;boolean solo;boolean solomute;Object control_mutex;...[] voices;int program;SoftSynthesizer synthesizer;SoftMainMixer mainmixer;...[] polypressure;int channelpressure;...[] controller;int pitchbend;...[] co_midi_pitch;...[] co_midi_channel_pressure;SoftTuning tuning;int tuning_bank;int tuning_program;SoftInstrument current_instrument;ModelChannelMixer current_mixer;ModelDirector current_director;int cds_control_number;// Controller Destination Settings...[] cds_control_connections;...[] cds_channelpressure_connections;...[] cds_polypressure_connections;boolean sustain;...[] keybasedcontroller_active;...[] keybasedcontroller_value;...[] channel_pressure;...[] poly_pressure;...[] co_midi;...[] co_midi_cc_cc;SoftControl co_midi_cc;Map<Integer,int[]> co_midi_rpn_rpn_i;Map<Integer,double[]> co_midi_rpn_rpn;SoftControl co_midi_rpn;Map<Integer,int[]> co_midi_nrpn_nrpn_i;Map<Integer,double[]> co_midi_nrpn_nrpn;SoftControl co_midi_nrpn;this.voicesgetVoices(...)this.synthesizerthis.mainmixergetMainMixer(...)synth.control_mutexresetAllControllers(...)int vmodegetVoiceAllocationMode(...)voices.length...[...].activeint steal_channelint voiceNoSoftVoice v...[...].stealer_channel...[...].channel...[...].on...[...].voiceIDv.voiceIDvoice.activevoice.stealer_channelvoice.stealer_performervoice.stealer_voiceIDvoice.stealer_noteNumbervoice.stealer_velocityvoice.stealer_extendedConnectionBlocksvoice.stealer_channelmixervoice.stealer_releaseTriggeredvoice.voiceIDsoundOff(...)voice.extendedConnectionBlocksvoice.channelmixervoice.releaseTriggeredvoice.tuningvoice.exclusiveClassp.exclusiveClassvoice.softchannelvoice.channelvoice.bankvoice.programvoice.instrumentvoice.performervoice.objectsnoteOn(...)setMute(...)setSoloMute(...)voice.co_noteon_keynumbergetTuning(...)voice.portamento/* A special noteOn with delay parameter, which is used to ... */restrict7Bit(...)noteOn_internal(...)noteOff_internal(...)int tunedKey...[...].sustain...[...].notenoteOff(...)activity(...)boolean n_found...[...].releaseTriggered...[...].portamentosetNote(...)allNotesOff(...)findInstrument(...)stopMixer(...)getSourceInstrument(...)registerMixer(...)applyInstrumentCustomization(...)synthesizer.voiceIDCounter...[...].stealer_noteNumberv.stealer_releaseTriggeredv.stealer_channelv.stealer_performerv.stealer_voiceIDv.stealer_noteNumberv.stealer_velocityv.stealer_extendedConnectionBlocksv.stealer_channelmixer...[] lastVelocity;int prevVoiceID;boolean firstVoice;int voiceNo;int play_noteNumber;int play_velocity;int play_delay;boolean play_releasetriggered;int noteNumberint velocityint delayboolean releasetriggeredSoftPerformer p...[...].exclusiveClassp.selfNonExclusiveshutdown(...)findFreeVoice(...)initVoice(...)setPolyPressure(...)setChannelPressure(...)ModelInstrument src_instrumentModelPerformer[] new_performersnew_performers.lengthModelPerformer new_performerList<ModelConnectionBlock> connblocksString ccIterator<ModelConnectionBlock> iterModelSource[] sourcesgetSources(...)boolean removeokgetIdentifier(...)cds_control_connections.lengthcds_polypressure_connections.lengthModelIdentifier srcidcds_channelpressure_connections.lengthnew SoftInstrument(...)List<ModelConnectionBlock> connsdestination.lengthModelTransform mtdouble s;new ModelConnectionBlock[]createModelConnections(...)new boolean[][]rpnChange(...)asin(...)boolean ongetControlRate(...)int[] val_iint stepnrpnChange(...)redamp(...)...[...].sostenutoallSoundOff(...)localControl(...)setOmni(...)setMono(...)this.controllertuningChange(...)programChange(...)restrict14Bit(...)this.bankthis.programsetPitchBend(...)double[] val_dgetGeneralMidiMode(...)controlChangePerNote(...)this.mutesetSolo(...)boolean soloinusethis.soloSoftChannel csynthesizer.channelsc.solothis.solomute// Bank Select (MSB)// Bank Select (LSB)// Channel Volume (MSB)// Balance (MSB)// Pan (MSB)// Expression (MSB)// Effects 1 Depth (default: Reverb Send)// Effects 2 Depth (default: Tremolo Depth)// Effects 3 Depth (default: Chorus Send)// Effects 4 Depth (default: Celeste [Detune] Depth)// Effects 5 Depth (default: Phaser Depth)// Sound Controller 1 (default: Sound Variation)// Sound Controller 2 (default: Timbre / Harmonic Quality)// Sound Controller 3 (default: Release Time)// Sound Controller 4 (default: Attack Time)// Sound Controller 5 (default: Brightness)// Sound Controller 6 (GM2 default: Decay Time)// Sound Controller 7 (GM2 default: Vibrato Rate)// Sound Controller 8 (GM2 default: Vibrato Depth)// Sound Controller 9 (GM2 default: Vibrato Delay)// Sound Controller 10 (GM2 default: Undefined)// All Sound Off// Reset All Controllers// Local Control On/Off// All Notes Off// Omni Mode Off// Omni Mode On// Poly Mode Off// Poly Mode On// Data Entry (MSB)// Data Entry (LSB)// Data Increment// Data Decrement// Non-Registered Parameter Number (LSB)// Non-Registered Parameter Number(MSB)// RPN = Null// x = -1 means that there where no available voice// last time we called findFreeVoice// and it hasn't changed because no audio has been// rendered in the meantime.// Therefore we have to return -1.// No free voice was found, we must steal one// DLS Static Voice Allocation//  * priority ( 10, 1-9, 11-16)// Search for channel to steal from// Search for oldest voice in off state on steal_channel// Search for oldest voice in on state on steal_channel// Default Voice Allocation//  * Find voice that is on//    and Find voice which has lowest voiceID ( oldest voice)//  * Or find voice that is off// Search for oldest voice in off state// Search for oldest voice in on state// Voice is active , we must steal the voice/* SoftPerformer[] performers = current_instrument.getPerformers(); ... */// We must also check stolen voices// Try play back note-off triggered voices,/* controlled parameter (pp)|range (rr)| Description             |Default ... *//* CC# | nn   | Name                    | vv             | default    | description ... *//* Map<String, int[]>co_midi_rpn_rpn_i = new HashMap<String, int[]>(); ... */// This produce asin-like curve// as described in General Midi Level 2 Specification, page 6// x is now cent/msec// Convert x from cent/msec to key/controlbuffertime// x is now keys/msec// x is now keys/sec// x is now keys/controlbuffertime// Hold1 (Damper) (cc#64)//allNotesOff();/* for (int i = 0; i < portamento_lastnote.length; i++) ... */// Sostenuto (cc#66)/* (bank & 127) + */// Should only return lower 7 bits,// even when controller is "boosted" higher./* System.out.println("(" + channel + ").nrpnChange(" ... */// Vibrato Rate// Vibrato Depth// Vibrato Delay// Brightness// Filter Resonance// Attack Time// Decay Time// Release Time// Pitch coarse// Volume// Panpot// Reverb// Chorus/* System.out.println("(" + channel + ").rpnChange(" ... */// Balance// Expression// NRPN Null// see DLS 2.1 (Power-on Default Values)// Pan// don't reset tuning settings// Bitch Bend sensitivity// Channel fine tunning// Channel Coarse Tuning// Modulation Depth, +/- 50 cent// Omni is not supported by GM2/** A MidiChannel proxy object used for external access to synthesizer internal ... */getChannelPressure(...)getController(...)getMono(...)getMute(...)getOmni(...)getPitchBend(...)getPolyPressure(...)getSolo(...)/** A chorus effect made using LFO and variable delay. One for each channel ... */...[] delaybuffer;int rovepos;float gain;float rgain;float delay;float lastdelay;float feedback;this.delaythis.feedbackthis.gainthis.rgainfloat delayfloat feedbackfloat[] delaybufferthis.delaybufferfloat delaydeltaint rnlendelaybuffer.lengthint roveposthis.roveposint rifloat oprocessMix(...)double phase;double phase_step;double depth;VariableDelay vdelay;double samplerate;double controlrate;this.controlratenew VariableDelay(...)setFeedBack(...)setGain(...)setReverbSendGain(...)setDelay(...)processReplace(...)boolean mix;SoftAudioBuffer inputA;SoftAudioBuffer left;SoftAudioBuffer right;SoftAudioBuffer reverb;LFODelay vdelay1L;LFODelay vdelay1R;boolean dirty;double dirty_vdelay1L_rate;double dirty_vdelay1R_rate;double dirty_vdelay1L_depth;double dirty_vdelay1R_depth;float dirty_vdelay1L_feedback;float dirty_vdelay1R_feedback;float dirty_vdelay1L_reverbsendgain;float dirty_vdelay1R_reverbsendgain;float controlrate;new LFODelay(...)globalParameterControlChange(...)slothpath.lengthsetRate(...)setDepth(...)double silentcounter;float[] inputAthis.inputAfloat[] leftfloat[] rightfloat[] reverbthis.reverbisSilent(...)this.mix// vdelay = new VariableDelay((int)(samplerate*4));// %// Chorus Type// Chorus 1 0 (0%) 3 (0.4Hz) 5 (1.9ms) 0 (0%)// Chorus 2 5 (4%) 9 (1.1Hz) 19 (6.3ms) 0 (0%)// Chorus 3 8 (6%) 3 (0.4Hz) 19 (6.3ms) 0 (0%)// Chorus 4 16 (12%) 9 (1.1Hz) 16 (5.3ms) 0 (0%)// FB Chorus 64 (49%) 2 (0.2Hz) 24 (7.8ms) 0 (0%)// Flanger 112 (86%) 1 (0.1Hz) 5 (1.9ms) 0 (0%)// Mod Rate// Mod Depth// Feedback// Send to Reverb/** <code>SoftControl</code> are the basic controls ... *//** A resampler that uses third-order (cubic) interpolation. ... */float pitchfloat ixfloat ix_endint iixfloat fixfloat y0float y1float y2float y3float a0float a1float a2float a3//float fix2 = fix * fix;//out[ox++] = (a0 * fix + a1) * fix2 + (a2 * fix + a3);/** AHDSR control signal envelope generator. ... */int EG_OFF;int EG_DELAY;int EG_ATTACK;int EG_HOLD;int EG_DECAY;int EG_SUSTAIN;int EG_RELEASE;int EG_SHUTDOWN;int EG_END;int max_count;int used_count;...[] stage;...[] stage_ix;...[] stage_v;...[] stage_count;...[] on;...[] active;...[] out;...[] delay;...[] attack;...[] hold;...[] decay;...[] sustain;...[] release;...[] shutdown;...[] release2;...[] attack2;...[] decay2;double control_time;processControlLogic(...)this.shutdowndouble misInfinite(...)this.releasethis.release2double sustainthis.sustaindouble attackthis.attackdouble attack2this.attack2this.holdthis.decaythis.decay2// stage_v[i] = out[i][0];// CONVEX attack// *stage_v[i];// re-damping/** Infinite impulse response (IIR) filter class. ... */int FILTERTYPE_LP6;int FILTERTYPE_LP12;int FILTERTYPE_HP12;int FILTERTYPE_BP12;int FILTERTYPE_NP12;int FILTERTYPE_LP24;int FILTERTYPE_HP24;int filtertype;// 0x30 = NP, Notch or Band Elimination Filter// 0x20 = BP, Band Pass Filter// 0x10 = HP, High Pass Filter// 0x00 = LP, Low Pass Filter// 0x3 = 4th-order, 24 db/oct// 0x2 = 3rd-order, 18 dB/oct// 0x1 = 2nd-order, 12 dB/oct// 0x0 = 1st-order, 6 dB/octfloat x1;float x2;float y1;float y2;float xx1;float xx2;float yy1;float yy2;float a0;float a1;float a2;float b1;float b2;float q;float wet;float last_wet;float last_a0;float last_a1;float last_a2;float last_b1;float last_b2;float last_q;float last_gain;boolean last_set;double cutoff;double resonancedB;this.filtertypefilter1(...)filter2(...)filter4(...)float[] bufferfilter2calc(...)this.last_a0this.last_a1this.last_a2float b1this.last_b1float b2this.last_b2this.last_gainfloat wetthis.last_wetfloat a0_deltathis.a0float a1_deltathis.a1float a2_deltathis.a2float b1_deltathis.b1float b2_deltathis.b2float gain_deltafloat wet_deltathis.wetfloat x1float x2this.y1this.y2float xx1this.xx1float xx2this.xx2float yy1this.yy1float yy2this.yy2float xxfloat yydouble resonancedBthis.resonancedBdouble bandwidthdouble omegadouble csdouble sndouble alphasinh(...)double b0double b1double b2double a0double a1double a2double cfdouble cdouble csqdouble resonancedouble qthis.last_qthis.qfilter1calc(...)float qfloat q_deltafloat ga0// Negative dB are illegal.// At least 22.5 dB is needed./** Software synthesizer internal instrument. ... */...[] modelperformers;initPerformers(...)this.modelperformersnew SoftPerformer[]modelperformers.lengthnew SoftPerformer(...)/* am: currently getPerformers() is not used (replaced with getPerformer(int)) ... *//** A jitter corrector to be used with SoftAudioPusher. ... */int MAX_BUFFER_SIZE;int writepos;// Cyclic bufferint readpos;...[] buffers;Object buffers_mutex;int w_count;// Adapative Drift Statisticsint w_min_tol;int w_max_tol;int w_min;int bbuffer_pos;// Current read bufferint bbuffer_max;...[] bbuffer;int w_mint buffposbuffers.lengthRunnable runnableint bufflenint frameslong nanoslong nextint correctionint curbuffsizelong waitJitterStream.thisnextWriteBuffer(...)IOException e1commit(...)this.w_countthis.buffersthis.bbuffer_maxnextReadBuffer(...)int bbuffer_lenbbuffer.lengthfillBuffer(...)byte[] bbufferthis.bbufferint bbuffer_posthis.bbuffer_posnew JitterStream(...)//e1.printStackTrace();/** Lanczos interpolation resampler. ... */...[] sinc_table;int sinc_table_fsize;int sinc_table_size;int sinc_table_center;sincTable(...)// Normalized sinc function// Generate sinc tablefloat[] wfloat[] sinc_tablethis.sinc_tableint xx// must be at least half of sinc_table_size/** A simple look-ahead volume limiter with very fast attack and fast release. ... */float lastmax;...[] temp_bufferL;...[] temp_bufferR;SoftAudioBuffer bufferL;SoftAudioBuffer bufferR;SoftAudioBuffer bufferLout;SoftAudioBuffer bufferRout;float[] bufferLthis.bufferLfloat[] bufferRthis.bufferRfloat[] bufferLoutthis.bufferLoutfloat[] bufferRoutthis.bufferRoutbufferL.lengthfloat lmaxfloat newgainfloat gaindeltatemp_bufferL.lengthtemp_bufferR.lengthbufferR.lengthfloat bLfloat tLfloat bRfloat tR/** A resampler that uses first-order (linear) interpolation. ... */float iint p_ixint p_ix_endint p_pitchint p_ix_lenint p_modint ox_end2int p_pitchstep// Check if we have do anything// 15 bit shift was choosed because// it resulted in no drift between p_ix and ix.// Pitch needs to recalculated// to ensure no drift between p_ix and ix.// To reduce//    while (p_ix < p_ix_end && ox < ox_end)// into//    while  (ox < ox_end)// We need to calculate new ox_end value./** LFO control signal generator. ... */...[] delay2;...[] freq;...[] delay_counter;...[] sin_phase;...[] sin_stepfreq;...[] sin_step;double sin_factor;double PI2;sin_stepfreq.lengthdouble pdouble fr// If sin_step is 0 then sin_stepfreq must be -INF/* double fr = 440.0 * Math.pow(2.0, ... *//* sin_phase[i] += sin_step[i]; ... */import MidiMessage/** Software synthesizer main audio mixer. ... */new TreeMap<Long,Object>(...)...[] balance;...[] volume;...[] coarse_tuning;...[] fine_tuning;// This becomes necessary when we want to have separate delay buffers for each channel mixer.// A private class thats contains a ModelChannelMixer and it's private buffers.ModelChannelMixer mixer;int CHANNEL_LEFT;int CHANNEL_RIGHT;int CHANNEL_MONO;int CHANNEL_DELAY_LEFT;int CHANNEL_DELAY_RIGHT;int CHANNEL_DELAY_MONO;int CHANNEL_EFFECT1;int CHANNEL_EFFECT2;int CHANNEL_DELAY_EFFECT1;int CHANNEL_DELAY_EFFECT2;int CHANNEL_LEFT_DRY;int CHANNEL_RIGHT_DRY;int CHANNEL_SCRATCH1;int CHANNEL_SCRATCH2;boolean active_sensing_on;long msec_last_activity;boolean pusher_silent;int pusher_silent_count;long sample_pos;boolean readfully;SoftSynthesizer synth;...[] voicestatus;SoftReverb reverb;SoftAudioProcessor chorus;SoftAudioProcessor agc;long msec_buffer_len;TreeMap<Long,Object> midimessages;int delay_midievent;int max_delay_midievent;double last_volume_left;double last_volume_right;...[] co_master_balance;...[] co_master_volume;...[] co_master_coarse_tuning;...[] co_master_fine_tuning;Set<SoftChannelMixerContainer> registeredMixers;Set<ModelChannelMixer> stoppedMixers;...[] cur_registeredMixers;SoftControl co_master;int deviceIDint subid1int subid2SoftTuning tuningint channelmaskSoftChannel[] channelssynth.channelschannels.length...[...].tuningsetGeneralMidiMode(...)synth.voice_allocation_modeint slotPathLenint paramWidthint valueWidthint[] slotPathlong[] paramslong[] valuessetVolume(...)setBalance(...)setFineTuning(...)setCoarseTuning(...)int msbint lsbSoftVoice[] voicesupdateTuning(...)int[] destinationsint[] rangesint channelSoftChannel softchannelmapChannelPressureToDestination(...)mapPolyPressureToDestination(...)int controlmapControlToDestination(...)int keynumberint controlnumberint controlvalueIterator<Entry<Long,Object>> iterEntry<Long,Object> entrylong msec_delayprocessMessage(...)double volume_leftdouble volume_rightSoftChannelMixerContainer[] act_registeredMixerssynth.weakstreamsynth.weakstream.silent_sampleslong msec_posdouble volumedouble balanceprocessMessages(...)voicestatus.lengthnew SoftChannelMixerContainer[]act_registeredMixers.lengthSoftAudioBuffer leftbakSoftAudioBuffer rightbakSoftAudioBuffer monobakSoftAudioBuffer delayleftbakSoftAudioBuffer delayrightbakSoftAudioBuffer delaymonobakint bufferlenfloat[][] cbufferfloat[][] obufferSoftChannelMixerContainer cmixerboolean hasactivevoicescmixer.buffers...[...].channelmixercmixer.mixerprocessAudioLogic(...)float[] monofloat vprocess(...)cbuffer.lengthfloat[] obuffsynth.chorus_onprocessAudio(...)synth.reverb_onfloat ampfloat amp_deltaint midimessages_sizesetInputStream(...)synth.agc_on// Must only we called within control_mutex synchronizationlong silent_samplesnew HashSet<ModelChannelMixer>(...)SoftChannelMixerContainer mixercontainernew SoftChannelMixerContainer(...)new HashSet<SoftChannelMixerContainer>(...)mixercontainer.buffersnew SoftAudioBuffer[]mixercontainer.buffers.lengthnew SoftAudioBuffer(...)mixercontainer.mixerint buffersizefloat controlrateSoftMainMixer.this.buffersSoftMainMixer.thisSoftMainMixer.this.synthint buffersize;...[] single;processAudioBuffers(...)int orgoffthis.synthnew SoftReverb(...)new SoftChorus(...)new SoftLimiter(...)setLightMode(...)synth.reverb_lightsetMixMode(...)paramsvalue.lengthShortMessage smsgetCommand(...)int cmdint data1int data2processSystemExclusiveMessage(...)ShortMessage.ACTIVE_SENSINGShortMessage.POLY_PRESSUREShortMessage.CHANNEL_PRESSURE// Universal Non-Real-Time SysEx// MIDI Tuning Standard// BULK TUNING DUMP// http://www.midi.org/about-midi/tuning.shtml// KEY-BASED TUNING DUMP// SCALE/OCTAVE TUNING DUMP, 1 byte format// SCALE/OCTAVE TUNING DUMP, 2 byte format// SINGLE NOTE TUNING CHANGE (NON REAL-TIME)// (BANK)// http://www.midi.org/about-midi/tuning_extens.shtml// scale/octave tuning 1-byte form (Non// Real-Time)// scale/octave tuning 2-byte form (Non// http://www.midi.org/about-midi/tuning-scale.shtml// General Midi Message// General Midi 1 On// General Midi Off// General MidI Level 2 On// DLS Message// DLS On// DLS Off// DLS Static Voice Allocation Off// DLS Static Voice Allocation On// Universal Real-Time SysEx// Device Control// Master Volume// Master Balane// Master fine tuning// Master coarse tuning// Global Parameter Control// SINGLE NOTE TUNING CHANGE (REAL-TIME)// scale/octave tuning 1-byte form//(Real-Time)// scale/octave tuning 2-byte form// (Real-Time)// Control Destination Settings// Channel Pressure// Poly Pressure// Control Change// Key Based Instrument Control// Basic Message// perform control logic// Active Sensing// if no message occurs for max 1000 ms// then do AllSoundOff on all channels// Make backup of left,right,mono channels// Reroute default left,right output// to channelmixer left,right input/output// Run effects// Set Volume / Balance/* boolean pusher_silent2; ... */// Reset Reverb// Reset Chorus// slothpath: 01xx are reserved only for GM2import MidiEventimport Track/** MIDI File Audio Renderer/Reader. ... */new Type(...)Type MIDI;long totallennew AudioFileFormat(...)AudioSynthesizer synthnew SoftSynthesizer(...)Receiver recvfloat divtypeint[] tracksposint mpqint seqreslong lastticklong curtimeMidiEvent seleventint seltrackint trackpos/** Clip implementation for the SoftMixingMixer. ... */int bloopendint bloopstartint offendint oint framesize;InputStream datastream;...[] readbuffer;AudioFormat outputformat;int out_nrofchannels;int in_nrofchannels;int frameposition;boolean frameposition_sg;boolean active_sg;int loopstart;int loopend;int loopcount;boolean _active;int _frameposition;boolean loop_sg;int _loopcount;int _loopstart;int _loopend;float _rightgain;float _leftgain;float _eff1gain;float _eff2gain;AudioFloatInputStream afis;SoftMixingMainMixer.CHANNEL_LEFTSoftMixingMainMixer.CHANNEL_RIGHTint in_creadbuffer.lengthfloat[] eff1SoftMixingMainMixer.CHANNEL_EFFECT1float[] eff2SoftMixingMainMixer.CHANNEL_EFFECT2sendEvent(...)int readsizethis.framesizemixer.implicitOpenopenLine(...)getFramePosition(...)closeLine(...)/** General software mixing line. ... */new ReverbSend(...)new ChorusSend(...)new ApplyReverb(...)new ArrayList<LineListener>(...)FloatControl.Type CHORUS_SEND;BooleanControl.Type.APPLY_REVERBFloatControl.Type.REVERB_SENDGain gain_control;Mute mute_control;Balance balance_control;Pan pan_control;ReverbSend reverbsend_control;ChorusSend chorussend_control;ApplyReverb apply_reverb;float leftgain;float rightgain;float eff1gain;float eff2gain;List<LineListener> listeners;SoftMixingMixer mixer;DataLine.Info info;this.control_mutexmixer.control_mutexLineListener[] listener_arraynew LineListener[]LineListener listener// -1 = Left, 0 Center, 1 = Right/** Main mixer for SoftMixingMixer. ... */new ArrayList<SoftMixingDataLine>(...)new SoftMixingDataLine[]int CHANNEL_EFFECT3;int CHANNEL_EFFECT4;int CHANNEL_CHANNELMIXER_LEFT;int CHANNEL_CHANNELMIXER_RIGHT;SoftAudioProcessor reverb;List<SoftMixingDataLine> openLinesList;...[] openLines;SoftMixingDataLine[] openLinesthis.openLinesopenLines.lengthSoftMixingMainMixer.this.buffersSoftMixingMainMixer.thisSoftMixingMainMixer.this.mixer/** Software audio mixer ... */String INFO_NAME;String INFO_VENDOR;String INFO_DESCRIPTION;String INFO_VERSION;Mixer.Info info;boolean implicitOpen;SoftMixingMainMixer mainmixer;SoftAudioPusher pusher;AudioInputStream pusher_stream;long latency;boolean jitter_correction;// 100 msecAudioFormat[] formats_arraynew SoftMixingSourceDataLine(...)new SoftMixingClip(...)ArrayList<Info> infosnew ArrayList<Info>(...)SoftMixingDataLine[] sourceLinesgetOpenLines(...)sourceLines.lengthSoftAudioPusher pusher_to_be_closedAudioInputStream pusher_stream_to_be_closeddouble latencythis.latencyint controlbuffersizeSoftMixingMixerProvider.mutexSoftMixingMixerProvider.lockthreadMixer defaultmixergetMixer(...)Info idealinfoAudioFormat idealformatInfo[] lineinfoslineinfos.lengthint ideal_channelsboolean ideal_signedfloat ideal_rateboolean ideal_endianint ideal_bitsgetSourceDataLine(...)int bufferSizenew SoftJitterCorrector(...)new SoftAudioPusher(...)new SoftMixingMainMixer(...)// Pusher must not be closed synchronized against control_mutex// this may result in synchronized conflict between pusher and// current thread.// Search for suitable line// Remember that we opened that line// so we can close again in SoftSynthesizer.close()// Tell mixer not fill read buffers fully.// This lowers latency, and tells DataPusher// to read in smaller amounts.// mainmixer.readfully = false;// pusher = new DataPusher(line, ais);import Info/** Provider for software audio mixer ... */SoftMixingMixer globalmixer;Thread lockthread;Object mutex;SoftMixingMixer.infonew SoftMixingMixer(...)/** SourceDataLine implementation for the SoftMixingMixer. ... */...[] cycling_buffer;int cycling_read_pos;int cycling_write_pos;int cycling_avail;long cycling_framepos;int buff_lencycling_buffer.length// FloatControl.Type.BALANCE// FloatControl.Type.MASTER_GAIN// FloatControl.Type.PAN// FloatControl.Type.VOLUME// FloatControl.Type.REVERB_SEND// FloatControl.Type.SAMPLE_RATE// EnumControl.Type.REVERB// BooleanControl.Type.MUTE// BooleanControl.Type.APPLY_REVERBInputStream cycling_inputstreamthis.outputformatnew NonBlockingFloatInputStream(...)/** This class decodes information from ModelPeformer for use in SoftVoice. ... */Float.NEGATIVE_INFINITYnew KeySortComparator(...)...[] defaultconnections;boolean forcedVelocity;boolean forcedKeynumber;ModelPerformer performer;...[] connections;...[] oscillators;Map<Integer,int[]> midi_rpn_connections;Map<Integer,int[]> midi_nrpn_connections;...[] midi_ctrl_connections;...[] midi_connections;...[] ctrl_connections;List<Integer> ctrl_connections_list;KeySortComparator keySortComparator;ModelSource[] srcsModelSource[] srcs2srcs.lengthString oprocessMidiControlSource(...)processMidiRpnSource(...)processMidiNrpnSource(...)processMidiSource(...)processNoteOnSource(...)int[] oldaint[] newaolda.lengthnewa.lengthMap<String,ModelConnectionBlock> connmapnew HashMap<String,ModelConnectionBlock>(...)List<ModelConnectionBlock> performer_connectionsList<ModelConnectionBlock> connectionsboolean mustBeOnTopthis.performerboolean isModulationWheelConectionFoundboolean channel_pressure_setboolean poly_pressureModelConnectionBlock mod_cc_1_connectionint mod_cc_1_connection_src_ixModelConnectionBlock found_vib_connectionint instanceModelConnectionBlock connectionModelDestination destboolean isModulationWheelConectionModelConnectionBlock newconnectionsetSources(...)ModelConnectionBlock mcModelSource[] src_listModelSource[] src_list_newsrc_list.lengthsrc_list_new.lengthextractKeys(...)getSources(...).lengthmidi_ctrl_connections.lengthmidi_connections.lengthprocessSource(...)this.connectionsthis.ctrl_connectionsthis.ctrl_connections.lengthnew ModelOscillator[]isUnnecessaryTransform(...)ModelStandardTransform stransformgetDirection(...)getPolarity(...)// 15 msec default// Add modulation depth range (RPN 5) to the modulation wheel (cc#1)// check if connection block has the source "modulation// wheel cc#1"// Let Aftertouch to behave just like modulation wheel (cc#1)// if(dest != null && sources != null)// check if channel or poly pressure are already// connected// Enable Vibration Sound Controllers : 76, 77, 78// Add default connection blocks// Add connection blocks from modelperformer// seperate connection blocks : Init time, Midi Time, Midi/Control Time,// Control Time/** A resampler that uses 0-order (nearest-neighbor) interpolation. ... */float ox_end/** Control signal processor interface ... *//** Software synthesizer provider class. ... */SoftSynthesizer.infoInfo softinfo;...[] softinfos;softinfos.lengthimport MidiDeviceReceiver/** Software synthesizer MIDI receiver class. ... */this.midimessagesmainmixer.midimessagesremoveReceiver(...)/** Basic resampler interface. ... *//** Resampler stream interface. ... *//** Reverb effect based on allpass/comb filters. First audio is send to 8 ... */inout.lengthint delaybuffersize;int delaybuffersizethis.delaybuffersizefloat delayoutfloat inputfloat filtertemp;float filtercoeff1;float filtercoeff2;float filtertempthis.filtertempfloat filtercoeff1this.filtercoeff1float filtercoeff2this.filtercoeff2float roomsize;float damp;Delay delay;...[] combL;...[] combR;...[] allpassL;...[] allpassR;...[] input;...[] pre1;...[] pre2;...[] pre3;boolean denormal_flip;float dirty_roomsize;float dirty_damp;float dirty_predelay;float dirty_gain;boolean light;double freqscaleint stereospreadnew Delay(...)new Comb[]new Comb(...)new AllPass[]new AllPass(...)allpassL.lengthboolean silent;boolean silent_inputint numsamplesinputA.lengthfloat againinput.lengthpre1.lengthcombL.lengthcombR.lengthfloat pfloat mallpassR.lengthsetRoomSize(...)setDamp(...)setPreDelay(...)...[...].feedbackdouble cxthis.light// One Pole Lowpass Filter// freqscale = 1.0/ freqscale;/* Init other settings */// Small Room A small size room with a length// of 5m or so.// Medium Room A medium size room with a length// of 10m or so.// Large Room A large size room suitable for// live performances.// Medium Hall A medium size concert hall.// Large Hall A large size concert hall// suitable for a full orchestra.// Plate A plate reverb simulation.// damp = value * 0.4f;/** A short message class that support for than 16 midi channels. ... */SoftShortMessage clonenew SoftShortMessage(...)/** Hann windowed sinc interpolation resampler with anti-alias filtering. ... */int sinc_scale_size;new float[][][]// Generate hann window suitable for windowing sincfloat[] window_tablewHanning(...)sinc(...)int max_pfloat[][] sinc_table_fimport BackingStoreExceptionimport Preferences/** The software synthesizer class. ... */new HashMap<String,SoftTuning>(...)new HashMap<String,SoftInstrument>(...)new HashMap<String,ModelInstrument>(...)AudioInputStream jitter_stream;long silent_samples;WeakReference<AudioInputStream> weak_stream_link;...[] silentbuffer;int samplesize;AudioInputStream local_streamsilentbuffer.lengthSoftAudioPusher _pusher;AudioInputStream _jitter_stream;SourceDataLine _sourceDataLine;new WeakReference<AudioInputStream>(...)SourceDataLine testline;Soundbank defaultSoundBank;WeakAudioStream weakstream;int voiceIDCounter;int voice_allocation_mode;// 1: DLS Voice Allocation// 0: defaultboolean load_default_soundbank;boolean reverb_light;boolean reverb_on;boolean chorus_on;boolean agc_on;...[] channels;...[] external_channels;boolean largemode;int gmmode;// 2: GM Level 2// 1: GM Level 1// 0: GM Mode off (default)int deviceid;String resamplerType;SoftResampler resampler;int number_of_midi_channels;int maxpoly;// 200 msecMap<String,SoftTuning> tunings;Map<String,SoftInstrument> inslist;Map<String,ModelInstrument> loadedlist;ArrayList<Receiver> recvslist;ModelOscillator oscModelByteBufferWavetable wgetBuffer(...)get8BitExtensionBuffer(...)List<ModelByteBuffer> buffersnew ArrayList<ModelByteBuffer>(...)ModelInstrument instrumentgetBuffers(...)loadAll(...)loadSamples(...)c.current_instrumentc.current_directorString patpatchToString(...)SoftInstrument softinsAudioSynthesizerPropertyInfo[] itemsgetPropertyInfo(...)this.resamplerTypesetFormat(...)boolean perform_closeString p_plafSoftInstrument current_instrumentthis.gmmodeString t_idMidiChannel[] retnew SoftChannelProxy[]external_channels.lengthnew SoftChannelProxy(...)new MidiChannel[]ret.lengthVoiceStatus[] tempVoiceStatusArraynew VoiceStatus[]getMaxPolyphony(...)tempVoiceStatusArray.lengthVoiceStatus bnew VoiceStatus(...)b.activeb.bankb.channelb.noteb.programb.volumeVoiceStatus aa.activea.banka.channela.notea.programa.volumeList<ModelInstrument> instrumentsnew ArrayList<ModelInstrument>(...)loadInstruments(...)ModelMappedInstrument mfromnew ModelMappedInstrument(...)unloadInstrument(...)loadInstrument(...)List<PrivilegedAction<InputStream>> actionsnew ArrayList<PrivilegedAction<InputStream>>(...)File javahomeFile libaudioFile foundfilelistFiles(...)File gm_dlsgetenv(...)File userhomeFile emg_soundbank_filePrivilegedAction<InputStream> actioncreateSoundbank(...)new PrivilegedAction<OutputStream>(...) { ... }mkdirs(...)FileNotFoundException ignoredIOException ignoredSoundbank defsbkgetDefaultSoundbank(...)ModelInstrument[] inslist_arraynew ModelInstrument[]isSoundbankSupported(...)Patch patnew PrivilegedAction<Properties>(...) { ... }String notePathPreferences prefrootuserRoot(...)nodeExists(...)Preferences prefsnode(...)String[] prefs_keysString prefs_keyBackingStoreException ignoredList<AudioSynthesizerPropertyInfo> listnew ArrayList<AudioSynthesizerPropertyInfo>(...)AudioSynthesizerPropertyInfo itemboolean oProperties storedPropertiesgetStoredProperties(...)new AudioSynthesizerPropertyInfo(...)item.choicesitem.descriptionnew AudioSynthesizerPropertyInfo[]AudioSynthesizerPropertyInfo item2item2.nameitem2.valueClassitem2.valueboolean signedString prevTokenNumber nshortValue(...)new WeakAudioStream(...)weakstream.jitter_streamweakstream.pusherweakstream.sourceDataLineMidiUnavailableException exprocessPropertyInfo(...)Soundbank defbankloadAllInstruments(...)new SoftVoice[]new SoftVoice(...)new SoftMainMixer(...)new SoftChannel[]new SoftChannel(...)SoftChannelProxy[] new_external_channelsnew_external_channels.lengthsetChannel(...)SoftVoice voicevoice.resampleropenStreamer(...)getReceivers(...)SoftReceiver srecvsrecv.opensrecv.mainmixersrecv.midimessagesgetMicrosecondPosition(...)SoftReceiver receivernew SoftReceiver(...)receiver.openArrayList<Receiver> recvs/* Copyright (c) 2008, 2014, Oracle and/or its affiliates. All rights reserved. ... */// Add support for GM2 banks 0x78 and 0x79// as specified in DLS 2.2 in Section 1.4.6// which allows using percussion and melodic instruments// on all channels// Instrument not found fallback to MSB:bank, LSB:0// Instrument not found fallback to MSB:0, LSB:bank// Instrument not found fallback to MSB:0, LSB:0// Instrument not found fallback to MSB:0, LSB:0, program=0// Channel 10 uses percussion instruments// if (external_channels == null) => the synthesizer is not open,// create 16 proxy channels// otherwise external_channels has the same length as channels array/* Try to load saved generated soundbank *//* Generate emergency soundbank *//* Save generated soundbank to disk for faster future use. */// If info != null or synthesizer is closed//   we return how the synthesizer will be set on next open// If info == null and synthesizer is open//   we return current synthesizer properties.// can throw IllegalArgumentException// can throw LineUnavailableException,// IllegalArgumentException, SecurityException//mainmixer.readfully = false;//pusher = new DataPusher(line, ais);// am: need MidiUnavailableException(Throwable) ctor!// Always create external_channels array// with 16 or more channels// so getChannels works correctly// when the synhtesizer is closed.// We must resize external_channels array// but we must also copy the old SoftChannelProxy// into the new one// Pusher must not be closed synchronized against control_mutex,// this may result in synchronized conflict between pusher// and current thread./** A tuning program container, for use with MIDI Tuning. ... */...[] tuning;Patch patch;tuning.lengththis.patch/* private boolean checksumOK2(byte[] data) { ... */int llint yyint zzint kkchecksumOK(...)int[] octave_tuningdouble[] octave_tuning// currently getTuning() is used only by tests// am: getTuning(int) is more effective.// Universal Non-Real-Time / Real-Time SysEx// BULK TUNING DUMP (NON-REAL-TIME)//if (!checksumOK2(data))// KEY-BASED TUNING DUMP (NON-REAL-TIME)// (NON-REAL-TIME)// SINGLE NOTE TUNING CHANGE (NON// REAL-TIME/REAL-TIME) (BANK)// Real-Time/REAL-TIME)/** Software synthesizer voice class. ... */new SoftEnvelopeGenerator(...)new SoftLowFrequencyOscillator(...)new HashMap<String,SoftControl>(...)new double[][][]...[] keynumber;...[] velocity;...[] gain;...[] pan;...[] reverb;...[] chorus;...[] ftype;...[] q;boolean releaseTriggered;int noteOn_noteNumber;int noteOn_velocity;int noteOff_velocity;int delay;ModelChannelMixer channelmixer;double tunedKey;SoftChannel stealer_channel;...[] stealer_extendedConnectionBlocks;SoftPerformer stealer_performer;ModelChannelMixer stealer_channelmixer;int stealer_voiceID;int stealer_noteNumber;int stealer_velocity;boolean stealer_releaseTriggered;int voiceID;boolean sostenuto;SoftFilter filter_left;SoftFilter filter_right;SoftProcess eg;SoftProcess lfo;Map<String,SoftControl> objects;SoftInstrument instrument;SoftPerformer performer;SoftChannel softchannel;boolean audiostarted;boolean stopping;float osc_attenuation;ModelOscillatorStream osc_stream;int osc_stream_nrofchannels;...[] osc_buff;boolean osc_stream_off_transmitted;boolean out_mixer_end;float out_mixer_left;float out_mixer_right;float out_mixer_effect1;float out_mixer_effect2;float last_out_mixer_left;float last_out_mixer_right;float last_out_mixer_effect1;float last_out_mixer_effect2;...[] extendedConnectionBlocks;...[] connections_last;// Last value added to destination...[] connections_src;// Pointer to source value...[] connections_src_kc;// Key-based override (if any)...[] connections_dst;// Pointer to destination valueboolean soundoff;float lastMuteValue;float lastSoloMuteValue;...[] co_noteon_keynumber;...[] co_noteon_velocity;...[] co_noteon_on;SoftControl co_noteon;...[] co_mixer_active;...[] co_mixer_gain;...[] co_mixer_pan;...[] co_mixer_balance;...[] co_mixer_reverb;...[] co_mixer_chorus;SoftControl co_mixer;...[] co_osc_pitch;SoftControl co_osc;...[] co_filter_freq;...[] co_filter_type;...[] co_filter_q;SoftControl co_filter;SoftResamplerStreamer resampler;new SoftFilter(...)int icSoftControl osoftchannel.keybasedcontroller_activedouble key_controlvaluesoftchannel.keybasedcontroller_valuedouble[][] srcdouble[] dsttransformValue(...)int[] src_kcprocessKeyBasedController(...)performer.midi_connectionsprocessConnection(...)performer.forcedKeynumberperformer.forcedVelocitygetMainMixer(...).co_masterperformer.connectionsconnections_last.lengthconnections.lengthconnections_src.lengthconnections_dst.lengthgetValueKC(...)ModelTransform tperformer.midi_ctrl_connectionsperformer.midi_nrpn_connectionsperformer.midi_rpn_connectionssoftchannel.sustainperformer.oscillatorsosc_buff.lengthint filter_typedouble filter_freqdouble pandouble note_deltadouble note_delta_asoftchannel.portamento_timeperformer.ctrl_connections.lengthperformer.ctrl_connectionssetPitch(...)setFilterType(...)setFrequency(...)setResonance(...)synthesizer.reverb_onsynthesizer.chorus_onfloat[] foutfloat[] finSoftAudioBuffer leftSoftMainMixer.CHANNEL_LEFTSoftAudioBuffer rightSoftMainMixer.CHANNEL_RIGHTSoftAudioBuffer monoSoftMainMixer.CHANNEL_MONOSoftAudioBuffer eff1SoftMainMixer.CHANNEL_EFFECT1SoftAudioBuffer eff2SoftMainMixer.CHANNEL_EFFECT2SoftAudioBuffer dleftSoftMainMixer.CHANNEL_DELAY_LEFTSoftAudioBuffer drightSoftMainMixer.CHANNEL_DELAY_RIGHTSoftAudioBuffer dmonoSoftMainMixer.CHANNEL_DELAY_MONOSoftAudioBuffer deff1SoftMainMixer.CHANNEL_DELAY_EFFECT1SoftAudioBuffer deff2SoftMainMixer.CHANNEL_DELAY_EFFECT2SoftAudioBuffer leftdrySoftMainMixer.CHANNEL_LEFT_DRYSoftAudioBuffer rightdrySoftMainMixer.CHANNEL_RIGHT_DRYmixAudioStream(...)// Fine tuning// Coarse tuning// co_mixer_gain[0] = 0;// volume = velocity;// don't redamp notes in shutdown stage/* filter_freq = 440.0 * Math.pow(2.0, ... *//* double velocity = co_noteon_velocity[0]; if(velocity < 0.5) ... *//* float gain = (float) Math.pow(10, ... *//* if(co_mixer_gain[0] > -960) ... */// gain *= 0.2;// System.out.println("pan = " + pan);import SysexMessage/** MIDI file reader. ... */int MThd_MAGIC;int bisBufferSize;// 'MThd'// buffer size in buffered input streamsgetMidiFileFormatFromStream(...)MidiFileFormat.UNKNOWN_LENGTH// returns format having invalid length// $$fb 2002-04-17: part of fix for 4635286: MidiSystem.getMidiFileFormat()int durationint numtracksfloat divisionTypeMidiFileFormat formatnew MidiFileFormat(...)smfParser.streamint timingnew InvalidMidiDataException(...)int frameCodeSequence.SMPTE_24Sequence.SMPTE_25Sequence.SMPTE_30DROPSequence.SMPTE_30smfParser.tracksMidiFileFormat fileFormatlong lengthSMFParser smfParsernew SMFParser(...)Sequence sequencenew Sequence(...)nextTrack(...)readTrack(...)createTrack(...)/** State variables during parsing of a MIDI file. *///=============================================================================================================int MTrk_MAGIC;boolean STRICT_PARSER;// set to true to not allow corrupt MIDI files tombe loaded// 'MTrk'int tracks;DataInputStream stream;// number of tracksint trackLength;// the stream to read from...[] trackData;// remaining length in trackint currentByteEOFException eofreadIntFromStream(...)boolean endOfTrackFoundtrackFinished(...)int byteValuereadUnsigned(...)readVarInt(...)int sysexLengthbyte[] sysexDataSysexMessage sysexMessagenew SysexMessage(...)int metaTypeint metaLengthbyte[] metaDataMetaMessage metaMessageArrayIndexOutOfBoundsException e// not MIDI// read header length// decipher the timing code// tempo based timing.  value is ticks per beat.// SMPTE based timing.  first decipher the frame code.// now determine the timing resolution in ticks per frame.// remainder of this chunk// if only reading the file format, reset the stream// throws InvalidMidiDataException// $$fb 2002-04-17: part of fix for 4635286: MidiSystem.getMidiFileFormat() returns format having invalid length// must be MIDI Type 0 or Type 1// construct the sequence object// for each track, go to the beginning and read the track events// the variable-lengh int value// $$fb 2003-08-20: fix for 4910986: MIDI file parser breaks up on http connection// now read track in a byte array// reset current tick to 0// reset current status byte to 0 (invalid value).// this should cause us to throw an InvalidMidiDataException if we don't// get a valid status byte from the beginning of the track.// initialize to invalid value// each event has a tick delay and then the event data.// first read the delay (a variable-length int) and update our tick value// check for new status// two data bytes// one data byte// sys-ex or meta// sys ex// meta// end of track means it!// switch sys-ex or meta// fix for 4834374import PipedInputStreamimport PipedOutputStream/** MIDI file writer. ... */int ONE_BYTE;int TWO_BYTE;int SYSEX;int META;int IGNORE;int MIDI_TYPE_0;int MIDI_TYPE_1;DataOutputStream tddos;// buffersize for write/** MIDI parser types */// data output stream for track writing/** new */int[] localArray/** Obtains the file types that this provider can write from the ... */int[] typesArraylong bytesWrittenisFileTypeSupported(...)//=================================================================================int bytesBuiltint headerLengthint timeFormatPipedOutputStream hposDataOutputStream hdosPipedInputStream headerStreamInputStream[] trackStreamsInputStream trackStreamInputStream fStreamnew InputStream[]writeTrack(...)new PipedOutputStream(...)new PipedInputStream(...)/** Returns ONE_BYTE, TWO_BYTE, SYSEX, META, ... */long mask;int lastBytesWrittenPipedOutputStream thposDataOutputStream thdosPipedInputStream thpisByteArrayOutputStream tdbosByteArrayInputStream tdbisSequenceInputStream fStreamlong currentTicklong deltaTicklong eventTickint runningStatusint eventtypeint metatypeShortMessage shortMessagewriteVarInt(...)// First get the fileStream from this sequence// Done....return bytesWritten// Determine the filetype to write// $$jb: 05.31.99: we _can_ write TYPE_1 if tracks.length==1// Now build the file one track at a time// Note that above we made sure that MIDI_TYPE_0 only happens// if tracks.length==1//bytesBuilt += trackStreams[i].getLength();// Now seqence the track streams// fix for 5048381: NullPointerException when saving a MIDI sequence// don't include failed track streams// Now build the header...// Write the magic number// Write the header length// Write the filetype// MIDI_TYPE_1// Write the number of tracks// Determine and write the timing format// $$jb: 04.08.99: What to really do here?// now construct an InputStream to become the FileStream// number of bitwise left-shifts of mask// first screen out leading zeros// then write actual values// -----------------------------// Write each event in the track// get the tick// $$jb: this gets easier if we change all system-wide time to delta ticks// get the status byte// $$jb: 04.08.99: always write status for sysex// $$jb: 10.18.99: we don't maintain length in// the message data for SysEx (it is not transmitted// over the line), so write the calculated length// minus the status byte// $$jb: 10.18.99: now write the rest of the// message// $$jb: 10.18.99: getMessage() returns the// entire valid midi message for a file,// including the status byte and the var-length-int// length value, so we can just write the data// here.  note that we must _always_ write the// status byte, regardless of runningStatus.// ignore this event// ---------------------------------// End write each event in the track// Build Track header now that we know length// Now sequence them/** A codec can encode and/or decode audio data.  It provides an ... *//** Constructs a new codec object. */this.inputEncodingsthis.outputEncodingsEncoding[] encodingsinputEncodings.lengthoutputEncodings.length/** Abstract File Reader class. ... */// buffer size for temporary input streams/** Constructs a new SunFileReader object. *//** rllong ... */int b3int b4/** big2little ... *//** rlshort ... */short highshort low/** Calculates the frame size for PCM frames. ... *//** Abstract File Writer class. ... */// buffer size for write/** Constructs a new SunParser object. */this.types// new, 10.27.99Type[] localArray/** InputStream wrapper class which prevent source stream from being closed. ... */// don't propagate the call/** Common conversions etc. ... *//** Converts bytes from signed to unsigned. *//** Swaps bytes. ... *//** Linear to DB scale conversion. */float dB/** DB to linear scale conversion. */float linear/* returns bytes aligned to a multiple of blocksize ... *//* gets the number of bytes needed to play the specified number of milliseconds *//* gets the time in milliseconds for the given number of bytes *//* gets the number of bytes needed to play the specified number of microseconds *//* gets the time in microseconds for the given number of bytes *//* gets the number of frames needed to play the specified number of microseconds *//* gets the time in microseconds for the given number of frames */AudioFormat af// prevent null pointers// we don't know how to verify possibly non-linear encodings// we can't open the device for non-PCM playback, so we have// convert any other encodings to PCM here (at least we try!)/** U-law encodes linear data, and decodes u-law data to linear data. ... */int ulaw...[] ULAW_TABH;/* Tables used for U-law decoding */...[] ULAW_TABL;...[] ulawEncodings;/** Constructs a new ULAW codec object. */new UlawCodecStream(...)/** True to encode to u-law, false to decode to linear */short BIAS// setup tables according to byte order/* Get the sign and the magnitude of the value. *//* Combine the sign, segment, quantization bits; ... */// EOF or error on read// end class UlawCodecStream// end class ULAW/** WAVE file reader for files using format WAVE_FORMAT_EXTENSIBLE (0xFFFE). ... */new GUID(...)GUID dGUID t...[] channelnames;...[] allchannelnames;GUID SUBTYPE_PCM;GUID SUBTYPE_IEEE_FLOAT;long mallchannelnames.lengthchannelnames.lengthAudioFileFormat formatinternal_getAudioFileFormat(...)RIFFReader riffiteratorboolean fmt_foundboolean data_foundint validBitsPerSamplelong channelMaskGUID subFormatMap<String,Object> pString s_channelmaskdecodeChannelMask(...)AudioFileFormat fileformatAudioFileFormat.Type.WAVEint formatint cbSize// 5.1// long framerate = 1;// WAVE_FORMAT_EXTENSIBLE// only/* framerate = */// validBitsPerSample is only informational for PCM data,// data is still encode according to SampleSizeInBits./** WAVE file format class. ... */int waveType;/** Wave format type. */int STANDARD_HEADER_SIZE;//$$fb 2002-04-16: Fix for 4636355: RIFF audio headers could be _more_ spec compliantint STANDARD_FMT_CHUNK_SIZE;/** fmt_ chunk size in bytes */int RIFF_MAGIC;int WAVE_MAGIC;int FMT_MAGIC;int DATA_MAGIC;// "fmt "int WAVE_FORMAT_UNKNOWN;// "data"int WAVE_FORMAT_PCM;int WAVE_FORMAT_ADPCM;int WAVE_FORMAT_ALAW;int WAVE_FORMAT_MULAW;int WAVE_FORMAT_OKI_ADPCM;int WAVE_FORMAT_DIGISTD;int WAVE_FORMAT_DIGIFIX;int WAVE_IBM_FORMAT_MULAW;int WAVE_IBM_FORMAT_ALAW;int WAVE_IBM_FORMAT_ADPCM;int WAVE_FORMAT_DVI_ADPCM;int WAVE_FORMAT_SX7383;getWaveType(...)getFmtChunkSize(...)// use dynamic format chunk size// add 2 bytes for "codec specific data length" for non-PCM codecs// WORD for "codec specific data length"/** WAVE file reader. ... */getFMT(...)int wav_typelong sampleRatelong avgBytesPerSecshort blockAlignint fileLengthint waveMagicint endLengthWaveFileFormat.RIFF_MAGICWaveFileFormat.WAVE_MAGICWaveFileFormat.FMT_MAGICrlshort(...)WaveFileFormat.WAVE_FORMAT_PCMWaveFileFormat.WAVE_FORMAT_ALAWWaveFileFormat.WAVE_FORMAT_MULAWint datahdrWaveFileFormat.DATA_MAGICint thisLengthnew WaveFileFormat(...)// getFMT leaves the input stream at the beginning of the audio data// assumes sream is rewound// not WAVE, throw UnsupportedAudioFileException// find and read the "fmt" chunk// we break out of this loop either by hitting EOF or finding "fmt "// we've found the 'fmt' chunk// else not 'fmt', skip this chunk// we've reached the end of the file without finding the 'fmt' chunk// Read the format chunk size.// This is the nread position at the end of the format chunk// Read the wave format data out of the format chunk.// encoding.// if 8-bit, we need PCM_UNSIGNED, below...// we don't support any other WAVE formats....// channels// sample rate.// this is the avgBytesPerSec// this is blockAlign value// this is the PCM-specific value bitsPerSample// if sampleSizeInBits==8, we need to use PCM_UNSIGNED// skip any difference between the length of the format chunk// and what we read// if the length of the chunk is odd, there's an extra pad byte// at the end.  i've never seen this in the fmt chunk, but we// should check to make sure.// $$jb: 07.28.99: endLength>nread, not length>nread.//       This fixes #4257986// we have a format now, so find the "data" chunk// we break out of this loop either by hitting EOF or finding "data"// $$kk: if "data" chunk precedes "fmt" chunk we are hosed -- can this legally happen?// we've found the 'data' chunk// else not 'data', skip this chunk// we've reached the end of the file without finding the 'data' chunk// this is the length of the data chunk// now build the new AudioFileFormat and return/** WAVE file writer. ... *//** Constructs a new WaveFileWriter object. */WaveFileFormat waveFileFormatwriteWaveFile(...)int riffLengthWaveFileFormat fileFormatint waveTypeAudioFormat audioFormatint riffMagicint fmtMagicint fmtLengthshort wav_typeshort sampleSizeInBitsint frameSizeInBytesint avgBytesPerSecint dataMagicSequenceInputStream waveStreambig2littleShort(...)//$$fb when we got this far, we are committed to write this file// skip RIFF magic// skip WAVE magic, fmt_ magic, fmt_ length, fmt_ chunk, data magic// WAVE is little endian// private method ... assumes audioFileFormat is a supported file type// WAVE header fields// if audioStream is an AudioInputStream and we need to convert, do it here...// plug in the transcoder to convert from PCM_SIGNED to PCM_UNSIGNED// plug in the transcoder to convert to PCM_SIGNED_LITTLE_ENDIAN// Now push the header into a stream, concat, and return the new SequenceInputStream// we write in littleendian...// add length 0 for "codec specific data length"/** Floating-point encoded (format 3) WAVE file loader. ... */// WAVE_FORMAT_IEEE_FLOAT only/** Floating-point encoded (format 3) WAVE file writer. ... */Type.WAVERIFFWriter writernew NoCloseOutputStream(...)int fpointercheckFormat(...)toLittleEndian(...)// WAVE_FORMAT_IEEE_FLOAT// no need to implement Enumeration since this is only for internal use/** The FactoryEnumeration is used for returning factory instances. ... */List<NamedWeakReference<Object>> factories;// List<NamedWeakReference<Class | Object>>/** Records the input list and uses it directly to satisfy ... */this.factoriesNamedWeakReference<Object> refClass<?> clsnew NamedWeakReference<Object>(...)// reload class if weak ref cleared// Instantiate Class to get factory// replace Class object or null/** A NamedWeakReference is a WeakReference with an immutable string name. ... *//** The ResourceManager class facilitates the reading of JNDI resource files. ... */Context.OBJECT_FACTORIESContext.URL_PKG_PREFIXESContext.STATE_FACTORIESLdapContext.CONTROL_FACTORIESnew WeakHashMap<Object,Hashtable<? super String,Object>>(...)new WeakHashMap<ClassLoader,Map<String,List<NamedWeakReference<Object>>>>(...)new WeakHashMap<ClassLoader,Map<String,WeakReference<Object>>>(...)String PROVIDER_RESOURCE_FILE_NAME;/* Name of provider resource files (without the package-name prefix.) */String APP_RESOURCE_FILE_NAME;/* Name of application resource files. */String JRELIB_PROPERTY_FILE_NAME;/* Name of properties file in <java.home>/lib. */String DISABLE_APP_RESOURCE_FILES;/* Internal environment property, that when set to "true", disables ... */...[] listProperties;/* The standard JNDI properties that specify colon-separated lists. */WeakHashMap<Object,Hashtable<? super String,Object>> propertiesCache;// WeakHashMap<Class | ClassLoader, Hashtable>/* A cache of the properties that have been constructed by ... */WeakHashMap<ClassLoader,Map<String,List<NamedWeakReference<Object>>>> factoryCache;/* A cache of factory objects (ObjectFactory, StateFactory, ControlFactory). ... */WeakHashMap<ClassLoader,Map<String,WeakReference<Object>>> urlFactoryCache;/* A cache of URL factory objects (ObjectFactory). ... */WeakReference<Object> NO_FACTORY;/** A class to allow JNDI properties be specified as applet parameters ... */Class<?> clazz;Method getMethod;/** Returns the value of the applet's named parameter. */// There should be no instances of this class./* Given the environment parameter passed to the initial context ... */// ---------- Public methods ----------String[] propsVersionHelper.PROPSString[] jndiSysPropsgetJndiProperties(...)String disableAppResprops.lengthgetJndiProperty(...)mergeTables(...)getApplicationResources(...)/** Retrieves the property from the environment, or from the provider ... */String val2getProviderResource(...)/** Retrieves an enumeration of factory classes/object specified by a ... */String facPropMap<String,List<NamedWeakReference<Object>>> perLoaderCachenew HashMap<String,List<NamedWeakReference<Object>>>(...)List<NamedWeakReference<Object>> factoriesnew FactoryEnumeration(...)new ArrayList<NamedWeakReference<Object>>(...)/** Retrieves a factory from a list of packages specified in a ... */Map<String,WeakReference<Object>> perLoaderCachenew HashMap<String,WeakReference<Object>>(...)WeakReference<Object> factoryRef/* Returns the properties contained in the provider resource file ... */// ---------- Private methods ----------Hashtable<? super String,Object> propsInputStream istream/* Returns the Hashtable (never null) that results from merging ... */Hashtable<? super String,Object> resultNamingEnumeration<InputStream> resourcesgetResources(...)getJavaHomeLibStream(...)/* Merge the properties from one hash table into another.  Each ... */Object val1isListProperty(...)/* Is a property one of the standard JNDI properties that specify ... */listProperties.length// The following shouldn't create a runtime dependence on ldap package.// if clazz is null then applet cannot be an Applet.// system/applet properties// Merge property values from env param, applet params, and system// properties.  The first value wins:  there's no concatenation of// colon-separated lists.// Read system properties by first trying System.getProperties(),// and then trying System.getProperty() if that fails.  The former// is more efficient due to fewer permission checks.// Read system property.// Return without merging if application resource files lookup// is disabled.// Merge the above with the values read from all application// resource files.  Colon-separated lists are concatenated.// no classes specified; return null// Cache is based on context class loader and property val// Cached list// Populate list with classes named in facProp; skipping// those that we cannot load// System.out.println("loading");// ignore ClassNotFoundException, IllegalArgumentException// System.out.println("adding to cache: " + factories);// Merge property with provider property and supplied default// Cache factory based on context class loader, class name, and// property val// check if weak ref has been cleared// Not cached; find first factory and cache// System.out.println("loading " + className);// ignore ClassNotFoundException, IllegalArgumentException,// etc.// Cache it.// Merge in properties from file in <java.home>/lib./** VersionHelper was used by JNDI to accommodate differences between ... */Context.DNS_URLnew VersionHelper12(...)...[] PROPS;int INITIAL_CONTEXT_FACTORY;int OBJECT_FACTORIES;int URL_PKG_PREFIXES;int STATE_FACTORIES;int PROVIDER_URL;int DNS_URL;int CONTROL_FACTORIES;/* Returns a JNDI property from the system properties.  Returns ... *//* Reads each property in PROPS from the system properties, and ... *//* Returns the resource of a given name associated with a particular ... *//* Returns an input stream for a file in <java.home>/lib, ... *//* Returns an enumeration (never null) of InputStreams of the ... *//* Returns the context class loader associated with the current thread. ... */String[] url// Parse codebase into separate URLs/** Package private. ... */Properties sysPropsString[] jPropsPROPS.lengthString javahomeString pathnameEnumeration<URL> urlsgetSystemResources(...)new InputStreamEnumeration(...)/** Given an enumeration of URLs, an instance of this class represents ... */Enumeration<URL> urls;InputStream nextElement;this.urls/* Returns the next InputStream, or null if there are no more. ... */getNextElement(...)InputStream res// Don't use bootstrap class loader directly!// skip this URL/** Authenticator represents an implementation of an HTTP authentication ... *//** Base class for return type from authenticate() method *//** Indicates an authentication failure. The authentication ... */int responseCode;this.responseCode/** returns the response code to send to the client *//** Indicates an authentication has succeeded and the ... */HttpPrincipal principal;/** returns the authenticated user Principal *//** Indicates an authentication must be retried. The ... *//** called to authenticate each incoming request. The implementation ... *//* Copyright (c) 2006, 2013, Oracle and/or its affiliates. All rights reserved. ... */import Base64/** BasicAuthenticator provides an implementation of HTTP Basic ... */String realm;/** Creates a BasicAuthenticator for the given HTTP realm ... */this.realm/** returns the realm this BasicAuthenticator was created with ... */Headers rmapgetRequestHeaders(...)String authgetFirst(...)getDecoder(...)String userpassString unameString passHeaders mapgetResponseHeaders(...)new Retry(...)Authenticator.Retrynew Failure(...)Authenticator.FailurecheckCredentials(...)new Success(...)Authenticator.Successnew HttpPrincipal(...)/** called for each incoming request to verify the ... *//* look for auth token *//* reject the request again with 401 *//** A filter used to pre- and post-process incoming requests. Pre-processing occurs ... *//** a chain of filters associated with a HttpServer. ... */ListIterator<Filter> iter;/* the last element in the chain must invoke the users ... */HttpHandler handler;/** calls the next filter in the chain, or else ... */Filter fdoFilter(...)/** Asks this filter to pre/post-process the given exchange. The filter ... *//** returns a short description of this Filter ... *//** HTTP request and response headers are represented by this class which implements ... */HashMap<String,List<String>> map;new HashMap<String,List<String>>(...)/* Normalize the key by converting to following form. ... */char[] b/** returns the first value from the List of String values ... */List<String> l/** adds the given value to the list of headers ... */String k/** sets the given value as the sole header value ... */LinkedList<String> lMap<>.Entry<String,List<String>>/** HttpContext represents a mapping between the root URI path of an application ... *//** returns the handler for this context ... *//** Sets the handler for this context, if not already set. ... *//** returns the path this context was created with ... *//** returns the server this context was created with ... *//** returns a mutable Map, which can be used to pass ... *//** returns this context's list of Filters. This is the ... *//** Sets the Authenticator for this HttpContext. Once an authenticator ... *//** Returns the currently set Authenticator for this context ... */import java.nio.channels.*import javax.net.ssl.*import MessageHeader/** This class encapsulates a HTTP request received and a ... *//** Returns an immutable Map containing the HTTP headers that were ... *//** Returns a mutable Map into which the HTTP response headers can be stored ... *//** Get the request URI ... *//** Get the request method ... *//** Get the HttpContext for this exchange ... *//** Ends this exchange by doing the following in sequence:<p><ol> ... *//** returns a stream from which the request body can be read. ... *//** returns a stream to which the response body must be ... *//** Starts sending the response back to the client using the current set of response headers ... *//** Returns the address of the remote entity invoking this request ... *//** Returns the response code, if it has already been set ... *//** Returns the local address on which the request was received ... *//** Returns the protocol string from the request in the form ... *//** Filter modules may store arbitrary objects with HttpExchange ... *//** Used by Filters to wrap either (or both) of this exchange's InputStream ... *//** If an authenticator is set on the HttpContext that owns this exchange, ... *//** A handler which is invoked to process HTTP exchanges. Each ... *//** Handle the given request and generate an appropriate response. ... *//** Represents a user authenticated by HTTP Basic or Digest ... */String username, ...;/** creates a HttpPrincipal from the given username and realm ... *//** Compares two HttpPrincipal. Returns <code>true</code> ... */HttpPrincipal theothertheother.usernametheother.realm/** returns the contents of this principal in the form ... *//** returns the username this object was created with. *//** returns the realm this object was created with. *//** returns a hashcode for this HttpPrincipal. This is calculated ... *//** returns the same string as getName() */import java.util.concurrent.*import HttpServerProvider/** This class implements a simple HTTP server. A HttpServer is bound to an IP address ... *//** creates a HttpServer instance which is initially not bound to any local address/port. ... *//** Create a <code>HttpServer</code> instance which will bind to the ... */HttpServerProvider providerprovider(...)createHttpServer(...)/** Binds a currently unbound HttpServer to the given address and port number. ... *//** Starts this server in a new background thread. The background thread ... *//** sets this server's {@link java.util.concurrent.Executor} object. An ... *//** returns this server's Executor object if one was specified with ... *//** stops this server by closing the listening socket and disallowing ... *//** Creates a HttpContext. A HttpContext represents a mapping from a ... *//** Creates a HttpContext without initially specifying a handler. The handler must later be specified using ... *//** Removes the context identified by the given path from the server. ... *//** Removes the given context from the server. ... *//** returns the address this server is listening on ... *//** This class is used to configure the https parameters for each incoming ... */SSLContext context;/** Creates an Https configuration, with the given SSLContext. ... *//** Returns the SSLContext for this HttpsConfigurator. ... *//** Called by the HttpsServer to configure the parameters ... *///BEGIN_TIGER_EXCLUDEsetSSLParameters(...)getDefaultSSLParameters(...)getSSLContext(...)//END_TIGER_EXCLUDE/** This class encapsulates a HTTPS request received and a ... *//** Get the SSLSession for this exchange. ... */import InetSocketAddressimport SSLParameters/** Represents the set of parameters for each https ... */...[] cipherSuites;...[] protocols;boolean wantClientAuth;boolean needClientAuth;/** Returns the HttpsConfigurator for this HttpsParameters. *//** Returns the address of the remote client initiating the ... *//** Sets the SSLParameters to use for this HttpsParameters. ... *//** Returns a copy of the array of ciphersuites or null if none ... *//** Sets the array of ciphersuites. ... */this.cipherSuites/** Returns a copy of the array of protocols or null if none ... *//** Sets the array of protocols. ... */this.protocols/** Returns whether client authentication should be requested. ... *//** Sets whether client authentication should be requested. Calling ... */this.wantClientAuth/** Returns whether client authentication should be required. ... *//** Sets whether client authentication should be required. Calling ... */this.needClientAuthimport com.sun.net.httpserver.spi.*/** This class is an extension of {@link HttpServer} which provides ... *//** creates a HttpsServer instance which is initially not bound to any local address/port. ... *//** Create a <code>HttpsServer</code> instance which will bind to the ... */createHttpsServer(...)/** Sets this server's {@link HttpsConfigurator} object. ... *//** Gets this server's {@link HttpsConfigurator} object, if it has been set. ... *//** Provides a simple high-level Http server API, which can be used to build ... */import ServiceConfigurationErrorimport com.sun.net.httpserver.*/** Service provider class for HttpServer. ... *//** creates a HttpServer from this provider ... *//** creates a HttpsServer from this provider ... */HttpServerProvider provider;/** Initializes a new instance of this class. ... */new RuntimePermission(...)String cnnew ServiceConfigurationError(...)Iterator<HttpServerProvider> iServiceConfigurationError sce/** Returns the system wide default HttpServerProvider for this invocation of ... */loadProviderFromProperty(...)loadProviderAsService(...)new DefaultHttpServerProvider(...)// Ignore the security exception, try the next provider/** Provides a pluggable service provider interface, which allows the HTTP server ... *//** HostnameVerifier provides a callback mechanism so that ... *//** Verify that the hostname from the URL is an acceptable ... *//* NOTE:  this file was copied from javax.net.ssl.HostnameVerifier */import HttpURLConnection/** HTTP URL connection with support for HTTPS-specific features. See ... */getDefaultSSLSocketFactory(...)/* Initialize an HTTPS URLConnection ... could check that the URL ... *//** Returns the cipher suite in use on this connection. ... *//** Returns the server's X.509 certificate chain, or null if ... */HostnameVerifier defaultHostnameVerifier;HostnameVerifier hostnameVerifier;/** Sets the default HostnameVerifier inherited when an instance ... */new SSLPermission(...)/** Gets the default HostnameVerifier. ... *//** Sets the HostnameVerifier. ... *//** Gets the HostnameVerifier. ... */SSLSocketFactory defaultSSLSocketFactory;SSLSocketFactory sslSocketFactory;/** Sets the default SSL socket factory inherited when an instance ... */checkSetFactory(...)/** Gets the default SSL socket factory. ... *//** Sets the SSL socket factory. ... *//** Gets the SSL socket factory. ... *//* NOTE:  this file was copied from javax.net.ssl.HttpsURLConnection *//** Base interface for JSSE key managers. These manage the ... *//* NOTE:  this file was copied from javax.net.ssl.KeyManager *//** This class acts as a factory for key managers based on a ... */Provider provider;// The providerKeyManagerFactorySpi factorySpi;// The provider implementation (delegate)String algorithm;// The name of the key management algorithm./** <p>The default KeyManager can be changed by setting the value of the ... *//** Creates a KeyManagerFactory object. ... */this.factorySpithis.providerthis.algorithm/** Returns the algorithm name of this <code>KeyManagerFactory</code> object. ... *//** Generates a <code>KeyManagerFactory</code> object that implements the ... */Object[] objsgetImpl(...)new KeyManagerFactory(...)NoSuchProviderException e/** Generates a <code>KeyManagerFactory</code> object for the specified ... *//** Returns the provider of this <code>KeyManagerFactory</code> object. ... *//** Initializes this factory with a source of key material. The ... *//** Returns one key manager for each type of key material. ... */engineGetKeyManagers(...)/* NOTE:  this file was copied from javax.net.ssl.KeyManagerFactory *//** This class defines the <i>Service Provider Interface</i> (<b>SPI</b>) ... *//** Returns one trust manager for each type of trust material. ... *//* NOTE:  this file was copied from javax.net.ssl.KeyManagerFactorySpi */import SSLSocketFactoryImplimport SSLServerSocketFactoryImpl/** Instances of this class represent a secure socket protocol ... */SSLContextSpi contextSpi;/** Creates an SSLContext object. ... */this.contextSpi/** Generates a <code>SSLContext</code> object that implements the ... */new SSLContext(...)/** Returns the protocol name of this <code>SSLContext</code> object. ... *//** Returns the provider of this <code>SSLContext</code> object. ... *//** Initializes this context. Either of the first two parameters ... *//** Returns a <code>SocketFactory</code> object for this ... */engineGetSocketFactory(...)/** Returns a <code>ServerSocketFactory</code> object for ... */engineGetServerSocketFactory(...)/* NOTE:  this file was copied from javax.net.ssl.SSLContext *//** Initializes this context. ... *//* NOTE:  this file was copied from javax.net.ssl.SSLContextSpi */import SecurityManager/** This class is for various network permissions. ... *//** Creates a new SSLPermission with the specified name. ... *//** Creates a new SSLPermission object with the specified name. ... *//* NOTE:  this file was copied from javax.net.ssl.SSLPermission */import Serviceimport sun.security.jca.*/** This class instantiates implementations of JSSE engine classes from ... *//* Don't let anyone instantiate this. */// ProviderList.getService() is not accessible now, implement our own loopProviderList listProvider pproviders(...)Service s/** The body of the driver for the getImpl method. */Provider providergetProvider(...)Class<?> implClassClass<?> typeClassJavaxClass<?> typeClassComcheckSuperclass(...)new SSLContextSpiWrapper(...)new TrustManagerFactorySpiWrapper(...)new KeyManagerFactorySpiWrapper(...)IllegalStateException exc/** Returns an array of objects: the first object in the array is ... */Service serviceProvider provnew NoSuchProviderException(...)getImpl1(...)/* Checks whether one class is the superclass of another *//* Return at most the first "resize" elements of an array. ... */newArray.length/* ================================================================= ... */SSLContext theSSLContext;KeyManager[] kmawTrustManager[] tmawnew KeyManager[]kma.lengthnew X509KeyManagerJavaxWrapper(...)truncateArray(...)new TrustManager[]tma.lengthnew X509TrustManagerJavaxWrapper(...)getSocketFactory(...)getServerSocketFactory(...)TrustManagerFactory theTrustManagerFactory;TrustManager[] tmagetTrustManagers(...)new X509TrustManagerComSunWrapper(...)KeyManagerFactory theKeyManagerFactory;KeyManager[] kmagetKeyManagers(...)new X509KeyManagerComSunWrapper(...)// =================================X509KeyManager theX509KeyManager;getClientAliases(...)String retvalkeyTypes.lengthchooseClientAlias(...)/* JSSE 1.0.x was only socket based, but it's possible someone might ... */getServerAliases(...)chooseServerAlias(...)getCertificateChain(...)getPrivateKey(...)X509TrustManager theX509TrustManager;isClientTrusted(...)new CertificateException(...)isServerTrusted(...)getAcceptedIssuers(...)String[] keyTypescheckClientTrusted(...)checkServerTrusted(...)/* NOTE:  this file was copied from javax.net.ssl.SSLSecurity, ... */// system class/* JSSE 1.0, 1.0.1, and 1.0.2 used the com.sun.net.ssl API as the ... */// catch instantiation errors/* (The following Class.forName()s should alway work, because ... *//* Odds are more likely that we have a javax variant, try this ... *//* We should throw an error if we get ... */// Keep track of the actual number of array elements copied// Convert com.sun.net.ssl.kma to a javax.net.ssl.kma// wrapper if need be./* These key managers may implement both javax ... *//* Do we know how to convert them?  If not, oh well... ... */// We can convert directly, since they implement./* If dst != src, there were more items in the original array ... */// Now do the same thing with the TrustManagers./* These key managers may implement both...see above... */// Do we know how to convert them?// We only know how to wrap X509TrustManagers, as// TrustManagers don't have any methods to wrap.// We only know how to wrap X509KeyManagers, as// KeyManagers don't have any methods to wrap./* Scan the list, look for something we can pass back. *//** Base interface for JSSE trust managers which manage ... *//* NOTE:  this file was copied from javax.net.ssl.TrustManager *//** This class acts as a factory for trust managers based on a ... */TrustManagerFactorySpi factorySpi;// The name of the trust management algorithm./** <p>The default TrustManager can be changed by setting the value of the ... *//** Creates a TrustManagerFactory object. ... *//** Returns the algorithm name of this <code>TrustManagerFactory</code> ... *//** Generates a <code>TrustManagerFactory</code> object that implements the ... */new TrustManagerFactory(...)/** Generates a <code>TrustManagerFactory</code> object for the specified ... *//** Returns the provider of this <code>TrustManagerFactory</code> object. ... *//** Initializes this factory with a source of certificate ... */engineGetTrustManagers(...)/* NOTE:  this file was copied from javax.net.ssl.TrustManagerFactory *//* NOTE:  this file was copied from javax.net.ssl.TrustManagerFactorySpi */import KeyManagementException/** Instances of this interface manage which X509 certificate-based ... *//** Get the matching aliases for authenticating the client side of a secure ... *//** Choose an alias to authenticate the client side of a secure ... *//** Get the matching aliases for authenticating the server side of a secure ... *//** Choose an alias to authenticate the server side of a secure ... *//* Returns the key associated with the given alias. ... *//* NOTE:  this file was copied from javax.net.ssl.X509KeyManager *//** Instance of this interface manage which X509 certificates ... *//** Given the partial or complete certificate chain ... *//** Return an array of certificate authority certificates ... *//* NOTE:  this file was copied from javax.net.ssl.X509TrustManager */import SunJSSE/** Main class for the SunJSSE provider. The actual code was moved to the ... */// standard constructor// preferred constructor to enable FIPS mode at runtime// constructor to enable FIPS mode from java.security file// public for now, but we may want to change it or not document it.isFIPS(...)/** Installs the JSSE provider. *//* nop. Remove this method in the future. */import X509TrustManager/** Instance of this class is an extension of <code>X509TrustManager</code>. ... *//** Constructor used by subclasses only. *//** Given the partial or complete certificate chain provided by the ... */import java.security.cert.*import X500Principalimport DerValueimport X500Nameimport AbstractDelegateHttpsURLConnection/** This class was introduced to provide an additional level of ... */HttpsURLConnection httpsURLConnection;// instead of AbstractDelegateHttpsURLConnection// second parameter needs to be cast to javax.net.ssl.HttpsURLConnection// this is for ResponseCache.put(URI, URLConnection)// from sun.net.www.protocol.http.HttpURLConnection// we also need it to be public so that it can be referenced// the properties set there// we need a reference to the HttpsURLConnection to getthis.httpsURLConnectiongetSSLSocketFactory(...)new VerifierWrapper(...)getHostnameVerifier(...)/* Called by layered delegator's finalize() method to handle closing ... *//* In com.sun.net.ssl.HostnameVerifier the method is defined ... */String serverNamegetServerName(...)Certificate[] serverChainX509Certificate serverCertserverChain.lengthgetServername(...)/* Extract the name of the SSL server from the certificate. ... */Collection<List<?>> subjAltNamesgetSubjectAlternativeNames(...)X500Name subjectgetSubjectX500Name(...)DerValue derValuefindMostSpecificAttribute(...)X500Name.commonName_oidIterator<List<?>> itrList<?> nextString dnsNamegetAsString(...)// note: getHostnameVerifier() never returns null// if the provider does not support it, return null, since// compare to subjectAltNames if dnsName is present// compare dNSName with host in url// else check against common name in the subject field/** This class exists for compatibility with previous JSSE releases ... */openConnection(...)new HttpsURLConnectionOldImpl(...)/* Copyright (c) 1996, 2003, Oracle and/or its affiliates. All rights reserved. ... */import ProtocolExceptionimport HttpClient//      extends javax.net.ssl.HttpsURLConnection {// public class HttpsURLConnectionImpl// For both copies of the file, uncomment one line and comment the other/** A class to represent an HTTP connection to a remote object. ... */DelegateHttpsURLConnection delegate;//    HttpsURLConnectionImpl(URL u, Handler handler) throws IOException {new DelegateHttpsURLConnection(...)/** Create a new HttpClient object, bypassing the cache of ... */setNewClient(...)/** Obtain a HttpClient object. Use the cached copy if specified. ... *//** Create a new HttpClient object, set up so that it uses ... */setProxiedClient(...)/** Obtain a HttpClient object, set up so that it uses per-instance ... *//** Implements the HTTP protocol handler's "connect" method, ... *//** Used by subclass to access "connected" variable.  Since we are ... */isConnected(...)setConnected(...)/** Returns the cipher suite in use on this connection. *//** Returns the certificate chain the client sent to the ... */getLocalCertificates(...)/** Returns the server's certificate chain, or throws ... */getServerCertificates(...)getServerCertificateChain(...)/* Allowable input/output sequences: ... */getErrorStream(...)/** Disconnect from the server. */usingProxy(...)/** Returns an unmodifiable Map of the header fields. ... */getHeaderFields(...)/** Gets a header field by name. Returns null if not known. ... */getHeaderField(...)/** Gets a header field by index. Returns null if not known. ... */getHeaderFieldKey(...)/** Sets request property. If a property with the key already ... */setRequestProperty(...)/** Adds a general request property specified by a ... */addRequestProperty(...)/** Overwrite super class method */getResponseCode(...)getRequestProperty(...)/** Returns an unmodifiable Map of general request ... */getRequestProperties(...)/* We support JDK 1.2.x so we can't count on these from JDK 1.3. ... */setInstanceFollowRedirects(...)getInstanceFollowRedirects(...)setRequestMethod(...)getRequestMethod(...)getResponseMessage(...)getHeaderFieldDate(...)getPermission(...)getContentLength(...)getContentLengthLong(...)getContentType(...)getContentEncoding(...)getExpiration(...)getDate(...)getLastModified(...)getHeaderFieldInt(...)getHeaderFieldLong(...)setDoInput(...)getDoInput(...)setDoOutput(...)getDoOutput(...)setAllowUserInteraction(...)getAllowUserInteraction(...)setUseCaches(...)getUseCaches(...)setIfModifiedSince(...)getIfModifiedSince(...)getDefaultUseCaches(...)setDefaultUseCaches(...)/* finalize (dispose) the delegated object.  Otherwise ... */getConnectTimeout(...)getReadTimeout(...)setFixedLengthStreamingMode(...)setChunkedStreamingMode(...)/* NOTE: This class lives in the package sun.net.www.protocol.https. ... */// package sun.net.www.protocol.https;// this method does not throw an exception as declared in// com.sun.net.ssl.HttpsURLConnection.// Return null for compatibility.import CopyOption/** Defines <em>extended</em> copy options supported on some platforms ... */new ExtendedCopyOption(...)ExtendedCopyOption INTERRUPTIBLE;/** The copy may be interrupted by the {@link Thread#interrupt interrupt} ... *//* Copyright (c) 2007, 2009, Oracle and/or its affiliates. All rights reserved. ... */import OpenOption/** Defines <em>extended</em> open options supported on some platforms ... */new ExtendedOpenOption(...)ExtendedOpenOption NOSHARE_READ;/** Prevent operations on the file that request read access. */ExtendedOpenOption NOSHARE_WRITE;/** Prevent operations on the file that request write access. */ExtendedOpenOption NOSHARE_DELETE;/** Prevent operations on the file that request delete access. *//** Defines <em>extended</em> watch event modifiers supported on some platforms ... */new ExtendedWatchEventModifier(...)ExtendedWatchEventModifier FILE_TREE;/** Register a file tree instead of a single directory. *//** Defines the <em>sensitivity levels</em> when registering objects with a ... */new SensitivityWatchEventModifier(...)SensitivityWatchEventModifier HIGH;/** High sensitivity. */SensitivityWatchEventModifier MEDIUM;/** Medium sensitivity. */SensitivityWatchEventModifier LOW;/** Low sensitivity. *//** Returns the sensitivity in seconds. */int sensitivity;this.sensitivity/** A skeletal handler that consumes notifications and continues. ... *//** Initializes a new instance of this class. *//** Invoked when an implementation specific notification is received from the ... */HandlerResult.CONTINUE/** Invoked when an {@link AssociationChangeNotification} is received from ... *//** Invoked when an {@link PeerAddressChangeNotification} is received from ... *//** Invoked when an {@link SendFailedNotification} is received from ... *//** Invoked when an {@link ShutdownNotification} is received from ... *//** A class that represents an SCTP association. ... */int associationID;int maxInStreams;int maxOutStreams;this.associationIDthis.maxInStreamsthis.maxOutStreams/** Returns the associationID. ... *//** Returns the maximum number of inbound streams that this association ... *//** Returns the maximum number of outbound streams that this association ... *//** Notification emitted when an association has either opened or closed. ... *//** Defines the type of change event that happened to the association. ... */new AssocChangeEvent(...)AssocChangeEvent COMM_UP;/** A new association is now ready and data may be exchanged with this peer. */AssocChangeEvent COMM_LOST;/** The association has failed. A series of SCTP send failed notifications ... */AssocChangeEvent RESTART;/** SCTP has detected that the peer has restarted. */AssocChangeEvent SHUTDOWN;/** The association has gracefully closed. */AssocChangeEvent CANT_START;/** The association failed to setup. If a message was sent on a {@link ... *//** Returns the association that this notification is applicable to. ... *//** Returns the type of change event. ... *//** Defines notification handler results. ... */new HandlerResult(...)HandlerResult CONTINUE;/** Try to receieve another message or notification. */HandlerResult RETURN;/** Return without trying to receive any more data. *//** Unchecked exception thrown when an attempt is made to invoke the ... *//** Constructs an instance of this class with the specified message. ... *//** Unchecked exception thrown when an attempt is made to remove an ... *//** Constructs an instance of this class with the specified detailed message. ... *//** Unchecked exception thrown when an attempt is made to send a ... */import SocketAddress/** The {@code MessageInfo} class provides additional ancillary information about ... *//** Creates a {@code MessageInfo} instance suitable for use when ... */new MessageInfoImpl(...)/** Returns the source socket address if the message has been received, ... *//** Returns the association that the message was received on, if the message ... *//** Returns the number of bytes read for the received message. ... *//** Tells whether or not the message is complete. ... *//** Sets whether or not the message is complete. ... *//** Tells whether or not the message is unordered. For received messages ... *//** Sets whether or not the message is unordered. ... *//** Returns the payload protocol Identifier. ... *//** Sets the payload protocol Identifier. ... *//** Returns the stream number that the message was received on, if the ... *//** Sets the stream number that the message is to be sent on. ... *//** The time period that the sending side may expire the message if it has ... *//** Sets the time period that the sending side may expire the message if it ... *//** A notification from the SCTP stack. ... *//** A handler for consuming notifications from the SCTP stack. ... *//** Invoked when a notification is received from the SCTP stack. ... *//** Notification emitted when a destination address on a multi-homed peer ... *//** Defines the type of address change event that occurred to the destination ... */new AddressChangeEvent(...)AddressChangeEvent ADDR_AVAILABLE;/** This address is now reachable. */AddressChangeEvent ADDR_UNREACHABLE;/** The address specified can no longer be reached. Any data sent to this ... */AddressChangeEvent ADDR_REMOVED;/** The address is no longer part of the association. */AddressChangeEvent ADDR_ADDED;/** The address is now part of the association. */AddressChangeEvent ADDR_MADE_PRIMARY;/** This address has now been made to be the primary destination address. */AddressChangeEvent ADDR_CONFIRMED;/** This address has now been confirmed as a valid address. *//** Returns the peer address. ... */import AbstractSelectableChannelimport SelectorProviderimport ClosedChannelExceptionimport SelectionKey/** A selectable channel for message-oriented connected SCTP sockets. ... *//** Opens an SCTP channel. ... */new SctpChannelImpl(...)/** Opens an SCTP channel and connects it to a remote address. ... */SctpChannel ssc/** Returns the association on this channel's socket. ... *//** Binds the channel's socket to a local address. ... *//** Adds the given address to the bound addresses for the channel's ... *//** Removes the given address from the bound addresses for the channel's ... *//** Connects this channel's socket. ... *//** Tells whether or not a connection operation is in progress on this channel. ... *//** Finishes the process of connecting an SCTP channel. ... *//** Returns all of the socket addresses to which this channel's socket is ... *//** Returns all of the remote addresses to which this channel's socket ... *//** Shutdown a connection without closing the channel. ... *//** Returns the value of a socket option. ... *//** Sets the value of a socket option. ... *//** Returns a set of the socket options supported by this channel. ... *//** Returns an operation set identifying this channel's supported operations. ... */SelectionKey.OP_CONNECTSelectionKey.OP_READSelectionKey.OP_WRITE/** Receives a message into the given buffer and/or handles a notification. ... *//** Sends a message via this channel. ... */import NotYetBoundException/** A selectable channel for message-oriented SCTP sockets. ... *//** Opens an SCTP multi channel. ... */new SctpMultiChannelImpl(...)/** Returns the open associations on this channel's socket. ... *//** Binds the channel's socket to a local address and configures the socket ... *//** Returns all of the remote addresses to which the given association on ... *//** Shutdown an association without closing the channel. ... *//** Receives a message and/or handles a notification via this channel. ... *//** Branches off an association. ... *//** A selectable channel for message-oriented listening SCTP sockets. ... *//** Opens an SCTP server channel. ... */new SctpServerChannelImpl(...)/** Accepts an association on this channel's socket. ... *//** Returns an operation set identifying this channel's supported ... */SelectionKey.OP_ACCEPT/** A socket option associated with an SCTP channel. ... */import SctpStdSocketOption/** SCTP channels supports the socket options defined by this class ... */new SctpStdSocketOption<Boolean>(...)SctpStdSocketOption<>.SCTP_DISABLE_FRAGMENTSSctpStdSocketOption<>.SCTP_EXPLICIT_COMPLETEnew SctpStdSocketOption<Integer>(...)SctpStdSocketOption<>.SCTP_FRAGMENT_INTERLEAVEnew SctpStdSocketOption<InitMaxStreams>(...)SctpStandardSocketOptions.InitMaxStreams.classSctpStandardSocketOptions.InitMaxStreamsSctpStdSocketOption<>.SCTP_NODELAYnew SctpStdSocketOption<SocketAddress>(...)SctpStdSocketOption<>.SO_SNDBUFSctpStdSocketOption<>.SO_RCVBUFSctpStdSocketOption<>.SO_LINGERSctpSocketOption<Boolean> SCTP_DISABLE_FRAGMENTS;/** Enables or disables message fragmentation. ... */SctpSocketOption<Boolean> SCTP_EXPLICIT_COMPLETE;/** Enables or disables explicit message completion. ... */SctpSocketOption<Integer> SCTP_FRAGMENT_INTERLEAVE;/** Fragmented interleave controls how the presentation of messages occur ... */SctpSocketOption<InitMaxStreams> SCTP_INIT_MAXSTREAMS;/** The maximum number of streams requested by the local endpoint during ... */SctpSocketOption<Boolean> SCTP_NODELAY;/** Enables or disables a Nagle-like algorithm. ... */SctpSocketOption<SocketAddress> SCTP_PRIMARY_ADDR;/** Requests that the local SCTP stack use the given peer address as ... */SctpSocketOption<SocketAddress> SCTP_SET_PEER_PRIMARY_ADDR;/** Requests that the peer mark the enclosed address as the association ... */SctpSocketOption<Integer> SO_SNDBUF;/** The size of the socket send buffer. ... */SctpSocketOption<Integer> SO_RCVBUF;/** The size of the socket receive buffer. ... */SctpSocketOption<Integer> SO_LINGER;/** Linger on close if data is present. ... *//** This class is used to set the maximum number of inbound/outbound streams ... *//** Creates an InitMaxStreams instance. ... */new InitMaxStreams(...)/** Returns the maximum number of inbound streams. ... *//** Returns the maximum number of outbound streams. ... *//** Returns a string representation of this init max streams, including ... *//** Returns true if the specified object is another {@code InitMaxStreams} ... */InitMaxStreams thatthat.maxInStreamsthat.maxOutStreams/** Returns a hash code value for this init max streams. *//** Notification emitted when a send failed notification has been received. ... *//** Returns the address. ... *//** Returns the data that was to be sent. ... *//** Returns the error code. ... *//** Returns the stream number that the messge was to be sent on. ... *//** Notification emitted when a peers shutdowns an the association. ... *//** A Java API for Stream Control Transport Protocol. ... */import XMLConstantsimport DocumentBuilderimport DocumentBuilderFactoryimport JCEMapperimport SignatureAlgorithmimport Canonicalizerimport XMLSecurityExceptionimport KeyResolverimport Transformimport ElementProxyimport I18nimport XMLUtilsimport ResourceResolverimport Attrimport Documentimport Element/** This class does the configuration of the library. This includes creating ... */String CONF_NS;/** The namespace for CONF file * */Logger log;/** {@link org.apache.commons.logging} logging facility */boolean alreadyInitialized;/** Field alreadyInitialized *//** Method isInitialized ... */Init.alreadyInitialized/** Method init */String cfiledynamicInit(...)fileInit(...)/** Dynamically initialise the library by registering the default algorithms/implementations */registerDefaultPrefixes(...)registerDefaultAlgorithms(...)registerDefaultResolvers(...)PrivilegedActionException exXMLSecurityException xse/** Initialise the library from a configuration file */DocumentBuilderFactory dbfDocumentBuilder dbNode configsetFeature(...)XMLConstants.FEATURE_SECURE_PROCESSINGsetNamespaceAware(...)setValidating(...)getLocalName(...)Node elString tagElement resourceAttr langAttrgetAttributeNode(...)Attr countryAttrString languageCodeString countryCodeElement[] listselectNodes(...)String urigetAttributeNS(...)String javaClassObject[] exArgsElement[] tranElemtranElem.lengthNoClassDefFoundError exNode algorithmsNodeElement[] algorithmsalgorithms.lengthElement elementnew Algorithm(...)JCEMapper.AlgorithmElement[] sigElemssigElems.lengthElement[] resolverElemresolverElem.lengthList<String> classNamesregisterClassNames(...)Element[] nlnl.lengthString namespacesetDefaultPrefix(...)/* reserved comment block ... *//** Licensed to the Apache Software Foundation (ASF) under one ... */// Load the Resource Bundle - the default is the English resource bundle.// To load another resource bundle, call I18n.init(...) before calling this// method.// Bind the default prefixes// Set the default Transforms// Set the default signature algorithms// Set the default JCE algorithms// Set the default c14n algorithms// Register the default resolvers// Register the default key resolvers/* read library configuration file *//* configure internationalization *//** $todo$ handle registering */import Constantsimport SignatureElementProxy/** The Algorithm class which stores the Algorithm URI as a string. */setAlgorithmURI(...)/** Constructor Algorithm ... *//** Method getAlgorithmURI ... */this.constructionElementConstants._ATT_ALGORITHM/** Sets the algorithm's URI as used in the signature. ... */setAttributeNS(...)// changes to utils.ClassLoaderUtils to this file.// modifiers changed to package-private. Make sure to integrate any future// NOTE! This is a duplicate of utils.ClassLoaderUtils with public/** This class is extremely useful for loading resources and classes in a fault ... *//** Load a given resource. <p/> This method will try to load the resource ... */ClassLoader cluClassloader/** Load a given resources. <p/> This method will try to load the resources ... */List<URL> retnew ArrayList<URL>(...)/** This is a convenience method to load a resource as a stream. <p/> The ... *//** Load a class with a given name. <p/> It will try to load the class in the ... */loadClass2(...)ClassNotFoundException exClassNotFoundException exc//certain classloaders need it without the leading ///ignoreimport ConcurrentHashMapimport XMLCipherimport XMLSignatureimport JavaUtils/** This class maps algorithm identifier URIs to JAVA JCE class names. */new ConcurrentHashMap<String,Algorithm>(...)Map<String,Algorithm> algorithmsMap;String providerName;/** Method register ... */checkRegisterPermission(...)/** This method registers the default algorithms. */MessageDigestAlgorithm.ALGO_ID_DIGEST_NOT_RECOMMENDED_MD5MessageDigestAlgorithm.ALGO_ID_DIGEST_RIPEMD160MessageDigestAlgorithm.ALGO_ID_DIGEST_SHA1MessageDigestAlgorithm.ALGO_ID_DIGEST_SHA256MessageDigestAlgorithm.ALGO_ID_DIGEST_SHA384MessageDigestAlgorithm.ALGO_ID_DIGEST_SHA512XMLSignature.ALGO_ID_SIGNATURE_DSAXMLSignature.ALGO_ID_SIGNATURE_DSA_SHA256XMLSignature.ALGO_ID_SIGNATURE_NOT_RECOMMENDED_RSA_MD5XMLSignature.ALGO_ID_SIGNATURE_RSA_RIPEMD160XMLSignature.ALGO_ID_SIGNATURE_RSA_SHA1XMLSignature.ALGO_ID_SIGNATURE_RSA_SHA256XMLSignature.ALGO_ID_SIGNATURE_RSA_SHA384XMLSignature.ALGO_ID_SIGNATURE_RSA_SHA512XMLSignature.ALGO_ID_SIGNATURE_ECDSA_SHA1XMLSignature.ALGO_ID_SIGNATURE_ECDSA_SHA256XMLSignature.ALGO_ID_SIGNATURE_ECDSA_SHA384XMLSignature.ALGO_ID_SIGNATURE_ECDSA_SHA512XMLSignature.ALGO_ID_MAC_HMAC_NOT_RECOMMENDED_MD5XMLSignature.ALGO_ID_MAC_HMAC_RIPEMD160XMLSignature.ALGO_ID_MAC_HMAC_SHA1XMLSignature.ALGO_ID_MAC_HMAC_SHA256XMLSignature.ALGO_ID_MAC_HMAC_SHA384XMLSignature.ALGO_ID_MAC_HMAC_SHA512XMLCipher.TRIPLEDESXMLCipher.AES_128XMLCipher.AES_192XMLCipher.AES_256XMLCipher.AES_128_GCMXMLCipher.AES_192_GCMXMLCipher.AES_256_GCMXMLCipher.RSA_v1dot5XMLCipher.RSA_OAEPXMLCipher.RSA_OAEP_11XMLCipher.DIFFIE_HELLMANXMLCipher.TRIPLEDES_KeyWrapXMLCipher.AES_128_KeyWrapXMLCipher.AES_192_KeyWrapXMLCipher.AES_256_KeyWrap/** Method translateURItoJCEID ... */Algorithm algorithmalgorithm.jceName/** Method getAlgorithmClassFromURI ... */algorithm.algorithmClass/** Returns the keylength in bits for a particular algorithm. ... */algorithm.keyLength/** Method getJCEKeyAlgorithmFromURI ... */algorithm.requiredKey/** Gets the default Provider for obtaining the security algorithms ... *//** Sets the default Provider for obtaining the security algorithms ... *//** Represents the Algorithm xml element */String requiredKey;String jceName;String algorithmClass;/** Gets data from element ... */hasAttribute(...)this.requiredKeythis.jceNamethis.algorithmClassthis.keyLengthimport XMLSignatureExceptionimport EncryptionConstants/** Digest Message wrapper & selector class. ... */Constants.MoreAlgorithmsSpecNSConstants.SignatureSpecNSEncryptionConstants.EncryptionSpecNSString ALGO_ID_DIGEST_NOT_RECOMMENDED_MD5;/** Message Digest - NOT RECOMMENDED MD5 */String ALGO_ID_DIGEST_SHA1;/** Digest - Required SHA1 */String ALGO_ID_DIGEST_SHA256;/** Message Digest - RECOMMENDED SHA256 */String ALGO_ID_DIGEST_SHA384;/** Message Digest - OPTIONAL SHA384 */String ALGO_ID_DIGEST_SHA512;/** Message Digest - OPTIONAL SHA512 */String ALGO_ID_DIGEST_RIPEMD160;/** Message Digest - OPTIONAL RIPEMD-160 */MessageDigest algorithm;/** Field algorithm stores the actual {@link java.security.MessageDigest} *//** Constructor for the brave who pass their own message digest algorithms and the ... */getDigestInstance(...)/** Factory method for constructing a message digest algorithm by name. ... */new MessageDigestAlgorithm(...)String algorithmIDtranslateURItoJCEID(...)getProviderId(...)new XMLSignatureException(...)NoSuchProviderException ex/** Returns the actual {@link java.security.MessageDigest} algorithm object ... *//** Proxy method for {@link java.security.MessageDigest#isEqual} ... *//** Proxy method for {@link java.security.MessageDigest#digest()} ... *//** Proxy method for {@link java.security.MessageDigest#digest(byte[])} ... *//** Proxy method for {@link java.security.MessageDigest#digest(byte[], int, int)} ... *//** Proxy method for {@link java.security.MessageDigest#getAlgorithm} ... *//** Proxy method for {@link java.security.MessageDigest#getProvider} ... *//** Proxy method for {@link java.security.MessageDigest#getDigestLength} ... *//** Proxy method for {@link java.security.MessageDigest#reset} ... *//** Proxy method for {@link java.security.MessageDigest#update(byte[])} ... *//** Proxy method for {@link java.security.MessageDigest#update(byte)} ... *//** Proxy method for {@link java.security.MessageDigest#update(byte[], int, int)} ... */Constants._TAG_DIGESTMETHODimport IntegrityHmacimport SignatureBaseRSAimport SignatureDSAimport SignatureECDSAimport AlgorithmAlreadyRegisteredException/** Allows selection of digital signature's algorithm, private keys, other ... */new ConcurrentHashMap<String,Class<? extends SignatureAlgorithmSpi>>(...)Map<String,Class<? extends SignatureAlgorithmSpi>> algorithmHash;/** All available algorithm classes are registered here */SignatureAlgorithmSpi signatureAlgorithm;/** Field signatureAlgorithm */String algorithmURI;/** Constructor SignatureAlgorithm ... */this.algorithmURIgetSignatureAlgorithmSpi(...)engineGetContextFromElement(...)engineSetHMACOutputLength(...)engineAddContextToElement(...)Attr attrgetAttributeNodeNS(...)getURI(...)setIdAttributeNode(...)new XMLSecurityException(...)/** Get a SignatureAlgorithmSpi object corresponding to the algorithmURI argument */Class<? extends SignatureAlgorithmSpi> implementingClassIllegalAccessException exInstantiationException exNullPointerException ex/** Proxy method for {@link java.security.Signature#sign()} ... */engineSign(...)/** Proxy method for {@link java.security.Signature#getAlgorithm} ... */engineGetJCEAlgorithmString(...)/** Method getJCEProviderName ... */engineGetJCEProviderName(...)/** Proxy method for {@link java.security.Signature#update(byte[])} ... *//** Proxy method for {@link java.security.Signature#update(byte)} ... *//** Proxy method for {@link java.security.Signature#update(byte[], int, int)} ... *//** Proxy method for {@link java.security.Signature#initSign(java.security.PrivateKey)} ... */engineInitSign(...)/** Proxy method for {@link java.security.Signature#initSign(java.security.PrivateKey, ... *//** Proxy method for {@link java.security.Signature#setParameter( ... */engineSetParameter(...)/** Proxy method for {@link java.security.Signature#initVerify(java.security.PublicKey)} ... */engineInitVerify(...)/** Proxy method for {@link java.security.Signature#verify(byte[])} ... */engineVerify(...)/** Returns the URI representation of Transformation algorithm ... *//** Registers implementing class of the SignatureAlgorithm with algorithmURI ... */Class<? extends SignatureAlgorithmSpi> registeredClassnew AlgorithmAlreadyRegisteredException(...)Class<? extends SignatureAlgorithmSpi> clazz/** Registers implementing class of the Transform algorithm with algorithmURI ... */SignatureDSA.SHA256.classSignatureDSA.SHA256SignatureBaseRSA.SignatureRSASHA1.classSignatureBaseRSA.SignatureRSASHA1IntegrityHmac.IntegrityHmacSHA1.classIntegrityHmac.IntegrityHmacSHA1SignatureBaseRSA.SignatureRSAMD5.classSignatureBaseRSA.SignatureRSAMD5SignatureBaseRSA.SignatureRSARIPEMD160.classSignatureBaseRSA.SignatureRSARIPEMD160SignatureBaseRSA.SignatureRSASHA256.classSignatureBaseRSA.SignatureRSASHA256SignatureBaseRSA.SignatureRSASHA384.classSignatureBaseRSA.SignatureRSASHA384SignatureBaseRSA.SignatureRSASHA512.classSignatureBaseRSA.SignatureRSASHA512SignatureECDSA.SignatureECDSASHA1.classSignatureECDSA.SignatureECDSASHA1SignatureECDSA.SignatureECDSASHA256.classSignatureECDSA.SignatureECDSASHA256SignatureECDSA.SignatureECDSASHA384.classSignatureECDSA.SignatureECDSASHA384SignatureECDSA.SignatureECDSASHA512.classSignatureECDSA.SignatureECDSASHA512IntegrityHmac.IntegrityHmacMD5.classIntegrityHmac.IntegrityHmacMD5IntegrityHmac.IntegrityHmacRIPEMD160.classIntegrityHmac.IntegrityHmacRIPEMD160IntegrityHmac.IntegrityHmacSHA256.classIntegrityHmac.IntegrityHmacSHA256IntegrityHmac.IntegrityHmacSHA384.classIntegrityHmac.IntegrityHmacSHA384IntegrityHmac.IntegrityHmacSHA512.classIntegrityHmac.IntegrityHmacSHA512/** Method getBaseNamespace ... *//** Method getBaseLocalName ... */Constants._TAG_SIGNATUREMETHOD// are we already registered?/** Returns the URI representation of <code>Transformation algorithm</code> ... *//** Method engineGetJCEProviderName ... *//** Proxy method for {@link javax.crypto.Mac} ... *//** Method engineInitVerify ... *//** Method engineGetContextFromElement ... *//** Method engineSetHMACOutputLength ... */import MessageDigestAlgorithmimport SignatureAlgorithmSpiimport TextMac macAlgorithm;/** Field macAlgorithm */int HMACOutputLength;/** Field HMACOutputLength */boolean HMACOutputLengthSet;/** Method engineGetURI ... *//** Returns the output length of the hash/digest. *//** Method IntegrityHmac ... */engineGetURI(...)this.macAlgorithmthis.HMACOutputLengthSetthis.HMACOutputLengthbyte[] completeResultIllegalStateException exString suppliedString neededInvalidKeyException exMac mac/** Method engineInitSign ... *//** Method engineGetJCEAlgorithmString ... */Text hmaclengthselectDsNodeText(...)Constants._TAG_HMACOUTPUTLENGTH/** Method engineAddContextToElement ... */getOwnerDocument(...)Element HMElemcreateElementInSignatureSpace(...)Text HMTextcreateTextNode(...)addReturnToElement(...)/** Class IntegrityHmacSHA1 *//** Constructor IntegrityHmacSHA1 ... *//** Class IntegrityHmacSHA256 *//** Constructor IntegrityHmacSHA256 ... *//** Class IntegrityHmacSHA384 *//** Constructor IntegrityHmacSHA384 ... *//** Class IntegrityHmacSHA512 *//** Constructor IntegrityHmacSHA512 ... *//** Class IntegrityHmacRIPEMD160 *//** Constructor IntegrityHmacRIPEMD160 ... *//** Class IntegrityHmacMD5 *//** Constructor IntegrityHmacMD5 ... */// reinstantiate Mac object to work around bug in JDK// see: http://bugs.sun.com/view_bug.do?bug_id=4953555// this shouldn't occur, but if it does, restore previous Macimport Signatureimport SignatureExceptionSignature signatureAlgorithm;/** Field algorithm *//** Constructor SignatureRSA ... */this.signatureAlgorithmsetParameter(...)SignatureException exinitVerify(...)Signature sigsign(...)initSign(...)/** Class SignatureRSASHA1 *//** Constructor SignatureRSASHA1 ... *//** Class SignatureRSASHA256 *//** Constructor SignatureRSASHA256 ... *//** Class SignatureRSASHA384 *//** Constructor SignatureRSASHA384 ... *//** Class SignatureRSASHA512 *//** Constructor SignatureRSASHA512 ... *//** Class SignatureRSARIPEMD160 *//** Constructor SignatureRSARIPEMD160 ... *//** Class SignatureRSAMD5 *//** Constructor SignatureRSAMD5 ... */// reinstantiate Signature object to work around bug in JDK// this shouldn't occur, but if it does, restore previousimport DSAKey/** size of Q *//** Constructor SignatureDSA ... */byte[] jcebytesconvertDsaXMLDSIGtoASN1(...)getQ(...)convertDsaASN1toXMLDSIG(...)/** Converts an ASN.1 ECDSA value to a XML Signature ECDSA Value. ... */byte rLengthbyte sLengthint rawLenbyte[] xmldsigBytesasn1Bytes.length/** Converts a XML Signature ECDSA Value to an ASN.1 DSA value. ... */xmldsigBytes.lengthbyte[] asn1BytesconvertXMLDSIGtoASN1(...)convertASN1toXMLDSIG(...)/** Class SignatureRSASHA1 ... *//** Class SignatureRSASHA256 ... *//** Class SignatureRSASHA384 ... *//** Class SignatureRSASHA512 ... *//** Class CanonicalizationException ... *//** Constructor CanonicalizationException *//** Constructor CanonicalizationException ... */import Canonicalizer11_OmitCommentsimport Canonicalizer11_WithCommentsimport Canonicalizer20010315ExclOmitCommentsimport Canonicalizer20010315ExclWithCommentsimport Canonicalizer20010315OmitCommentsimport Canonicalizer20010315WithCommentsimport CanonicalizerPhysicalnew ConcurrentHashMap<String,Class<? extends CanonicalizerSpi>>(...)/** The output encoding of canonicalized data */String XPATH_C14N_WITH_COMMENTS_SINGLE_NODE;/** XPath Expression for selecting every node and continuous comments joined ... */String ALGO_ID_C14N_OMIT_COMMENTS;/** The URL defined in XML-SEC Rec for inclusive c14n <b>without</b> comments. */String ALGO_ID_C14N_WITH_COMMENTS;/** The URL defined in XML-SEC Rec for inclusive c14n <b>with</b> comments. */String ALGO_ID_C14N_EXCL_OMIT_COMMENTS;/** The URL defined in XML-SEC Rec for exclusive c14n <b>without</b> comments. */String ALGO_ID_C14N_EXCL_WITH_COMMENTS;/** The URL defined in XML-SEC Rec for exclusive c14n <b>with</b> comments. */String ALGO_ID_C14N11_OMIT_COMMENTS;/** The URI for inclusive c14n 1.1 <b>without</b> comments. */String ALGO_ID_C14N11_WITH_COMMENTS;/** The URI for inclusive c14n 1.1 <b>with</b> comments. */String ALGO_ID_C14N_PHYSICAL;/** Non-standard algorithm to serialize the physical representation for XML Encryption */Map<String,Class<? extends CanonicalizerSpi>> canonicalizerHash;CanonicalizerSpi canonicalizerSpi;/** Constructor Canonicalizer ... */Class<? extends CanonicalizerSpi> implementingClasscanonicalizerSpi.resetnew InvalidCanonicalizerException(...)/** Method getInstance ... */new Canonicalizer(...)Class<? extends CanonicalizerSpi> registeredClassCanonicalizer.ALGO_ID_C14N_OMIT_COMMENTSCanonicalizer.ALGO_ID_C14N_WITH_COMMENTSCanonicalizer.ALGO_ID_C14N_EXCL_OMIT_COMMENTSCanonicalizer.ALGO_ID_C14N_EXCL_WITH_COMMENTSCanonicalizer.ALGO_ID_C14N11_OMIT_COMMENTSCanonicalizer.ALGO_ID_C14N11_WITH_COMMENTSCanonicalizer.ALGO_ID_C14N_PHYSICAL/** Method getURI ... *//** Method getIncludeComments ... */engineGetIncludeComments(...)/** This method tries to canonicalize the given bytes. It's possible to even ... */InputSource inDocumentBuilderFactory dfactoryDocument documentsetErrorHandler(...)new IgnoreAllErrorHandler(...)canonicalizeSubtree(...)/** Canonicalizes the subtree rooted by <CODE>node</CODE>. ... */engineCanonicalizeSubTree(...)/** Canonicalizes an XPath node set. The <CODE>xpathNodeSet</CODE> is treated ... */engineCanonicalizeXPathNodeSet(...)/** Canonicalizes an XPath node set. ... *//** Sets the writer where the canonicalization ends.  ByteArrayOutputStream ... */setWriter(...)/** Returns the name of the implementing {@link CanonicalizerSpi} class ... *//** Set the canonicalizer behaviour to not reset. */// check whether URI is already registered// needs to validate for ID attribute normalization/* for some of the test vectors from the specification, ... *//** Base class which all Canonicalization algorithms extend. ... */boolean reset;/** Reset the writer after a c14n *//** Method canonicalize ... *//** Method engineCanonicalizeXPathNodeSet ... */convertNodelistToSet(...)/** Returns the URI of this engine. ... *//** Returns true if comments are included ... *//** C14n a nodeset ... *//** C14n a node tree. ... *//** Sets the writer where the canonicalization ends. ByteArrayOutputStream if ... *//** Constructor InvalidCanonicalizerException *//** Constructor InvalidCanonicalizerException ... *//** Compares two attributes based on the C14n specification. ... */Constants.NamespaceSpecNSint ATTR0_BEFORE_ATTR1;int ATTR1_BEFORE_ATTR0;String XMLNS;String namespaceURI0getNamespaceURI(...)String namespaceURI1boolean isNamespaceAttr0boolean isNamespaceAttr1String localname0String localname1String name0String name1// both are namespaces// attr0 is a namespace, attr1 is not// attr1 is a namespace, attr0 is not// none is a namespaceimport CanonicalizationException/** Temporary swapped static functions from the normalizer Section ... *//** Constructor C14nHelper *//** Method namespaceIsRelative ... */namespaceIsAbsolute(...)/** Method namespaceIsAbsolute ... *//** This method throws an exception if the Attribute value contains ... */String nodeAttrNameboolean definesDefaultNSboolean definesNonDefaultNSnamespaceIsRelative(...)String parentNamegetTagName(...)getOwnerElement(...)String attrValuenew CanonicalizationException(...)/** This method throws a CanonicalizationException if the supplied Document ... */getImplementation(...)/** This method throws a CanonicalizationException if the supplied Element ... */NamedNodeMap attributesassertNotRelativeNS(...)// don't allow instantiation// assume empty namespaces are absoluteimport URISyntaxExceptionimport C14nHelperimport XMLSignatureInput/** Implements <A HREF="http://www.w3.org/TR/2008/PR-xml-c14n11-20080129/"> ... */new TreeSet<Attr>(...)new XmlAttrStack(...)Constants.XML_LANG_SPACE_SpecNSString XMLNS_URI;String XML_LANG_URI;SortedSet<Attr> result;boolean firstCall;new ArrayList<XmlsStackElement>(...)new ArrayList<Attr>(...)boolean rendered;List<Attr> nodes;int currentLevel;int lastlevel;XmlsStackElement cur;List<XmlsStackElement> levels;(...).levelnew XmlsStackElement(...)cur.levelcur.nodesboolean parentRenderedXmlsStackElement eMap<String,Attr> loanew HashMap<String,Attr>(...)List<Attr> baseAttrsboolean successiveOmittede.renderede.levelcur.renderedIterator<Attr> ite.nodesAttr nAttr baseAttrjoinURI(...)URISyntaxException ueXmlAttrStack xmlattrStack;/** Constructor Canonicalizer11 ... *//** Always throws a CanonicalizationException because this is inclusive c14n. ... *//** Returns the Attr[]s to be output for the given element. ... */SortedSet<Attr> resultthis.resultint attrsLengthAttr attributeString NUriString NNameString NValueNode naddMappingAndRender(...)getUnrenderedNodes(...)getXmlnsAttr(...)boolean isRealVisibleisVisibleDO(...)getLevel(...)addXmlnsAttr(...)removeMappingIfRender(...)removeMapping(...)addMapping(...)Attr xmlnsgetNullNode(...)isNeedsToBeExpanded(...)getSubNode(...)getNodeSet(...)circumventBug2650(...)String NamecreateAttributeNS(...)String bschemeString bauthorityString bpathString bqueryURI rnew URI(...)String rschemeString rauthoritygetAuthority(...)String rpathString rqueryString tschemeString tauthorityString tpathString tqueryURI baseremoveDotSegments(...)String inputStringBuilder outputreplaceAll(...)printStep(...)replaceFirst(...)String segment// result will contain the attrs which have to be output// It's not a namespace attr node. Add to the result and continue.// The default mapping for xml must not be output.// Render the ns definition// It is the first node of the subtree// Obtain all the namespaces defined in the parents, and added to the output.// output the attributes in the xml namespace.//A non namespace definition node.// treat xml:id like any other attribute// (emit it, but don't inherit it)//The node is visible add the attribute to the list of output attributes./* except omit namespace node with local name xml, which defines ... */// add the prefix binding to the ns symb table.// The xpath select this node output it if needed.//The element is visible, handle the xmlns definition//No xmlns def just get the already defined.//There is a definition but the xmlns is not selected by the xpath.//then xmlns=""//output the xmlns def if needed.//Float all xml:* attributes of the unselected parent elements to this one.// pre-parse the baseURI// 1. The input buffer is initialized with the now-appended path// components then replace occurrences of "//" in the input buffer// with "/" until no more occurrences of "//" are in the input buffer.// Initialize the output buffer with the empty string.// If the input buffer starts with a root slash "/" then move this// character to the output buffer.// While the input buffer is not empty, loop as follows// 2A. If the input buffer begins with a prefix of "./",// then remove that prefix from the input buffer// else if the input buffer begins with a prefix of "../", then// if also the output does not contain the root slash "/" only,// then move this prefix to the end of the output buffer else// remove that prefix// 2B. if the input buffer begins with a prefix of "/./" or "/.",// where "." is a complete path segment, then replace that prefix// with "/" in the input buffer; otherwise,// FIXME: what is complete path segment?// 2C. if the input buffer begins with a prefix of "/../" or "/..",// where ".." is a complete path segment, then replace that prefix// with "/" in the input buffer and if also the output buffer is// empty, last segment in the output buffer equals "../" or "..",// where ".." is a complete path segment, then append ".." or "/.."// for the latter case respectively to the output buffer else// remove the last segment and its preceding "/" (if any) from the// output buffer and if hereby the first character in the output// buffer was removed and it was not the root slash then delete a// leading slash from the input buffer; otherwise,// 2D. if the input buffer consists only of ".", then remove// that from the input buffer else if the input buffer consists// only of ".." and if the output buffer does not contain only// the root slash "/", then move the ".." to the output buffer// else delte it.; otherwise,// 2E. move the first path segment (if any) in the input buffer// to the end of the output buffer, including the initial "/"// character (if any) and any subsequent characters up to, but not// including, the next "/" character or the end of the input buffer.// 3. Finally, if the only or last segment of the output buffer is// "..", where ".." is a complete path segment not followed by a slash// then append a slash "/". The output buffer is returned as the result// of remove_dot_segments/** Implements <A HREF="http://www.w3.org/TR/2001/REC-xml-c14n-20010315">Canonical ... *//** Constructor Canonicalizer20010315 ... *//** $todo$ well, should we throw UnsupportedOperationException ? *///It's not a namespace attr node. Add to the result and continue.//The default mapping for xml must not be output.//Render the ns definition//It is the first node of the subtree//Obtain all the namespaces defined in the parents, and added to the output.//output the attributes in the xml namespace.//add the prefix binding to the ns symb table.//The xpath select this node output it if needed.import InclusiveNamespaces/** Implements &quot; <A ... */SortedSet<String> inclusiveNSSet;/** This Set contains the names (Strings like "xmlns" or "xmlns:foo") of ... *//** Constructor Canonicalizer20010315Excl ... *//** Method engineCanonicalizeSubTree ... */prefixStr2Set(...)engineCanonicalize(...)SortedSet<String> visiblyUtilizedString NNodeValueAttr key/** @inheritDoc ... */Set<String> visiblyUtilizedboolean isOutputElementremoveMappingIfNotRender(...)// The prefix visibly utilized (in the attribute or in the name) in// the element// Not a namespace definition.// The Element is output element, add the prefix (if used) to// visiblyUtilized// Add to the result.// New definition check if it is relative.// It's the output selected.// The Element is output element, add the prefix (if used)// to visibyUtilized// New definition check if it is relative// The element is visible, handle the xmlns definition// There is a definition but the xmlns is not selected by the// xpath. then xmlns=""/** Class Canonicalizer20010315ExclWithComments *//** Constructor Canonicalizer20010315ExclWithComments *//** Constructor Canonicalizer20010315WithXPathOmitComments *//** Constructor Canonicalizer20010315WithXPathWithComments */import CanonicalizerSpiimport AttrCompareimport NodeFilterimport UnsyncByteArrayOutputStreamimport Commentimport ProcessingInstruction/** Abstract base class for canonicalization algorithms. ... */new AttrCompare(...)String XML;AttrCompare COMPARE;...[] END_PI;// potentially untrusted objects such as OutputStreams.// Make sure you clone the following mutable arrays before passing to...[] BEGIN_PI;...[] END_COMM;...[] BEGIN_COMM;...[] XA;...[] X9;...[] QUOT;...[] XD;...[] GT;...[] LT;...[] END_TAG;...[] AMP;...[] EQUALS_STR;int NODE_BEFORE_DOCUMENT_ELEMENT;int NODE_NOT_BEFORE_OR_AFTER_DOCUMENT_ELEMENT;int NODE_AFTER_DOCUMENT_ELEMENT;List<NodeFilter> nodeFilter;boolean includeComments;Set<Node> xpathNodeSet;Node excludeNode;/** The node to be skipped/excluded from the DOM tree ... */OutputStream writer;Attr nullNode;/** The null xmlns definition. *//** Constructor CanonicalizerBase ... */this.includeCommentsthis.xpathNodeSetengineCanonicalizeXPathNodeSetInternal(...)/** Canonicalizes a Subtree node. ... */isExcludeComments(...)isOctetStream(...)isElement(...)getExcludeNode(...)isNodeSet(...)getNodeFilters(...)circumventBugIfNeeded(...)CanonicalizationException ex/** @param */this.writerthis.excludeNodeNameSpaceSymbTable nsnew NameSpaceSymbTable(...)int nodeLevelgetParentNameSpaces(...)canonicalizeSubTree(...)UnsupportedEncodingException ex/** Method canonicalizeSubTree, this function is a recursive one. ... */Node siblingNode parentNodeOutputStream writerNode excludeNodeboolean includeCommentsMap<String,byte[]> cachenew HashMap<String,byte[]>(...)isVisibleInt(...)Element currentElementIterator<Attr> attrshandleAttributesSubtree(...)Node.ENTITY_NODENode.NOTATION_NODENode.ATTRIBUTE_NODENode.DOCUMENT_FRAGMENT_NODENode.DOCUMENT_NODEoutputNodePush(...)Node.COMMENT_NODEoutputCommentToWriter(...)Node.PROCESSING_INSTRUCTION_NODEoutputPItoWriter(...)Node.TEXT_NODENode.CDATA_SECTION_NODEoutputTextToWriter(...)outputAttrToWriter(...)writeStringToUtf8(...)outputNodePop(...)Node.DOCUMENT_TYPE_NODEcanonicalizeXPathNodeSet(...)byte[] sol/** Canonicalizes all the nodes included in the currentNode and contained in the ... */boolean currentNodeIsVisibleint documentLevelhandleAttributes(...)Node nextSiblingIterator<NodeFilter> itisNodeIncludeDO(...)isNodeInclude(...)/** Adds to ns the definitions from the parent elements of el ... */Node n1List<Element> parentsListIterator<Element> itAttr nsprefixElement elehandleParent(...)getMappingWithoutRendered(...)/** Obtain the attributes to output for this node in XPathNodeSet c14n. ... *//** Obtain the attributes to output for this node in a Subtree c14n. ... *//** Outputs an Attribute to the internal Writer. ... */byte[] toWritewriteCharToUtf8(...)/** Outputs a PI to the internal Writer. ... */getTarget(...)String data/** Method outputCommentToWriter ... *//** Outputs a Text of CDATA section to the internal Writer. ... */// The null xmlns definition.//Fills the nssymbtable with the definitions of the parent of the root subnode// illegal node type during traversal//Add a level to the nssymbtable. So latter can be pop-back.//we output all Attrs which are available//We finished with this level, pop to the previous definitions.//Obtain all the parents of the element//Visit them in reverse order.// '\t'// '\n'// '\r'/** Serializes the physical representation of the subtree. All the attributes ... *//** Constructor Canonicalizer20010315 *//** Always throws a CanonicalizationException. ... */// result will contain all the attrs declared directly on that element// Processing Instructions before or after the document element are not treated specially// Comments before or after the document element are not treated specially/** A stack based Symbol Table. ... */new SymbMap(...)NameSpaceSymbEntry nenew NameSpaceSymbEntry(...)ne.lastrenderedSymbMap initialMap;SymbMap symb;/** The map betwen prefix-> entry table. */List<SymbMap> level;/** The stacks for removing the definitions when doing pop. */boolean cloned;/** Default constractor */new ArrayList<SymbMap>(...)/** Get all the unrendered nodes in the name space. ... */Iterator<NameSpaceSymbEntry> itNameSpaceSymbEntry nn.renderedn.nneedsClone(...)n.prefixn.lastrenderedn.uri/** Push a frame for visible namespace. ... *//** Pop a frame for visible namespace. *//** Push a frame for a node. ... *//** Pop a frame. ... */Object ob/** Gets the attribute node that defines the binding for the prefix. ... */NameSpaceSymbEntry entryentry.renderedentry.lastrenderedentry.urientry.n/** Gets a definition without mark it as render. ... *//** Adds the mapping for a prefix. ... */NameSpaceSymbEntry obob.uriob.lastrenderedne.rendered/** Adds a definition and mark it as render. ... */ob.renderedob.nne.n/** The internal structure of NameSpaceSymbTable. *//** The URI that the prefix defines */String lastrendered;/** The last output in the URI for this prefix (This for speed reason). *//** This prefix-URI has been already render or not. */Attr n;/** The attribute to include. */this.renderedthis.nint free;new NameSpaceSymbEntry[]Object oldKeyint newCapacityrehash(...)List<NameSpaceSymbEntry> anew ArrayList<NameSpaceSymbEntry>(...)...[...].uriObject[] setset.lengthObject cur/** rehashes the map to the new capacity. ... */int oldCapacityString[] oldKeysNameSpaceSymbEntry[] oldValsSymbMap copycopy.entriescopy.keys//Insert the default binding for xmlns.//put them rendered?//Put the number of namespace definitions in the stack.//There is no definition for the prefix(a bug?).//No need to render an entry already rendered.// Mark this entry as render.// Return the node for outputing.//If we have it previously defined. Don't keep working.//Creates and entry in the table for this new definition.//We have a previous definition store it for the pop.//Check if a previous definition(not the inmidiatly one) has been rendered.//Yes it is. Mark as rendered.//abs of indexgetStringInUtf8(...)int biasint writeboolean expandedint outbyte writebyte[] newResult//No Surrogates in sun javaimport OutputStreamWriter/** Converts <code>String</code>s into <code>Node</code>s and visa versa. ... */Canonicalizer canon;this.canon/** Returns a <code>String</code> representation of the specified ... */canonSerialize(...)/** Returns a <code>byte[]</code> representation of the specified ... */canonSerializeToByteArray(...)String retnotReset(...)/** Use the Canonicalizer to serialize the node ... */ByteArrayOutputStream byteArrayOutputStreamOutputStreamWriter outputStreamWriternew OutputStreamWriter(...)Map<String,String> storedNamespacesNode wkNamedNodeMap attsNode attString nodeNamenew XMLEncryptionException(...)// Create the context to parse the document against// Run through each node up to the document node and find any xmlns: nodesimport KeyInfo/** A Key Agreement algorithm provides for the derivation of a shared secret key ... *//** Returns a <code>byte</code> array. ... *//** Sets the KANonce.jj ... *//** Returns additional information regarding the <code>AgreementMethod</code>. ... *//** Adds additional <code>AgreementMethod</code> information. ... *//** Removes additional <code>AgreementMethod</code> information. ... *//** Returns information relating to the originator's shared secret. ... *//** Sets the information relating to the originator's shared secret. ... *//** Returns information relating to the recipient's shared secret. ... *//** Sets the information relating to the recipient's shared secret. ... *//** Returns the algorithm URI of this <code>CryptographicMethod</code>. ... *//** <code>CipherData</code> provides encrypted data. It must either contain the ... */int VALUE_TYPE;/** VALUE_TYPE ASN */int REFERENCE_TYPE;/** REFERENCE_TYPE ASN *//** Returns the type of encrypted data contained in the ... *//** Returns the cipher value as a base64 encoded <code>byte</code> array. ... *//** Sets the <code>CipherData</code>'s value. ... *//** Returns a reference to an external location containing the encrypted ... *//** Sets the <code>CipherData</code>'s reference. ... *//** <code>CipherReference</code> identifies a source which, when processed, ... *//** Returns an <code>URI</code> that contains an identifier that should be ... *//** Gets the URI as an Attribute node.  Used to meld the CipherReference ... *//** Returns the <code>Transforms</code> that specifies how to transform the ... *//** Sets the <code>Transforms</code> that specifies how to transform the ... *//** <code>CipherValue</code> is the wrapper for cipher text. ... *//** Returns the Base 64 encoded, encrypted octets that is the ... *//** Sets the Base 64 encoded, encrypted octets that is the ... */import DocumentFragment/** Converts <code>String</code>s into <code>Node</code>s and visa versa. */DocumentBuilderFactory dbf;byte[] fragmentcreateContext(...)String fragmentDocument dDocument contextDocumentElement fragEltimportNode(...)getDocumentElement(...)DocumentFragment resultcreateDocumentFragment(...)removeChild(...)SAXException seParserConfigurationException pce/** The <code>EncryptedData</code> element is the core element in the syntax. Not ... *//** The <code>EncryptedKey</code> element is used to transport encryption keys ... *//** Returns a hint as to which recipient this encrypted key value is intended for. ... *//** Sets the recipient for this <code>EncryptedKey</code>. ... *//** Returns pointers to data and keys encrypted using this key. The reference ... *//** Sets the <code>ReferenceList</code> to the <code>EncryptedKey</code>. ... *//** Returns a user readable name with the key value. This may then be used to ... *//** Sets the carried name. ... *//** EncryptedType is the abstract type from which <code>EncryptedData</code> and ... *//** Returns a <code>String</code> providing for the standard method of ... *//** Sets the id. ... *//** Returns an <code>URI</code> identifying type information about the ... *//** Sets the type. ... *//** Returns a <code>String</code> which describes the media type of the data ... *//** Sets the mime type. ... *//** Return an <code>URI</code> representing the encoding of the ... *//** Sets the <code>URI</code> representing the encoding of the ... *//** Returns an <code>EncryptionMethod</code> that describes the encryption ... *//** Sets the <code>EncryptionMethod</code> used to encrypt the cipher data. ... *//** Returns the <code>ds:KeyInfo</code>, that carries information about the ... *//** Sets the encryption key information. ... *//** Returns the <code>CipherReference</code> that contains the ... *//** Returns additional information concerning the generation of the ... *//** Sets the <code>EncryptionProperties</code> that supplies additional ... *//** <code>EncryptionMethod</code> describes the encryption algorithm applied to ... *//** Returns the algorithm applied to the cipher data. ... *//** Returns the key size of the key of the algorithm applied to the cipher ... *//** Sets the size of the key of the algorithm applied to the cipher data. ... *//** Returns the OAEP parameters of the algorithm applied applied to the ... *//** Sets the OAEP parameters. ... *//** Set the Digest Algorithm to use ... *//** Get the Digest Algorithm to use ... *//** Set the MGF Algorithm to use ... *//** Get the MGF Algorithm to use ... *//** Returns an iterator over all the additional elements contained in the ... *//** Adds encryption method information. ... *//** Removes encryption method information. ... *//** <code>EncryptionProperties</code> can hold additional information concerning ... *//** Returns the <code>EncryptionProperties</code>' id. ... *//** Returns an <code>Iterator</code> over all the ... *//** Adds an <code>EncryptionProperty</code>. ... *//** Removes the specified <code>EncryptionProperty</code>. ... *//** Additional information items concerning the generation of the ... *//** Returns the <code>EncryptedType</code> being described. ... *//** Sets the target. ... *//** Returns the id of the <CODE>EncryptionProperty</CODE>. ... *//** Returns the attribute's value in the <code>xml</code> namespace. ... *//** Set the attribute value. ... *//** Returns the properties of the <CODE>EncryptionProperty</CODE>. ... *//** Adds encryption information. ... *//** Removes encryption information. ... *//** A wrapper for a pointer from a key value of an <code>EncryptedKey</code> to ... *//** Returns the <code>Element</code> tag name for this <code>Reference</code>. ... *//** Returns a <code>URI</code> that points to an <code>Element</code> that ... *//** Sets a <code>URI</code> that points to an <code>Element</code> that ... *//** Returns an <code>Iterator</code> over all the child elements contained in ... *//** Adds retrieval information. ... *//** Removes the specified retrieval information. ... *//** <code>ReferenceList</code> is an element that contains pointers from a key ... */int DATA_REFERENCE;/** DATA TAG */int KEY_REFERENCE;/** KEY TAG *//** Adds a reference to this reference list. ... *//** Removes a reference from the <code>ReferenceList</code>. ... *//** Returns the size of the <code>ReferenceList</code>. ... *//** Indicates if the <code>ReferenceList</code> is empty. ... *//** Returns an <code>Iterator</code> over all the <code>Reference</code>s ... *//** <code>DataReference</code> factory method. Returns a ... *//** <code>KeyReference</code> factory method. Returns a ... *//** Set the Canonicalizer object to use. *//** A container for <code>ds:Transform</code>s. ... *//** Temporary method to turn the XMLEncryption Transforms class ... */import NoSuchPaddingExceptionimport InvalidCanonicalizerExceptionimport Base64DecodingExceptionimport KeyResolverExceptionimport KeyResolverSpiimport EncryptedKeyResolverimport InvalidTransformExceptionimport TransformationException/** <code>XMLCipher</code> encrypts and decrypts the contents of ... */EncryptionConstants.ALGO_ID_BLOCKCIPHER_TRIPLEDESEncryptionConstants.ALGO_ID_BLOCKCIPHER_AES128EncryptionConstants.ALGO_ID_BLOCKCIPHER_AES256EncryptionConstants.ALGO_ID_BLOCKCIPHER_AES192EncryptionConstants.ALGO_ID_BLOCKCIPHER_AES128_GCMEncryptionConstants.ALGO_ID_BLOCKCIPHER_AES192_GCMEncryptionConstants.ALGO_ID_BLOCKCIPHER_AES256_GCMEncryptionConstants.ALGO_ID_KEYTRANSPORT_RSA15EncryptionConstants.ALGO_ID_KEYTRANSPORT_RSAOAEPEncryptionConstants.ALGO_ID_KEYTRANSPORT_RSAOAEP_11EncryptionConstants.ALGO_ID_KEYAGREEMENT_DHEncryptionConstants.ALGO_ID_KEYWRAP_TRIPLEDESEncryptionConstants.ALGO_ID_KEYWRAP_AES128EncryptionConstants.ALGO_ID_KEYWRAP_AES256EncryptionConstants.ALGO_ID_KEYWRAP_AES192Constants.ALGO_ID_DIGEST_SHA1Transforms.TRANSFORM_BASE64_DECODEString TRIPLEDES;/** Triple DES EDE (192 bit key) in CBC mode */String AES_128;/** AES 128 Cipher */String AES_256;/** AES 256 Cipher */String AES_192;/** AES 192 Cipher */String AES_128_GCM;/** AES 128 GCM Cipher */String AES_192_GCM;/** AES 192 GCM Cipher */String AES_256_GCM;/** AES 256 GCM Cipher */String RSA_v1dot5;/** RSA 1.5 Cipher */String RSA_OAEP;/** RSA OAEP Cipher */String RSA_OAEP_11;String DIFFIE_HELLMAN;/** DIFFIE_HELLMAN Cipher */String TRIPLEDES_KeyWrap;/** Triple DES EDE (192 bit key) in CBC mode KEYWRAP */String AES_128_KeyWrap;/** AES 128 Cipher KeyWrap */String AES_256_KeyWrap;/** AES 256 Cipher KeyWrap */String AES_192_KeyWrap;/** AES 192 Cipher KeyWrap */String SHA1;/** SHA1 Cipher */String SHA256;/** SHA256 Cipher */String SHA512;/** SHA512 Cipher */String RIPEMD_160;/** RIPEMD Cipher */String XML_DSIG;/** XML Signature NS */String N14C_XML;/** N14C_XML */String N14C_XML_WITH_COMMENTS;/** N14C_XML with comments */String EXCL_XML_N14C;/** N14C_XML exclusive */String EXCL_XML_N14C_WITH_COMMENTS;/** N14C_XML exclusive with comments */String PHYSICAL_XML_N14C;/** N14C_PHYSICAL preserve the physical representation */String BASE64_ENCODING;/** Base64 encoding */int ENCRYPT_MODE;/** ENCRYPT Mode */int DECRYPT_MODE;/** DECRYPT Mode */int UNWRAP_MODE;/** UNWRAP Mode */int WRAP_MODE;/** WRAP Mode */String ENC_ALGORITHMS;Cipher contextCipher;/** Cipher created during initialisation that is used for encryption *//** Mode that the XMLCipher object is operating in *//** URI of algorithm that is being used for cryptographic operation */String requestedJCEProvider;/** Cryptographic provider requested by caller *//** Holds c14n to serialize, if initialized then _always_ use this c14n to serialize */Document contextDocument;/** Used for creation of DOM nodes in WRAP and ENCRYPT modes */Factory factory;/** Instance of factory used to create XML Encryption objects */Serializer serializer;/** Serializer class for going to/from UTF-8 */Key key;/** Local copy of user's key */Key kek;/** Local copy of the kek (used to decrypt EncryptedKeys during a ... */EncryptedKey ek;// (part of an UNWRAP operation)// The EncryptedKey being built (part of a WRAP operation) or readEncryptedData ed;// The EncryptedData being built (part of a WRAP operation) or readboolean secureValidation;String digestAlg;List<KeyResolverSpi> internalKeyResolvers;/** List of internal KeyResolvers for DECRYPT and UNWRAP modes. *//** Set the Serializer algorithm to use */this.serializersetCanonicalizer(...)/** Get the Serializer algorithm to use *//** Creates a new <code>XMLCipher</code>. ... */new Factory(...)InvalidCanonicalizerException icenew DocumentSerializer(...)constructCipher(...)/** Checks to ensure that the supplied algorithm is valid. ... *//** Validate the transformation argument of getInstance or getProviderInstance ... */isValidEncryptionAlgorithm(...)/** Returns an <code>XMLCipher</code> that implements the specified ... */validateTransformation(...)new XMLCipher(...)/** Returns an <code>XMLCipher</code> that implements no specific ... *//** Initializes this cipher with a key. ... */createEncryptedData(...)CipherData.VALUE_TYPEcreateEncryptedKey(...)/** Set whether secure validation is enabled or not. The default is false. */this.secureValidation/** This method is used to add a custom {@link KeyResolverSpi} to an XMLCipher. ... */new ArrayList<KeyResolverSpi>(...)/** Get the EncryptedData being built ... *//** Get the EncryptedData being build ... *//** Set a Key Encryption Key. ... */this.kek/** Martial an EncryptedData ... */toElement(...)/** Martial an EncryptedKey ... *//** Martial a ReferenceList ... *//** Encrypts an <code>Element</code> and replaces it with its encrypted ... */Element encryptedElementNode sourceParentencryptData(...)replaceChild(...)/** Encrypts a <code>NodeList</code> (the contents of an ... */removeContent(...)/** Process a DOM <code>Document</code> node. The processing depends on the ... */Document resultdecryptElement(...)encryptElement(...)/** Process a DOM <code>Element</code> node. The processing depends on the ... *//** Process the contents of a DOM <code>Element</code> node. The processing ... */decryptElementContent(...)encryptElementContent(...)/** Returns an <code>EncryptedData</code> interface. Use this operation if ... */EncryptionConstants.TYPE_CONTENTEncryptionConstants.TYPE_ELEMENTbyte[] serializedOctetsbyte[] encryptedBytesCipher cbyte[] finalEncryptedBytesencryptedBytes.lengthString base64EncodedEncryptedOctetsserializeToByteArray(...)byte[] tempIvParameterSpec paramSpecserializedOctets.lengthIllegalBlockSizeException ibseBadPaddingException bpeUnsupportedEncodingException ueeCipherData cdgetCipherData(...)CipherValue cvgetCipherValue(...)EncryptionMethod methodnewEncryptionMethod(...)setType(...)setDigestAlgorithm(...)setEncryptionMethod(...)URISyntaxException exnewEncryptedData(...)/** Returns an <code>EncryptedKey</code> interface. Use this operation if ... */newEncryptedKey(...)loadEncryptedKey(...)/** Encrypts a key to an EncryptedKey structure ... */encryptKey(...)OAEPParameterSpec oaepParametersconstructOAEPParameters(...)setMGFAlgorithm(...)setOAEPparams(...)/** Decrypt a key from a passed in EncryptedKey structure ... */XMLCipherInput cipherInputnew XMLCipherInput(...)String jceKeyAlgorithmgetJCEKeyAlgorithmFromURI(...)Key retKeyInfo kigetKeyInfo(...)setSecureValidation(...)String keyWrapAlggetEncryptionMethod(...)String keyTypegetSecretKey(...)EncryptionMethod encMethodgetOAEPparams(...)/** Construct an OAEPParameterSpec object from the given parameters */String jceDigestAlgorithmPSpecified pSourceMGF1ParameterSpec mgfParameterSpecnew MGF1ParameterSpec(...)EncryptionConstants.MGF1_SHA256EncryptionConstants.MGF1_SHA384EncryptionConstants.MGF1_SHA512/** Construct a Cipher object */String jceAlgorithmNoSuchProviderException nspreNoSuchPaddingException nspae/** Decrypt a key from a passed in EncryptedKey structure.  This version ... */decryptKey(...)/** Removes the contents of a <code>Node</code>. ... *//** Decrypts <code>EncryptedData</code> in a single-part operation. ... */byte[] octetsdecryptToByteArray(...)Node decryptedNodegetElementsByTagNameNS(...)EncryptionConstants._TAG_ENCRYPTEDDATA/** Decrypt an EncryptedData element to a byte array. ... */EncryptedData encryptedDataint ivLenString encMethodAlgorithmEncryptedKeyResolver resolvernew EncryptedKeyResolver(...)registerInternalKeyResolver(...)KeyResolverException kre/** Creates an <code>EncryptedData</code> <code>Element</code>. ... *//* Expose the interface for creating XML Encryption objects */EncryptedData resultCipherData dataCipherReference cipherReferencenewCipherReference(...)CipherValue cipherValuenewCipherValue(...)CipherData.REFERENCE_TYPEnewCipherData(...)setCipherReference(...)setCipherValue(...)/** Creates an <code>EncryptedKey</code> <code>Element</code>. ... */EncryptedKey result/** Create an AgreementMethod object ... */newAgreementMethod(...)/** Create a CipherData object ... *//** Create a CipherReference object ... *//** Create a CipherValue element ... *//** Create an EncryptionMethod object ... *//** Create an EncryptionProperties element ... */newEncryptionProperties(...)/** Create a new EncryptionProperty element ... */newEncryptionProperty(...)/** Create a new ReferenceList object ... */newReferenceList(...)/** Create a new Transforms object ... */newTransforms(...)new AgreementMethodImpl(...)new CipherDataImpl(...)new CipherReferenceImpl(...)new CipherValueImpl(...)/* CipherValue newCipherValue(byte[] value) { ... */new EncryptedDataImpl(...)new EncryptedKeyImpl(...)new EncryptionMethodImpl(...)new EncryptionPropertiesImpl(...)new EncryptionPropertyImpl(...)new ReferenceListImpl(...)new TransformsImpl(...)CipherData resultEncryptionConstants._TAG_CIPHERVALUEEncryptionConstants._TAG_CIPHERREFERENCEAttr uriAttrEncryptionConstants._ATT_URICipherReference resultNodeList transformsElementsEncryptionConstants._TAG_TRANSFORMSElement transformsElementsetTransforms(...)XMLSignatureException xseInvalidTransformException itegetFullTextChildrenFromElement(...)NodeList dataElementsEncryptionConstants._TAG_CIPHERDATAElement dataElementElement encryptionMethodElementEncryptionConstants._TAG_ENCRYPTIONMETHODElement keyInfoElementConstants._TAG_KEYINFOElement encryptionPropertiesElementEncryptionConstants._TAG_ENCRYPTIONPROPERTIESsetId(...)EncryptionConstants._ATT_IDEncryptionConstants._ATT_TYPEsetMimeType(...)EncryptionConstants._ATT_MIMETYPEsetEncoding(...)Constants._ATT_ENCODINGnewKeyInfo(...)setKeyInfo(...)setEncryptionProperties(...)Element referenceListElementEncryptionConstants._TAG_REFERENCELISTElement carriedNameElementEncryptionConstants._TAG_CARRIEDKEYNAMEsetRecipient(...)EncryptionConstants._ATT_RECIPIENTsetReferenceList(...)setCarriedName(...)new KeyInfo(...)String encAlgorithmEncryptionConstants._ATT_ALGORITHMEncryptionMethod resultElement keySizeElementEncryptionConstants._TAG_KEYSIZEElement oaepParamsElementEncryptionConstants._TAG_OAEPPARAMSElement digestElementElement mgfElementEncryptionConstants.EncryptionSpec11NSEncryptionConstants._TAG_MGFsetKeySize(...)String oaepParamsBase64DecodingException eString digestAlgorithmString mgfAlgorithmEncryptionProperties resultNodeList encryptionPropertyListEncryptionConstants._TAG_ENCRYPTIONPROPERTYaddEncryptionProperty(...)EncryptionProperty resultsetTarget(...)EncryptionConstants._ATT_TARGETReferenceList resultEncryptionConstants._TAG_DATAREFERENCEReferenceList.DATA_REFERENCEEncryptionConstants._TAG_KEYREFERENCEReferenceList.KEY_REFERENCEnewDataReference(...)newKeyReference(...)...[] kaNonce;List<Element> agreementMethodInformation;KeyInfo originatorKeyInfo;KeyInfo recipientKeyInfo;URI tmpAlgorithmnew LinkedList<Element>(...)String valueMessage;String referenceMessage;CipherValue cipherValue;CipherReference cipherReference;int cipherType;Element resultcreateElementInEncryptionSpace(...)String referenceURI;Transforms referenceTransforms;Attr referenceNode;String cipherValue;createElementForFamily(...)getMimeType(...)EncryptionConstants._ATT_ENCODINGcloneNode(...)getElement(...)getEncryptionProperties(...)String keyRecipient;ReferenceList referenceList;String carriedName;EncryptionConstants._TAG_ENCRYPTEDKEYgetRecipient(...)getReferenceList(...)String mimeType;String encoding;EncryptionMethod encryptionMethod;KeyInfo keyInfo;CipherData cipherData;EncryptionProperties encryptionProperties;/** Constructor. ... */URI tmpTypethis.encodingURI tmpEncoding...[] oaepParams;List<Element> encryptionMethodInformation;String digestAlgorithm;String mgfAlgorithm;this.digestAlgorithmthis.mgfAlgorithmIterator<Element> itrElement oaepElementcreateElementInEncryption11Space(...)getDefaultPrefix(...)List<EncryptionProperty> encryptionProperties;/** Constructor. */new LinkedList<EncryptionProperty>(...)Iterator<EncryptionProperty> itrString target;Map<String,String> attributeMap;List<Element> encryptionInformation;this.targetURI tmpTarget/** Construct Transforms */this.doccreateElementForFamilyLocal(...)getBaseNamespace(...)getBaseLocalName(...)// Over-ride the namespaceClass<?> sentry;List<Reference> references;DataReference.classKeyReference.classnew LinkedList<Reference>(...)Iterator<Reference> eachReferenceReference referencenew DataReference(...)new KeyReference(...)/** <code>ReferenceImpl</code> is an implementation of ... */List<Element> referenceInformation;// Create a canonicalizer - used when serializing DOM to octets// prior to encryption (and for the reverse)// The default is to preserve the physical representation.// sanity checks// Sanity checks/* XMLEncryption */// Now create the working cipher if none was created already// Now perform the encryption// The Spec mandates a 96-bit IV for GCM algorithms// Now build up to a properly XML Encryption encoded octet stream// IvParameterSpec iv;// cv.setValue(base64EncodedEncryptedOctets.getBytes());// Now create the working cipher// Should internally generate an IV// todo - allow user to set an IV// Obtain the encrypted octets// Check to see if an RSA OAEP MGF-1 with SHA-1 algorithm was requested// Some JDKs don't support RSA/ECB/OAEPPadding// The de-serialiser returns a node whose children we need to take on.// If this is a content decryption, this may have problems// Add an EncryptedKey resolver// Calculate the IV length and copy out// For now, we only work with Block ciphers, so this will work.// This should probably be put into the JCE mapper.// You may be able to pass the entire piece in to IvParameterSpec// and it will only take the first x bytes, but no way to be certain// that this will work for every JCE provider, so lets copy the// necessary bytes into a dedicated array.// Find any Transforms// Need to get the last CipherData found, as earlier ones will// be for elements in the KeyInfo lists// BFL 16/7/03 - simple implementation// TODO: Work out how to handle relative URI// TODO: Implement// TODO: Make this mess work// <any namespace='##other' minOccurs='0' maxOccurs='unbounded'/>// TODO: Make this lot work...// <anyAttribute namespace="http://www.w3.org/XML/1998/namespace"/>// TODO: Make this work...// <any namespace='##other' processContents='lax'/>/* Don't check validity of URI as may be "" *//* This is a same document URI reference. Do not parse, ... */// TODO: figure out the anyAttribyte stuff...// TODO: figure out the any stuff...// TODO: Need to martial referenceInformation// Figure out how to make this work..// <any namespace="##other" minOccurs="0" maxOccurs="unbounded"/>import ResourceResolverException/** <code>XMLCipherInput</code> is used to wrap input passed into the ... *//** The data we are working with *//** MODES *//** Constructor for processing encrypted octets ... */XMLCipher.DECRYPT_MODE/** Dereferences the input and returns it as a single byte array. ... */getDecryptBytes(...)/** Internal method to get bytes in decryption mode ... */CipherReference crgetCipherReference(...)getURIAsAttr(...)XMLSignatureInput inputTransforms transformsgetTransforms(...)ResourceResolver resolverResourceResolverException exTransforms dsTransformsgetDSTransforms(...)performTransforms(...)TransformationException exBase64DecodingException bde// Fun time!// Need to wrap the uri in an Attribute node so that we can// Pass to the resource resolvers// Lets see if there are any transforms// retrieve the cipher text/** Constants */String RSA_1_5;String TRIPLEDES_KEYWRAP;String AES_128_KEYWRAP;String AES_256_KEYWRAP;String AES_192_KEYWRAP;String N14C_XML_CMMNTS;String EXCL_XML_N14C_CMMNTS;/** Constructor AlgorithmAlreadyRegisteredException *//** Constructor AlgorithmAlreadyRegisteredException ... *//** This Exception is thrown if decoding of Base64 data fails. ... *//** Constructor Base64DecodingException *//** Constructor Base64DecodingException ... *//** The mother of all Exceptions in this bundle. It allows exceptions to have ... */String msgID;/** Field msgID *//** Constructor XMLSecurityException */this.msgID/** Constructor XMLSecurityException ... */getExceptionMessage(...)Constants.exceptionMessagesResourceBundleBase/** Method getMsgID ... *//** Method printStackTrace *//** Method printStackTrace ... *//** Method getOriginalException ... *//** The mother of all runtime Exceptions in this bundle. It allows exceptions to have ... *//** Constructor XMLSecurityRuntimeException *//** Constructor XMLSecurityRuntimeException ... *//** Constructor ContentHandlerAlreadyRegisteredException *//** Constructor ContentHandlerAlreadyRegisteredException ... */import EncryptedKeyimport XMLEncryptionExceptionimport DEREncodedKeyValueimport KeyInfoReferenceimport KeyNameimport KeyValueimport MgmtDataimport PGPDataimport RetrievalMethodimport SPKIDataimport X509Dataimport DSAKeyValueimport RSAKeyValueimport StorageResolverimport Transforms/** This class stand for KeyInfo Element that may contain keys, names, ... */List<StorageResolver> listnew ArrayList<StorageResolver>(...)List<X509Data> x509Datas;// The default StorageResolver is null.// the KeyResolvers would not be called.// We need at least one StorageResolver otherwiseList<EncryptedKey> encryptedKeys;List<StorageResolver> nullList;List<StorageResolver> storageResolvers;/** Field storageResolvers *//** Stores the individual (per-KeyInfo) {@link KeyResolverSpi}s *//** Constructor KeyInfo ... *//** Set whether secure processing is enabled or not. The default is false. *//** Sets the <code>Id</code> attribute ... */Constants._ATT_IDsetIdAttributeNS(...)/** Returns the <code>Id</code> attribute ... *//** Method addKeyName ... */new KeyName(...)/** Method add ... *//** Method addKeyValue ... */new KeyValue(...)/** Method addMgmtData ... */new MgmtData(...)/** Method addPGPData ... *//** Method addRetrievalMethod ... */new RetrievalMethod(...)/** Method addX509Data ... */new ArrayList<X509Data>(...)/** Method addEncryptedKey ... */XMLCipher ciphernew ArrayList<EncryptedKey>(...)martial(...)/** Method addDEREncodedKeyValue ... */new DEREncodedKeyValue(...)/** Method addKeyInfoReference ... */new KeyInfoReference(...)/** Method addUnknownElement ... *//** Method lengthKeyName ... */Constants._TAG_KEYNAME/** Method lengthKeyValue ... */Constants._TAG_KEYVALUE/** Method lengthMgmtData ... */Constants._TAG_MGMTDATA/** Method lengthPGPData ... */Constants._TAG_PGPDATA/** Method lengthRetrievalMethod ... */Constants._TAG_RETRIEVALMETHOD/** Method lengthSPKIData ... */Constants._TAG_SPKIDATA/** Method lengthX509Data ... */Constants._TAG_X509DATA/** Method lengthDEREncodedKeyValue ... */Constants.SignatureSpec11NSConstants._TAG_DERENCODEDKEYVALUE/** Method lengthKeyInfoReference ... */Constants._TAG_KEYINFOREFERENCE/** Method lengthUnknownElement ... */NodeList nlNode current/** Method itemKeyName ... */selectDsNode(...)this.baseURI/** Method itemKeyValue ... *//** Method itemMgmtData ... *//** Method itemPGPData ... */new PGPData(...)/** Method itemRetrievalMethod ... *//** Method itemSPKIData ... */new SPKIData(...)/** Method itemX509Data ... */new X509Data(...)/** Method itemEncryptedKey ... */selectXencNode(...)XMLCipher.UNWRAP_MODE/** Method itemDEREncodedKeyValue ... */selectDs11Node(...)/** Method itemKeyInfoReference ... *//** Method itemUnknownElement ... *//** Method isEmpty ... *//** Method containsKeyName ... */lengthKeyName(...)/** Method containsKeyValue ... */lengthKeyValue(...)/** Method containsMgmtData ... */lengthMgmtData(...)/** Method containsPGPData ... */lengthPGPData(...)/** Method containsRetrievalMethod ... */lengthRetrievalMethod(...)/** Method containsSPKIData ... */lengthSPKIData(...)/** Method containsUnknownElement ... */lengthUnknownElement(...)/** Method containsX509Data ... */lengthX509Data(...)/** Method containsDEREncodedKeyValue ... */lengthDEREncodedKeyValue(...)/** Method containsKeyInfoReference ... */lengthKeyInfoReference(...)/** This method returns the public key. ... */PublicKey pkgetPublicKeyFromInternalResolvers(...)getPublicKeyFromStaticResolvers(...)/** Searches the library wide KeyResolvers for public keys ... */Iterator<KeyResolverSpi> itKeyResolverSpi keyResolverNode currentChildgetBaseURI(...)StorageResolver storageengineLookupAndResolvePublicKey(...)/** Searches the per-KeyInfo KeyResolvers for public keys ... *//** Method getX509Certificate ... */X509Certificate certgetX509CertificateFromInternalResolvers(...)getX509CertificateFromStaticResolvers(...)/** This method uses each System-wide {@link KeyResolver} to search the ... */applyCurrentResolver(...)engineLookupResolveX509Certificate(...)/** Method getX509CertificateFromInternalResolvers ... */lengthInternalKeyResolver(...)/** This method returns a secret (symmetric) key. This is for XML Encryption. ... */getSecretKeyFromInternalResolvers(...)getSecretKeyFromStaticResolvers(...)/** Searches the library wide KeyResolvers for Secret keys ... */engineLookupAndResolveSecretKey(...)/** Searches the per-KeyInfo KeyResolvers for secret keys ... *//** This method returns a private key. This is for Key Transport in XML Encryption. ... */PrivateKey pkgetPrivateKeyFromInternalResolvers(...)getPrivateKeyFromStaticResolvers(...)/** Searches the library wide KeyResolvers for Private keys ... */engineLookupAndResolvePrivateKey(...)/** Searches the per-KeyInfo KeyResolvers for private keys ... *//** This method is used to add a custom {@link KeyResolverSpi} to a KeyInfo ... */this.internalKeyResolvers/** Method lengthInternalKeyResolver ... *//** Method itemInternalKeyResolver ... *//** Method addStorageResolver ... */this.storageResolvers/** $todo$ using this method, we don't see unknown Elements ... */// First search using the individual resolvers from the user// Then use the system-wide Resolvers// not using StorageResolvers at the moment// since they cannot return private keys// Replace the default null StorageResolver/** Utility class for for <CODE>com.sun.org.apache.xml.internal.security.keys</CODE> package. ... *//** Method prinoutKeyInfo ... */KeyName xitemKeyName(...)getKeyName(...)KeyValue xitemKeyValue(...)getPublicKey(...)MgmtData xitemMgmtData(...)getMgmtData(...)X509Data xitemX509Data(...)containsCertificate(...)containsIssuerSerial(...)// no instantiationimport Signature11ElementProxy/** Provides content model support for the <code>dsig11:DEREncodedKeyvalue</code> element. ... */...[] supportedKeyTypes;/** JCA algorithm key types supported by this implementation. *//** Constructor DEREncodedKeyValue ... */addBase64Text(...)getEncodedDER(...)removeAttributeNS(...)/** Method getPublicKey ... */getBytesFromTextChild(...)PublicKey publicKey/** Method getEncodedDER ... */getKeySpec(...)// Iterate over the supported key types until one produces a public key.// Do nothing, try the next type/** Empty interface just to identify Elements that can be children of ds:KeyInfo. ... *//** Provides content model support for the <code>dsig11:KeyInfoReference</code> element. ... *//** Constructor RetrievalMethod ... */Constants._ATT_URI/** Method getURIAttr ... */getURIAttr(...)/** Constructor KeyName ... */addText(...)/** Method getKeyName ... */getTextFromTextChild(...)/** The KeyValue element contains a single public key that may be useful in ... *//** Constructor KeyValue ... */DSAKeyValue dsanew DSAKeyValue(...)RSAKeyValue rsanew RSAKeyValue(...)Element rsaConstants._TAG_RSAKEYVALUEElement dsaConstants._TAG_DSAKEYVALUERSAKeyValue kvDSAKeyValue kv/** Constructor MgmtData ... *//** Method getMgmtData ... *//** Constructor PGPData ... */String TYPE_DSA;/** DSA retrieval */String TYPE_RSA;/** RSA retrieval */String TYPE_PGP;/** PGP retrieval */String TYPE_SPKI;/** SPKI retrieval */String TYPE_MGMT;/** MGMT retrieval */String TYPE_X509;/** X509 retrieval */String TYPE_RAWX509;/** RAWX509 retrieval */Constants._ATT_TYPE/** Method getTransforms ... */Element transformsElemConstants._TAG_TRANSFORMSnew Transforms(...)XMLSignatureException ex/** Constructor SPKIData ... */import XMLX509CRLimport XMLX509Certificateimport XMLX509Digestimport XMLX509IssuerSerialimport XMLX509SKIimport XMLX509SubjectName/** Constructor X509Data ... *//** Method addIssuerSerial ... */new XMLX509IssuerSerial(...)/** Method addSKI ... */new XMLX509SKI(...)/** Method addSubjectName ... */new XMLX509SubjectName(...)/** Method addCertificate ... */new XMLX509Certificate(...)/** Method addCRL ... */new XMLX509CRL(...)/** Method addDigest ... */new XMLX509Digest(...)/** Method lengthIssuerSerial ... */Constants._TAG_X509ISSUERSERIAL/** Method lengthSKI ... */Constants._TAG_X509SKI/** Method lengthSubjectName ... */Constants._TAG_X509SUBJECTNAME/** Method lengthCertificate ... */Constants._TAG_X509CERTIFICATE/** Method lengthCRL ... */Constants._TAG_X509CRL/** Method lengthDigest ... */Constants._TAG_X509DIGEST/** Method itemIssuerSerial ... *//** Method itemSKI ... *//** Method itemSubjectName ... *//** Method itemCertificate ... *//** Method itemCRL ... *//** Method itemDigest ... *//** Method containsIssuerSerial ... */lengthIssuerSerial(...)/** Method containsSKI ... */lengthSKI(...)/** Method containsSubjectName ... */lengthSubjectName(...)/** Method containsCertificate ... */lengthCertificate(...)/** Method containsDigest ... */lengthDigest(...)/** Method containsCRL ... */lengthCRL(...)/* No Elements found */import DSAPublicKeyimport DSAPublicKeySpec/** Constructor DSAKeyValue ... */addBigIntegerElement(...)Constants._TAG_PConstants._TAG_QConstants._TAG_GConstants._TAG_YDSAPublicKeySpec pkspecnew DSAPublicKeySpec(...)getBigIntegerFromChildElement(...)KeyFactory dsaFactoryInvalidKeySpecException eximport RSAPublicKeyimport RSAPublicKeySpec/** Constructor RSAKeyValue ... */Constants._TAG_MODULUSConstants._TAG_EXPONENTgetPublicExponent(...)KeyFactory rsaFactoryRSAPublicKeySpec rsaKeyspecnew RSAPublicKeySpec(...)/** Constructor XMLX509CRL ... *//** Constructor X509CRL ... *//** Method getCRLBytes ... */String JCA_CERT_ID;/** Field JCA_CERT_ID *//** Constructor X509Certificate ... *//** Constructor XMLX509Certificate ... */CertificateEncodingException ex/** Method getCertificateBytes ... */byte[] certbytesgetCertificateBytes(...)CertificateFactory certFactXMLX509Certificate.JCA_CERT_IDCertificateException exgetX509Certificate(...)XMLX509Certificate otherXMLSecurityException exXMLSecurityException e/** Just used for tagging contents that are allowed inside a ds:X509Data Element. ... *//** Provides content model support for the <code>dsig11:X509Digest</code> element. ... *//** Constructor XMLX509Digest ... */getDigestBytesFromCert(...)/** Method getAlgorithmAttr ... *//** Method getAlgorithm ... */getAlgorithmAttr(...)/** Method getDigestBytes ... *//** Method getDigestBytesFromCert ... */String jcaDigestAlgorithmimport RFC2253Parser/** Constructor XMLX509IssuerSerial ... */addTextElement(...)Constants._TAG_X509ISSUERNAMEConstants._TAG_X509SERIALNUMBERgetIssuerX500Principal(...)/** Method getSerialNumber ... */getTextFromChildElement(...)/** Method getSerialNumberInteger ... *//** Method getIssuerName ... */XMLX509IssuerSerial othergetIssuerName(...)/** Handles SubjectKeyIdentifier (SKI) for X.509v3. ... */String SKI_OID;/** <CODE>SubjectKeyIdentifier (id-ce-subjectKeyIdentifier) (2.5.29.14)</CODE>: ... *//** Constructor X509SKI ... *//** Constructor XMLX509SKI ... */getSKIBytesFromCert(...)/** Method getSKIBytes ... *//** Method getSKIBytesFromCert ... */byte[] extensionValuegetExtensionValue(...)XMLX509SKI.SKI_OIDbyte[] skidValueextensionValue.lengthskidValue.lengthXMLX509SKI othergetSKIBytes(...)/* Gets the DER-encoded OCTET string for the extension value ... *//** Strip away first four bytes from the extensionValue ... *//** Constructor X509SubjectName ... *//** Constructor XMLX509SubjectName ... */getSubjectX500Principal(...)/** Method getSubjectName ... */XMLX509SubjectName otherString otherSubjectgetSubjectName(...)String thisSubject/** Constructor InvalidKeyResolverException *//** Constructor InvalidKeyResolverException ... */import CopyOnWriteArrayListimport DEREncodedKeyValueResolverimport DSAKeyValueResolverimport KeyInfoReferenceResolverimport RSAKeyValueResolverimport RetrievalMethodResolverimport X509CertificateResolverimport X509DigestResolverimport X509IssuerSerialResolverimport X509SKIResolverimport X509SubjectNameResolver/** KeyResolver is factory class for subclass of KeyResolverSpi that ... */new CopyOnWriteArrayList<KeyResolver>(...)List<KeyResolver> resolverVector;/** Field resolverVector */KeyResolverSpi resolverSpi;/** Field resolverSpi *//** Method length ... */KeyResolver resolverresolveX509Certificate(...)new KeyResolverException(...)PublicKey certresolvePublicKey(...)/** This method is used for registering {@link KeyResolverSpi}s which are ... */KeyResolverSpi keyResolverSpisetGlobalResolver(...)new KeyResolver(...)List<KeyResolver> keyResolverListnew ArrayList<KeyResolver>(...)/** This method registers the default resolvers. */new RSAKeyValueResolver(...)new DSAKeyValueResolver(...)new X509CertificateResolver(...)new X509SKIResolver(...)new RetrievalMethodResolver(...)new X509SubjectNameResolver(...)new X509IssuerSerialResolver(...)new DEREncodedKeyValueResolver(...)new KeyInfoReferenceResolver(...)new X509DigestResolver(...)/** Method resolvePublicKey ... *//** Method resolveX509Certificate ... *//** Method setProperty ... */engineSetProperty(...)/** Method getProperty ... */engineGetProperty(...)/** Method understandsProperty ... */understandsProperty(...)/** Method resolverClassName ... *//** Iterate over the KeyResolverSpi instances */List<KeyResolver> res;Iterator<KeyResolver> it;resolver.resolverSpinew ResolverIterator(...)/** Constructor KeyResolverException *//** Constructor KeyResolverException ... *//** This class is an abstract class for a child KeyInfo Element. ... */Map<String,String> properties;/** Field properties */boolean globalResolver;/** This method returns whether the KeyResolverSpi is able to perform the requested action. ... *//** Method engineResolvePublicKey ... *//** Method engineLookupAndResolvePublicKey ... */KeyResolverSpi tmpcloneIfNeeded(...)engineCanResolve(...)engineResolvePublicKey(...)/** Method engineResolveCertificate ... *//** Method engineLookupResolveX509Certificate ... */engineResolveX509Certificate(...)/** Method engineResolveSecretKey ... *//** Method engineLookupAndResolveSecretKey ... */engineResolveSecretKey(...)/** Method engineLookupAndResolvePrivateKey ... *//** Method engineSetProperty ... *//** Method engineGetProperty ... */this.globalResolver// This method was added later, it has no equivalent// engineResolvePrivateKey() in the old API.// We cannot throw UnsupportedOperationException because// KeyResolverSpi implementations who don't know about// this method would stop the search too early./** KeyResolverSpi implementation which resolves public keys from a ... *//** {@inheritDoc}. */elementIsInSignature11Space(...)DEREncodedKeyValue derKeyValueElement dsaKeyElementboolean isKeyValueelementIsInSignatureSpace(...)DSAKeyValue dsaKeyValue// this trick is needed to allow the RetrievalMethodResolver to eat a// ds:DSAKeyValue directly (without KeyValue)//do nothing/** The <code>EncryptedKeyResolver</code> is not a generic resolver.  It can ... *//** Constructor for use when a KEK needs to be derived from a KeyInfo ... *//** Constructor used for when a KEK has been set ... *//** This method is used to add a custom {@link KeyResolverSpi} to help ... */boolean isEncryptedKeyelementIsInEncryptionSpace(...)EncryptedKey ekXMLEncryptionException eimport QName/** KeyResolverSpi implementation which resolves public keys, private keys, secret keys, and X.509 certificates from a ... */KeyInfo referentresolveReferentKeyInfo(...)/** Resolve the KeyInfoReference Element's URI attribute into a KeyInfo instance. ... */KeyInfoReference referenceXMLSignatureInput resourceresolveInput(...)Element referentElementobtainReferenceElement(...)validateReference(...)addStorageResolver(...)/** Validate the Element referred to by the KeyInfoReference. ... */new QName(...)containsKeyInfoReference(...)/** Resolve the XML signature input represented by the specified URI. ... */ResourceResolver resRes/** Resolve the Element effectively represented by the XML signature input source. ... */byte[] inputBytesgetDocFromBytes(...)/** Parses a byte array and returns the parsed Element. ... */// Don't support chains of references at this time. If do support in the future, this is where the code// would go to validate that don't have a cycle, resulting in an infinite loop. This may be unrealistic// to implement, and/or very expensive given remote URI references.// Retrieved resource is a byte streamimport KeyStoreimport CertificateEncodingException/** Resolves a PrivateKey within a KeyStore based on the KeyInfo hints. ... */KeyStore keyStore;this.keyStore/** Method engineResolveX509Certificate ... *//** Method engineResolvePrivateKey ... */PrivateKey privKeyresolveX509Data(...)String keyNameX509Data x509DataXMLX509SKI x509SKIitemSKI(...)resolveX509SKI(...)XMLX509IssuerSerial x509SerialitemIssuerSerial(...)resolveX509IssuerSerial(...)XMLX509SubjectName x509SubjectNameitemSubjectName(...)resolveX509SubjectName(...)XMLX509Certificate x509CertitemCertificate(...)KeyStoreException e/* Search for a private key entry in the KeyStore with the same Subject Key Identifier */Enumeration<String> aliasesaliases(...)isKeyEntry(...)getCertificate(...)XMLX509SKI certSKI/* Search for a private key entry in the KeyStore with the same Issuer/Serial Number pair. */XMLX509IssuerSerial certSerial/* Search for a private key entry in the KeyStore with the same Subject Name. */XMLX509SubjectName certSN/* Search for a private key entry in the KeyStore with the same Certificate. */byte[] x509CertBytesbyte[] certBytesCertificateEncodingException e1// Keep searchingElement rsaKeyElementRSAKeyValue rsaKeyValue// ds:RSAKeyValue directly (without KeyValue)/** The RetrievalMethodResolver can retrieve public keys and certificates from ... */RetrievalMethod rmRetrievalMethod.TYPE_RAWX509getRawCertificate(...)RetrievalMethod rm2XMLSignatureInput resource2Element e2String errorresolveKey(...)ParserConfigurationException eSAXException eresolveCertificate(...)/** Retrieves a x509Certificate from the given information ... *//** Retrieves a PublicKey from the given information ... */inputBytes.length/** Resolves the input from the given retrieval method ... */Attr uriIterator<Node> itList<Node> parentsListIterator<Node> it2Node currentNode// Create a retrieval method over the given element// a raw certificate, direct parsing is done!// Check to make sure that the reference is not to another RetrievalMethod// which points to this element// An element has been provided// Retrieved resource is a nodeSet// Retrieved resource is an inputStream// otherwise, we parse the resource, create an Element and delegate// if the resource stores a raw certificate, we have to handle it// Apply the transforms// Obtain all the parents of the elemnt// Visit them in reverse order./** Resolves a SecretKey within a KeyStore based on the KeyName. ... *//** Resolves a single Key based on the KeyName. */String keyName;PublicKey publicKey;PrivateKey privateKey;SecretKey secretKey;this.keyNamethis.publicKeythis.privateKeythis.secretKey/** Resolves Certificates which are directly contained inside a ... */Element[] elsselectDsNodes(...)els.lengthElement elXMLX509Certificate xmlCert// populate Object array/** KeyResolverSpi implementation which resolves public keys and X.509 certificates from a ... */containsDigest(...)/** Resolves from the storage resolver the actual certificate represented by the digest. ... */XMLX509Digest[] x509DigestsElement[] x509childNodesselectDs11Nodes(...)x509childNodes.lengthIterator<Certificate> storageIteratorgetIterator(...)checkStorage(...)new XMLX509Digest[]x509Digests.lengthXMLX509Digest keyInfoDigestbyte[] certDigestBytesgetDigestBytes(...)/** Method checkSrorage ... */KeyResolverException exX509Data x509dataint noOfISSXMLX509IssuerSerial xmlissXMLX509SKI[] x509childObjectnew XMLX509SKI[]x509childObject.length/** Field _x509childObject[] */XMLX509SubjectName[] x509childObjectnew XMLX509SubjectName[]import KeyStoreResolverimport SingleCertificateResolver/** This class collects customized resolvers for Certificates. */List<StorageResolverSpi> storageResolvers;/** Constructor StorageResolver *//** Constructor StorageResolver ... *//** Method addResolver ... */new ArrayList<StorageResolverSpi>(...)/** Method addKeyStore ... */new KeyStoreResolver(...)StorageResolverException exnew SingleCertificateResolver(...)/** Method getIterator ... */new StorageResolverIterator(...)/** Class StorageResolverIterator ... */Iterator<StorageResolverSpi> resolvers;/** Field resolvers */Iterator<Certificate> currentResolver;/** Field currentResolver *//** Constructor StorageResolverIterator ... */this.resolversfindNextResolver(...)/** Method remove */// Find the next storage with at least one element and return its IteratorStorageResolverSpi resolverSpiIterator<Certificate> iter/** Constructor StorageResolverException *//** Constructor StorageResolverException ... */import CertificateExpiredExceptionimport CertificateNotYetValidExceptionimport StorageResolverExceptionimport StorageResolverSpi/** This {@link StorageResolverSpi} makes all raw (binary) {@link X509Certificate}s ... */new ArrayList<X509Certificate>(...)String merlinsCertificatesDir;/** Field merlinsCertificatesDir */List<X509Certificate> certs;/** Field certs */this.merlinsCertificatesDirreadCertsFromHarddrive(...)/** Method readCertsFromHarddrive ... */File certDirList<String> alString currentFileNamenew StorageResolverException(...)checkValidity(...)this.certsCertificateNotYetValidException exCertificateExpiredException exnew FilesystemIterator(...)/** Class FilesystemIterator *//** Field i *//** Constructor FilesystemIterator ... *//** Method main ... */CertsInFilesystemDirectoryResolver krsnew CertsInFilesystemDirectoryResolver(...)Iterator<Certificate> ibyte[] ski//add to ArrayList/** Makes the Certificates from a JAVA {@link KeyStore} object available to the ... *//** Field keyStore *//** Constructor KeyStoreResolver ... */KeyStoreException exnew KeyStoreIterator(...)/** Class KeyStoreIterator */Enumeration<String> aliases;/** Field aliases */Certificate nextCert;/** Field nextCert *//** Constructor KeyStoreIterator ... */this.aliasesfindNextCert(...)Certificate ret// In particular, this skips over entries containing symmetric keys.// Find the next entry that contains a certificate and return it.// Do a quick check on the keystore// empty Enumeration// maybe caller did not call hasNext()/** This {@link StorageResolverSpi} makes a single {@link X509Certificate} ... */X509Certificate certificate;/** Field certificate */this.certificatenew InternalIterator(...)/** Class InternalIterator */boolean alreadyReturned;/** Field alreadyReturned *//** Constructor InternalIterator ... */this.alreadyReturned/** Raised when the computed hash value doesn't match the given <i>DigestValue</i>. ... *//** Constructor InvalidDigestValueException *//** Constructor InvalidDigestValueException ... *//** Raised if testing the signature value over <i>DigestValue</i> fails because of invalid signature. ... *//** Constructor InvalidSignatureValueException *//** Constructor InvalidSignatureValueException ... */import ResourceResolverSpiimport DOMException/** Handles <code>&lt;ds:Manifest&gt;</code> elements. ... */int MAXIMUM_REFERENCE_COUNT;/** The maximum number of references per Manifest, if secure validation is enabled. *//** Field references */...[] referencesEl;...[] verificationResults;/** Field verificationResults[] */Map<String,String> resolverProperties;/** Field resolverProperties */List<ResourceResolver> perManifestResolvers;/** Field perManifestResolvers *//** Constructs {@link Manifest} ... */this.referencesnew ArrayList<Reference>(...)/** Constructor Manifest ... */int lethis.referencesEl.lengththis.referencesElConstants._TAG_REFERENCEConstants._TAG_MANIFESTnew DOMException(...)DOMException.WRONG_DOCUMENT_ERRElement refElemAttr refAttr/** This <code>addDocument</code> method is used to add a new resource to the ... *//** The calculation of the DigestValues in the References must be after the ... */Reference currentRefgenerateDigestValue(...)/** Return the nonnegative number of added references. ... *//** Return the <it>i</it><sup>th</sup> reference. Valid <code>i</code> ... *//** Used to do a <A HREF="http://www.w3.org/TR/xmldsig-core/#def-ValidationReference">reference ... */verifyReferences(...)boolean verifyreferencesEl.lengththis.verificationResultsboolean currentRefVerifiedsetVerificationResult(...)typeIsReferenceToManifest(...)XMLSignatureInput signedManifestNodesdereferenceURIandPerformTransforms(...)Set<Node> nlManifest referencedManifestIterator<Node> nlIteratorboolean referencedManifestValidnew Manifest(...)getSourceURI(...)new MissingResourceFailureException(...)referencedManifest.perManifestResolversthis.perManifestResolversreferencedManifest.resolverPropertiesthis.resolverPropertiesnew ReferenceNotInitializedException(...)ReferenceNotInitializedException ex/** Method setVerificationResult ... *//** After verifying a {@link Manifest} or a {@link SignedInfo} using the ... *//** Adds Resource Resolver for retrieving resources at specified <code>URI</code> attribute ... */new ArrayList<ResourceResolver>(...)new ResourceResolver(...)/** Get the Per-Manifest Resolver List ... *//** Get the resolver property map ... *//** Used to pass parameters like proxy servers etc to the ResourceResolver ... *//** Returns the value at specified key ... *//** Method getSignedContentItem ... */getReferencedContentAfterTransformsItem(...)InvalidCanonicalizerException ex/** Method getReferencedContentPriorTransformsItem ... */getContentsBeforeTransformation(...)/** Method getReferencedContentAfterTransformsItem ... */getContentsAfterTransformation(...)/** Method getSignedContentLength ... */// check out Reference children// At least one Reference must be present. Bad.// create List// the this.doc is handed implicitly by the this.getOwnerDocument()// add Reference object to our cache vector// add the Element of the Reference object to the Manifest/SignedInfo// update the cached Reference object, the Element content is automatically updated// not yet constructed, so _we_ have to// if only one item does not verify, the whole verification fails// was verification successful till now and do we want to verify the Manifest?// Hm, seems not to be a ds:Manifest// The Reference stated that it points to a ds:Manifest// but we did not find a ds:Manifest in the signed area/** Thrown by {@link com.sun.org.apache.xml.internal.security.signature.SignedInfo#verify()} when ... */Reference uninitializedReference;/** Field uninitializedReference *//** MissingKeyResourceFailureException constructor. ... */this.uninitializedReference/** Constructor MissingResourceFailureException ... *//** used to set the uninitialized {@link com.sun.org.apache.xml.internal.security.signature.Reference} ... *//** used to get the uninitialized {@link com.sun.org.apache.xml.internal.security.signature.Reference} ... *//** An interface to tell to the c14n if a node is included or not in the output *//** Tells if a node must be output in c14n. ... *//** Tells if a node must be output in a c14n. ... *//** Handles <code>&lt;ds:Object&gt;</code> elements ... *//** Constructs {@link ObjectContainer} ... *//** Constructs {@link ObjectContainer} from {@link Element} ... *//** Sets the <code>MimeType</code> attribute ... */Constants._ATT_MIMETYPE/** Returns the <code>MimeType</code> attribute ... *//** Sets the <code>Encoding</code> attribute ... *//** Returns the <code>Encoding</code> attribute ... *//** Adds child Node ... */Constants._TAG_OBJECTimport ReferenceDataimport ReferenceNodeSetDataimport ReferenceOctetStreamDataimport ReferenceSubTreeDataimport DigesterOutputStreamimport UnsyncBufferedOutputStream/** Handles <code>&lt;ds:Reference&gt;</code> elements. ... */String OBJECT_URI;/** Field OBJECT_URI */String MANIFEST_URI;/** Field MANIFEST_URI */int MAXIMUM_TRANSFORM_COUNT;/** The maximum number of transforms per reference, if secure validation is enabled. */boolean useC14N11;/** Look up useC14N11 system property. If true, an explicit C14N11 transform ... */Manifest manifest;XMLSignatureInput transformsOutput;Transforms transforms;Element digestMethodElem;Element digestValueElement;ReferenceData referenceData;/** Constructor Reference ... */MessageDigestAlgorithm mdathis.manifestsetURI(...)this.transformsConstants._TAG_DIGESTVALUE/** Build a {@link Reference} from an {@link Element} ... *//** Returns {@link MessageDigestAlgorithm} ... *//** Sets the <code>URI</code> of this <code>Reference</code> element ... *//** Returns the <code>URI</code> of this <code>Reference</code> element ... *//** Sets the <code>Id</code> attribute of this <code>Reference</code> element ... *//** Returns the <code>Id</code> attribute of this <code>Reference</code> element ... *//** Sets the <code>type</code> atttibute of the Reference indicate whether an ... *//** Return the <code>type</code> atttibute of the Reference indicate whether an ... *//** Method isReferenceToObject ... */Reference.OBJECT_URI/** Method isReferenceToManifest ... */Reference.MANIFEST_URI/** Method setDigestValueElement ... */String base64codedValueText t/** Method generateDigestValue ... */setDigestValueElement(...)calculateDigest(...)/** Returns the XMLSignatureInput which is created by de-referencing the URI attribute. ... */getPerManifestResolvers(...)addProperties(...)getResolverProperties(...)XMLSignatureInput outputthis.transformsOutput/** Returns the XMLSignatureInput which is the result of the Transforms. ... */cacheDereferencedElement(...)/** This method returns the XMLSignatureInput which represents the node set before ... */Transform tTransforms.TRANSFORM_C14N_EXCL_OMIT_COMMENTSTransforms.TRANSFORM_C14N_EXCL_WITH_COMMENTSTransforms.TRANSFORM_C14N_OMIT_COMMENTSTransforms.TRANSFORM_C14N_WITH_COMMENTSperformTransform(...)setSourceURI(...)/** Method getHTMLRepresentation ... */XMLSignatureInput nodesgetNodesetBeforeFirstCanonicalization(...)Transform c14nTransformSet<String> inclusiveNamespacesInclusiveNamespaces.ExclusiveCanonicalizationNamespaceInclusiveNamespaces._TAG_EC_INCLUSIVENAMESPACESInclusiveNamespaces innew InclusiveNamespaces(...)selectNode(...)getInclusiveNamespaces(...)getHTMLRepresentation(...)InvalidTransformException ex/** This method only works works after a call to verify. ... *//** Get the ReferenceData that corresponds to the cached representation of the dereferenced ... *//** This method returns the {@link XMLSignatureInput} which is referenced by the ... *//** Store the dereferenced Element(s) so that it/they can be retrieved later. */Set<Node> sIterator<Node> sIterator;new ReferenceSubTreeData(...)isByteArray(...)new ReferenceOctetStreamData(...)getOctetStream(...)getMIMEType(...)/** Method getReferencedBytes ... *//** Method calculateDigest ... */getMessageDigestAlgorithm(...)DigesterOutputStream diOsnew DigesterOutputStream(...)new UnsyncBufferedOutputStream(...)Reference.useC14N11isOutputStreamSet(...)addTransform(...)Transforms.TRANSFORM_C14N11_OMIT_COMMENTSupdateOutputStream(...)getOctetStreamReal(...)getDigestValue(...)/** Returns the digest value. ... *//** Tests reference validation is success or false ... */byte[] elemDigbyte[] calcDigboolean equal// important: The ds:Reference must be added to the associated ds:Manifest//            or ds:SignedInfo _before_ the this.resolverResult() is called.// this.manifest.appendChild(this.constructionElement);// this.manifest.appendChild(this.doc.createTextNode("\n"));//new XMLSignatureInput(output.getBytes());//this.transformsOutput.setSourceURI(output.getSourceURI());// there is one InclusiveNamespaces element// log a warning// if signing and c14n11 property == true explicitly add// C14N11 transform if needed//this.getReferencedBytes(diOs);//mda.update(data);// The required element is not in the XML!/** Raised if verifying a {@link com.sun.org.apache.xml.internal.security.signature.Reference} fails ... *//** Constructor ReferenceNotInitializedException *//** Constructor ReferenceNotInitializedException ... *//** Handles <code>&lt;ds:SignatureProperties&gt;</code> elements ... *//** Constructor SignatureProperties ... *//** Constructs {@link SignatureProperties} from {@link Element} ... */Element propertyElemConstants._TAG_SIGNATUREPROPERTYAttr propertyAttr/** Return the nonnegative number of added SignatureProperty elements. ... */Element[] propertyElemspropertyElems.length/** Return the <it>i</it><sup>th</sup> SignatureProperty. Valid <code>i</code> ... */new SignatureProperty(...)/** Method addSignatureProperty ... */Constants._TAG_SIGNATUREPROPERTIES/** Handles <code>&lt;ds:SignatureProperty&gt;</code> elements ... *//** Constructs{@link SignatureProperty} using specified <code>target</code> attribute ... *//** Constructs {@link SignatureProperty} using sepcified <code>target</code> attribute and ... *//** Constructs a {@link SignatureProperty} from an {@link Element} ... *//** Sets the <code>id</code> attribute ... *//** Returns the <code>id</code> attribute ... *//** Sets the <code>target</code> attribute ... */Constants._ATT_TARGET/** Returns the <code>target</code> attribute ... *//** Method appendChild ... *//** Handles <code>&lt;ds:SignedInfo&gt;</code> elements ... */SignatureAlgorithm signatureAlgorithm;...[] c14nizedBytes;/** Field c14nizedBytes */Element c14nMethod;Element signatureMethod;/** Overwrites {@link Manifest#addDocument} because it creates another ... *//** Constructs {@link SignedInfo} using given Canonicalization algorithm and ... *//** Constructor SignedInfo ... */Constants._TAG_CANONICALIZATIONMETHODnew SignatureAlgorithm(...)this.c14nMethod/** Build a {@link SignedInfo} from an {@link Element} ... */reparseSignedInfoElem(...)Element c14nMethodString c14nMethodURICanonicalizer c14nizerbyte[] c14nizedBytesDocument newdocNode imported/** Tests core validation process ... *//** Returns getCanonicalizedOctetStream ... */this.c14nizedBytesgetCanonicalizationMethodURI(...)/** Output the C14n stream to the given OutputStream. ... */String inclusiveNamespaces/** Returns the Canonicalization method URI ... *//** Returns the Signature method URI ... */Element signatureElementgetSignatureMethodElement(...)/** Method getSignatureMethodElement ... *//** Creates a SecretKey for the appropriate Mac algorithm based on a ... */getJCEAlgorithmString(...)Constants._TAG_SIGNEDINFOElement inclusiveElement// Check this?// Parse the Reference children and Id attribute in the Manifest/* If a custom canonicalizationMethod is used, canonicalize ... */// the c14n is not a secure one and can rewrite the URIs or like// so reparse the SignedInfo to be sure// make defensive copyimport SignerOutputStream/** Handles <code>&lt;ds:Signature&gt;</code> elements. ... */String ALGO_ID_MAC_HMAC_SHA1;/** MAC - Required HMAC-SHA1 */String ALGO_ID_SIGNATURE_DSA;/** Signature - Required DSAwithSHA1 (DSS) */String ALGO_ID_SIGNATURE_DSA_SHA256;/** Signature - Optional DSAwithSHA256 */String ALGO_ID_SIGNATURE_RSA;/** Signature - Recommended RSAwithSHA1 */String ALGO_ID_SIGNATURE_RSA_SHA1;String ALGO_ID_SIGNATURE_NOT_RECOMMENDED_RSA_MD5;/** Signature - NOT Recommended RSAwithMD5 */String ALGO_ID_SIGNATURE_RSA_RIPEMD160;/** Signature - Optional RSAwithRIPEMD160 */String ALGO_ID_SIGNATURE_RSA_SHA256;/** Signature - Optional RSAwithSHA256 */String ALGO_ID_SIGNATURE_RSA_SHA384;/** Signature - Optional RSAwithSHA384 */String ALGO_ID_SIGNATURE_RSA_SHA512;/** Signature - Optional RSAwithSHA512 */String ALGO_ID_MAC_HMAC_NOT_RECOMMENDED_MD5;/** HMAC - NOT Recommended HMAC-MD5 */String ALGO_ID_MAC_HMAC_RIPEMD160;/** HMAC - Optional HMAC-RIPEMD160 */String ALGO_ID_MAC_HMAC_SHA256;/** HMAC - Optional HMAC-SHA256 */String ALGO_ID_MAC_HMAC_SHA384;/** HMAC - Optional HMAC-SHA284 */String ALGO_ID_MAC_HMAC_SHA512;/** HMAC - Optional HMAC-SHA512 */String ALGO_ID_SIGNATURE_ECDSA_SHA1;/** Signature - Optional ECDSAwithSHA1 */String ALGO_ID_SIGNATURE_ECDSA_SHA256;/** Signature - Optional ECDSAwithSHA256 */String ALGO_ID_SIGNATURE_ECDSA_SHA384;/** Signature - Optional ECDSAwithSHA384 */String ALGO_ID_SIGNATURE_ECDSA_SHA512;/** Signature - Optional ECDSAwithSHA512 */SignedInfo signedInfo;/** ds:Signature.ds:SignedInfo element *//** ds:Signature.ds:KeyInfo */boolean followManifestsDuringValidation;/** Checking the digests in References in a Signature are mandatory, but for ... */Element signatureValueElement;/** This creates a new <CODE>ds:Signature</CODE> Element and adds an empty ... *//** Constructor XMLSignature ... */String xmlnsDsPrefixthis.signedInfonew SignedInfo(...)Constants._TAG_SIGNATUREVALUE/** Creates a XMLSignature in a Document ... *//** This will parse the element and construct the Java Objects. ... */Element signedInfoElemAttr signatureValueAttrElement keyInfoElemElement objectElemthis.signatureValueElementthis.keyInfoAttr objectAttrElement childElemnew SignatureProperties(...)/** Returns the completely parsed <code>SignedInfo</code> object. ... *//** Returns the octet value of the SignatureValue element. ... */Base64DecodingException ex/** Base64 encodes and sets the bytes as the content of the SignatureValue ... */ignoreLineBreaks(...)/** Returns the KeyInfo child. If we are in signing mode and the KeyInfo ... */Element firstObjectaddReturnBeforeChild(...)/** Appends an Object (not a <code>java.lang.Object</code> but an Object ... *//** Returns the <code>i<code>th <code>ds:Object</code> child of the signature ... */Element objElemnew ObjectContainer(...)/** Returns the number of all <code>ds:Object</code> elements. ... *//** Digests all References in the SignedInfo, calculates the signature value ... */SignedInfo sigetSignedInfo(...)SignatureAlgorithm sagetSignatureAlgorithm(...)OutputStream sogenerateDigestValues(...)new SignerOutputStream(...)signInOctetStream(...)setSignatureValueElement(...)/** Adds a {@link ResourceResolver} to enable the retrieval of resources. ... */addResourceResolver(...)/** Adds a {@link ResourceResolverSpi} to enable the retrieval of resources. ... *//** Extracts the public key from the certificate and verifies if the signature ... */checkSignatureValue(...)/** Verifies if the signature is valid by redigesting all References, ... */byte[] sigBytesgetAlgorithmURI(...)getJCEProviderName(...)SignerOutputStream soOutputStream bosgetSignatureValue(...)this.followManifestsDuringValidation/** Add a Reference with full parameters to this Signature ... */addDocument(...)/** This method is a proxy method for the {@link Manifest#addDocument} method. ... *//** Adds a Reference with just the URI and the transforms. This used the ... *//** Add a Reference with just this URI. It uses SHA1 by default as the digest ... *//** Add an X509 Certificate to the KeyInfo. This will include the whole cert ... */addCertificate(...)/** Add this public key to the KeyInfo. This will include the complete key in ... *//** Proxy method for {@link SignedInfo#createSecretKey(byte[])}. If you want ... */createSecretKey(...)/** Signal whether Manifest should be automatically validated. ... *//** Get the local name of this element ... */// create an empty SignatureValue; this is filled by setSignatureValueElement// check out SignedInfo child// check to see if it is there// create a SignedInfo object from that element// get signedInfoElem again in case it has changed// check out SignatureValue child// check to see if it exists// <element ref="ds:KeyInfo" minOccurs="0"/>// If it exists use it, but it's not mandatory// <element ref="ds:Object" minOccurs="0" maxOccurs="unbounded"/>// Register Ids of the Object child elements// check to see if we are signing and if we have to create a keyinfo// create the KeyInfo// get the Element from KeyInfo// add it before the object// add it as the last element to the signature//if (this.state != MODE_SIGN) {// throw new XMLSignatureException(//  "signature.operationOnlyBeforeSign");//} catch (XMLSecurityException ex) {// throw new XMLSignatureException("empty", ex);//Create a SignatureAlgorithm object// initialize SignatureAlgorithm for signing// generate digest values for all References in this SignedInfo// get the canonicalized bytes from SignedInfo// set them on the SignatureValue element// see if cert is null// check the values with the public key from the cert//COMMENT: pk suggests it can only be a public key?//check to see if the key is not null// all references inside the signedinfo need to be dereferenced and// digested again to see if the outcome matches the stored value in the// SignedInfo.// If followManifestsDuringValidation is true it will do the same for// References inside a Manifest.//create a SignatureAlgorithms from the SignatureMethod inside//SignedInfo. This is used to validate the signature.// Get the canonicalized (normalized) SignedInfo// retrieve the byte[] from the stored signature// Impossible...// have SignatureAlgorithm sign the input bytes and compare them to// the bytes that were stored in the signature./** All XML Signature related exceptions inherit herefrom. ... *//** Constructor XMLSignatureException *//** Constructor XMLSignatureException ... */import LinkedHashSetimport CanonicalizerBaseimport XMLSecurityRuntimeException/** Class XMLSignatureInput ... */new ArrayList<NodeFilter>(...)InputStream inputOctetStreamProxy;/** Some InputStreams do not support the {@link java.io.InputStream#reset} ... *//* The XMLSignature Input can be either: ... */Set<Node> inputNodeSet;/** The original NodeSet for this XMLSignatureInput */Node subNode;/** The original Element *//** Exclude Node *for enveloped transformations* */boolean excludeComments;boolean isNodeSet;/** A cached bytes *//** Some Transforms may require explicit MIME type, charset (IANA registered ... */String sourceURI;/** Field sourceURI */List<NodeFilter> nodeFilters;/** Node Filter list. */boolean needsToBeExpanded;OutputStream outputStream;DocumentBuilderFactory dfactory;/** Construct a XMLSignatureInput from an octet array. ... *//** Constructs a <code>XMLSignatureInput</code> from an octet stream. The ... */this.inputOctetStreamProxy/** Construct a XMLSignatureInput from a subtree rooted by rootNode. This ... */this.subNode/** Constructor XMLSignatureInput ... */this.inputNodeSet/** Check if the structure needs to be expanded. ... *//** Set if the structure needs to be expanded. ... */this.needsToBeExpanded/** Returns the node set from input which was specified as the parameter of ... *//** Get the Input NodeSet. ... */new LinkedHashSet<Node>(...)getSet(...)Set<Node> resultconvertToNodes(...)/** Returns the Octet stream(byte Stream) from input which was specified as ... *//** Returns the byte array from input which was specified as the parameter of ... */getBytesFromInputStream(...)Canonicalizer20010315OmitComments c14nizernew Canonicalizer20010315OmitComments(...)/** Determines if the object has been set up with a Node set ... *//** Determines if the object has been set up with an Element ... *//** Determines if the object has been set up with an octet stream ... *//** Determines if {@link #setOutputStream} has been called with a ... *//** Determines if the object has been set up with a ByteArray ... *//** Is the object correctly set up? ... *//** Returns mimeType ... *//** Sets mimeType ... */this.mimeType/** Return SourceURI ... *//** Sets SourceURI ... */this.sourceURI/** Method toString ... */IOException iexCanonicalizationException cexXMLSignatureInputDebugger dbnew XMLSignatureInputDebugger(...)/** Gets the exclude node of this XMLSignatureInput ... *//** Sets the exclude node of this XMLSignatureInput ... *//** Gets the node of this XMLSignatureInput ... */this.excludeCommentsCanonicalizerBase c14nizernew Canonicalizer11_OmitComments(...)getBytesFromStream(...)new XMLSecurityRuntimeException(...)// NO defensive copy// select all nodes, also the comments.// if a not-wellformed nodeset exists, put a container around it...import StringWriterimport Writer/** Class XMLSignatureInputDebugger *//** Field _xmlSignatureInput */Set<String> inclusiveNamespaces;/** Field doc */Writer writer;/** Field writer */String HTMLPrefix;/** The HTML Prefix* */String HTMLSuffix;/** HTML Suffix * */String HTMLExcludePrefix;String HTMLIncludePrefix;String HTMLIncludeOrExcludeSuffix;String HTMLIncludedInclusiveNamespacePrefix;String HTMLExcludedInclusiveNamespacePrefix;AttrCompare ATTR_COMPARE;/** Constructor XMLSignatureInputDebugger ... */getInputNodeSet(...)this.inclusiveNamespacesnew StringWriter(...)/** Method canonicalizeXPathNodeSet ... */int currentNodeTypeint positiongetPositionRelativeToDocumentElement(...)Attr[] attrs2new Attr[]Object[] attrs3Attr aboolean includedboolean inclusive/** Checks whether a Comment or ProcessingInstruction is before or after the ... */Element documentElementNode x/** Normalizes an {@link Attr}ibute value ... *//** Normalizes a {@link org.w3c.dom.Comment} value ... *//** Method outputTextToWriter ... */// get only a single node as anchor to fetch the owner document/* The XPath data model allows to select only the first of a ... */// we output all Attrs which are available// included and inclusive// included and not inclusive// excluded and inclusive// excluded and not inclusive// traversal/** An abstract representation of the result of dereferencing a ds:Reference URI. *//* Copyright (c) 2005, 2013, Oracle and/or its affiliates. All rights reserved. *//* $Id$ *//** An abstract representation of a <code>ReferenceData</code> type containing a node-set. *//** Returns a read-only iterator over the nodes contained in this ... *//** A representation of a <code>ReferenceData</code> type containing an OctetStream. */InputStream octetStream;/** Creates a new <code>ReferenceOctetStreamData</code>. ... */this.octetStream/** Returns the input stream of this <code>ReferenceOctetStreamData</code>. ... *//** Returns the URI String identifying the data object represented by this ... *//** Returns the MIME type associated with the data object represented by this ... *//** A representation of a <code>ReferenceNodeSetData</code> type containing a node-set. ... */new DelayedNodeIterator(...)/** This is an Iterator that contains a backing node-set that is ... */List<Node> nodeSet;ListIterator<Node> li;boolean withComments;this.withCommentsdereferenceSameDocumentURI(...)/** Dereferences a same-document URI fragment. ... */List<Node> nodeSetnodeSetMinusCommentNodes(...)/** Recursively traverses the subtree, and returns an XPath-equivalent ... */Node pSibling// emulate XPath which only returns the first node in// contiguous text/cdata nodes/** Constructor InvalidTransformException *//** Constructor InvalidTransformException ... */import TransformBase64Decodeimport TransformC14Nimport TransformC14N11import TransformC14N11_WithCommentsimport TransformC14NExclusiveimport TransformC14NExclusiveWithCommentsimport TransformC14NWithCommentsimport TransformEnvelopedSignatureimport TransformXPathimport TransformXPath2Filterimport TransformXSLTimport HelperNodeList/** Implements the behaviour of the <code>ds:Transform</code> element. ... */new ConcurrentHashMap<String,Class<? extends TransformSpi>>(...)Map<String,Class<? extends TransformSpi>> transformSpiHash;/** All available Transform classes are registered here */TransformSpi transformSpi;/** Generates a Transform object that implements the specified ... */HelperNodeList contextNodesnew HelperNodeList(...)initializeTransform(...)/** Constructs {@link Transform} ... */String algorithmURIClass<? extends TransformSpi> transformSpiClassConstants._TAG_TRANSFORMnew TransformationException(...)new InvalidTransformException(...)Class<? extends TransformSpi> transformSpiTransforms.TRANSFORM_C14N11_WITH_COMMENTSTransforms.TRANSFORM_XPATHTransforms.TRANSFORM_ENVELOPED_SIGNATURETransforms.TRANSFORM_XSLTTransforms.TRANSFORM_XPATH2FILTER/** Transforms the input, and generates {@link XMLSignatureInput} as output. ... */XMLSignatureInput resultenginePerformTransform(...)/** Initialize the transform object. */TransformSpi newTransformSpi// retrieve Algorithm Attribute from ds:Transform// give it to the current document/** Base class which all Transform algorithms extend. The common methods that ... *//** The mega method which MUST be implemented by the Transformation Algorithm. ... *//** Constructor TransformationException *//** Constructor TransformationException ... *//** Holder of the {@link com.sun.org.apache.xml.internal.security.transforms.Transform} steps to ... */String TRANSFORM_C14N_OMIT_COMMENTS;/** Canonicalization - Required Canonical XML (omits comments) */String TRANSFORM_C14N_WITH_COMMENTS;/** Canonicalization - Recommended Canonical XML with Comments */String TRANSFORM_C14N11_OMIT_COMMENTS;/** Canonicalization - Required Canonical XML 1.1 (omits comments) */String TRANSFORM_C14N11_WITH_COMMENTS;/** Canonicalization - Recommended Canonical XML 1.1 with Comments */String TRANSFORM_C14N_EXCL_OMIT_COMMENTS;/** Canonicalization - Required Exclusive Canonicalization (omits comments) */String TRANSFORM_C14N_EXCL_WITH_COMMENTS;/** Canonicalization - Recommended Exclusive Canonicalization with Comments */String TRANSFORM_XSLT;/** Transform - Optional XSLT */String TRANSFORM_BASE64_DECODE;/** Transform - Required base64 decoding */String TRANSFORM_XPATH;/** Transform - Recommended XPath */String TRANSFORM_ENVELOPED_SIGNATURE;/** Transform - Required Enveloped Signature */String TRANSFORM_XPOINTER;/** Transform - XPointer */String TRANSFORM_XPATH2FILTER;/** Transform - XPath Filter */...[] transforms;/** Constructs {@link Transforms}. ... *//** Constructs {@link Transforms} from {@link Element} which is ... */int numberOfTransformElems/** Adds the <code>Transform</code> with the specified <code>Transform ... */Transform transformnew Transform(...)/** Adds a user-provided Transform step. ... */Element transformElement/** Applies all included <code>Transform</code>s to xmlSignatureInput and ... */checkSecureValidation(...)/** Return the nonnegative number of transformations. ... */transforms.length/** Return the <it>i</it><sup>th</sup> <code>{@link Transform}</code>. ... */// At least one Transform element must be present. Bad.import TransformerExceptionimport DTMimport NodeSetDTMimport XPathContextimport Functionimport XNodeSetimport XObjectimport XPATHErrorResources/** The 'here()' function returns a node-set containing the attribute or ... *//** The here function returns a node-set containing the attribute or ... */Node xpathOwnerNodegetOwnerObject(...)int xpathOwnerNodeDTMgetDTMHandleFromNode(...)int currentNodegetCurrentNode(...)DTM dtmgetDTM(...)int docContextXNodeSet nodesnew XNodeSet(...)getDTMManager(...)NodeSetDTM nodeSetmutableNodeset(...)DTM.NULLXPATHErrorResources.ER_CONTEXT_HAS_NO_OWNERDOCDocument currentDocDocument xpathOwnerDocnew TransformerException(...)int hereNodeaddNode(...)detach(...)/** No arguments to process, so this does nothing. ... */// check whether currentNode and the node containing the XPath expression// are in the same document// returns a node-set containing the attribute /  processing instruction node// returns a node-set containing the parent element of the// text node that directly bears the XPath expression/** $todo$ Do I have to do this detach() call? */import TransformSpi/** Implements the <CODE>http://www.w3.org/2000/09/xmldsig#base64</CODE> decoding ... */String implementedTransformURI;/** Field implementedTransformURI */TransformBase64Decode.implementedTransformURI/** Method enginePerformTransform ... */new XMLSignatureInput(...)traverseElement(...)byte[] decodedBytessetOutputStream(...)byte[] base64BytesElement rootNode//Exceptional case there is current not text case testing this(Before it was a//a common case)./** Implements the <CODE>http://www.w3.org/TR/2001/REC-xml-c14n-20010315</CODE> ... */TransformC14N.implementedTransformURICanonicalizer20010315OmitComments c14n/** Implements the <CODE>http://www.w3.org/2006/12/xml-c14n11</CODE> ... */Canonicalizer11_OmitComments c14n/** Implements the <CODE>http://www.w3.org/2006/12/xml-c14n-11#WithComments</CODE> ... */Canonicalizer11_WithComments c14nnew Canonicalizer11_WithComments(...)/** Class TransformC14NExclusive */Canonicalizer20010315ExclOmitComments c14nnew Canonicalizer20010315ExclOmitComments(...)/** Implements the <CODE>http://www.w3.org/TR/2001/REC-xml-c14n-20010315#WithComments</CODE> ... */Canonicalizer20010315ExclWithComments c14nnew Canonicalizer20010315ExclWithComments(...)Canonicalizer20010315WithComments c14nnew Canonicalizer20010315WithComments(...)/** Implements the <CODE>http://www.w3.org/2000/09/xmldsig#enveloped-signature</CODE> ... */Node signatureElementsearchSignatureElement(...)setExcludeNode(...)addNodeFilter(...)new EnvelopedNodeFilter(...)Node exclude;/** @see */isDescendantOrSelf(...)/** If the actual input is an octet stream, then the application MUST ... *///return !XMLUtils.isDescendantOrSelf(exclude,n);import XPathAPIimport XPathFactory/** Class TransformXPath ... */Element xpathElementConstants._TAG_XPATHNode xpathnodegetStrFromNode(...)XPathFactory xpathFactoryXPathAPI xpathAPIInstancenewXPathAPI(...)setNeedsToBeExpanded(...)needsCircumvent(...)DOMException.HIERARCHY_REQUEST_ERRnew XPathNodeFilter(...)setNodeSet(...)DOMException exXPathAPI xPathAPI;Node xpathnode;Element xpathElement;String str;this.xpathnodethis.strthis.xpathElementthis.xPathAPIboolean includeTransformerException eObject[] eArgsimport XPath2FilterContainer/** Implements the <I>XML Signature XPath Filter v2.0</I> ... */List<NodeList> unionNodesnew ArrayList<NodeList>(...)List<NodeList> subtractNodesList<NodeList> intersectNodesElement[] xpathElementsXPath2FilterContainer.XPathFilter2NSXPath2FilterContainer._TAG_XPATH2Document inputDocxpathElements.lengthXPath2FilterContainer xpathContainergetXPathFilterTextNode(...)NodeList subtreeRootsselectNodeList(...)isIntersect(...)isSubtract(...)isUnion(...)new XPath2NodeFilter(...)TransformerException exboolean hasUnionFilter;boolean hasSubtractFilter;boolean hasIntersectFilter;Set<Node> unionNodes;Set<Node> subtractNodes;Set<Node> intersectNodes;int inSubtract;int inIntersect;int inUnion;this.unionNodesconvertNodeListToSet(...)this.subtractNodesthis.intersectNodesrooted(...)inList(...)/** Method rooted ... */Node rootNodenew HashSet<Node>(...)NodeList rootNodes//TODO OPTIMIZE/** Class TransformXPointer ... */Transforms.TRANSFORM_XPOINTERimport Sourceimport Transformerimport TransformerConfigurationExceptionimport TransformerFactoryimport DOMSourceimport StreamResultimport StreamSource/** Class TransformXSLT ... */String XSLTSpecNS;String defaultXSLTSpecNSprefix;String XSLTSTYLESHEET;Element xsltElementTransformerFactory tFactorySource xmlSourcenew StreamSource(...)Source stylesheetTransformer transformernewTransformer(...)StreamResult outputTargetnew StreamResult(...)ByteArrayOutputStream osDOMSource sourcenew DOMSource(...)StreamResult resultsetOutputProperty(...)ByteArrayOutputStream baos1TransformerConfigurationException ex// Process XSLT stylesheets in a secure manner/* This transform requires an octet stream as input. If the actual ... *//* This complicated transformation of the stylesheet itself is necessary ... */// Force Xalan to use \n as line separator on all OSes. This// avoids OS specific signature validation failures due to line// separator differences in the transformed output. Unfortunately,// this is not a standard JAXP property so will not work with non-Xalan// implementations.import TransformParam/** This Object serves as Content for the ds:Transforms for exclusive ... */String _TAG_EC_INCLUSIVENAMESPACES;/** Field _TAG_EC_INCLUSIVENAMESPACES */String _ATT_EC_PREFIXLIST;/** Field _ATT_EC_PREFIXLIST */String ExclusiveCanonicalizationNamespace;/** Field ExclusiveCanonicalizationNamespace *//** Constructor XPathContainer ... *//** Constructor InclusiveNamespaces ... */SortedSet<String> prefixListInclusiveNamespaces._ATT_EC_PREFIXLIST/** Method getInclusiveNamespaces ... *//** Decodes the <code>inclusiveNamespaces</code> String and returns all ... */SortedSet<String> prefixes/** Implements the parameters for the <A ... */XPath2FilterContainer._ATT_FILTER_VALUE_INTERSECTXPath2FilterContainer._ATT_FILTER_VALUE_SUBTRACTXPath2FilterContainer._ATT_FILTER_VALUE_UNIONString _ATT_FILTER;/** Field _ATT_FILTER */String _ATT_FILTER_VALUE_INTERSECT;/** Field _ATT_FILTER_VALUE_INTERSECT */String _ATT_FILTER_VALUE_SUBTRACT;/** Field _ATT_FILTER_VALUE_SUBTRACT */String _ATT_FILTER_VALUE_UNION;/** Field _ATT_FILTER_VALUE_UNION */String INTERSECT;/** Field INTERSECT */String SUBTRACT;/** Field SUBTRACT */String UNION;/** Field UNION */String _TAG_XPATH2;/** Field _TAG_XPATH2 */String XPathFilter2NS;/** Field XPathFiler2NS *//** Constructor XPath2FilterContainer *//** Constructor XPath2FilterContainer ... */XPath2FilterContainer._ATT_FILTERString filterStr/** Creates a new XPath2FilterContainer with the filter type "intersect". ... */new XPath2FilterContainer(...)/** Creates a new XPath2FilterContainer with the filter type "subtract". ... *//** Creates a new XPath2FilterContainer with the filter type "union". ... *//** Method newInstances ... */HelperNodeList nlString xpathXPath2FilterContainer c/** Creates a XPath2FilterContainer from an existing Element; needed for verification. ... *//** Returns <code>true</code> if the <code>Filter</code> attribute has value "intersect". ... *//** Returns <code>true</code> if the <code>Filter</code> attribute has value "subtract". ... *//** Returns <code>true</code> if the <code>Filter</code> attribute has value "union". ... *//** Returns the XPath 2 Filter String ... *//** Returns the first Text node which contains information from the XPath 2 ... *//** Constructor XPath2FilterContainer04 *//** Constructor XPath2FilterContainer04 ... */XPath2FilterContainer04._ATT_FILTERXPath2FilterContainer04._ATT_FILTER_VALUE_INTERSECTXPath2FilterContainer04._ATT_FILTER_VALUE_SUBTRACTXPath2FilterContainer04._ATT_FILTER_VALUE_UNION/** Creates a new XPath2FilterContainer04 with the filter type "intersect". ... */new XPath2FilterContainer04(...)/** Creates a new XPath2FilterContainer04 with the filter type "subtract". ... *//** Creates a new XPath2FilterContainer04 with the filter type "union". ... *//** Creates a XPath2FilterContainer04 from an existing Element; needed for verification. ... */XPath2FilterContainer04._TAG_XPATH2XPath2FilterContainer04.XPathFilter2NS/** This Object serves both as namespace prefix resolver and as container for ... *//** Sets the TEXT value of the <CODE>ds:XPath</CODE> Element. ... */Text xpathText/** Returns the TEXT value of the <CODE>ds:XPath</CODE> Element. ... *//** Implements the parameters for a custom Transform which has a better performance ... */String TRANSFORM_XPATHFILTERCHGP;String _TAG_INCLUDE_BUT_SEARCH;String _TAG_EXCLUDE_BUT_SEARCH;String _TAG_EXCLUDE;String _TAG_XPATHCHGP;/** Field _TAG_XPATHCHGP */String _ATT_INCLUDESLASH;/** Field _ATT_INCLUDESLASH */boolean IncludeSlash;/** Field IncludeSlash */boolean ExcludeSlash;/** Field ExcludeSlash *//** Constructor XPathFilterCHGPContainer *//** Constructor XPathFilterCHGPContainer ... */XPathFilterCHGPContainer._ATT_INCLUDESLASHElement includeButSearchElemXPathFilterCHGPContainer._TAG_INCLUDE_BUT_SEARCHindentXPathText(...)Element excludeButSearchElemXPathFilterCHGPContainer._TAG_EXCLUDE_BUT_SEARCHElement excludeElemXPathFilterCHGPContainer._TAG_EXCLUDE/** Method indentXPathText ... *//** Creates a new XPathFilterCHGPContainer; needed for generation. ... */new XPathFilterCHGPContainer(...)/** Creates a XPathFilterCHGPContainer from an existing Element; needed for verification. ... *//** Method getXStr ... */Element xElem/** Method getIncludeButSearch ... */getXStr(...)/** Method getExcludeButSearch ... *//** Method getExclude ... *//** Method getIncludeSlashPolicy ... *//** Returns the first Text node which contains information from the XPath ... */selectNodeText(...)/** Method getHereContextNodeIncludeButSearch ... */getHereContextNode(...)/** Method getHereContextNodeExcludeButSearch ... *//** Method getHereContextNodeExclude ... */XPathFilterCHGPContainer._TAG_XPATHCHGP/** Implementation of MIME's Base64 encoding and decoding conversions. ... */int BASE64DEFAULTLENGTH;/** Field BASE64DEFAULTLENGTH */int BASELENGTH;int LOOKUPLENGTH;int TWENTYFOURBITGROUP;int EIGHTBIT;int SIXTEENBIT;int FOURBYTE;int SIGN;char PAD;...[] base64Alphabet;...[] lookUpBase64Alphabet;/** Returns a byte-array representation of a <code>{@link BigInteger}<code>. ... */byte[] bigBytesint startSrcint bigLenbigBytes.lengthint startDstbyte[] resizedBytes/** Encode in Base64 the given <code>{@link BigInteger}<code>. ... *//** Method decodeBigIntegerFromElement ... *//** Method decodeBigIntegerFromText ... *//** This method takes an (empty) Element and a BigInteger and adds the ... */String encodedIntText text/** Method decode ... *//** Method encodeToElement ... */decodeInternal(...)/** Encode a byte array and fold lines at the standard 76th character unless ... *//** Base64 decode the lines from the reader and return an InputStream ... */byte[] retBytesUnsyncByteArrayOutputStream baosnew UnsyncByteArrayOutputStream(...)/** Encode a byte array in Base64 format and return an optionally ... *//** Encodes hex octets into Base64 ... */int lengthDataBitsbinaryData.lengthint fewerThan24bitsint numberTripletsint numberQuartetint quartesPerLineint numberLineschar[] encodedDatabyte kbyte lbyte b3int encodedIndexint dataIndexint lineint quartetbyte val1byte val2byte val3/** Decodes Base64 data into octets ... */getBytesInternal(...)byte dataSisWhiteSpace(...)int numberQuadruplebyte[] decodedDatabyte b4byte d3byte d4removeWhiteSpace(...)new Base64DecodingException(...)isPad(...)/** Decodes Base64 data into outputstream ... *//** Decodes Base64 data into  outputstream ... */byte d1byte d2byte readed/** remove WhiteSpace from MIME containing encoded Base64 data. ... */// we don't allow instantiation//round bitlen// some copying needed// no need to skip anything//valid length of the string// correct values// skip sign bit// valid length of the string//pad with leading nulls// form integral number of 6-bit groups//encodedData[encodedIndex] = 0xa;// remove white spaces//should be divisible by four//decodedData = new byte[ (numberQuadruple)*3];//first last bits.//if found "no data" just return null//Check if they are PAD characters//Two PAD e.g. 3c[Pad][Pad]//last 4 bits should be zero//One PAD  e.g. 3cQ[Pad]//last 2 bits should be zero//an error  like "3c[Pad]r", "3cdX", "3cXd", "3cXX" where X is non data//No PAD e.g 3cQl//the begin//byte decodedData[] = null;//  first last bits.// count characters that's not whitespace/** Provides all constants and some translation functions for i18n. ... */String configurationFile;/** Field configurationFile */String configurationFileNew;/** Field configurationFileNew */String exceptionMessagesResourceBundleDir;/** Field exceptionMessagesResourceBundleDir */String exceptionMessagesResourceBundleBase;/** Field exceptionMessagesResourceBundleBase is the location of the <CODE>ResourceBundle</CODE> */String SIGNATURESPECIFICATION_URL;/** The URL of the ... */String SignatureSpecNS;/** The namespace of the ... */String SignatureSpec11NS;String MoreAlgorithmsSpecNS;/** The URL for more algorithms * */String XML_LANG_SPACE_SpecNS;/** The URI for XML spec */String NamespaceSpecNS;/** The URI for XMLNS spec */String _ATT_ALGORITHM;/** Tag of Attr Algorithm* */String _ATT_URI;/** Tag of Attr URI* */String _ATT_TYPE;/** Tag of Attr Type* */String _ATT_ID;/** Tag of Attr Id* */String _ATT_MIMETYPE;/** Tag of Attr MimeType* */String _ATT_ENCODING;/** Tag of Attr Encoding* */String _ATT_TARGET;/** Tag of Attr Target* */String _TAG_CANONICALIZATIONMETHOD;/** Tag of Element CanonicalizationMethod * */// SPKIData (SPKISexp)// PGPData ((PGPKeyID, PGPKeyPacket?) | (PGPKeyPacket))// X509IssuerSerial (X509IssuerName, X509SerialNumber)// X509Data ((X509IssuerSerial | X509SKI | X509SubjectName | X509Certificate)+ | X509CRL)// RetrievalMethod (Transforms?)// RSAKeyValue (Modulus, Exponent)// DSAKeyValue (P, Q, G, Y, J?, (Seed, PgenCounter)?)// KeyValue (DSAKeyValue|RSAKeyValue)// KeyInfo (KeyName|KeyValue|RetrievalMethod|X509Data|PGPData|SPKIData|MgmtData)String _TAG_DIGESTMETHOD;/** Tag of Element DigestMethod * */String _TAG_DIGESTVALUE;/** Tag of Element DigestValue * */String _TAG_MANIFEST;/** Tag of Element Manifest * */String _TAG_METHODS;/** Tag of Element Methods * */String _TAG_OBJECT;/** Tag of Element Object * */String _TAG_REFERENCE;/** Tag of Element Reference * */String _TAG_SIGNATURE;/** Tag of Element Signature * */String _TAG_SIGNATUREMETHOD;/** Tag of Element SignatureMethod * */String _TAG_HMACOUTPUTLENGTH;/** Tag of Element HMACOutputLength * */String _TAG_SIGNATUREPROPERTIES;/** Tag of Element SignatureProperties * */String _TAG_SIGNATUREPROPERTY;/** Tag of Element SignatureProperty * */String _TAG_SIGNATUREVALUE;/** Tag of Element SignatureValue * */String _TAG_SIGNEDINFO;/** Tag of Element SignedInfo * */String _TAG_TRANSFORM;/** Tag of Element Transform * */String _TAG_TRANSFORMS;/** Tag of Element Transforms * */String _TAG_XPATH;/** Tag of Element XPath * */String _TAG_KEYINFO;/** Tag of Element KeyInfo * */String _TAG_KEYNAME;/** Tag of Element KeyName * */String _TAG_KEYVALUE;/** Tag of Element KeyValue * */String _TAG_RETRIEVALMETHOD;/** Tag of Element RetrievalMethod * */String _TAG_X509DATA;/** Tag of Element X509Data * */String _TAG_PGPDATA;/** Tag of Element PGPData * */String _TAG_SPKIDATA;/** Tag of Element SPKIData * */String _TAG_MGMTDATA;/** Tag of Element MgmtData * */String _TAG_RSAKEYVALUE;/** Tag of Element RSAKeyValue * */String _TAG_EXPONENT;/** Tag of Element Exponent * */String _TAG_MODULUS;/** Tag of Element Modulus * */String _TAG_DSAKEYVALUE;/** Tag of Element DSAKeyValue * */String _TAG_P;/** Tag of Element P * */String _TAG_Q;/** Tag of Element Q * */String _TAG_G;/** Tag of Element G * */String _TAG_Y;/** Tag of Element Y * */String _TAG_J;/** Tag of Element J * */String _TAG_SEED;/** Tag of Element Seed * */String _TAG_PGENCOUNTER;/** Tag of Element PgenCounter * */String _TAG_RAWX509CERTIFICATE;/** Tag of Element rawX509Certificate * */String _TAG_X509ISSUERSERIAL;/** Tag of Element X509IssuerSerial * */String _TAG_X509SKI;/** Tag of Element X509SKI * */String _TAG_X509SUBJECTNAME;/** Tag of Element X509SubjectName * */String _TAG_X509CERTIFICATE;/** Tag of Element X509Certificate * */String _TAG_X509CRL;/** Tag of Element X509CRL * */String _TAG_X509ISSUERNAME;/** Tag of Element X509IssuerName * */String _TAG_X509SERIALNUMBER;/** Tag of Element X509SerialNumber * */String _TAG_PGPKEYID;/** Tag of Element PGPKeyID * */String _TAG_PGPKEYPACKET;/** Tag of Element PGPKeyPacket * */String _TAG_DERENCODEDKEYVALUE;String _TAG_KEYINFOREFERENCE;String _TAG_X509DIGEST;String _TAG_SPKISEXP;/** Tag of Element SPKISexp * */String ALGO_ID_SIGNATURE_ECDSA_CERTICOM;/** @see ... */import NamespaceContextMap<String,String> namespaceMap;addNamespaces(...)NamedNodeMap mapMessageDigestAlgorithm mda;this.mdaarg0.length/** Check that the element is the one expect ... *//** A checker for DOM that interns NS */String expectedLocalnameString expectedNamespaceString localnameISString namespaceIS/** An empty checker if schema checking is used *//** This is the base class to all Objects which have a direct 1:1 mapping to an ... */new ConcurrentHashMap<String,String>(...)Element constructionElement;/** Field constructionElement */String baseURI;/** Field baseURI */Map<String,String> prefixMappings;/** Field prefixMappings *//** Constructor ElementProxy *//** Constructor ElementProxy ... */guaranteeThatElementInCorrectSpace(...)/** Returns the namespace of the Elements of the sub-class. ... *//** Returns the localname of the Elements of the sub-class. ... */createElementNS(...)String baseName/** This method creates an Element in a given namespace with a given localname. ... *//** Method setElement ... *//** Returns the Element which was constructed by the Object. ... *//** Returns the Element plus a leading and a trailing CarriageReturn Text node. ... *//** Method getDocument ... *//** Method getBaseURI ... *//** Method guaranteeThatElementInCorrectSpace ... */String expectedLocalNameString expectedNamespaceUriString actualLocalNameString actualNamespaceUri/** Method addBigIntegerElement ... */fillElementWithBigInteger(...)/** Method addBase64Element ... */encodeToElement(...)/** Method addTextElement ... *//** Method addBase64Text ... *//** Method addText ... *//** Method getVal ... */decodeBigIntegerFromText(...)/** Method getBytesFromChildElement ... *//** Method getTextFromChildElement ... */getTextContent(...)/** Method getBytesFromTextChild ... *//** Method getTextFromTextChild ... */int number/** Adds an xmlns: definition to the Element. This can be called as follows: ... */String ns/** Method setDefaultPrefix ... */String storedPrefixsetDsPrefix(...)setXencPrefix(...)/** This method registers the default prefixes. *//** Method getDefaultPrefix ... *///"xmlns:" + prefix.substring("xmlns:".length());/** Tag of Attr Algorithm * */// Attributes that exist in XML Signature in the same way/** Tag of Attr Target * *//** Tag of Attr Type * *//** Tag of Attr URI * *//** Tag of Attr encoding * */// Attributes new in XML EncryptionString _ATT_RECIPIENT;/** Tag of Attr recipient * *//** Tag of Attr mimetype * */String _TAG_CARRIEDKEYNAME;/** Tag of Element CarriedKeyName * */String _TAG_CIPHERDATA;/** Tag of Element CipherData * */String _TAG_CIPHERREFERENCE;/** Tag of Element CipherReference * */String _TAG_CIPHERVALUE;/** Tag of Element CipherValue * */String _TAG_DATAREFERENCE;/** Tag of Element DataReference * */String _TAG_ENCRYPTEDDATA;/** Tag of Element EncryptedData * */String _TAG_ENCRYPTEDKEY;/** Tag of Element EncryptedKey * */String _TAG_ENCRYPTIONMETHOD;/** Tag of Element EncryptionMethod * */String _TAG_ENCRYPTIONPROPERTIES;/** Tag of Element EncryptionProperties * */String _TAG_ENCRYPTIONPROPERTY;/** Tag of Element EncryptionProperty * */String _TAG_KEYREFERENCE;/** Tag of Element KeyReference * */String _TAG_KEYSIZE;/** Tag of Element KeySize * */String _TAG_OAEPPARAMS;/** Tag of Element OAEPparams * */String _TAG_MGF;/** Tag of Element MGF * */String _TAG_REFERENCELIST;/** Tag of Element ReferenceList * */String _TAG_AGREEMENTMETHOD;/** Tag of Element AgreementMethod * */String _TAG_KA_NONCE;/** Tag of Element KA-Nonce * */String _TAG_ORIGINATORKEYINFO;/** Tag of Element OriginatorKeyInfo * */String _TAG_RECIPIENTKEYINFO;/** Tag of Element RecipientKeyInfo * */String ENCRYPTIONSPECIFICATION_URL;/** Field ENCRYPTIONSPECIFICATION_URL */String EncryptionSpecNS;String EncryptionSpec11NS;/** The namespace of the XML Encryption 1.1 specification */String TYPE_CONTENT;/** URI for content */String TYPE_ELEMENT;/** URI for element */String TYPE_MEDIATYPE;/** URI for mediatype */String ALGO_ID_BLOCKCIPHER_TRIPLEDES;/** Block Encryption - REQUIRED TRIPLEDES */String ALGO_ID_BLOCKCIPHER_AES128;/** Block Encryption - REQUIRED AES-128 */String ALGO_ID_BLOCKCIPHER_AES256;/** Block Encryption - REQUIRED AES-256 */String ALGO_ID_BLOCKCIPHER_AES192;/** Block Encryption - OPTIONAL AES-192 */String ALGO_ID_BLOCKCIPHER_AES128_GCM;/** Block Encryption - OPTIONAL AES-128-GCM */String ALGO_ID_BLOCKCIPHER_AES192_GCM;/** Block Encryption - OPTIONAL AES-192-GCM */String ALGO_ID_BLOCKCIPHER_AES256_GCM;/** Block Encryption - OPTIONAL AES-256-GCM */String ALGO_ID_KEYTRANSPORT_RSA15;/** Key Transport - REQUIRED RSA-v1.5 */String ALGO_ID_KEYTRANSPORT_RSAOAEP;/** Key Transport - REQUIRED RSA-OAEP */String ALGO_ID_KEYTRANSPORT_RSAOAEP_11;/** Key Transport - OPTIONAL RSA-OAEP_11 */String ALGO_ID_KEYAGREEMENT_DH;/** Key Agreement - OPTIONAL Diffie-Hellman */String ALGO_ID_KEYWRAP_TRIPLEDES;/** Symmetric Key Wrap - REQUIRED TRIPLEDES KeyWrap */String ALGO_ID_KEYWRAP_AES128;/** Symmetric Key Wrap - REQUIRED AES-128 KeyWrap */String ALGO_ID_KEYWRAP_AES256;/** Symmetric Key Wrap - REQUIRED AES-256 KeyWrap */String ALGO_ID_KEYWRAP_AES192;/** Symmetric Key Wrap - OPTIONAL AES-192 KeyWrap */String ALGO_ID_AUTHENTICATION_XMLSIGNATURE;/** Message Authentication - RECOMMENDED XML Digital Signature */String ALGO_ID_C14N_WITHCOMMENTS;/** Canonicalization - OPTIONAL Canonical XML with Comments */String ALGO_ID_C14N_OMITCOMMENTS;/** Canonicalization - OPTIONAL Canonical XML (omits comments) */String ALGO_ID_ENCODING_BASE64;/** Encoding - REQUIRED base64 */String MGF1_SHA1;/** MGF1 with SHA-1 */String MGF1_SHA224;/** MGF1 with SHA-224 */String MGF1_SHA256;/** MGF1 with SHA-256 */String MGF1_SHA384;/** MGF1 with SHA-384 */String MGF1_SHA512;/** MGF1 with SHA-512 *//** This is the base object for all objects which map directly to an Element from ... *//** Constructor EncryptionElementProxy ... */List<Node> nodes;/** Field nodes */boolean allNodesMustHaveSameParent;this.allNodesMustHaveSameParent/** Method item ... *//** Method getLength ... *//** The Internationalization (I18N) pack. ... */String NOT_INITIALIZED_MSG;/** Field NOT_INITIALIZED_MSG */ResourceBundle resourceBundle;/** Field resourceBundle *//** Constructor I18n *//** Method translate ... *//** Method getExceptionMessage ... */isInitialized(...)I18n.NOT_INITIALIZED_MSG/** Method init ... */I18n.resourceBundle/** Purpose of this class is to enable the XML Parser to keep track of ID ... *//** Method registerElementById ... *//** Method getElementById ... */getElementById(...)import ErrorHandlerimport SAXParseException/** This {@link org.xml.sax.ErrorHandler} does absolutely nothing but log ... */boolean warnOnExceptions;/** Field throwExceptions */boolean throwExceptions;IgnoreAllErrorHandler.warnOnExceptionsIgnoreAllErrorHandler.throwExceptionsimport XPathimport XPathConstantsimport XPathExpressionimport XPathExpressionExceptionimport XPathFactoryConfigurationException/** An implementation for XPath evaluation that uses the JDK API. */XPathFactory xpf;String xpathStr;XPathExpression xpathExpression;/** Use an XPath string to select a nodelist. ... */XPath xpathnewXPath(...)XPathFactoryConfigurationException exsetNamespaceContext(...)new DOMNamespaceContext(...)compile(...)XPathExpressionException exXPathConstants.NODESET/** Evaluate an XPath string and return true if the output is to be included or not. ... */Boolean resultXPathConstants.BOOLEAN/** Clear any context information from this object *//** A Factory to return a JDKXPathAPI instance. *//** Get a new XPathAPI instance */new JDKXPathAPI(...)import SecurityPermission/** A collection of different, general-purpose methods for JAVA-specific things ... */new SecurityPermission(...)SecurityPermission REGISTER_PERMISSION;/** Method getBytesFromFile ... */byte[] refBytesFileInputStream fisRef/** Method writeBytesToFilename ... *//** This method reads all bytes from the given InputStream till EOF and ... *//** Converts an ASN.1 DSA value to a XML Signature DSA Value. ... *//** Converts an XML Signature DSA Value to a ASN.1 DSA value. ... *//** Throws a {@code SecurityException} if a security manager is installed ... *//** Method rfc2253toXMLdsig ... */String normalizedrfctoXML(...)/** Method xmldsigtoRFC2253 ... */xmltoRFC(...)/** Method normalize ... */semicolonToComma(...)countQuotes(...)parseRDN(...)/** Method parseRDN ... */parseATAV(...)/** Method parseATAV ... */normalizeAT(...)normalizeV(...)/** Method normalizeAT ... */String at/** Method normalizeV ... */StringReader sr/** Method rfctoXML ... */changeLess32toXML(...)changeWStoXML(...)/** Method xmltoRFC ... */changeLess32toRFC(...)changeWStoRFC(...)/** Method changeLess32toRFC ... *//** Method changeLess32toXML ... *//** Method changeWStoXML ... *//** Method changeWStoRFC ... *//** Method semicolonToComma ... */removeWSandReplace(...)/** Method removeWhiteSpace ... *//** Method removeWSandReplace ... *//** Returns the number of Quotation from i to j ... *//** Method trim ... *///only for the end of a space character occurring at the end of the string from rfc2253String trimed// Transform from RFC1779 to RFC2253//if empty string//for name component// only normalize if value is a String//the following char is defined at 4.Relationship with RFC1779 and LDAPv2 inrfc2253//65 (A) 97 (a)/** Class SignatureElementProxy ... *//** Constructor Signature11ElementProxy ... */createElementInSignature11Space(...)/** Constructor SignatureElementProxy ... */SignatureAlgorithm sa;this.saXMLSignatureException e/** A class that buffers without synchronizing its methods ... */int pointer;/** Creates a buffered output stream without synchronization ... */int newLenflushBuffer(...)/** A simple Unsynced ByteArrayOutputStream ... */int INITIAL_SIZE;int newPosnew OutOfMemoryError(...)expandSize(...)byte[] newBuf// Deal with overflow/** DOM and XML accessibility and comfort functions. ... */boolean ignoreLineBreaks;String dsPrefix;String ds11Prefix;String xencPrefix;String xenc11Prefix;/** Constructor XMLUtils *//** Set the prefix for the digital signature namespace ... *//** Set the prefix for the digital signature 1.1 namespace ... *//** Set the prefix for the encryption namespace ... *//** Set the prefix for the encryption namespace 1.1 ... */getSetRec(...)NamedNodeMap nlNode r/** Outputs a DOM tree to an {@link OutputStream}. ... */outputDOM(...)/** Outputs a DOM tree to an {@link OutputStream}. <I>If an Exception is ... *//** Serializes the <CODE>contextNode</CODE> into the OutputStream, <I>but ... *//** Method getFullTextChildrenFromElement ... *//** Creates an Element in the XML Signature specification namespace. ... *//** Creates an Element in the XML Signature 1.1 specification namespace. ... *//** Creates an Element in the XML Encryption specification namespace. ... *//** Creates an Element in the XML Encryption 1.1 specification namespace. ... *//** Returns true if the element is in XML Signature namespace and the local ... *//** Returns true if the element is in XML Signature 1.1 namespace and the local ... *//** Returns true if the element is in XML Encryption namespace and the local ... *//** Returns true if the element is in XML Encryption 1.1 namespace and the local ... *//** This method returns the owner document of a particular node. ... */NullPointerException npe/** This method returns the first non-null owner document of the Nodes in this Set. ... */int nodeTypeNullPointerException e/** Method createDSctx ... */Element ctx/** Method addReturnToElement ... *//** Method convertNodelistToSet ... */Set<Node> set/** This method spreads all namespace attributes in a DOM document to their ... */Attr xmlnsAttrcircumventBug2650internal(...)/** This is the work horse for {@link #circumventBug2650}. ... */String namespaceNsint attributesLengthElement childElementAttr currentAttrhasAttributeNS(...)Node.ENTITY_REFERENCE_NODEList<Element> listSet<Node> resultSetIterator<Node> iteratorNode inputNode/** Method getStrFromNode ... */Node currentSibling/** Returns true if the descendantOrSelf is on the descendant-or-self axis ... *//** Returns the attribute value for the attribute with the specified name. ... *//** This method is a tree-search to help prevent against wrapping attacks. It checks that no ... */Node startParentNode processedNodeElement foundElementElement seisId(...)/** This method is a tree-search to help prevent against wrapping attacks. It checks that no other ... *///no return keep working// throw new RuntimeException(ex.getMessage());// if the document element has no xmlns definition, we add xmlns=""// we iterate over all siblings of the context node because eventually,// the text is "polluted" with pi's or comments// Continue searching to find duplicates// no child, this node is done.// close node processing, get sibling// no more siblings, get parent, all children// of parent are processed.// close parent node processing (processed node now)/** An interface to abstract XPath evaluation *//** A Factory to return an XPathAPI instance. If Xalan is available it returns XalanXPathAPI. If not, then ... */Class<?> funcTableClassboolean xalanInstalled;/** Get a new XPathFactory instance */isXalanInstalled(...)new JDKXPathFactory(...)isInstalled(...)new XalanXPathFactory(...)// Xalan is available// Some problem was encountered in fixing up the Xalan FunctionTable so fall back to the// JDK implementationimport ErrorListenerimport SourceLocatorimport FuncHereimport PrefixResolverimport PrefixResolverDefaultimport FunctionTable/** An implementation of XPathAPI using Xalan. This supports the "here()" function defined in the digital ... */fixupFunctionTable(...)XPath xpath;FunctionTable funcTable;boolean installed;XPathContext context;XObject listeval(...)nodelist(...)XObject objectbool(...)Node resolverNodePrefixResolverDefault prefixResolvernew PrefixResolverDefault(...)int ctxtNodenew XPathContext(...)setSecureProcessing(...)createXPath(...)Class<?>[] classesXPath.SELECTnew XPath(...)Class<?>[] argsMethod installFunctionModifier.STATICnew FuncHere(...)new FunctionTable(...)// Execute the XPath, and have it return the result// Return a NodeList.// Create an object to resolve namespace prefixes.// XPath namespaces are resolved from the input context node's document element// if it is a root node, or else the current context node (for lack of a better// resolution space, given the simplicity of this sample code)./** Try to register our here() implementation as internal function. *//** A Factory to return a XalanXPathAPI instance. */new XalanXPathAPI(...)import ResolverDirectHTTPimport ResolverFragmentimport ResolverLocalFilesystemimport ResolverXPointer/** During reference validation, we have to retrieve resources from somewhere. ... */List<ResourceResolver> resolverList;/** these are the system-wide resolvers */ResourceResolverSpi resolverSpi;/** Constructor ResourceResolver ... */this.resolverSpiResourceResolverContext contextnew ResourceResolverContext(...)internalGetInstance(...)context.baseUricontext.uriToResolveResourceResolver resolverTmpengineIsThreadSafe(...)new ResourceResolverException(...)context.attrcanResolve(...)context.secureValidationresolverTmp.resolverSpiString currentClass/** Registers a ResourceResolverSpi class. This method logs a warning if ... */Class<ResourceResolverSpi> resourceResolverClass/** Registers a ResourceResolverSpi class at the beginning of the provider ... *//** Registers a ResourceResolverSpi class. This method logs a warning if the class ... */ResourceResolverSpi resourceResolverSpi/** Registers a ResourceResolverSpi instance. This method logs a warning if the class ... */new ResolverFragment(...)new ResolverLocalFilesystem(...)new ResolverXPointer(...)new ResolverDirectHTTP(...)/** Method resolve ... */engineResolveURI(...)/** Method addProperties ... */engineAddProperies(...)/** Method getPropertyKeys ... */engineGetPropertyKeys(...)/** Method canResolve ... */engineCanResolveURI(...)// Check to see whether the Resolver is allowed// first check the individual Resolversthis.attrthis.baseUrithis.uriToResolveString uriToResolve;String baseUri;Attr attr;/** This Exception is thrown if something related to the ... */Attr uri;/** Constructor ResourceResolverException ... *//** Deprecated - used to carry state about whether resolution was being done in a secure fashion, ... *//** This is the workhorse method used to resolve resources. ... */engineResolve(...)/** Tells if the implementation does can be reused by several threads safely. ... *//** This method helps the {@link ResourceResolver} to decide whether a ... *//** Method engineGetPropertyKeys ... */String[] understoodunderstood.length/** Fixes a platform dependent filename to standard URI form. ... */char ch0char ch1char ch2char ch3boolean isDosFilename// The default implementation, to preserve backwards compatibility in the// test cases, calls the old resolver API.// This method used to be abstract, so any calls to "super" are bogus.// To preserve backward compatibility with existing resolvers that might override the old method,// call the old deprecated API.// handle platform dependent strings// str =~ /^\W:\/([^/])/ # to speak perl ;-))// Windows fiximport ResourceResolverContextimport URLConnection/** A simple ResourceResolver for HTTP requests. This class handles only 'pure' ... */...[] properties;/** Field properties[] */int HttpProxyHost;/** Field HttpProxyHost */int HttpProxyPort;/** Field HttpProxyPort */int HttpProxyUser;/** Field HttpProxyUser */int HttpProxyPass;/** Field HttpProxyPass */int HttpBasicUser;int HttpBasicPass;URI uriNewgetNewURI(...)URLConnection urlConnectionString mimeTypeint summarizedResolverDirectHTTP.propertiesResolverDirectHTTP.HttpBasicUserResolverDirectHTTP.HttpBasicPassString passwordString encodedPasswordsetMIMEType(...)String proxyHostPropResolverDirectHTTP.HttpProxyHostString proxyPortPropResolverDirectHTTP.HttpProxyPortString proxyUserResolverDirectHTTP.HttpProxyUserString proxyPassResolverDirectHTTP.HttpProxyPassProxy proxynew Proxy(...)Proxy.Type.HTTPnew InetSocketAddress(...)Proxy.TypeString authString/** We resolve http URIs <I>without</I> fragment... ... */URI newUrigetFragment(...)URI uriNewNoFraggetSchemeSpecificPart(...)// calculate new URI// check if Basic authentication is required// do http basic authentication// set authentication property in the http header// if the URI contains a fragment, ignore it/** This resolver is used for resolving same-document URIs like URI="" of URI="#id". ... *//** Method engineResolve ... */Node selectedElemElement startprotectAgainstWrappingAttack(...)setExcludeComments(...)/** Method engineCanResolve ... *//* Identifies the node-set (minus any comment nodes) of the XML ... *//* URI="#chapter1" ... *//** A simple ResourceResolver for requests into the local filesystem. */int FILE_URI_LENGTH;String fileNametranslateUriToFilename(...)FileInputStream inputStream/** Method translateUriToFilename ... */String subStrStringBuilder temp// we're running M$ Windows, so this works fine// we're running some UNIX, so we have to prepend a slash/** Handles barename XPointer Reference URIs. ... */String XP;int XP_LENGTH;Node resultNodeisXPointerSlash(...)isXPointerId(...)getXPointerId(...)/** Method isXPointerSlash ... *//** Method isXPointerId ... */String idPlusDelimint idLen/** Method getXPointerId ... *//** The ExecOptionPermission class represents permission for rmid to use ... */boolean wildcard;/** does this permission have a wildcard at the end? *//** the name without the wildcard on the end *//** UID for serialization *//** Checks if the specified permission is "implied" by ... */ExecOptionPermission thatthis.wildcardthat.wildcard/** Checks two ExecOptionPermission objects for equality. ... *//** Returns the hash code value for this object. ... *//** Returns the canonical string representation of the actions. ... *//** Returns a new PermissionCollection object for storing ... */new ExecOptionPermissionCollection(...)/** readObject is called to restore the state of the ExecOptionPermission ... *//** Initialize a ExecOptionPermission object. Common to all constructors. ... *//** A ExecOptionPermissionCollection stores a collection ... */Hashtable<String,Permission> permissions;boolean all_allowed;// true if "*" is in the collection/** Create an empty ExecOptionPermissionCollection. */new Hashtable<String,Permission>(...)/** Adds a permission to the collection. The key for the hash is ... */ExecOptionPermission p/** Check and see if this set of permissions implies the permissions ... */Permission ximplies(...)/** Returns an enumeration of all the ExecOptionPermission objects in the ... */// one wildcard can imply another// make sure p.name is longer so a.b.* doesn't imply a.b// a non-wildcard can't imply a wildcard// init is called to initialize the rest of the values.// short circuit if the "*" Permission was added// strategy:// Check for full match first. Then work our way up the// name looking for matches on a.b.*// we have a direct hit!// work our way up the tree...// check for "=*" wildcard match// we don't have to check for "*" as it was already checked// at the top (all_allowed), so we just return false/** The ExecPermission class represents permission for rmid to execute ... */FilePermission fp;/** Creates a new ExecPermission object with the specified path. ... *//** Checks if this ExecPermission object "implies" the specified permission. ... */ExecPermission thatthat.fp/** Checks two ExecPermission objects for equality. ... */this.fpnew ExecPermissionCollection(...)/** readObject is called to restore the state of the ExecPermission ... *//** Initialize a ExecPermission object. Common to all constructors. ... *//** A ExecPermissionCollection stores a collection ... */Vector<Permission> permissions;/** Create an empty ExecPermissionCollection. */new Vector<Permission>(...)/** Adds a permission to the collection. ... */Enumeration<Permission> eExecPermission x/** Returns an enumeration of all the ExecPermission objects in the ... */import java.sql.*import javax.sql.*import java.text.*import javax.sql.rowset.*import javax.sql.rowset.spi.*import javax.sql.rowset.serial.*import com.sun.rowset.internal.*import com.sun.rowset.providers.*/** The standard implementation of the <code>CachedRowSet</code> interface. ... */SyncProvider provider;/** The <code>SyncProvider</code> used by the CachedRowSet */RowSetReader rowSetReader;/** The <code>RowSetReaderImpl</code> object that is the reader ... */RowSetWriter rowSetWriter;/** The <code>RowSetWriterImpl</code> object that is the writer ... *//** The <code>Connection</code> object that connects with this ... */ResultSetMetaData RSMD;/** The <code>ResultSetMetaData</code> object that contains information ... */RowSetMetaDataImpl RowSetMD;/** The <code>RowSetMetaData</code> object that contains information about ... */...[] keyCols;/** An array containing the columns in this <code>CachedRowSetImpl</code> ... */// Properties of this RowSetString tableName;/** The name of the table in the underlying database to which updates ... */Vector<Object> rvh;/** A <code>Vector</code> object containing the <code>Row</code> ... */int cursorPos;/** The current position of the cursor in this <code>CachedRowSetImpl</code> ... */int absolutePos;int numDeleted;/** The number of deleted rows currently in this <code>CachedRowSetImpl</code> ... */int numRows;/** The total number of rows currently in this <code>CachedRowSetImpl</code> ... */InsertRow insertRow;/** A special row used for constructing a new row. A new ... */boolean onInsertRow;/** A <code>boolean</code> indicating whether the cursor is ... */int currentRow;/** The field that temporarily holds the last position of the ... */boolean lastValueNull;/** A <code>boolean</code> indicating whether the last value ... */SQLWarning sqlwarn;/** A <code>SQLWarning</code> which logs on the warnings */String strMatchColumn;/** Used to track match column for JoinRowSet consumption */int iMatchColumn;RowSetWarning rowsetWarning;/** A <code>RowSetWarning</code> which logs on the warnings */String DEFAULT_SYNC_PROVIDER;/** The default SyncProvider for the RI CachedRowSetImpl */boolean dbmslocatorsUpdateCopy;/** The boolean variable indicating locatorsUpdateValue */ResultSet resultSet;/** The <code>ResultSet</code> object that is used to maintain the data when ... */int endPos;/** The integer value indicating the end position in the ResultSetwhere the picking ... */int prevEndPos;int startPos;/** The integer value indicating the position in the ResultSet, to populate the ... */int startPrev;/** The integer value indicating the position from where the page prior to this ... */int pageSize;/** The integer value indicating size of the page. */int maxRowsreached;/** The integer value indicating number of rows that have been processed so far. ... */boolean pagenotend;/** The boolean value when true signifies that pages are still to follow and a ... */boolean onFirstPage;/** The boolean value indicating whether this is the first page or not. */boolean onLastPage;/** The boolean value indicating whether this is the last page or not. */int populatecallcount;/** The integer value indicating how many times the populate function has been called. */int totalRows;/** The integer value indicating the total number of rows to be processed in the ... */boolean callWithCon;/** The boolean value indicating how the CahedRowSet object has been populated for ... */CachedRowSetReader crsReader;/** CachedRowSet reader object to read the data from the ResultSet when a connection ... */Vector<Integer> iMatchColumns;/** The Vector holding the Match Columns */Vector<String> strMatchColumns;/** The Vector that will hold the Match Column names. */boolean tXWriter;/** Trigger that indicates whether the active SyncProvider is exposes the ... */TransactionalWriter tWriter;/** The field object for a transactional RowSet writer */JdbcRowSetResourceBundle resBundle;boolean updateOnInsert;/** Constructs a new default <code>CachedRowSetImpl</code> object with ... */getJdbcRowSetResourceBundle(...)new SQLException(...)getRowSetReader(...)getRowSetWriter(...)initParams(...)initContainer(...)initProperties(...)new SQLWarning(...)new RowSetWarning(...)/** Provides a <code>CachedRowSetImpl</code> instance with the same default properties as ... */String providerNameSyncFactory.ROWSET_SYNC_PROVIDER/** Sets the <code>rvh</code> field to a new <code>Vector</code> ... */new Vector<Object>(...)/** Sets the properties for this <code>CachedRowSetImpl</code> object to ... */setShowDeleted(...)setQueryTimeout(...)setMaxRows(...)setMaxFieldSize(...)setConcurrency(...)ResultSet.CONCUR_UPDATABLEsetTransactionIsolation(...)Connection.TRANSACTION_READ_COMMITTEDsetEscapeProcessing(...)checkTransactionalWriter(...)new Vector<Integer>(...)/** Determine whether the SyncProvider's writer implements the ... */Class<?>[] theInterfacestheInterfaces.lengthestablishTransactionalWriter(...)/** Sets an private field to all transaction bounddaries to be set *//** Sets this <code>CachedRowSetImpl</code> object's command property ... *///-----------------------------------------------------------------------// PropertiessetCommand(...)buildTableName(...)setTableName(...)/** Populates this <code>CachedRowSetImpl</code> object with data from ... *///---------------------------------------------------------------------// Reading and writing dataint rowsFetchedRow currentRowint numColsMap<String,Class<?>> mapgetTypeMap(...)int mRowsthis.resultSetgetMetaData(...)new RowSetMetaDataImpl(...)initMetaData(...)getColumnCount(...)getMaxRows(...)new Row(...)setNextWarning(...)new SerialStruct(...)new SerialBlob(...)new SerialClob(...)new SerialArray(...)initColumnObject(...)notifyRowSetChanged(...)/** Initializes the given <code>RowSetMetaData</code> object with the values ... */setColumnCount(...)getColumnDisplaySize(...)int precisiongetPrecision(...)setAutoIncrement(...)isAutoIncrement(...)setCaseSensitive(...)isCaseSensitive(...)setCurrency(...)isCurrency(...)setNullable(...)isNullable(...)setSigned(...)isSigned(...)setSearchable(...)isSearchable(...)setColumnDisplaySize(...)setColumnLabel(...)getColumnLabel(...)setColumnName(...)getColumnName(...)setSchemaName(...)getSchemaName(...)setPrecision(...)getTableName(...)setCatalogName(...)getCatalogName(...)setColumnType(...)getColumnType(...)setColumnTypeName(...)getColumnTypeName(...)locatorsUpdateCopy(...)/** Populates this <code>CachedRowSetImpl</code> object with data, ... */getPageSize(...)setStartPosition(...)/** Sets this <code>CachedRowSetImpl</code> object's connection property ... *//** Propagates all row update, insert, and delete changes to the ... */int saveCursorPosboolean conflictnew SyncProviderException(...)writeData(...)rollback(...)setOriginal(...)SyncProviderException speSQLException eacceptChanges(...)/** Restores this <code>CachedRowSetImpl</code> object to its original state, ... */getInserted(...)getDeleted(...)clearDeleted(...)getUpdated(...)clearUpdated(...)/** Releases the current contents of this <code>CachedRowSetImpl</code> ... *//** Cancels deletion of the current row and notifies listeners that ... */getCurrentRow(...)getShowDeleted(...)checkCursor(...)notifyRowChanged(...)/** Immediately removes the current row from this ... *//** Immediately reverses the last update operation if the ... */moveToCurrentRow(...)undoDelete(...)undoInsert(...)/** Returns a new <code>RowSet</code> object backed by the same data as ... */// ViewsRowSet cloneCloneNotSupportedException ex/** Returns a new <code>RowSet</code> object containing by the same data ... *//** Creates a <code>RowSet</code> object that is a deep copy of ... */ObjectOutputStream outByteArrayOutputStream bOutObjectInputStream inStreamCorruptedException exCachedRowSetImpl crsTempcrsTemp.resBundlethis.resBundleOptionalDataException ex/** Creates a <code>RowSet</code> object that is a copy of ... */int nRowsCachedRowSet crscreateCopy(...)/** Creates a <code>CachedRowSet</code> object that is a copy of ... */CachedRowSetImpl crsunsetMatchColumn(...)getMatchColumnIndexes(...)SQLException sqlegetMatchColumnNames(...)/** Converts this <code>CachedRowSetImpl</code> object to a collection ... */TreeMap<Integer,Object> tMapnew TreeMap<Integer,Object>(...)/** Returns the specified column of this <code>CachedRowSetImpl</code> object ... */Vector<Object> vectoCollection(...)getColIdxByName(...)/** Returns the <code>SyncProvider</code> implementation being used ... */// Advanced features/** Sets the active <code>SyncProvider</code> and attempts to load ... *//** Populates this <code>CachedRowSetImpl</code> object with data. ... *///-----------------// methods inherited from RowSet/** Moves the cursor down one row from its current position and ... *///-----------------------------------// Methods inherited from ResultSetinternalNext(...)notifyCursorMoved(...)/** Moves this <code>CachedRowSetImpl</code> object's cursor to the next ... */rowDeleted(...)/** Closes this <code>CachedRowSetImpl</code> objecy and releases any resources ... *//** Reports whether the last column read was SQL <code>NULL</code>. ... *//** Sets the field <code>lastValueNull</code> to the given ... *//** Checks to see whether the given index is a valid column number ... */// Methods for accessing results by column index/** Checks to see whether the cursor for this <code>CachedRowSetImpl</code> ... */isAfterLast(...)isBeforeFirst(...)/** Returns the column number of the column with the given name in this ... */int colsString colName/** Returns the insert row or the current row of this ... *//** Removes the row on which the cursor is positioned. ... */setDeleted(...)/** Retrieves the value of the designated column in the current row ... */setLastValueNull(...)getColumnObject(...)parseDouble(...)BigDecimal bDecimalBigDecimal retValnew BigDecimal(...)getBigDecimal(...)Types.DATElong secTypes.TIMESTAMPTypes.CHARTypes.VARCHARTypes.LONGVARCHARDateFormat dfgetDateInstance(...)ParseException exTypes.TIMEnew Time(...)DateFormat tfgetTimeInstance(...)new Timestamp(...)/** Retrieves the value of the designated column in the current row of this ... */isString(...)/** A column value can be retrieved as a stream of Unicode characters ... */new StringBufferInputStream(...)/** Retrieves the value stored in the designated column ... */// Methods for accessing results by column namegetTimestamp(...)getAsciiStream(...)getUnicodeStream(...)getBinaryStream(...)/** The first warning reported by calls on this <code>CachedRowSetImpl</code> ... */// Advanced features:/** Clears all the warnings reporeted for the <code>CachedRowSetImpl</code> ... *//** Retrieves the name of the SQL cursor used by this ... *//** Retrieves a <code>ResultSetMetaData</code> object instance that ... */Struct sgetSQLTypeName(...)SQLData objObject[] attribsSQLInputImpl sqlInputnew SQLInputImpl(...)readSQL(...)/** Maps the given column name for one of this <code>CachedRowSetImpl</code> ... *///----------------------------------------------------------------// Getter's and Setter's//--------------------------JDBC 2.0-----------------------------------getCharacterStream(...)/** Returns the number of rows in this <code>CachedRowSetImpl</code> object. ... */// Traversal/Positioning/** Indicates whether the cursor is before the first row in this ... *//** Indicates whether the cursor is after the last row in this ... *//** Indicates whether the cursor is on the first row in this ... */int saveAbsoluteCursorPosinternalFirst(...)/** Indicates whether the cursor is on the last row in this ... */boolean saveShowDeletedinternalLast(...)/** Moves this <code>CachedRowSetImpl</code> object's cursor to the front of ... *//** Moves this <code>CachedRowSetImpl</code> object's cursor to the end of ... *//** Moves this <code>CachedRowSetImpl</code> object's cursor to the first row ... *//** Moves this <code>CachedRowSetImpl</code> object's cursor to the first ... *//** Moves this <code>CachedRowSetImpl</code> object's cursor to the last row ... *//** Moves this <code>CachedRowSetImpl</code> object's cursor to the last ... */internalPrevious(...)/** Returns the number of the current row in this <code>CachedRowSetImpl</code> ... *//** Moves this <code>CachedRowSetImpl</code> object's cursor to the row number ... */afterLast(...)beforeFirst(...)/** Moves the cursor the specified number of rows from the current ... *//** Moves this <code>CachedRowSetImpl</code> object's cursor to the ... *//** Moves the cursor to the previous row in this <code>CachedRowSetImpl</code> ... *//** Indicates whether the current row of this <code>CachedRowSetImpl</code> ... */// Updates/** Indicates whether the designated column of the current row of ... */getColUpdated(...)columnUpdated(...)/** Indicates whether the current row has been inserted.  The value returned ... *//** Indicates whether the current row has been deleted.  A deleted row ... *//** Indicates whether the given SQL data type is a numberic type. ... */Types.NUMERICTypes.DECIMALTypes.BITTypes.TINYINTTypes.SMALLINTTypes.INTEGERTypes.BIGINTTypes.REALTypes.DOUBLETypes.FLOAT/** Indicates whether the given SQL data type is a string type. ... *//** Indicates whether the given SQL data type is a binary type. ... */Types.BINARYTypes.VARBINARYTypes.LONGVARBINARY/** Indicates whether the given SQL data type is a temporal type. ... *//** Indicates whether the given SQL data type is a boolean type. ... */Types.BOOLEAN/** Converts the given <code>Object</code> in the Java programming language ... */isNumeric(...)isTemporal(...)isBoolean(...)/** Sets the designated nullable column in the current row or the ... */BaseRow rowsetColumnObject(...)/** Sets the designated column in either the current row or the insert ... */convertBoolean(...)convertNumeric(...)convertTemporal(...)int charsReadupdateNull(...)updateBoolean(...)updateByte(...)updateShort(...)updateInt(...)updateLong(...)updateFloat(...)updateDouble(...)updateBigDecimal(...)updateString(...)updateBytes(...)updateDate(...)updateTime(...)updateTimestamp(...)updateAsciiStream(...)updateBinaryStream(...)updateCharacterStream(...)updateObject(...)/** Inserts the contents of this <code>CachedRowSetImpl</code> object's insert ... */Object[] toInsertRow insRowgetOrigRow(...)isCompleteRow(...)toInsert.lengthsetInserted(...)/** Marks the current row of this <code>CachedRowSetImpl</code> object as ... */setUpdated(...)/** Deletes the current row from this <code>CachedRowSetImpl</code> object and ... *//** Sets the current row with its original value and marks the row as ... *//** Rolls back any updates made to the current row of this ... *//** Moves the cursor for this <code>CachedRowSetImpl</code> object ... */getConcurrency(...)ResultSet.CONCUR_READ_ONLYnew InsertRow(...)initInsertRow(...)/** Moves the cursor for this <code>CachedRowSetImpl</code> object to ... *//** Returns <code>null</code>. ... *//** Retrieves the value of the designated column in this ... */Ref valueTypes.REFBlob valueTypes.BLOBClob valueTypes.CLOBArray valueTypes.ARRAYgetBlob(...)getClob(...)getArray(...)Calendar defaultCalCalendar.YEARCalendar.MONTHCalendar.DAY_OF_MONTHCalendar.HOUR_OF_DAYCalendar.MINUTECalendar.SECOND/** Retrieves the <code>Connection</code> object passed to this ... *//* RowSetInternal Interface *//** Sets the metadata for this <code>CachedRowSetImpl</code> object ... *//** Returns a result set containing the original value of the rowset. The ... */new CachedRowSetImpl(...)int colCountRow origcrs.RowSetMDcrs.numRowscrs.cursorPoscrs.rvh/** Returns a result set containing the original value of the current ... */setTypeMap(...)/** Marks the current row in this rowset as being an original row. ... */Row rowmakeRowOriginal(...)removeCurrentRow(...)/** Makes the given row of this rowset the original row by clearing any ... */clearInserted(...)moveCurrentToOrig(...)/** Marks all rows in this rowset as being original rows. Any updates ... *//** Returns an identifier for the object (table) that was used to create this ... *//** Sets the identifier for the table from which this rowset was derived ... *//** Returns the columns that make a key to uniquely identify a ... */int[] keyColumnsthis.keyColskeyColumns.length/** Sets this <code>CachedRowSetImpl</code> object's ... */new SerialRef(...)updateRef(...)updateClob(...)updateBlob(...)updateArray(...)URL valueTypes.DATALINK/** The function tries to isolate the tablename when only setCommand ... */int indexFromint indexCommaString strTablenameString tabNameint idxWhere/** Commits all changes performed by the <code>acceptChanges()</code> ... *//** Rolls back all changes performed by the <code>acceptChanges()</code> ... *//** Unsets the designated parameter to the given int array. ... */int i_valcolumnIdxes.length/** Unsets the designated parameter to the given String array. ... *//** Retrieves the column name as <code>String</code> array ... */String[] str_tempcopyInto(...)/** Retrieves the column id as <code>int</code> array that was set using ... */Integer[] int_tempint[] i_tempint_temp.length/** Sets the designated parameter to the given int array. ... *//** Sets the designated parameter to the given String array. ... */columnNames.length/** Sets the designated parameter to the given <code>int</code> ... *//** Sets the designated parameter to the given <code>String</code> ... *//** Unsets the designated parameter to the given <code>int</code> ... *//** Unsets the designated parameter to the given <code>String</code> ... *//** Notifies registered listeners that a RowSet object in the given RowSetEvent ... */getFetchSize(...)RowSetEvent event_tempnew RowSetEvent(...)/** Populates this <code>CachedRowSet</code> object with data from ... */absolute(...)setNextException(...)/** The nextPage gets the next page, that is a <code>CachedRowSetImpl</code> object ... *//** This is the setter function for setting the size of the page, which specifies ... *//** This is the getter function for the size of the page. ... *//** Retrieves the data present in the page prior to the page from where it is ... */int pSint mR/** Sets the status for the row on which the cursor is positioned. The insertFlag is used ... *//* public boolean lastPage() throws SQLException{ ... *//** Retrives the last page of data as specified by the page size. ... *//* public boolean firstPage() throws SQLException { ... *//** Retrieves the first page of data as specified by the page size. ... *//* public boolean relativePage(int page) throws SQLException { ... *//** Goes to the page number passed as the parameter  from the current page. ... *//* public boolean absolutePage(int page) throws SQLException{ ... *//** Goes to the page number passed as the parameter ... *//** Retrieves the value of the designated <code>SQL XML</code> parameter as a ... */new SQLFeatureNotSupportedException(...)/** Updates the designated column with a <code>RowId</code> value. The updater ... *//** Retrieves the holdability of this ResultSet object ... *//** Retrieves whether this ResultSet object has been closed. A ResultSet is closed if the ... *//** This method is used for updating columns that support National Character sets. ... *//* o ... *//** This method is used for updating SQL <code>NCLOB</code>  type that maps ... *//** Sets the designated parameter to the given <code>java.sql.SQLXML</code> object. The driver converts this to an ... *//** Sets the designated parameter to the given <code>java.sql.RowId</code> object. The ... *//** Sets the designated parameter to a <code>Reader</code> object. The ... *//** Sets the designated parameter to a <code>java.sql.NClob</code> object. The object ... *//** Updates the designated column with a <code>java.sql.SQLXML</code> value. ... *//** Updates the designated column with a character stream value, which will ... *//** Updates the designated column with a character stream value.   The ... *//** Updates the designated column with a character stream value.  The ... *//** Updates the designated column using the given input stream, which ... *////////////////////////////** Updates the designated column using the given input stream. ... *//** Updates the designated column using the given <code>Reader</code> ... *//** Updates the designated column with an ascii stream value, which will have ... *//** Updates the designated column with a binary stream value, which will have ... *//** Updates the designated column with a character stream value, which will have ... *//** Updates the designated column with a binary stream value. ... *//** Updates the designated column with a character stream value. ... *//** Updates the designated column with an ascii stream value. ... *//** Sets the designated parameter to the given <code>java.net.URL</code> value. ... *//** Sets the designated parameter to a <code>Reader</code> object. ... *//** Sets the designated parameter to a <code>Reader</code> object.  The <code>reader</code> must contain  the number ... *//** Sets the designated parameter to a <code>Reader</code> object.  The reader must contain  the number ... *//** Sets the designated parameter to a <code>java.sql.NClob</code> object. The driver converts this to ... *//** Sets the designated parameter to the given <code>String</code> object. ... *//** Sets the designated parameter to the given <code>java.sql.Timestamp</code> value, ... *//** Sets the designated parameter to the given <code>java.sql.Clob</code> object. ... *//** Sets the designated parameter to the given <code>java.sql.Date</code> value ... *//** Sets the designated parameter to the given <code>java.sql.Date</code> value, ... *//** Sets the designated parameter to the given <code>java.sql.Time</code> value. ... *//** Sets the designated parameter to the given <code>java.sql.Time</code> value, ... *//** Sets the designated parameter to a <code>InputStream</code> object.  The inputstream must contain  the number ... *//** Sets the designated parameter to a <code>InputStream</code> object. ... *//** Sets the designated parameter to a <code>InputStream</code> object.  The <code>inputstream</code> must contain  the number ... *//** Sets the designated parameter to the given <code>java.sql.Blob</code> object. ... *//** Sets the value of the designated parameter with the given object. The second ... *//** Sets the value of the designated parameter with the given object. ... *//** Sets the designated parameter to the given input stream, which will have ... *//** Sets the designated parameter to the given <code>Reader</code> ... *//** Sets the designated parameter to the given input stream. ... *//** Sets the designated parameter to the given ... *//** Sets the designated parameter to the given Java <code>String</code> value. ... *//** Sets the designated parameter to the given Java array of bytes. ... *//** Sets the designated parameter to the given <code>java.sql.Timestamp</code> value. ... *//** Sets the designated parameter to SQL <code>NULL</code>. ... *//** Sets the designated parameter to the given Java <code>boolean</code> value. ... *//** Sets the designated parameter to the given Java <code>byte</code> value. ... *//** Sets the designated parameter to the given Java <code>short</code> value. ... *//** Sets the designated parameter to the given Java <code>int</code> value. ... *//** Sets the designated parameter to the given Java <code>long</code> value. ... *//** Sets the designated parameter to the given Java <code>float</code> value. ... *//** Sets the designated parameter to the given Java <code>double</code> value. ... *//** This method re populates the resBundle ... *///------------------------- JDBC 4.1 -----------------------------------// set the Reader, this maybe overridden latter// allocate the parameters collection// set up some default values// insert row setup// set the warninings//setTypeMap(null);//Instantiating the vector for MatchColumns// get the meta data for this ResultSet// set up the metadata// release the meta-data so that aren't tempted to use it./* check if the user has set a map. If no map ... *//* the following block checks for the various ... */// Also rowsFetched should be equal to rvh.size()// notify any listeners that the rowset has changed/* The PostgreSQL drivers sometimes return negative columnDisplaySize, ... *//* Drivers return some strange values for precision, for non-numeric data, including reports of ... *//* It seems, from a bug report, that a driver can sometimes return a negative ... */// JDBC 4.0 mandates as does the Java EE spec that all DataBaseMetaData methods// must be implemented, therefore, the previous fix for 5055528 is being backed out// store the connection so the reader can find it.// Now call the current reader's readData method// do commit/rollback's here// move to before the first// notify any listeners// make sure we are on a row// don't want this to happen...// if on insert row, cancel the insert row// make the insert row flag,// cursorPos back to the current row// else if not on insert row// call undoUpdate or undoInsert//return ((CachedRowSet)(in.readObject()));// Copy everything except data i.e all constraints// Store the number of rows of "this"// and make numRows equals zero.// and make data also zero.// reset this object back to number of rows.// Copy the whole data ONLY without any constraints.//do nothing, if the setMatchColumn is not set.// create a copy/* make sure things look sane. The cursor must be ... */// now move and notify// increment to after last/* each call to internalNext may increment cursorPos multiple ... */// close all data structures holding// the disconnected rowset// set all insert(s), update(s) & delete(s),// if at all, to their initial values.// clear the vector of it's present contents// this will make it eligible for gc// rvh = null;// sanity check.// make sure the cursor is on a valid row// check for SQL NULL// check for Boolean...// convert to a Double and compare to zero/* The object coming back from the db could be ... */// always free an old stream//make sure the cursor is on a vlid row// look up the class in the map// create new instance of the class// get the attributes from the struct// create the SQLInput "stream"// read the values...// this becomes nasty because of deletes.// move and notify// are we on a valid row? Valid rows are between first and last// we are moving foward// fell off the end// we are moving backward// fell off the front// Now move towards the absolute row that we're looking for// we are moving forward// decrement to before first/* Each call to internalPrevious may move the cursor ... */// sanity Check//Changed the condition check to check for length instead of -1//Changed the condition checking to check for length instead of -1// Added the setting of parameters that are passed// to setXXX methods after an empty CRS Object is// created through RowSetMetaData object/* The new row is inserted into the RowSet ... */// notify the listeners that the row changed.// make sure we aren't on the insert row// just undo any changes made to this row.// %%% setCurrentRow called in BaseRow// create a default calendar// set this Calendar to the time we have/* Now we can pull the pieces of the date out ... *//* This looks a little odd but it is correct - ... */// set the time in the default calendar// make sure we don't get someone playing with these// %%% is this now necessary ???//crs.setReader(null);//crs.setWriter(null);// this can happen if deleted rows are being shown// remove deleted rows from the collection.// SerialClob will help in getting the byte array and storing it.// We need to be checking DatabaseMetaData.locatorsUpdatorCopy()// or through RowSetMetaData.locatorsUpdatorCopy()// SerialBlob will help in getting the byte array and storing it.// SerialArray will help in getting the byte array and storing it.//throw new SQLException("Operation not supported");// mask exception// If we have a query from one table,// we set the table name implicitly// else user has to explicitly set the table name.// Query can be a select, insert or  update// look for "from" keyword, after that look for a// comma after from. If comma is there don't set// table name else isolate table name.// implies only one table/** Adding the addtional check for conditions following the table name. ... *///strTablename="";// validate, if col is ok to be set// set iMatchColumn//strMatchColumn = null;// set strMatchColumn//iMatchColumn = -1;// check if we are unsetting the SAME column// that is, we are unsetting it.// check if we are unsetting the same column// Fix for 6554186// Default state initialization happens here// Initialization of transient Res Bundle happens here ./** The standard implementation of the <code>FilteredRowSet</code> interface. See the interface ... */Predicate p;/** Construct a <code>FilteredRowSet</code> *//** Construct a <code>FilteredRowSet</code> with a specified synchronization ... *//** Apply the predicate for this filter ... *//** Retrieve the filter active for this <code>FilteredRowSet</code> ... *//** Over-riding <code>internalNext()</code> implementation. This method ... */boolean boolint rowsgetRow(...)/** Over-riding <code>internalPrevious()</code> implementation. This method ... *//** Over-riding <code>internalFirst()</code> implementation. This method ... *//** Over-riding <code>internalLast()</code> implementation. This method ... */// end internalLast()boolean boolvalmoveToInsertRow(...)/** This is explanation for the overriding of the updateXXX functions. ... */findColumn(...)Byte[] obj_arrnew Byte[]x.lengthinsertRow(...)// CachedRowSetImpl.next() internally calls// this(crs).internalNext() NOTE: this holds crs object// So when frs.next() is called,// internally this(frs).internalNext() will be called// which will be nothing but this method.// because this holds frs object// keep on doing super.internalNext()// rather than doing it once.// p.evaluate will help us in changing the cursor// and checking the next value by returning true or false.// to fit the filter// So while() loop will have a "random combination" of// true and false returned depending upon the records// are in or out of filter.// We need to traverse from present cursorPos till end,// whether true or false and check each row for "filter"// "till we get a "true"// with previous move backwards,// i.e. from any record towards first record// from first till present cursor position(go forward),// find the actual first which matches the filter.// from last to the present cursor position(go backward),// find the actual last which matches the filter.// end FilteredRowSetImpl class/** The standard implementation of the <code>JdbcRowSet</code> interface. See the interface ... *//** The <code>Connection</code> object that is this rowset's ... */PreparedStatement ps;/** The <code>PreparedStatement</code> object that is this rowset's ... */ResultSet rs;/** The <code>ResultSet</code> object that is this rowset's ... */RowSetMetaDataImpl rowsMD;/** The <code>RowSetMetaDataImpl</code> object that is constructed when ... */ResultSetMetaData resMD;/** The <code>ResultSetMetaData</code> object from which this ... *//** Constructs a default <code>JdbcRowSet</code> object. ... *//** Constructs a default <code>JdbcRowSet</code> object given a ... */setParams(...)/** Constructs a default <code>JdbcRowSet</code> object using the ... */setUsername(...)setUrl(...)/** Constructs a <code>JdbcRowSet</code> object using the given valid ... *//** Creates the internal <code>ResultSet</code> object for which this ... */setProperties(...)decodeParams(...)executeQuery(...)getEscapeProcessing(...)SQLException exgetMaxFieldSize(...)getQueryTimeout(...)getDataSourceName(...)new InitialContext(...)DataSource dsgetUsername(...)getConnection(...)NamingException exgetUrl(...)Map<String,Class<?>> aMapprepareStatement(...)int arraySizeObject[] paramparam.lengthsetNull(...)setDate(...)setCharacterStream(...)setObject(...)JdbcRowSetImpl.UNICODE_STREAM_PARAMsetUnicodeStream(...)JdbcRowSetImpl.BINARY_STREAM_PARAMsetBinaryStream(...)JdbcRowSetImpl.ASCII_STREAM_PARAMsetAsciiStream(...)/** Moves the cursor for this rowset's <code>ResultSet</code> ... *//** Releases this rowset's <code>ResultSet</code> object's database and ... *//** Reports whether the last column read from this rowset's ... */wasNull(...)/** Gets the value of the designated column in the current row ... *///======================================================================/** Gets the value of a column in the current row as a stream of ... *//** Returns the first warning reported by calls on this rowset's ... *///=====================================================================getWarnings(...)/** Clears all warnings reported on this rowset's <code>ResultSet</code> object. ... */clearWarnings(...)/** Gets the name of the SQL cursor used by this rowset's <code>ResultSet</code> ... */getCursorName(...)/** Retrieves the  number, types and properties of ... *//** <p>Gets the value of the designated column in the current row ... *//** Maps the given <code>JdbcRowSetImpl</code> column name to its ... */// Getters and Setters/** Indicates whether the cursor is before the first row in ... *//** Indicates whether the cursor is after the last row in ... *//** Indicates whether the cursor is on the first row of ... */isFirst(...)/** Indicates whether the cursor is on the last row of ... */isLast(...)/** Moves the cursor to the front of ... *//** Moves the cursor to the end of ... *//** Moves the cursor to the first row in ... */first(...)/** Moves the cursor to the last row in ... */last(...)/** Retrieves the current row number.  The first row is number 1, the ... *//** Moves the cursor to the given row number in ... *//** Moves the cursor a relative number of rows, either positive or negative. ... */relative(...)/** Moves the cursor to the previous row in this ... *//** Gives a hint as to the direction in which the rows in this ... */setFetchDirection(...)/** Returns the fetch direction for this ... */getFetchDirection(...)/** Gives the JDBC driver a hint as to the number of rows that should ... */setFetchSize(...)/** Returns the fetch size for this ... */int rstype/** Returns the concurrency mode of this rowset's <code>ResultSet</code> object. ... *//** Indicates whether the current row has been updated.  The value returned ... */rowUpdated(...)/** Indicates whether the current row has had an insertion. ... */rowInserted(...)/** Indicates whether a row has been deleted.  A deleted row may leave ... *//** Gives a nullable column a null value. ... */checkTypeConcurrency(...)/** Updates the designated column with a <code>boolean</code> value. ... *//** Updates the designated column with a <code>byte</code> value. ... *//** Updates the designated column with a <code>short</code> value. ... *//** Updates the designated column with an <code>int</code> value. ... *//** Updates the designated column with a <code>long</code> value. ... *//** Updates the designated column with a <code>float</code> value. ... *//** Updates the designated column with a <code>double</code> value. ... *//** Updates the designated column with a <code>java.math.BigDecimal</code> ... *//** Updates the designated column with a <code>String</code> value. ... *//** Updates the designated column with a <code>byte</code> array value. ... *//** Updates the designated column with a <code>java.sql.Date</code> value. ... *//** Updates the designated column with a <code>java.sql.Time</code> value. ... *//** Updates the designated column with a <code>java.sql.Timestamp</code> ... *//** Updates the designated column with an <code>Object</code> value. ... *//** Updates the designated column with a <code>null</code> value. ... *//** Updates the designated column with a <code>float </code> value. ... *//** Updates the designated column with a <code>java.sql.BigDecimal</code> ... *//** Inserts the contents of the insert row into this ... *//** Updates the underlying database with the new contents of the ... */updateRow(...)/** Deletes the current row from this rowset's <code>ResultSet</code> object ... */deleteRow(...)/** Refreshes the current row of this rowset's <code>ResultSet</code> ... */refreshRow(...)/** Cancels the updates made to the current row in this ... */cancelRowUpdates(...)/** Moves the cursor to the insert row.  The current cursor position is ... *//** Moves the cursor to the remembered cursor position, usually the ... *//** Returns the <code>Statement</code> object that produced this ... */getStatement(...)/** Returns the value of the designated column in the current row ... *//** Provide interface coverage for getURL(int) in ResultSet->RowSet *//** Provide interface coverage for getURL(String) in ResultSet->RowSet *//** Return the RowSetWarning object for the current row of a ... *//** Retrieves the <code>DatabaseMetaData</code> associated with ... */Connection con/** Retrieves the <code>ParameterMetaData</code> associated with ... */getParameterMetaData(...)/** Commits all updates in this <code>JdbcRowSet</code> object by ... */getHoldability(...)/** Sets auto-commit on the internal <code>Connection</code> object with this ... */setAutoCommit(...)/** Returns the auto-commit status with this <code>JdbcRowSet</code>. ... */getAutoCommit(...)/** Rolls back all the updates in this <code>JdbcRowSet</code> object by ... *//** Rollbacks all the updates in the <code>JdbcRowSet</code> back to the ... */// Setting the ResultSet Type and Concurrency// Checking ResultSet Type and Concurrency/** Gets this <code>JdbcRowSet</code> object's Connection property ... *///  Added as per Rave requirements// Returns a Connection Handle/** Sets this <code>JdbcRowSet</code> object's connection property ... */// Added as per rave requirements// Sets the connection handle with the parameter/** Gets this <code>JdbcRowSet</code> object's PreparedStatement property ... */// Added as per Rave requirements// Returns a PreparedStatement Handle/** Sets this <code>JdbcRowSet</code> object's preparedtsatement property ... *///Sets the prepared statement handle to the parameter/** Gets this <code>JdbcRowSet</code> object's ResultSet property ... */// Returns a ResultSet handle/** Sets this <code>JdbcRowSet</code> object's resultset property ... */// Sets the result set handle to the parameter/** Sets this <code>JdbcRowSet</code> object's <code>command</code> property to ... *//** Sets the <code>dataSourceName</code> property for this <code>JdbcRowSet</code> ... */setDataSourceName(...)/** Sets the Url property for this <code>JdbcRowSet</code> object ... *//** Sets the username property for this <code>JdbcRowSet</code> object ... *//** Sets the password property for this <code>JdbcRowSet</code> object ... *//** Sets the type for this <code>RowSet</code> object to the specified type. ... */int oldVal/** Sets the concurrency for this <code>RowSet</code> object to ... *//** Sets the designated parameter in this <code>RowSet</code> object's command ... *//** Sets the designated parameter to a <code>Reader</code> object.  The <code>reader</code> must contain the number ... *//** * of characters specified by length otherwise a <code>SQLException</code> will becontain  the number ... */// set the defaults// Pass the arguments to BaseRowSet// setter methods now.// A ResultSet handle encapsulates a connection handle.// But there is no way we can retrieve a Connection handle// from a ResultSet object.// So to avoid any anomalies we keep the conn = null// The passed rs handle will be a wrapper around for// "this" object's all operations.// get the values from the resultset handle.// Get a handle to ResultSetMetaData// Construct RowSetMetaData out of it.// If all the three i.e.  conn, ps & rs are// simultaneously null implies we are not connected// to the db, implies undesirable state so throw exception/* To execute based on the properties: ... */// set the properties of our shiny new statement// set the parameters// execute the statement// notify listeners// Get a JDBC connection.// First check for Connection handle object as such if// "this" initialized  using conn.// Connect using JNDI.//return ds.getConnection(getUsername(),getPassword());// Check only for getUrl() != null because// user, passwd can be null// Connect using the driver manager.// get a connection// There is a corresponding decodeParams in JdbcRowSetImpl// which does the same as this method. This is a design flaw.// Update the CachedRowsetReader.decodeParams when you update// this method.// Adding the same comments to CachedRowsetReader.decodeParams./* What's left should be setObject(int, Object, scale) *//* no point at looking at the first element now; ... */// common case - this catches all SQL92 types// Try to get all the params to be set here// It may be the case that JdbcRowSet might not have been// initialized with ResultSet handle and may be by PreparedStatement// internally when we set JdbcRowSet.setCommand().// We may require all the basic properties of setEscapeProcessing// setMaxFieldSize etc. which an application can use before we call// execute.// will return ResultSetMetaData// If the ResultSet has not been created, then return the default type// otherwise return the type from the ResultSet.// To check the type and concurrency of the ResultSet// to verify whether updates are possible or not// Checking the holadbility value and making the result set handle null// The connection object should be there// in order to commit the connection handle on or off.// Coming here means the connection object is null.// So generate a connection handle internally, since// a JdbcRowSet is always connected to a db, it is fine// to get a handle to the connection.// Get hold of a connection handle// and change the autcommit as passesd.// After setting the below the conn.getAutoCommit()// should return the same value.// Makes the result ste handle null after rollback/** This class is used to help in localization of resources, ... */String fileName;/** This <code>String</code> variable stores the location ... */PropertyResourceBundle propResBundle;/** This variable will hold the <code>PropertyResourceBundle</code> ... */JdbcRowSetResourceBundle jpResBundle;/** The constructor initializes to this object */String PROPERTIES;/** The variable which will represent the properties ... */String UNDERSCORE;/** The variable to represent underscore */String DOT;/** The variable which will represent dot */String SLASH;/** The variable which will represent the slash. */String PATH;/** The variable where the default resource bundle will ... *//** The constructor which initializes the resource bundle. ... */Locale locale/** This method is used to get a handle to the ... */new JdbcRowSetResourceBundle(...)/** This method returns an enumerated handle of the keys ... */getKeys(...)/** This method takes the key as an argument and ... */// Try to load the resource bundle according// to the locale. Else if no bundle found according// to the locale load the default.// In default case the default locale resource bundle// should always be loaded else it// will be difficult to throw appropriate// exception string messages.// Load appropriate bundle according to locale//end if//end synchronized blockimport SyncProviderimport SyncProviderException/** The standard implementation of the <code>JoinRowSet</code> ... */Vector<CachedRowSetImpl> vecRowSetsInJOIN;/** A <code>Vector</code> object that contains the <code>RowSet</code> objects ... */CachedRowSetImpl crsInternal;/** The <code>CachedRowSet</code> object that encapsulates this ... */Vector<Integer> vecJoinType;/** A <code>Vector</code> object containing the types of join that have been set ... */Vector<String> vecTableNames;/** A <code>Vector</code> object containing the names of all the tables entering ... */int iMatchKey;/** An <code>int</code> that indicates the column index of the match column. */String strMatchKey;/** A <code>String</code> object that stores the name of the match column. */...[] supportedJOINs;/** An array of <code>boolean</code> values indicating the types of joins supported ... */WebRowSet wrs;/** The <code>WebRowSet</code> object that encapsulates this <code>JoinRowSet</code> ... *//** Constructor for <code>JoinRowSetImpl</code> class. Configures various internal data ... */new Vector<CachedRowSetImpl>(...)/** Adds the given <code>RowSet</code> object to this ... */boolean boolColIdboolean boolColNameCachedRowSetImpl cRowsetint matchColumnCountint[] pColgetMatchColumnIndexes(...).lengthsetMatchColumn(...)ArrayList<Integer> indicesint[] indexesgetMatchColumnNames(...).lengthinitJOIN(...)/** Adds the given <code>RowSet</code> object to the <code>JOIN</code> relation ... */addRowSet(...)/** Adds the given <code>RowSet</code> object to the <code>JOIN</code> relationship ... *//** Adds the given <code>RowSet</code> objects to the <code>JOIN</code> relationship ... */rowset.lengthcolumnIdx.lengthcolumnName.length/** Returns a Collection of the <code>RowSet</code> object instances ... *//** Returns a string array of the RowSet names currently residing ... */Object[] arrString[] strArrarr.length/** Creates a separate <code>CachedRowSet</code> object that contains the data ... *//** Returns <code>true</code> if this <code>JoinRowSet</code> object supports ... */JoinRowSet.CROSS_JOINJoinRowSet.INNER_JOINJoinRowSet.LEFT_OUTER_JOINJoinRowSet.RIGHT_OUTER_JOINJoinRowSet.FULL_JOIN/** Sets the type of SQL <code>JOIN</code> that this <code>JoinRowSet</code> ... */Integer Intgr/** This checks for a match column for ... */int[] ii.length/** Internal initialization of <code>JoinRowSet</code>. */RowSetMetaDataImpl rsmdsetMetaData(...)int rowCount2int rowCount1setJoinType(...)int colc/** Return a SQL-like description of the <code>WHERE</code> clause being used ... */String strWhereClauseString whereClauseString strTabName/** Releases the current contents of this rowset, discarding  outstanding ... *//** A column value can be retrieved as a stream of uninterpreted bytes ... */// ColumnName methods/** This method is not supported, and it will throw an ... *//* The first warning reported by calls on this <code>JoinRowSetImpl</code> ... *//** Throws an <code>UnsupportedOperationException</code> if called. ... *//** Retrieves the <code>ResultSetMetaData</code> object that contains ... *//** Returns the number of rows in this <code>JoinRowSetImpl</code> object. ... *//** Moves this <code>JoinRowSetImpl</code> object's cursor to the front of ... *//** Moves this <code>JoinRowSetImpl</code> object's cursor to the end of ... *//** Moves this <code>JoinRowSetImpl</code> object's cursor to the first row ... *//** Moves this <code>JoinRowSetImpl</code> object's cursor to the last row ... *//** Returns the number of the current row in this <code>JoinRowSetImpl</code> ... *//** Moves this <code>JoinRowSetImpl</code> object's cursor to the row number ... *//** Moves this <code>JoinRowSetImpl</code> object's cursor to the ... *//** Returns the index of the column whose name is <i>columnName</i>. ... *//** Indicates whether the current row of this <code>JoinRowSetImpl</code> ... *//* Sets the designated column in either the current row or the insert ... */// columnName updates/** Unsupported; throws an <code>UnsupportedOperationException</code> ... *//** Inserts the contents of this <code>JoinRowSetImpl</code> object's insert ... *//** Marks the current row of this <code>JoinRowSetImpl</code> object as ... *//** Deletes the current row from this <code>JoinRowSetImpl</code> object and ... *//** Moves the cursor for this <code>JoinRowSetImpl</code> object ... *//** Moves the cursor for this <code>JoinRowSetImpl</code> object to ... */// ColumnName/** Sets the metadata for this <code>JoinRowSetImpl</code> object ... */getOriginal(...)/** Returns a result set containing the original value of the rowset. ... */getOriginalRow(...)setOriginalRow(...)getKeyColumns(...)/** Sets this <code>JoinRowSetImpl</code> object's ... */setKeyColumns(...)/** Populates this <code>JoinRowSetImpl</code> object with data. ... *//** Populates this <code>JoinRowSetImpl</code> object with data, ... *//** Creates a new <code>WebRowSet</code> object, populates it with the ... */new WebRowSetImpl(...)writeXml(...)/** Writes this <code>JoinRowSet</code> object to the given ... */createWebRowSet(...)/** Reads this <code>JoinRowSet</code> object in its XML format. ... */readXml(...)/** Reads a stream based XML input to populate an <code>WebRowSet</code> ... */// Stream based methods/** Creates an an output stream of the internal state and contents of a ... *//** Creates a new <code>WebRowSet</code> object, populates it with ... *//** %%% Javadoc comments to be added here *//** Returns the last set SQL <code>JOIN</code> type in this JoinRowSetImpl ... *//** The listener will be notified whenever an event occurs on this <code>JoinRowSet</code> ... */addRowSetListener(...)/** Removes the designated object from this <code>JoinRowSet</code> object's list of listeners. ... */removeRowSetListener(...)/** Converts this <code>JoinRowSetImpl</code> object to a collection ... *//** Returns the specified column of this <code>JoinRowSetImpl</code> object ... */createCopySchema(...)setSyncProvider(...)getSyncProvider(...)// Either column id or column name will be set// If both not set throw exception.//if not set catch the exception but do nothing now.// neither setter methods have been used to set//if(boolColId || boolColName)// either of the setter methods have been set.// Set the match column here because join will be// based on columnId,// (nested for loop in initJOIN() checks for equality//  based on columnIndex)//do nothing, iMatchKey is set.// Now both iMatchKey and strMatchKey have been set pointing// to the same column// Till first rowset setJoinType may not be set because// default type is JoinRowSet.INNER_JOIN which should// be set and for subsequent additions of rowset, if not set// keep on adding join type as JoinRowSet.INNER_JOIN// to vecJoinType.//passing the rowset as well as the columnIdx to form the joinrowset.//validate if length of rowset array is same as length of int array.//end for// The join which governs the join of two rowsets is the last// join set, using setJoinType// This 'if' will be removed after all joins are implemented.// Create a new CachedRowSet object local to this function./* The following 'if block' seems to be always going true. ... */// implies first cRowset to be added to the Join// simply add this as a CachedRowSet.// Also add it to the class variable of type vector// do not need to check "type" of Join but it should be set.// metadata will also set the MatchColumn.// At this point we are ready to add another rowset to 'this' object// Check the size of vecJoinType and vecRowSetsInJoin// If nothing is being set, internally call setJoinType()// to set to JoinRowSet.INNER_JOIN.// For two rowsets one (valid) entry should be there in vecJoinType// For three rowsets two (valid) entries should be there in vecJoinType// Maintain vecRowSetsInJoin = vecJoinType + 1// we are going to add next rowset and setJoinType has not been set// recently, so set it to setJoinType() to JoinRowSet.INNER_JOIN.// the default join type// do nothing setjoinType() has been set by programmer// Add the table names to the class variable of type vector.// Now we have two rowsets crsInternal and cRowset which need// to be INNER JOIN'ED to form a new rowset// Compare table1.MatchColumn1.value1 == { table2.MatchColumn2.value1//                              ... upto table2.MatchColumn2.valueN }//     ...// Compare table1.MatchColumn1.valueM == { table2.MatchColumn2.value1// Assuming first rowset has M rows and second N rows.// total columns in the new CachedRowSet will be sum of both -1// (common column)// reset this variable everytime you loop// re create a JoinRowSet in crsTemp object// create a new rowset crsTemp with data from first rowset// column type also needs to be passed.// will happen only once, for that  merged column pass// the types as OBJECT, if types not equal//don't do ++colc in the above statement// append the rowset crsTemp, with data from second rowset/** This will happen for a special case scenario. The value of 'p' ... *///if((p+q-1) > ((crsInternal.getMetaData().getColumnCount()) +//            (cRowset.getMetaData().getColumnCount())     - 1)) {// --p;// since not equa12// so do nothing// bool1 = cRowset.next();// end inner for//bool2 = crsInternal.next();//end outer for// Now the join is done.// Make crsInternal = crsTemp, to be ready for next merge, if at all.// Because we add the first rowset as crsInternal to the// merged rowset, so pCol will point to the Match column.// until reset, am not sure we should set this or not(?)// if this is not set next inner join won't happen// if we explicitly do not set a set MatchColumn of// the new crsInternal.// Add the merged rowset to the class variable of type vector.// %%% Exception should not dump here:// get all the column(s) names from each rowset.// append them with their tablenames i.e. tableName.columnName// Select tableName1.columnName1,..., tableNameX.columnNameY// from tableName1,...tableNameX where// tableName1.(rowset1.getMatchColumnName()) ==// tableName2.(rowset2.getMatchColumnName()) + "and" +// tableNameX.(rowsetX.getMatchColumnName()) ==// tableNameZ.(rowsetZ.getMatchColumnName()));//end while// now remove the last ","// Add from clause// Add the table names.//Remove the last ","// Add the where clause// Get the match columns// rowset1.getMatchColumnName() == rowset2.getMatchColumnName()// check if it has already been initialized.// Default JoinRowSet typeimport SQLExceptionimport CachedRowSetimport FilteredRowSetimport JdbcRowSetimport JoinRowSetimport WebRowSetimport RowSetFactory/** This is the implementation specific class for the ... */new FilteredRowSetImpl(...)new JdbcRowSetImpl(...)new JoinRowSetImpl(...)import org.xml.sax.*/** The standard implementation of the <code>WebRowSet</code> interface. See the interface ... */WebRowSetXmlReader xmlReader;/** The <code>WebRowSetXmlReader</code> object that this ... */WebRowSetXmlWriter xmlWriter;/** The <code>WebRowSetXmlWriter</code> object that this ... */int curPosBfrWrite;/* This stores the cursor position prior to calling the writeXML. ... *//** Constructs a new <code>WebRowSet</code> object initialized with the ... */new WebRowSetXmlReader(...)new WebRowSetXmlWriter(...)/** Constructs a new <code>WebRowSet</code> object initialized with the the ... *//** Populates this <code>WebRowSet</code> object with the ... *//** Writes this <code>WebRowSet</code> object to the given ... */writeXML(...)/** Reads this <code>WebRowSet</code> object in its XML format. ... */readXML(...)/** Reads a stream based XML input to populate this <code>WebRowSet</code> ... *//** Writes this <code>WebRowSet</code> object to the given <code> OutputStream</code> ... */// %%%// Needs to use to SPI  XmlReader,XmlWriters// xmlReader = provider.getRowSetReader();// xmlWriter = provider.getRowSetWriter();// WebRowSetImpl wrs = new WebRowSetImpl();// Store the cursor position before writing// This will change to a XmlReader, which over-rides the default// Xml that is used when a WRS is instantiated.// WebRowSetXmlWriter xmlWriter = getXmlWriter();//WebRowSetXmlReader xmlReader = getXmlReader();// Position is before the first row// The cursor position is to be stored while serializng// and deserializing the WebRowSet Object.// Return the position back to place prior to callin writeXml/** The abstract base class from which the classes <code>Row</code> ... *//** Specify the serialVersionUID */...[] origVals;/** The array containing the original values for this <code>BaseRow</code> ... *//** Retrieves the values that this row contained immediately ... */Object[] origRowthis.origValsorigRow.length/** Retrieves the array element at the given index, which is ... *//** Sets the element at the given index into this row's array of ... */import com.sun.rowset.*/** The facility called by the <code>RIOptimisticProvider</code> object ... */int writerCalls;/** The field that keeps track of whether the writer associated with ... */boolean userCon;int startPosition;/** Reads data from a data source and populates the given ... */PreparedStatement pstmtgetTransactionIsolation(...)ResultSet rsexecuteUpdate(...)getCloseConnection(...)Exception dummy/** Checks to see if the writer associated with this reader needs ... *//** Establishes a connection with the data source for the given ... */SQLException sqlEx/** Sets the parameter placeholders ... */CachedRowSetImpl.UNICODE_STREAM_PARAMCachedRowSetImpl.BINARY_STREAM_PARAMCachedRowSetImpl.ASCII_STREAM_PARAM/** Assists in determining whether the current connection was created by this ... *//** This sets the start position in the ResultSet from where to begin. This is ... */// Get rid of the current contents of the rowset./** Checking added to verify whether page size has been set or not. ... */// When page size is not set,// crs.size() will show the total no of rows.// Get a connection.  This reader assumes that the necessary// properties have been set on the caller to let it supply a// connection.// Check our assumptions.// Use JDBC to read the data.// Pass any input parameters to JDBC./* drivers may not support the above - esp. older ... */// can be (crs.getCommand()).indexOf("select")) == 0// because we will be getting resultset when// it may be the case that some false select query with// select coming in between instead of first.// if ((crs.getCommand()).indexOf("?")) does not return -1// implies a Prepared Statement like query exists./** If page size has been set then create a ResultSet object that is scrollable using a ... */// Get the data.// only close connections we created...// Throw an exception if reading fails for any reason./* not an error condition, we're closing anyway, but ... */// will get exception if something already went wrong, but don't// override that exception with this one// A connection was passed to execute(), so use it.// As we are using a connection the user gave us we// won't close it.// Check for username, password,// if it exists try getting a Connection handle through them// else try without these// else throw SQLException// Update the JdbcRowSetImpl.decodeParams when you update// Adding the same comments to JdbcRowSetImpl.decodeParams.// Initialization of  Res Bundle happens here .import SQLInputImplimport SerialArrayimport SerialBlobimport SerialClobimport SerialStruct/** The facility called on internally by the <code>RIOptimisticProvider</code> implementation to ... */Connection con;/** The <code>Connection</code> object that this writer will use to make a ... */String selectCmd;/** The SQL <code>SELECT</code> command that this writer will call ... */String updateCmd;/** The SQL <code>UPDATE</code> command that this writer will call ... */String updateWhere;/** The SQL <code>WHERE</code> clause the writer will use for update ... */String deleteCmd;/** The SQL <code>DELETE</code> command that this writer will call ... */String deleteWhere;/** The SQL <code>WHERE</code> clause the writer will use for delete ... */String insertCmd;/** The SQL <code>INSERT INTO</code> command that this writer will internally use ... *//** An array containing the column numbers of the columns that are ... */...[] params;/** An array of the parameters that should be used to set the parameter ... */CachedRowSetReader reader;/** The <code>CachedRowSetReader</code> object that has been ... */ResultSetMetaData callerMd;int callerColumnCount;/** The number of columns in the <code>CachedRowSet</code> object ... */CachedRowSetImpl crsResolve;/** This <code>CachedRowSet<code> will hold the conflicting values ... */ArrayList<Integer> status;/** This <code>ArrayList<code> will hold the values of SyncResolver.* */int iChangedValsInDbAndCRS;/** This will check whether the same field value has changed both ... */int iChangedValsinDbOnly;/** This will hold the number of cols for which the values have ... *//** Propagates changes in the given <code>RowSet</code> object ... */long conflictsboolean showDelPreparedStatement pstmtInsint iColCountRowSetMetaDataImpl rsmdWriteRowSetMetaDataImpl rsmdResolvthis.crsResolveinitSQLStatements(...)ResultSetMetaData.columnNullableUnknowndeleteOriginalRow(...)SyncResolver.DELETE_ROW_CONFLICTSyncResolver.NO_ROW_CONFLICTinsertNewRow(...)SyncResolver.INSERT_ROW_CONFLICTupdateOriginalRow(...)SyncResolver.UPDATE_ROW_CONFLICTint icolCountSyncResolverImpl syncResImplgetSyncResolver(...)setCachedRowSet(...)setCachedRowSetResolver(...)setCachedRowSetWriter(...)/** Updates the given <code>CachedRowSet</code> object's underlying data ... *///end writeDataResultSet origValsString tempselectCmdResultSetMetaData rsmdbuildWhereClause(...)String tempSelectkeyCols.lengthint colsNotChangedVector<Integer> colsString updateExecObject origObject currObject rsvalboolean boolNullObject objValboolean first/** Inserts a row that has been inserted into the given ... */boolean returnValPreparedStatement pstmtSelResultSet rs2getPrimaryKeys(...)String[] primaryKeysString pkNameObject crsPKString rsPKisPKNameValid(...)String colname/** Deletes the row in the underlying data source that corresponds to ... */String strSelectboolean boolChangedObject originalObject changed/** Sets the reader for this writer to the given reader. ... *//** Gets the reader for this writer. ... *//** Composes a <code>SELECT</code>, <code>UPDATE</code>, <code>INSERT</code>, ... */String tableString catalogString schemaDatabaseMetaData dbmdString tempupdCmdint idxupWherebuildKeyDesc(...)/** Returns a fully qualified table name built from the given catalog and ... */isCatalogAtStart(...)getCatalogSeparator(...)/** Assigns to the given <code>CachedRowSet</code> object's ... */ResultSetMetaData resultsetmdArrayList<Integer> listKeysTypes.STRUCTTypes.SQLXMLTypes.OTHER/** Constructs an SQL <code>WHERE</code> clause using the given ... */PreparedStatement pStmtString strWhereString strExecString strUpdateString strSet/** Validate whether the Primary Key is known to the CachedRowSet.  If it is ... */boolean isValidgetColumnClassName(...)// We assume caller is a CachedRowSet// crsResolve = new CachedRowSetImpl();// The reader is registered with the writer at design time.// This is not required, in general.  The reader has logic// to get a JDBC connection, so call it./* // Fix 6200646. ... */// moved outside the insert inner loop//pstmtIns = con.prepareStatement(insertCmd);// No data, so return success.// We need to see rows marked for deletion.// Look at all the rows.// The row has been deleted.// delete happened without any occurrence of conflicts// so update status accordingly// The row has been inserted.// insert happened without any occurrence of conflicts// The row has been updated.// update happened without any occurrence of conflicts/** The row is neither of inserted, updated or deleted. ... */// close the insert statement//SyncResolver syncRes = spe.getSyncResolver();/* if (conflict == true) { ... */// Select the row from the database./** The following block of code is for checking a particular type of ... */// Older driver don't support these operations./** More than one row conflict. ... */// don't close the rs// we require the record in rs to be used.// rs.close();// pstmt.close();// how many fields need to be updated// There's only one row and the cursor// needs to be on that row./* the following block creates equivalent objects ... */// reset boolNull if it had been set/** This addtional checking has been added when the current value ... */// value in db has changed// don't proceed with synchronization// get the value in db and pass it to the resolver.// Set the boolNull to false,// in order to set the actual value;/** Adding the checking for rsval to be "not" null or else ... *//** Adding the additonal condition of checking for "flag" ... *//** Adding the extra condition for orig to be "not" null as the ... *///nothing to update in this case since values are equal// When values from db and values in CachedRowSet are not equal,// if db value is same as before updation for each col in// the row before fetching into CachedRowSet,// only then we go ahead with updation, else we// throw SyncProviderException.// if value has changed in db after fetching from db// for some cols of the row and at the same time, some other cols// have changed in CachedRowSet, no synchronization happens// Synchronization happens only when data when fetching is// same or at most has changed in cachedrowset// check orig value with what is there in crs for a column// before updation in crs.// At this point we are sure that// the value updated in crs was from// what is in db now and has not changed// Here the value has changed in the db after// data was fetched// Plus store this row from CachedRowSet and keep it// in a new CachedRowSet/** if nothing has changed return now - this can happen ... */// Comments needed here/** i should be equal to 1(row count), because we update ... *//** Cursor will be here, if the ResultSet may not return even a single row ... */// if executeUpdate fails it will come here,// update crsResolve with null rows/* We came here as one of the the primary keys ... *//* It is possible that the PK is null on some databases ... *//* Cursor will come here if executeUpdate fails. ... *//* Older driver don't support these operations... */// more than one row// Now check all the values in rs to be same in// db also before actually going ahead with deleting// do not delete as values in db have changed// deletion will not happen for this row from db// exit now returning true. i.e. conflict// delete the row.// Go ahead with deleting,// don't do anything here// didn't find the row// no conflict// No data, so return./* If the RowSet has a Table name we should use it. ... *//* attempt to build a table name using the info ... *//* Compose a SELECT statement.  There are three parts. */// Project List// FROM clause./* Compose an UPDATE statement. *//* Compose an INSERT statement. */// Column list/* Compose a DELETE statement. *//* set the key desriptors that will be ... */// trim all the leading and trailing whitespaces,// white spaces can never be catalog, schema or a table name.//String updateExe = ;// changed or updated values will become part of// set clause here// keycols will become part of where clause//end if ..else//end if crs.column...// Set the key cols for after WHERE =? clauseimport JdbcRowSetResourceBundle/** A class used internally to manage a <code>CachedRowSet</code> object's ... */BitSet colsInserted;/** An internal <code>BitSet</code> object used to keep track of the ... */int cols;/** The number of columns in this <code>InsertRow</code> object. *//** Creates an <code>InsertRow</code> object initialized with the ... *//** Sets the bit in this <code>InsertRow</code> object's internal ... *//** Indicates whether this <code>InsertRow</code> object has a value ... */ResultSetMetaData.columnNoNulls/** Clears all the bits in the internal <code>BitSet</code> object ... *//** Sets the element in this <code>InsertRow</code> object's ... */markColInserted(...)/** A class that keeps track of a row's values. A <code>Row</code> object ... */...[] currentVals;/** An array containing the current column values for this <code>Row</code> ... */BitSet colsChanged;/** A <code>BitSet</code> object containing a flag for each column in ... */boolean deleted;/** A <code>boolean</code> indicating whether or not this <code>Row</code> ... */boolean updated;boolean inserted;int numCols;/** The number of columns in this <code>Row</code> object. ... *//** Creates a new <code>Row</code> object with the given number of columns. ... */this.numCols/** Creates a new <code>Row</code> object with the given number of columns ... *//** This method is called internally by the <code>CachedRowSet.populate</code> ... *//** This method is called internally by the <code>CachedRowSet.updateXXX</code> ... */setColUpdated(...)/** Retrieves the column value stored in the designated column of this ... *//** Indicates whether the designated column of this <code>Row</code> object ... *//** Sets this <code>Row</code> object's <code>deleted</code> field ... *//** Retrieves the value of this <code>Row</code> object's <code>deleted</code> field, ... *//** Sets the <code>deleted</code> field for this <code>Row</code> object to ... *//** Sets the value of this <code>Row</code> object's <code>inserted</code> field ... *//** Retrieves the value of this <code>Row</code> object's <code>inserted</code> field, ... *//** Sets the <code>inserted</code> field for this <code>Row</code> object to ... *//** Retrieves the value of this <code>Row</code> object's ... *//** Sets the <code>updated</code> field for this <code>Row</code> object to ... *//** Sets the bit at the given index into this <code>Row</code> object's internal ... *//** Sets the column values in this <code>Row</code> object's internal ... *//** Returns the row on which the cursor is positioned. ... */// maps to array!!// %%% was public// only mark something as updated if one or// more of the columns has been changed./** There will be two sets of data which will be maintained by the rowset at the ... */CachedRowSetImpl crsRes;/** This CachedRowSet object will encapsulate a rowset ... */CachedRowSetImpl crsSync;/** This is the actual CachedRowSet object ... */ArrayList<?> stats;/** This ArrayList will contain the status of a row ... */CachedRowSetWriter crw;/** The RowSetWriter associated with the original ... */int rowStatus;/** Row number identifier */int sz;/** This will contain the size of the <code>CachedRowSet</code> object *//** The <code>Connection</code> handle used to synchronize the changes ... */CachedRowSet row;/** The <code>CachedRowSet</code> object which will encapsulate ... *//** Public constructor */new CachedRowSetWriter(...)/** Retrieves the conflict status of the current row of this ... *//** Retrieves the value in the designated column in the current row of this ... *//** Sets <i>obj</i> as the value in column <i>index</i> in the current row of the ... */buildCachedRow(...)/** This passes a CachedRowSet as a row the the CachedRowSetWriter ... */updateResolvedConflictToDB(...)getReader(...)/** This function builds a row  as a <code>CachedRowSet</code> object ... */CachedRowSetImpl crsRowRowSetMetaDataImpl rsmdRow/** Sets <i>obj</i> as the value in column <i>columnName</i> in the current row of the ... *//** This function is package private, ... *//** Moves the cursor down one row from its current position. A <code>SyncResolver</code> ... *//** Moves the cursor to the previous conflict row in this <code>SyncResolver</code> object. ... */// end next() method// modify method to throw SQLException in spec/** When a value is resolved properly make it to null ... */// check whether the index is in range// check whether index col is in conflict// modify method to throw for SQLException/** Check resolved value to be either of conflict ... *//** Check whether this is the only conflict in the row. ... *//** Step 2: Change the value in the CachedRowSetImpl object ... */// break out of loop and wait for other cols// in same row to get resolved/** sync data back using CachedRowSetWriter ... *//** Note : The use of CachedRowSetWriter to get *same* Connection handle. ... *///crw.writeData( (RowSetInternal)crsRow);//System.out.printlnt.println("12");/** This will occur if db is not allowing ... *///end if(bool)//end if (crs.getObject ...) block// %%% Missing implementation!/** The next() method will hop from ... *///sz--;// bool remains as false//end classimport org.xml.sax.helpers.*/** An implementation of the <code>XmlReader</code> interface, which ... *//** Parses the given <code>WebRowSet</code> object, getting its input from ... */InputSource isDefaultHandler dhnew XmlErrorHandler(...)XmlReaderContentHandler hndrnew XmlReaderContentHandler(...)SAXParserFactory factorySAXParser parserXMLReader reader1getXMLReader(...)setEntityResolver(...)new XmlResolver(...)setContentHandler(...)SAXParseException errgetLineNumber(...)getSystemId(...)ArrayIndexOutOfBoundsException aie/** For code coverage purposes only right now */// Crimson Parser(as in J2SE 1.4.1 is NOT able to handle// Reader(s)(FileReader).// But getting the file as a Stream works fine. So we are going to take// the reader but send it as a InputStream to the parser. Note that this// functionality needs to work against any parser// Crimson(J2SE 1.4.x) / Xerces(J2SE 1.5.x).// Will be here if trying to write beyond the RowSet limits/** An implementation of the <code>XmlWriter</code> interface, which writes a ... *//** The <code>java.io.Writer</code> object to which this <code>WebRowSetXmlWriter</code> ... */Stack<String> stack;/** The <code>java.util.Stack</code> object that this <code>WebRowSetXmlWriter</code> ... *//** Writes the given <code>WebRowSet</code> object as an XML document ... */new Stack<String>(...)writeRowSet(...)/** @exception */startHeader(...)writeProperties(...)writeMetaData(...)endHeader(...)setTag(...)endTag(...)beginSection(...)int[] kcMap<String,Class<?>> typeMapint itypeString strTypeString strProviderInstanceString strProviderpropString(...)processSpecialCharacters(...)propInteger(...)propBoolean(...)kc.lengthendSection(...)Entry<String,Class<?>> mmMap<>.Entry<String,Class<?>>getProviderGrade(...)getDataSourceLock(...)int columnCountint colIndexbeginTag(...)long lTime timeTimestamp tswriteNull(...)writeInteger(...)writeFloat(...)writeDouble(...)writeBigDecimal(...)writeStringData(...)/* This begins a new tag with a indent */writeIndent(...)/* This closes a tag started by beginTag with a indent */String beginTagemptyTag(...)writeEmptyString(...)/** Purely for code coverage purposes.. *//** This function has been added for the processing of special characters ... */char[] charStrString specialStrcharStr.length// create a new stack for tag checking.// it may be the case that fetch direction has not been set// fetchDir  == 0// in that case it will throw a SQLException.// To avoid that catch it here//Changed to beginSection and endSection for maps for proper indentation// Remove the string after "@xxxx"// before writing it to the xml file.// this is unchecked//Need to take care of BLOB, CLOB, Array, Ref here// store the current tag// write it out// get the current tag and write it out// write tag out// write an emptyTag// add the tag to stack// indent.../** An implementation of the <code>DefaultHandler</code> interface, which ... */int errorCounter;/** The document handler that receives parse events that an XML parser sends while it ... */HashMap<String,Integer> propMap;HashMap<String,Integer> colDefMap;HashMap<String,Integer> dataMap;HashMap<String,Class<?>> typeMap;Vector<Object[]> updates;Vector<String> keyCols;String columnValue;String propertyValue;String metaDataValue;WebRowSetImpl rs;boolean nullVal;boolean emptyStringVal;RowSetMetaData md;int idx;String lastval;String Key_map;String Value_map;String tempStr;String tempUpdate;String tempCommand;...[] upd;/** A list of the properties for a rowset. There is a constant defined to ... */int CommandTag;/** A constant representing the tag for the command property. */int ConcurrencyTag;/** A constant representing the tag for the concurrency property. */int DatasourceTag;/** A constant representing the tag for the datasource property. */int EscapeProcessingTag;/** A constant representing the tag for the escape-processing property. */int FetchDirectionTag;/** A constant representing the tag for the fetch-direction property. */int FetchSizeTag;/** A constant representing the tag for the fetch-size property. */int IsolationLevelTag;/** A constant representing the tag for the isolation-level property */int KeycolsTag;/** A constant representing the tag for the key-columns property. */int MapTag;/** A constant representing the tag for the map property. ... */int MaxFieldSizeTag;/** A constant representing the tag for the max-field-size property. */int MaxRowsTag;/** A constant representing the tag for the max-rows property. */int QueryTimeoutTag;/** A constant representing the tag for the query-timeout property. */int ReadOnlyTag;/** A constant representing the tag for the read-only property. */int RowsetTypeTag;/** A constant representing the tag for the rowset-type property. */int ShowDeletedTag;/** A constant representing the tag for the show-deleted property. */int TableNameTag;/** A constant representing the tag for the table-name property. */int UrlTag;/** A constant representing the tag for the URL property. */int PropNullTag;/** A constant representing the tag for the null property. */int PropColumnTag;/** A constant representing the tag for the column property. */int PropTypeTag;/** A constant representing the tag for the type property. */int PropClassTag;/** A constant representing the tag for the class property. */int SyncProviderTag;/** A constant representing the tag for the sync-provider. */int SyncProviderNameTag;/** A constant representing the tag for the sync-provider ... */int SyncProviderVendorTag;int SyncProviderVersionTag;int SyncProviderGradeTag;int DataSourceLock;/** A constant representing the tag for the data source lock. */...[] colDef;/** A listing of the kinds of metadata information available about ... */int ColumnCountTag;/** A constant representing the tag for column-count. */int ColumnDefinitionTag;/** A constant representing the tag for column-definition. */int ColumnIndexTag;/** A constant representing the tag for column-index. */int AutoIncrementTag;/** A constant representing the tag for auto-increment. */int CaseSensitiveTag;/** A constant representing the tag for case-sensitive. */int CurrencyTag;/** A constant representing the tag for currency. */int NullableTag;/** A constant representing the tag for nullable. */int SignedTag;/** A constant representing the tag for signed. */int SearchableTag;/** A constant representing the tag for searchable. */int ColumnDisplaySizeTag;/** A constant representing the tag for column-display-size. */int ColumnLabelTag;/** A constant representing the tag for column-label. */int ColumnNameTag;/** A constant representing the tag for column-name. */int SchemaNameTag;/** A constant representing the tag for schema-name. */int ColumnPrecisionTag;/** A constant representing the tag for column-precision. */int ColumnScaleTag;/** A constant representing the tag for column-scale. */int MetaTableNameTag;/** A constant representing the tag for table-name. */int CatalogNameTag;/** A constant representing the tag for catalog-name. */int ColumnTypeTag;/** A constant representing the tag for column-type. */int ColumnTypeNameTag;/** A constant representing the tag for column-type-name. */int MetaNullTag;/** A constant representing the tag for null. */int RowTag;int ColTag;int InsTag;int DelTag;int InsDelTag;int UpdTag;int NullTag;int EmptyStringTag;int INITIAL;/** A constant indicating the state of this <code>XmlReaderContentHandler</code> ... */int PROPERTIES;/** A constant indicating the state in which this <code>XmlReaderContentHandler</code> ... */int METADATA;int DATA;/** Constructs a new <code>XmlReaderContentHandler</code> object that will ... */new Vector<Object[]>(...)/** Creates and initializes three new <code>HashMap</code> objects that map ... */int itemsproperties.lengthcolDef.length/** Sets this <code>XmlReaderContentHandler</code> object's <code>tag</code> ... */setNullValue(...)setEmptyStringValue(...)/** Sets the value for the given element if <code>name</code> is one of ... */getNullValue(...)setMetaDataValue(...)insertValue(...)applyUpdates(...)getEmptyStringValue(...)Object[] updremoveAllElements(...)/** Sets a property, metadata, or data value with the characters in ... */setDataValue(...)/** Retrieves the current state of this <code>XmlReaderContentHandler</code> ... */parseShort(...)getLongValue(...)boolean nullValuegetIntegerValue(...)getBooleanValue(...)getStringValue(...)int iTypegetShortValue(...)getFloatValue(...)getDoubleValue(...)getBigDecimalValue(...)getBinaryValue(...)getDateValue(...)getTimeValue(...)getTimestampValue(...)/** Throws the given <code>SAXParseException</code> object. This ... *//** Prints a warning message to <code>System.out</code> giving the line ... */// dump warnings too/** Returns the current row of this <code>Rowset</code>object. ... */// keep the rowset we've been given// set-up the token maps// allocate the collection for the updates// start out with the empty string//Initialize connection map here/** This has been added to clear out the values of the previous read ... *///Added the handling for Class tags to take care of maps//Makes an entry into the map upon end of class tag//Added the handling for Map to take set the typeMap// propertyValue need to be reset to an empty string// metaDataValue needs to be reset to an empty string// columnValue now need to be reset to the empty string// Making this as the original to turn off the// rowInserted flagging// now handle any updates/** This has been added for handling of special characters. When special ... */// Added the following check for handling of type tags in maps// Added the following check for handling of class tags in maps// The parser will come here after the endElement as there is// "\n" in the after endTag is printed. This will cause a problem// when the data between the tags is an empty string so adding// below condition to take care of that situation.// find out if we are going to be dealing with a null//rs.setCommand(null);//rs.setType(getIntegerValue(s));//rs.setTableName(null);// to be implemented//System.out.println("MetaData: Unknown Tag: (" + getTag() + ")");//updates.add(upd);//insertValue(ch, start, len);// no longer have to deal with those pesky nulls.//rs.setOriginalRow();// ResultSetMetaData rsmd = rs.getMetaData();// int numCols = rsmd.getColumnCount();// Object vals[] = new Object[numCols];// for(int j = 1; j<= numCols ; j++){//     vals[j-1] = rs.getObject(j);// }// return(new Row(numCols, vals));import EntityResolver/** An implementation of the <code>EntityResolver</code> interface, which ... */String schemaName/** The reference implementation of a JDBC Rowset synchronization provider ... */CachedRowSetWriter writer;String providerID;/** The unique provider identifier. *//** The vendor name of this SyncProvider implementation */String versionNumber;/** The version number of this SyncProvider implementation *//** ResourceBundle *//** Creates an <code>RIOptimisticProvider</code> object initialized with the ... */new CachedRowSetReader(...)/** Returns the <code>'javax.sql.rowset.providers.RIOptimisticProvider'</code> ... *//** Returns the <code>javax.sql.RowSetWriter</code> object for this ... */setReader(...)/** Returns the <code>javax.sql.RowSetReader</code> object for this ... *//** Returns the <code>SyncProvider</code> grade of synchronization that ... */SyncProvider.GRADE_CHECK_MODIFIED_AT_COMMIT/** Modifies the data source lock severity according to the standard ... */SyncProvider.DATASOURCE_NO_LOCK/** Returns the active data source lock severity in this ... *//** Returns the supported updatable view abilities of the ... *//** Returns the release version ID of the Reference Implementation Optimistic ... */this.versionNumber/** Returns the vendor name of the Reference Implementation Optimistic ... */this.vendorName/** A reference implementation of a JDBC RowSet synchronization provider ... *//** The vendor name of this SyncProvider implementation. *//** The version number of this SyncProvider implementation. */XmlReader xmlReader;XmlWriter xmlWriter;/** This provider is available to all JDBC <code>RowSet</code> implementations as the ... *//** Returns <code>"javax.sql.rowset.providers.RIXMLProvider"</code>, which is ... *//** Sets this <code>WebRowSet</code> object's reader to the given ... */// original datasource. Allow XML state to be written out and in// additional methods that sit on top of reader/writer methods back to/** Sets this <code>WebRowSet</code> object's writer to the given ... *//** Retrieves the reader that this <code>WebRowSet</code> object ... *//** Retrieves the writer that this <code>WebRowSet</code> object ... *//** Returns the <code>SyncProvider</code> grade of syncrhonization that ... */SyncProvider.GRADE_NONE/** Returns the default UPDATABLE_VIEW behavior of this reader *//** Returns the default DATASOURCE_LOCK behavior of this reader *//** Throws an unsupported operation exception as this method does ... *//** Returns a null object as RowSetWriters are not returned by this SyncProvider *//** Returns a null object as RowSetWriter objects are not returned by this ... *//** Returns the vendor name of the Reference Implemntation Optimistic ... *//** A principal identified by a distinguished name as specified by ... *//** The principal's string name ... */LdapName name;/** The principal's name ... *//** Creates an LDAP principal. ... */getLdapName(...)/** Compares this principal to the specified object. ... *//** Computes the hash code for this principal. ... *//** Returns the name originally used to create this principal. ... *//** Creates a string representation of this principal's name in the format ... */// Create an LdapName object from a string distinguished name./** <p> This class implements the <code>Principal</code> interface ... *//** @serial *//** Create an <code>NTDomainPrincipal</code> with a Windows NT domain name. ... */MessageFormat formObject[] source/** Return the Windows NT domain name for this ... *//** Return a string representation of this <code>NTDomainPrincipal</code>. ... *//** Compares the specified Object with this <code>NTDomainPrincipal</code> ... */NTDomainPrincipal that/** Return a hash code for this <code>NTDomainPrincipal</code>. ... *//** <p> This class abstracts an NT security token ... */long impersonationToken;/** Create an <code>NTNumericCredential</code> with an integer value. ... */this.impersonationToken/** Return an integer representation of this ... *//** Return a string representation of this <code>NTNumericCredential</code>. ... *//** Compares the specified Object with this <code>NTNumericCredential</code> ... */NTNumericCredential that/** Return a hash code for this <code>NTNumericCredential</code>. ... */String sid;/** Create an <code>NTSid</code> with a Windows NT SID. ... *//** Return a string version of this <code>NTSid</code>. ... *//** Return a string representation of this <code>NTSid</code>. ... *//** Compares the specified Object with this <code>NTSid</code> ... */NTSid thatthat.sid/** Return a hash code for this <code>NTSid</code>. ... *//** <p> This class extends <code>NTSid</code> ... *//** Create an <code>NTSidDomainPrincipal</code> with a Windows NT SID. ... *//** Return a string representation of this <code>NTSidDomainPrincipal</code>. ... *//** Compares the specified Object with this <code>NTSidDomainPrincipal</code> ... *//** Create an <code>NTSidGroupPrincipal</code> with a Windows NT group name. ... *//** Return a string representation of this <code>NTSidGroupPrincipal</code>. ... *//** Compares the specified Object with this <code>NTSidGroupPrincipal</code> ... *//** Create an <code>NTSidPrimaryGroupPrincipal</code> with a Windows NT ... *//** Return a string representation of this ... *//** Compares the specified Object with this ... *//** Create an <code>NTSidUserPrincipal</code> with a Windows NT SID. ... *//** Return a string representation of this <code>NTSidUserPrincipal</code>. ... *//** Compares the specified Object with this <code>NTSidUserPrincipal</code> ... *//** Create an <code>NTUserPrincipal</code> with a Windows NT username. ... *//** Return the Windows NT username for this <code>NTPrincipal</code>. ... *//** Return a string representation of this <code>NTPrincipal</code>. ... *//** Compares the specified Object with this <code>NTUserPrincipal</code> ... */NTUserPrincipal that/** Return a hash code for this <code>NTUserPrincipal</code>. ... */import PermissionCollection/** This class represents a default implementation for ... */AuthPolicyFile apf;/** Initializes the Policy object and reads the default policy ... */new AuthPolicyFile(...)/** Refreshes the policy object by re-reading all the policy files. ... *//** Examines this <code>Policy</code> and returns the Permissions granted ... */getPermissions(...)/** An object that implements the <code>java.security.Principal</code> ... *//** Check if the specified <code>Subject</code> is implied by ... */ResourceBundle rb;boolean primaryGroup;/** Create a <code>SolarisNumericGroupPrincipal</code> using a ... */this.primaryGroup/** Return the user's group identification number (GID) for this ... *//** Return whether this group identification number (GID) represents ... */SolarisNumericGroupPrincipal thatisPrimaryGroup(...)/** Return a hash code for this <code>SolarisNumericGroupPrincipal</code>. ... *//** Create a <code>SolarisNumericUserPrincipal</code> using a ... *//** Return the user identification number (UID) for this ... */SolarisNumericUserPrincipal that/** Return a hash code for this <code>SolarisNumericUserPrincipal</code>. ... *//** Create a SolarisPrincipal with a Solaris username. ... *//** Return the Unix username for this <code>SolarisPrincipal</code>. ... *//** Return a string representation of this <code>SolarisPrincipal</code>. ... *//** Compares the specified Object with this <code>SolarisPrincipal</code> ... */SolarisPrincipal that/** Return a hash code for this <code>SolarisPrincipal</code>. ... *//** Create a <code>UnixNumericGroupPrincipal</code> using a ... */UnixNumericGroupPrincipal that/** Return a hash code for this <code>UnixNumericGroupPrincipal</code>. ... *//** Create a <code>UnixNumericUserPrincipal</code> using a ... */UnixNumericUserPrincipal that/** Return a hash code for this <code>UnixNumericUserPrincipal</code>. ... *//** Create a UnixPrincipal with a Unix username. ... *//** Return the Unix username for this <code>UnixPrincipal</code>. ... *//** Return a string representation of this <code>UnixPrincipal</code>. ... *//** Compares the specified Object with this <code>UnixPrincipal</code> ... */UnixPrincipal that/** Return a hash code for this <code>UnixPrincipal</code>. ... *//** A user principal identified by a username or account name. ... *//** Creates a principal. ... *//** Returns a hash code for this principal. ... *//** Returns the name of this principal. ... *//** Returns a string representation of this principal. ... *//** <p> This class represents an X.500 <code>Principal</code>. ... */X500Name thisX500Name;/** Create a X500Principal with an X.500 Name, ... */new X500Name(...)/** Return the Unix username for this <code>X500Principal</code>. ... *//** Return a string representation of this <code>X500Principal</code>. ... *//** Compares the specified Object with this <code>X500Principal</code> ... */X500Principal thatX500Name thatX500Name/** Return a hash code for this <code>X500Principal</code>. ... *//** Reads this object from a stream (i.e., deserializes it) */// any parsing exceptions, return false// this will return 'true' if 'o' is a sun.security.x509.X500Name// and the X500Names are equal// re-create thisX500Nameimport Callbackimport ConfirmationCallbackimport NameCallbackimport PasswordCallbackimport TextOutputCallbackimport UnsupportedCallbackExceptionimport Boximport JOptionPaneimport JPasswordFieldimport JTextFieldComponent parentComponent;/* The parent window, or null if using the default parent *//* -- Fields -- */int JPasswordFieldLen;int JTextFieldLen;/** Creates a callback dialog with the default parent window. *//* -- Methods -- *//** Creates a callback dialog and specify the parent window. ... */this.parentComponent/* An interface for recording actions to carry out if the user ... *//** Handles the specified set of callbacks. ... */List<Object> messagesList<Action> okActionsnew ArrayList<Action>(...)ConfirmationInfo confirmationnew ConfirmationInfo(...)showOptionDialog(...)confirmation.optionTypeconfirmation.messageTypeconfirmation.optionsconfirmation.initialValueTextOutputCallback tcgetMessageType(...)TextOutputCallback.INFORMATIONJOptionPane.INFORMATION_MESSAGETextOutputCallback.WARNINGJOptionPane.WARNING_MESSAGETextOutputCallback.ERRORNameCallback ncJLabel promptgetPrompt(...)JTextField nameString defaultNamegetDefaultName(...)Box namePanelPasswordCallback pcJPasswordField passwordnew JPasswordField(...)Box passwordPanelisEchoOn(...)setEchoChar(...)ConfirmationCallback ccsetCallback(...)JOptionPane.OK_OPTIONJOptionPane.YES_OPTIONIterator<Action> iteratorperform(...)handleResult(...)/* Provides assistance with translating between JAAS and Swing ... */JOptionPane.OK_CANCEL_OPTIONJOptionPane.QUESTION_MESSAGE...[] translations;int optionType;...[] options;Object initialValue;int messageType;ConfirmationCallback callback;/* Set the confirmation callback handler */int confirmationOptionTypegetOptionType(...)int confirmationMessageTypethis.callbackConfirmationCallback.YES_NO_OPTIONJOptionPane.YES_NO_OPTIONConfirmationCallback.YESJOptionPane.NO_OPTIONConfirmationCallback.NOJOptionPane.CLOSED_OPTIONConfirmationCallback.YES_NO_CANCEL_OPTIONJOptionPane.YES_NO_CANCEL_OPTIONJOptionPane.CANCEL_OPTIONConfirmationCallback.CANCELConfirmationCallback.OK_CANCEL_OPTIONConfirmationCallback.OKConfirmationCallback.UNSPECIFIED_OPTIONgetOptions(...)getDefaultOption(...)ConfirmationCallback.WARNINGConfirmationCallback.ERRORConfirmationCallback.INFORMATION/* Process the result returned by the Swing dialog */translations.length/* JAAS imports *//* Java imports *//* Collect messages to display in the dialog *//* Collection actions to perform if the user clicks OK *//* Put the prompt and name in a horizontal box, ... *//* Store the name back into the callback if OK *//* Display the dialog *//* title *//* icon *//* options *//* initialValue *//* Perform the OK actions *//* There's no way to know if the default option means ... */import PushbackInputStreamimport Password/** <p>Creates a callback handler that prompts and reads from the ... */ConfirmationCallback confirmationreadPassword(...)doConfirmation(...)/* Reads a line of input */int messageTypeOptionInfo[] optionsint optionTypeint defaultOptionString promptString[] optionStringsnew OptionInfo[]new OptionInfo(...)optionStrings.lengthoptions.length...[...].name/* Do the confirmation callback last. */// defaultOption is an index into the options array// defaultOption is an option value// See JDK-8005117 for more information.// sun.security.provider.ConfigFile.Spi and not this class.// implementation. All implementation fixes and enhancements should be made to// sun.security.provider.ConfigFile.Spi and forwards all methods to that// NOTE: As of JDK 8, this class instantiatesConfigFile.Spi spi;ConfigFile.Spi/** Create a new {@code Configuration} object. ... */new Spi(...)/** Create a new {@code Configuration} object from the specified {@code URI}. ... *//** Retrieve an entry from the {@code Configuration} using an application ... */engineGetAppConfigurationEntry(...)/** Refresh and reload the {@code Configuration} by re-reading all of the ... */engineRefresh(...)...[] IP;/* EXPORT DELETE START */...[] FP;...[] PC1_C;...[] PC1_D;...[] shifts;...[] PC2_C;...[] PC2_D;...[] C;...[] D;...[] KS;...[] E;...[] e2;byte t...[] P;...[] L;...[] tempL;...[] f;...[] preS;int R/** Creates a new Crypt object for use with the crypt method. *//* EXPORT DELETE END *//** Implements the libc crypt(3) function. ... */int pwibyte[] iobufpw.lengthsetkey(...)/** program to test the crypt routine. ... */Crypt cnew Crypt(...)arg.length/* Copyright (c) 2000, 2003, Oracle and/or its affiliates. All rights reserved. ... *//* Copyright (c) 1988 AT&T *//* All Rights Reserved *//** Implements the UNIX crypt(3) function, based on a direct port of the ... */// &L[32]// does nothing at this time//iobuf[i+2] = 0;import UnixPrincipalimport UnixNumericUserPrincipalimport UnixNumericGroupPrincipal/** <p> The module prompts for a username and password ... */new LinkedList<UnixNumericGroupPrincipal>(...)String USER_PROVIDER;/** JNDI Provider */String GROUP_PROVIDER;// configurable optionsboolean strongDebug;String userProvider;String groupProvider;// the authentication status// username, password, and JNDI contextDirContext ctx;UnixPrincipal userPrincipal;// the user (assume it is a UnixPrincipal)UnixNumericUserPrincipal UIDPrincipal;UnixNumericGroupPrincipal GIDPrincipal;LinkedList<UnixNumericGroupPrincipal> supplementaryGroups;String CRYPT;String USER_PWD;String USER_UID;String USER_GID;String GROUP_ID;String NAME;String PWD;// passing known keys.// Unchecked warnings from options.get(String) are safe since we are// since javax.security.auth.login.LoginContext passes a raw HashMap.// Unchecked warning from (Map<String, Object>)sharedState is safe/** <p> Prompt for username and password. ... *//** Abstract method to commit the authentication process (phase 2). ... *//** <p> This method is called if the LoginContext's ... */String encryptedPasswordInitialContext iCtxSearchControls controlsNamingEnumeration<SearchResult> neAttributes attributesAttribute pwdString encryptedPwdAttribute uidString uidNumberAttribute gidString gidNumberverifyPassword(...)new UnixPrincipal(...)new UnixNumericUserPrincipal(...)new UnixNumericGroupPrincipal(...)String suppGidUnixNumericGroupPrincipal suppPrincipalString protocol/** Verify a password against the encrypted passwd from /etc/shadow */byte[] oldCryptbyte[] newCryptnewCrypt.lengtholdCrypt.length// attempt the authentication by prompting for the username and pwd// first get the username and password// get the user's passwd entry from the user provider URL/* SearchControls controls = new SearchControls ... */// get the password// this module works only if the LDAP directory server// is configured to permit read access to the userPassword// attribute. The directory administrator need to grant// this access.// A workaround would be to make the server do authentication// by setting the Context.SECURITY_PRINCIPAL// and Context.SECURITY_CREDENTIALS property.// However, this would make it not work with systems that// don't do authentication at the server (like NIS).// Setting the SECURITY_* properties and using "simple"// authentication for LDAP is recommended only for secure// channels. For nonsecure channels, SSL is recommended.// check the password// save input as shared state only if// create the user principal// get the UID// get the GID// get the supplementary groups from the group provider URL// bad username// password stored in incorrect format// prompt for a username and password// print debugging information// cannot happen, but return false just to be safeimport Destroyableimport DestroyFailedExceptionimport javax.security.auth.x500.*import FailedLoginException/** Provides a JAAS login module that prompts for a key store alias and ... */new ConfirmationCallback(...)new TextOutputCallback(...)int UNINITIALIZED;int AUTHENTICATED;int LOGGED_IN;int PROTECTED_PATH;int TOKEN;int NORMAL;String NONE;String P11KEYSTORE;TextOutputCallback bannerCallback;ConfirmationCallback confirmationCallback;...[] keyStorePassword;...[] privateKeyPassword;String keyStoreURL;String keyStoreType;String keyStoreProvider;String keyStoreAlias;String keyStorePasswordURL;String privateKeyPasswordURL;X500Principal principal;...[] fromKeyStore;CertPath certP;X500PrivateCredential privateCredential;boolean nullStream;boolean token;boolean protectedPath;processOptions(...)getDefaultType(...)debugPrint(...)/** Authenticate the user. ... */getAliasAndPasswords(...)getKeyStoreInfo(...)/** Get the alias and passwords to use for looking up in the KeyStore. */checkAlias(...)checkStorePass(...)checkKeyPass(...)NameCallback aliasCallbackPasswordCallback storePassCallbackPasswordCallback keyPassCallbackprompt(...)int confirmationResultUnsupportedCallbackException esaveAlias(...)saveStorePass(...)saveKeyPass(...)privateKeyPassword.length/** Get the credentials from the KeyStore. */fromKeyStore.lengthLinkedList<Certificate> certListnew LinkedList<Certificate>(...)CertificateFactory certFgenerateCertPath(...)CertificateException ceX509Certificate certificateKey privateKeynew X500Principal(...)getSubjectDN(...)new X500PrivateCredential(...)UnrecoverableKeyException eFailedLoginException flegetAlias(...)logoutInternal(...)commitInternal(...)getPublicCredentials(...)getPrivateCredentials(...)LoginException logoutExceptionAuthProvider apIterator<Object> itDestroyFailedException dfe// get relevant alias and password info// log into KeyStore to retrieve data,// then clear passwords// No callback handler - check for alias and password options// Callback handler available - prompt for alias and passwords// fall thru// only prompt for alias// prompt for alias and key store password// prompt for alias, key store password, and key password/* Treat a NULL password as an empty password *//* Use keystore password if no private key password is ... *//* Get KeyStore instance *//* Load KeyStore contents from file */// if using protected auth path, keyStorePassword will be null/* Get certificate chain and create a certificate path *//* Get principal and keys */// if token, privateKeyPassword will be null/* If the subject is not readonly add to the principal and credentials ... */// impossible for LoginModule to be in AUTHENTICATED// assert status != AUTHENTICATED;// assumption is that KeyStore.load did a login -// perform explicit logout if possible// save but continue below// attempt to destroy the private credential// even if the Subject is read-only// destroy the private credential// throw an exception because we can not remove// the principal and public credential from this// read-only Subject// throw pending logout exception if there is one// we should switch to logging APIimport javax.security.auth.kerberos.*import sun.security.krb5.*import Krb5Utilimport Credentials/** <p> This <code>LoginModule</code> authenticates users using ... */// configurable optionboolean storeKey;boolean doNotPrompt;boolean useTicketCache;boolean useKeyTab;String ticketCacheName;String keyTabName;String princName;boolean refreshKrb5Config;boolean renewTGT;boolean isInitiator;// perform authentication exchange if initiator// specify if initiator....[] encKeys;// and useKeyTab == false (or true but not found)// Encryption keys calculated from password. Assigned when storekey == trueKeyTab ktab;Credentials cred;PrincipalName principal;KerberosPrincipal kerbClientPrinc;KerberosTicket kerbTicket;...[] kerbKeys;StringBuffer krb5PrincName;boolean unboundServer;String isInitiatorValue/** Authenticate the user ... */String principalPropertyKrbException kevalidateConfiguration(...)LoginException e/** process the configuration options ... */new PrincipalName(...)PrincipalName.KRB_NT_PRINCIPALKrbException eacquireTGTFromCache(...)isCurrent(...)renewCredentials(...)getClient(...)KrbAsReqBuilder builderpromptForName(...)KerberosPrincipal kpnew KerberosPrincipal(...)getUnboundInstance(...)keysFromJavaxKeyTab(...).lengthkeysFromJavaxKeyTab(...)promptForPass(...)new KrbAsReqBuilder(...)getCreds(...)action(...)HexDumpEncoder hdencKeys.lengthgetEType(...)LoginException ieString defUsernameString userNameDate endTimeCredentials lcredsisRenewable(...)new RefreshFailedException(...)getRenewTill(...)renew(...)Set<Object> privCredSetSet<Principal> princSetcleanKerberosCred(...)credsToTicket(...)new KerberosKey[]Integer tempgetKeyVersionNumber(...)new KerberosKey(...)kerbKeys.length/** Logout the user. ... *//** Clean Kerberos credentials */DestroyFailedException e/** Clean out the state */// check isInitiator value// use default, if value not set// authentication failed -- clean out state// attempt the authentication by getting the username and pwd// by prompting or configuration i.e. not from shared state/* Check the creds cache to see whether ... */// ticketCacheName == null implies the default cache// check to renew credentials// credentials have expired// get the principal name from the ticket cache// cred = null indicates that we didn't get the creds// from the cache or useTicketCache was false// We need the principal name whether we use keytab// or AS Exchange/* Before dynamic KeyTab support (6894072), here we check if ... */// XXX Even if isInitiator=false, it might be// better to do an AS-REQ so that keys can be// updated with PA info// When encKeys is empty, the login actually fails.// For compatibility, exception is thrown in commit().// we should hava a non-null cred// use the name saved by the first module in the stack// clear tmpPassword/* Let us add the Krb5 Creds to the Subject's ... *//* Add the Principal (authenticated identity) ... */// create Kerberos Ticket// Let us add the kerbClientPrinc,kerbTicket and KeyTab/KerbKey (if// storeKey is true)// We won't add "*" as a KerberosPrincipal// add the TGT// login succeeded but overall authentication failed// Let us remove all Kerberos credentials stored in the Subject// clean the kerberos ticket and keys// Clean the ticket and server key// remove temp results for the next tryimport SocketPermissionimport Matcherimport LdapPrincipalimport UserPrincipal/** This {@link LoginModule} performs LDAP-based authentication. ... */// Use the default classloader for this class to load the prompt strings.// Keys to retrieve the stored username and password// Option namesString USER_FILTER;String AUTHC_IDENTITY;String AUTHZ_IDENTITY;String USERNAME_TOKEN;// Used for the username token replacementPattern USERNAME_PATTERN;String userFilter;String authcIdentity;String authzIdentity;String authzIdentityAttr;boolean useSSL;boolean authFirst;boolean authOnly;LdapPrincipal ldapPrincipal;// User's identitiesUserPrincipal userPrincipal;UserPrincipal authzPrincipal;LdapContext ctx;Matcher identityMatcher;Matcher filterMatcher;Hashtable<String,Object> ldapEnvironment;SearchControls constraints;matcher(...)/** Begin user authentication. ... *//** Complete user authentication. ... */Set<Principal> principals/** Abort user authentication. ... */replaceUsernameToken(...)new InitialLdapContext(...)findUserDN(...)new UserPrincipal(...)new LdapPrincipal(...)/** Search for the user's entry. ... */String userDNSearchResult entrygetNameInNamespace(...)/** Replace the username token ... */// Add any JNDI properties to the environment//return no attrs// to get the full DN// set later, from the specified attribute// determine mode// authentication-first mode// authentication-only mode// Prepare to bind using user's username and password// Connect to the LDAP server (using simple bind)// Authentication has succeeded// Locate the user's distinguished name// Connect to the LDAP server (using anonymous bind)// Prepare to bind using user's distinguished name and password// Save input as shared state only if authentication succeeded// Create the user principals// Locate the user's LDAP entry// Extract the distinguished name of the user's entry// (Use the first entry if more than one is returned)// %%% - use the SearchResult.getNameInNamespace method//        available in JDK 1.5 and later.//        (can remove call to constraints.setReturningObjFlag)// Extract a value from user's authorization identity attribute// Bad username/** <p> This <code>LoginModule</code> imports a user's Unix ... */Map<String,?> sharedState;UnixSystem ss;// UnixSystem to retrieve underlying system info// Underlying system info/** Authenticate the user (first phase). ... */long[] unixGroupsnew UnixSystem(...)getUid(...)getGid(...)getGroups(...)getGroups(...).lengthunixGroups.lengthUnixNumericGroupPrincipal ngp/** Commit the authentication (second phase). ... *//** Abort the authentication (second phase). ... *//** Logout the user ... */// remove the added Principals from the Subject/** <p> This class implementation retrieves and makes available Unix ... */long uid;long gid;/** Instantiate a <code>UnixSystem</code> and load ... */getUnixInfo(...)/** Get the username for the current Unix user. ... *//** Get the UID for the current Unix user. ... *//** Get the GID for the current Unix user. ... *//** Get the supplementary groups for the current Unix user. ... */import javax.security.cert.*/** The X509V1CertImpl class is used as a conversion wrapper around ... */X509Certificate wrappedCert;/** Default constructor. *//** Unmarshals a certificate from its encoded form, parsing the ... */ByteArrayInputStream bsgetFactory(...)/** unmarshals an X.509 certificate from an input stream. ... *//** Returns the encoded form of this certificate. It is ... */CertificateEncodingException enew CertificateEncodingException(...)/** Throws an exception if the certificate was not signed using the ... *//** Checks that the certificate is currently valid, i.e. the current ... *//** Checks that the specified date is within the certificate's ... */CertificateNotYetValidException enew CertificateNotYetValidException(...)CertificateExpiredException enew CertificateExpiredException(...)/** Returns a printable representation of the certificate.  This does not ... *//** Gets the publickey from this certificate. ... *//* Gets the version number from the certificate. ... *//** Gets the serial number from the certificate. ... *//** Gets the subject distinguished name from the certificate. ... *//** Gets the issuer distinguished name from the certificate. ... */getIssuerDN(...)/** Gets the notBefore date from the validity period of the certificate. ... */getNotBefore(...)/** Gets the notAfter date from the validity period of the certificate. ... */getNotAfter(...)/** Gets the signature algorithm name for the certificate ... */getSigAlgName(...)/** Gets the signature algorithm OID string from the certificate. ... */getSigAlgOID(...)/** Gets the DER encoded signature algorithm parameters from this ... */getSigAlgParams(...)/** Kerberos 5 AuthorizationData entry. *//** Create an AuthorizationDataEntry object. ... *//** Get the ad-type field. ... *//** Get a copy of the ad-data field. ... */import org.ietf.jgss.*/** The extended GSSContext interface for supporting additional ... *//** Return the mechanism-specific attribute associated with {@code type}. ... *//** Requests that the delegation policy be respected. When a true value is ... *//** Returns the delegation policy response. Called after a security context ... *//** The extended GSSCredential interface for supporting additional ... *//** Impersonates a principal. In Kerberos, this can be implemented ... *//* Copyright (c) 2012, 2013, Oracle and/or its affiliates. All rights reserved. ... */import GSSNameimport GSSCredential/** GSS-API Utilities for using in conjunction with Sun Microsystem's ... *//** Use this method to convert a GSSName and GSSCredential into a ... */import BasicPermission/** This class is used to protect various attributes of an established ... *//** Constructs a new {@code InquireSecContextPermission} object with ... *//** Attribute types that can be specified as an argument of ... */new InquireType(...)InquireType KRB5_GET_SESSION_KEY;/** Attribute type for retrieving the session key of an ... */InquireType KRB5_GET_TKT_FLAGS;/** Attribute type for retrieving the service ticket flags of an ... */InquireType KRB5_GET_AUTHZ_DATA;/** Attribute type for retrieving the authorization data in the ... */InquireType KRB5_GET_AUTHTIME;/** Attribute type for retrieving the authtime in the service ticket ... *//** The NTLM client. Not multi-thread enabled.<p> ... */...[] pw1, ...;/** Creates an NTLM Client instance. ... */new NTLMException(...)NTLMException.PROTOCOLthis.pw1getP1(...)this.pw2getP2(...)/** Generates the Type 1 message ... */Writer pnew Writer(...)Version.NTLM/** Generates the Type 3 message ... */Reader rnew Reader(...)byte[] challengereadBytes(...)int inputFlagsboolean unicodebyte[] lmbyte[] ntlmwriteSecurityBuffer(...)byte[] lmhashcalcLMHash(...)byte[] nthashcalcNTHash(...)calcResponse(...)Version.NTLM2ntlm2LM(...)ntlm2NTLM(...)calcV2(...)byte[] alistreadSecurityBuffer(...)byte[] blobalist.lengthbyte[] timemultiply(...)time.length/** Returns the domain value provided by server after the authentication ... *//** Disposes any password-derived information. */// Negotiate always sign, Negotiate NTLM,// Request Target, Negotiate OEM, Negotiate unicode// IE uses domainFromServer to generate an alist if server has not// provided one. Firefox/WebKit do not. Neither do we.//String domainFromServer = r.readSecurityBuffer(12, unicode);// Some client create a alist even if server does not send// one: (i16)2 (i16)len target_in_unicode (i16)0 (i16) 0// TSimport static Version.*import SecretKeyFactory/** NTLM authentication implemented according to MS-NLMP, version 12.1 ... */SecretKeyFactory fac;Cipher cipher;MessageDigest md4;Mac hmac;MessageDigest md5;Version v;boolean writeLM;boolean writeNTLM;NTLMException.BAD_VERSIONNoSuchPaddingException e/** Prints out a formatted string, called in various places inside then NTLM ... */printf(...)/** Prints out the content of a byte array, called in various places inside ... *//** Reading an NTLM packet */...[] internal;NTLMException.PACKET_READ_ERRORbyte[] raw/** Writing an NTLM packet */int current;// buffer/** Starts writing a NTLM packet ... */// current written content interface bufferinternal.length/* Convert a 7 byte array to an 8 byte array (for a des key with parity) ... */// LM/NTLMint[] inbyte[] pwb1pwb.lengthDESKeySpec dks1makeDesKey(...)DESKeySpec dks2SecretKey key1generateSecret(...)SecretKey key2byte[] out1InvalidKeyException ive/* key is a 21 byte array. Split it into 3 7 byte chunks, ... */DESKeySpec dks3SecretKey key3byte[] out3IllegalBlockSizeException exBadPaddingException ex// LMv2/NTLMv2byte[] ntlmv2hashhmacMD5(...)byte[] cnblob.length// NTLM2 LM/NTLMbyte[] sesshash// Password in ASCII and UNICODE// Impossible/* Zero padded */// Will not happen, all key material are 8 bytes// Will not happen, we only feed DESKeySpec to DES factory// Will not happen, we encrypt 8 bytes// Will not happen, this is encryption// will not happen, we returned already// None will happen/** An NTLM-related Exception */int PACKET_READ_ERROR;/** If the incoming packet is invalid. */int NO_DOMAIN_INFO;/** If the client cannot get a domain value from the server and the ... */int USER_UNKNOWN;/** If the client name is not found on server's user database. *///public final static int DOMAIN_UNMATCH = 3;/** If the domain provided by the client does not match the one received ... */int AUTH_FAILED;/** If authentication fails. */int BAD_VERSION;/** If an illegal version string is provided. */int PROTOCOL;/** Protocol errors. *//** Constructs an NTLMException object. ... *//** Returns the error code associated with this NTLMException. ... *//* Copyright (c) 2010, 2011, Oracle and/or its affiliates. All rights reserved. ... *//** The NTLM server, not multi-thread enabled.<p> ... */boolean allVersion;/** Creates a Server instance. ... */this.allVersion/** Generates the Type 2 message ... *//** Verifies the Type3 message received from client and returns ... */String usernameString hostnameString incomingDomainboolean verifiedchar[] passwordbyte[] incomingLMbyte[] incomingNTLMNTLMException.USER_UNKNOWNincomingLM.lengthbyte[] pw1byte[] lmresponseincomingNTLM.lengthbyte[] pw2byte[] ntresponsebyte[] clientNoncebyte[] ntlmresponseVersion.NTLMv2byte[] clientBlobNTLMException.AUTH_FAILED/** Retrieves the password for a given user. This method should be ... */// Negotiate NTLM2 Key, Target Type Domain,// Negotiate NTLM, Request Target, Negotiate unicode/* if (incomingDomain != null && !incomingDomain.equals(domain)) { ... */// We didn't sent alist in type2(), so there// is nothing to check here.Version NTLM;Version NTLM2;Version NTLMv2;import PolicyUtils/** Client factory for EXTERNAL, CRAM-MD5, PLAIN. ... */PolicyUtils.NOANONYMOUSPolicyUtils.NODICTIONARYPolicyUtils.NOPLAINTEXTPolicyUtils.NOACTIVE...[] myMechs;...[] mechPolicies;int EXTERNAL;int CRAMMD5;int PLAIN;mechs.lengthcheckPolicy(...)new ExternalClient(...)Object[] uinfogetUserInfo(...)new CramMD5Client(...)new PlainClient(...)filterMechs(...)/** Gets the authentication id and password. The ... */String userPromptString passwdPromptNameCallback ncbPasswordCallback pcbchar[] pwbyte[] bytepwString authId/* Copyright (c) 1999, 2006, Oracle and/or its affiliates. All rights reserved. ... */// %%% RL: Policies should actually depend on the external channel// CRAM-MD5// PLAIN// Callee responsible for clearing bytepw/** Base class for implementing CRAM-MD5 client and server mechanisms. ... */boolean aborted;...[] pw;initLogger(...)/** Retrieves this mechanism's name. ... *//** Determines whether this mechanism has completed. ... *//** Unwraps the incoming buffer. CRAM-MD5 supports no security layer. ... *//** Wraps the outgoing buffer. CRAM-MD5 supports no security layer. ... *//** Retrieves the negotiated property. ... */int MD5_BLOCKSIZE;/** Hashes its input arguments according to HMAC-MD5 (RFC 2104) ... */StringBuffer digestString/** Sets logger field. */String SASL_LOGGER_NAME;/** Logger for debug messages */// For HMAC_MD5// zero out password/* digest the key if longer than 64 bytes *//* inner padding *//* outer padding *//* store key in pads *//* XOR key with pads *//* inner MD5 *//* outer MD5 */// Get character representation of digest// set in initLogger(); lazily loads logger/** Implements the CRAM-MD5 SASL client-side mechanism. ... *//** Creates a SASL mechanism with client credentials that it needs ... */this.pw/** CRAM-MD5 has no initial response. *//** Processes the challenge data. ... */String digestHMAC_MD5(...)String resp/* Copyright (c) 1999, 2010, Oracle and/or its affiliates. All rights reserved. ... */// caller should have already cloned// See if we've been here before// generate a keyed-MD5 digest from the user's password and challenge.// clear it when we no longer need it// response is username + " " + digest/** Implements the CRAM-MD5 SASL server-side mechanism. ... */String fqdn;...[] challengeData;String authzid;CallbackHandler cbh;/** Creates a CRAM-MD5 SASL server. ... */this.cbh/** Generates challenge based on response sent by client. ... */long randnextLong(...)String challengeStrresponseData.lengthint ulenchar[] pwCharsString pwStrbyte[] expectedDigestint digestLenAuthorizeCallback acbnew AuthorizeCallback(...)pwChars.lengthexpectedDigest.lengthisAuthorized(...)getAuthorizedID(...)// Generate challenge {random, timestamp, fqdn}// Examine response to see if correctly encrypted challengeData// Extract username from response// Get user's password// user has no password; OK to disclose to server// Generate a keyed-MD5 digest from the user's password and// original challenge.// clear pw when we no longer need it// Check whether digest is as expected// All checks out, use AuthorizeCallback to canonicalize name// Not authorized/** Implements the EXTERNAL SASL client mechanism. ... */...[] username;/** Constructs an External mechanism with optional authorization ID. ... *//** Retrieves this mechanism's name for initiating the "EXTERNAL" protocol ... *//** This mechanism has an initial response. *//** Returns whether this mechanism is complete. ... *//** Unwraps the incoming buffer. ... *//** Wraps the outgoing buffer. ... *//** Implements the PLAIN SASL client mechanism. ... */String authorizationID;byte SEP;// US-ASCII <NUL>this.authorizationIDthis.authenticationID/** Retrieves this mechanism's name for to initiate the PLAIN protocol ... *//** Retrieves the initial response for the SASL command, which for ... */byte[] authzbyte[] authauth.lengthauthz.length/* Copyright (c) 2000, 2006, Oracle and/or its affiliates. All rights reserved. ... *//** The SASL provider. ... */// Client mechanisms// Server mechanisms/** Server factory for CRAM-MD5. ... */new CramMD5Server(...)import AbstractSaslImpl/** Utility class for DIGEST-MD5 mechanism. Provides utility methods ... */DigestIntegrity.classDigestPrivacy.classString DI_CLASS_NAME;// Used for logging/* ------------------------- Constants ------------------------ */String DP_CLASS_NAME;int MAX_CHALLENGE_LENGTH;/* Constants - defined in RFC2831 */int MAX_RESPONSE_LENGTH;int DEFAULT_MAXBUF;int DES3;/* Supported ciphers for 'auth-conf' */int RC4;int DES;int RC4_56;int RC4_40;...[] CIPHER_TOKENS;...[] JCE_CIPHER_NAME;byte DES_3_STRENGTH;/* If QOP is set to 'auth-conf', a DIGEST-MD5 mechanism must have ... */byte RC4_STRENGTH;byte DES_STRENGTH;byte RC4_56_STRENGTH;byte RC4_40_STRENGTH;byte UNSET;...[] CIPHER_MASKS;String SECURITY_LAYER_MARKER;...[] EMPTY_BYTE_ARRAY;int step;/* Used to track progress of authentication; step numbers from RFC 2831 *//* ------------------- Variable Fields ----------------------- *//* Used to obtain authorization, pw info, canonicalized authzid for server *//* Used to get username/password, choose realm for client */SecurityCtx secCtx;...[] H_A1;...[] nonce;// component of response-valueString negotiatedStrength;/* Variables set when parsing directives in digest challenge/response. */// server generated nonceString negotiatedCipher;String negotiatedQop;String negotiatedRealm;boolean useUTF8;String digestUri;// default unless server specifies utf-8/** Constucts an instance of DigestMD5Base. Calls super constructor ... */// authzid or canonicalized authzidthis.digestUri/** Retrieves the SASL mechanism IANA name. ... *//** Unwrap the incoming message using the wrap method of the secCtx object ... *//** Wrap outgoing bytes using the wrap method of the secCtx object ... */Sasl.STRENGTHSasl.BOUND_SERVER_NAME...[] pem_array;/** This array maps the characters to their 6 bit values *//** Generate random-string used for digest-response. ... *//* ----------------- Digest-MD5 utilities ---------------- */int RAW_NONCE_SIZE;// Make sure that this is a multiple of 3int ENCODED_NONCE_SIZE;// Base 64 encoding turns each 3 bytes into 4byte[] randomDatabyte[] noncebyte arandomData.length/** Checks if a byte[] contains characters that must be quoted ... */needEscape(...)// unless escaped; also escape the escape character and CTL chars except LWS// See Section 7.2 of RFC 2831; double-quote character is not allowed// Determines whether a character needs to be escaped in a quoted string/** Convert a byte array to hexadecimal string. ... *//** Used to convert username-value, passwd or realm to 8859_1 encoding ... */char[] bufferbyte[] ciphersCIPHER_TOKENS.lengthJCE_CIPHER_NAME.length/** Assembles response-value for digest-response. ... */byte[] hexA1byte[] hexA2ByteArrayOutputStream A2ByteArrayOutputStream beginA1ByteArrayOutputStream A1ByteArrayOutputStream KDbinaryToHex(...)stringToByte_8859_1(...)nonceCountToHex(...)/** Takes 'nonceCount' value and returns HEX value of the value. ... */StringBuffer pad/** Parses digest-challenge string, extracting each token ... */byte[][] valueTablekeyTable.lengthByteArrayOutputStream keyByteArrayOutputStream valueboolean gettingKeyboolean gettingQuotedValueboolean expectSeparatorbyte bchskipLws(...)isLws(...)extractDirective(...)// %%% Note that we're checking individual bytes instead of CRLF// LWS            = [CRLF] 1*( SP | HT )// Is character a linear white space?// Skip all linear white spaces/** Processes directive/value pairs from the digest-challenge and ... *//** Implementation of the SecurityCtx interface allowing for messages ... */String CLIENT_INT_MAGIC;/* Used for generating integrity keys - specified in RFC 2831 */String SVR_INT_MAGIC;...[] myKi;/* Key pairs for integrity checking */...[] peerKi;// == Kic for client; == Kis for serverint mySeqNum;// == Kis for client; == Kic for serverint peerSeqNum;...[] messageType;// outgoing messageType and sequenceNum...[] sequenceNum;/** Initializes DigestIntegrity implementation of SecurityCtx to ... */generateIntegrityKeyPair(...)/** Generate client-server, server-client key pairs for DIGEST-MD5 ... */byte[] cimagicbyte[] simagicbyte[] keyBufferH_A1.lengthcimagic.lengthbyte[] Kicbyte[] Kissimagic.lengthtraceOutput(...)/** Append MAC onto outgoing message. ... */byte[] wrappedbyte[] macgetHMAC(...)incrementSeqNum(...)/** Return verified message without MAC - only if the received MAC ... */byte[] msgTypebyte[] seqNumbyte[] expectedMac/** Generates MAC to be appended onto out-going messages. ... */byte[] seqAndMsgSecretKey keyKiMac mbyte[] hMAC_MD5byte[] macBuffer/** Increment own sequence number and set answer in NBO sequenceNum field. */String CLIENT_CONF_MAGIC;/* Used for generating privacy keys - specified in RFC 2831 */String SVR_CONF_MAGIC;Cipher encCipher;Cipher decCipher;/** Initializes the cipher object instances for encryption and decryption. ... */generatePrivacyKeyPair(...)/** Generates client-server and server-client keys to encrypt and ... */byte[] ccmagicbyte[] scmagicccmagic.lengthbyte[] Kccbyte[] Kcsbyte[] myKcbyte[] peerKcscmagic.lengthSecretKey encKeySecretKey decKeyString cipherFullnameString cipherShortnameIvParameterSpec encIvIvParameterSpec decIvmakeDesKeys(...)/** Encrypt out-going message. ... */// -------------------------------------------------------------------int bsbyte[] toBeEncryptedpadding.lengthbyte[] cipherBlockcipherBlock.lengthtoBeEncrypted.length/* Decrypt incoming messages and verify their integrity. ... */byte[] encryptedMsgbyte[] decryptedMsgbyte[] msgWithPaddingdecryptedMsg.lengthint msgLengthmsgWithPadding.lengthencryptedMsg.lengthbyte[] clearMsgBigInteger MASK;// ---------------- DES and 3 DES key manipulation routines/** Sets the parity bit (0th bit) in each byte so that each byte ... *//** Expands a 7-byte array into an 8-byte array that contains parity bits ... */BigInteger inand(...)shiftRight(...)/** Create parity-adjusted keys suitable for DES / DESede encryption. ... */byte[] subkey1addDesParity(...)KeySpec specSecretKeyFactory desFactorybyte[] subkey2byte[] edesubkey2.lengthsubkey1.lengthisParityAdjusted(...)// sets QOP, STENGTH and BUFFER_SIZE//       0   1   2   3   4   5   6   7// SecureRandom random = new SecureRandom();// Base64-encode bytes// %%% For testing using RFC 2831 example, uncomment the following 2 lines// System.out.println("!!!Using RFC 2831's cnonce for testing!!!");// return "OA6MHXh6VqTrRk".getBytes();// escape char// quote// DEL// 0 <= ch <= 31 except CR, HT and LF// Checking whether the transformation is available from the// current installed providers.// no implementation found for requested algorithm.// A2// --// A2 = { "AUTHENTICATE:", digest-uri-value,// [:00000000000000000000000000000000] }  // if auth-int or auth-conf// A1// H(user-name : realm-value : passwd)// if no realm, realm will be an empty string// A1 = { H ( {user-name : realm-value : passwd } ),// : nonce-value, : cnonce-value : authzid-value// Record H(A1). Use for integrity & privacy.// H(k, : , s);// Empty element, skip separator and lws// Termination of key// Skip to next nonwhitespace// Check whether value is quoted// Skip quote// LWS that occurs after key// Expecting '='// Append to key// Advance// Getting a quoted value// quoted-pair = "\" CHAR  ==> CHAR// Skip escape// Trailing escape in a quoted value// closing quote// Skip closing quote//  Value terminated// Skip separator and LWS// Unquoted value// Get last pair// US-ASCII CR, carriage return// US-ASCII LF, linefeed// US-ASCII SP, space// US-ASCII HT, horizontal-tab// > 1 realm specified// add existing one// add new one// end search/* Initialize magic strings *//* Message type is a fixed value */// Both client-magic-keys and server-magic-keys are the same length// Kic: Key for protecting msgs from client to server.// Kis: Key for protecting msgs from server to client// No need to recopy H_A1/* wrapped = message, MAC, message type, sequence number *//* Start with message itself *//* Calculate MAC *//* Add MAC[0..9] to message *//* Add message type [0..1] *//* Add sequence number [0..3] */// shave off last 16 bytes of message/* Get Msg, MAC, msgType, sequenceNum *//* Calculate MAC to ensure integrity *//* First, compare MAC's before updating any of our state *///  Discard message and do not increment sequence number/* Ensure server-sequence numbers are correct */// Increment sequence number and return message/* First 10 bytes of HMAC_MD5 digest */// generate Kic, Kis keys for integrity-checking./* Kcc = MD5{H(A1)[0..n], "Digest ... client-to-server"} *//* H(A1)[0..5] *//* H(A1)[0..7] */// des and 3des and rc4/* H(A1)[0..16] *//* {H(A1)[0..n], "Digest ... client-to-server..."} */// H(A1)[0..n]/* Kcc: Key for encrypting messages from client->server *//* Kcs: Key for decrypting messages from server->client */// No need to copy H_A1 again since it hasn't changed/* Initialize cipher objects */// DES or 3DES// Use "NoPadding" when specifying cipher names// RFC 2831 already defines padding rules for producing// 8-byte aligned blocks/* 3DES */// Set up the DES IV, which is the last 8 bytes of Kcc/Kcs// Initialize cipher objects/* HMAC(Ki, {SeqNum, msg})[0..9] */// Calculate padding// add 10 for HMAC[0..9]/* {msg, pad, HMAC(Ki, {SeqNum, msg}[0..9])} *//* CIPHER(Kc, {msg, pad, HMAC(Ki, {SeqNum, msg}[0..9])}) */// Do CBC (chaining) across packets// update() can return null/* Get cipherMsg; msgType; sequenceNum */// Decrypt message// get value of last octet of the byte array/* Re-calculate MAC to ensure integrity */// First, compare MACs before updating state/* Ensure sequence number is correct *//* Check message type */// no padding// Get a copy of the message without padding// Shift 7 bits each time into a byte// make room for parity bit// Generate first subkey using first 7 bytes// Generate second subkey using second 7 bytes// Construct 24-byte encryption-decryption-encryption sequence/** An implementation of the DIGEST-MD5 ... */String MY_CLASS_NAME;String CIPHER_PROPERTY;// Property for specifying cipher explicitly...[] DIRECTIVE_KEY;/* Directives encountered in challenges sent by the server. */int REALM;/* Indices into DIRECTIVE_KEY */int QOP;int ALGORITHM;int NONCE;int MAXBUF;int CHARSET;int CIPHER;int RESPONSE_AUTH;int STALE;int nonceCount;String specifiedCipher;/* User-supplied/generated information */// number of times nonce has been used/seen...[] cnonce;// cipher explicitly requested by user// client generated nonce...[] authzidBytes;/** Constructor for DIGEST-MD5 mechanism. ... */// byte repr of authzidthis.authzid/** DIGEST-MD5 has no initial response ... *//** Process the challenge data. ... */byte[][] challengeValchallengeData.lengthList<byte[]> realmChoicesparseDirectives(...)processChallenge(...)checkQopSupport(...)generateClientResponse(...)validateResponseValue(...)new DigestPrivacy(...)new DigestIntegrity(...)/** Record information from the challengeVal array into variables/fields. ... */int srvMaxBufSizeString[] realmTokensrealmTokens.lengthRealmCallback tcbnew RealmCallback(...)RealmChoiceCallback ccbnew RealmChoiceCallback(...)int[] selectedgetSelectedIndexes(...)SaslException se/** Parses the 'qop' directive. If 'auth-conf' is specified by ... */String qopOptionsString[] serverQopTokensbyte[] serverQopparseQop(...)byte serverAllQopcombineMasks(...)findPreferredMask(...)checkStrengthSupport(...)/** Processes the 'cipher' digest-challenge directive. This allows the ... */String cipherOptionsint tokenCountbyte[] serverCiphersString[] serverCipherStrsserverCiphers.lengthbyte[] clntCiphersgetPlatformCiphers(...)byte interfindCipherAndStrength(...)/** Steps through the ordered 'strength' array, and compares it with ... */byte sstrength.lengthsupportedCiphers.length/** Returns digest-response suitable for an initial authentication. ... */ByteArrayOutputStream digestRespquotedStringValue(...)writeQuotedStringValue(...)getNonceCount(...)generateNonce(...)generateResponseValue(...)/** From RFC 2831, Section 2.1.3: Step Three ... */byte[] expected/** Returns the number of requests (including current request) ... */// >= 0 times// atmost once; default is "auth"// exactly once// atmost once; default is 65536// atmost once; default is ISO 8859-1// exactly once if qop is "auth-conf"// exactly once in 2nd challenge// atmost once for in subsequent auth (not supported)// authzID can only be encoded in UTF8 - RFC 2222/* Extract and process digest-challenge *//* Process server's first challenge (from Step 1) *//* Get realm, qop, maxbuf, charset, algorithm, cipher, nonce ... *//* Process server's step 3 (server response to digest response) *//* Get rspauth directive *//* Initialize SecurityCtx implementation *//* client */// Mechanism has completed.// Set to invalid state// No other possible state/* CHARSET: optional atmost once *//* ALGORITHM: required exactly once *//* NONCE: required exactly once *//* REALM: optional, if multiple, stored in realmChoices */// Only one realm specified// Server specified <= 1 realm// If 0, RFC 2831: the client SHOULD solicit a realm from the user./* Acquire realm from RealmCallback */// Acquire realm from RealmChoiceCallback/* MAXBUF: optional atmost once *//* QOP: optional; if multiple, merged earlier */// process/* ignore unrecognized tokens */// buffer sizes not applicable/* CIPHER: required exactly once if qop=auth-conf */// First determine ciphers that server supports// Parse ciphers in challenge; mark each that server supports// keep for replay to server// Determine which ciphers are available on client// Take intersection of server and client supported ciphers// now have a clear picture of user / client; client / server// cipher options. Leverage strength array against what is// supported to choose a cipher.// If user explicitly requested cipher, then it// must be the one we choose// none found/* Server's rspauth value does not match *//** An implementation of the DIGEST-MD5 server SASL mechanism. ... */String UTF8_DIRECTIVE;String ALGORITHM_DIRECTIVE;int NONCE_COUNT_VALUE;/* Always expect nonce count value to be 1 because we support only ... */String UTF8_PROPERTY;/* "true" means use UTF8; "false" ISO 8859-1; default is "true" */String REALM_PROPERTY;/* List of space-separated realms used for authentication *//* Directives encountered in responses sent by the client. */int USERNAME;int CNONCE;int NONCE_COUNT;int DIGEST_URI;int RESPONSE;int AUTHZID;int AUTH_PARAM;String specifiedQops;/* Server-generated/supplied information */...[] myCiphers;List<String> serverRealms;String realmsresponse.lengthString supportedCiphersgenerateChallenge(...)byte[][] responseValvalidateClientResponse(...)/** Generates challenge to be sent to client. ... */ByteArrayOutputStream out/** Validates client's response. ... */int clntMaxBufSizebyte[] nonceFromClientbyte[] cnoncebyte cQopString digestUriFromResponsebyte[] responseFromClientbyte[] authzidBytesString authzidFromClientint foundCipheruriMatches(...)byte[] expectedResponsegenerateResponseAuth(...)int protoAndSlashString thisProtoAndSlashString incomingProtoAndSlash/** Server sends a message formatted as follows: ... */byte[] responseValueresponseValue.length// exactly once if sent by server// atmost once; default is 00000001// atmost once; (default?)// atmost once; default is ISO-8859-1// atmost once; default is none// >= 0 times (ignored)// By default, use server name as realm/* Generate first challenge */// myCipher[i] is a byte that indicates whether CIPHER_TOKENS[i]// is supported// Step 2 is performed by client/* Validates client's response and generate challenge: ... *//* not client */// Realms (>= 0)// Nonce - required (1)// QOP - optional (1) [default: auth]// qop="auth,auth-conf,auth-int"// Check for quotes in case of non-standard qop options// maxbuf - optional (1) [default: 65536]// charset - optional (1) [default: ISO 8859_1]// Check for quotes in case of custom ciphers// algorithm - required (1)// The client should send this directive only if the server has// indicated it supports UTF-8.// maxbuf: atmost once// Max send buf size is min of client's max recv buf size and// server's max send buf size/* username: exactly once *//* realm: exactly once if sent by server */// Server had sent at least one realm// Check that response is one of these// Else, client specified realm was one of server's or server had none/* nonce: exactly once *//* cnonce: exactly once *//* nonce-count: atmost once *//* qop: atmost once; default is "auth" */// Check that QOP is one sent by server// Check that cipher is one that we offered// Set negotiatedStrength// assume default low// atmost once// serv-type "/" host [ "/" serv-name ]// e.g.: smtp/mail3.example.com/example.com// e.g.: ftp/ftp.example.com// e.g.: ldap/ldapserver.example.com// host should match one of service's configured service names// Check against digest URI that mech was created with// account for case-sensitive diffs// response: exactly once// authzid: atmost once// Ignore auth-param// Get password need to generate verifying response// Realm and Name callbacks are used to provide info// PasswordCallback is used to collect info// Validate response value sent by client/* use own nonce */// Ensure that authzid mapping is OK// Clear password// Full match// Unbound match// Construct response value/** Client and server factory for DIGEST-MD5 SASL client/server mechanisms. ... */int DIGEST_MD5;/** Returns a new instance of the DIGEST-MD5 SASL client mechanism. ... */new DigestMD5Client(...)/** Returns a new instance of the DIGEST-MD5 SASL server mechanism. ... */new DigestMD5Server(...)/** Returns the authentication mechanisms that this factory can produce. ... *//** Interface used for classes implementing integrity checking and privacy ... *//** Wrap out-going message and return wrapped message ... *//** Unwrap incoming message and return original message ... *//** Client/server factory for GSSAPI (Kerberos V5) SASL client/server mechs. ... */int GSS_KERB_V5;new GssKrb5Client(...)new GssKrb5Server(...)new Oid(...)GSSException ignoreString KRB5_OID_STR;Oid KRB5_OID;GSSContext secCtx;int JGSS_QOP;// unrelated to SASL QOP maskMessageProp msgPropnew MessageProp(...)GSSException e// integrity will be true if either privacy or integrity negotiated// Generate GSS token/** Implements the GSSAPI SASL client mechanism for Kerberos V5. ... */// ---------------- Constants -----------------boolean finalHandshake;boolean mutual;...[] authzID;// default falseString serviceGSSManager mgrGSSName acceptorNamecreateName(...)GSSName.NT_HOSTBASED_SERVICEGSSCredential credentialsObject propSasl.CREDENTIALSGSSContext.INDEFINITE_LIFETIMErequestCredDeleg(...)Sasl.SERVER_AUTHrequestMutualAuth(...)requestConf(...)requestInteg(...)this.authzIDdoFinalHandshake(...)byte[] gssOutTokeninitSecContext(...)isEstablished(...)byte selectedQopbyte[] gssInTokengetWrapSizeLimit(...)authzID.lengthgssInToken.length// JAAS// JGSS// Create the name for the requested service entity for Krb5 mech// Parse properties to check for supplied credentials// Create a context using credentials for Krb5 mech/* mechanism *//* credentials */// Request credential delegation when credentials have been supplied// Parse properties  to set desired context options// Mutual authentication// Always specify potential need for integrity and confidentiality// Decision will be made during final handshake// Security context not established yet; continue with init// RFC 2222 7.2.1:  Client responds with no data// Security context already established. challengeData// should contain security layers and server's maximum buffer size// Received S0, should return []// Received S1 (security layer, server max recv size)// First octet is a bit-mask specifying the protections// supported by the server// Client selects preferred protection// qop is ordered list of qop values// 2nd-4th octets specifies maximum buffer size expected by// server (in network byte order)// Determine the max send buffer size based on what the// server is able to receive and our specified max// Update context to limit size of returned buffer// Construct negotiated security layers and client's max// receive buffer size and authzID// copy authorization id/* qop *//* privacy */// server authenticated/** Implements the GSSAPI SASL server mechanism for Kerberos V5. ... */int handshakeStage;String peer;String me;String protocolSaved;// will be null if serverName is not null.// check the protocol name after the context is established. This value// When serverName is null, the server will be unbound. We need to save and/** Creates a SASL mechanism with server credentials that it needs ... */GSSName serviceNameGSSCredential credcreateCredential(...)GSSCredential.INDEFINITE_LIFETIMEGSSCredential.ACCEPT_ONLY/** Processes the response data. ... */doHandshake1(...)doHandshake2(...)acceptSecContext(...)getSrcName(...)getTargName(...)gssOutToken.length// Create a context using the server's credentials// Might need integrity// Might need privacy// Security context not established yet; continue with accept// me might take the form of proto@host or proto/host// Security context already established. responseData// should contain no data// Construct 4 octets of data:// First octet contains bitmask specifying protections supported// 2nd-4th octets contains max receive buffer of server// progress to next stage/* gop */// Expecting 4 octets from client selected protection// and client's receive buffer size// First octet is a bit-mask specifying the selected protection// client (in network byte order). This is the server's send// buffer maximum.// client is able to receive and our specified max// Get authorization identity, if any// In Kerberos, realm is embedded in peer name// Authorization failed/** Client and server factory for NTLM SASL client/server mechanisms. ... *//** Returns a new instance of the NTLM SASL client mechanism. ... */new NTLMClient(...)/** Returns a new instance of the NTLM SASL server mechanism. ... */new NTLMServer(...)import Clientimport NTLMExceptionimport UnknownHostException/** Required callbacks: ... */String NTLM_VERSION;String NTLM_RANDOM;String NTLM_DOMAIN;String NTLM_HOSTNAME;Client client;String mech;// 0-start,1-nego,2-auth,3-doneRandom rtmpRealmCallback dcbthis.mechgetCanonicalHostName(...)getLocalHost(...)new Client(...)NTLMException netype1(...)type3(...)NTLMException eximport ServerServer server;String authzId;type2(...)String[] out/** The base class used by client and server implementations of SASL ... */boolean privacy;boolean integrity;...[] qop;byte allQop;// ordered list of qops...[] strength;// a mask indicating which QOPs are requestedint sendMaxBufSize;// These are relevant only when privacy or integray have been negotiated// ordered list of cipher strengths// specified by peer but can override// optionally specified by selfString myClassName;// derived from sendMaxBufSizeqop.lengthStringBuffer qopbufparseStrength(...)byte answerparseProp(...)vals.length/** Outputs a byte array. Can be null. */int origlenLevel levString content// ---------------- Constants  -----------------String MAX_SEND_BUF;byte NO_PROTECTION;// default 0 (no protection); 1 (integrity only)byte INTEGRITY_ONLY_PROTECTION;byte PRIVACY_PROTECTION;byte LOW_STRENGTH;byte MEDIUM_STRENGTH;byte HIGH_STRENGTH;...[] DEFAULT_QOP;...[] QOP_TOKENS;...[] QOP_MASKS;...[] DEFAULT_STRENGTH;...[] STRENGTH_TOKENS;...[] STRENGTH_MASKS;// "auth", "auth-int", "auth-conf"// "low", "medium", "high"// Max receive buffer size// Max send buffer size// save what was parsed// Initialize rest of array with 0// Message id supplied by caller as part of traceTag/** Static class that contains utilities for dealing with Java SASL ... */// Can't create one of theseint NOPLAINTEXT;int NOACTIVE;int NODICTIONARY;int FORWARD_SECRECY;int NOANONYMOUS;int PASS_CREDENTIALS;/** Determines whether a mechanism's characteristics, as defined in flags, ... */Sasl.POLICY_NOPLAINTEXTSasl.POLICY_NOACTIVESasl.POLICY_NODICTIONARYSasl.POLICY_NOANONYMOUSSasl.POLICY_FORWARD_SECRECYSasl.POLICY_PASS_CREDENTIALS/** Given a list of mechanisms and their characteristics, select the ... */boolean[] passed/** The exception thrown when an agent fails to initialize in the target ... *//** use serialVersionUID for interoperability */int returnValue;/** Constructs an <code>AgentInitializationException</code> with ... */this.returnValue/** If the exception was created with the return value from the agent ... *//** The exception thrown when an agent cannot be loaded into the target ... *//** Constructs an <code>AgentLoadException</code> with ... */import AttachProvider/** Thrown by {@link com.sun.tools.attach.VirtualMachine#attach ... *//** Constructs an <code>AttachNotSupportedException</code> with ... *//** Exception type to signal that an attach operation failed in the target VM. ... *//** Constructs an <code>AttachOperationFailedException</code> with ... *//** When a {@link java.lang.SecurityManager SecurityManager} set, this ... *//** Constructs a new AttachPermission object. ... *//** A Java virtual machine. ... */AttachProvider provider;// 0 => not computed/** Return a list of Java virtual machines. ... */ArrayList<VirtualMachineDescriptor> lnew ArrayList<VirtualMachineDescriptor>(...)List<AttachProvider> providersAttachProvider providerlistVirtualMachines(...)/** Attaches to a Java virtual machine. ... */AttachNotSupportedException lastExcnew AttachNotSupportedException(...)attachVirtualMachine(...)AttachNotSupportedException x/** Detach from the virtual machine. ... *//** Returns the provider that created this virtual machine. ... *//** Returns the identifier for this Java virtual machine. ... *//** Loads an agent library. ... */loadAgentLibrary(...)/** Load a native agent library by full pathname. ... */loadAgentPath(...)/** Loads an agent. ... */loadAgent(...)/** Returns the current system properties in the target virtual machine. ... *//** Returns the current <i>agent properties</i> in the target virtual ... *//** Starts the JMX management agent in the target virtual machine. ... *//** Starts the local JMX management agent in the target virtual machine. ... *//** Returns a hash-code value for this VirtualMachine. The hash ... *//** Tests this VirtualMachine for equality with another object. ... */VirtualMachine otherid(...)/** Returns the string representation of the <code>VirtualMachine</code>. *//** Describes a Java virtual machine. ... */String displayName;/** Creates a virtual machine descriptor from the given components. ... */this.displayName/** Return the <code>AttachProvider</code> that this descriptor references. ... *//** Return the identifier component of this descriptor. ... *//** Return the <i>display name</i> component of this descriptor. ... *//** Returns a hash-code value for this VirtualMachineDescriptor. The hash ... *//** Tests this VirtualMachineDescriptor for equality with another object. ... */VirtualMachineDescriptor other/** Returns the string representation of the <code>VirtualMachineDescriptor</code>. *//** Provides the API to attach to a Java<sup><font size=-2>TM</font></sup> ... */import VirtualMachineDescriptorimport AttachPermissionimport AttachNotSupportedException/** Attach provider class for attaching to a Java virtual machine. ... */List<AttachProvider> providers;/** Initializes a new instance of this class.  </p> ... */new AttachPermission(...)/** Return this provider's name. </p> ... *//** Return this provider's type. </p> ... *//** Lists the Java virtual machines known to this provider. ... *//** Returns a list of the installed attach providers. ... */ServiceLoader<AttachProvider> providerLoaderIterator<AttachProvider> inew ArrayList<AttachProvider>(...)ThreadDeath td// Ignore errors and exceptions/** Only developers who are defining new attach providers should need to make ... *//** An implementation of interface CharStream, where the stream is assumed to ... */boolean staticFlag;int bufpos;int available;int tokenBegin;...[] bufline;...[] bufcolumn;int line;InputStream inputStream;boolean prevCharIsCR;boolean prevCharIsLF;...[] nextCharBuf;int maxNextCharInd;int nextCharInd;int inBuf;char[] newbufferint[] newbuflineint[] newbufcolumnbackup(...)FillBuff(...)readChar(...)ExpandBuff(...)AdjustBuffSize(...)ReadByte(...)UpdateLineColumn(...)hexval(...)/** @deprecated ... */ReInit(...)char[] ret/** Method to adjust line and column numbers for the start of a token.<BR> */int nextColDiffint columnDiff/* This source code is provided to illustrate the usage of a given feature ... *//* Generated By:JavaCC: Do not edit this line. ASCII_UCodeESC_CharStream.java Version 0.7pre6 */// Should never come here// Read all the backslashes// found a non-backslash char.// Here, we have seen an odd number of backslash's followed by a 'u'new Stack<LValue>(...)new JJExpressionParserCalls[]new Vector<int[]>(...)Stack<LValue> stack;VirtualMachine vm;GetFrame frameGetter;GetFrame lastFrameGetter;LValue lastLValue;getMassagedValue(...)ExpressionParser parsernew ExpressionParser(...)parser.vmparser.frameGetterExpression(...)FileNotFoundException eParseException e/* Type, name and expression syntax follows. *//** *************************************** ... */jj_ntk(...)PrimitiveType(...)Name(...)jj_consume_token(...)new ParseException(...)jj_2_1(...)/* Expression syntax follows. */jj_2_2(...)Assignment(...)ConditionalExpression(...)LValue exprValPrimaryExpression(...)AssignmentOperator(...)ConditionalOrExpression(...)LValue falseBranchLValue trueBranchValue condinteriorGetValue(...)ConditionalAndExpression(...)InclusiveOrExpression(...)ExclusiveOrExpression(...)AndExpression(...)EqualityExpression(...)Token tokInstanceOfExpression(...)LValue leftbooleanOperation(...)RelationalExpression(...)Type(...)ShiftExpression(...)AdditiveExpression(...)MultiplicativeExpression(...)operation(...)UnaryExpression(...)PreIncrementExpression(...)PreDecrementExpression(...)UnaryExpressionNotPlusMinus(...)jj_2_3(...)CastExpression(...)PostfixExpression(...)// this.// about// below are not used, but they are there just to indicate that we know// specifications// This production is to determine lookahead only. The LOOKAHEADjj_2_4(...)jj_2_5(...)Literal(...)jj_2_6(...)PrimaryPrefix(...)PrimarySuffix(...)makeName(...)makeThisObject(...)AllocationExpression(...)List<Value> argListLValue indexarrayElementLValue(...)memberLValue(...)token.imageArguments(...)invokeWith(...)makeInteger(...)makeFloat(...)makeCharacter(...)makeString(...)BooleanLiteral(...)makeBoolean(...)NullLiteral(...)makeNull(...)new ArrayList<Value>(...)ArgumentList(...)jj_2_7(...)ArrayDimensions(...)makeNewObject(...)/* The second LOOKAHEAD specification below is to parse to PrimarySuffix if ... */jj_2_8(...)jj_2_9(...)jj_3_1(...)jj_save(...)jj_3_2(...)jj_3_3(...)jj_3_4(...)jj_3_5(...)jj_3_6(...)jj_3_7(...)jj_3_8(...)jj_3_9(...)jj_scan_token(...)Token xspjj_3R_154(...)jj_3R_155(...)jj_3R_150(...)jj_3R_23(...)jj_3R_152(...)jj_3R_115(...)jj_3R_50(...)jj_3R_51(...)jj_3R_67(...)jj_3R_24(...)jj_3R_20(...)jj_3R_151(...)jj_3R_59(...)jj_3R_60(...)jj_3R_61(...)jj_3R_62(...)jj_3R_63(...)jj_3R_64(...)jj_3R_65(...)jj_3R_66(...)jj_3R_40(...)jj_3R_41(...)jj_3R_22(...)jj_3R_149(...)jj_3R_148(...)jj_3R_146(...)jj_3R_147(...)jj_3R_140(...)jj_3R_141(...)jj_3R_142(...)jj_3R_42(...)jj_3R_43(...)jj_3R_44(...)jj_3R_45(...)jj_3R_46(...)jj_3R_47(...)jj_3R_48(...)jj_3R_49(...)jj_3R_121(...)jj_3R_122(...)jj_3R_123(...)jj_3R_136(...)jj_3R_135(...)jj_3R_134(...)jj_3R_132(...)jj_3R_133(...)jj_3R_124(...)jj_3R_125(...)jj_3R_126(...)jj_3R_127(...)jj_3R_143(...)jj_3R_144(...)jj_3R_145(...)jj_3R_137(...)jj_3R_86(...)jj_3R_138(...)jj_3R_139(...)jj_3R_112(...)jj_3R_82(...)jj_3R_129(...)jj_3R_130(...)jj_3R_131(...)jj_3R_108(...)jj_3R_128(...)jj_3R_25(...)jj_3R_116(...)jj_3R_117(...)jj_3R_118(...)jj_3R_119(...)jj_3R_120(...)jj_3R_106(...)jj_3R_114(...)jj_3R_113(...)jj_3R_87(...)jj_3R_88(...)jj_3R_81(...)jj_3R_104(...)jj_3R_109(...)jj_3R_110(...)jj_3R_111(...)jj_3R_102(...)jj_3R_97(...)jj_3R_94(...)jj_3R_89(...)jj_3R_100(...)jj_3R_107(...)jj_3R_98(...)jj_3R_105(...)jj_3R_91(...)jj_3R_92(...)jj_3R_95(...)jj_3R_103(...)jj_3R_85(...)jj_3R_69(...)jj_3R_84(...)jj_3R_90(...)jj_3R_101(...)jj_3R_75(...)jj_3R_76(...)jj_3R_77(...)jj_3R_78(...)jj_3R_79(...)jj_3R_80(...)jj_3R_83(...)jj_3R_99(...)jj_3R_96(...)jj_3R_71(...)jj_3R_72(...)jj_3R_73(...)jj_3R_68(...)jj_3R_70(...)jj_3R_58(...)jj_3R_74(...)jj_3R_93(...)jj_3R_52(...)jj_3R_53(...)jj_3R_54(...)jj_3R_55(...)jj_3R_56(...)jj_3R_57(...)jj_3R_28(...)jj_3R_29(...)jj_3R_30(...)jj_3R_31(...)jj_3R_32(...)jj_3R_33(...)jj_3R_34(...)jj_3R_35(...)jj_3R_36(...)jj_3R_37(...)jj_3R_38(...)jj_3R_39(...)jj_3R_21(...)jj_3R_26(...)jj_3R_27(...)jj_3R_153(...)ExpressionParserTokenManager token_source;ASCII_UCodeESC_CharStream jj_input_stream;Token token, ...;int jj_ntk;Token jj_scanpos, ...;int jj_la;boolean lookingAhead;int jj_gen;...[] jj_la1;...[] jj_la1_0;...[] jj_la1_1;...[] jj_la1_2;...[] jj_la1_3;...[] jj_2_rtns;boolean jj_rescan;int jj_gc;new ASCII_UCodeESC_CharStream(...)new ExpressionParserTokenManager(...)new Token(...)jj_2_rtns.lengthnew JJExpressionParserCalls(...)Token oldToken(...).nexttoken.nextgetNextToken(...)token.kindJJExpressionParserCalls jj_2_rtnJJExpressionParserCalls cc.genc.firstc.nextgenerateParseException(...)jj_scanpos.nexttok.nextjj_add_error_token(...)jj_scanpos.kindToken tt.next(...).kindjj_nt.kindVector<int[]> jj_expentries;...[] jj_expentry;int jj_kind;...[] jj_lasttokens;int jj_endpos;boolean existsEnumeration<int[]> enum_int[] oldentryoldentry.lengthjj_expentry.lengthboolean[] la1tokensint[][] exptokseqjj_rescan_token(...)JJExpressionParserCalls pp.genp.argp.firstp.nextint gen;Token first;int arg;JJExpressionParserCalls next;/* Generated By:JavaCC: Do not edit this line. ExpressionParser.java */// TODO StringBufferInputStream is deprecated.int EOF;int SINGLE_LINE_COMMENT;int FORMAL_COMMENT;int MULTI_LINE_COMMENT;int ABSTRACT;int BREAK;int CASE;int CATCH;int CONST;int CONTINUE;int _DEFAULT;int DO;int ELSE;int EXTENDS;int FALSE;int FINAL;int FINALLY;int FOR;int GOTO;int IF;int IMPLEMENTS;int IMPORT;int INSTANCEOF;int NATIVE;int NEW;int NULL;int PACKAGE;int PRIVATE;int PROTECTED;int PUBLIC;int RETURN;int STATIC;int SUPER;int SWITCH;int SYNCHRONIZED;int THIS;int THROW;int THROWS;int TRANSIENT;int TRUE;int TRY;int VOLATILE;int WHILE;int INTEGER_LITERAL;int DECIMAL_LITERAL;int HEX_LITERAL;int OCTAL_LITERAL;int FLOATING_POINT_LITERAL;int EXPONENT;int CHARACTER_LITERAL;int STRING_LITERAL;int IDENTIFIER;int LETTER;int DIGIT;int LPAREN;int RPAREN;int LBRACE;int RBRACE;int LBRACKET;int RBRACKET;int SEMICOLON;int COMMA;int DOT;int ASSIGN;int GT;int LT;int BANG;int TILDE;int HOOK;int COLON;int EQ;int LE;int GE;int NE;int SC_OR;int SC_AND;int INCR;int DECR;int PLUS;int MINUS;int STAR;int SLASH;int BIT_AND;int BIT_OR;int XOR;int REM;int LSHIFT;int RSIGNEDSHIFT;int RUNSIGNEDSHIFT;int PLUSASSIGN;int MINUSASSIGN;int STARASSIGN;int SLASHASSIGN;int ANDASSIGN;int ORASSIGN;int XORASSIGN;int REMASSIGN;int LSHIFTASSIGN;int RSIGNEDSHIFTASSIGN;int RUNSIGNEDSHIFTASSIGN;int DEFAULT;...[] tokenImage;/* Generated By:JavaCC: Do not edit this line. ExpressionParserConstants.java */jjMoveNfa_0(...)jjStopStringLiteralDfa_0(...)jjMoveStringLiteralDfa1_0(...)jjStopAtPos(...)jjStartNfaWithStates_0(...)jjMoveStringLiteralDfa2_0(...)jjStartNfa_0(...)jjMoveStringLiteralDfa3_0(...)jjMoveStringLiteralDfa4_0(...)jjMoveStringLiteralDfa5_0(...)jjMoveStringLiteralDfa6_0(...)jjMoveStringLiteralDfa7_0(...)jjMoveStringLiteralDfa8_0(...)jjMoveStringLiteralDfa9_0(...)jjMoveStringLiteralDfa10_0(...)jjMoveStringLiteralDfa11_0(...)jjCheckNAdd(...)...[] jjbitVec0;...[] jjbitVec2;...[] jjbitVec3;...[] jjbitVec4;...[] jjbitVec5;...[] jjbitVec6;...[] jjbitVec7;...[] jjbitVec8;int startsAtReInitRounds(...)jjCheckNAddStates(...)jjAddStates(...)jjCheckNAddTwoStates(...)int hiBytelong l1long l2jjCanMove_1(...)jjCanMove_0(...)...[] jjnextStates;...[] jjstrLiteralImages;...[] lexStateNames;...[] jjtoToken;...[] jjtoSkip;...[] jjtoSpecial;ASCII_UCodeESC_CharStream input_stream;...[] jjrounds;...[] jjstateSet;char curChar;ASCII_UCodeESC_CharStream.staticFlagSwitchTo(...)new TokenMgrError(...)TokenMgrError.INVALID_LEXICAL_STATEnewToken(...)String imt.kindt.imageGetImage(...)t.beginLinegetBeginLine(...)t.beginColumngetBeginColumn(...)t.endLinegetEndLine(...)t.endColumngetEndColumn(...)int curLexState;int defaultLexState;int jjnewStateCnt;int jjround;int jjmatchedPos;int jjmatchedKind;Token specialTokenToken matchedTokenint curPosint error_lineint error_columnString error_afterboolean EOFSeenBeginToken(...)jjFillToken(...)matchedToken.specialTokenjjMoveStringLiteralDfa0_0(...)specialToken.nextTokenMgrError.LEXICAL_ERROR/* Generated By:JavaCC: Do not edit this line. ExpressionParserTokenManager.java *///MatchLoopValue jdiValue;// value in the debuggee.// next to the actual calls to JDI methods to get/set the// jdiValue is set/tested at the lowest level - right// get/set values in this file.  To minimize confusion,// Unfortunately, there are several levels of calls to// a 2nd time.// represents a member function.  We would end up calling it// for the LValue.  This is especially wrong when the LValue// point, we don't want to call JDI a 2nd time to get the Value// call getMassagedValue to get this toString value.  At that// the 'toString' value for the LValue in which case it will// to the ExpressionParser, it might decide that it needs// we have to remember it since after we return the LValue object// The JDI Value object for this LValue.  Once we have this Value,setValue0(...)InvalidTypeException excClassNotLoadedException excclassName(...)ExpressionParser.GetFramethread(...)IncompatibleThreadStateException excValue valnew LValueArrayLength(...)new LValueInstanceMember(...)// to a String.  IE, if it is an Object, call toString in the debuggee.// Return the Value for this LValue that would be used to concatenateValue vvStackFrame frameThreadReference threadLValue toStringMemberValue valueInvocationException eexception(...)IncompatibleThreadStateException itseInvalidTypeException iteClassNotLoadedException tnleValue indexValuenew LValueArrayElement(...)int INSTANCE;fieldByName(...)boolean isStaticList<Method> listmethodsByName(...)Iterator<Method> iterList<String> primitiveTypeNames;int SAME;int ASSIGNABLE;int DIFFERENT;/* Return SAME, DIFFERENT or ASSIGNABLE. ... */Iterator<Type> typeIterIterator<Value> valIterType argTypetype(...)isAssignableTo(...)// implementations of ClassType, ArrayType, and InterfaceType// These is...AssignableTo methods are based on similar code in the JDIType toComponentTypecomponentType(...)isComponentAssignable(...)ClassNotLoadedException eList<InterfaceType> interfacesisArrayAssignableTo(...)ClassType superclazzsuperclass(...)interfaces(...)superinterfaces(...)InterfaceType interfazeMethod retValint assignableCountMethod mmList<Type> argTypesint compareargumentsMatch(...)argumentTypes(...)ClassNotLoadedException eeStackFrame frame;LocalVariable var;this.varObjectReference obj;ThreadReference thread;Field matchingField;List<Method> overloads;Method matchingMethod;List<Value> methodArguments;ReferenceType refTypereferenceType(...)this.objLValue.INSTANCEinvokeMethod(...)resolveOverload(...)ReferenceType refType;LValue.STATICClassType clazzInterfaceType ifacenew InvalidTypeException(...)ArrayReference arrayRef;/* Since one can code "int myLen = myArray.length;", ... */this.arrayRefmirrorOf(...)virtualMachine(...)ArrayReference array;this.arrayValue value;new LValueConstant(...)ObjectReference thisObjectthisObject(...)List<ReferenceType> classesclassesByName(...)ClassType classTypemethods(...)Method constructorObjectReference newObjectisConstructor(...)InvocationException ienFields(...)StringTokenizer izerString firstLocalVariable varvisibleVariableByName(...)AbsentInformationException enew LValueLocal(...)LValue thisLValueLValue fvParseException excLValue lvalnew LValueStaticMember(...)String opValue rightValue leftdouble rrdouble llPrimitiveValue primRightPrimitiveValue primLeftdouble resfloat rrfloat llfloat reslong rrlong lllong resint rr// If vv is an ObjectReference, then we have to// do the implicit call to toString()./* TO DO: Note that this currently fails to find superclass ... *//** * ... */// If any pair aren't the same, change the// result to ASSIGNABLE.  If any pair aren't// assignable, return DIFFERENT// Null values can be passed to any non-primitive argument// Else, we will assume that a null value// exactly matches an object type.// Assignment of primitive arrays requires identical// component types.// Assignment of object arrays requires availability// of widening conversion of component types// One or both component types has not yet been// loaded => can't assign// Only valid InterfaceType assignee is Cloneable// Only valid ClassType assignee is Object// If one is boolean, so must be the other.// Other primitive types are intermixable only with each other.// neither one is primitive.// fromType must be an InterfaceType// If there is only one method to call, we'll just choose// that without looking at the args.  If they aren't right// the invoke will return a better error message than we// could generate here.// Resolving overloads is beyond the scope of this exercise.// So, we will look for a method that matches exactly the// types of the arguments.  If we can't find one, then// if there is exactly one method whose param types are assignable// from the arg types, we will use that.  Otherwise,// it is an error.  We won't guess which of multiple possible// methods to call. And, since casts aren't implemented,// the user can't use them to pick a particular overload to call.// IE, the user is out of luck in this case.// This probably won't happen for the// method that we are really supposed to// call.// Else, it is assignable.  Remember it.// At this point, we didn't find an exact match,// but we found one for which the args are assignable./* Can't tell yet whether this LValue will be accessed as a ... */// writable/* TO DO: Better error handling */// check local variables// check if it is a field of 'this'// check for class name// is this correct in all cases?// can compare any numeric doubles// If one is an ObjectRef, we will need to invoke// toString on it, so we need the thread.// from here on, we know it is a integer kind of type/** This exception is thrown when parse errors are encountered. ... *//** This constructor is used by the method "generateParseException" ... *//** The following constructors are for use by you for whatever ... */boolean specialConstructor;/** This variable determines which constructor was used to create ... */Token currentToken;/** This is the last token that has been consumed successfully.  If ... */...[] expectedTokenSequences;/** Each entry in this array is an array of integers.  Each array ... *//** This is a reference to the "tokenImage" array of the generated ... *//** This method has the standard behavior when this object has been ... */String expectedint maxSizecurrentToken.nextint[] expectedTokenSequenceexpectedTokenSequence.lengthtok.kindadd_escapes(...)tok.imagecurrentToken.next.beginColumncurrentToken.next.beginLineexpectedTokenSequences.lengthString eol;/** The end of line string for this machine. *//** Used to convert raw characters to their escaped version ... */StringBuffer retval/* Generated By:JavaCC: Do not edit this line. ParseException.java Version 0.7pre6 *//** Describes the input token stream. */int kind;/** An integer that describes the kind of this token.  This numbering ... */int beginLine, ...;/** beginLine and beginColumn describe the position of the first character ... */String image;/** The string image of the token. */Token next;/** A reference to the next regular (non-special) token from the input ... */Token specialToken;/** This field is used to access special tokens that occur prior to this ... *//** Returns the image. *//** Returns a new Token object, by default. However, if you want, you ... *//* Generated By:JavaCC: Do not edit this line. Token.java Version 0.7pre3 *//* Ordinals for various reasons why an Error of this type can be thrown. */int LEXICAL_ERROR;/** Lexical error occurred. */int STATIC_LEXER_ERROR;/** An attempt wass made to create a second instance of a static token manager. */int INVALID_LEXICAL_STATE;/** Tried to change to an invalid lexical state. */int LOOP_DETECTED;/** Detected (and bailed out of) an infinite loop in the token manager. *//** Indicates the reason why the exception is thrown. It will have ... *//** Replaces unprintable characters by their espaced (or unicode escaped) ... *//** Returns a detailed message for the Error when it is thrown by the ... */addEscapes(...)/** You can also modify the body of this method to customize your error messages. ... *//* Constructors of various flavors follow. */LexicalError(...)/* Generated By:JavaCC: Do not edit this line. TokenMgrError.java Version 0.7pre2 */import com.sun.jdi.request.*/** The 'refType' is known to match, return the EventRequest. */EventRequestManager emeventRequestManager(...)EventRequest wpcreateAccessWatchpointRequest(...)setSuspendPolicy(...)enable(...)String methodId;List<String> methodArgs;this.methodIdthis.methodArgsthis.lineNumberisValidMethodName(...)new MalformedMemberNameException(...)Location locationEventRequest bpcreateBreakpointRequest(...)BreakpointSpec breakpointbreakpoint.methodIdbreakpoint.methodArgsbreakpoint.refSpecbreakpoint.lineNumberlineNumber(...)errorMessageFor(...)StringBuffer bufferisMethodBreakpoint(...)findMatchingMethod(...)List<Location> locslocationsOfLine(...)new LineNotFoundException(...)method(...)isJavaIdentifier(...)/* Compare a method's argument types with a Vector of type names. ... */List<String> argTypeNamesargumentTypeNames(...)int nTypesString comp1String comp2int comp1Length/* Remove unneeded spaces and expand class names to fully ... */StringBuffer typePartStringBuffer arrayPartint nameLengthboolean isVarArgsReferenceType argClassgetReferenceTypeFromToken(...)/* Attempt an unambiguous match of the method name and ... */Method firstMatchMethod exactMatchint matchCountmethodArgs(...)normalizeArgTypeName(...)Method candidatecompareArgTypes(...)new AmbiguousMethodException(...)/* TO DO: list the methods here */// let AbsentInformationException be thrown// TO DO: handle multiple locations// If argument counts differ, we can stop here// Compare each argument type's name/* We have to handle varargs.  EG, the ... *//* The last types differ, it is a varargs ... */// The type names are different lengths// We know the two type names are the same length// We do have xxx[] and xxx... as the last param type/* Separate the type name from any array modifiers, ... *//* For varargs, there can be spaces before the ... but not ... */// name is complete/* When there's no sign of a package name already, try to expand the ... */// We'll try the name as is// Normalize the argument string once before looping below.// Check each method in the class for matches// first method with matching name// (only) method with same name & sig// > 1 implies overload// Remember the first match in case it is the only one// If argument types were specified, check against candidate// Determine method for breakpoint// Name and signature match// At least one name matched and no arg types were specified// Only one match; safe to use itimport Connectorimport ExpressionParserimport ParseExceptionThreadInfo threadInfogetCurrentThreadInfo(...)int stackFramegetCurrentFrameIndex(...)UnsupportedOperationException uoesetCurrentThreadInfo(...)setCurrentFrameIndex(...)IncompatibleThreadStateException eprintPrompt(...)Value resultGetFrame frameGettergetCurrentFrame(...)vm(...)String exMessageprintException(...)MissingResourceException mexprintDirectln(...)String valStrgetThreadInfo(...)List<String> argsint lastParamString lastStrCollection<Connector> ccsallConnectors(...)Connector ccString transportNametransport(...)description(...)Argument aadefaultArguments(...)boolean requiredArgumentmustSpecify(...)StringBuffer classListallClasses(...)String idClassboolean showAllReferenceType typeClassType superclassallInterfaces(...)ClassType subsubclasses(...)ReferenceType nestnestedTypes(...)InterfaceType superinterfaceInterfaceType subsubinterfaces(...)ClassType implementorimplementors(...)ArrayType arrayReferenceType clsStringBuffer methodsListallMethods(...)declaringType(...)typedName(...)allFields(...)List<Field> visiblevisibleFields(...)StringBuffer fieldsListThreadIterator threadIternew ThreadIterator(...)int maxIdLengthint maxNameLengthThreadReference thrStringBuffer idBufferStringBuffer nameBufferString statusFormatthreadGroup(...)status(...)ThreadReference.THREAD_STATUS_UNKNOWNisAtBreakpoint(...)ThreadReference.THREAD_STATUS_ZOMBIEThreadReference.THREAD_STATUS_RUNNINGThreadReference.THREAD_STATUS_SLEEPINGThreadReference.THREAD_STATUS_MONITORThreadReference.THREAD_STATUS_WAITThreadGroupReference tgprintThreadGroup(...)group(...)ThreadGroupIterator itnew ThreadGroupIterator(...)nextThreadGroup(...)doGetThread(...)setThreadGroup(...)VMConnection connectionconnection(...)String argsisLaunch(...)commandCont(...)boolean argsSetsetConnectorArg(...)connectorArg(...)List<ThreadReference> listnew ArrayList<ThreadReference>(...)threads(...)ThreadGroupReference childthreadGroups(...)allThreads(...)suspend(...)getThread(...)invalidateAll(...)resume(...)EventRequestManager mgrStepRequest requeststepRequests(...)deleteEventRequest(...)/* step */EventRequestManager reqMgrcreateStepRequest(...)StepRequest.STEP_LINEStepRequest.STEP_OUTStepRequest.STEP_INTOclearPreviousStep(...)addExcludes(...)addCountFilter(...)/* stepi ... */StepRequest.STEP_MINStepRequest.STEP_OVERString exprInvalidTypeException edoKill(...)doKillThread(...)boolean noExceptionsEventRequestSpec speceventRequestSpecs(...)Env.specListString notificationboolean notifyCaughtboolean notifyUncaughtString classPatterncreateExceptionCatch(...)listCaughtExceptions(...)parseExceptionSpec(...)resolveNow(...)int nLevelsString idTokenNumberFormat nfgetNumberInstance(...)setParseIntegerOnly(...)ParseException jtpeup(...)down(...)List<StackFrame> stackgetStack(...)int nFramesdumpFrame(...)Location loclong pcMethod methlong lineNumberString methodInfocodeIndex(...)isNative(...)sourceName(...)/* The next two methods are used by this class and by EventHandler ... */boolean noBreakpointsNoSuchElementException eString classIdString lineTokenint lineNumberprintBreakpointCommandUsage(...)createBreakpoint(...)int idotList<String> argumentListMalformedMemberNameException excaddEagerlyResolve(...)isResolved(...)String atInbyte suspendPolicyEventRequest.SUSPEND_ALLBreakpointSpec specparseBreakpointSpec(...)EventRequest.SUSPEND_NONEEventRequest.SUSPEND_EVENT_THREADlistBreakpoints(...)spec.suspendPolicyList<WatchpointSpec> listnew ArrayList<WatchpointSpec>(...)boolean accessboolean modificationint suspendPolicyString fieldNameWatchpointSpec speccreateAccessWatchpoint(...)createModificationWatchpoint(...)parseWatchpointSpec(...)EventRequestManager ermMethodExitRequest exitcreateMethodExitRequest(...)addThreadFilter(...)String methodTraceCommand;String modifString goStrString traceCmdString modif1IncompatibleThreadStateException eesetAtExitMethod(...)atExitMethod(...)commandUntrace(...)turnOnExitTrace(...)MethodEntryRequest entrycreateMethodEntryRequest(...)deleteEventRequests(...)methodEntryRequests(...)methodExitRequests(...)String sourceFileNameint linenoint startLineint endLineList<Method> methssourceLine(...)String sourceLineFileNotFoundException excIOException excString idMethodList<Location> linesallLineLocations(...)Location linePathSearchingVirtualMachine vmbaseDirectory(...)classPath(...)bootClassPath(...)/* Get or set the source file path list. */getSourcePath(...)setSourcePath(...)/* Print a stack variable *//* Print all local variables in current stack frame. */List<LocalVariable> varsvisibleVariables(...)Map<LocalVariable,Value> valuesnew AbsentInformationException(...)printVar(...)AbsentInformationException aiefields(...)StringBuffer oClassType supInterfaceType supIterator<Value> itprintDirect(...)/* Print a specified reference. */ObjectReference objString strValdoPrint(...)String allcommandPrint(...)ObjectReference objectThreadReference ownerowningThread(...)List<ThreadReference> waiterswaitingThreads(...)entryCount(...)ThreadReference waiterdoLock(...)List<ObjectReference> ownedownedMonitors(...)ObjectReference waitingcurrentContendedMonitor(...)ObjectReference monitorprintThreadLockInfo(...)disableCollection(...)doDisableGC(...)enableCollection(...)doEnableGC(...)setSavedValue(...)Set<String> keysgetSaveKeys(...)getSavedValue(...)isCollected(...)doSave(...)ReferenceType rtbyte[] bytecodesStringBuffer linebytecodes(...)bytecodes.lengthexcludesString(...)setExcludes(...)File phylMap<ReferenceType,byte[]> mapnew HashMap<ReferenceType,byte[]>(...)Exception excredefineClasses(...)Throwable excpopFrames(...)commandStepi(...)String extensionsourceDebugExtension(...)majorInterfaceVersion(...)minorInterfaceVersion(...)VMNotConnectedException e/* Save current thread and stack frame. (BugId 4296031) *///(BugId 4453329)/* This was an asynchronous command.  Events may have been ... */// Special case: use printDirectln()// output param types except for the last// output the last param// lastParam is an array.  Replace the [] with ...//no current value and no default.// array type// Note any thread group changes/* Do a bit of filling with whitespace to get thread ID ... *//* Select the output format to use based on thread status ... *//* The 'run' command makes little sense in a ... *//* Set the main class and any arguments. Note that this will work ... *//* Launch the VM. *//* A previous step may not have completed on this thread; ... */// We want just the next step event and no others// Print a listing of the catch patterns currently in place/* Handle the same as "all" for backward ... */// Print set breakpoints// We can't use hasMoreTokens here because it will cause any leading// paren to be lost.// Try stripping method from class.method token./* No dot or dot in first char *//* dot in last char */// Trim the parens// Enforcement of "at" vs. "in". The distinction is really// unnecessary and we should consider not checking for this// (and making "at" and "in" optional)./* trace [go] methods [thread] ... */// this is undocumented as it doesn't work right.// Turn on method entry trace/* To keep things simple we want each 'trace' to cancel ... */// trace all by itself.// More trace lines can be added here.// untrace// untrace methods// See if token is a line number.// It isn't -- see if it's a method name.// Undocumented command: useful for testing/* Take the remainder of the command line, minus ... *//* else refType is an instanceof ArrayType */// Special case: use printDirect()/* Bare bones error checking. *//* The set command is really just syntactic sugar. Pass it on to the ... */// Undocumented command: useful for testing.// Overloading is not handled here.// TO DO: handle multiple classes foundimport StepRequestimport MethodEntryRequestimport MethodExitRequestnew EventRequestSpecList(...)new SourceMapper(...)new LinkedList<SourceCode>(...)new HashMap<String,Value>(...)EventRequestSpecList specList;VMConnection connection;SourceMapper sourceMapper;List<String> excludes;int SOURCE_CACHE_SIZE;List<SourceCode> sourceCache;HashMap<String,Value> savedValues;Method atExitMethod;new VMConnection(...)disposeVM(...)VMDisconnectedException elnprint(...)String patternexcludes(...)addClassExclusionFilter(...)List<String> list/** Return a Reader cooresponding to the source of this location. ... */sourceReader(...)Iterator<SourceCode> iterSourceCode codeSourceCode candidatefileName(...)BufferedReader readernew SourceCode(...)/** Return a description of an object. */ReferenceType clazzlong iduniqueID(...)toHex(...)/** Convert a long to a hexadecimal string. */char[] s1char[] s2long d/** Convert hexadecimal strings to longs. */new NumberFormatException(...)List<String> sourceLines;this.fileName// Shutting down after the VM has gone away. This is// not an error, and we just ignore it./* Store digits in reverse order. *//* Now reverse the array. */// This notation saves typing by letting the user omit leading// package names. The first// loaded class whose name matches this limited regular// expression is selected.// It's a class name// TO DO: handle multiples// list is 0-indexedimport com.sun.jdi.event.*EventNotifier notifier;boolean connected;String shutdownMessageKey;boolean stopOnVMStart;this.notifierthis.stopOnVMStartInterruptedException excEventQueue queueeventQueue(...)EventSet eventSetboolean resumeStoppedAppEventIterator iteventIterator(...)handleEvent(...)nextEvent(...)suspendPolicy(...)setCurrentThread(...)vmInterrupted(...)VMDisconnectedException discExchandleDisconnectedException(...)receivedEvent(...)exceptionEvent(...)breakpointEvent(...)fieldWatchEvent(...)stepEvent(...)methodEntryEvent(...)methodExitEvent(...)classPrepareEvent(...)classUnloadEvent(...)threadStartEvent(...)threadDeathEvent(...)vmStartEvent(...)handleExitEvent(...)boolean vmDied;vmDeathEvent(...)vmDisconnectEvent(...)EventIterator iterInternalError excEvent eventeventThread(...)VMStartEvent seBreakpointEvent beMethodEntryEvent meMethodExitEvent meWatchpointEvent fweStepEvent seClassPrepareEvent cleClassUnloadEvent cueExceptionEvent eeThreadDeathEvent teeremoveThread(...)ThreadStartEvent tseaddThread(...)// force run() loop termination// Do nothing. Any changes will be seen at top of loop./* A VMDisconnectedException has happened while dealing with ... *//* If any event in the set has a thread associated with it, ... */// Is there a better way?import ExceptionRequestimport ClassPrepareRequestimport ClassPrepareEventReferenceTypeSpec refSpec;int suspendPolicy;EventRequest resolved;ClassPrepareRequest prepareRequest;this.refSpecrequest(...)resolveEventRequest(...)disable(...)PatternReferenceTypeSpec prsisUnique(...)createPrepareRequest(...)resolved(...)ArrayList<ExceptionRequest> deleteListnew ArrayList<ExceptionRequest>(...)ExceptionRequest erexceptionRequests(...)isPrepared(...)resolveAgainstPreparedClasses(...)isJavaIdentifierStart(...)/* Class pattern event requests are never ... *//* This is a class pattern.  Track down and delete ... *//* Not resolved.  Schedule a prepare request so we ... */// Try to resolve in case the class is already loaded.// Do nothing. Another resolve will be attempted when the// VM is started.// A runtime exception that we were not expectingnew ArrayList<EventRequestSpec>(...)int statusResolved;int statusUnresolved;int statusError;List<EventRequestSpec> eventRequestSpecs;// all specs/** Resolve all deferred eventRequests waiting for 'refType'. ... */boolean failureEventRequest eventRequestresolveEagerly(...)ReferenceTypeSpec refSpecnew PatternReferenceTypeSpec(...)new BreakpointSpec(...)new ExceptionSpec(...)new AccessWatchpointSpec(...)new ModificationWatchpointSpec(...)int inx// We need to make a copy to avoid synchronization problemsimport ReferenceTypeboolean notifyCaught;boolean notifyUncaught;this.notifyCaughtthis.notifyUncaughtExceptionRequest excReqcreateExceptionRequest(...)notifyCaught(...)notifyUncaught(...)ExceptionSpec eses.refSpec//Reference: Effective Java[tm] (Bloch, 2001), Item 8/** Internationalization (i18n) convenience methods for jdb. ... */ResourceBundle textResources;/** The resource bundle containing localizable message content. ... */MessageFormat messageFormat;/** Our message formatter.  Allocated once, used many times *//** Fatal shutdown notification.  This is sent to System.err ... *//** "Format" a string by doing a simple key lookup. *//** Fetch and format a message with one string argument. ... *//** Fetch a string by key lookup and format in the arguments. */applyPattern(...)/** Print directly to System.out. ... *//** Print a newline. ... *//** Format and print a simple string. *//** Fetch, format and print a message with one string argument. ... *//** Fetch, format and print a message with an arbitrary ... *//** Print a newline, followed by the string. *//** Print an exception message with a stack trace. */createModificationWatchpointRequest(...)String classId;String stem;this.classIdcheckClassName(...)/** Is this spec unique or is it a class pattern? *//** Does the specified ReferenceType match this spec. */ClassPrepareRequest requestcreateClassPrepareRequest(...)addClassFilter(...)PatternReferenceTypeSpec specspec.classId// Do stricter checking of class name validity on deferred//  because if the name is invalid, it will// never match a future loaded class, and we'll be silent// about it.// Each dot-separated piece must be a valid identifier// and the first token can also be "*". (Note that// numeric class ids are not permitted. They must// match a loaded class.)import Locationimport AbsentInformationException...[] dirs;List<String> dirListString elementFile.pathSeparator/* Return the current sourcePath as a String. */StringBuffer sp/** Return a File cooresponding to the source of this location. ... */String refNameint iDotString pkgNameString fullFile path/** Return a BufferedReader cooresponding to the source ... */File sourceFilesourceFile(...)new FileReader(...)/* sourcepath can arrive from the debugee as a List. ... *///XXX remove .jar and .zip files; we want only directories on//the source path. (Bug ID 4186582)/* sourcepath can also arrive from the command line ... *///The source path is empty.EventHandler handler;List<String> monitorCommands;/** List of Strings to execute at each stop. */int monitorCount;String progname;/** The name of this tool. */field(...)object(...)valueCurrent(...)valueToBe(...)Location catchLocationcatchLocation(...)locationString(...)printLocationOfEvent(...)Method mmmMethod meMethodcanGetMethodReturnValues(...)returnValue(...)EventRequest eReqprintCurrentLocation(...)executeCommand(...)printBaseLocation(...)...[] commandList;/* Look up the command string in commandList. ... */commandList.lengthString midVal/* Return true if the command is OK when disconnected. *//* Return true if the command is OK when readonly. */boolean showPromptString subcomNumberFormatException excint commandNumberisCommand(...)isDisconnectCmd(...)canBeModified(...)isReadOnlyCmd(...)Commands evaluatornew Commands(...)commandSet(...)commandLocals(...)commandClasses(...)commandClass(...)commandConnectors(...)commandMethods(...)commandFields(...)commandThreads(...)commandThread(...)commandSuspend(...)commandResume(...)commandThreadGroups(...)commandThreadGroup(...)commandCatchException(...)commandIgnoreException(...)commandStep(...)commandNext(...)commandKill(...)commandInterrupt(...)commandTrace(...)commandWhere(...)commandUp(...)commandDown(...)commandLoad(...)commandRun(...)new EventHandler(...)commandMemory(...)commandGC(...)commandStop(...)commandClear(...)commandWatch(...)commandUnwatch(...)commandList(...)commandLines(...)commandClasspath(...)commandUse(...)monitorCommand(...)unmonitorCommand(...)commandLock(...)commandThreadlocks(...)commandDisableGC(...)commandEnableGC(...)commandSave(...)commandBytecodes(...)commandRedefine(...)commandPopFrames(...)commandExtension(...)commandExclude(...)readCommand(...)help(...)commandVersion(...)VMCannotBeModifiedException rovmVMNotConnectedException vmnse/* Maintain a list of commands to execute each time the VM is suspended. */String monTokint monNumString monStrStringTokenizer ctString cmdfnamereadCommandFile(...)/** Read and execute a command file.  Return true if the file was read ... */BufferedReader inFileString ln/** Try to read commands from dir/fname, unless ... */File dotInitFileString myCanonFileString lastLineString userHomeString canonPathString userDirreadStartupCommandFile(...)usage(...)Connector connectorString hostStringString portStringhasWhitespace(...)String cmdLineString javaArgsint traceFlagsVirtualMachine.TRACE_NONEboolean launchImmediatelyString connectSpecMessageOutput.textResourcesargv.lengthVirtualMachine.TRACE_ALLString flagStrusageError(...)String addresssupportsSharedMemory(...)String suboptionsaddressToSocketArgs(...)new TTY(...)// fetch output/* These can be very numerous, so be as efficient as possible. ... */// We are stopping; the name will be shown by the normal mechanism// We aren't stopping, show the name/* These can be very numerous, so be as efficient as possible. */// Either we are not tracing a specific method, or we are// and we are exitting that method.// We will be stopping here, so do a newline// We won't be stopping here, so show the method name// In case we want to have a one shot trace exit some day, this// code disables the request so we don't hit it again.// This is a one shot deal; we don't want to stop// here the next time.// We are tracing a specific method, and this isn't it.  Keep going.// get rid of monitor number// Output the current source line, if possible/* NOTE: this list must be kept sorted in ascending ASCII ... *///Reference: binarySearch() in java/util/Arrays.java//           Adapted for use with String[][0].// key found// key not found.// Normally, prompt for the next command after this one is done/* Anything starting with # is discarded as a no-op or 'comment'. *//* Next check for an integer repetition prefix.  If found, ... */// Bypass the printPrompt() below./* Check for an unknown command */// asynchronous command/* Fire up an event handler, if the connection was just ... */// Process initial commands./* Connection opened on startup. Start event handler ... *//* Read start up files.  This mimics the behavior ... */// Doesn't exist, try alternate spelling// Process interactive commands.// Quotes were stripped out for this argument, add 'em back.// Standard VM options passed on// -v[:...]// -verbose[:...]// -classpath handled below// NonStandard options passed on// Old-style options (These should remain in place as long as//  the standard VM accepts them)// -client must be the first one// -server must be the first one/* -attach is shorthand for one of the reference implementation's ... *//* -listen[any] is shorthand for one of the reference implementation's ... *//* -connect allows the user to pick the connector ... */// Everything from here is part of the command line/* Unless otherwise specified, set the default connect spec. *//* Here are examples of jdb command lines and how the options ... */// (Bug ID 4285874)// NOTE: The value strings in this file containing "{0}" are//       processed by the java.text.MessageFormat class.  Any//       single quotes appearing in these strings need to be//       doubled up.import ThreadGroupReference/** Descend the tree of thread groups. ... */new Stack<Iterator<ThreadGroupReference>>(...)Stack<Iterator<ThreadGroupReference>> stack;List<ThreadGroupReference> tglnew ArrayList<ThreadGroupReference>(...)topLevelThreadGroups(...)/** The invariant in this class is that the top iterator ... */top(...)ThreadGroupIterator tgiimport ThreadReferenceimport IncompatibleThreadStateExceptionimport StackFramenew ArrayList<ThreadInfo>(...)List<ThreadInfo> threads;// ThreadInfo.invalidateAll, unlike the other static fields below.// This is a list of all known ThreadInfo objects. It survivesboolean gotInitialThreads;ThreadInfo current;ThreadGroupReference group;int currentFrameIndex;fatalError(...)new ThreadInfo(...)ThreadInfo tiinitThreads(...)ThreadInfo.currentString currentThreadNameThreadInfo tinfo/** Get the current ThreadInfo object. ... *//** Get the thread from this ThreadInfo object. ... */ThreadInfo retInfoti.threadlong threadId/** Get the thread stack frames. ... */frames(...)/** Get the current stackframe. ... */frameCount(...)frame(...)/** Invalidate the current stackframe index. *//* Throw IncompatibleThreadStateException if not suspended */isSuspended(...)new IncompatibleThreadStateException(...)/** Get the current stackframe index. ... *//** Set the current stackframe to a specific frame. ... */assureSuspended(...)/** Change the current stackframe to be one or more frames higher ... *//** Change the current stackframe to be one or more frames lower ... */// Guard against duplicates. Duplicates can happen during// initialization when a particular thread might be added both// by a thread start event and by the initial call to threads()// Current thread has died.// Be careful getting the thread name. If its death happens// as part of VM termination, it may be too late to get the// information, and an exception will be thrown.// Make a copy to allow iteration without synchronization// Current thread group defaults to the first top level// thread group.Iterator<ThreadReference> it;ThreadGroupIterator tgi;// no moreimport ThreadStartRequestimport ThreadDeathRequestimport java.util.regex.*int outputCompleteCount;Connector connector;Map<String,Argument> connectorArgs;int traceFlags;Map<String,Argument> argumentsString regexPatternPattern pMatcher mint startPositionint endPositionArgument argumentsplitStringAtNonEnclosedWhiteSpace(...)isEnclosed(...)char[] arrchar SPACEchar DOUBLEQchar SINGLEQchar enclosingTargetCharisLastChar(...)isNextCharWhitespace(...)isPreviousCharWhitespace(...)isCharWhitespace(...)String nameStringString argStringfindConnector(...)parseConnectorArgs(...)this.traceFlagslaunchTarget(...)attachTarget(...)listenTarget(...)setDebugTraceMode(...)setEventRequests(...)resolveEventRequests(...)PathSearchingVirtualMachine psvmnew VMNotConnectedException(...)waitOutputComplete(...)ThreadStartRequest tsrcreateThreadStartRequest(...)ThreadDeathRequest tdrcreateThreadDeathRequest(...)resolveAll(...)/** Create a Thread that will retrieve and display any output. ... */Thread thrdumpStream(...)notifyOutputComplete(...)/* launch child target vm */LaunchingConnector launcherVirtualMachine vmlaunch(...)displayRemoteOutput(...)IllegalConnectorArgumentsException icaeVMStartException vmsedumpFailedLaunchInfo(...)/* attach to running target vm */AttachingConnector attacherattach(...)/* listen for connection from target vm */ListeningConnector listenerString retAddressstartListening(...)accept(...)stopListening(...)// Wait for stderr and stdout/* We are parsing strings of the form: ... */// special case for quote=.,// name=//   ( "l , ue"//     'l , ue'//     v a l u e )+ ,/* It is an error if parsing skips over any part of argString. */// Remove comma delimiter/* for values enclosed in quotes (single and/or double quotes) ... */// Remove what was just parsed...//    and parse again on what is left./* It is an error if any part of argString is left over, ... *//* An "open" or "active" enclosing state is where ... */// split parameter string into individual chars// do nothing for spaces// unless last in array// break for substring creation// potential match to close open enclosing// if peek next is whitespace// then enclosing is a valid substring// reset enclosing target char// no open enclosing state// handle as normal char// peek forward for end candidates// set open enclosing state by// setting up the target char// no more target chars left to match// end enclosing, handle as normal char// normal non-space, non-" and non-' chars// start of space delim substring// end of space delim substring// break's end up here// extract substring and add to List<String>// set new start position// for loop// outside arraybounds is considered an implicit space/* Now that the vm connection is open, fetch the debugee ... *//* Too late if the connection already made */// Normally, we want all uncaught exceptions.  We request them// via the same mechanism as Commands.commandCatchException()// so the user can ignore them later if they are not// interested.// FIXME: this works but generates spurious messages on stdout//        during startup://          Set uncaught java.lang.Throwable//          Set deferred uncaught java.lang.Throwable// Special case: use//   printDirect()// else we got a Bad file number IOException which just means// that the debuggee has gone away.  We'll just treat it the// same as if we got an EOF.// Shuts up the compilerString fieldId;this.fieldIdWatchpointSpec watchpointwatchpoint.fieldIdwatchpoint.refSpecimport Manifestimport java.util.jar.*import JarURLConnectionimport ParseUtil/** ExtCheck reports on clashes between a specified (target) ... */String targetSpecTitle;// for the target jar file// The following strings hold the values of the version variablesString targetSpecVersion;String targetSpecVendor;String targetImplTitle;String targetImplVersion;String targetImplVendor;String targetsealed;boolean verboseFlag;/* Flag to indicate whether extra information should be dumped to stdout *//* Create a new instance of the jar reporting tool for a particular ... */new ExtCheck(...)investigateTarget(...)Manifest targetManifestAttributes attrgetMainAttributes(...)verboseMessage(...)File canonfileToEncodedURL(...)JarLoader loadernew JarLoader(...)JarFile jarFilegetJarFile(...)Name.SPECIFICATION_TITLEName.SPECIFICATION_VERSIONName.SPECIFICATION_VENDORName.IMPLEMENTATION_TITLEName.IMPLEMENTATION_VERSIONName.IMPLEMENTATION_VENDORName.SEALED/** Verify that none of the jar files in the install directory ... */File[] dirsboolean resultString[] filescheckURLRecursively(...)generalMessage(...)/** Recursively verify that a jar file, and any urls mentioned ... */JarLoader jarloaderJarFile jManifest manURL[] loaderListgetClassPath(...)String vendorString implTitleString implVersionString implVendorString sealedisNotOlderThan(...)loaderList.length/** See comment in method java.lang.Package.isCompatibleWith. ... */StringTokenizer dtokint dverint sver/** Prints out message if the verboseFlag is set *//** Throws a RuntimeException with a message describing the error. *//** Inner class used to represent a loader of resources and classes ... */URL base;JarFile jar;URL csu;/* Creates a new Loader for the specified URL. */String urlNameURL tmpBaseURLfindJarFile(...)/* Returns the base URL for this Loader. */URLConnection ucgetBaseURL(...)getFile(...)/* Returns the JAR file local class path, or null if none. */Name.CLASS_PATHparseClassPath(...)/* Parses value of the Class-Path manifest attribute and returns ... */URL[] urls// Until it matches scan and compare numbers// Known to be incompatible// Known to be compatible// Check for and absorb separators// Compare next component// All components numerically equal// Optimize case where url refers to a local jar file//uc.setRequestProperty(USER_AGENT_JAVA_VERSION, JAVA_VERSION);/** Main program of extcheck */String INSUFFICIENT;String MISSING;String DOES_NOT_EXIST;String EXTRA;/** Terminates with one of the following codes ... */realMain(...)int argIndexboolean verboseFlagString jarNameExtCheck jtcheckInstalledAgainstTarget(...)import Snapshotimport ReachableExcludesImplimport QueryListenerString VERSION_STRING;// Convert s to a boolean.  If it's invalid, abort the program.boolean parseonlyint portNumberboolean callStackboolean calculateRefsString baselineDumpString excludeFileNameint debugLevelSnapshot modelFile excludeFileQueryListener listenernew QueryListener(...)RuntimeException exsetReachableExcludes(...)new ReachableExcludesImpl(...)Snapshot baselinemarkNewRelativeTo(...)/* The Original Code is HAT. The Initial Developer of the ... */// Never happens// Undocumented option. To be used for testing purpose only// Guard against conservative GC// do not start web server./** A visitor for a JavaThing.  @see JavaObject#visitReferencedObjects() *//** Should the given field be excluded from the set of things visited? ... *//** Primitive array type codes as defined by VM specification. */int T_BOOLEAN;// Refer to newarray instruction in VM Spec.// Typecodes for array elements.int T_CHAR;int T_FLOAT;int T_DOUBLE;int T_BYTE;int T_SHORT;int T_INT;int T_LONG;/** This is used to represent values that the program doesn't really understand. ... *//** Represents a boolean (i.e. a boolean field in an instance). ... */boolean value;/** Represents an byte (i.e. a byte field in an instance). ... */byte value;/** Represents a char (i.e. a char field in an instance). ... */char value;import CompositeEnumerationimport ReadBuffernew Vector<JavaHeapObject>(...)new JavaClass[]// my id// my nameJavaThing superclass;// These are JavaObjectRef before resolveJavaThing loader;JavaThing signers;JavaThing protectionDomain;...[] fields;// non-static fields...[] statics;// static fields...[] EMPTY_CLASS_ARRAY;...[] subclasses;// my subclassesVector<JavaHeapObject> instances;// my instancesSnapshot mySnapshot;// Who I belong to.  Set on resolve.int instanceSize;// Size of an instance, including VM overheadint totalNumFields;// Total number of fields including inherited onesthis.superclassnew JavaObjectRef(...)this.signersthis.protectionDomainthis.fieldsthis.staticsthis.instanceSizegetJavaLangClass(...)getIdentifierSize(...)getMinimumObjectSize(...)resolveSuperclass(...)addSubclass(...)dereference(...)statics.lengthaddInstance(...)/** Resolve our superclass.  This might be called well before ... */getNullThing(...)JavaClass scsc.totalNumFieldsClassCastException exgetJavaLangString(...)getJavaLangClassLoader(...)/** Get a numbered field from this class *//** Get the total number of fields that are part of an instance of ... *//** Get a numbered field from all the fields that are part of instance ... */getFieldForInstance(...)/** Get the class responsible for field i, where i is a field number that ... */getClassForField(...)Enumeration<> ressubclasses.lengthnew CompositeEnumeration(...)getInstances(...)getInstancesCount(...)/** This can only safely be called after resolve() *//** Includes superclass fields */Vector<JavaField> vnew Vector<JavaField>(...)JavaField[] resultnew JavaField[]addFields(...)// returns value of static field of given nameJavaStatic s(...).nameother.superclass/** Describe the reference that this thing has to target.  This will only ... */JavaField fhasId(...)JavaThing otherdescribeReferenceTo(...)JavaThing tJavaClass clgetInstanceSize(...)JavaHeapObject scvisitReferencedObjects(...)getLoader(...)getSigners(...)exclude(...)// package-privates below this pointgetReadBuffer(...)setNew(...)isNew(...)getSiteTrace(...)addReferenceFromRoot(...)getRoot(...)// Internals only below this pointaddSubclassInstances(...)JavaClass[] newValue// We must be java.lang.Object, so we have no superclass.// Trivial tail recursion:  I have faith in javac.// array class and non-zero count, we have to// get the size of each instance and sum it/** Represents a double (i.e. a double field in an instance). ... */double value;/** Represents a float (i.e. a float field in an instance). ... */float value;import Misc/** Represents an object that's allocated out of the Java heap.  It occupies ... */...[] referers;// empty slots.// be appended to.  When resolved, referers has no duplicates or// resolved.  When building, referers might have duplicates, but can// referers and referersLen go through two phases:  Building and// well worth trading a bit of speed for less swapping.// Who we refer to.  This is heavily optimized for space, because it'sint referersLen;// -1 when resolved/** Do any initialization this thing needs after its data is read in. ... */StackTrace trace// referers data member for details.// This sets us up to answer queries.  See the comments around the//  Eliminate duplicates from referers, and size the array exactly.Map<JavaThing,JavaThing> mapnew HashMap<JavaThing,JavaThing>(...)new JavaThing[]getIdString(...)getClazz(...)/** Tell the visitor about all of the objects we refer to */referers.lengthJavaThing[] copy/** If the rootset includes this object, return a Root describing one ... *//** Tell who refers to us. ... */int num;/** Given other, which the caller promises is in referers, determines if ... */// Copy referers to map, screening out duplicates// Now copy into the array// It was null// We just append to referers here.  Measurements have shown that// around 10% to 30% are duplicates, so it's better to just append// blindly and screen out all the duplicates at once./** A visitor for a JavaThing.  @see JavaObject#visitReferencedObjects() ... *//** Represents an integer (i.e. an int field in an instance). ... *//* Base class for lazily read Java heap objects. */// file offset from which this object data startsgetValueLength(...)// return the length of the data for this objectreadValueLength(...)IOException exp// get this object's content as byte arraySnapshot.EMPTY_BYTE_ARRAY// get ID of this objectReadBuffer bufint idSizeSnapshot.SMALL_ID_MASK// make Integer or Long for given object ID// get ID as long value from Number// read object ID from given index from given byte arraylongAt(...)// utility methods to read primitive types from byte arraylong val/** Represents a long (i.e. a long field in an instance). ... */long value;/** Represents Java instance ... */Object clazz;/** Construct a new JavaObject. ... */// JavaClass after resolve// Number before resolvemakeId(...)long classIDgetIdValue(...)findThing(...)long lenOffsetwarn(...)addFakeInstanceClass(...)parseFields(...)/** Are we the same type as other?  We are iff our clazz is the ... */JavaObject oo/** Return our JavaClass object.  This may only be called after resolve. */// returns the value of field of given nameJavaThing[] fldsJavaField[] instFieldsgetFieldsForInstance(...)instFields.lengthflds.lengthmightExclude(...)getWeakReferenceClass(...)int referentFieldIndexgetReferentFieldIndex(...)JavaThing valuevalueString(...)/* Java instance record (HPROF_GC_INSTANCE_DUMP) looks as below: ... */long lengthOffsetlong offsetgetNumFieldsForInstance(...)JavaField[] fieldsJavaThing[] fieldValuesSnapshot snapshotgetSnapshot(...)int fieldNoJavaClass currClassfieldValues.lengthchar sigobjectIdAt(...)JavaObjectRef refbyteAt(...)new JavaBoolean(...)new JavaByte(...)short valueshortAt(...)new JavaShort(...)char valuenew JavaChar(...)new JavaInt(...)new JavaLong(...)floatAt(...)new JavaFloat(...)doubleAt(...)new JavaDouble(...)// while resolving, parse fields in verbose mode.// but, getFields calls parseFields in non-verbose mode// to avoid printing warnings repeatedly.// pass false to verbose mode so that dereference// warnings are not printed.// skip it// REMIND:  This introduces a dependency on the JDK//      implementation that is undesirable.// In the dump file, the fields are stored in this order:// fields of most derived class (immediate class) are stored// first and then the super class and so on. In this object,// fields are stored in the reverse ("natural") order. i.e.,// fields of most super class are stored first.// target variable is used to compensate for the fact that// the dump file starts field values from the leaf working// upwards in the inheritance hierarchy, whereas JavaObject// starts with the top of the inheritance hierarchy and works down.// Long before resolve, the class after resolveisNewStyleArrayClass(...)JavaClass elgetArrayClass(...)getOtherArrayType(...)getElements(...)int numElementsJavaThing[] elementselements.length/* Java object array record (HPROF_GC_OBJ_ARRAY_DUMP) ... */// Modern heap dumps do this/** A forward reference to an object.  This is an intermediate representation ... */JavaThing resultgetUnresolvedObjectsOK(...)new HackJavaValue(...)// If this happens, we must be a field that represents an int.// (This only happens with .bod-style files)// Thread.dumpStack();/** Represents a short (i.e. a short field in an instance). ... */short value;/** Represents the value of a static field of a JavaClass */JavaField field;JavaThing value;isHeapAllocated(...)JavaHeapObject hoaddRoot(...)new Root(...)Root.JAVA_STATIC// static fields are only roots if they are in classes//    loaded by the root classloader./** Represents a java "Thing".  A thing is anything that can be the value of ... *//** If this is a forward reference, figure out what it really ... *//** Are we the same type as other? ... *//** Compare our string representation to other's ... *//** Abstract base class for all value types (ints, longs, floats, etc.) ... */// The size of a value is already accounted for in the class// that has the data member./** An array of values, that is, an array of ints, boolean, floats or the like. ... *//* Java primitive array record (HPROF_GC_PRIM_ARRAY_DUMP) looks ... */byte typeelementSize(...)JavaClass clazz;// JavaClass set only after resolve.int data;// Actual array length is (byte[].length / divider)// length of content byte[] is not same as array length.// divider to be used to calculate length. Note that// This field contains elementSignature byte andint SIGNATURE_MASK;// First 8 bits of data is used for element signatureint LENGTH_DIVIDER_MASK;// Next 8 bits of data is used for length dividerint LENGTH_DIVIDER_SHIFT;// Number of bits to shift to get length dividerbyte elementSiggetElementType(...)arrayTypeName(...)int dividerbyte elementSignaturebyte etboolean[] resbooleanAt(...)char[] resshort[] resint[] reslong[] resfloat[] resdouble[] resrequireType(...)StringBuffer resultchar valboolean valfloat val/* imports */// length of the array// typecode of array element type// Char arrays deserve special treatment/** This represents a set of data members that should be excluded from the ... */import ReaderFile excludesFile;long lastModified;Hashtable<> methods;/** Create a new ReachableExcludesImpl over the given file.  The file will be ... */// Hashtable<String, String>, used as a bagthis.excludesFilelong lmHashtable<String,String> mString methodreadFileIfNeeded(...)// We want this to be atomicimport ArraySorterimport ComparerHashtable<JavaHeapObject,JavaHeapObject> bagnew Hashtable<JavaHeapObject,JavaHeapObject>(...)Hashtable<String,String> fieldsExcludedHashtable<String,String> fieldsUsedJavaHeapObjectVisitor visitorisExcluded(...)JavaThing[] thingsEnumeration<> eJavaThing leftJavaThing rightthis.reachablesthis.totalSizethings.lengthObject[] keyssortArrayOfStrings(...)JavaHeapObject root;...[] reachables;...[] excludedFields;...[] usedFields;long totalSize;//Bag<String>// Bag<String>// Size is zero for things like integer fields// Put the closure of root and all objects reachable from root into// bag (depth first), but don't include root:// Now grab the elements into a vector, and sort it in decreasing size/** Represents a chain of references to some target object ... */JavaHeapObject obj;ReferenceChain next;// Object referred to// Next in chainReferenceChain tmptmp.next/** Represents a member of the rootset, that is, one of the objects that ... */long refererId;// ID of the JavaThing we refer to// Thread or Class responsible for this, or 0// Index in Snapshot.rootsJavaHeapObject referer;StackTrace stackTrace;int INVALID_TYPE;// See also getTypeName()// Values for type.  Higher values are more interesting -- see getType().int SYSTEM_CLASS;int NATIVE_LOCAL;int NATIVE_STATIC;int THREAD_BLOCK;int BUSY_MONITOR;int JAVA_LOCAL;int NATIVE_STACK;int JAVA_STATIC;this.refererIdthis.stackTrace/** Return type.  We guarantee that more interesting roots will have ... *//** Given two Root instances, return the one that is most interesting. */other.type/** Get the object that's responsible for this root, if there is one. ... *//** Represents a snapshot of the Java objects in the VM at one instant. ... */new Hashtable<Number,JavaHeapObject>(...)new Hashtable<Number,JavaClass>(...)new Vector<Root>(...)new TreeMap<String,JavaClass>(...)new HashMap<JavaHeapObject,Root>(...)new JavaStatic[]long SMALL_ID_MASK;...[] EMPTY_FIELD_ARRAY;...[] EMPTY_STATIC_ARRAY;Hashtable<Number,JavaHeapObject> heapObjects;// all heap objectsHashtable<Number,JavaClass> fakeClasses;Vector<Root> roots;// all Roots in this SnapshotMap<String,JavaClass> classes;// name-to-class mapMap<JavaHeapObject,Boolean> newObjects;// new objects relative to a baseline - lazily initializedMap<JavaHeapObject,StackTrace> siteTraces;// allocation site traces for all objects - lazily initializedMap<JavaHeapObject,Root> rootsMap;// object-to-Root map for all objectsSoftReference<Vector<>> finalizablesCache;// soft cache of finalizeable objects - lazily initializedJavaThing nullThing;// represents null referenceJavaClass weakReferenceClass;// java.lang.ref.Reference classint referentFieldIndex;// index of 'referent' field in java.lang.ref.Reference classJavaClass javaLangClass;// java.lang.Class classJavaClass javaLangString;// java.lang.String classJavaClass javaLangClassLoader;// java.lang.ClassLoader classJavaClass otherArrayType;// unknown "other" array classReachableExcludes reachableExcludes;// Stuff to exclude from reachable queryReadBuffer readBuf;// the underlying heap dump bufferboolean hasNewSet;// True iff some heap objects have isNew setboolean unresolvedObjectsOK;boolean newStyleArrayClass;// old style (element) class.// whether object array instances have new style class orint identifierSize;// object id size in the heap dumpint minimumObjectSize;// (which is true for Sun's hotspot JVM).// most Java virtual machines - we assume 2 identifierSize// minimum object size - accounts for object header ingetFrames(...).lengthinitSiteTraces(...)addHeapObject(...)putInClassesMap(...)int numIntsJavaClass cnew JavaClass(...)new JavaField(...)addFakeClass(...)// Used in the body of resolve()JavaHeapObject t;addReferenceFrom(...)int DOT_LIMIT;// To show heap parsing progress, we print a '.' after this limit/** Called after reading complete, to initialize the structure */JavaHeapObject tcalculateReferencesToObjects(...)setupReferers(...)MyVisitor visitornew MyVisitor(...)visitor.tRoot rboolean isNewlong thingIDisSameTypeAs(...)Number idObjJavaHeapObject jhoparseHex(...)/** Return an Iterator of all of the classes in this snapshot. */JavaClass[] resVector<> objJavaClass clazzJavaObject queuegetStaticField(...)JavaThing tmpVector<JavaHeapObject> finalizablesJavaObject headJavaHeapObject referentJavaThing nextnew SoftReference<Vector<>>(...)Root[] resnew Root[]Vector<ReferenceChain> fifonew Vector<ReferenceChain>(...)Hashtable<JavaHeapObject,JavaHeapObject> visitedVector<ReferenceChain> resultReferenceChain[] realResultnew ReferenceChain[]new ReferenceChain(...)ReferenceChain chainJavaHeapObject currgetObj(...)Enumeration<> referersgetReferers(...)refersOnlyWeaklyTo(...)// package privatesRoot rootmostInteresting(...)initNewObjects(...)new HashMap<JavaHeapObject,Boolean>(...)new HashMap<JavaHeapObject,StackTrace>(...)// Create a fake class name based on ID.// Create fake fields convering the given instance size.// Create as many as int type fields and for the left over// size create byte type fields.// Create fake instance class// Add the class// First, resolve the classes.  All classes must be resolved before// we try any objects, because the objects use classes in their// resolution.// Now, resolve everything else.// JDK 1.1.x// This println refers to the *next* step// to ensure that Iterator.remove() on getClasses()// result will throw exception..// call addReferenceFrom(t) on all objects t references:// note that because classes is a TreeMap// classes are already sorted by name// This is slow... A real fifo would help// Must be a fifo to go breadth-first// Objects are added here right after being added to fifo.// Even though curr is in the rootset, we want to explore its// referers, because they might be more interesting.// This is needed because the JDK only creates Class structures// for array element types, not the arrays themselves.  For// analysis, though, we need to pretend that there's a// JavaClass for the array type, too.// more than one class can have the same name// if so, create a unique name by appending// - and id string to it./** Represents a stack frame. */int LINE_NUMBER_UNKNOWN;// as the values used in the JDK 1.2 heap dump file.// Values for the lineNumber data member.  These are the sameint LINE_NUMBER_COMPILED;int LINE_NUMBER_NATIVE;String methodSignature;String sourceFileName;this.methodSignaturethis.sourceFileName/** Represents a stack trace, that is, an ordered collection of stack frames. */this.framesStackFrame[] fnew StackFrame[]new StackTrace(...)import com.sun.tools.hat.internal.model.*/** This is Object Query Language Interpreter */Class<?> managerClassObject managerMethod getEngineMethodObject jseException exp// check OQL is supported or not before creating OQLEngineisOQLSupported(...)/** Query is of the form ... */String selectExprboolean seenFromboolean isInstanceOfString whereExprString identifierObject resevalScript(...)new OQLException(...)String tmpnew OQLQuery(...)String selectCodeString whereCodeq.classNameq.identifierq.selectExprq.whereExprEnumeration<> objectsq.isInstanceOfJavaHeapObject objwrapJavaObject(...)Object selectthis.snapshotgetInitStream(...)Class<?> engineClassClass<?> invocableClassMethod putMethodObject engine;Method evalMethod;Method invokeMethod;Snapshot snapshot;boolean oqlSupported;// Do we have javax.script support?// create ScriptEngineManager// create JavaScript engine// Query does not start with 'select' keyword.// Just treat it as plain JavaScript and eval it.// compile select expression and where condition// simple "select <expr>" query// initialize engine with init file (hat.js)// initialize ScriptEngine.eval(String) and// Invocable.invokeFunction(String, Object[]) methods.// initialize ScriptEngine.put(String, Object) method// call ScriptEngine.put to initialize built-in heap object/** OQLException is thrown if OQL execution results in error *//** This represents a parsed OQL query */this.selectExprthis.isInstanceOfthis.identifierthis.whereExprString selectExpr;boolean isInstanceOf;String identifier;String whereExpr;/** This visitor is supplied to OQLEngine.executeQuery ... */// return true to terminate the result set callback earlier/** Implementation of ReadBuffer using a RandomAccessFile ... */RandomAccessFile file;// underlying file to readimport ArrayTypeCodes/** Object that's used to read a hprof file. ... */int MAGIC_NUMBER;...[] VERSIONS;// That's "JAVA", the first part of "JAVA PROFILE ..."int VERSION_JDK12BETA3;int VERSION_JDK12BETA4;int VERSION_JDK6;int HPROF_UTF8;// Record types:// dump is generated as version 1.0.2).// heaps the heap dump will not fit in a HPROF_HEAP_DUMP record so the// the size of the heap (normally it will be 1.0.1 but for multi-GB// file. In Java SE 6.0 the version is either 1.0.1 or 1.0.2 depending on// The HPROF agent in J2SE 1.2 through to 5.0 generate a version 1.0.1// to allow a large heap to be dumped as a sequence of heap dump segments.// Version 1.0.2 added HPROF_HEAP_DUMP_SEGMENT and HPROF_HEAP_DUMP_END// to a typecode.// Version 1.0.1 changed the type of a constant pool entry from a signature// version-sensitive parsing.// Version 1.0.1 added HPROF_GC_PRIM_ARRAY_DUMP, which requires no// reading the file.// member version is set to one of these, and it drives decisions when// These version numbers are indices into VERSIONS.  The instance dataint HPROF_LOAD_CLASS;int HPROF_UNLOAD_CLASS;int HPROF_FRAME;int HPROF_TRACE;int HPROF_ALLOC_SITES;int HPROF_HEAP_SUMMARY;int HPROF_START_THREAD;int HPROF_END_THREAD;int HPROF_HEAP_DUMP;int HPROF_CPU_SAMPLES;int HPROF_CONTROL_SETTINGS;int HPROF_LOCKSTATS_WAIT_TIME;int HPROF_LOCKSTATS_HOLD_TIME;int HPROF_GC_ROOT_UNKNOWN;int HPROF_GC_ROOT_JNI_GLOBAL;int HPROF_GC_ROOT_JNI_LOCAL;int HPROF_GC_ROOT_JAVA_FRAME;int HPROF_GC_ROOT_NATIVE_STACK;int HPROF_GC_ROOT_STICKY_CLASS;int HPROF_GC_ROOT_THREAD_BLOCK;int HPROF_GC_ROOT_MONITOR_USED;int HPROF_GC_ROOT_THREAD_OBJ;int HPROF_GC_CLASS_DUMP;int HPROF_GC_INSTANCE_DUMP;int HPROF_GC_OBJ_ARRAY_DUMP;int HPROF_GC_PRIM_ARRAY_DUMP;int HPROF_HEAP_DUMP_SEGMENT;int HPROF_HEAP_DUMP_END;int T_CLASS;int debugLevel;// The version of .hprof being readlong currPos;int dumpsToSkip;// Current position in the fileboolean callStack;// If true, read the call stack of objectsHashtable<Long,String> names;// Size, in bytes, of identifiers.Hashtable<Integer,ThreadObject> threadObjects;// at the end of this file.// HPROF_GC_ROOT_THREAD_OBJ.  ThreadObject is a trivial inner class,// (aka "serial number") to the thread object ID for// Hashtable<Integer, ThreadObject>, used to map the thread sequence numberHashtable<Long,String> classNameFromObjectID;// (with / converted to .)// Hashtable<Long, String>, maps class object ID to class nameHashtable<Integer,String> classNameFromSerialNo;// Hashtable<Integer, Integer>, maps class serial # to class object IDHashtable<Long,StackFrame> stackFrames;// Null if we're not tracking them.// Hashtable<Long, StackFrame> maps stack frame ID to StackFrame.Hashtable<Integer,StackTrace> stackTraces;// Hashtable<Integer, StackTrace> maps stack frame ID to StackTraceRandomAccessFile filenew Snapshot(...)this.dumpsToSkipthis.callStackthis.debugLevelnew Hashtable<Long,String>(...)new Hashtable<Integer,ThreadObject>(...)new Hashtable<Long,StackFrame>(...)new Hashtable<Integer,StackTrace>(...)new Hashtable<Integer,String>(...)readVersionHeader(...)setIdentifierSize(...)setNewStyleArrayClass(...)EOFException ignoredreadID(...)byte[] charsint serialNoint stackTraceSerialNolong classNameIDLong classIdIgetNameFromID(...)readHeapDump(...)EOFException exphandleEOF(...)String methodSigString sourceFileint classSerStackFrame.LINE_NUMBER_NATIVEStackFrame.LINE_NUMBER_UNKNOWNnew StackFrame(...)int threadSeqStackFrame[] frameslong fidint candidatesLeftVERSIONS.lengthboolean[] matchedRoot.UNKNOWNint stackSeqnew ThreadObject(...)long globalRefIdRoot.NATIVE_STATICThreadObject togetThreadObjectFromSequence(...)StackTrace stgetStackTraceFromSerial(...)to.stackSeqtraceForDepth(...)to.threadIdRoot.NATIVE_LOCALRoot.JAVA_LOCALRoot.NATIVE_STACKRoot.SYSTEM_CLASSRoot.THREAD_BLOCKRoot.BUSY_MONITORreadInstance(...)// @returns the number of bytes read// array of one element.  We use it to fake multiple return values.// Read a java value.  If result is non-null, it's expected to be anreadValueForType(...)signatureFromTypeId(...)readValueForTypeSignature(...)StackTrace result// Return number of bytes read// Handle a HPROF_GC_CLASS_DUMPStackTrace stackTracelong superIdlong classLoaderIdlong signersIdlong protDomainIdlong reserved1long reserved2int instanceSizeint numConstPoolEntriesint numStaticsJavaThing[] valueBinJavaStatic[] staticsint numFieldslong nameIdString signaturenew JavaStatic(...)setSiteTrace(...)// Handle a HPROF_GC_INSTANCE_DUMPint bytesFollowingJavaObject jobjnew JavaObject(...)// Handle a HPROF_GC_OBJ_ARRAY_DUMP or HPROF_GC_PRIM_ARRAY_DUMPlong elementClassIDbyte primitiveSignatureint elSizeJavaValueArray vanew JavaValueArray(...)JavaObjectArray arrnew JavaObjectArray(...)setUnresolvedObjectsOK(...)// A trivial data-holder class for HPROF_GC_ROOT_THREAD_OBJ.long threadId;int stackSeq;this.threadIdthis.stackSeq// 4 because of the magic number// Timestamp of this record// Length of record: readInt() will return negative value for record// length >2GB.  so store 32bit value in long to keep it unsigned.// Not used// should be no-op// skip this dump (of the end record for a sequence of dump segments)// HPROF_HEAP_DUMP_END only recognized in >= 1.0.2// read the dump segment// all segments comprising the heap dump will be skipped// HPROF_HEAP_DUMP_SEGMENT only recognized in >= 1.0.2// Ignore these record types// Not matched// Ignored, for now// We ignore the values// Check for primitive arrays:// we have EOF, we have to tolerate missing referencesimport MappedByteBufferimport FileChannel/** Implementation of ReadBuffer using mapped file buffer ... */MappedByteBuffer buf;// factory method to create correct ReadBuffer for a given fileFileChannel chcanUseFileMap(...)MappedByteBuffer bufmap(...)FileChannel.MapMode.READ_ONLYFileChannel.MapModenew MappedReadBuffer(...)new FileReadBuffer(...)// if file size is more than 2 GB and when file mapping is// configured (default), use mapped file reader// fall through// else fall through// set jhat.disableFileMap to any value other than "false"// to disable file mapping/** A DataInputStream that keeps track of total bytes read ... */new PositionInputStream(...)/** InputStream that keeps track of total bytes read (in effect ... */long position;/** Positionable read only buffer ... */// read position has to be specified always.// read methods - only byte array and int primitive types./** Abstract base class for reading object dump files.  A reader need not be ... */PositionDataInputStream in;/** Read a snapshot from a data input stream.  It is assumed that the magic ... *//** Read a snapshot from a file. ... */int dumpNumberPositionDataInputStream innew PositionDataInputStream(...)HprofReader.MAGIC_NUMBERnew HprofReader(...)boolean excludePlatform;this.excludePlatformthis.oqlSupportedIterator<> classesString lastPackagestartHtml(...)String pkgisPlatformClass(...)printClass(...)printAnchorStart(...)endHtml(...)// skip this..// Only in ancient heap dumpsRoot[] rootsgetRootsArray(...)int lastTypeRoot.INVALID_TYPERoot leftRoot rightroots.lengthprintRoot(...)getReferer(...)printThingAnchorTag(...)printThing(...)// More interesting values are *higher*// It should always beprintFullClass(...)JavaClass[] scgetSubclasses(...)JavaField[] ffJavaStatic[] ssgetStatics(...)sc.lengthJavaField leftJavaField rightff.lengthprintField(...)ss.lengthprintStatic(...)encodeForURL(...)getHasNewSet(...)printReferencesTo(...)JavaHeapObject refprintHex(...)// If there are more than one references, this only gets the// first one.Enumeration<> objsgetFinalizerObjects(...)printFinalizerSummary(...)other.countMap<JavaClass,HistogramElement> mapnew HashMap<JavaClass,HistogramElement>(...)HistogramElement[] elementsnew HistogramElement[]HistogramElement elementnew HistogramElement(...)updateCount(...)// calculate and print histogramimport JavaClass/** Prints histogram sortable by class name, count and size. */JavaClass[] classesgetClassesArray(...)Comparator<JavaClass> comparatorgetTotalInstanceSize(...)// default sort is by total sizeimport BufferedWriterimport OQLEngineSocket socket;PrintWriter out;OQLEngine engine;this.socketthis.engineint dataStringBuilder queryBufQueryHandler handlernew BufferedWriter(...)outputError(...)new AllClassesQuery(...)setUrlStart(...)setQuery(...)new OQLHelp(...)new AllRootsQuery(...)new InstancesCountQuery(...)new InstancesQuery(...)new ObjectQuery(...)new ClassQuery(...)new RootsQuery(...)new ReachableQuery(...)new RootStackQuery(...)new HistogramQuery(...)new RefsByTypeQuery(...)new FinalizerSummaryQuery(...)new FinalizerObjectsQuery(...)setSnapshot(...)encodeHtml(...)/** Reads a single HTTP query from a socket, and starts up a QueryHandler ... */long totalSizelong instancesJavaClass[] tmpJavaClass lhsJavaClass rhsString leftString rightint newInst// Sort from biggest to smallest// Arrays at the endboolean includeSubclasses;boolean newObjects;this.includeSubclassesthis.newObjectsString instancesOf/** This handles Object Query Language (OQL) help. ... */import com.sun.tools.hat.internal.oql.*/** This handles Object Query Language (OQL) queries. ... */String oqltoHtml(...)OQLException exp// We inherit printFullClass from ClassQueryJavaHeapObject thingprintAllocationSite(...)printFullObjectArray(...)printFullObject(...)Integer[] hack// Print the StackTrace where this was allocatedgetAllocatedFrom(...)// In the following, I suppose we really should use a visitor// pattern.  I'm not that strongly motivated to do this, however:// This is the only typecase there is, and the default for an// unrecognized type is to do something reasonable.// We should never get here/** This class is a helper that determines if a class is a "platform" ... */LinkedList<String> listInputStream strBufferedReader rdrString[] nmsgetNames(...)isBootstrap(...)nms.length// Shouldn't happen, and if it does, continuing// is the right thing to do anyway.// all classes loaded by bootstrap loader are considered// platform classes. In addition, the older name based filtering// is also done for compatibility.// skip even the array classes of the skipped classes.// some primitive array.// skip upto 'L' after the last '['.import URLEncoderString urlStart;boolean traceAvailableStackFrame fString clazzgetMethodSignature(...)getMethodName(...)getSourceFileName(...)StringWriter swnew OQLEngine(...)waitForRequests(...)ServerSocket ssnew ServerSocket(...)Thread lastSocket snew HttpReader(...)Throwable ignored// Client will setModel when it's ready// created when snapshot is set// If the thread is no longer alive, we'll get a// NullPointerExceptionJavaHeapObject rootReachableObjects ronew ReachableObjects(...)getReachableExcludes(...)getTotalSize(...)getReachables(...)printFields(...)getUsedFields(...)getExcludedFields(...)// Now, print out the sorted list, but start with root/** References by type summary */Map<JavaClass,Long> referrersStatnew HashMap<JavaClass,Long>(...)Map<JavaClass,Long> refereesStatEnumeration<> instancesJavaHeapObject instanceLong count// runSet<JavaClass> keysLong count1Long count2// for each instance// clazz != null/** Query to show the StackTrace for a given root ... */getRootAt(...)boolean includeWeak;this.includeWeakJavaHeapObject targetReferenceChain[] refsrootsetReferencesTo(...)ReferenceChain leftReferenceChain rightRoot leftRRoot rightRrefs.lengthReferenceChain refReferenceChain nextgetNext(...)/** A singleton utility class that sorts an array of objects. ... *//** Sort the given array, using c for comparison */quickSort(...)/** Sort an array of strings, using String.compareTo() */Object tmp// or nearly so.// in O(n log n).  It's well-behaved if the list is already sorted,// terminate).  Worst-case it's O(n^2), but it will usually run in// I _did_ put thought into making sure it's safe (it will always// of-my-head quicksort:  I haven't put any thought into optimizing it.// Sorts arr between from and to, inclusive.  This is a quick, off-the-top-Object pivotint highestBelowPivot// Simple-minded, but reasonable// We now move low and high toward each other, maintaining the// invariants://      arr[i] <= pivot    for all i < low//      arr[i] > pivot     for all i > high// As long as these invariants hold, and every iteration makes// progress, we are safe.// arr[low] <= pivot// arr[high] > pivot:// At this point, low is never == high, BTW// At this point, low == high+1// Now we just need to sort from from..highestBelowPivot// and from high+1..to// pivot == pivot, so ensure algorithm terminates/** Base class for comparison of two objects. ... */Enumeration<> e1;Enumeration<> e2;this.e1this.e2/** Miscellaneous functions I couldn't think of a good place to put. ... */...[] digits;/** A singleton utility class that sorts a vector. ... *//** Sort the given vector, using c for comparison *//** Sort a vector of strings, using String.compareTo() */// Sorts v between from and to, inclusive.  This is a quick, off-the-top-// We now move low and high toward eachother, maintaining the//      v[i] <= pivot    for all i < low//      v[i] > pivot     for all i > high// v[low] <= pivot// v[high] > pivot:// At this point, low is never == highimport SwingPropertyChangeSupport/** {@code JConsoleContext} represents a JConsole connection to a target ... */String CONNECTION_STATE_PROPERTY;/** The {@link ConnectionState ConnectionState} bound property name. *//** Values for the {@linkplain #CONNECTION_STATE_PROPERTY ... */new ConnectionState(...)ConnectionState CONNECTED;/** The connection has been successfully established. */ConnectionState DISCONNECTED;/** No connection present. */ConnectionState CONNECTING;/** The connection is being attempted. *//** Returns the {@link MBeanServerConnection MBeanServerConnection} for the ... *//** Returns the current connection state. ... *//** Add a {@link java.beans.PropertyChangeListener PropertyChangeListener} ... *//** Removes a {@link java.beans.PropertyChangeListener PropertyChangeListener} ... */import JPanelimport SwingWorker/** A JConsole plugin class.  JConsole uses the ... */JConsoleContext context;/** Sets the {@link JConsoleContext JConsoleContext} object representing ... */PropertyChangeListener l/** Returns the {@link JConsoleContext JConsoleContext} object representing ... *//** Returns the tabs to be added in JConsole window. ... *//** Returns a {@link SwingWorker} to perform ... *//** Dispose this plugin. This method is called by JConsole to inform ... *//** Adds a {@link PropertyChangeListener PropertyChangeListener} ... *//** Removes a {@link PropertyChangeListener PropertyChangeListener} ... */// throw away the listener list// Default nop implementation// defer registration of the listener until setContext() is called// check again if context is not set// maintain a listener list to be added later/** This package contains the JConsole API. ... */import com.sun.tools.jdi.*import com.sun.jdi.connect.spi.*ThreadGroup grp;ThreadGroup parentString quoteStrString quotedString pendingList<String> tokenListString[] tokenArraynew InternalException(...)TransportService.ListenKeyHelper helpernew Helper(...)VirtualMachineManager managerlaunchAndAccept(...)createVirtualMachine(...)/** This class simply provides a context for a single launch and ... */String address;TransportService.ListenKey listenKey;TransportService ts;...[] commandArray;Connection connection;IOException acceptException;boolean exited;this.commandArraythis.listenKeythis.tscommandArray.lengthThread acceptingThreadacceptConnection(...)Thread monitoringThreadmonitorTarget(...)exec(...)new VMStartException(...)commandString(...)this.connectionthis.acceptExceptionwaitFor(...)notifyOfExit(...)Connection connectionnotifyOfConnection(...)InterruptedIOException enotifyOfAcceptException(...)// easier to deal with/* Tokenize the command, respecting the given quote character. */// continue/* Add final token. *//* An unclosed quote at the end of the command. Do an ... */// Rethrow the exception in this thread/* Notify waiting thread of VM error termination */// Connection has been established, stop monitoring/* Notify waiting thread of connection */// VM terminated, stop accepting// Report any other exception to waiting thread/** Return array length. ... */process(...).arrayLengthJDWP.ArrayReference.LengthJDWP.ArrayReferenceJDWPException exctoJDIException(...)List<Value> list/** Validate that the range to set/get is valid. ... */List<Value> valsvalidateArrayAccess(...)process(...).valuesJDWP.ArrayReference.GetValuessetValues(...)boolean somethingToSetValueImpl[] setValuesvalidateMirrorsOrNulls(...)ValueImpl valueprepareForAssignment(...)new Component(...)JDWP.ArrayReference.SetValuescomponentTypeName(...)arrayType(...)JDWP.Tag.ARRAYJDWP.TagvalidateAssignment(...)boolean validJNITypeParser destParsernew JNITypeParser(...)signature(...)JNITypeParser srcParserint destDimsdimensionCount(...)String destComponentSignaturecomponentSignature(...)Type destComponentTypefindType(...)String srcComponentSignatureType srcComponentTypefindComponentType(...)/* Represents an array component to other internal parts of this ... */// The method has to be a method on Object since// arrays don't have methods nor any other 'superclasses'// So, use the ClassTypeImpl for Object instead of// the ArrayTypeImpl for the array itself.// because length can be computed from index,// index must be tested first for correct error message// -1 means the rest of the array// shorter of, the rest of the array and rest of// the source values// Validate and convert if necessary/* Since we got this exception, ... *//* An array can be used extensively without the ... *//* Remove all dimensions from the destination. Remove ... */process(...).newArrayJDWP.ArrayType.NewInstanceJDWP.ArrayTypeJNITypeParser parser/* Find the type object, if any, of a component type of this array. ... */isObjectTag(...)List<ReferenceType> listIterator<ReferenceType> iterClassLoaderReference clclassLoader(...)new ClassNotLoadedException(...)primitiveTypeMirror(...)ReferenceTypeImpl refSourceReferenceTypeImpl refDestination/* Return true if an instance of the  given reference type ... */new ArrayList<ReferenceType>(...)VMModifiers.FINALVMModifiers.PUBLICmodifiers(...)ClassNotLoadedException cnleloaderString(...)/* Save a pointless trip over the wire for these methods ... *//* Defined always to be true for arrays */// Just skip the leading '['// arrays don't have methods// It's a reference type// Component class has not yet been loaded// It's a primitive type/* For object arrays, the return values for Interface ... */ReferenceTypeImpl declaringType;this.declaringTypeSDE.BASE_STRATUM_NAMEbaseSourceName(...)baseSourcePath(...)JDWP.Tag.BOOLEANcheckedBooleanValue(...)/* Copyright (c) 1998, 1999, Oracle and/or its affiliates. All rights reserved. ... */theBooleanType(...)/* TO DO: Better hash code */JDWP.Tag.BYTEcheckedByteValue(...)byte othertheByteType(...)Character.MAX_VALUECharacter.MIN_VALUEcheckedCharValue(...)/* Copyright (c) 1998, 2004, Oracle and/or its affiliates. All rights reserved. ... */JDWP.Tag.CHARchar othertheCharType(...)checkedShortValue(...)// Note: since char is unsigned, don't check against MIN_VALUE// This is cached only while the VM is suspendedObjectReferenceImpl.CacheList<ReferenceType> visibleClasses;state(...)ArrayList<ReferenceType> definedClassesCache localgetCache(...)local.visibleClassesClassInfo[] jdwpClassesprocess(...).classesJDWP.ClassLoaderReference.VisibleClassesJDWP.ClassLoaderReferenceJDWP.ClassLoaderReference.VisibleClasses.ClassInfojdwpClasses.length...[...].typeID...[...].refTypeTagVirtualMachine.TRACE_OBJREFSList<ReferenceType> typesvisibleClasses(...)JDWP.Tag.CLASS_LOADERReferenceType reflectedType;JDWP.ClassObjectReference.ReflectedTypeReflectedType replyJDWP.ClassObjectReferencereply.typeIDreply.refTypeTagJDWP.Tag.CLASS_OBJECTreflectedType(...)/* Copyright (c) 1999, 2000, Oracle and/or its affiliates. All rights reserved. ... */JDWP.ClassType.InvokeMethod rslt;JDWP.ClassType.InvokeMethodJDWP.ClassTypethis.rsltrslt.exceptionrslt.returnValueboolean cachedSuperclass;ClassType superclass;int lastLine;List<InterfaceType> interfaces;ClassTypeImpl supprocess(...).superclassJDWP.ClassType.SuperclassgetAllInterfaces(...)List<ClassType> subsnew ArrayList<ClassType>(...)validateMirror(...)validateMirrorOrNull(...)validateFieldSet(...)FieldValue[] valuesnew FieldValue[]JDWP.ClassType.SetValues.FieldValueJDWP.ClassType.SetValuesnew FieldValue(...)CommandSender senderJDWP.ClassType.NewInstanceClassTypeImpl.thisPacketStream streamsendResumingCommand(...)MethodImpl methodThreadReferenceImpl threadList<Value> argumentsvalidateAndPrepareArgumentsForInvoke(...)ValueImpl[] argsNewInstance retvalidateConstructorInvocation(...)sendNewInstanceCommand(...)errorCode(...)JDWP.Error.INVALID_THREADJDWP.ErrornotifySuspend(...)ret.exceptionnew InvocationException(...)ret.newObjectvisibleMethods(...)ReferenceTypeImpl declTypenew CommandSender(...) { ... }new IResult(...)/* If there is a superclass, cache its ... */// More validation specific to setting from a ClassType// validate and convert if necessary/* There is an implict VM-wide suspend at the conclusion ... *//* Method must be in this class. *//* Method must be a constructor */// Method must be in this class or a superclass./** Represents methods with method bodies. ... *//* A subset of the line number info that is softly cached */String stratumID;Map<Integer,List<Location>> lineMapper;// The stratum of this informationList<Location> lineLocations;// Maps line number to location(s)int lowestLine;/* Note: these do not necessarily correspond to ... */// List of locations ordered by code indexint highestLine;this.stratumIDthis.lineMapperthis.lineLocationsthis.lowestLinethis.highestLineSoftReference<SoftLocationXRefs> softBaseLocationXRefsRef;SoftReference<SoftLocationXRefs> softOtherLocationXRefsRef;SoftReference<List<LocalVariable>> variablesRef;boolean absentVariableInformation;long firstIndex;long lastIndex;SoftReference<byte[]> bytecodesRef;int argSlotCount;getBaseLocations(...)SDE.Stratumnew ArrayList<Location>(...)List<Location> lineLocationsgetLocations(...).lineLocationsgetLocations(...)sourceNameFilter(...)SoftLocationXRefs infoList<Location> listinfo.lineMapperinfo.lineLocationsnew LocationImpl(...)Iterator<Location> iterLocationImpl bestMatchcodeIndexToLineInfo(...)LocationImpl currentgetVariables(...)List<LocalVariable> variablesList<LocalVariable> retListnew ArrayList<LocalVariable>(...)Iterator<LocalVariable> iterLocalVariable variableprocess(...).bytesJDWP.Method.BytecodesJDWP.Methodnew SoftReference<byte[]>(...)String stratumIDMap<Integer,List<Location>> lineMappernew HashMap<Integer,List<Location>>(...)int lowestLineint highestLineSDE.LineStratumLineStratum lastLineStratumStratum baseStratumstratum(...)Iterator<Location> itgetBaseLocations(...).lineLocationsisJava(...)info.stratumIDLocationImpl locint baseLineNumberLineStratum lineStratumlineStratum(...)Integer keyList<Location> mappedLocsaddStratumLineInfo(...)new StratumLineInfo(...)sourcePath(...)new SoftLocationXRefs(...)new SoftReference<SoftLocationXRefs>(...)JDWP.Method.LineTableLineTable lntablntab.lines.lengthlntab.lineslong bci...[...].lineCodeIndex...[...].lineNumberaddBaseLineInfo(...)new BaseLineInfo(...)lntab.startlntab.endJDWP.Method.VariableTableVariableTable vartabvartab.slots.lengthvartab.slotsJDWP.Error.ABSENT_INFORMATIONvartab.argCntJDWP.Method.VariableTable.SlotInfoSlotInfo sisi.nameLocation scopeStartsi.codeIndexLocation scopeEndsi.lengthnew LocalVariableImpl(...)si.slotsi.signatureJDWP.Method.VariableTableWithGenericVariableTableWithGeneric vartabcanGet1_5LanguageFeatures(...)getVariables1_4(...)JDWP.Method.VariableTableWithGeneric.SlotInfosi.genericSignaturegetVariables1(...)new SoftReference<List<LocalVariable>>(...)// The generic signature is set when this is created/* needs sourceName filteration *//* Find the locations which match the line number ... *//* Check for invalid code index. *//* Check for absent line numbers. *//* Treat code before the beginning of the first line table ... *//* Arrays are always modifiable, so it is a little unsafe ... */// location not mapped in this stratum// remove unmapped and dup lines// Remember the largest/smallest line number// Add to the location list// Add to the line -> locations map/* Note: the absent info error shouldn't happen here ... *//* Some compilers will point multiple consecutive ... *//* firstIndex, lastIndex, and startLocation need to be ... *//* The startLocation is the first one in the ... */// Get the number of slots used by argument variables/* Skip "this*" entries because they are never real ... */// Add to the variable listimport InternalExceptionnew LinkedHashMap<String,Argument>(...)Map<String,Argument> defaultArguments;String trueString;// Used by BooleanArgumentString falseString;Map<String,Argument> defaultsCollection<Argument> valuesIterator<Argument> iterArgumentImpl argumentnew StringArgumentImpl(...)new BooleanArgumentImpl(...)new IntegerArgumentImpl(...)new SelectedArgumentImpl(...)new IllegalConnectorArgumentsException(...)ResourceBundle messages;String stringboolean mustSpecify;this.mustSpecifyArgument otherConnectorImpl.ArgumentImplConnector.BooleanArgumentConnector.IntegerArgumentConnector.StringArgumentConnector.SelectedArgumentList<String> choices;this.choices// Object should always support clone// *** Should this be internationalized????// *** Even Brian Beck was unsure if an Arabic programmer// *** would expect port numbers in Arabic numerals,// *** so punt for now.JDWP.Tag.DOUBLEcheckedDoubleValue(...)double othertheDoubleType(...)checkedIntValue(...)long longValuecheckedLongValue(...)float floatValuecheckedFloatValue(...)import EventSetnew LinkedList<EventSet>(...)LinkedList<EventSet> eventSets;/* Note this is not a synchronized list. Iteration/update should be ... */TargetVM target;addEventQueue(...)/* Override superclass back to default equality */new EventSetImpl(...)JDWP.EventKind.VM_DISCONNECTED/** Filter out events not for user's eyes. ... */EventSetImpl fullEventSetremoveUnfiltered(...)userFilter(...)JDWP.SuspendPolicy.ALLJDWP.SuspendPolicyinternalFilter(...)TimerThread threadnew TimerThread(...)timedOut(...)EventSetImpl eventSetwaitInitCompletion(...)TimerThread timerThreadstartTimerThread(...)shouldWait(...)new VMDisconnectedException(...)notifyDequeueEventSet(...)build(...)boolean timedOut;threadGroupForJDI(...)EventQueueImpl queueEventQueueImpl.this// OK for this the be first since synchronized// place VMDisconnectEvent into queue// timeout/* Remove events from the event set for which ... */// Waiting forever, so removeUnfiltered() is never null/* Currently, no internal events are requested with a suspend ... *//* Make sure the VM has completed initialization before ... *//* If there's already something there, no need ... *//* If a timeout was specified, create a thread to ... */// The build is synchronized on the event set, don't hold// the queue lock.// Exit without notifyingimport JDWP// and List[] requestLists. The generic array is not supported.// Remove SuppressWarning when we fix the warnings from List filters// Warnings from List filters and List[] requestLists is  hard to fix./** This interface is used to create and remove Breakpoints, Watchpoints, ... */...[] requestLists;int methodExitEventCmd;JDWP.SuspendPolicy.EVENT_THREADJDWP.SuspendPolicy.NONEint id;List<Object> filters;/* This list is not protected by a synchronized wrapper. All ... */boolean isEnabled;Map<Object,Object> clientProperties;EventRequestManagerImpl.this.vmEventRequestManagerImpl.thisnew InvalidRequestStateException(...)requestList(...)eventCmd(...)/** delete the event request */invalidState(...)JDWP.EventRequest.Set.Modifier.CountJDWP.EventRequest.Set.ModifierJDWP.EventRequest.SetJDWP.EventRequestJDItoJDWPSuspendPolicy(...)JDWPtoJDISuspendPolicy(...)/** set (enable) the event request */Modifier[] modsnew Modifier[]process(...).requestIDJDWP.EventRequest.Clearnew HashMap<Object,Object>(...)/** Add an arbitrary key/value "property" to this component. ... */JDWP.EventRequest.Set.Modifier.ThreadOnlyJDWP.EventRequest.Set.Modifier.ClassOnlyJDWP.EventRequest.Set.Modifier.ClassMatchJDWP.EventRequest.Set.Modifier.ClassExcludecanUseInstanceFilters(...)JDWP.EventRequest.Set.Modifier.InstanceOnlythis.locationJDWP.EventRequest.Set.Modifier.LocationOnlycanUseSourceNameFilters(...)JDWP.EventRequest.Set.Modifier.SourceNameMatchReferenceType exception;ReferenceTypeImpl excnew ClassTypeImpl(...)JDWP.EventRequest.Set.Modifier.ExceptionOnlyEventRequestManagerImpl.methodExitEventCmdint jdwpSizeint jdwpDepthList<StepRequest> requestsIterator<StepRequest> iterJDWP.StepSize.MINJDWP.StepSizeJDWP.StepSize.LINEJDWP.StepDepth.INTOJDWP.StepDepthJDWP.StepDepth.OVERJDWP.StepDepth.OUTnew DuplicateRequestException(...)JDWP.EventRequest.Set.Modifier.StepField field;JDWP.EventRequest.Set.Modifier.FieldOnlyField[] ekindsgetDeclaredFields(...)JDWP.EventKind.classint highestekinds.lengthIllegalAccessException excnew List<>[]new ArrayList<EventRequest>(...)new ClassPrepareRequestImpl(...)new ClassUnloadRequestImpl(...)new ExceptionRequestImpl(...)new StepRequestImpl(...)new ThreadDeathRequestImpl(...)new ThreadStartRequestImpl(...)new MethodEntryRequestImpl(...)new MethodExitRequestImpl(...)canRequestMonitorEvents(...)new MonitorContendedEnterRequestImpl(...)new MonitorContendedEnteredRequestImpl(...)new MonitorWaitRequestImpl(...)new MonitorWaitedRequestImpl(...)new NativeMethodException(...)new BreakpointRequestImpl(...)canWatchFieldAccess(...)new AccessWatchpointRequestImpl(...)canWatchFieldModification(...)new ModificationWatchpointRequestImpl(...)canRequestVMDeathEvent(...)new VMDeathRequestImpl(...)Iterator<? extends EventRequest> iternew ArrayList<? extends EventRequest>(...)validateMirrors(...)JDWP.EventRequest.ClearAllBreakpointsunmodifiableRequestList(...)List<? extends EventRequest> rlEventRequestImpl erer.id/* must do BEFORE delete *//* If we can get return values, then we always get them. ... *//* Translate size and depth to corresponding JDWP values. *//* Make sure this isn't a duplicate */// copy the eventRequests to avoid ConcurrentModificationExceptionnew EventDestination(...)EventDestination UNKNOWN_EVENT;EventDestination INTERNAL_EVENT;EventDestination CLIENT_EVENT;/* An EventSet is normally created by the transport reader thread when ... */VirtualMachineImpl vm;Packet pkt;// we implement MirrorEventSetImpl internalEventSet;byte eventCmd;EventRequest request;// This is set only for client requests, not internal requests./** Constructor for events. */JDWP.Event.Composite.Events.EventsCommonJDWP.Event.Composite.EventsJDWP.Event.CompositeJDWP.EventEventRequestManagerImpl ermieventRequestManagerImpl(...)EventSetImpl.this.vmEventSetImpl.thisthis.eventCmdeventKind(...)this.requestIDthis.request/** Constructor for VM disconnected events. */EventDestination.CLIENT_EVENTgetInternalEventRequestManager(...)this.vmEventDestination.INTERNAL_EVENTEventDestination.UNKNOWN_EVENTeventName(...)/** For MethodEntry and MethodExit */JDWP.Event.Composite.Events.Breakpointevt.requestIDevt.threadevt.locationJDWP.Event.Composite.Events.SingleStepJDWP.Event.Composite.Events.MethodEntryValue returnVal;JDWP.Event.Composite.Events.MethodExitJDWP.Event.Composite.Events.MethodExitWithReturnValueevt.valueObjectReference monitor;JDWP.Event.Composite.Events.MonitorContendedEnterthis.monitorevt.objectJDWP.Event.Composite.Events.MonitorContendedEnteredJDWP.Event.Composite.Events.MonitorWaitevt.timeoutJDWP.Event.Composite.Events.MonitorWaitedthis.timed_outevt.timed_outReferenceType referenceType;JDWP.Event.Composite.Events.ClassPrepareevt.typeIDevt.refTypeTagevt.signatureevt.statusString classSignature;JDWP.Event.Composite.Events.ClassUnloadthis.classSignatureJDWP.Event.Composite.Events.Exceptionevt.exceptionthis.catchLocationevt.catchLocationJDWP.Event.Composite.Events.ThreadDeathJDWP.Event.Composite.Events.ThreadStartJDWP.Event.Composite.Events.VMStartJDWP.Event.Composite.Events.VMDeathObjectReference object;getFieldMirror(...)JDWP.Event.Composite.Events.FieldAccessevt.fieldIDValue newValue;JDWP.Event.Composite.Events.FieldModificationthis.newValueevt.valueToBe/** Events are constructed on the thread which reads all data from the ... */this.pkt/** Constructor for special events like VM disconnected */addEvent(...)new VMDisconnectEventImpl(...)/* Complete the construction of an EventSet.  This is called from ... */Composite compEvtnew Composite(...)ThreadReference fix6485605compEvt.suspendPolicyVirtualMachine.TRACE_EVENTScompEvt.events.lengthcompEvt.eventsEventImpl evtcreateEvent(...)VMDisconnectedException eedestination(...)/** Filter out internal events *//** Filter out user events. */this.internalEventSetEventsCommon commevt.aEventsCommonevt.eventKindnew ThreadStartEventImpl(...)JDWP.EventKind.THREAD_ENDnew ThreadDeathEventImpl(...)new ExceptionEventImpl(...)new BreakpointEventImpl(...)new MethodEntryEventImpl(...)new MethodExitEventImpl(...)new AccessWatchpointEventImpl(...)new ModificationWatchpointEventImpl(...)new StepEventImpl(...)new ClassPrepareEventImpl(...)new ClassUnloadEventImpl(...)new MonitorContendedEnterEventImpl(...)new MonitorContendedEnteredEventImpl(...)new MonitorWaitEventImpl(...)new MonitorWaitedEventImpl(...)new VMStartEventImpl(...)new VMDeathEventImpl(...)int cursor;/** Index of element to be returned by subsequent call to next. */Event nxtspliterator(...)Spliterator<>.DISTINCT/* below make this unmodifiable *//* We need to decide if this event is for ... *//* An unsolicited event.  These have traditionally ... */// Is this an event for a current client request?// Nope.  Is it an event for an internal request?// Yep// We found a client request// From "MirrorImpl":// Yes, its a bit of a hack. But by doing it this// way, this is the only place we have to change// typing to substitute a new impl.// Note that this class has a public add method that throws// an exception so that clients can't modify the EventSet// ignore - see bug 6502716// Ignore disabled, deleted, unknown events, but// save the thread if there is one since we might// have to resume it.  Note that events for different// threads can't be in the same event set.// No longer needed - free it up// Avoid hangs described in 6296125, 6293795// This set has no client events.  If we don't do// needed resumes, no one else is going to.// See bug 6485605.// apparently, there is nothing to resume.// Ignore unknown event types// Do nothingFieldImpl otherReferenceTypeImpl declaringTypeint rcReferenceTypeImpl enclosingisModifierSet(...)VMModifiers.TRANSIENTVMModifiers.VOLATILEVMModifiers.ENUM_CONSTANTJDWP.Tag.FLOATfloat othertheFloatType(...)import Bootstrap/* An AttachingConnector to attach to a running VM using any ... */String ARG_ADDRESS;/* The arguments that this connector supports */String ARG_TIMEOUT;TransportService transportService;Transport transport;/* Initialize a new instance of this connector. The connector ... */addStringArgument(...)addIntegerArgument(...)/** Initializes a new instance of this connector. This constructor ... *//* Create an instance of this connector. The resulting AttachingConnector ... */new GenericAttachingConnector(...)/** Attach to a target VM using the specified address and Connector arguments. */String tsargument(...)int timeout/** Attach to a target VM using the specified arguments - the address ... */// delegate name to the transport service/* A ListeningConnector to listen for connections from target VM ... */Map<Map<String,? extends Argument>,ListenKey> listenMap;/** Initialize a new instance of this connector. The connector ... */new HashMap<Map<String,? extends Argument>,ListenKey>(...)/** Initialize a new instance of this connector. This constructor is used ... *//** Create an instance of this Connector. The resulting ListeningConnector will ... */new GenericListeningConnector(...)ListenKey listenersupportsMultipleConnections(...)capabilities(...)/* Keep compatibility with previous releases - if the ... */JDWP.Tag.INTint othertheIntegerType(...)JDWP.InterfaceType.InvokeMethod rslt;JDWP.InterfaceType.InvokeMethodJDWP.InterfaceTypeSoftReference<List<InterfaceType>> superinterfacesRef;List<InterfaceType> superinterfacesnew SoftReference<List<InterfaceType>>(...)List<InterfaceType> subsnew ArrayList<InterfaceType>(...)List<ClassType> implementorsInterfaceTypeImpl.this// interfaces are always assignable to j.l.Object// method must be directly in this interfaceEventQueueImpl queue;ClassUnloadEvent cuEventremoveReferenceType(...)classSignature(...)ClassPrepareEvent cpEventmarkPrepared(...)VMOutOfMemoryException vmmeInconsistentDebugInfoException idieObjectCollectedException oceClassNotPreparedException cnpe/* Handle exceptions that can occur in normal operation ... *//* If any of these exceptions below occurs, there is some ... */// should we really die here// time to dieimport ClassNotLoadedExceptionimport ClassTypeimport InterfaceTypeimport InvalidTypeExceptionimport InvocationExceptionimport Value/** A supertype for ReferenceTypes allowing method invocations *//** The invocation result wrapper ... *//** Method invocation support. ... */List<? extends Value> argumentsInvocationResult retvalidateMethodInvocation(...)sendInvokeCommand(...)ClassType.INVOKE_SINGLE_THREADEDgetResult(...)ClassTypeImpl superclazzIterator<InterfaceType> iterInterfaceTypeImpl interfazeClassTypeImpl clazzaddVisibleMethods(...)addToMethodMap(...)List<InterfaceType> immediateClassTypeImpl superclassaddInterfaces(...)/** Returns all the implemented interfaces recursively ... */List<InterfaceType> all/** Shared implementation of {@linkplain ClassType#allMethods()} and ... */ArrayList<Method> listList<ReferenceType> inheritedgetInvokeMethodSender(...)ValueImpl argcanInvoke(...)isStaticInitializer(...)/** A subclass will provide specific {@linkplain CommandSender} ... *//** Waits for the reply to the last sent command ... *//** Get the {@linkplain ReferenceType} superclass ... *//** Get the implemented/extended interfaces ... *//** Checks the provided method whether it can be invoked ... *//* Add methods from ... *//* Avoid duplicate checking on each method by iterating through ... *//* insert at front *//* Cache the values of args when TRACE_SENDS is enabled, for later printing. ... *//* Method must be a static and not a static initializer */short errorCode;JDWP.Error.INVALID_OBJECTnew ObjectCollectedException(...)JDWP.Error.VM_DEADJDWP.Error.OUT_OF_MEMORYnew VMOutOfMemoryException(...)JDWP.Error.CLASS_NOT_PREPAREDnew ClassNotPreparedException(...)JDWP.Error.INVALID_FRAMEIDJDWP.Error.NOT_CURRENT_FRAMEnew InvalidStackFrameException(...)JDWP.Error.NOT_IMPLEMENTEDJDWP.Error.INVALID_INDEXJDWP.Error.INVALID_LENGTHJDWP.Error.TYPE_MISMATCHnew InconsistentDebugInfoException(...)new IllegalThreadStateException(...)char SIGNATURE_ENDCLASS;char SIGNATURE_FUNC;char SIGNATURE_ENDFUNC;List<String> typeNameList;List<String> signatureList;int currentIndex;int firstIndextypeNameList(...)signatureList(...)String elemnextSignature(...)nextTypeName(...)char keyint endClassString retValJDWP.Tag.OBJECTJDWP.Tag.VOIDJDWP.Tag.SHORTJDWP.Tag.LONGLocation scopeStart;Location scopeEnd;this.scopeStartthis.scopeEndthis.genericSignatureLocalVariableImpl otherslot(...)other.scopeStartMethod frameMethodargSlotCount(...)/* Compilers/VMs can have byte code ranges for variables of the ... */LocalVariableImpl otherImplotherImpl.methodotherImpl.nameotherImpl.scopeStart// The Spec says to return null for non-generic types// this is here to cover the possibility that we will// allow LocalVariables for native methods.  If we do// so we will have to re-examinine this.// If this variable object exists, there shouldn't be absent infolong methodRef;LineInfo baseLineInfo;LineInfo otherLineInfo;this.codeIndex/* This constructor allows lazy creation of the method mirror. This ... */this.methodRefLocation otherLocationImpl othergetMethodMirror(...)LineInfo lineInfoMethodImpl methodImplgetBaseLineInfo(...)liStratum(...)getDefaultStratum(...)liSourceName(...)liSourcePath(...)liLineNumber(...)/* TO DO: better hash code? */// be sure information is up-to-date/* check if there is cached info to use *//* compute the line info *//* cache it *//* base stratum is done slighly differently */// copy because of concurrency/* find best match *//** This class is used by the back end to do thread synchronization. ... */long othertheLongType(...)JNITypeParser signatureParser;VMModifiers.NATIVEVMModifiers.ABSTRACTnew NonConcreteMethodImpl(...)new ConcreteMethodImpl(...)MethodImpl otherreturnSignature(...)argumentSignatures(...)ArrayList<Type> typesnew ArrayList<Type>(...)argumentType(...)VMModifiers.STATICVMModifiers.PRIVATEVMModifiers.SYNCHRONIZEDVMModifiers.VARARGSVMModifiers.BRIDGEprocess(...).isObsoleteJDWP.Method.IsObsolete/* A container class for the return value to allow ... */returnType(...)returnTypeName(...)MethodImpl.thisReturnContainer retValContainer;new ReturnContainer(...)/* A container class for the argument to allow ... *//* This is a var args method.  Thus, its last param is an ... */List<Type> paramTypesArrayType lastParamTypeint argCountValue nthArgValueType nthArgTypeArrayReference argArray/* The output list will be different than the input list. */List<String> signatureshandleVarArgs(...)new ArgumentContainer(...)//type().signature();// Error; will be caught later.// It is ok to pass 0 args to the var arg.// We have to gen a 0 length array./* This is case 1.  A compatible array is being passed to the ... *//* Case 2.  We have to verify that the n, n+1, ... args are compatible ... *//* This will copy arguments(paramCount - 1) ... to argArray(0) ... ... *//* Remove the excess args */Mirror other/** Throw NullPointerException on null mirror. ... */new VMMismatchException(...)/** Allow null mirror. ... *//** Throw NullPointerException on null mirrors. ... */Iterator<? extends Mirror> iterMirrorImpl mirrormirror.vm/** Allow null mirrors. ... */boolean isValid;/* Once false, monitorInfo should not be used. ... */this.stack_depth/* ThreadListener implementation ... */validateMonitorInfo(...)/* remove this stack frame as a listener *//** Represents non-concrete (that is, native or abstract) methods. ... */long ref;ReferenceType type;int gcDisableCount;boolean addedListener;JDWP.ObjectReference.MonitorInfo monitorInfo;JDWP.ObjectReference.MonitorInfoJDWP.ObjectReferenceCache noInitCache;Cache markerCache;Cache cache;// Override in subclassesenableCache(...)disableCache(...)newCache(...)// can override.// By default it is our very own referenceType() but subclasses// Return the ClassTypeImpl upon which to invoke a method./* VMListener implementation */ObjectReferenceImpl otherJDWP.ObjectReference.ReferenceTypeReferenceType rtinfortinfo.typeIDrtinfo.refTypeTagList<Field> listMap<Field,Value> mapList<Field> staticFieldsList<Field> instanceFieldsField[] queryFieldsJDWP.ObjectReference.GetValues.FieldJDWP.ObjectReference.GetValuesValueImpl[] valuesvalidateFieldAccess(...)new HashMap<Field,Value>(...)FieldImpl fieldFieldValue[] fvalsJDWP.ObjectReference.SetValues.FieldValueJDWP.ObjectReference.SetValuesvalidateClassMethodInvocation(...)validateIfaceMethodInvocation(...)invokableReferenceType(...)ClassTypeImpl invokedClassisNonVirtual(...)Method invokerconcreteMethodByName(...)isDefault(...)JDWP.ObjectReference.InvokeMethodObjectReferenceImpl.thisInvokeMethod retInterfaceType typeClassType typeret.returnValue/* leave synchronized to keep count accurate */JDWP.ObjectReference.DisableCollectionJDWP.ObjectReference.EnableCollectionprocess(...).isCollectedJDWP.ObjectReference.IsCollectedMonitorInfo infolocal.monitorInfohasListener(...)JDWP.Error.THREAD_NOT_SUSPENDEDjdwpMonitorInfo(...).waitersjdwpMonitorInfo(...)jdwpMonitorInfo(...).ownerjdwpMonitorInfo(...).entryCountint intMaxcanGetInstanceInfo(...)process(...).referringObjectsJDWP.ObjectReference.ReferringObjectsReferenceType destTypeReferenceTypeImpl myTypeString destTypeName// Set cache now, otherwise newly created objects are// not cached until resuspend// make sure that cache and listener management are synchronized/* If a listener was added (i.e. this is not a ... */// false says remove// Make sure the field is valid// FIX ME! We need to do some sanity checking// here; make sure the field belongs to this// object./* thanks OTI *//* Method must be in this object's class, a superclass, or ... *//* Method must be a non-constructor *//* For nonvirtual invokes, method must have a body *//* Get the class containing the method that will be invoked. ... */// No overrides in non-virtual invokes/* For virtual invokes, find any override of the method. ... *///  invoker is supposed to be non-null under normal circumstances/* The above code is left over from previous versions. ... *//* Only default methods allowed for nonvirtual invokes */// If already collected, no harm done, no exception// getCache() and addlistener() must be synchronized// so that no events are lost.// Check if there will be something to cache// and there is not already a listener/* For other, less numerous objects, this is done ... */// JDWP can't currently handle more than this (in mustang)/* Don't need to worry about subclasses since java.lang.Class is final. */// conversion never necessary/* Do these simpler checks before attempting a query of the destination's ... *//* TO DO: Centralize JNI signature knowledge */// Validate assignment/** Represents methods which have changed when the class was redefined. */short NoFlags;short Reply;short ReplyNoError;int uID;...[] nullData;// to work with.// We represent them as shorts to make them easier// Note! flags, cmdSet, and cmd are all byte values.short flags;short cmdSet;short cmd;boolean replied;/** Return byte representation of the packet */Packet.Reply/** Create a packet from its byte array representation */int b0int b5int b6int b7Packet pp.idp.flagsp.cmdSetp.cmdshort b9short b10p.errorCodep.datap.data.lengthuniqID(...)/* Copyright (c) 1998, 2003, Oracle and/or its affiliates. All rights reserved. ... *//* JDWP spec does not require this id to be sequential and ... */int inCursor;ByteArrayOutputStream dataStream;boolean isCommitted;pkt.cmdSetpkt.cmdthis.isCommittedpkt.idpkt.datasendToTarget(...)waitForTargetReply(...)pkt.errorCodePacket.ReplyNoErrornew JDWPException(...)writeID(...)vm.sizeofObjectRefvm.sizeofClassRefvm.sizeofMethodRefvm.sizeofFieldRefvm.sizeofFrameRefbyte[] stringBytesstringBytes.lengthwriteByteArray(...)ReferenceTypeImpl refTypeJDWP.TypeTag.CLASSJDWP.TypeTagJDWP.TypeTag.INTERFACEwriteValueChecked(...)typeValueKey(...)writeUntaggedValueChecked(...)writeChar(...)charValue(...)/** Read byte represented as one bytes. */byte ret/** Read boolean represented as one byte. *//** Read char represented as two bytes. *//** Read short represented as two bytes. *//** Read int represented as four bytes. *//** Read long represented as eight bytes. */long b1long b2long b3long b4long b5long b6long b7long b8/** Read float represented as four bytes. *//** Read double represented as eight bytes. *//** Read string represented as four byte length followed by ... *//** Read object represented as vm specific byte sequence. */byte typeKeyobjectMirror(...)readObjectRef(...)long refstringMirror(...)arrayMirror(...)threadMirror(...)threadGroupMirror(...)classLoaderMirror(...)classObjectMirror(...)/** Read method reference represented as vm specific byte sequence. *//** Read field reference represented as vm specific byte sequence. *//** Read field represented as vm specific byte sequence. */readReferenceType(...)long fieldRef/** Read frame represented as vm specific byte sequence. *//** Read a value, first byte describes type of value to read. */readUntaggedValue(...)ValueImpl valnew ByteValueImpl(...)new CharValueImpl(...)new FloatValueImpl(...)new DoubleValueImpl(...)new IntegerValueImpl(...)new LongValueImpl(...)new ShortValueImpl(...)new BooleanValueImpl(...)new VoidValueImpl(...)/** Read location represented as vm specific byte sequence. */long classReflong methodReflong codeIndexbyte[] arrayboolean gettingObjectsJDWP.Tag.STRINGJDWP.Tag.THREADJDWP.Tag.THREAD_GROUP/* read only stream */// It's possible to have executable code in an interface/* Valid location *//* Null location (example: uncaught exception) *//* Each object comes back with a type key which might ... *//* Converts the given primitive value to a value of this type. *//* The checked versions of the value accessors throw ... */convertForAssignmentTo(...)PrimitiveTypeImpl primitiveType/* Always disallow a conversion to boolean from any other ... *//* Can't overflow by converting to double, so this method ... *//* An AttachingConnector that connects to a debuggee by specifying the process ... */String ARG_PID;String pidTransportService tsgetAgentProperties(...)new SocketTransportService(...)// use generic keys to keep// resource bundle small// Use Attach API to attach to target VM and read value of// sun.jdwp.listenAddress property.// check that the property value is formatted correctly// parse into transport library name and address// connect to the debuggeeString ARG_COMMAND;String ARG_QUOTE;ClassNotFoundException xUnsatisfiedLinkError xString commandString quotetokenizeCommand(...)new SDE(...)JDWP.ClassStatus.INITIALIZEDJDWP.ClassStatus.ERRORJDWP.ClassStatusboolean genericSignatureGotten;String baseSourceName;String baseSourceDir;String baseSourcePath;int modifiers;SoftReference<List<Field>> fieldsRef;SoftReference<List<Method>> methodsRef;SoftReference<SDE> sdeRef;boolean isClassLoaderCached;ClassLoaderReference classLoader;ClassObjectReference classObject;boolean isPrepared;boolean versionNumberGotten;boolean constantPoolInfoGotten;int constanPoolCount;...[] constantPoolBytes;SoftReference<byte[]> constantPoolBytesRef;String ABSENT_BASE_SOURCE_NAME;/* to mark a SourceFile request that returned a genuine JDWP.Error.ABSENT_INFORMATION */SDE NO_SDE_INFO_MARK;/* to mark when no info available */int INITIALIZED_OR_FAILED;// bits set when initialization was attempted (succeeded or failed)Iterator<Method> itnew ObsoleteMethodImpl(...)Iterator<Field> itReferenceTypeImpl otherint complong rf1long rf2vm.sequenceNumber(...).sequenceNumbergenericSignature(...)process(...).signatureJDWP.ReferenceType.SignatureJDWP.ReferenceTypeJDWP.ReferenceType.SignatureWithGenericSignatureWithGeneric resultresult.signaturesetGenericSignature(...)result.genericSignatureprocess(...).classLoaderJDWP.ReferenceType.ClassLoaderVMModifiers.PROTECTEDisPrivate(...)isProtected(...)updateStatus(...)JDWP.ClassStatus.VERIFIEDFieldInfo[] jdwpFieldsJDWP.ReferenceType.FieldsWithGeneric.FieldInfoJDWP.ReferenceType.FieldsWithGenericprocess(...).declaredjdwpFields.lengthFieldInfo finew FieldImpl(...)fi.fieldIDfi.namefi.signaturefi.genericSignaturefi.modBitsJDWP.ReferenceType.Fields.FieldInfoJDWP.ReferenceType.Fieldsnew SoftReference<List<Field>>(...)Field duplicateList<Field> visibleListMap<String,Field> visibleTablenew HashMap<String,Field>(...)List<String> ambiguousNamesList<? extends ReferenceType> typesinheritedTypes(...)Iterator<? extends ReferenceType> iterList<Field> retListReferenceTypeImpl typeaddVisibleFields(...)Field hiddenaddAllFields(...)List<Field> fieldListSet<ReferenceType> typeSetnew HashSet<ReferenceType>(...)List<Field> searchListmethods1_4(...)MethodInfo[] declaredJDWP.ReferenceType.MethodsWithGeneric.MethodInfoJDWP.ReferenceType.MethodsWithGenericdeclared.lengthMethodInfo micreateMethodImpl(...)mi.methodIDmi.namemi.signaturemi.genericSignaturemi.modBitsJDWP.ReferenceType.Methods.MethodInfoJDWP.ReferenceType.Methods/* Utility method used by subclasses to build lists of visible ... */Map<String,Method> mapnew HashMap<String,Method>(...)new HashSet<InterfaceType>(...)ArrayList<Method> retListInterfaceTypeImpl[] intfsprocess(...).interfacesJDWP.ReferenceType.InterfacesList<ReferenceType> allList<ReferenceType> nestedString outernameint outerlen/** Returns a map of field values */JDWP.ReferenceType.GetValues.FieldJDWP.ReferenceType.GetValuesprocess(...).classObjectJDWP.ReferenceType.ClassObjectSDE sdesourceDebugExtensionInfo(...)sourceNames(...)Stratum stratumbaseSourceDir(...)sourcePaths(...)String bsnprocess(...).sourceFileJDWP.ReferenceType.SourceFileString bspint nextIndexcanGetSourceDebugExtension(...)sde.sourceDebugExtensionprocess(...).extensionJDWP.ReferenceType.SourceDebugExtensionnew SoftReference<SDE>(...)availableStrata(...)List<String> strata/** Always returns non-null stratumID */SDE sdeisdei.defaultStratumIdboolean someAbsentAbsentInformationException excboolean somePresentprocess(...).instancesJDWP.ReferenceType.InstancesJDWP.ReferenceType.ClassFileVersionClassFileVersion classFileVersioncanGetClassFileVersion(...)classFileVersion.majorVersionclassFileVersion.minorVersiongetClassFileVersion(...)JDWP.ReferenceType.ConstantPoolConstantPool jdwpCPoolcanGetConstantPool(...)byte[] cpbytesjdwpCPool.countjdwpCPool.bytesgetConstantPoolInfo(...)// static info is fetched twice// Does not need synchronization, since worst-caseprocess(...).modBitsJDWP.ReferenceType.ModifiersJDWP.ClassStatus.PREPAREDdecodeStatus(...)process(...).statusJDWP.ReferenceType.Status/* Return true if an instance of this type ... */this.genericSignatureGottenboolean isPAtheVoidType(...)ClassLoaderReferenceImpl loaderisPrimitiveArray(...)findBootType(...)//Invalidate information previously fetched and cached.//These will be refreshed later on demand.// obsolete method// Fetch all methods for the class, check performance impact// Needs no synchronization now, since methods() returns// unmodifiable local data// Fetch all fields for the class, check performance impact// Needs no synchronization now, since fields() returns/* Note that it is critical that compareTo() == 0 ... */// optimize for typical case: refs equal and VMs equal// sequenceNumbers are always positive/* we might as well get both the signature and the ... */// This gets both the signature and the generic signature// This ref type may have been prepared before we were getting// events, so get it once.  After that,// this status flag is updated through the ClassPrepareEvent,// there is no need for the expense of a JDWP query.// Once true, it never resets, so we don't need to update// Once initialization succeeds or fails, it never resets,// so we don't need to update// identical field from two branches; do nothing/* Maintain two different collections of visible fields. The ... *//* Track fields removed from above collection due to ambiguity *//* Add inherited, visible fields *//* TO DO: Be defensive and check for cyclic interface inheritance *//* Insert fields from this type, removing any inherited fields they ... *//* Continue the recursion only if this type is new *//* Add local fields *//* Add inherited fields *///throw new NoSuchFieldException("Field '" + fieldName + "' not found in " + name());/* Build a collection of all visible methods. The hash ... *//* ... but the hash map destroys order. Methods should be ... *//* The separator is historically '$' but could also be '#' *//* Field must be in this object's class, a superclass, or ... */// Do more validation specific to ReferenceType field getting// Are classObjects unique for an Object, or// created each time? Is this spec'ed?// A method that should have info, didn't// location list// If we retrieved no line info, and at least one of the methods// should have had some (as determined by an// AbsentInformationException being thrown) then we rethrow// the AbsentInformationException.// A method that should have info, did// eliminate native and abstract to eliminate// false positives// Make sure they're all here - the obsolete method// won't be found and so will have index -1// Make sure they're all here/* TO DO: Centralize JNI signature knowledge. ... *//* OTI FIX: Must be a primitive type or the void type */// Must be a reference type.//Work around 4450091// Caller wants type of boot class field// Caller wants type of non-boot class fieldint INIT_SIZE_FILE;int INIT_SIZE_LINE;int INIT_SIZE_STRATUM;String BASE_STRATUM_NAME;String NullString;/* for C capatibility */int fileId;String sourceName;String sourcePath;boolean isConverted;// do not read - use accessor/** Return the sourcePath, computing it if not set. ... */int jplsStart;int jplsEnd;int jplsLineInc;int njplsStart;int njplsEnd;int fileIndex;int lineIndex;int sti;/* stratum index */this.sti/** Return all the sourceNames for this stratum. ... */int fileIndexStart...[...].fileIndexint fileIndexEnd...[...].sourceName/** Return all the sourcePaths for this stratum. ... */int ltistiLineTableIndex(...)new LineStratum(...)int lti;/* line table index */int jplsLine;this.ltithis.jplsLineLineStratum otherother.ltiother.stiother.refTypestiLineNumber(...)/** Fetch the source name and source path for ... */int ftistiFileTableIndex(...)FileTableRecord ftr...[...].fileIdftr.sourceNamegetSourceInfo(...)...[] fileTable;...[] lineTable;...[] stratumTable;int stratumIndex;int currentFileId;int defaultStratumIndex;int baseStratumIndex;int sdePos;/* so as not to match -1 above */String sourceDebugExtension;String jplsFilename;String defaultStratumId;this.sourceDebugExtensioncreateProxyForAbsentSDE(...)lineTable.lengthLineTableRecord[] newTablenew LineTableRecord[]new LineTableRecord(...)fileTable.lengthFileTableRecord[] newTablenew FileTableRecord[]new FileTableRecord(...)stratumTable.lengthStratumTableRecord[] newTablenew StratumTableRecord[]new StratumTableRecord(...)ignoreWhite(...)sdeRead(...)sdePeek(...)stratumTableIndex(...)defaultStratumTableIndex(...)int stinew Stratum(...)StratumTableRecord recrec.id/** *************************** ... */sdeAdvance(...)assureFileTableSize(...)...[...].sourcePathint hasAbsoluteint fileIdString sourceNameString sourcePathreadNumber(...)storeFile(...)assureLineTableSize(...)...[...].jplsStart...[...].jplsEnd...[...].jplsLineInc...[...].njplsStart...[...].njplsEnd/** Parse line translation info.  Syntax is ... */int lineCountint lineIncrementint njplsStartint jplsStartignoreLine(...)storeLine(...)/** Until the next stratum section, everything after this ... */...[...].lineIndexassureStratumTableSize(...)/** The beginning of a stratum's info */storeStratum(...)fileLine(...)lineLine(...)/** Ignore a section we don't know about. *//** A base "Java" stratum is always available, though ... *//** Decode a SourceDebugExtension which is in SourceMap format. ... */createJavaStratum(...)stratumSection(...)fileSection(...)lineSection(...)ignoreSection(...)/** *************** query functions ********************** */int lineIndexStartint lineIndexEndfileTableIndex(...)/* one past end */// already done// check for CR LF// leading white/* check for CR LF *//* leading white *//* acts as boolean *//* is there an absolute filename? *//* is there a fileID? *//* is there a line count? *//* flush the rest *//* remove redundant strata *//* nothing changed overwrite it *//* store the results *//* JPL line numbers cannot exceed 65535 *//* in case they don't declare *//* check for "SMAP" - allow EOF if not ours *//* not our info *//* set end points */short othertheShortType(...)/* An AttachingConnector that uses the SocketTransportService */String ARG_PORT;String ARG_HOST;String defaultHostNamegetHostName(...)/* Create an "address" from the hostname and port connector ... */// for compatibility reasons/* An ListeningConnector that uses the SocketTransportService */String ARG_LOCALADDR;String localaddr// default is wildcard// default to system chosen port/* A transport service based on a TCP connection between the ... *//** The listener returned by startListening encapsulates ... */ServerSocket ss;this.ss/* Returns the string representation of the address that this ... */InetAddress addressgetInetAddress(...)String hostaddrgetHostAddress(...)isAnyLocalAddress(...)UnknownHostException uhebyte[] loopbackgetByAddress(...)UnknownHostException xgetLocalPort(...)/** Handshake with the debuggee */byte[] hellohello.lengthint receivedSocketTimeoutException x/** No-arg constructor *//** The name of this transport service *//** Return localized description of this transport service *//** Return the capabilities of this transport service */new SocketTransportServiceCapabilities(...)/** Attach to the specified address with optional attach and handshake ... */int splitIndexString portStrInetSocketAddress saSocketTimeoutException excIOException xnew TransportTimeoutException(...)handshake(...)new SocketConnection(...)/* Listen on the specified address and port. Return a listener ... */new SocketListenKey(...)/** Listen on the specified address *//** Listen on the default address *//** Stop the listener */socket(...)isClosed(...)/** Accept a connection from a debuggee and handshake with it. *//* The Connection returned by attach and accept is one of these */OutputStream socketOutput;InputStream socketInput;Object receiveLock;Object sendLock;Object closeLock;new ClosedConnectionException(...)/* The capabilities of the socket transport service */TransportService.Capabilities/* If bound to the wildcard address then use current local ... *//* Now decide if we return a hostname or IP address. Where possible ... *//* Finally return "hostname:port", "ipv4-address:port" or ... */// disable read timeout// open TCP connection to VM// handshake with the target VM// use ephemeral port if address isn't specified.// if the ServerSocket has been closed it means// the listener is invalid// obtain the ServerSocket from the listener - if the// socket is closed it means the listener is invalid// from here onwards it's possible that the ServerSocket// may be closed by a call to stopListening - that's okay// because the ServerSocket methods will throw an// IOException indicating the socket is closed.// Additionally, it's possible that another thread calls accept// with a different accept timeout - that creates a same race// condition between setting the timeout and calling accept.// As it is such an unlikely scenario (requires both threads// to be using the same listener we've chosen to ignore the issue).// handshake here// length/* Check the packet size *//* Check that the byte array contains the complete packet *//* Send the packet (ignoring any bytes that follow ... *//* Once false, frame should not be used. ... */Map<String,LocalVariable> visibleVariables;ObjectReference thisObject;/** Return the frame location. ... */validateStackFrame(...)/** Return the thread holding the frame. ... */StackFrameImpl otherother.idMethodImpl currentMethodJDWP.StackFrame.ThisObjectJDWP.StackFramewaitForReply(...).objectThis/** Build the visible variable map. ... */List<LocalVariable> allVariablesvariables(...)Map<String,LocalVariable> mapnew HashMap<String,LocalVariable>(...)LocalVariable existinghides(...)/** Return the list of visible variable in the frame. ... */List<LocalVariable> mapAsListcreateVisibleVariables(...)/** Return a particular variable in the frame. ... */List<LocalVariable> listSlotInfo[] slotsJDWP.StackFrame.GetValues.SlotInfoJDWP.StackFrame.GetValuesMap<LocalVariable,Value> mapnew HashMap<LocalVariable,Value>(...)LocalVariableImpl variablewaitForReply(...).valuesSlotInfo[] slotValsJDWP.StackFrame.SetValues.SlotInfoJDWP.StackFrame.SetValuesMethodImpl mmmList<String> argSigschar sigCharJDWP.StackFrame.PopFramesJDWP.Error.NO_MORE_FRAMESfreeze(...)/* protect against defunct frame id *//* actually get it, now that order is guaranteed */// Validate and convert value if necessary/* actually set it, now that order is guaranteed */// flush caches and disable caching until command completion/* zombie */// enable caching - suspended againthis.sourceNamethis.sourcePathprocess(...).stringValueJDWP.StringReference.ValueJDWP.StringReferenceString ARG_HOME;String ARG_OPTIONS;String ARG_MAIN;String ARG_INIT_SUSPEND;String ARG_VM_EXEC;boolean usingSharedMemory;addBooleanArgument(...)String homeString optionsString mainClassAndArgsboolean waitString exeString exePathListenKey listenKeyRandom rrint failCounttransportService(...)String xrun/** By default this connector uses either the shared memory ... *//* Start listening. ... */// Quote only if necessary in case the quote arg value is bogus// System.err.println("Command: \"" + command + '"');new HashMap<String,Packet>(...)new ArrayList<EventQueue>(...)Map<String,Packet> waitingQueue;boolean shouldListen;List<EventQueue> eventQueues;Thread readerThread;EventController eventController;boolean eventsHeld;int OVERLOADED_QUEUE;/* TO DO: The limit numbers below are somewhat arbitrary and should ... */int UNDERLOADED_QUEUE;this.readerThreadString directionpacket.flagspacket.cmdpacket.cmdSetpacket.data.lengthpacket.idpacket.datapacket.errorCodePacket p2String idStringVirtualMachine.TRACE_SENDSreadPacket(...)fromByteArray(...)VirtualMachineImpl.TRACE_RAW_RECEIVESdumpPacket(...)handleVMCommand(...)notifyCommandComplete(...)p2.errorCodep2.datap2.replieddisposeVirtualMachine(...)vm.vmManagerIterator<EventQueue> iterIterator<Packet> iterPacket packetJDWP.Event.COMMAND_SEThandleEventCmdSet(...)/* Events should not be constructed on this thread (the thread ... */queueEventSet(...)new EventController(...)hold(...)eventController(...)int maxQueueSizecontrolEventFlow(...)VirtualMachineImpl.TRACE_RAW_SENDSwritePacket(...)packet.repliedint controlRequest;int currentRequestJDWP.VirtualMachine.HoldEventsJDWP.VirtualMachineJDWP.VirtualMachine.ReleaseEventsJDWPException e// It's a command/* if(p.errorCode != Packet.ReplyNoError) { ... */// Whoa! a reply without a sender. Problem.// FIX ME! Need to post an error.// inform the VM mamager that this VM is history// close down all the event queues// Closing a queue causes a VMDisconnectEvent to// be put onto the queue.// indirectly throw VMDisconnectedException to// command requesters./* Don't want to terminate the thread, so the ... *//* The name "action" is used to avoid confusion ... */int THREAD_RESUMABLE;/* static final int THREAD_SUSPENDED = 1; */// Event ids// Cached components that cannot changeThreadGroupReference parent;boolean triedParent;JDWP.ThreadGroupReference.Children kids;JDWP.ThreadGroupReference.ChildrenJDWP.ThreadGroupReferenceprocess(...).groupNameJDWP.ThreadGroupReference.Nameprocess(...).parentGroupJDWP.ThreadGroupReference.ParentThreadGroupReference threadGroupChildren kidslocal.kidskids(...).childThreadskids(...)kids(...).childGroups// static info is fetched twice (Thread group name// cannot change)// static info is fetched twice (Thread group parent cannot// change)/* Not needed for current implementation, and hard to implement ... */import BreakpointRequestnew ArrayList<WeakReference<ThreadListener>>(...)int SUSPEND_STATUS_BREAK;int suspendedZombieCount;ThreadGroupReference threadGroup;// This is cached for the life of the thread/* Some objects can only be created while a thread is suspended and are valid ... */// create a new initialized one.// the thread is resumed, we abandon the current cache object and// This is cached only while this one thread is suspended.  Each timeJDWP.ThreadReference.Status status;JDWP.ThreadReference.StatusJDWP.ThreadReferenceList<StackFrame> frames;int framesStart;int framesLength;List<ObjectReference> ownedMonitors;List<MonitorInfo> ownedMonitorsInfo;ObjectReference contendedMonitor;boolean triedCurrentContended;LocalCache localCache;/* The localCache instance var is set by resetLocalCache to an initialized ... */new LocalCache(...)// Yes, someone could change the name of a thread while it is suspended.// This is cached only while all threads in the VM are suspendedList<WeakReference<ThreadListener>> listeners;// Listeners - synchronized on vm.state()resetLocalCache(...)resumingThread(...)processThreadAction(...)new ThreadAction(...)ThreadAction.THREAD_RESUMABLEvmNotSuspended(...)/** Note that we only cache the name string while the entire VM is suspended ... */local.nameprocess(...).threadNameJDWP.ThreadReference.Name/* Sends a command to the back end which is defined to do an ... */JDWP.ThreadReference.SuspendJDWP.ThreadReference.Resumeprocess(...).suspendCountJDWP.ThreadReference.SuspendCountClassTypeImpl throwableClassJDWP.ThreadReference.StopJDWP.ThreadReference.InterruptLocalCache snapshotStatus myStatussnapshot.statusmyStatus.suspendStatusjdwpStatus(...).threadStatusjdwpStatus(...)jdwpStatus(...).suspendStatusList<BreakpointRequest> requestsbreakpointRequests(...)Iterator<BreakpointRequest> iterBreakpointRequest requestIndexOutOfBoundsException iobeprocess(...).groupJDWP.ThreadReference.ThreadGroupsnapshot.frameCountprocess(...).frameCountJDWP.ThreadReference.FrameCountprivateFrames(...)List<StackFrame> list/** Is the requested subrange within what has been retrieved? ... */snapshot.framesStartsnapshot.framesLengthsnapshot.frames/** Private version of frames() allows "-1" to specify all ... */Frame[] jdwpFramesprocess(...).framesJDWP.ThreadReference.FramesjdwpFrames.lengthJDWP.ThreadReference.Frames.Framenew ArrayList<StackFrame>(...)new StackFrameImpl(...)...[...].frameID...[...].locationint fromIndexint toIndexsnapshot.ownedMonitorsprocess(...).ownedJDWP.ThreadReference.OwnedMonitorssnapshot.contendedMonitorsnapshot.triedCurrentContendedprocess(...).monitorJDWP.ThreadReference.CurrentContendedMonitorsnapshot.ownedMonitorsInfomonitor[] minfoJDWP.ThreadReference.OwnedMonitorsStackDepthInfo.monitorJDWP.ThreadReference.OwnedMonitorsStackDepthInfonew ArrayList<MonitorInfo>(...)minfo.lengthmonitor miMonitorInfo monnew MonitorInfoImpl(...)...[...].monitor...[...].stack_depthcanPopFrames(...)StackFrameImpl sfMethodImpl methValueImpl convertedValuegetReturnValueContainer(...)canForceEarlyReturn(...)IndexOutOfBoundsException excJDWP.ThreadReference.ForceEarlyReturnJDWP.Error.OPAQUE_FRAMEJDWP.Error.THREAD_NOT_ALIVEnew WeakReference<ThreadListener>(...)Iterator<WeakReference<ThreadListener>> iterWeakReference<ThreadListener> ref/** Propagate the the thread state change information ... */ThreadListener listenerthreadResumable(...)// all threads are being resumed/* Othewise, only one thread is being resumed: ... */// Don't consider the thread suspended yet. On reply, notifySuspend()// will be called./* If it's a zombie, we can just update internal state without ... *//* If it's a zombie, we maintain the count in the front end. */// Verify that the given object is a Throwable instance// thread is suspended, we can cache the status./* TO DO: This fails to take filters into account. */// no frames on stack => not at breakpoint// Per the javadoc, not suspended => return false/* Thread group can't change, so it's cached once and for all. */// Lock must be held while creating stack frames so if that two threads// do this at the same time, one won't clobber the subset created by the other.// Add to the frame list// Note that interface-wise this functionality belongs// here in ThreadReference, but implementation-wise it// belongs in StackFrame, so we just forward it.// Listener is unreachable; clean up// Discard our local cachethis.modifiersVMModifiers.SYNTHETIC// The generic signature is set when this is created.String myName;Type other/* Copyright (c) 1998, 2005, Oracle and/or its affiliates. All rights reserved. ... */int VM_SUSPENDED;int VM_NOT_SUSPENDED;ThreadReference resumingThread;// the only thread that is being resumed.// For id = VM_NOT_SUSPENDED, if resumingThread != null, then it isthis.resumingThread/* visible to everyone *//* visible only to the defining class *//* visible to subclasses *//* instance variable is static *//* no further subclassing, overriding *//* wrap method call in monitor lock */int BRIDGE;/* can cache in registers *//* Bridge method generated by compiler */int VARARGS;/* not persistant *//* Method accepts var. args *//* implemented in C *//* class is an interface */int ENUM_CONSTANT;/* no definition provided */int SYNTHETIC;/* enum constant field *//* not in source code */new ArrayList<WeakReference<VMListener>>(...)List<WeakReference<VMListener>> listeners;// Listenersboolean notifyingListeners;// synchronized (this)int lastCompletedCommandId;/* Certain information can be cached only when the entire VM is ... */int lastResumeCommandId;List<ThreadGroupReference> groups;List<ThreadReference> threads;// cached Top Level ThreadGroups/** Is the VM currently suspended, for the purpose of caching? ... *//* A JDWP command has been completed (reply has been received). ... */processVMAction(...)new VMAction(...)VMAction.VM_SUSPENDEDthaw(...)/** All threads are resuming *//** Tell listeners to invalidate suspend-sensitive caches. ... */VMAction.VM_NOT_SUSPENDEDIterator<WeakReference<VMListener>> iterWeakReference<VMListener> refVMListener listenerboolean keepvmSuspended(...)new WeakReference<VMListener>(...)List<ThreadReference> threadslocal.threadsprocess(...).threadsJDWP.VirtualMachine.AllThreadsList<ThreadGroupReference> groupslocal.groupsprocess(...).groupsJDWP.VirtualMachine.TopLevelThreadGroups// cached Threads/* No pending resumes to worry about. The VM is suspended ... */// Prevent recursion// may be stale when returned, but not provably so/* This interface allows us to pass fields, variables, and ... */prepareForAssignmentTo(...)// no further checking or conversion necessarynew HashMap<Long,SoftObjectReference>(...)new ReferenceQueue<ObjectReferenceImpl>(...)new ArrayList<SoftObjectReference>(...)new VMState(...)int sizeofFieldRef;// are unique to a given vm// VM Level exported variables, theseint sizeofMethodRef;int sizeofObjectRef;int sizeofClassRef;int sizeofFrameRef;int sequenceNumber;EventQueueImpl eventQueue;EventRequestManagerImpl internalEventRequestManager;EventRequestManagerImpl eventRequestManager;VirtualMachineManagerImpl vmManager;ThreadGroup threadGroupForJDI;// JDI as little as possible when not enabled.// Allow direct access to this field so that that tracing code slows downint TRACE_RAW_SENDS;int TRACE_RAW_RECEIVES;boolean traceReceives;Map<Long,ReferenceType> typesByID;// be set synchronously// tested unsynchronized (since once true, it stays true), but must// Protected by "synchronized(this)". "retrievedAllTypes" may be// ReferenceType access - updated with class prepare and unload events// pre-compute because of frequencyTreeSet<ReferenceType> typesBySignature;boolean retrievedAllTypes;String defaultStratum;// For other languages supportMap<Long,SoftObjectReference> objectsByID;// "objectsByID" protected by "synchronized(this)".// ObjectReference cacheReferenceQueue<ObjectReferenceImpl> referenceQueue;int DISPOSE_THRESHOLD;List<SoftObjectReference> batchedDisposeRequests;JDWP.VirtualMachine.Version versionInfo;JDWP.VirtualMachine.Version// These are cached once for the life of the VMJDWP.VirtualMachine.ClassPaths pathInfo;JDWP.VirtualMachine.ClassPathsJDWP.VirtualMachine.Capabilities capabilities;JDWP.VirtualMachine.CapabilitiesJDWP.VirtualMachine.CapabilitiesNew capabilitiesNew;JDWP.VirtualMachine.CapabilitiesNewBooleanType theBooleanType;// singleton-ness protected by "synchronized(this)".// Per-vm singletons for primitive types and for void.ByteType theByteType;CharType theCharType;ShortType theShortType;IntegerType theIntegerType;LongType theLongType;FloatType theFloatType;DoubleType theDoubleType;VoidType theVoidType;VoidValue voidVal;// Launched debuggee processVMState state;// coordinates state changes and corresponding listener notificationsObject initMonitor;boolean initComplete;boolean shutdown;/* ThreadListener implementation */EventQueueImpl internalEventQueuenew EventQueueImpl(...)JDWP.VirtualMachine.IDSizesIDSizes idSizesEventRequest erthis.vmManagerthis.sequenceNumbermainGroupForJDI(...)new TargetVM(...)new InternalEventHandler(...)new EventRequestManagerImpl(...)idSizes.fieldIDSizeidSizes.methodIDSizeidSizes.objectIDSizeidSizes.referenceTypeIDSizeidSizes.frameIDSizecreateClassUnloadRequest(...)notifyInitCompletion(...)typeNameToSignature(...)validateVM(...)findReferenceTypes(...)retrieveClassesBySignature(...)ArrayList<ReferenceType> aretrieveAllClasses(...)ClassDef[] defsnew ClassDef[]JDWP.VirtualMachine.RedefineClasses.ClassDefJDWP.VirtualMachine.RedefineClassesList<BreakpointRequest> toDeletenew ArrayList<BreakpointRequest>(...)canRedefineClasses(...)Map<>.Entry<?,?>Entry<?,?> entrynew ClassDef(...)JDWP.Error.INVALID_CLASS_FORMATnew ClassFormatError(...)JDWP.Error.CIRCULAR_CLASS_DEFINITIONnew ClassCircularityError(...)JDWP.Error.FAILS_VERIFICATIONnew VerifyError(...)JDWP.Error.UNSUPPORTED_VERSIONnew UnsupportedClassVersionError(...)JDWP.Error.ADD_METHOD_NOT_IMPLEMENTEDJDWP.Error.SCHEMA_CHANGE_NOT_IMPLEMENTEDJDWP.Error.HIERARCHY_CHANGE_NOT_IMPLEMENTEDJDWP.Error.DELETE_METHOD_NOT_IMPLEMENTEDJDWP.Error.CLASS_MODIFIERS_CHANGE_NOT_IMPLEMENTEDJDWP.Error.METHOD_MODIFIERS_CHANGE_NOT_IMPLEMENTEDJDWP.Error.NAMES_DONT_MATCHnew NoClassDefFoundError(...)BreakpointRequest reqReferenceTypeImpl rtinoticeRedefineClass(...)thawCommand(...)/* The VM has been suspended. Additional caching can be done ... */JDWP.VirtualMachine.SuspendJDWP.VirtualMachine.ResumeVMDisconnectedException excprocess(...).stringObjectJDWP.VirtualMachine.CreateStringlong[] retValueReferenceTypeImpl[] rtArraynew ReferenceTypeImpl[]ReferenceType rtiprocess(...).countsJDWP.VirtualMachine.InstanceCountsJDWP.VirtualMachine.DisposeJDWP.VirtualMachine.ExitversionInfo(...).descriptionversionInfo(...)versionInfo(...).vmVersionversionInfo(...).vmNamecapabilities(...).canWatchFieldModificationcapabilities(...).canWatchFieldAccesscapabilities(...).canGetBytecodescapabilities(...).canGetSyntheticAttributecapabilities(...).canGetOwnedMonitorInfocapabilities(...).canGetCurrentContendedMonitorcapabilities(...).canGetMonitorInfoversionInfo(...).jdwpMajorversionInfo(...).jdwpMinorhasNewCapabilities(...)capabilitiesNew(...).canUseInstanceFilterscapabilitiesNew(...)capabilitiesNew(...).canRedefineClassescapabilitiesNew(...).canAddMethodcapabilitiesNew(...).canUnrestrictedlyRedefineClassescapabilitiesNew(...).canPopFramescapabilitiesNew(...).canGetInstanceInfocapabilitiesNew(...).canForceEarlyReturncapabilitiesNew(...).canGetSourceDebugExtensioncapabilitiesNew(...).canGetConstantPoolcapabilitiesNew(...).canRequestVMDeathEventcapabilitiesNew(...).canRequestMonitorEventscapabilitiesNew(...).canGetMonitorFrameInfothis.traceReceivesinitReferenceTypes(...)new InterfaceTypeImpl(...)JDWP.TypeTag.ARRAYnew ArrayTypeImpl(...)setSignature(...)VirtualMachine.TRACE_REFTYPESint matchesnew HashMap<Long,ReferenceType>(...)new TreeSet<ReferenceType>(...)ReferenceTypeImpl retTypeaddReferenceType(...)ClassInfo[] cinfoscinfos.lengthJDWP.VirtualMachine.ClassesBySignature.ClassInfoJDWP.VirtualMachine.ClassesBySignatureClassInfo cici.typeIDci.refTypeTagci.statusJDWP.VirtualMachine.AllClasses.ClassInfoJDWP.VirtualMachine.AllClassesci.signatureretrieveAllClasses1_4(...)JDWP.VirtualMachine.AllClassesWithGeneric.ClassInfoJDWP.VirtualMachine.AllClassesWithGenericci.genericSignatureprocessBatchedDisposes(...)new BooleanTypeImpl(...)new ByteTypeImpl(...)new CharTypeImpl(...)new ShortTypeImpl(...)new IntegerTypeImpl(...)new LongTypeImpl(...)new FloatTypeImpl(...)new DoubleTypeImpl(...)new VoidTypeImpl(...)Request[] requestsJDWP.VirtualMachine.DisposeObjects.RequestJDWP.VirtualMachine.DisposeObjectsnew Request[]SoftObjectReference refcount(...)key(...)new Request(...)new ObjectReferenceImpl(...)Reference<?> refSoftObjectReference softRefremoveObjectMirror(...)batchForDispose(...)ObjectReferenceImpl objectLong keyprocessQueue(...)new ThreadReferenceImpl(...)new StringReferenceImpl(...)new ArrayReferenceImpl(...)new ThreadGroupReferenceImpl(...)new ClassLoaderReferenceImpl(...)new ClassObjectReferenceImpl(...)new SoftObjectReference(...)incrementCount(...)/* Implementation of PathSearchingVirtualMachine */getClasspath(...).classpathsgetClasspath(...)getClasspath(...).bootclasspathsgetClasspath(...).baseDirJDWP.VirtualMachine.SetDefaultStratumLong key;/* If any thread is resumed, the VM is considered not suspended. ... */// Can't use super(this)/* Create ThreadGroup to be used by all threads servicing ... *//* Set up a thread to communicate with the target VM over ... *//* Set up a thread to handle events processed internally ... *//* Initialize client access to event setting and handling *//* Many ids are variably sized, depending on target VM. ... *//** Set up requests needed by internal event handler. ... *//* Tell other threads, notably TargetVM, that initialization ... *//* We no longer need to do this.  The spec now says ... */// flush caches and disable caching until the next suspend// Delete any record of the breakpoints// Invalidate any information cached for the classes just redefined./* If the debugger makes a VMDeathRequest with SUSPEND_ALL, ... *//* No VM validation here. We allow access to the event queue ... */// Need not be synchronized since it is static information/* If a signature was specified, make sure to set it ASAP, to ... *//* There can be multiple classes with the same name. Since ... *//* fix for 4359077 , don't break out. list is no longer sorted ... *//* ...and if there was more than one, re-retrieve the classes ... */// Hold lock during processing to improve performance// and to have safe check/set of retrievedAllTypes// Number of classes/* To save time (assuming the caller will be ... *//* If any object disposes have been batched up, send them now. */// This is kludgy. We temporarily re-create an object// reference so that we can correctly pass its id to the// JDWP command.//if ((traceFlags & TRACE_OBJREFS) != 0) {//    printTrace("Checking for softly reachable objects");// Handle any queue elements that are not strongly reachable/* Attempt to retrieve an existing object object reference *//* If the object wasn't in the table, or it's soft reference was ... *//* If there was no previous entry in the table, we add one here ... *//* If there's a live ObjectReference about, it better be part ... *//* This will remove the soft reference if it has not been ... *//* Public for use by com.sun.jdi.Bootstrap */new ArrayList<Connector>(...)new ArrayList<VirtualMachine>(...)List<Connector> connectors;LaunchingConnector defaultConnector;List<VirtualMachine> targets;ThreadGroup mainGroupForJDI;int vmSequenceNumber;VirtualMachineManagerImpl vmm;JDIPermission vmmPermissionnew JDIPermission(...)new VirtualMachineManagerImpl(...)ThreadGroup topServiceLoader<Connector> connectorLoaderIterator<Connector> connectorsServiceLoader<TransportService> transportLoaderIterator<TransportService> transportServicesList<LaunchingConnector> launcherslaunchingConnectors(...)ThreadDeath xError xaddConnector(...)TransportService transportServiceLaunchingConnector lcsetDefaultConnector(...)List<LaunchingConnector> launchingConnectorsnew ArrayList<LaunchingConnector>(...)List<AttachingConnector> attachingConnectorsnew ArrayList<AttachingConnector>(...)List<ListeningConnector> listeningConnectorsnew ArrayList<ListeningConnector>(...)new VirtualMachineImpl(...)/* Create a top-level thread group *//* Load the connectors *//* Load any transport services and encapsulate them with ... */// no connectors found// Set the default launcher. In order to be compatible// 1.2/1.3/1.4 we try to make the default launcher// "com.sun.jdi.CommandLineLaunch". If this connector// isn't found then we arbitarly pick the first connector.import VirtualMachineManager/** VirtualMachineManager SPI *//** Replaces the default connector. ... *//** Adds a connector to the list of known connectors. ... *//** Removes a connector from the list of known connectors. ... */import javax.script.*/** This is the main class for Java script shell. */new ArrayList<Command>(...)new HashMap<String,ScriptEngine>(...)/** main entry point to the command line tool ... */String[] scriptArgsCommand cmd// by an instance of Command.// Each -e or -f or interactive mode is represented/** Parses and processes command line options. ... */String currentLanguageString currentEncodingboolean seenScriptboolean seenStdincheckClassPath(...)int numScriptArgsint startScriptArgString[] resultScriptEngine segetScriptEngine(...)addFileSource(...)addStringSource(...)addInteractiveMode(...)listScriptEngines(...)/** Adds interactive mode Command ... */setScriptArguments(...)/** Adds script source file Command ... *//** Adds script string source Command ... */String oldFilesetScriptFilename(...)evaluateString(...)/** Prints list of script engines available and exits. */List<ScriptEngineFactory> factoriesgetEngineFactories(...)ScriptEngineFactory factorygetError(...)getLanguageName(...)getLanguageVersion(...)getEngineName(...)getEngineVersion(...)/** Processes a given source file or standard input. ... */getIn(...)boolean hitEOFScriptEngine.FILENAMEString sourceFileNotFoundException fnfeevaluateStream(...)/** Evaluates given script source ... */ScriptException sexp/** Evaluate script string source and exit on script error ... *//** Evaluates script from given reader ... */String oldFilename/** Evaluates given input stream ... */evaluateReader(...)/** Prints usage message and exits ... *//** Gets prompt for interactive mode ... */List<String> names/** Get formatted, localized error message */// input stream from where we will read// stream to print error messages// get current script enginegetEngineByName(...)initScriptEngine(...)// initialize a given script engineList<String> extsgetExtensions(...)InputStream sysInString ext/** Checks for -classpath, -cp in command line args. Creates a ClassLoader ... */String classPathpathToURLs(...)URLClassLoader loadernew URLClassLoader(...)new ScriptEngineManager(...)/** Utility method for converting a search path string to an array ... */String[] componentsfileToURL(...)URL[] tmp/** Returns the directory or JAR file URL corresponding to the specified ... */ScriptEngine.ARGVString oldNameint EXIT_SUCCESS;// exit codesint EXIT_CMD_NO_CLASSPATH;int EXIT_CMD_NO_FILE;int EXIT_CMD_NO_SCRIPT;int EXIT_CMD_NO_LANG;int EXIT_CMD_NO_ENCODING;int EXIT_CMD_NO_PROPNAME;int EXIT_UNKNOWN_OPTION;int EXIT_ENGINE_NOT_FOUND;int EXIT_NO_ENCODING_FOUND;int EXIT_SCRIPT_ERROR;int EXIT_FILE_NOT_FOUND;int EXIT_MULTIPLE_STDIN;String DEFAULT_LANGUAGE;// default scripting languageList<Command> scripts;// list of scripts to processScriptEngineManager engineManager;// the script engine managerMap<String,ScriptEngine> engines;// map of engines we loadedResourceBundle msgRes;// error messages resourceString BUNDLE_NAME;String PROGRAM_NAME;// parse command line options// process each script command// current scripting language selected// current script file encoding selected// check for -classpath or -cp first// have we seen -e or -f ?// have we seen -f - already?// handled already, just continue// collect non-option arguments and pass these as script arguments// if we have seen -e or -f already all non-option arguments// are passed as script arguments// if we have not seen -e or -f, first non-option argument// is treated as script file name and rest of the non-option// arguments are passed to script as script arguments// collect script arguments and return to main// do not allow empty property name// some unknown option...// initialize the engine// to avoid re-initialization of engine, store it in a map// put engine global variable// load init.<ext> file from resource// just -classpath or -cp with no value/* We create a class loader, configure it with specified ... */// now initialize script engine manager. Note that this has to// be done after setting the context loader so that manager// will see script engines from user specified classpath// If the file does not exist, then assume that it's a directory/** The {@code Probe} interface represents a tracepoint. ... *//** Checks whether there is an active trace of this probe. ... *//** Determines whether a tracepoint is enabled. ... */import Targetimport Retentionimport RetentionPolicy/** An annotation used to override the name of a probe. ... */RetentionPolicy.RUNTIMEElementType.METHOD/** {@code Provider} is a superinterface for user-defined tracing providers. ... *//** Retrieves a reference to a Probe object, which is used to check status ... *//** Disposes system resources associated with this provider. ... */import NullProviderFactoryimport PrintStreamProviderFactoryimport MultiplexProviderFactoryimport DTraceProviderFactory/** {@code ProviderFactory} is a factory class used to create instances of ... *//** Creates an implementation of a Provider interface. ... *//** Returns an implementation of a {@code ProviderFactory} which ... */HashSet<ProviderFactory> factoriesnew HashSet<ProviderFactory>(...)new DTraceProviderFactory(...)getPrintStreamFromSpec(...)new PrintStreamProviderFactory(...)new NullProviderFactory(...)new ProviderFactory[]new MultiplexProviderFactory(...)int fieldpos// Try to instantiate a DTraceProviderFactory// Try to instantiate an output stream factory// See how many factories we instantiated, and return an appropriate// factory that encapsulates that.// spec is in the form of <class>.<field>, where <class> is// a fully specified class name, and <field> is a static member// in that class.  The <field> must be a 'PrintStream' or subtype// in order to be used./** An annotation used to specify the name of a provider. ... */ElementType.TYPE/** This annotation describes the interface attributes of the probe arguments in ... *//** This annotation describes the interface's field attributes ... *//** The stability level of the name. *//** The stability level of the data. *//** The interface attribute's dependency class. *//** Enumeration for the DTrace dependency classes. ... */new DependencyClass(...)DependencyClass UNKNOWN;/** The interface has an unknown set of architectural dependencies. */DependencyClass CPU;/** The interface is specific to the CPU model of the current system. */DependencyClass PLATFORM;/** The interface is specific to the hardware platform of the current ... */DependencyClass GROUP;/** The interface is specific to the hardware platform group of the ... */DependencyClass ISA;/** The interface is specific to the instruction set architecture (ISA) ... */DependencyClass COMMON;/** The interface is common to all Solaris systems regardless of the ... */int encoding;/** This annotation describes the interface attributes of the ... *//** An annotation used to specify the {@code function} field for a DTrace probe. ... *//** This annotation is used to describe the interface attributes of the ... *//** An annotation used to specify the {@code module} field for a DTrace probe. ... *//** Enumeration for the DTrace stability levels. ... */new StabilityLevel(...)StabilityLevel INTERNAL;/** The interface is private to DTrace and represents an implementation ... */StabilityLevel PRIVATE;/** The interface is private to Sun for use by other Sun products. It is ... */StabilityLevel OBSOLETE;/** The interface is supported in the current release but is scheduled ... */StabilityLevel EXTERNAL;/** The interface is controlled by an entity other than Sun. */StabilityLevel UNSTABLE;/** The interface gives developers early access to new or ... */StabilityLevel EVOLVING;/** The interface might eventually become Standard or Stable but is ... */StabilityLevel STABLE;/** The interface is a mature interface under Sun's control. */StabilityLevel STANDARD;/** The interface complies with an industry standard. *//** This package contains annotations and enumerations that are used to ... *//** This package provides a mechanism for defining and ... *//** An applet is a small program that is intended not to be run on ... *//** Constructs a new Applet. ... */new HeadlessException(...)AppletStub stub;/** Applets can be serialized but the following conventions MUST be followed: ... *//* version ID for serialized form. *//** Read an applet from an object input stream. ... *//** Sets this applet's stub. This is done automatically by the system. ... */this.stubSecurityManager snew AWTPermission(...)/** Determines if this applet is active. An applet is marked active ... *//** Gets the URL of the document in which this applet is embedded. ... */getDocumentBase(...)/** Gets the base URL. This is the URL of the directory which contains this applet. ... */getCodeBase(...)/** Returns the value of the named parameter in the HTML tag. For ... */getParameter(...)/** Determines this applet's context, which allows the applet to ... */getAppletContext(...)/** Requests that this applet be resized. ... */appletResize(...)/** Indicates if this container is a validate root. ... *//** Requests that the argument string be displayed in the ... */showStatus(...)/** Returns an <code>Image</code> object that can then be painted on ... *//** Get an audio clip from the given URL. ... */new AppletAudioClip(...)/** Returns the <code>AudioClip</code> object specified by the ... */getAudioClip(...)/** Returns information about this applet. An applet should override ... *//** Gets the locale of the applet. It allows the applet ... *//** Returns information about the parameters that are understood by ... *//** Plays the audio clip at the specified absolute URL. Nothing ... */AudioClip clip/** Plays the audio clip given the URL and a specifier that is ... *//** Called by the browser or applet viewer to inform ... */AccessibleContext accessibleContext;// Accessibility support/** Gets the AccessibleContext associated with this Applet. ... */new AccessibleApplet(...)/** This class implements accessibility support for the ... */AccessibleRole.FRAMEAccessibleState.ACTIVE/* Copyright (c) 1995, 2013, Oracle and/or its affiliates. All rights reserved. ... */// If stub field not filled in, applet never active/** This interface corresponds to an applet's environment: the ... *//** Creates an audio clip. ... *//** Finds and returns the applet in the document represented by this ... *//** Finds all the applets in the document represented by this applet ... *//** Requests that the browser or applet viewer show the Web page ... *//** Associates the specified stream with the specified key in this ... *//** Returns the stream to which specified key is associated within this ... *//** Finds all the keys of the streams in this applet context. ... *//** When an applet is first created, an applet stub is attached to it ... *//** Determines if the applet is active. An applet is active just ... *//** Gets the URL of the document in which the applet is embedded. ... *//** Gets the base URL. This is the URL of the directory which contains the applet. ... *//** Returns the applet's context. ... *//** Called when the applet wants to be resized. ... *//** The <code>AudioClip</code> interface is a simple abstraction for ... *//** Starts playing this audio clip. Each time this method is called, ... *//** Starts playing this audio clip in a loop. *//** Stops playing this audio clip. *//* Copyright (c) 1995, 1997, Oracle and/or its affiliates. All rights reserved. ... *//** Thrown when a serious Abstract Window Toolkit error has occurred. ... *//* JDK 1.1 serialVersionUID *//** Constructs an instance of <code>AWTError</code> with the specified ... */import ComponentPeerimport LightweightPeer/** The root event class for all AWT events. ... */setAWTEventAccessor(...)AWTAccessor.AWTEventAccessorev.isPostedev.isSystemGeneratedgetAccessControlContext(...)ev.bdata...[] bdata;/** The event's id. ... */boolean consumed;/** Controls whether or not the event is sent back down to the peer once the ... *//* The event's AccessControlContext. *//* Returns the acc this event was constructed with. */boolean focusManagerIsDispatching;boolean isPosted;boolean isSystemGenerated;/** Indicates whether this AWTEvent was generated by the system as ... */long COMPONENT_EVENT_MASK;/** The event mask for selecting component events. */long CONTAINER_EVENT_MASK;/** The event mask for selecting container events. */long FOCUS_EVENT_MASK;/** The event mask for selecting focus events. */long KEY_EVENT_MASK;/** The event mask for selecting key events. */long MOUSE_EVENT_MASK;/** The event mask for selecting mouse events. */long MOUSE_MOTION_EVENT_MASK;/** The event mask for selecting mouse motion events. */long WINDOW_EVENT_MASK;/** The event mask for selecting window events. */long ACTION_EVENT_MASK;/** The event mask for selecting action events. */long ADJUSTMENT_EVENT_MASK;/** The event mask for selecting adjustment events. */long ITEM_EVENT_MASK;/** The event mask for selecting item events. */long TEXT_EVENT_MASK;/** The event mask for selecting text events. */long INPUT_METHOD_EVENT_MASK;/** The event mask for selecting input method events. */long INPUT_METHODS_ENABLED_MASK;/** The pseudo event mask for enabling input methods. ... */long PAINT_EVENT_MASK;/** The event mask for selecting paint events. */long INVOCATION_EVENT_MASK;/** The event mask for selecting invocation events. */long HIERARCHY_EVENT_MASK;/** The event mask for selecting hierarchy events. */long HIERARCHY_BOUNDS_EVENT_MASK;/** The event mask for selecting hierarchy bounds events. */long MOUSE_WHEEL_EVENT_MASK;/** The event mask for selecting mouse wheel events. ... */long WINDOW_STATE_EVENT_MASK;/** The event mask for selecting window state events. ... */long WINDOW_FOCUS_EVENT_MASK;/** The event mask for selecting window focus events. ... */int RESERVED_ID_MAX;/** The maximum value for reserved AWT event IDs. Programs defining ... *//** WARNING: there are more mask defined privately.  See ... */Field inputEvent_CanAccessSystemClipboard_Field;// security stuffgetDeclaredField(...)PlatformLogger.Level.FINEPlatformLogger.Level/** Initialize JNI field and method IDs for fields that may be ... *//** Constructs an AWTEvent object from the parameters of a 1.0-style event. ... */event.targetevent.id/** Constructs an AWTEvent object with the specified source object and type. ... */AdjustmentEvent.ADJUSTMENT_VALUE_CHANGEDTextEvent.TEXT_VALUE_CHANGED/** Retargets an event to a new source. This method is typically used to ... */comp.peercomp.parentComponentPeer peernativeSetSource(...)/** Returns the event type. *//** Returns a String representation of this object. */String srcNameparamString(...)/** Returns a string representing the state of this <code>Event</code>. ... *//** Consumes this event, if this event can be consumed. Only low-level, ... */MouseEvent.MOUSE_WHEELInputMethodEvent.INPUT_METHOD_TEXT_CHANGEDInputMethodEvent.CARET_POSITION_CHANGED/** Returns whether this event has been consumed. *//** Converts a new event to an old one (used for compatibility). ... */Object srcint newidKeyEvent keint keyCodeMouseEvent meEvent oldenew Event(...)InputEvent.BUTTON1_MASKActionEvent aeItemEvent ieAdjustmentEvent ajeisActionKey(...)Event.KEY_ACTIONEvent.KEY_ACTION_RELEASEKeyEvent.VK_SHIFTKeyEvent.VK_CONTROLgetOldEventKey(...)olde.clickCountWindowEvent.WINDOW_CLOSINGWindowEvent.WINDOW_ICONIFIEDWindowEvent.WINDOW_DEICONIFIEDComponentEvent.COMPONENT_MOVEDEvent.WINDOW_MOVEDgetActionCommand(...)Event.LIST_DESELECTgetStateChange(...)ItemEvent.SELECTEDgetItem(...)getAdjustmentType(...)AdjustmentEvent.UNIT_INCREMENTEvent.SCROLL_LINE_DOWNAdjustmentEvent.UNIT_DECREMENTAdjustmentEvent.BLOCK_INCREMENTEvent.SCROLL_PAGE_DOWNAdjustmentEvent.BLOCK_DECREMENTEvent.SCROLL_PAGE_UPAdjustmentEvent.TRACKEvent.SCROLL_ABSOLUTEEvent.SCROLL_END/** Copies all private data from this event into that. ... */that.bdatathis.bdataget_InputEvent_CanAccessSystemClipboard(...)setBoolean(...)that.isSystemGeneratedthis.isSystemGenerated/* ensure that the necessary native libraries are loaded */// event type cannot be consumed// suppress modifier keys in old event model.// no mask for button1 existed in old Event - strip it out// Checkbox// Copy canAccessSystemClipboard value from this into that.// class AWTEvent/** {@code AWTEventMulticaster} implements efficient and thread-safe multi-cast ... */EventListener a, ...;/** Creates an event multicaster instance which chains listener-a ... */this.athis.b/** Removes a listener from this multicaster. ... */EventListener a2EventListener b2/** Handles the componentResized event by invoking the ... *//** Handles the componentMoved event by invoking the ... *//** Handles the componentShown event by invoking the ... *//** Handles the componentHidden event by invoking the ... *//** Handles the componentAdded container event by invoking the ... *//** Handles the componentRemoved container event by invoking the ... *//** Handles the focusGained event by invoking the ... *//** Handles the focusLost event by invoking the ... *//** Handles the keyTyped event by invoking the ... *//** Handles the keyPressed event by invoking the ... *//** Handles the keyReleased event by invoking the ... *//** Handles the mouseClicked event by invoking the ... *//** Handles the mousePressed event by invoking the ... *//** Handles the mouseReleased event by invoking the ... *//** Handles the mouseEntered event by invoking the ... *//** Handles the mouseExited event by invoking the ... *//** Handles the mouseDragged event by invoking the ... *//** Handles the mouseMoved event by invoking the ... *//** Handles the windowOpened event by invoking the ... *//** Handles the windowClosing event by invoking the ... *//** Handles the windowClosed event by invoking the ... *//** Handles the windowIconified event by invoking the ... *//** Handles the windowDeiconfied event by invoking the ... *//** Handles the windowActivated event by invoking the ... *//** Handles the windowDeactivated event by invoking the ... *//** Handles the windowStateChanged event by invoking the ... */windowStateChanged(...)/** Handles the windowGainedFocus event by invoking the windowGainedFocus ... */windowGainedFocus(...)/** Handles the windowLostFocus event by invoking the windowLostFocus ... */windowLostFocus(...)/** Handles the actionPerformed event by invoking the ... *//** Handles the itemStateChanged event by invoking the ... *//** Handles the adjustmentValueChanged event by invoking the ... *//** Handles the inputMethodTextChanged event by invoking the ... */inputMethodTextChanged(...)/** Handles the caretPositionChanged event by invoking the ... */caretPositionChanged(...)/** Handles the hierarchyChanged event by invoking the ... */hierarchyChanged(...)/** Handles the ancestorMoved event by invoking the ... *//** Handles the ancestorResized event by invoking the ... */ancestorResized(...)/** Handles the mouseWheelMoved event by invoking the ... */mouseWheelMoved(...)/** Adds component-listener-a with component-listener-b and ... *//** Adds container-listener-a with container-listener-b and ... *//** Adds focus-listener-a with focus-listener-b and ... *//** Adds key-listener-a with key-listener-b and ... *//** Adds mouse-listener-a with mouse-listener-b and ... *//** Adds mouse-motion-listener-a with mouse-motion-listener-b and ... *//** Adds window-listener-a with window-listener-b and ... *//** Adds window-state-listener-a with window-state-listener-b ... *//** Adds window-focus-listener-a with window-focus-listener-b ... *//** Adds action-listener-a with action-listener-b and ... *//** Adds item-listener-a with item-listener-b and ... *//** Adds adjustment-listener-a with adjustment-listener-b and ... *//** Adds input-method-listener-a with input-method-listener-b and ... *//** Adds hierarchy-listener-a with hierarchy-listener-b and ... *//** Adds hierarchy-bounds-listener-a with hierarchy-bounds-listener-b and ... *//** Adds mouse-wheel-listener-a with mouse-wheel-listener-b and ... *//** Removes the old component-listener from component-listener-l and ... *//** Removes the old container-listener from container-listener-l and ... *//** Removes the old focus-listener from focus-listener-l and ... *//** Removes the old key-listener from key-listener-l and ... *//** Removes the old mouse-listener from mouse-listener-l and ... *//** Removes the old mouse-motion-listener from mouse-motion-listener-l ... *//** Removes the old window-listener from window-listener-l and ... *//** Removes the old window-state-listener from window-state-listener-l ... *//** Removes the old window-focus-listener from window-focus-listener-l ... *//** Removes the old action-listener from action-listener-l and ... *//** Removes the old item-listener from item-listener-l and ... *//** Removes the old adjustment-listener from adjustment-listener-l and ... *//** Removes the old input-method-listener from input-method-listener-l and ... *//** Removes the old hierarchy-listener from hierarchy-listener-l and ... *//** Removes the old hierarchy-bounds-listener from ... *//** Removes the old mouse-wheel-listener from mouse-wheel-listener-l ... *//** Returns the resulting multicast listener from adding listener-a ... */new AWTEventMulticaster(...)/** Returns the resulting multicast listener after removing the ... *//* Serialization support. */saveInternal(...)/* Recursive method which returns a count of the number of listeners in ... */AWTEventMulticaster mcmc.amc.b/* Recusive method which populates EventListener array a with EventListeners ... */int lhspopulateListenerArray(...)/** Returns an array of all the objects chained as ... */T[] result// Only count listeners of correct type// Skip nulls, instances of wrong class/** Signals that an Abstract Window Toolkit exception has occurred. ... *//** Constructs an instance of <code>AWTException</code> with the ... *//** An <code>AWTKeyStroke</code> represents a key action on the ... */KeyEvent.CHAR_UNDEFINEDKeyEvent.VK_UNDEFINEDnew AWTKeyStroke(...)Map<String,Integer> modifierKeywords;VKCollection vks;/** Associates VK_XXX (as a String) with code (as Integer). This is ... */Object APP_CONTEXT_CACHE_KEY;//A key for the collection of AWTKeyStrokes within AppContext.AWTKeyStroke APP_CONTEXT_KEYSTROKE_KEY;//A key withing the cache/* Reads keystroke class from AppContext and if null, puts there the ... */Class<AWTKeyStroke> clazzchar keyChar;int keyCode;boolean onKeyRelease;/** Constructs an <code>AWTKeyStroke</code> with default values. ... *//** Constructs an <code>AWTKeyStroke</code> with the specified ... */this.keyCharthis.keyCodethis.onKeyRelease/** Registers a new class which the factory methods in ... */Constructor<> ctorgetCtor(...)String couldNotInstantiateClass<AWTKeyStroke> keyStrokeClassAWTKeyStroke strokeNoSuchMethodError eExceptionInInitializerError e/* returns noarg Constructor for class with accessible flag. No security ... */Map<AWTKeyStroke,AWTKeyStroke> cacheAWTKeyStroke cacheKeynew HashMap<AWTKeyStroke,AWTKeyStroke>(...)getAWTKeyStrokeClass(...)cacheKey.keyCharcacheKey.keyCodecacheKey.modifiersmapNewModifiers(...)mapOldModifiers(...)cacheKey.onKeyRelease/** Returns a shared instance of an <code>AWTKeyStroke</code> ... */getCachedStroke(...)/** Returns a shared instance of an {@code AWTKeyStroke} ... *//** Returns a shared instance of an <code>AWTKeyStroke</code>, ... *//** Returns an <code>AWTKeyStroke</code> which represents the ... */KeyEvent.KEY_TYPEDgetKeyChar(...)/** Parses a string and returns an <code>AWTKeyStroke</code>. ... */String errmsgboolean releasedboolean typedMap<String,Integer> uninitializedMapInputEvent.SHIFT_DOWN_MASKInputEvent.CTRL_DOWN_MASKInputEvent.META_DOWN_MASKInputEvent.META_MASKInputEvent.ALT_DOWN_MASKInputEvent.ALT_MASKInputEvent.ALT_GRAPH_DOWN_MASKInputEvent.ALT_GRAPH_MASKInputEvent.BUTTON1_DOWN_MASKInputEvent.BUTTON2_DOWN_MASKInputEvent.BUTTON3_DOWN_MASKInteger tokenMaskString keyCodeNamegetVKValue(...)new VKCollection(...)/** Returns the integer constant for the KeyEvent.VK field named ... */VKCollection vkCollectgetVKCollection(...)Integer valuefindCode(...)NoSuchFieldException nsfe/** Returns the character for this <code>AWTKeyStroke</code>. ... *//** Returns the numeric key code for this <code>AWTKeyStroke</code>. ... *//** Returns the modifier keys for this <code>AWTKeyStroke</code>. ... *//** Returns whether this <code>AWTKeyStroke</code> represents a key release. ... *//** Returns the type of <code>KeyEvent</code> which corresponds to ... *//** Returns a numeric value for this object that is likely to be unique, ... *//** Returns true if this object is identical to the specified object. ... */AWTKeyStroke ksks.keyCharks.keyCodeks.onKeyReleaseks.modifiers/** Returns a string that displays and identifies this object's properties. ... */getModifiersText(...)getVKText(...)findName(...)int expected_modifiersModifier.FINALField[] fields/** Returns a cached instance of <code>AWTKeyStroke</code> (or a subclass of ... */Map<Integer,String> code2name;Map<String,Integer> name2code;new HashMap<Integer,String>(...)// Already registered// Invalid ID for this KeyEvent/** This class is for AWT permissions. ... *//** use serialVersionUID from the Java 2 platform for interoperability *//** Creates a new <code>AWTPermission</code> with the specified name. ... *//** Creates a new <code>AWTPermission</code> object with the specified name. ... *//** An interface for events that know how to dispatch themselves. ... *//** Dispatch the event to its target, listeners of the events source, ... */import Native/** The interface for objects which have an adjustable numeric value ... */int HORIZONTAL;/** Indicates that the <code>Adjustable</code> has horizontal orientation. */int VERTICAL;/** Indicates that the <code>Adjustable</code> has vertical orientation. */int NO_ORIENTATION;/** Indicates that the <code>Adjustable</code> has no orientation. *//** Gets the orientation of the adjustable object. ... *//** Sets the minimum value of the adjustable object. ... *//** Gets the minimum value of the adjustable object. ... *//** Sets the maximum value of the adjustable object. ... *//** Gets the maximum value of the adjustable object. ... *//** Sets the unit value increment for the adjustable object. ... *//** Gets the unit value increment for the adjustable object. ... *//** Sets the block value increment for the adjustable object. ... *//** Gets the block value increment for the adjustable object. ... *//** Sets the length of the proportional indicator of the ... *//** Gets the length of the proportional indicator. ... *//** Sets the current value of the adjustable object. If ... *//** Gets the current value of the adjustable object. ... *//** Adds a listener to receive adjustment events when the value of ... *//** Removes an adjustment listener. ... */import SunCompositeContext/** The <code>AlphaComposite</code> class implements basic alpha ... */new AlphaComposite(...)int CLEAR;/** Both the color and the alpha of the destination are cleared ... */int SRC;/** The source is copied to the destination ... */int DST;/** The destination is left untouched ... */int SRC_OVER;/** The source is composited over the destination ... */// Note that DST was added in 1.4 so it is numbered out of order...int DST_OVER;/** The destination is composited over the source and ... */int SRC_IN;/** The part of the source lying inside of the destination replaces ... */int DST_IN;/** The part of the destination lying inside of the source ... */int SRC_OUT;/** The part of the source lying outside of the destination ... */int DST_OUT;/** The part of the destination lying outside of the source ... */int SRC_ATOP;/** The part of the source lying inside of the destination ... */// public static final int  DST             = 9;// list logically, rather than numerically// Rule 9 is DST which is defined above where it fits into theint DST_ATOP;/** The part of the source that lies outside of the destination ... */AlphaComposite Clear;/** <code>AlphaComposite</code> object that implements the opaque CLEAR rule ... */AlphaComposite Src;/** <code>AlphaComposite</code> object that implements the opaque SRC rule ... */AlphaComposite Dst;/** <code>AlphaComposite</code> object that implements the opaque DST rule ... */AlphaComposite SrcOver;/** <code>AlphaComposite</code> object that implements the opaque SRC_OVER rule ... */AlphaComposite DstOver;/** <code>AlphaComposite</code> object that implements the opaque DST_OVER rule ... */AlphaComposite SrcIn;/** <code>AlphaComposite</code> object that implements the opaque SRC_IN rule ... */AlphaComposite DstIn;/** <code>AlphaComposite</code> object that implements the opaque DST_IN rule ... */AlphaComposite SrcOut;/** <code>AlphaComposite</code> object that implements the opaque SRC_OUT rule ... */AlphaComposite DstOut;/** <code>AlphaComposite</code> object that implements the opaque DST_OUT rule ... */AlphaComposite SrcAtop;/** <code>AlphaComposite</code> object that implements the opaque SRC_ATOP rule ... */AlphaComposite DstAtop;/** <code>AlphaComposite</code> object that implements the opaque DST_ATOP rule ... */AlphaComposite Xor;/** <code>AlphaComposite</code> object that implements the opaque XOR rule ... */int MIN_RULE;int MAX_RULE;float extraAlpha;int rule;this.rulethis.extraAlpha/** Creates an <code>AlphaComposite</code> object with the specified rule. ... *//** Creates an <code>AlphaComposite</code> object with the specified rule and ... *//** Creates a context for the compositing operation. ... */new SunCompositeContext(...)/** Returns the alpha value of this <code>AlphaComposite</code>.  If this ... *//** Returns the compositing rule of this <code>AlphaComposite</code>. ... *//** Returns a similar <code>AlphaComposite</code> object that uses ... *//** Returns the hashcode for this composite. ... *//** Determines whether the specified object is equal to this ... */ac.ruleac.extraAlphaPlatformLogger.Level.FINESTPlatformLogger.Level.FINER// index.// This hashCode is used by the sun.awt implementation as an arrayimport ConstructorProperties/** The <code>BasicStroke</code> class defines a basic set of rendering ... */int JOIN_MITER;/** Joins path segments by extending their outside edges until ... */int JOIN_ROUND;/** Joins path segments by rounding off the corner at a radius ... */int JOIN_BEVEL;/** Joins path segments by connecting the outer corners of their ... */int CAP_BUTT;/** Ends unclosed subpaths and dash segments with no added ... */int CAP_ROUND;/** Ends unclosed subpaths and dash segments with a round ... */int CAP_SQUARE;/** Ends unclosed subpaths and dash segments with a square ... */float width;int join;float miterlimit;...[] dash;float dash_phase;/** Constructs a new <code>BasicStroke</code> with the specified ... */boolean allzerodash.lengthfloat dthis.jointhis.miterlimitthis.dashthis.dash_phase/** Constructs a solid <code>BasicStroke</code> with the specified ... *//** Constructs a new <code>BasicStroke</code> with defaults for all ... *//** Returns a <code>Shape</code> whose interior defines the ... */RenderingEngine recreateStrokedShape(...)/** Returns the line width.  Line width is represented in user space, ... *//** Returns the end cap style. ... *//** Returns the line join style. ... *//** Returns the limit of miter joins. ... *//** Returns the array representing the lengths of the dash segments. ... *//** Returns the current dash phase. ... *//** Returns the hashcode for this stroke. ... *//** Tests if a specified object is equal to this <code>BasicStroke</code> ... *//** Returns true if this BasicStroke represents the same ... */BasicStroke bsbs.widthbs.joinbs.capbs.miterlimitbs.dash_phasebs.dash/** A border layout lays out a container, arranging and resizing ... */int hgap;/** Constructs a border layout with the horizontal gaps ... */int vgap;/** Constructs a border layout with the vertical gaps ... */Component north;/** Constant to specify components location to be the ... */Component west;Component east;Component south;Component center;Component firstLine;/** A relative positioning constant, that can be used instead of ... */Component lastLine;Component firstItem;Component lastItem;String NORTH;/** The north layout constraint (top of container). */String SOUTH;/** The south layout constraint (bottom of container). */String EAST;/** The east layout constraint (right side of container). */String WEST;/** The west layout constraint (left side of container). */String CENTER;/** The center layout constraint (middle of container). */String BEFORE_FIRST_LINE;/** Synonym for PAGE_START.  Exists for compatibility with previous ... */String AFTER_LAST_LINE;/** Synonym for PAGE_END.  Exists for compatibility with previous ... */String BEFORE_LINE_BEGINS;/** Synonym for LINE_START.  Exists for compatibility with previous ... */String AFTER_LINE_ENDS;/** Synonym for LINE_END.  Exists for compatibility with previous ... */String PAGE_START;/** The component comes before the first line of the layout's content. ... */String PAGE_END;/** The component comes after the last line of the layout's content. ... */String LINE_START;/** The component goes at the beginning of the line direction for the ... */String LINE_END;/** The component goes at the end of the line direction for the ... *//** Constructs a new border layout with ... *//** Constructs a border layout with the specified gaps ... */this.hgapthis.vgap/** Returns the horizontal gap between components. ... *//** Sets the horizontal gap between components. ... *//** Returns the vertical gap between components. ... *//** Sets the vertical gap between components. ... *//** Adds the specified component to the layout, using the specified ... */getTreeLock(...)addLayoutComponent(...)/** Removes the specified component from this border layout. This ... *//** Gets the component that was added using the given constraint ... *//** Returns the component that corresponds to the given constraint location ... */Component result/** Gets the constraints for the specified component ... *//** Determines the minimum size of the <code>target</code> container ... *//** Determines the preferred size of the <code>target</code> ... *//** Returns the maximum dimensions for this layout given the components ... *//** Returns the alignment along the x axis.  This specifies how ... *//** Returns the alignment along the y axis.  This specifies how ... *//** Invalidates the layout, indicating that if the layout manager ... *//** Lays out the container argument using this border layout. ... */target.heighttarget.widthc.heightc.width/** Get the component that corresponds to the given constraint location ... */result.visible/** Returns a string representation of the state of this border layout. ... *//* Special case:  treat null the same as "Center". *//* Assign the component to one of the known regions of the layout. *///fix for 6242148 : API method java.awt.BorderLayout.getConstraints(null) should return null/** Capabilities and properties of buffers. ... */ImageCapabilities frontCaps;ImageCapabilities backCaps;FlipContents flipContents;/** Creates a new object for specifying buffering capabilities ... */this.frontCapsthis.backCapsthis.flipContentsgetFlipContents(...)/** A type-safe enumeration of the possible back buffer contents after ... */// Inner class FlipContentsnew FlipContents(...)int I_UNDEFINED;int I_BACKGROUND;int I_PRIOR;int I_COPIED;...[] NAMES;FlipContents UNDEFINED;/** When flip contents are <code>UNDEFINED</code>, the ... */FlipContents BACKGROUND;/** When flip contents are <code>BACKGROUND</code>, the ... */FlipContents PRIOR;/** When flip contents are <code>PRIOR</code>, the ... */FlipContents COPIED;/** When flip contents are <code>COPIED</code>, the ... */// Since we implement Cloneable, this should never happenimport ButtonPeer/** This class creates a labeled button. The application can cause ... *//** The button's label.  This value may be null. ... */String actionCommand;/** The action to be performed once a button has been ... */String base;int nameCounter;/** Constructs a button with an empty string for its label. ... *//** Constructs a button with the specified label. ... */checkHeadless(...)/** Construct a name for this component.  Called by getName() when the ... *//** Creates the peer of the button.  The button's peer allows the ... */createButton(...)getToolkit(...)addNotify(...)/** Gets the label of this button. ... *//** Sets the button's label to be the specified string. ... */boolean testvalidButtonPeer peerthis.peerinvalidateIfValid(...)/** Sets the command name for the action event fired ... *//** Returns the command name of the action event fired by this button. ... *//** Adds the specified action listener to receive action events from ... *//** Removes the specified action listener so that it no longer ... *//** Returns an array of all the action listeners ... */getListeners(...)/** Returns an array of all the objects currently registered ... */EventListener l// REMIND: remove when filtering is done at lower levele.idAWTEvent.ACTION_EVENT_MASKeventEnabled(...)/** Processes events on this button. If an event is ... */processActionEvent(...)/** Processes action events occurring on this button ... */ActionListener listener/** Returns a string representing the state of this <code>Button</code>. ... */int buttonSerializedDataVersion;/* Button Serial Data Version. ... *//** Writes default serializable fields to stream.  Writes ... *//** Reads the <code>ObjectInputStream</code> and if ... */Object keyOrNull/** Gets the <code>AccessibleContext</code> associated with ... */new AccessibleAWTButton(...)/* JDK 1.3 serialVersionUID */getAccessibleName(...)/** Get the AccessibleAction associated with this object.  In the ... *//** Get the AccessibleValue associated with this object.  In the ... *//** Returns the number of Actions available in this object.  The ... *//** Return a description of the specified action of the object. ... *//** Perform the specified Action on the object ... */getEventQueue(...)Button.this/** Get the value of this object as a Number. ... *//** Set the value of this object as a Number. ... *//** Get the minimum value of this object as a Number. ... *//** Get the maximum value of this object as a Number. ... */// This could change the preferred size of the Component.// skip value for unrecognized key// [[[PENDING:  WDW -- need to provide a localized string]]]// Simulate a button click// inner class AccessibleAWTButtonimport BufferStrategyimport CanvasPeer/** A <code>Canvas</code> component represents a blank rectangular ... *//** Constructs a new Canvas. *//** Constructs a new Canvas given a GraphicsConfiguration object. ... */setGraphicsConfiguration(...)CanvasPeer peergetPeer(...)getAppropriateGraphicsConfiguration(...)/** Creates the peer of the canvas.  This peer allows you to change the ... */createCanvas(...)/** Paints this canvas. ... */clearRect(...)/** Updates this canvas. ... *//** Creates a new strategy for multi-buffering on this component. ... */createBufferStrategy(...)/** Creates a new strategy for multi-buffering on this component with the ... *//** Returns the <code>BufferStrategy</code> used by this component.  This ... */getBufferStrategy(...)/** Gets the AccessibleContext associated with this Canvas. ... *//* --- Accessibility Support --- */new AccessibleAWTCanvas(...)AccessibleRole.CANVAS/* Copyright (c) 1995, 2010, Oracle and/or its affiliates. All rights reserved. ... */// inner class AccessibleAWTCanvasimport ObjectStreamField/** A <code>CardLayout</code> object is a layout manager for a ... */new Vector<Card>(...)new ObjectStreamField[]new ObjectStreamField(...)Hashtable<>.classVector<>.classVector<Card> vector;/* This creates a Vector to store associated ... *//* A pair of Component and String that represents its name. */Component comp;int currentCard;/* Index of Component currently displayed by CardLayout. *//* A cards horizontal Layout gap (inset). It specifies ... *//* A cards vertical Layout gap (inset). It specifies ... */...[] serialPersistentFields;/** @serialField ... *//** Creates a new card layout with gaps of size zero. *//** Creates a new card layout with the specified horizontal and ... *//** Gets the horizontal gap between components. ... *//** Gets the vertical gap between components. ... *//** Adds the specified component to this card layout's internal ... */(...).compnew Card(...)/** Removes the specified component from the layout. ... *//** Determines the preferred size of the container argument using ... *//** Calculates the minimum size for the specified panel. ... *//** Lays out the specified container using this card layout. ... */boolean currentFoundparent.widthparent.height/** Make sure that the Container really has a CardLayout installed. ... *//** Flips to the first card of the container. ... */checkLayout(...)/** Flips to the next card of the specified container. If the ... */showDefaultComponent(...)/** Flips to the previous card of the specified container. If the ... *//** Flips to the last card of the container. ... *//** Flips to the component that was added to this layout with the ... */Component nextCard cardcard.namecard.comp/** Returns a string representation of the state of this card layout. ... *//** Reads serializable fields from stream. */ObjectInputStream.GetFieldGetField freadFields(...)defaulted(...)Hashtable<String,Component> tab/** Writes serializable fields to stream. */new Hashtable<String,Component>(...)ObjectOutputStream.PutFieldPutField fputFields(...)writeFields(...)// if we remove current component we should show next one// correct currentCard if this is necessary//  pre-1.4 streamimport CheckboxPeer/** A check box is a graphical component that can be in either an ... *//** The label of the Checkbox. ... */boolean state;/** The state of the <code>Checkbox</code>. ... */CheckboxGroup group;/** The check box group. ... *//** Helper function for setState and CheckboxGroup.setSelectedCheckbox ... */CheckboxPeer peer/** Creates a check box with an empty string for its label. ... *//** Creates a check box with the specified label.  The state ... *//** Creates a check box with the specified label ... *//** Constructs a Checkbox with the specified label, set to the ... */this.groupsetSelectedCheckbox(...)/** Creates a check box with the specified label, in the specified ... *//** Constructs a name for this component.  Called by ... *//** Creates the peer of the Checkbox. The peer allows you to change the ... */createCheckbox(...)/** Gets the label of this check box. ... *//** Sets this check box's label to be the string argument. ... *//** Determines whether this check box is in the "on" or "off" state. ... *//** Sets the state of this check box to the specified state. ... */CheckboxGroup groupgetSelectedCheckbox(...)setStateInternal(...)/** Returns an array (length 1) containing the checkbox ... */Object[] items/** Determines this check box's group. ... *//** Sets this check box's group to the specified check box group. ... */CheckboxGroup oldGroupboolean oldStatesetCheckboxGroup(...)/** Adds the specified item listener to receive item events from ... *//** Removes the specified item listener so that the item listener ... *//** Returns an array of all the item listeners ... */AWTEvent.ITEM_EVENT_MASK/** Processes events on this check box. ... */processItemEvent(...)/** Processes item events occurring on this check box by ... */ItemListener listener/** Returns a string representing the state of this <code>Checkbox</code>. ... */int checkboxSerializedDataVersion;/* Serialized data version ... *//** Reads the <code>ObjectInputStream</code> and if it ... */addItemListener(...)/** Initialize JNI field and method ids *//** Gets the AccessibleContext associated with this Checkbox. ... */new AccessibleAWTCheckbox(...)Checkbox.this/** Fire accessible property change events when the state of the ... */Checkbox cbCheckbox.this.accessibleContextAccessibleContext.ACCESSIBLE_STATE_PROPERTY/** Returns the number of Actions available in this object. ... *//** Get the value of this object as a Number.  If the value has not been ... *//** Get the state set of this object. ... *//* Cannot hold check box lock when calling group.setSelectedCheckbox. *//* Do nothing if this check box has already belonged ... *//* Locking check box below could cause deadlock with ... *///  To be fully implemented in a future release// inner class AccessibleAWTCheckbox/** The <code>CheckboxGroup</code> class is used to group together ... */Checkbox selectedCheckbox;/** The current choice. ... *//** Creates a new instance of <code>CheckboxGroup</code>. *//** Gets the current choice from this check box group. ... */getCurrent(...)/** Sets the currently selected check box in this group ... */setCurrent(...)Checkbox oldChoicethis.selectedCheckboxbox.groupoldChoice.group/** Returns a string representation of this check box group, ... */import CheckboxMenuItemPeer/** This class represents a check box that can be included in a menu. ... */setCheckboxMenuItemAccessor(...)AWTAccessor.CheckboxMenuItemAccessorcmi.state/** The state of a checkbox menu item ... *//** Create a check box menu item with an empty label. ... *//** Create a check box menu item with the specified label. ... *//** Create a check box menu item with the specified label and state. ... *//** Construct a name for this MenuComponent.  Called by getName() when ... *//** Creates the peer of the checkbox item.  This peer allows us to ... */createCheckboxMenuItem(...)/** Determines whether the state of this check box menu item ... *//** Sets this check box menu item to the specified state. ... */CheckboxMenuItemPeer peer/** Returns the an array (length 1) containing the checkbox menu item ... *//** Removes the specified item listener so that it no longer receives ... *//** Processes events on this check box menu item. ... *//** Processes item events occurring on this check box menu item by ... *//* Post an ItemEvent and toggle state. */new ItemEvent(...)ItemEvent.DESELECTED/** Returns a string representing the state of this ... */int checkboxMenuItemSerializedDataVersion;/* Serial Data Version ... *//* Reads the <code>ObjectInputStream</code> and if it ... *//** Initialize JNI field and method IDs *//** Gets the AccessibleContext associated with this CheckboxMenuItem. ... */new AccessibleAWTCheckboxMenuItem(...)/** Inner class of CheckboxMenuItem used to provide default support for ... */// class AccessibleAWTMenuItemimport ChoicePeer/** The <code>Choice</code> class presents a pop-up menu of choices. ... */Vector<String> pItems;/** The items for the <code>Choice</code>. ... */int selectedIndex;/** The index of the current choice for this <code>Choice</code> ... *//** Creates a new choice menu. The menu initially has no items in it. ... *//** Creates the <code>Choice</code>'s peer.  This peer allows us ... */createChoice(...)/** Returns the number of items in this <code>Choice</code> menu. ... */countItems(...)/** Gets the string at the specified index in this ... */getItemImpl(...)/* This is called by the native code, so client code can't ... *//** Adds an item to this <code>Choice</code> menu. ... *//** Obsolete as of Java 2 platform v1.1.  Please use the ... */insertNoInvalidate(...)/** Inserts an item to this <code>Choice</code>, ... */ChoicePeer peer/** Inserts the item into this choice at the specified position. ... *//** Removes the first occurrence of <code>item</code> ... */removeNoInvalidate(...)/** Removes an item from the choice menu ... *//** Removes an item from the <code>Choice</code> at the ... *//** Removes all items from the choice menu. ... *//** Gets a representation of the current choice as a string. ... *//** Returns an array (length 1) containing the currently selected ... *//** Returns the index of the currently selected item. ... *//** Sets the selected item in this <code>Choice</code> menu to be the ... *//** Sets the selected item in this <code>Choice</code> menu ... *//** Processes events on this choice. If the event is an ... *//** Processes item events occurring on this <code>Choice</code> ... *//** Returns a string representing the state of this <code>Choice</code> ... */int choiceSerializedDataVersion;/* Choice Serial Data Version. ... *//** Gets the <code>AccessibleContext</code> associated with this ... */new AccessibleAWTChoice(...)AccessibleRole.COMBO_BOX/** Returns the number of accessible actions available in this object ... *//** Returns a description of the specified action of the object. ... *//* initialize JNI field and method ids */// no selection or selection shifted up/* if the index greater than item count, add item to the end *//* Adjust selectedIndex if selected item was removed. */// inner class AccessibleAWTChoiceimport Rectangle2D/** The <code>Color</code> class is used to encapsulate colors in the default ... */Color white;/** The color white.  In the default sRGB space. */Color WHITE;/** The color white.  In the default sRGB space. ... */Color lightGray;/** The color light gray.  In the default sRGB space. */Color LIGHT_GRAY;/** The color light gray.  In the default sRGB space. ... */Color gray;/** The color gray.  In the default sRGB space. */Color GRAY;/** The color gray.  In the default sRGB space. ... */Color darkGray;/** The color dark gray.  In the default sRGB space. */Color DARK_GRAY;/** The color dark gray.  In the default sRGB space. ... */Color black;/** The color black.  In the default sRGB space. */Color BLACK;/** The color black.  In the default sRGB space. ... */Color red;/** The color red.  In the default sRGB space. */Color RED;/** The color red.  In the default sRGB space. ... */Color pink;/** The color pink.  In the default sRGB space. */Color PINK;/** The color pink.  In the default sRGB space. ... */Color orange;/** The color orange.  In the default sRGB space. */Color ORANGE;/** The color orange.  In the default sRGB space. ... */Color yellow;/** The color yellow.  In the default sRGB space. */Color YELLOW;/** The color yellow.  In the default sRGB space. ... */Color green;/** The color green.  In the default sRGB space. */Color GREEN;/** The color green.  In the default sRGB space. ... */Color magenta;/** The color magenta.  In the default sRGB space. */Color MAGENTA;/** The color magenta.  In the default sRGB space. ... */Color cyan;/** The color cyan.  In the default sRGB space. */Color CYAN;/** The color cyan.  In the default sRGB space. ... */Color blue;/** The color blue.  In the default sRGB space. */Color BLUE;/** The color blue.  In the default sRGB space. ... *//** The color value. ... */...[] frgbvalue;/** The color value in the default sRGB <code>ColorSpace</code> as ... */...[] fvalue;/** The color value in the native <code>ColorSpace</code> as ... */float falpha;/** The alpha value as a <code>float</code> component. ... */ColorSpace cs;/** The <code>ColorSpace</code>.  If <code>null</code>, then it's ... *//** Checks the color integer components supplied for validity. ... */boolean rangeErrorString badComponentString/** Checks the color <code>float</code> components supplied for ... *//** Creates an opaque sRGB color with the specified red, green, ... *//** Creates an sRGB color with the specified red, green, blue, and alpha ... */testColorValueRange(...)/** Creates an opaque sRGB color with the specified combined RGB value ... *//** Creates an sRGB color with the specified combined RGBA value consisting ... *//** Creates an opaque sRGB color with the specified red, green, and blue ... *//** Creates an sRGB color with the specified red, green, blue, and ... *//** Creates a color in the specified <code>ColorSpace</code> ... */toRGB(...)/** Returns the red component in the range 0-255 in the default sRGB ... *//** Returns the green component in the range 0-255 in the default sRGB ... *//** Returns the blue component in the range 0-255 in the default sRGB ... *//** Returns the alpha component in the range 0-255. ... *//** Returns the RGB value representing the color in the default sRGB ... */double FACTOR;/** Creates a new <code>Color</code> that is a brighter version of this ... *//** Creates a new <code>Color</code> that is a darker version of this ... *//** Computes the hash code for this <code>Color</code>. ... *//** Determines whether another object is equal to this ... *//** Returns a string representation of this <code>Color</code>. This ... *//** Converts a <code>String</code> to an integer and returns the ... */Integer intval/** Finds a color in the system properties. ... *//** Converts the components of a color, as specified by the HSB ... */floor(...)float t/** Converts the components of a color, as specified by the default RGB ... */float brightnessint cmaxint cminfloat redcfloat greencfloat bluec/** Creates a <code>Color</code> object based on the specified values ... */HSBtoRGB(...)/** Returns a <code>float</code> array containing the color and alpha ... */float[] f/** Returns a <code>float</code> array containing only the color ... */fvalue.lengthgetRGBComponents(...)getRGBColorComponents(...)float[] tmptoCIEXYZ(...)float[] tmpoutfromCIEXYZ(...)tmpout.length/** Returns the <code>ColorSpace</code> of this <code>Color</code>. ... *//** Creates and returns a {@link PaintContext} used to ... */new ColorPaintContext(...)/** Returns the transparency mode for this <code>Color</code>.  This is ... */Transparency.BITMASK/** 4112352 - Calling getDefaultToolkit() ... *//* From 2D group: ... */import IntegerComponentRasterint color;WritableRaster savedTile;/* Returns the RGB value representing the color in the default sRGB ... */WritableRaster tIntegerComponentRaster icrgetDataStorage(...)// Note - markDirty is probably unnecessary since icr is brand newimport ContainerPeerimport ImageObserverimport VolatileImageimport PropertyChangeSupportimport Transientimport InputContextimport InputMethodRequestsimport DropTargetimport ConstrainableGraphicsimport SubRegionShowableimport WindowClosingListenerimport CausedFocusEventimport EmbeddedFrameimport SunDropTargetEventimport CompositionAreaimport FontManagerimport FontManagerFactoryimport SunFontManagerimport SunGraphics2Dimport VSyncedBSManagerimport ExtendedBufferCapabilitiesimport static VSyncType.*import RequestFocusControllerimport SunGraphicsEnvironment/** A <em>component</em> is an object having a graphical representation ... */ComponentOrientation.UNKNOWNAWTEvent.INPUT_METHODS_ENABLED_MASKComponentPeer.DEFAULT_OPERATIONcheckCoalescing(...)new AWTTreeLock(...)setComponentAccessor(...)AWTAccessor.ComponentAccessorcomp.backgroundEraseDisabledcomp.xcomp.ycomp.widthcomp.heightboolean needShowingboolean needHidingisNonOpaqueForMixing(...)comp.mixingCutoutRegionisMixingNeeded(...)mixOnHiding(...)isLightweight(...)mixOnShowing(...)CausedFocusEvent.CausecanBeFocusOwner(...)isVisible_NoClientCode(...)setRequestFocusController(...)comp.appContextgetParent_NoClientCode(...)location_NoClientCode(...)isEnabledImpl(...)getCursor_NoClientCode(...)comp.ignoreRepaintcomp.foregroundcomp.backgroundgetFont_NoClientCode(...)revalidateSynchronously(...)new DummyRequestFocusController(...)PlatformLogger eventLog;PlatformLogger focusLog;PlatformLogger mixingLog;ComponentPeer peer;/** The peer of the component. The peer implements the component's ... */Container parent;/** The parent of the object. It may be <code>null</code> ... */AppContext appContext;/** The <code>AppContext</code> of the component. Applets/Plugin may ... *//** The x position of the component in the parent's coordinate system. ... *//** The y position of the component in the parent's coordinate system. ... *//** The width of the component. ... *//** The height of the component. ... *//** The foreground color for this component. ... *//** The background color for this component. ... *//** The font used by this component. ... */Font peerFont;/** The font which the peer is currently using. ... *//** The cursor displayed when pointer is over this component. ... */Locale locale;/** The locale for the component. ... */GraphicsConfiguration graphicsConfig;/** A reference to a <code>GraphicsConfiguration</code> object ... */BufferStrategy bufferStrategy;/** A reference to a <code>BufferStrategy</code> object ... */boolean ignoreRepaint;/** True when the object should ignore all repaint events. ... */boolean visible;/** True when the object is visible. An object that is not ... *//** True when the object is enabled. An object that is not ... */boolean valid;/** True when the object is valid. An invalid object needs to ... */DropTarget dropTarget;/** The <code>DropTarget</code> associated with this component. ... */Vector<PopupMenu> popups;/** @serial ... *//** A component's name. ... */boolean nameExplicitlySet;/** A bool to determine whether the name has ... */boolean focusable;/** Indicates whether this Component can be focused. ... */int FOCUS_TRAVERSABLE_UNKNOWN;int FOCUS_TRAVERSABLE_DEFAULT;int FOCUS_TRAVERSABLE_SET;int isFocusTraversableOverridden;/** Tracks whether this Component is relying on default focus travesability. ... */...[] focusTraversalKeys;/** The focus traversal keys. These keys will generate focus traversal ... */...[] focusTraversalKeyPropertyNames;boolean focusTraversalKeysEnabled;/** Indicates whether focus traversal keys are enabled for this Component. ... */Object LOCK;/** The locking object for AWT component-tree and layout operations. ... *//* The component's AccessControlContext. */Dimension minSize;/** Minimum size. ... */boolean minSizeSet;/** Whether or not setMinimumSize has been invoked with a non-null value. */Dimension prefSize;/** Preferred size. ... */boolean prefSizeSet;/** Whether or not setPreferredSize has been invoked with a non-null value. */Dimension maxSize;/** Maximum size ... */boolean maxSizeSet;/** Whether or not setMaximumSize has been invoked with a non-null value. */ComponentOrientation componentOrientation;/** The orientation for this component. ... */boolean newEventsOnly;/** <code>newEventsOnly</code> will be true if the event is ... */HierarchyBoundsListener hierarchyBoundsListener;MouseWheelListener mouseWheelListener;InputMethodListener inputMethodListener;RuntimeException windowClosingException;String actionListenerK;/** Internal, constants for serialization */String adjustmentListenerK;String componentListenerK;String containerListenerK;String focusListenerK;String itemListenerK;String keyListenerK;String mouseListenerK;String mouseMotionListenerK;String mouseWheelListenerK;String textListenerK;String ownedWindowK;String windowListenerK;String inputMethodListenerK;String hierarchyListenerK;String hierarchyBoundsListenerK;String windowStateListenerK;String windowFocusListenerK;long eventMask;/** The <code>eventMask</code> is ONLY set by subclasses via ... */boolean isInc;/** Static properties for incremental drawing. ... */int incRate;float TOP_ALIGNMENT;/** Ease-of-use constant for <code>getAlignmentY()</code>. ... */float CENTER_ALIGNMENT;/** Ease-of-use constant for <code>getAlignmentY</code> and ... */float BOTTOM_ALIGNMENT;/** Ease-of-use constant for <code>getAlignmentY</code>. ... */float LEFT_ALIGNMENT;/** Ease-of-use constant for <code>getAlignmentX</code>. ... */float RIGHT_ALIGNMENT;PropertyChangeSupport changeSupport;/** If any <code>PropertyChangeListeners</code> have been registered, ... */Object objectLock;/* In some cases using "this" as an object to synchronize by ... *//* Returns the acc this component was constructed with. */boolean isPacked;int boundsOp;/** Pseudoparameter for direct Geometry API (setLocation, setBounds setSize ... *//** Enumeration of the common ways the baseline of a component can ... */new BaselineResizeBehavior(...)BaselineResizeBehavior CONSTANT_ASCENT;/** Indicates the baseline remains fixed relative to the ... */BaselineResizeBehavior CONSTANT_DESCENT;/** Indicates the baseline remains fixed relative to the height ... */BaselineResizeBehavior CENTER_OFFSET;/** Indicates the baseline remains a fixed distance from ... */BaselineResizeBehavior OTHER;/** Indicates the baseline resize behavior can not be expressed using ... */Region compoundShape;/* The shape set with the applyCompoundShape() method. It uncludes the result ... */Region mixingCutoutRegion;/* Represents the shape of this lightweight component to be cut out from ... */boolean isAddNotifyComplete;/* Indicates whether addNotify() is complete ... *//** Should only be used in subclass getBounds to check that part of bounds ... */ComponentPeer.RESET_OPERATIONboolean backgroundEraseDisabled;// of the peer and therefore the call to XSetBackground.// where currently there is no chance to interpose on the creation// needed in order to make this function work on X11 platforms,// specified via SunToolkit.disableBackgroundErase(). This is// Whether this Component has had the background erase flag/** Constructs a new component. Class <code>Component</code> can be ... */new Set<>[]/** Constructs a name for this component.  Called by <code>getName</code> ... *//** Gets the name of the component. ... */getObjectLock(...)constructComponentName(...)/** Sets the name of the component to the specified string. ... *//** Gets the parent of this component. ... *///       DO NOT INVOKE CLIENT CODE ON THIS THREAD!//       to insure that it cannot be overridden by client subclasses.//       This functionality is implemented in a package-private method// NOTE: This method may be called by privileged threads.//    the owner of the window, not its parent.//    because the parent field of the Window object contains// This method is overridden in the Window class to return null,/** Associate a <code>DropTarget</code> with this component. ... */DropTarget oldDropTarget tsetComponent(...)IllegalArgumentException iae1/** Gets the <code>DropTarget</code> associated with this ... *//** Gets the <code>GraphicsConfiguration</code> associated with this ... */getGraphicsConfiguration_NoClientCode(...)updateGraphicsData(...)checkTreeLock(...)/** Checks that this component's <code>GraphicsDevice</code> ... */getIDstring(...)/** Gets this component's locking object (the object that owns the thread ... *//** Gets the toolkit of this component. Note that ... */getToolkitImpl(...)/** Determines whether this component is valid. A component is valid ... *//** Determines whether this component is displayable. A component is ... *//** Determines whether this component should be visible when its ... *//** Determines whether this component will be displayed on the screen. ... */isRecursivelyVisible(...)/** Determines the bounds of a visible part of the component relative to its ... */Component containergetContainer(...)Rectangle boundsRectangle parentsBoundsgetRecursivelyVisibleBounds(...)/** Translates absolute coordinates into coordinates in the coordinate ... */Point compCoordsabsolute.xcompCoords.xabsolute.ycompCoords.y/** Assuming that mouse location is stored in PointerInfo passed ... */boolean INCLUDE_DISABLEDPoint relativeToWindowpointRelativeToComponent(...)Component inTheSameWindowfindComponentAt(...)relativeToWindow.xrelativeToWindow.yisWindowUnderMouse(...)getMouseInfoPeer(...)/** Returns the position of the mouse pointer in this <code>Component</code>'s ... */PointerInfo pigetPointerInfo(...)findUnderMouseInWindow(...)isSameOrAncestorOf(...)/** Overridden in Container. Must be called under TreeLock. *//** Determines whether this component is showing on screen. This means ... *//** Determines whether this component is enabled. An enabled component ... *//** Enables or disables this component, depending on the value of the ... */updateCursorImmediately(...)clearMostRecentFocusOwner(...)isAutoFocusTransferEnabled(...)isFocusOwner(...)containsFocus(...)transferFocus(...)/** Returns true if this component is painted to an offscreen image ... *//** Enables or disables input method support for this component. If input ... */InputContext inputContextgetInputContext(...)FocusEvent focusGainedEventnew FocusEvent(...)endComposition(...)/** Shows or hides this component depending on the value of parameter ... */createHierarchyEvents(...)HierarchyEvent.HIERARCHY_CHANGEDHierarchyEvent.SHOWING_CHANGEDenabledOnToolkit(...)AWTEvent.HIERARCHY_EVENT_MASKAWTEvent.COMPONENT_EVENT_MASKComponentEvent enew ComponentEvent(...)ComponentEvent.COMPONENT_SHOWNclearCurrentFocusCycleRootOnHide(...)clearMostRecentFocusOwnerOnHide(...)ComponentEvent.COMPONENT_HIDDEN/** Gets the foreground color of this component. ... */Color foreground/** Sets the foreground color of this component. ... *//** Returns whether the foreground color has been explicitly set for this ... *//** Gets the background color of this component. ... *//** Sets the background color of this component. ... *//** Returns whether the background color has been explicitly set for this ... *//** Gets the font of this component. ... *//** Sets the font of this component. ... *//** Returns whether the font has been explicitly set for this Component. If ... *//** Gets the locale of this component. ... */new IllegalComponentStateException(...)/** Sets the locale of this component.  This is a bound property. ... */Locale oldValue/** Gets the instance of <code>ColorModel</code> used to display ... *//** Gets the location of this component in the form of a ... *//** Gets the location of this component in the form of a point ... */getLocationOnScreen_NoTreeLock(...)/* a package private version of getLocationOnScreen ... */Container hostgetNativeContainer(...)Point pthost.peerpt.xc.xpt.yc.y/** Moves this component to a new location. The top-left corner of ... */setBoundsOp(...)ComponentPeer.SET_LOCATION/** Returns the size of this component in the form of a ... *//** Resizes this component so that it has width <code>width</code> ... */ComponentPeer.SET_SIZE/** Resizes this component so that it has width <code>d.width</code> ... *//** Gets the bounds of this component in the form of a ... */bounds(...)/** Moves and resizes this component. The new location of the top-left ... */boolean resizedboolean movedint oldXint oldYboolean needNotifyComponentPeer.SET_BOUNDSmixOnReshaping(...)reshapeNativePeer(...)getBoundsOp(...)notifyNewBounds(...)repaintParentIfNeeded(...)int nativeXint nativeYc.peerc.parentComponentEvent.COMPONENT_RESIZEDcountComponents(...)boolean enabledOnToolkitAWTEvent.HIERARCHY_BOUNDS_EVENT_MASKcreateChildHierarchyEvents(...)HierarchyEvent.ANCESTOR_RESIZEDHierarchyEvent.ANCESTOR_MOVED/** Moves and resizes this component to conform to the new ... *//** Returns the current x coordinate of the components origin. ... *//** Returns the current y coordinate of the components origin. ... *//** Returns the current width of this component. ... *//** Returns the current height of this component. ... *//** Stores the bounds of this component into "return value" <b>rv</b> and ... *//** Stores the width/height of this component into "return value" <b>rv</b> ... *//** Stores the x,y origin of this component into "return value" <b>rv</b> ... *//** Returns true if this component is completely opaque, returns ... *//** A lightweight component doesn't have a native toolkit peer. ... *//** Sets the preferred size of this component to a constant ... */Dimension old/** Returns true if the preferred size has been set to a ... *//** Gets the preferred size of this component. ... */preferredSize(...)isPreferredSizeSet(...)/** Sets the minimum size of this component to a constant ... */this.minSize/** Returns whether or not <code>setMinimumSize</code> has been ... *//** Gets the minimum size of this component. ... */minimumSize(...)isMinimumSizeSet(...)/** Sets the maximum size of this component to a constant ... *//** Returns true if the maximum size has been set to a non-<code>null</code> ... *//** Gets the maximum size of this component. ... */isMaximumSizeSet(...)/** Returns the baseline.  The baseline is measured from the top of ... *//** Returns an enum indicating how the baseline of the component ... */BaselineResizeBehavior.OTHER/** Prompts the layout manager to lay out this component. This is ... *//** Validates this component. ... */boolean wasValidFont newfontFont oldfontmixOnValidating(...)/** Invalidates this component and its ancestors. ... */invalidateParent(...)/** Invalidates the parent of this component if any. ... *//** Invalidates the component unless it is already invalid. *//** Revalidates the component hierarchy up to the nearest validate root. ... *//** Revalidates the component synchronously. */Container rootisValidateRoot(...)/** Creates a graphics context for this component. This method will ... */constrain(...)getGraphics_NoClientCode(...)/** Gets the font metrics for the specified font. ... */FontManager fmusePlatformFontMetrics(...)getMetrics(...)/** Sets the cursor image to the specified cursor.  This cursor ... */this.cursor/** Updates the cursor.  May not be invoked from the native ... */Container nativeContainerComponentPeer cPeer/** Gets the cursor set in the component. If the component does ... */Cursor cursor/** Returns whether the cursor has been explicitly set for this Component. ... *//** Paints this component. ... *//** Updates this component. ... *//** Paints this component and all of its subcomponents. ... */runOneComponent(...)GraphicsCallback.PeerPaintCallbackGraphicsCallback.LIGHTWEIGHTSGraphicsCallback.HEAVYWEIGHTS/** Simulates the peer callbacks into java.awt for painting of ... *//** Paints all the heavyweight subcomponents. *//** Repaints this component. ... *//** Repaints the component.  If this component is a lightweight ... *//** Repaints the specified rectangle of this component. ... *//** Repaints the specified rectangle of this component within ... */int pwidthint pheightint pyPaintEvent enew PaintEvent(...)PaintEvent.UPDATE/** Prints this component. Applications should override this method ... *//** Prints this component and all of its subcomponents. ... */GraphicsCallback.PeerPrintCallback/** Simulates the peer callbacks into java.awt for printing of ... *//** Prints all the heavyweight subcomponents. *//** Repaints the component when the image has changed. ... */int rate/** Creates an image from the specified image producer. ... *//** Creates an off-screen drawable image ... *//** Creates a volatile off-screen drawable image ... */createVolatileImage(...)/** Creates a volatile off-screen drawable image, with the given capabilities. ... *//** Prepares an image for rendering on this component.  The image ... */prepareImage(...)/** Prepares an image for rendering on this component at the ... *//** Returns the status of the construction of a screen representation ... */checkImage(...)BufferCapabilities bufferCapsnew BufferCapabilities(...)new ImageCapabilities(...)BufferCapabilities.FlipContents.UNDEFINEDBufferCapabilities.FlipContentsAWTException enew SingleBufferStrategy(...)SunGraphicsEnvironment sgeisFlipStrategyPreferred(...)isPageFlipping(...)new ProxyCapabilities(...)new FlipSubRegionBufferStrategy(...)new BltSubRegionBufferStrategy(...)/** This is a proxy capabilities class used when a FlipBufferStrategy ... */BufferCapabilities orig;getFrontBufferCapabilities(...)getBackBufferCapabilities(...)BufferCapabilities.FlipContents.BACKGROUNDBufferCapabilities.FlipContents.COPIEDthis.origBltBufferStrategy bltBSgetBackBuffer(...)FlipBufferStrategy flipBS/** Inner class for flipping buffers on a component.  That component must ... */int numBuffers;/** The number of buffers */BufferCapabilities caps;/** The buffering capabilities */// = 0Image drawBuffer;/** The drawing buffer */// = nullVolatileImage drawVBuffer;/** The drawing buffer as a volatile image */boolean validatedContents;/** Whether or not the drawing buffer has been recently restored from ... *//** Size of the back buffers.  (Note: these fields were added in 6.0 ... */// = false/** Creates a new flipping buffer strategy for this component. ... */Component.thisthis.numBuffersthis.capscreateBuffers(...)/** Creates one or more complex, flipping buffers with the given ... */destroyBuffers(...)ExtendedBufferCapabilities ebcgetVSync(...)vsyncAllowed(...)updateInternalBuffers(...)/** Updates internal buffers (both volatile and non-volatile) ... *//** Flipping moves the contents of the back buffer to the front buffer, ... */Image backBuffer/** Destroys the buffers created through this object */releaseVsync(...)(...).orig/** Restore the drawing buffer if it has been lost */int returnCodeVolatileImage.IMAGE_INCOMPATIBLEVolatileImage.IMAGE_RESTOREDcontentsLost(...)/** Makes the next available buffer visible by either blitting or ... *//** Makes specified region of the the next available buffer visible ... */flipSubRegion(...)Component.this.bufferStrategy/** Inner class for blitting offscreen surfaces to a component. ... */// Inner class FlipBufferStrategy...[] backBuffers;/** The back buffers *//** Size of the back buffers *//** Insets for the hosting Component.  The size of the back buffer ... *//** Creates a new blt buffer strategy around a component ... */createBackBuffers(...)backBuffers.length/** Creates the back buffers */int iWidthint iHeightgetInsets_NoClientCode(...)new VolatileImage[]SunGraphics2D g/** Makes the next available buffer visible. */showSubRegion(...)/** Package-private method to present a specific rectangular area ... *//** Private class to perform sub-region flipping. */// Inner class BltBufferStrategy// This is invoked by Swing on the toolkit thread./** Private class to perform sub-region blitting.  Swing will use ... */// This method is called by Swing on the toolkit thread./** Sets whether or not paint messages received from the operating system ... */// Inner class SingleBufferStrategythis.ignoreRepaint/** Checks whether this component "contains" the specified point, ... */inside(...)/** Determines if this component or one of its immediate ... */locate(...)/** Returns the component or subcomponent that contains the ... *//** Dispatches an event to this component or one of its sub components. ... */dispatchEventImpl(...)AppContext compContextsetCurrentEventAndMostRecentTime(...)e.focusManagerIsDispatchinge.isPostedretargetFocusEvent(...)dispatchMouseWheelToAncestor(...)eventTypeEnabled(...)handlesWheelScrolling(...)notifyAWTEventListeners(...)processKeyEvent(...)areInputMethodsEnabled(...)disableNativeIM(...)preProcessKeyEvent(...)windowClosingNotify(...)checkWindowClosingException(...)autoProcessMouseWheel(...)postsOldMouseEvents(...)convertToOld(...)olde.keyolde.modifiersolde.idsetKeyChar(...)getKeyEventChar(...)setModifiers(...)windowClosingDelivered(...)ComponentPeer tpeerComponent sourceContainer target/* If newEventsOnly is false, method is called so that ScrollPane can ... */// dispatchEventImpl()/* Dispatch given MouseWheelEvent to the first ancestor for which ... */int newXint newYMouseWheelEvent newMWEContainer ancnew MouseWheelEvent(...)getScrollType(...)getScrollAmount(...)getWheelRotation(...)getPreciseWheelRotation(...)copyPrivateDataInto(...)dispatchEventToSelf(...)interruptBlocking(...)AWTEvent.KEY_EVENT_MASK// REMIND: remove when filtering is handled at lower levelAWTEvent.MOUSE_WHEEL_EVENT_MASKAWTEvent.INPUT_METHOD_EVENT_MASKAWTEvent.TEXT_EVENT_MASKAWTEvent.ADJUSTMENT_EVENT_MASKAWTEvent.RESERVED_ID_MAXint eventxe.xint eventye.y/** Adds the specified component listener to receive component events from ... */// Event source interfaces/** Removes the specified component listener so that it no longer ... *//** Returns an array of all the component listeners ... *//** Adds the specified focus listener to receive focus events from ... */proxyEnableEvents(...)/** Removes the specified focus listener so that it no longer ... *//** Returns an array of all the focus listeners ... *//** Adds the specified hierarchy listener to receive hierarchy changed ... */boolean notifyAncestorsadjustListeningChildrenOnParent(...)/** Removes the specified hierarchy listener so that it no longer ... *//** Returns an array of all the hierarchy listeners ... *//** Adds the specified hierarchy bounds listener to receive hierarchy ... *//** Removes the specified hierarchy bounds listener so that it no longer ... */// Should only be called while holding the tree lock// Should only be called while holding tree lockHierarchyEvent enew HierarchyEvent(...)/** Returns an array of all the hierarchy bounds listeners ... *//* Should only be called while holding the tree lock. ... */adjustListeningChildren(...)/** Adds the specified key listener to receive key events from ... *//** Removes the specified key listener so that it no longer ... *//** Returns an array of all the key listeners ... *//** Adds the specified mouse listener to receive mouse events from ... *//** Removes the specified mouse listener so that it no longer ... *//** Returns an array of all the mouse listeners ... *//** Adds the specified mouse motion listener to receive mouse motion ... *//** Removes the specified mouse motion listener so that it no longer ... *//** Returns an array of all the mouse motion listeners ... *//** Adds the specified mouse wheel listener to receive mouse wheel events ... *//** Removes the specified mouse wheel listener so that it no longer ... *//** Returns an array of all the mouse wheel listeners ... *//** Adds the specified input method listener to receive ... *//** Removes the specified input method listener so that it no longer ... *//** Returns an array of all the input method listeners ... */getPropertyChangeListeners(...)/** Gets the input method request handler which supports ... *//** Gets the input context used by this component for handling ... *//** Enables the events defined by the specified event mask parameter ... */long notifyAncestors/** Disables the events defined by the specified event mask parameter ... */...[] eventCache;boolean coalescingEnabled;Map<Class<?>,Boolean> coalesceMap;/** Weak map of known coalesceEvent overriders. ... *//** Indicates whether this class overrides coalesceEvents. ... */Class<? extends Component> clazzBoolean valueBoolean enabledisCoalesceEventsOverriden(...)...[] coalesceEventsParams;/** Parameter types of coalesceEvents(AWTEvent,AWTEVent). *//** Indicates whether a class or its superclasses override coalesceEvents. ... */Class<?> superclassgetDeclaredMethod(...)/** Indicates whether coalesceEvents may do something. *//** Potentially coalesce an event being posted with an existing ... *//** Processes events occurring on this component. By default this ... */processFocusEvent(...)processMouseMotionEvent(...)processMouseWheelEvent(...)processComponentEvent(...)processInputMethodEvent(...)processHierarchyEvent(...)processHierarchyBoundsEvent(...)/** Processes component events occurring on this component by ... */ComponentListener listener/** Processes focus events occurring on this component by ... */FocusListener listener/** Processes key events occurring on this component by ... */KeyListener listener/** Processes mouse events occurring on this component by ... */MouseListener listener/** Processes mouse motion events occurring on this component by ... */MouseMotionListener listener/** Processes mouse wheel events occurring on this component by ... */MouseWheelListener listener/** Processes input method events occurring on this component by ... */InputMethodListener listener/** Processes hierarchy events occurring on this component by ... */HierarchyListener listener/** Processes hierarchy bounds events occurring on this component by ... */HierarchyBoundsListener listenerevt.idmouseEnter(...)evt.xevt.ymouseExit(...)mouseMove(...)mouseDown(...)mouseDrag(...)mouseUp(...)keyDown(...)evt.keykeyUp(...)evt.arggotFocus(...)lostFocus(...)/** Makes this <code>Component</code> displayable by connecting it to a ... */int npopupscreateComponent(...)relocateComponent(...)isRecursivelyVisibleUpToHeavyweightContainer(...)PopupMenu popupincreaseComponentCount(...)updateZOrder(...)/** Makes this <code>Component</code> undisplayable by destroying it native ... */getPermanentFocusOwner(...)setGlobalPermanentFocusOwner(...)ComponentPeer pisAutoFocusTransferEnabledFor(...)decreaseComponentCount(...)boolean isLightweightremoveSourceEvents(...)discardKeyEvents(...)this.compoundShape/** Returns whether this <code>Component</code> can become the focus ... *//** Returns whether this Component can be focused. ... *//** Sets the focusable state of this Component to the specified value. This ... */boolean oldFocusablethis.focusable/** Sets the focus traversal keys for a given traversal operation for this ... */KeyboardFocusManager.TRAVERSAL_KEY_LENGTHsetFocusTraversalKeys_NoIDCheck(...)/** Returns the Set of focus traversal keys for a given traversal operation ... */getFocusTraversalKeys_NoIDCheck(...)// DOWN_CYCLE_TRAVERSAL_KEY.// would erroneously generate an IllegalArgumentException for// DOWN_CYCLE_TRAVERSAL_KEY while Component does not. The Component method// code. Container cannot call super.<method> because Container allows// We define these methods so that Container does not need to repeat thisSet<AWTKeyStroke> oldKeysinitializeFocusTraversalKeys(...)AWTKeyStroke keystrokefocusTraversalKeys.lengthunmodifiableSet(...)Set<AWTKeyStroke> keystrokesgetDefaultFocusTraversalKeys(...)/** Returns whether the Set of focus traversal keys for the given focus ... *//** Sets whether focus traversal keys are enabled for this Component. ... */boolean oldFocusTraversalKeysEnabledthis.focusTraversalKeysEnabled/** Returns whether focus traversal keys are enabled for this Component. ... *//** Requests that this Component get the input focus, and that this ... */requestFocusHelper(...)/** Requests that this <code>Component</code> get the input focus, ... *//** Requests that this Component get the input focus, if this ... */CausedFocusEvent.Cause.UNKNOWNAWTEvent currentEventgetCurrentEvent(...)Component windowComponent heavyweightlong timeisSystemGenerated(...)isRequestFocusAccepted(...)setMostRecentFocusOwner(...)window.parentheavyweight.peerisDispatchThread(...)getMostRecentKeyEventTime(...)dequeueKeyEvents(...)Window windowgetMostRecentFocusOwner(...)acceptRequestFocus(...)Component.requestFocusControllerisFocusableWindow(...)CausedFocusEvent.Cause.ACTIVATIONRequestFocusController requestFocusController;// Perhaps, we should make this method public (later ;)// Swing access this method through reflection to implement InputVerifier's functionality./** Returns the Container which is the focus cycle root of this Component's ... */rootAncestor.parent/** Returns whether the specified Container is the focus cycle root of this ... *//** Transfers the focus to the next component, as though this Component were ... */nextFocus(...)Component toFocusgetNextFocusCandidate(...)requestFocusInWindow(...)CausedFocusEvent.Cause.TRAVERSAL_FORWARDclearGlobalFocusOwnerPriv(...)getTraversalRoot(...)Component candidateApplet appletgetAppletIfAncestorOf(...)/** Transfers the focus to the previous component, as though this Component ... */transferFocusBackward(...)CausedFocusEvent.Cause.TRAVERSAL_BACKWARD/** Transfers the focus up one focus traversal cycle. Typically, the focus ... */Container rootAncestorRootAncestorContainer fcrsetGlobalCurrentFocusCycleRootPriv(...)CausedFocusEvent.Cause.TRAVERSAL_UP/** Returns <code>true</code> if this <code>Component</code> is the ... */boolean autoFocusTransferOnDisposal;/* Used to disallow auto-focus-transfer on disposal of the focus owner ... *//** Adds the specified popup menu to the component. ... */popup.parentnew Vector<PopupMenu>(...)popup.peer/** Removes the specified popup menu from the component. ... */PopupMenu pmenupmenu.peerpmenu.parent/** Returns a string representing the state of this component. This ... */String thisNameString invalidString hiddenString disabled/** Returns a string representation of this component and its values. ... *//** Prints a listing of this component to the standard system output ... *//** Prints a listing of this component to the specified output ... *//** Prints out a list, starting at the specified indentation, to the ... *//** Prints a listing to the specified print writer. ... *//** Prints out a list, starting at the specified indentation, to ... *//* Fetches the native container somewhere higher up in the component ... */p.peer/** Adds a PropertyChangeListener to the listener list. The listener is ... *//** Removes a PropertyChangeListener from the listener list. This method ... *//** Returns an array of all the property change listeners ... *//** Adds a PropertyChangeListener to the listener list for a specific ... *//** Removes a <code>PropertyChangeListener</code> from the listener ... *//** Returns an array of all the listeners which have been associated ... *//** Support for reporting bound property changes for Object properties. ... */PropertyChangeSupport changeSupportthis.changeSupport/** Support for reporting bound property changes for boolean properties. ... *//** Support for reporting bound property changes for integer properties. ... *//** Reports a bound property change. ... */int componentSerializedDataVersion;/** Component Serialized Data Version. ... */// Serialization support./** This hack is for Swing serialization. It will invoke ... */Package swingPackageClass<?> klassClass<?> swingClassMethod[] methodsgetDeclaredMethods(...)methods.lengthdoSwingSerialization(...)/** Reads the <code>ObjectInputStream</code> and if it isn't ... */Object orientaddInputMethodListener(...)OptionalDataException ee.eofaddHierarchyBoundsListener(...)addMouseWheelListener(...)/** Sets the language-sensitive orientation that is to be used to order ... */ComponentOrientation oldValue/** Retrieves the language-sensitive orientation that is to be used to order ... *//** Sets the <code>ComponentOrientation</code> property of this component ... */setComponentOrientation(...)/** Checks that this component meets the prerequesites to be focus owner: ... */canContainFocusOwner(...)/** Fix the location of the HW component in a LW container hierarchy. */Component contcont.xcont.y/** Returns the <code>Window</code> ancestor of the component. ... *//** The {@code AccessibleContext} associated with this {@code Component}. *//* --- Accessibility Support --- ... *//** Gets the <code>AccessibleContext</code> associated ... *//** Inner class of Component used to provide default support for ... *//** Though the class is abstract, this should be called by ... */int propertyListenersCount;/** Number of PropertyChangeListener objects registered. It's used ... */ComponentListener accessibleAWTComponentHandler;FocusListener accessibleAWTFocusHandler;/** Fire PropertyChange listener, if one is registered, ... */AccessibleState.VISIBLE// inner class AccessibleAWTComponentHandler/** Adds a <code>PropertyChangeListener</code> to the listener list. ... */// inner class AccessibleAWTFocusHandlernew AccessibleAWTComponentHandler(...)new AccessibleAWTFocusHandler(...)/** Remove a PropertyChangeListener from the listener list. ... *//** Gets the accessible name of this object.  This should almost never ... *//** Gets the accessible description of this object.  This should be ... *//** Gets the role of this object. ... */AccessibleRole.AWT_COMPONENT/** Gets the state of this object. ... *//** Gets the <code>Accessible</code> parent of this object. ... *//** Gets the index of this object in its accessible parent. ... */getAccessibleIndexInParent(...)/** Returns the number of accessible children in the object.  If all ... *//** Returns the nth <code>Accessible</code> child of the object. ... *//** Returns the locale of this object. ... *//** Gets the <code>AccessibleComponent</code> associated ... *//** Gets the background color of this object. ... *//** Sets the background color of this object. ... *//** Gets the foreground color of this object. ... *//** Sets the foreground color of this object. ... *//** Gets the <code>Cursor</code> of this object. ... *//** Sets the <code>Cursor</code> of this object. ... *//** Gets the <code>Font</code> of this object. ... *//** Sets the <code>Font</code> of this object. ... *//** Gets the <code>FontMetrics</code> of this object. ... *//** Determines if the object is enabled. ... *//** Sets the enabled state of the object. ... *//** Determines if the object is visible.  Note: this means that the ... *//** Sets the visible state of the object. ... *//** Determines if the object is showing.  This is determined by checking ... *//** Checks whether the specified point is within this object's bounds, ... *//** Gets the location of the object relative to the parent in the form ... *//** Sets the location of the object relative to the parent. ... *//** Gets the bounds of this object in the form of a Rectangle object. ... *//** Sets the bounds of this object in the form of a ... *//** Returns the size of this object in the form of a ... *//** Resizes this object so that it has width and height. ... *//** Returns the <code>Accessible</code> child, ... *//** Adds the specified focus listener to receive focus events from this ... */// inner class AccessibleAWTComponent/** Gets the current state set of this object. ... */AccessibleState.SHOWINGAccessible apgetAccessibleParent(...)AccessibleContext pacAccessibleSelection asgetAccessibleSelection(...)AccessibleState.SELECTABLEisAccessibleChildSelected(...)AccessibleState.OPAQUE/** Checks that the given object is instance of the given class. ... *//** Check whether we can trust the current bounds of the component. ... */// ************************** MIXING CODE *******************************Container cont/** Applies the shape to the component ... */areBoundsValid(...)Region.EMPTY_REGIONgetNormalShape(...)applyShape(...)Point compAbsolutegetLocationOnWindow(...)getAppliedShape(...)getTranslatedRegion(...)compAbsolute.xcompAbsolute.y/** Returns the shape previously set with applyCompoundShape(). ... */Point curLocationcurLocation.xcurLocation.y/** Returns the full shape of the component located in window coordinates */getInstanceXYWH(...)/** Returns the "opaque shape" of the component. ... */int nextAbovegetComponentZOrder(...)int indexAbovegetSiblingIndexAbove(...)int nextBelowRegion sgetDifference(...)getOpaqueShape(...)getIntersection(...)applyCompoundShape(...)calculateCurrentShape(...)Container parent2recursiveApplyCurrentShape(...)getSiblingIndexBelow(...)Region opaqueShaperecursiveSubtractAndApplyShape(...)subtractAndApplyShapeBelowMe(...)applyCurrentShape(...)applyCurrentShapeBelowMe(...)boolean becameHigherRegion shapegetSunAwtDisableMixing(...)isDisposing(...)hasHeavyweightDescendants(...)hasLightweightDescendants(...)// a window doesn't need to be updated in the Z-order.// Note that the method is overriden in the Window class,// ****************** END OF MIXING CODE ********************************setZOrder(...)getHWPeerAboveMe(...)/* Copyright (c) 1995, 2015, Oracle and/or its affiliates. All rights reserved. ... */// For strict compliance with prior platform versions, a Component// that doesn't set its name should return null from// getName()// ignore it.// if we have a new one, and we have a peer, add it!// ignore it!// we are top level window or haven't a container, return our bounds// translate the container's bounds to our coordinate space// A disabled lw container is allowed to contain a focus owner.// Don't clear the global focus owner. If transferFocus// fails, we want the focus to stay on the disabled// Component so that keyboard traversal, et. al. still// makes sense to the user.// If this component already has focus, then activate the// input method by dispatching a synthesized focus gained// event.// This is a bound property, so report the change to// any registered listeners.  (Cheap if there are none.)// Fix for 6213660. Should compare old and new fonts and do not// call invalidate() if they are equal.// else// lightweight component location needs to be translated// relative to a native component.// LightwightPeer is an empty stub so can skip peer.reshape// Check peer actualy changed coordinates// fix for 5025858: do not send ComponentEvents for toplevel// windows here as it is done from peer or native code when// the window is really resized or moved, otherwise some// events may be sent twice// Have the parent redraw the area this component occupied.// Have the parent redraw the area this component *now* occupies.// native peer might be offset by more than direct// parent since parent might be lightweight.// If the preferred size was set, use it as the old value, otherwise// use null to indicate we didn't previously have a set preferred// size./* Avoid grabbing the lock if a reasonable cached size value ... */// If the minimum size was set, use it as the old value, otherwise// use null to indicate we didn't previously have a set minimum// If the maximum size was set, use it as the old value, otherwise// use null to indicate we didn't previously have a set maximum/* Nullify cached layout and size information. ... */// There's no parents. Just validate itself.// If there's no validate roots, we'll validate the// topmost container// This is for a lightweight component, need to// translate coordinate spaces and clip relative// to the parent.// This is an unsupported hack, but left in for a customer.// Do not remove.// Needs to be translated to parent coordinates since// a parent native container provides the actual repaint// services.  Additionally, the request is restricted to// the bounds of the component.// REMIND : check caps// Try to create a page-flipping strategy// Success// Failed// Try a blitting (but still accelerated) strategy// Try an unaccelerated blitting strategy// Code should never reach here (an unaccelerated blitting// strategy should always work)// Check arguments// Destroy old buffers// assert numBuffers > 1;// save the current bounds// dispose the existing backbuffers// ... then recreate the backbuffers// if this buffer strategy is not allowed to be v-synced,// change the caps that we pass to the peer but keep on// trying to create v-synced buffers;// do not throw IAE here in case it is disallowed, see// ExtendedBufferCapabilities for more info// get the images associated with the draw buffer// component has been resized; recreate the backbuffers// shouldn't be possible// get the buffers from the peer every time since they// might have been replaced in response to a display change event// now validate the backbuffer// backbuffers were recreated, so validate again// It is possible for the component's width and/or height// to be 0 here.  Force the size of the backbuffers to// be > 0 so that creating the image won't fail.// flush any existing backbuffers// create the backbuffers// Adjust location to be relative to client area.// Not showing, bail// First image copy is in terms of Frame's coordinates, need// to translate to client area.// else case means we're called from Swing on the toolkit// thread, don't recreate buffers as that'll deadlock// (creating VolatileImages invokes getting GraphicsConfig// which grabs treelock).// Check that this component belongs to this app-context/* 0. Set timestamp and modifiers of current event. */// Timestamp of a key event is set later in DKFM.preDispatchKeyEvent(KeyEvent)./* 1. Pre-dispatchers. Do any necessary retargeting/reordering here ... */// Invoke the private focus retargeting method which provides// lightweight Component support// Now, with the event properly targeted to a lightweight// descendant if necessary, invoke the public focus retargeting// and dispatching function// MouseWheel may need to be retargeted here so that// AWTEventListener sees the event go to the correct// Component.  If the MouseWheelEvent needs to go to an ancestor,// the event is dispatched to the ancestor, and dispatching here// stops./* 2. Allow the Toolkit to pass this to AWTEventListeners. *//* 3. If no one has consumed a key event, allow the ... *//* 4. Allow input methods to process the event */// We need to pass on InputMethodEvents since some host// input method adapters send them through the Java// event queue instead of directly to the component,// and the input context also handles the Java composition window// Otherwise, we only pass on input and focus events, because// a) input methods shouldn't know about semantic or component-level events// b) passing on the events takes time// c) isConsumed() is always true for semantic events.// When non-clients get focus, we need to explicitly disable the native// input method. The native input method is actually not disabled when// the active/passive/peered clients loose focus./* 5. Pre-process any special events before delivery */// Handling of the PAINT and UPDATE events is now done in the// peer's handleEvent() method so the background can be cleared// selectively for non-native components on Windows only.// - Fred.Ecks@Eng.sun.com, 5-8-98/* 6. Deliver event for normal processing */// Filtering needs to really be moved to happen at a lower// level in order to get maximum performance gain;  it is// here temporarily to ensure the API spec is honored.// newEventsOnly will be false for a listenerless ScrollPane, but// MouseWheelEvents still need to be dispatched to it so scrolling// can be done.// backward compatibility// if target changed key or modifier values, copy them// back to original event/* 8. Special handling for 4061116 : Hook for browser to close modal ... *//* 9. Allow the peer to process the event. ... */// if focus owner is lightweight then its native container// processes event// Coordinates take into account at least// the cursor's position relative to this// Component (e.getX()), and this Component's// position relative to its parent./* parent field for Window refers to the owning Window. ... */// fix coordinates to be relative to new event source// Change event to be from new source, with new x,y// For now, just create a new event - yucky// new source// x relative to new source// y relative to new source// When dispatching a wheel event to// ancestor, there is no need trying to find descendant// lightweights to dispatch event to.// If we dispatch the event to toplevel ancestor,// this could encolse the loop: 6480024.// in 1.2, we assume input method support is required for all// components that handle key events, but components can turn off// input methods by calling enableInputMethods(false).// Always pass on events defined by external programs.// restore coords// if this is a lightweight component, enable focus events// in the native container.// One mask or the other, but not neither or both.// assert false// if this is a lightweight component, enable key events// if this is a lightweight component, enable mouse events// Check cache.// Need to check non-bootstraps.// First check superclass - we may not need to bother ourselves.// Only occurs on implementations that//   do not use null to represent the bootsrap class loader.// Not done already - recurse.// Throws if not overriden.// Not present in this class.// Update both the Component's peer variable and the local// variable we use for thread safety.// This is a lightweight component which means it won't be// able to get window-related events by itself.  If any// have been enabled, then the nearest native container must// be enabled.// It's native. If the parent is lightweight it will need some// help.// Update stacking order// If there is any input context for this component, notify// that this component is being removed. (This has to be done// before hiding peer.)// Hide peer first to stop system events such as cursor moves.// Stop peer updates.// Nullifying compoundShape means that the component has normal shape// (or has no shape at all).// Okay to return Set directly because it is an unmodifiable view// 1) Check if the event being dispatched is a system-generated mouse event.// 2) Sanity check: if the mouse event component source belongs to the same containing window.// If both the conditions are fulfilled the focus request should be strictly// bounded by the toplevel window. It's assumed that the mouse event activates// the window (if it wasn't active) and this makes it possible for a focus// request with a strong in-window requirement to change focus in the bounds// of the toplevel. If, by any means, due to asynchronous nature of the event// dispatching mechanism, the window happens to be natively inactive by the time// this focus request is eventually handled, it should not re-activate the// toplevel. Otherwise the result may not meet user expectations. See 6981400.// Update most-recent map// Focus this Component// A focus request made from outside EDT should not be associated with any event// and so its time stamp is simply set to the current time.// We have passed all regular checks for focus request,// now let's call RequestFocusController and see what it says.// sometimes most recent focus owner may be null, but focus owner is not// e.g. we reset most recent focus owner if user removes focus owner// Controller is supposed to verify focus transfers and for this it// should know both from and to components.  And it shouldn't verify// transfers from when these components are equal.// we shouldn't call RequestFocusController in case we are// in activation.  We do request focus on component which// has got temporary focus lost and then on component which is// most recent focus owner.  But most recent focus owner can be// changed by requestFocsuXXX() call only, so this transfer has// been already approved.// For Swing serialization to correctly work Swing needs to// be notified before Component does it's serialization.  This// hack accomodates this.// Swing classes MUST be loaded by the bootstrap class loader,// otherwise we don't consider them.// Find the first override of the compWriteObjectNotify method// We found it, use doPrivileged to make it accessible// to use.// Invoke the method// We're done, bail.// These fields are non-transient and rely on default// serialization. However, the default values are insufficient,// so we need to set them explicitly for object data streams prior// to 1.4.// Read the component's orientation if it's present// JDK 1.1 instances will not have this optional data.// e.eof will be true to indicate that there is no more// data available for this object.// If e.eof is not true, throw the exception as it// might have been caused by reasons unrelated to// componentOrientation.// JDK 1.1/1.2 instances will not have this optional data.// hierarchy and hierarchyBounds listeners.// pre-1.3 instances will not have this optional data.// mouse wheel listeners// It is enabled, visible, focusable.// - it is enabled, visible, focusable// - it's parents are all enabled and showing// Components don't have children// The Region class has some optimizations. That's why// we should manually check whether it's empty and// substitute the object ourselves. Otherwise we end up// with some incorrect Region object with loX being// greater than the hiX for instance.// Note: the shape is not really copied/cloned. We create// the Region object ourselves, so there's no any possibility// to modify the object outside of the mixing code.//XXX: if we allow LW components to have a shape, this must be changed//XXX: we may take into account a user-specified shape for this component// traversing the hierarchy up to the closest HW container;// further traversing may return a component that is not actually// a native sibling of this component and this kind of z-order// request may not be allowed by the underlying system (6852051)./* It is assumed that: ... */// Because applyCompoundShape() ignores such components anyway// First, reapply shapes of my siblings// Second, if my container is non-opaque, reapply shapes of siblings of my container// First, cut my siblings// Second, if my container is non-opaque, cut siblings of my container// We cannot be sure that the peer exists at this point, so we need the argument//    to find out whether the hiding component is (well, actually was) a LW or a HW.// This method gets overriden in the Container. Obviously, a plain// non-container components don't need to handle validation./** The ComponentOrientation class encapsulates the language-sensitive ... */new ComponentOrientation(...)/* serialVersionUID */int UNK_BIT;// Internal constants used in the implementationint HORIZ_BIT;int LTR_BIT;ComponentOrientation LEFT_TO_RIGHT;/** Items run left to right and lines flow top to bottom ... */ComponentOrientation RIGHT_TO_LEFT;/** Items run right to left and lines flow top to bottom ... */ComponentOrientation UNKNOWN;/** Indicates that a component's orientation has not been set. ... *//** Are lines horizontal? ... *//** HorizontalLines: Do items run left-to-right?<br> ... *//** Returns the orientation that is appropriate for the given locale. ... */String lang/** Returns the orientation appropriate for the given ResourceBundle's ... */ComponentOrientation resultint orientation;/* (C) Copyright IBM Corp. 1998 - All Rights Reserved ... */// A more flexible implementation would consult a ResourceBundle// to find the appropriate orientation.  Until pluggable locales// are introduced however, the flexiblity isn't really needed.// So we choose efficiency instead./** The <code>Composite</code> interface, along with ... *//** Creates a context containing state that is used to perform ... *//** The <code>CompositeContext</code> interface defines the encapsulated ... *//** Releases resources allocated for a context. *//** Composes the two source {@link Raster} objects and ... *//** Conditional is used by the EventDispatchThread's message pumps to ... */import PeerEvent/** A generic Abstract Window Toolkit(AWT) container object is a component ... */new ArrayList<Component>(...)new Component[]setContainerAccessor(...)AWTAccessor.ContainerAccessorvalidateUnconditionally(...)...[] EMPTY_ARRAY;List<Component> component;/** The components in this container. ... */LayoutManager layoutMgr;/** Layout manager for this container. ... */LightweightDispatcher dispatcher;/** Event router for lightweight components.  If this container ... */FocusTraversalPolicy focusTraversalPolicy;/** The focus traversal policy that will manage keyboard traversal of this ... */boolean focusCycleRoot;/** Indicates whether this Component is the root of a focus traversal cycle. ... */boolean focusTraversalPolicyProvider;/** Stores the value of focusTraversalPolicyProvider property. ... */Set<Thread> printingThreads;// keeps track of the threads that are printing this componentboolean printing;// True if there is at least one thread that's printing this componentint listeningChildren;/* HierarchyListener and HierarchyBoundsListener support */int listeningBoundsChildren;int descendantsCount;Color preserveBackgroundColor;/* Non-opaque window support -- see Window.setLayersOpaque *//** JDK 1.1 serialVersionUID */boolean INCLUDE_SELF;/** A constant which toggles one of the controllable behaviors ... */boolean SEARCH_HEAVYWEIGHTS;int numOfHWComponents;/* Number of HW or LW components in this container (including ... */int numOfLWComponents;/** Constructs a new Container. Containers can be extended directly, ... *//** Gets the number of components in this panel. ... *//** Gets the nth component in this container. ... */IndexOutOfBoundsException z/** Gets all the components in this container. ... */getComponents_NoClientCode(...)/* Wrapper for getComponents() method with a proper synchronization. *//** Determines the insets of this container, which indicate the size ... */insets(...)ContainerPeer cpeer/** Appends the specified component to the end of this container. ... */addImpl(...)/** Adds the specified component to this container. ... *//** Adds the specified component to this container at the given ... *//** Checks that the component ... */Container cncn.parent/** Checks that the component is not a Window instance. *//** Checks that the component comp can be added to this container ... */GraphicsConfiguration thisGCgetGraphicsConfiguration(...)Window thisTopLevelWindow compTopLevelcheckAddToSelf(...)checkNotAWindow(...)checkGD(...)/** Removes component comp from this container without making unneccessary changes ... */boolean needRemoveNotifyisRemoveNotifyNeeded(...)removeLayoutComponent(...)numListening(...)adjustDescendants(...)countHierarchyMembers(...)AWTEvent.CONTAINER_EVENT_MASKContainerEvent enew ContainerEvent(...)ContainerEvent.COMPONENT_REMOVEDHierarchyEvent.PARENT_CHANGED/** Checks whether this container can contain component which is focus owner. ... *//** Checks whether or not this container has heavyweight children. ... *//** Checks whether or not this container has lightweight children. ... *//** Returns closest heavyweight component to this container. If this container is heavyweight ... *//** Detects whether or not remove from current parent and adding to new parent requires call of ... */Container newNativeContainergetHeavyweightContainer(...)Container oldNativeContainernewContainer.peerboolean isContainerisReparentSupported(...)/** Moves the specified component to the specified z-order index in ... */Container curParentint oldZindexboolean peerRecreatedremoveDelicately(...)checkAdding(...)addDelicately(...)mixOnZOrderChanging(...)/** Traverses the tree of components and reparents children heavyweight component ... */reparentTraverse(...)reparent(...)/** Reparents child component peer to this container peer. ... *//** Adds component to this container. Tries to minimize side effects of this adding - ... */reparentChild(...)ContainerEvent.COMPONENT_ADDEDcanBeFocusOwnerRecursively(...)isParentOf(...)/** Returns the z-order index of the component inside the container. ... *//** Adds the specified component to the end of this container. ... *//** Adds the specified component to this container with the specified ... *//** Adds the specified component to this container at the specified ... *//** Checks that all Components that this Container contains are on ... *//** Removes the component, specified by <code>index</code>, ... *//** Removes the specified component from this container. ... *//** Removes all the components from this container. ... */int superListeningboolean toAssertadjustDecendantsOnParent(...)int listenersgetListenersCount(...)/** Gets the layout manager for this container. ... *//** Sets the layout manager for this container. ... *//** Causes this container to lay out its components.  Most programs ... */LayoutManager layoutMgrthis.layoutMgr/** Indicates if this container is a <i>validate root</i>. ... */boolean isJavaAwtSmartInvalidate;/** Invalidates the parent of the container unless the container ... *//** Invalidates the container. ... */LayoutManager2 lminvalidateLayout(...)/** Validates this container and all of its subcomponents. ... */boolean updateCurContainerPeer pbeginValidate(...)validateTree(...)endValidate(...)boolean descendUnconditionallyWhenValidating;/** Indicates whether valid containers should also traverse their ... *//** Unconditionally validate the component hierarchy. *//** Recursively descends the container tree and recomputes the ... */beginLayout(...)doLayout(...)endLayout(...)/** Recursively descends the container tree and invalidates all ... */invalidateTree(...)/** Sets the font of this container. ... */boolean shouldinvalidate/** Returns the preferred size of this container.  If the preferred size has ... *//** Returns the minimum size of this container.  If the minimum size has ... *//** Returns the maximum size of this container.  If the maximum size has ... */maximumLayoutSize(...)float xAligngetLayoutAlignmentX(...)getAlignmentX(...)float yAligngetLayoutAlignmentY(...)getAlignmentY(...)/** Paints the container. This forwards the paint to any lightweight ... */runComponents(...)getComponentsSync(...)GraphicsCallback.PaintCallback/** Updates the container.  This forwards the update to any lightweight ... *//** Prints the container. This forwards the print to any lightweight ... */new HashSet<Thread>(...)GraphicsCallback.PrintCallback/** Paints each of the components in this container. ... */GraphicsCallback.TWO_PASSESGraphicsCallback.PaintAllCallbacklightweightPaint(...)paintHeavyweightComponents(...)GraphicsCallback.PaintHeavyweightComponentsCallback/** Prints each of the components in this container. ... */GraphicsCallback.PrintAllCallbacklightweightPrint(...)printHeavyweightComponents(...)GraphicsCallback.PrintHeavyweightComponentsCallback/** Adds the specified container listener to receive container events ... *//** Removes the specified container listener so it no longer receives ... *//** Returns an array of all the container listeners ... *//** Processes events on this container. If the event is a ... */processContainerEvent(...)/** Processes container events occurring on this container by ... */ContainerListener listener/* Dispatches an event to this component or one of its sub components. ... *//* Dispatches an event to this component, without trying to forward ... *//** Fetchs the top-most (deepest) lightweight component that is interested ... */getMouseEventTarget(...)MouseEventTargetFilter.FILTER/** Fetches the top-most (deepest) component to receive SunDropTargetEvents. */DropTargetEventTargetFilter.FILTER/** A private version of getMouseEventTarget which has two additional ... */getMouseEventTargetImpl(...)/** A private version of getMouseEventTarget which has three additional ... */boolean isPeerOKboolean isMouseOverMecomp.visibleContainer childComponent deeperchild.xchild.ynew MouseEventTargetFilter(...)EventTargetFilter FILTER;comp.eventMaskcomp.mouseListenercomp.mouseMotionListenercomp.mouseWheelListenernew DropTargetEventTargetFilter(...)DropTarget dtgetDropTarget(...)/** This is called by lightweight components that want the containing ... */deliverEvent(...)/** Locates the component that contains the x,y position.  The ... */Component lightweight/** Gets the component that contains the specified point. ... *//** Returns the position of the mouse pointer in this <code>Container</code>'s ... *//** Locates the visible child component that contains the specified ... *//** Private version of findComponentAt which has a controllable ... */findComponentAtImpl(...)Component childgetChildAt(...)/** Helper method for findComponentAtImpl. Finds a child component using ... */comp.enabled/** Makes this Container displayable by connecting it to ... */new LightweightDispatcher(...)/** Makes this Container undisplayable by removing its connection ... */setAutoFocusTransferOnDisposal(...)/** Checks if the component is contained in the component hierarchy of ... */Component modalComp;/* The following code was added to support modal JInternalFrames ... */AppContext modalAppContext;Component predictedFocusOwnerRunnable pumpEventsForHierarchyEventDispatchThread dispatchThreadpumpEventsForHierarchy(...)Container.thisnativeContainer.modalCompenqueueKeyEvents(...)this.modalCompSequencedEvent currentSequencedEventgetCurrentSequencedEvent(...)new PeerEvent(...)PeerEvent.PRIORITY_EVENTnew WakingRunnable(...)/** Returns a string representing the state of this <code>Container</code>. ... *//* End of JOptionPane support code *//** Prints a listing of this container to the specified output ... *//** Prints out a list, starting at the specified indentation, ... */Container currentFocusCycleRootgetCurrentFocusCycleRoot(...)/** Check if this component is the child of this container or its children. ... */boolean resetComponent storedCompgetTemporaryLostComponent(...)setTemporaryLostComponent(...)KeyboardFocusManager kfmfindTraversalRoot(...)/** Sets the focus traversal policy that will manage keyboard traversal of ... */FocusTraversalPolicy oldPolicythis.focusTraversalPolicy/** Returns the focus traversal policy that will manage keyboard traversal ... */isFocusTraversalPolicyProvider(...)getDefaultFocusTraversalPolicy(...)/** Returns whether the focus traversal policy has been explicitly set for ... *//** Sets whether this Container is the root of a focus traversal cycle. Once ... */boolean oldFocusCycleRootthis.focusCycleRoot/** Returns whether this Container is the root of a focus traversal cycle. ... *//** Sets whether this container will be used to provide focus ... */boolean oldProvider/** Returns whether this container provides focus traversal ... *//** Transfers the focus down one focus traversal cycle. If this Container is ... */CausedFocusEvent.Cause.TRAVERSAL_DOWNpostProcessKeyEvent(...)/** Sets the <code>ComponentOrientation</code> property of this container ... */int containerSerializedDataVersion;/** Container Serial Data Version. */// parent fields of its component children.// Serialization support. A Container is responsible for restoring the/** Serializes this <code>Container</code> to the specified ... *//** Deserializes this <code>Container</code> from the specified ... */Component[] tmpComponentList<Component> componentObject policy/** Inner class of Container used to provide default support for ... *//** JDK1.3 serialVersionUID *//** Returns the <code>Accessible</code> child, if one exists, ... */ContainerListener accessibleContainerHandler;/** Fire <code>PropertyChange</code> listener, if one is registered, ... */AccessibleAWTContainer.this/** Adds a PropertyChangeListener to the listener list. ... */new AccessibleContainerHandler(...)/** Returns the <code>Accessible</code> child contained at the local ... */// inner class AccessibleAWTContainerint nchildrenPoint npComponent retint addHWint addLW(...).numOfLWComponents(...).numOfHWComponentscont.numOfLWComponentscont.numOfHWComponentsint subHWint subLW/* This method is overriden to handle opaque children in non-opaque ... */getUnion(...)getTopmostComponentIndex(...)getBottommostComponentIndex(...)subtractAndApplyShape(...)recursiveShowHeavyweightChildren(...)recursiveHideHeavyweightChildren(...)Point newOriginrecursiveRelocateHeavyweightChildren(...)origin.xorigin.y/** Checks if the container and its direct lightweight containers are ... */boolean isMixingNeeded/** Class to manage the dispatching of MouseEvents to the lightweight descendants ... */int[] buttonsDownMaskgetButtonDownMasks(...)getInputEventAccessor(...)int buttonDownMaskint LWD_MOUSE_DRAGGED_OVER;/* Our own mouse event for when we're dragged over from another hw ... */int BUTTONS_DOWN_MASK;this.nativeContainernew WeakReference<Component>(...)/* Clean up any resources allocated when dispatcher was created; ... */stopListeningForOtherDrags(...)/** Enables events to subcomponents. *//** Dispatches an event to a sub-component if necessary, and ... */SunDropTargetEvent sddeprocessDropTargetEvent(...)/* This method effectively returns whether or not a mouse button was down ... */getModifiersEx(...)getMaskForButton(...)getButton(...)/** This method attempts to distribute a mouse event to a lightweight ... */Component mouseOverContainer.INCLUDE_SELFComponent mettrackMouseEnterExit(...)isMouseGrab(...)retargetMouseEvent(...)getDropTargetEventTarget(...)SunDropTargetEvent.MOUSE_ENTEREDSunDropTargetEvent.MOUSE_EXITED/* Generates dnd enter/exit events as mouse moves over lw components ... */Component tleretargetMouseEnterExit(...)/* Generates enter/exit events as mouse moves over lw components ... */trackDropTargetEnterExit(...)startListeningForOtherDrags(...)Component targetEnter/* Listens to global mouse drag events so even drags originating ... */LightweightDispatcher.thisremoveAWTEventListener(...)/* (Implementation of AWTEventListener) ... */boolean isForeignDragMouseEvent srcEventComponent targetOverComponent srcComponentPoint ptSrcOriginisModalBlocked(...)nativeContainer.appContextMouseEvent mouseEventPoint ptDstOrigintranslatePoint(...)ptSrcOrigin.xptDstOrigin.xptSrcOrigin.yptDstOrigin.yexecuteOnEventHandlerThread(...)/** Sends a mouse event to the current mouse event recipient using ... */MouseEvent retargetedcomponent.xcomponent.ynew SunDropTargetEvent(...)getDispatcher(...)target.appContextisAncestorOf(...)Container nativeContainer;/** The windowed container that might be hosting events for ... */// --- member variables -------------------------------Component focus;/** This variable is not used, but kept for serialization compatibility */WeakReference<Component> mouseEventTarget;/** The current subcomponent being hosted by this windowed ... */WeakReference<Component> targetLastEntered;/** The last component entered by the {@code MouseEvent}. */WeakReference<Component> targetLastEnteredDT;/** The last component entered by the {@code SunDropTargetEvent}. */boolean isMouseInNativeContainer;/** Is the mouse over the native container. */boolean isMouseDTInNativeContainer;/** Is DnD over the native container. */Cursor nativeCursor;/** The event mask for contained lightweight components.  Lightweight ... */long PROXY_EVENT_MASK;/** The kind of events routed to lightweight components from windowed ... */long MOUSE_MASK;// This method is not synchronized under AWT tree lock.// Instead, the calling code is responsible for the// synchronization. See 6784816 for details.// We should remove component and then// add it by the newIndex without newIndex decrement if even we shift components to the left// after remove. Consult the rules below:// 2->4: 012345 -> 013425, 2->5: 012345 -> 013452// 4->2: 012345 -> 014235// was actually removed// Component didn't have parent - no removeNotify// Component didn't have peer - no removeNotify// Component has peer but new Container doesn't - call removeNotify// If component is lightweight non-Container or lightweight Container with all but heavyweight// children there is no need to call remove notify// If this point is reached, then the comp is either a HW or a LW container with HW descendants.// All three components have peers, check for peer change// Native containers change - check whether or not current platform supports// changing of widget hierarchy on native level without recreation.// The current implementation forbids reparenting of LW containers with HW descendants// into another native container w/o destroying the peers. Actually such an operation// is quite rare. If we ever need to save the peers, we'll have to slightly change the// addDelicately() method in order to handle such LW containers recursively, reparenting// each HW descendant independently.// Store parent because remove will clear it// If the oldZindex == -1, the component gets inserted,// rather than it changes its z-order.// The new 'index' cannot be == -1.// It gets checked at the checkAdding() method.// Therefore both oldZIndex and index denote// some existing positions at this point and// this is actually a Z-order changing.// If components is lightweight check if it is container// If it is container it might contain heavyweight children we need to reparent// Q: Need to update NativeInLightFixer?// If component is lightweight container we need to reparent all its explicit  heavyweight children// Traverse component's tree till depth-first until encountering heavyweight component// Check if moving between containers//index == -1 means add to the end.// Remove notify was called or it didn't have peer - create new one// Both container and child have peers, it means child peer should be reparented.// In both cases we need to reparent native widgets.// Native container changed - need to reparent native widgets// If component is heavyweight and one of the containers is lightweight// the location of the component should be fixed./* Notify the layout manager of the added component. */// If component is focus owner or parent container of focus owner check that after reparenting// focus owner moved out if new container prohibit this kind of focus owner.// Quick check - container should be immediate parent of the component/* Check for correct arguments:  index in bounds, ... *//* Reparent the component and tidy up the tree's state. */// Verify listeningChildren is correct// Verify listeningBoundsChildren is correct// assert false;// Verify descendantsCount is correct// Don't lazy-read because every app uses invalidate()// Avoid updating cursor if this is an internal call.// See validateUnconditionally() for details.// The container is showing on screen and// this paint() is not called from print().// Paint self and forward the paint to lightweight subcomponents.// super.paint(); -- Don't bother, since it's a NOP.// By default, Component.print() calls paint()// event was sent to a lightweight component.  The// native-produced event sent to the native container// must be properly disposed of by the peer, so it// gets forwarded.  If the native host has been removed// as a result of the sending the lightweight event,// the peer reference will be null.// found a component that intersects the point, see if there// is a deeper possibility.// there isn't a deeper target, but this component// is a target// didn't find a child target, return this component if it's// a possible target// no possible target// this container is lightweight.... continue sending it// upward.// This is a native container, so it needs to host// one of it's children.  If this function is called before// a peer has been created we don't yet have a dispatcher// because it has not yet been determined if this instance// is lightweight.// Optimized version of two passes:// see comment in sun.awt.SunGraphicsCallback// return heavyweight component as soon as possible// save and return later the first lightweight component// checkTreeLock(); commented for a performance reason// addNotify() on the children may cause proxy event enabling// on this instance, so we first call super.addNotify() and// possibly create an lightweight event dispatcher before calling// addNotify() on the children which may be lightweight.// We shouldn't use iterator because of the Swing menu// implementation specifics:// the menu is being assigned as a child to JLayeredPane// instead of particular component so always affect// collection of component if menu is becoming shown or hidden.// Fix for 6607170.// We want to suppress focus change on disposal// of the focused component. But because of focus// is asynchronous, we should suppress focus change// on every component in case it receives native focus// in the process of disposal.// If some of the children had focus before disposal then it still has.// Auto-transfer focus to the next (or previous) component if auto-transfer// is enabled.// Store the app context on which this component is being shown.// Event dispatch thread of this app context will be sleeping until// we wake it by any event from hideAndDisposeHandler().// keep the KeyEvents from being dispatched// until the focus has been transfered// We have two mechanisms for blocking: 1. If we're on the// EventDispatchThread, start a new event pump. 2. If we're// on any other thread, call wait() on the treelock.// Wake up event dispatch thread on which the dialog was// initially shown// Don't call super.setFocusTraversalKey. The Component parameter check// does not allow DOWN_CYCLE_TRAVERSAL_KEYS, but we do.// Don't call super.getFocusTraversalKey. The Component parameter check// does not allow DOWN_CYCLE_TRAVERSAL_KEY, but we do.// I potentially have two roots, myself and my root parent// If I am the current root, then use me// If none of my parents are roots, then use me// If my root parent is the current root, then use my root parent// If neither I nor my root parent is the current root, then// use my root parent (a guess)// This synchronized should always be the second in a pair// (tree lock, KeyboardFocusManager.class)// Old stream. Doesn't contain maxSize among Component's fields.// JDK 1.1/1.2/1.3 instances will not have this optional data.// e.eof will be true to indicate that there is no more data// available for this object. If e.eof is not true, throw the// exception as it might have been caused by reasons unrelated to// focusTraversalPolicy.// An invalid container with not-null layout should be ignored// by the mixing code, the container will be validated later// and the mixing code will be executed later.//System.out.println("Disposing lw dispatcher");/* Fix for BugTraq Id 4389284. ... *//* modifiers now as just before event */// sensitive to mouse events// 4508327 : MOUSE_CLICKED should only go to the recipient of// the accompanying MOUSE_PRESSED, so don't reset mouseEventTarget on a// MOUSE_CLICKED.// 4508327: MOUSE_CLICKED should never be dispatched to a Component// other than that which received the MOUSE_PRESSED event.  If the// mouse is now over a different Component, don't dispatch the event.// The previous fix for a similar problem was associated with bug// 4155217.// This may send it somewhere that doesn't have MouseWheelEvents// enabled.  In this case, Component.dispatchEventImpl() will// retarget the event to a parent that DOES have the events enabled.//Consuming of wheel events is implemented in "retargetMouseEvent"./* Fix for BugTraq ID 4395290. ... */// not necessarily sensitive to mouse events// This can happen if a lightweight component which initiated the// drag has an associated drop target. MOUSE_ENTERED comes when the// mouse is in the native container already. To propagate this event// properly we should null out targetLastEntered.// any event but an exit or drag means we're in the native container// consume native exit event if we generate one// consume native enter event if we generate one//System.out.println("Adding AWTEventListener");//System.out.println("Removing AWTEventListener");// only interested in drags from other hw components// component may have disappeared since drag event posted// (i.e. Swing hierarchical menus)// see 5083555// check if srcComponent is in any modal blocked window// create an internal 'dragged-over' event indicating// we are being dragged over from another hw component// translate coordinates to this native container//System.out.println("Track event: " + me);// feed the 'dragged-over' event directly to the enter/exit// code (not a real event so don't pass it to dispatchEvent)// mouse is over another hw component or target is disabled// avoid recursively calling LightweightDispatcher...//An exception for wheel bubbling to the native system.//In "processMouseEvent" total event consuming for wheel events is skipped.//Protection from bubbling of Java-accepted wheel events./** A FocusTraversalPolicy that determines traversal order based on the order ... */int FORWARD_TRAVERSAL;int BACKWARD_TRAVERSAL;/* JDK 1.4 serialVersionUID */boolean implicitDownCycleTraversal;Container cachedRoot;/** Used by getComponentAfter and getComponentBefore for efficiency. In ... */List<Component> cachedCycle;/* protected *//* We suppose to use getFocusTraversalCycle & getComponentIndex methods in order ... */List<Component> cycleenumerateCycle(...)Container aContContainer ftp/* Checks if a new focus cycle takes place and returns a Component to traverse focus to. ... */Component retCompgetImplicitDownCycleTraversal(...)getLastComponent(...)/** Returns the Component that should receive the focus after aComponent. ... */getComponentDownCycle(...)Container providergetTopmostProvider(...)getFocusTraversalCycle(...)getComponentIndex(...)Component afterCompgetFirstComponent(...)this.cachedRootthis.cachedCycle/** Returns the Component that should receive the focus before aComponent. ... */Component tryCompComponent beforeComp/** Returns the first Component in the traversal cycle. This method is used ... *//** Returns the last Component in the traversal cycle. This method is used ... *//** Returns the default Component to focus. This Component will be the first ... *//** Sets whether this ContainerOrderFocusTraversalPolicy transfers focus ... */this.implicitDownCycleTraversal/** Returns whether this ContainerOrderFocusTraversalPolicy transfers focus ... *//** Determines whether a Component is an acceptable choice as the new ... */Container enableTest// Before all the ckecks below we first see if it's an FTP provider or a focus cycle root.// If it's the case just go down cycle (if it's set to "implicit").// See if the component is inside of policy provider.// FTP knows how to find component after the given. We don't.// Null result means that we overstepped the limit of the FTP's cycle.// In that case we must quit the cycle, otherwise return the component found.// If the provider is traversable it's returned.// Verify that the Component is recursively enabled. Disabling a// heavyweight Container disables its children, whereas disabling// a lightweight Container does not./** A class to encapsulate the bitmap representation of the mouse cursor. ... */new Cursor[]new Hashtable<String,Cursor>(...)initCursorDir(...)setCursorAccessor(...)AWTAccessor.CursorAccessorcursor.pDatacursor.typeint DEFAULT_CURSOR;/** The default cursor type (gets set if no cursor is defined). */int CROSSHAIR_CURSOR;/** The crosshair cursor type. */int TEXT_CURSOR;/** The text cursor type. */int WAIT_CURSOR;/** The wait cursor type. */int SW_RESIZE_CURSOR;/** The south-west-resize cursor type. */int SE_RESIZE_CURSOR;/** The south-east-resize cursor type. */int NW_RESIZE_CURSOR;/** The north-west-resize cursor type. */int NE_RESIZE_CURSOR;/** The north-east-resize cursor type. */int N_RESIZE_CURSOR;/** The north-resize cursor type. */int S_RESIZE_CURSOR;/** The south-resize cursor type. */int W_RESIZE_CURSOR;/** The west-resize cursor type. */int E_RESIZE_CURSOR;/** The east-resize cursor type. */int HAND_CURSOR;/** The hand cursor type. */int MOVE_CURSOR;/** The move cursor type. */...[] predefined;...[] predefinedPrivate;/** This field is a private replacement for 'predefined' array. */...[] cursorProperties;/* Localization names and default values *//** The chosen cursor type initially set to ... */int CUSTOM_CURSOR;/** The type associated with all custom cursors. */Hashtable<String,Cursor> systemCustomCursors;/* hashtable, filesystem dir prefix, filename, and properties for custom cursors support */String systemCustomCursorDirPrefix;String jhomeString systemCustomCursorPropertiesFile;Properties systemCustomCursorProperties;String CursorDotPrefix;String DotFileSuffix;String DotHotspotSuffix;String DotNameSuffix;/** Hook into native data. */Object anchor;finalizeImpl(...)CursorDisposer disposer;new CursorDisposer(...)disposer.pData/** The user-visible name of the cursor. ... *//** Returns a cursor object with the specified predefined type. ... */Cursor cCursor.MOVE_CURSORnew Cursor(...)/** Returns a system-specific custom cursor object matching the ... */String localizedString hotspotloadSystemCustomCursorProperties(...)new AWTException(...)int fxint fyString flocalizedcreateCustomCursor(...)/** Return the system default cursor. *//** Creates a new cursor object with the specified type. ... *//** Creates a new custom cursor object with the specified name.<p> ... */Cursor.CUSTOM_CURSOR/** Returns the type for this cursor. *//** Returns the name of this cursor. ... *//** Returns a string representation of this cursor. ... *//* load the cursor.properties file */// anchor is null after deserialization// fill 'predefined' array for backwards compatibility.// Lookup localized name.isFocusTraversableOverridden(...)import FocusEventimport TimedWindowEvent/** The default KeyboardFocusManager for AWT applications. Focus traversal is ... */new LinkedList<KeyEvent>(...)new LinkedList<TypeAheadMarker>(...)new WeakReference<Window>(...)setDefaultKeyboardFocusManagerAccessor(...)AWTAccessor.DefaultKeyboardFocusManagerAccessorconsumeNextKeyTyped(...)WeakReference<Window> NULL_WINDOW_WR;// null weak references to not create too many objectsWeakReference<Component> NULL_COMPONENT_WR;WeakReference<Window> realOppositeWindowWR;WeakReference<Component> realOppositeComponentWR;int inSendMessage;LinkedList<KeyEvent> enqueuedKeyEvents;LinkedList<TypeAheadMarker> typeAheadMarkers;boolean consumeNextKeyTyped;long after;Component untilFocused;this.afterthis.untilFocused/** Returns string representation of the marker *//* This series of restoreFocus methods is used for recovering from a ... */Component realOppositeComponentthis.realOppositeComponentWRComponent vetoedComponentrestoreFocus(...)doRestoreFocus(...)getOppositeComponent(...)Window realOppositeWindowthis.realOppositeWindowWRgetOppositeWindow(...)CausedFocusEvent.Cause.ROLLBACKComponent nextFocus/** A special type of SentEvent which updates a counter in the target ... */KeyboardFocusManager managerDefaultKeyboardFocusManager defaultManagerdefaultManager.inSendMessage/** Sends a synthetic AWTEvent to a Component. If the Component is in ... */AppContext myAppContextAppContext targetAppContextSentEvent senew DefaultKeyboardFocusManagerSentEvent(...)EventDispatchThread edtpumpEvents(...)SentEvent.IDse.dispatched/* Checks if the focus window event follows key events waiting in the type-ahead ... */TimedWindowEvent weTypeAheadMarker markerWindow toplevelmarker.untilFocusedisFocused(...)new SequencedEvent(...)/** This method is called by the AWT event dispatcher requesting that the ... */WindowEvent.WINDOW_GAINED_FOCUSWindowEvent weWindow oldFocusedWindowgetGlobalFocusedWindow(...)Window newFocusedWindowWindow newActiveWindowgetOwningFrameDialog(...)Window currentActiveWindowgetGlobalActiveWindow(...)repostIfFollowsKeyEvents(...)boolean isEventDispatchednew WindowEvent(...)WindowEvent.WINDOW_LOST_FOCUSsetGlobalFocusOwner(...)setGlobalFocusedWindow(...)Component tempLostgetInitialComponent(...)typeAheadAssertions(...)Window oldActiveWindowsetGlobalActiveWindow(...)FocusEvent feCause causeComponent oldFocusOwnergetGlobalFocusOwner(...)Component newFocusOwnerWindow currentFocusedWindownew CausedFocusEvent(...)isTemporary(...)getGlobalPermanentFocusOwner(...)setNativeFocusOwner(...)getHeavyweight(...)(...).isPostedComponent currentFocusOwnerWindow owningWindowWindow losingFocusWindowWindow activeWindowWindow oppositeWindowComponent oppositeComp/** Called by <code>dispatchEvent</code> if no other ... */boolean stopPostProcessingList<KeyEventPostProcessor> processorsgetKeyEventPostProcessors(...)redispatchEvent(...)Iterator<KeyEventPostProcessor> iter/** This method will be called by <code>dispatchKeyEvent</code>. It will ... */Component targetmarker.afterpreDispatchKeyEvent(...)/** Dumps the list of type-ahead queue markers to stderr */Iterator<TypeAheadMarker> iterpumpApprovedKeyEvents(...)addLast(...)dumpMarkers(...)hasMarker(...)next(...).untilFocused/** Returns true if there are some marker associated with component <code>comp</code> ... *//** Clears markers queue ... */List<KeyEventDispatcher> dispatchersgetKeyEventDispatchers(...)getFocusedWindow(...)isProxyActive(...)Iterator<KeyEventDispatcher> iterdispatchKeyEvent(...)/* @param e is a KEY_PRESSED event that can be used ... *//* return true if event was consumed *//** This method initiates a focus traversal operation if and only if the ... */consumeProcessedKeyEvent(...)getFocusTraversalKeysEnabled(...)getAWTKeyStrokeForEvent(...)AWTKeyStroke oppStrokegetAWTKeyStroke(...)isOnKeyRelease(...)Set<AWTKeyStroke> toTestboolean containsboolean containsOppconsumeTraversalKey(...)focusNextComponent(...)focusPreviousComponent(...)upFocusCycle(...)downFocusCycle(...)/** Delays dispatching of KeyEvents until the specified Component becomes ... */int insertionIndexListIterator<TypeAheadMarker> iternew TypeAheadMarker(...)/** Releases for normal dispatching to the current focus owner all ... *//** Discards all KeyEvents which were enqueued because of one or more calls ... */Component toTestpurgeStampedEvents(...)//     queue will be removed//   * if 'end' is < 0, then all KeyEvents from 'start' to the end of the//   * if 'start' is < 0, then this function does nothing//   * must be called inside a synchronized block// Notes:Iterator<KeyEvent> iter/** Focuses the Component before aComponent, typically based on a ... *//** Focuses the Component after aComponent, typically based on a ... *//** Moves the focus up one focus traversal cycle. Typically, the focus owner ... */transferFocusUpCycle(...)/** Moves the focus down one focus traversal cycle. If aContainer is a focus ... */transferFocusDownCycle(...)// do nothing, everything is done in restoreFocus()// Check that the component awaiting focus belongs to// the current focused window. See 8015454.// we can not accept focus on such window, so reject it.// If there exists a current focused window, then notify it// that it has lost focus.// Failed to dispatch, clear by ourselfves// Because the native libraries do not post WINDOW_ACTIVATED// events, we need to synthesize one if the active Window// changed.// Activation change was rejected. Unlikely, but// possible.// Focus change was rejected. Will happen if// newFocusedWindow is not a focusable Window.// Restore focus to the Component which last held it. We do// this here so that client code can override our choice in// a WINDOW_GAINED_FOCUS handler.// Make sure that the focus change request doesn't change the// focused Window in case we are no longer the focused Window// when the request is handled.// Identify which Component should initially gain focus// in the Window.// * If we're in SendMessage, then this is a synthetic//   WINDOW_GAINED_FOCUS message which was generated by a//   the FOCUS_GAINED handler. Allow the Component to//   which the FOCUS_GAINED message was targeted to//   receive the focus.// * Otherwise, look up the correct Component here.//   We don't use Window.getMostRecentFocusOwner because//   window is focused now and 'null' will be returned// Calculating of most recent focus owner and focus// request should be synchronized on KeyboardFocusManager.class// to prevent from thread race when user will request// focus between calculation and our request.// But if focus transfer is synchronous, this synchronization// may cause deadlock, thus we don't synchronize this block.// The component which last has the focus when this window was focused// should receive focus first// If there is a component which requested focus when this window// was inactive it expects to receive focus after activation.// If there exists a current active window, then notify it that// it has lost activation.// We can't just drop the event - there could be// type-ahead markers associated with it.// If there exists a current focus owner, then notify it that// it has lost focus.// Because the native windowing system has a different notion// of the current focus and activation states, it is possible// that a Component outside of the focused Window receives a// FOCUS_GAINED event. We synthesize a WINDOW_GAINED_FOCUS// event in that case.// Need to recover type-ahead, but don't bother// restoring focus. That was done by the// WINDOW_GAINED_FOCUS handler// Refuse focus on a disabled component if the focus event// isn't of UNKNOWN reason (i.e. not a result of a direct request// but traversal, activation or system generated).// we should not accept focus on such component, so reject it.// If FOCUS_GAINED is for a disposed component (however// it shouldn't happen) its toplevel parent is null. In this// case we have to try to restore focus in the current focused// window (for the details: 6607170).// see: 8013773// newFocusOwner is not focus traversable.// Focus change was rejected. Unlikely, but possible.// Ignore cases where a Component loses focus to itself.// If we make a mistake because of retargeting, then the// FOCUS_GAINED handler will correct it.// The event is lost in time.// Allow listeners to precess the event but do not// change any global states// Activation change was rejected. Unlikely, but possible.// Special case -- if the native windowing system posts an// event claiming that the active Window has lost focus to the// focused Window, then discard the event. This is an artifact// of the native windowing system not knowing which Window is// really focused.// The focus owner should always receive a FOCUS_LOST event// before the Window is defocused.// Then we need to deactive the active Window as well.// No need to synthesize in other cases, because// WINDOW_ACTIVATED will handle it if necessary.// Activation change was rejected. Unlikely,// but possible.// Allow the peer to process KeyEvent// Fixed 5064013: may appears that the events have the same time// if (ke.getWhen() >= marker.after) {// The fix is rolled out.// Clear any pending events here as well as in the FOCUS_GAINED// handler. We need this call here in case a marker was removed in// response to a call to dequeueKeyEvents.// KeyEvent was posted before focus change request// Search the marker list for the first marker tied to// the Component which just gained focus. Then remove// that marker, any markers which immediately follow// and are tied to the same component, and all markers// that preceed it. This handles the case where// multiple focus requests were made for the same// Component in a row and when we lost some of the// earlier requests. Since FOCUS_GAINED events will// not be generated for these additional requests, we// need to clear those markers too.// Exception condition - event without marker// Now, dispatch any pending KeyEvents which have been// released because of the FOCUS_GAINED event so that we don't// have to wait for another event to be posted to the queue.// Explicitly set the key event timestamp here (not in Component.dispatchEventImpl):// - A key event is anyway passed to this method which starts its actual dispatching.// - If a key event is put to the type ahead queue, its time stamp should not be registered//   until its dispatching actually starts (by this method)./** Fix for 4495473. ... *//** Fix for 4478780 - consume event after it was dispatched by peer. */// consume processed event if needed// KEY_TYPED events cannot be focus traversal keys// Fix for 6637607: consumeNextKeyTyped should be reset.import AWTPermissionimport GraphicsEnvironmentimport HeadlessExceptionimport DesktopPeerimport HeadlessToolkitimport SecurityConstants/** The {@code Desktop} class allows a Java application to launch ... *//** Represents an action type.  Each platform supports a different ... */new Action(...)Action OPEN;/** Represents an "open" action. ... */Action EDIT;/** Represents an "edit" action. ... */Action PRINT;/** Represents a "print" action. ... */Action MAIL;/** Represents a "mail" action. ... */Action BROWSE;/** Represents a "browse" action. ... */DesktopPeer peer;/** Suppresses default constructor for noninstantiability. */createDesktopPeer(...)/** Returns the <code>Desktop</code> instance of the current ... */AppContext contextDesktop desktopisDesktopSupported(...)new Desktop(...)/** Tests whether this class is supported on the current platform. ... */Toolkit defaultToolkit/** Tests whether an action is supported on the current platform. ... *//** Checks if the file is a valid file and readable. ... *//** Checks if the action type is supported. ... *//** Calls to the security manager's <code>checkPermission</code> method with ... *//** Launches the associated application to open the file. ... */checkAWTPermission(...)checkExec(...)checkActionSupport(...)Action.OPENcheckFileValidation(...)/** Launches the associated editor application and opens a file for ... */Action.EDITcanWrite(...)edit(...)/** Prints a file with the native desktop printing facility, using ... */checkPrintJobAccess(...)Action.PRINT/** Launches the default browser to display a {@code URI}. ... */SecurityException securityExceptionDesktopBrowse dbAction.BROWSEbrowse(...)/** Launches the mail composing window of the user default mail ... */URI mailtoURIAction.MAILmail(...)URISyntaxException eSecurityConstants.FILE_EXECUTE_ACTION// Calling thread doesn't have necessary priviledges.// Delegate to DesktopBrowse so that it can work in// applet/webstart.// Not in webstart/applet, throw the exception.// won't reach here.import DialogPeerimport AtomicLongimport IdentityArrayListimport IdentityLinkedList/** A Dialog is a top-level window with a title and a border ... */new IdentityArrayList<Window>(...)ModalityType.APPLICATION_MODALnew IdentityArrayList<Dialog>(...)boolean resizable;/** A dialog's resizable property. Will be true ... */boolean undecorated;/** This field indicates whether the dialog is undecorated. ... *//** Modal dialogs block all input to some top-level windows. ... */new ModalityType(...)ModalityType MODELESS;/** <code>MODELESS</code> dialog doesn't block any top-level windows. */ModalityType DOCUMENT_MODAL;/** A <code>DOCUMENT_MODAL</code> dialog blocks input to all top-level windows ... */ModalityType APPLICATION_MODAL;/** An <code>APPLICATION_MODAL</code> dialog blocks all top-level windows ... */ModalityType TOOLKIT_MODAL;/** A <code>TOOLKIT_MODAL</code> dialog blocks all top-level windows run ... */ModalityType DEFAULT_MODALITY_TYPE;/** Default modality type for modal dialogs. The default modality type is ... */boolean modal;/** True if this dialog is modal, false is the dialog is modeless. ... */ModalityType modalityType;/** Modality type of this dialog. If the dialog's modality type is not ... *//** Any top-level window can be marked not to be blocked by modal ... */new ModalExclusionType(...)ModalExclusionType NO_EXCLUDE;/** No modal exclusion. */ModalExclusionType APPLICATION_EXCLUDE;/** <code>APPLICATION_EXCLUDE</code> indicates that a top-level window ... */ModalExclusionType TOOLKIT_EXCLUDE;/** <code>TOOLKIT_EXCLUDE</code> indicates that a top-level window ... */IdentityArrayList<Dialog> modalDialogs;/* operations with this list should be synchronized on tree lock */IdentityArrayList<Window> blockedWindows;String title;/** Specifies the title of the Dialog. ... */ModalEventFilter modalFilter;SecondaryLoop secondaryLoop;boolean isInHide;/* Indicates that this dialog is being hidden. This flag is set to true at ... */boolean isInDispose;/* Indicates that this dialog is being disposed. This flag is set to true at ... *//** Constructs an initially invisible, modeless <code>Dialog</code> with ... *//** Constructs an initially invisible <code>Dialog</code> with the specified ... *//** Constructs an initially invisible <code>Dialog</code> with the ... */ModalityType.MODELESS/** Constructs an initially invisible <code>Dialog</code> with the specified owner ... *//** Constructs an initially invisible, modeless <code>Dialog</code> ... *//** Constructs an initially invisible, modeless <code>Dialog</code> with the ... */this.titlesetModalityType(...)checkAndSetPolicy(...)/** Makes this Dialog displayable by connecting it to ... */createDialog(...)/** Indicates whether the dialog is modal. ... */isModal_NoClientCode(...)/** Specifies whether this dialog should be modal. ... */this.modal/** Returns the modality type of this dialog. ... *//** Sets the modality type for this dialog. See {@link ... */Dialog.ModalityType.MODELESSDialog.ModalityTypeisModalityTypeSupported(...)checkModalityPermission(...)/** Gets the title of the dialog. The title is displayed in the ... *//** Sets the title of the Dialog. ... */String oldTitleDialogPeer peersetTitle(...)closeSplashScreen(...)toFront(...)isModal(...)checkShouldBeBlocked(...)modalShow(...)setLocationByPlatform(...)Window childchild.showWithParentupdateChildFocusableWindowState(...)postWindowEvent(...)/** Shows or hides this {@code Dialog} depending on the value of parameter ... *//** Makes the {@code Dialog} visible. If the dialog and/or its owner ... */conditionalShow(...)AppContext showAppContextAtomicLong timenew AtomicLong(...)Conditional condcreateFilterForDialog(...)ModalityType.TOOLKIT_MODALIterator<AppContext> itgetAppContexts(...)EventQueue eventQueueAppContext.EVENT_QUEUE_KEYRunnable createEDTgetDispatchThread(...)new InvocationEvent(...)addEventFilter(...)modalityPushed(...)getSystemEventQueue(...)createSecondaryLoop(...)enter(...)modalityPopped(...)removeEventFilter(...)SunToolkit stknotifyModalityPushed(...)notifyModalityPopped(...)disposeImpl(...)modalHide(...)/** Hides the Dialog and then causes {@code show} to return if it is currently ... */hideAndDisposePreHandler(...)hideAndDisposeHandler(...)/** Disposes the Dialog and then causes show() to return if it is currently ... */doDispose(...)toBack(...)toBack_NoClientCode(...)/** Indicates whether this dialog is resizable by the user. ... *//** Sets whether this dialog is resizable by the user. ... */this.resizablesetResizable(...)/** Disables or enables decorations for this dialog. ... */this.undecorated/** Indicates whether this dialog is undecorated. ... */isUndecorated(...)/** Returns a string representing the state of this dialog. This ... *//* This method is called only for modal dialogs. ... *//* --- Modality support --- */IdentityArrayList<Dialog> blockersIdentityArrayList<Window> blockersHierarchiesList<Window> toBlocknew IdentityLinkedList<Window>(...)IdentityArrayList<Window> unblockedWindowsgetAllUnblockedWindows(...)Dialog dshouldBlock(...)getOwner_NoClientCode(...)getModalityType(...)Dialog blockerDialog blockerBlockergetModalBlocker(...)blockWindow(...)getOwnedWindows_NoClientCode(...)Dialog wdblockWindows(...)updateChildrenBlocking(...)IdentityArrayList<Window> saveint blockedWindowsCountunblockWindow(...)/* Returns whether the given top-level window should be blocked by ... */Window blockerToCheckw.isInShow(...).isInHideisModalExcluded(...)ModalExclusionType.APPLICATION_EXCLUDEgetDocumentRoot(...)w.appContextModalExclusionType.TOOLKIT_EXCLUDE/* Adds the given top-level window to the list of blocked ... */setModalBlocked(...)DialogPeer dpeerIterator<Window> it/* Removes the given top-level window from the list of blocked ... *//* Checks if any other modal dialog D blocks the given window. ... */Dialog modalDialogSecurityConstants.AWT.TOOLKIT_MODALITY_PERMISSIONSecurityConstants.AWTGetField fieldsModalityType localModalityTypesetModal(...)this.modalityType/** Gets the AccessibleContext associated with this Dialog. ... */new AccessibleAWTDialog(...)AccessibleRole.DIALOGAccessibleState.MODALAccessibleState.RESIZABLE// check if this dialog should be modal blocked BEFORE calling peer.show(),// otherwise, a pair of FOCUS_GAINED and FOCUS_LOST may be mistakenly// generated for the dialog// This call is required as the show() method of the Dialog class// does not invoke the super.show(). So wried... :(// now guaranteed never to block// endif// endfor// if this dialog is toolkit-modal, the filter should be added// to all EDTs (for all AppContexts)// it may occur that EDT for appContext hasn't been started yet, so// we post an empty invocation event to trigger EDT initialization// if this dialog is toolkit-modal, its filter must be removed// from all EDTs (for all AppContexts)// Restore normal key event dispatching// dialog can be shown and then disposed before its// modal filter is created// fix for 5048370: if hide() is called from super.doDispose(), then// hideAndDisposeHandler() should not be called here as it will be called// at the end of doDispose()// fix for 5048370: set isInDispose flag to true to prevent calling// to hideAndDisposeHandler() from hide()// On some platforms, changing the resizable state affects// the insets of the Dialog. If we could, we'd call invalidate()// from the peer, but we need to guarantee that we're not holding// the Dialog lock when we call invalidate()./* Make sure we don't run in the middle of peer creation. */// find all the dialogs that block this one// add all blockers' blockers to blockers :)// find all windows from blockers' hierarchies// block all windows from scope of blocking except from blockers' hierarchies// we should unblock all the windows first...// also removes w from blockedWindows// ... and only after that check if they should be blocked// by another dialogs// check if w is from children hierarchy// fix for 6271546: we should also take into consideration child hierarchies// of this dialog's blockers// application- and toolkit-excluded windows are not blocked by// document-modal dialogs from outside their children hierarchy// in 1.5 or earlier modalityType was absent, so use "modal" instead// inner class AccessibleAWTDialogimport Dimension2D/** The <code>Dimension</code> class encapsulates the width and ... *//** The width dimension; negative values can be used. ... *//** The height dimension; negative values can be used. ... *//** Creates an instance of <code>Dimension</code> with a width ... *//** Creates an instance of <code>Dimension</code> whose width ... *//** Constructs a <code>Dimension</code> and initializes ... *//** Sets the size of this <code>Dimension</code> object to ... *//** Gets the size of this <code>Dimension</code> object. ... *//** Sets the size of this <code>Dimension</code> object to the specified size. ... *//** Sets the size of this <code>Dimension</code> object ... *//** Checks whether two dimension objects have equal values. *//** Returns the hash code for this <code>Dimension</code>. ... *//** Returns a string representation of the values of this ... *//* Copyright (c) 1995, 2008, Oracle and/or its affiliates. All rights reserved. ... *//** The <code>DisplayMode</code> class encapsulates the bit depth, height, ... */int bitDepth;int refreshRate;/** Create a new display mode object with the supplied parameters. ... */this.bitDepththis.refreshRate/** Returns the height of the display, in pixels. ... *//** Returns the width of the display, in pixels. ... */int BIT_DEPTH_MULTI;/** Value of the bit depth if multiple bit depths are supported in this ... *//** Returns the bit depth of the display, in bits per pixel.  This may be ... */int REFRESH_RATE_UNKNOWN;/** Value of the refresh rate if not known. ... *//** Returns the refresh rate of the display, in hertz.  This may be ... *//** Returns whether the two display modes are equal. ... */getBitDepth(...)getRefreshRate(...)/** <b>NOTE:</b> The <code>Event</code> class is obsolete and is ... */KeyEvent.VK_HOMEEvent.HOMEKeyEvent.VK_ENDEvent.ENDKeyEvent.VK_PAGE_UPEvent.PGUPKeyEvent.VK_PAGE_DOWNEvent.PGDNKeyEvent.VK_UPEvent.UPKeyEvent.VK_DOWNEvent.DOWNEvent.LEFTEvent.RIGHTKeyEvent.VK_F1Event.F1KeyEvent.VK_F2Event.F2KeyEvent.VK_F3Event.F3KeyEvent.VK_F4Event.F4KeyEvent.VK_F5Event.F5KeyEvent.VK_F6Event.F6KeyEvent.VK_F7Event.F7KeyEvent.VK_F8Event.F8KeyEvent.VK_F9Event.F9KeyEvent.VK_F10Event.F10KeyEvent.VK_F11Event.F11KeyEvent.VK_F12Event.F12KeyEvent.VK_PRINTSCREENEvent.PRINT_SCREENKeyEvent.VK_SCROLL_LOCKEvent.SCROLL_LOCKKeyEvent.VK_CAPS_LOCKEvent.CAPS_LOCKKeyEvent.VK_NUM_LOCKEvent.NUM_LOCKKeyEvent.VK_PAUSEEvent.PAUSEEvent.INSERTlong data;int SHIFT_MASK;/** This flag indicates that the Shift key was down when the event ... *//* Modifier constants */int CTRL_MASK;/** This flag indicates that the Control key was down when the event ... */int META_MASK;/** This flag indicates that the Meta key was down when the event ... */int ALT_MASK;/** This flag indicates that the Alt key was down when ... */int HOME;/** The Home key, a non-ASCII action key. *//* Action keys */int END;/** The End key, a non-ASCII action key. */int PGUP;/** The Page Up key, a non-ASCII action key. */int PGDN;/** The Page Down key, a non-ASCII action key. */int UP;/** The Up Arrow key, a non-ASCII action key. */int DOWN;/** The Down Arrow key, a non-ASCII action key. */int LEFT;/** The Left Arrow key, a non-ASCII action key. */int RIGHT;/** The Right Arrow key, a non-ASCII action key. */int F1;/** The F1 function key, a non-ASCII action key. */int F2;/** The F2 function key, a non-ASCII action key. */int F3;/** The F3 function key, a non-ASCII action key. */int F4;/** The F4 function key, a non-ASCII action key. */int F5;/** The F5 function key, a non-ASCII action key. */int F6;/** The F6 function key, a non-ASCII action key. */int F7;/** The F7 function key, a non-ASCII action key. */int F8;/** The F8 function key, a non-ASCII action key. */int F9;/** The F9 function key, a non-ASCII action key. */int F10;/** The F10 function key, a non-ASCII action key. */int F11;/** The F11 function key, a non-ASCII action key. */int F12;/** The F12 function key, a non-ASCII action key. */int PRINT_SCREEN;/** The Print Screen key, a non-ASCII action key. */int SCROLL_LOCK;/** The Scroll Lock key, a non-ASCII action key. */int CAPS_LOCK;/** The Caps Lock key, a non-ASCII action key. */int NUM_LOCK;/** The Num Lock key, a non-ASCII action key. */int PAUSE;/** The Pause key, a non-ASCII action key. */int INSERT;/** The Insert key, a non-ASCII action key. */int ENTER;/** The Enter key. *//* Non-action keys */int BACK_SPACE;/** The BackSpace key. */int TAB;/** The Tab key. */int ESCAPE;/** The Escape key. *//** The Delete key. */int WINDOW_EVENT;/* Base for all window events. */int WINDOW_DESTROY;/** The user has asked the window manager to kill the window. */int WINDOW_EXPOSE;/** The user has asked the window manager to expose the window. */int WINDOW_ICONIFY;/** The user has asked the window manager to iconify the window. */int WINDOW_DEICONIFY;/** The user has asked the window manager to de-iconify the window. */int WINDOW_MOVED;/** The user has asked the window manager to move the window. */int KEY_EVENT;/* Base for all keyboard events. */int KEY_PRESS;/** The user has pressed a normal key. */int KEY_RELEASE;/** The user has released a normal key. */int KEY_ACTION;/** The user has pressed a non-ASCII <em>action</em> key. ... */int KEY_ACTION_RELEASE;/** The user has released a non-ASCII <em>action</em> key. ... */int MOUSE_EVENT;/* Base for all mouse events. */int MOUSE_DOWN;/** The user has pressed the mouse button. The <code>ALT_MASK</code> ... */int MOUSE_UP;/** The user has released the mouse button. The <code>ALT_MASK</code> ... */int MOUSE_MOVE;/** The mouse has moved with no button pressed. */int MOUSE_ENTER;/** The mouse has entered a component. */int MOUSE_EXIT;/** The mouse has exited a component. */int MOUSE_DRAG;/** The user has moved the mouse with a button pressed. The ... */int SCROLL_EVENT;/* Scrolling events */int SCROLL_LINE_UP;/** The user has activated the <em>line up</em> ... */int SCROLL_LINE_DOWN;/** The user has activated the <em>line down</em> ... */int SCROLL_PAGE_UP;/** The user has activated the <em>page up</em> ... */int SCROLL_PAGE_DOWN;/** The user has activated the <em>page down</em> ... */int SCROLL_ABSOLUTE;/** The user has moved the bubble (thumb) in a scroll bar, ... */int SCROLL_BEGIN;/** The scroll begin event. */int SCROLL_END;/** The scroll end event. */int LIST_EVENT;/* List Events */int LIST_SELECT;/** An item in a list has been selected. */int LIST_DESELECT;/** An item in a list has been deselected. */int MISC_EVENT;/* Misc Event */int ACTION_EVENT;/** This event indicates that the user wants some action to occur. */int LOAD_FILE;/** A file loading event. */int SAVE_FILE;/** A file saving event. */int GOT_FOCUS;/** A component gained the focus. */int LOST_FOCUS;/** A component lost the focus. */Object target;/** The target component. This indicates the component over which the ... */long when;/** The time stamp. ... *//** Indicates which type of event the event is, and which ... *//** The <i>x</i> coordinate of the event. ... *//** The <i>y</i> coordinate of the event. ... */int key;/** The key code of the key that was pressed in a keyboard event. ... *//** The state of the modifier keys. ... *///    public char keyChar;/** The key character that was pressed in a keyboard event. */int clickCount;/** For <code>MOUSE_DOWN</code> events, this field indicates the ... *//** An arbitrary argument of the event. The value of this field ... */Event evt;/** The next event. This field is set when putting events into a ... */...[] actionKeyCodes;/* table for mapping old Event action keys to KeyEvent virtual keys. *//** This field controls whether or not the event is sent back ... */this.whenthis.clickCount/* <b>NOTE:</b> The <code>Event</code> class is obsolete and is ... */actionKeyCodes.lengthshiftDown(...)controlDown(...)metaDown(...)/* virtual key              action key */// these types are not passed back to peerimport SunDragSourceContextPeer/** EventDispatchThread is a package-private AWT class which takes ... */new ArrayList<EventFilter>(...)EventQueue theQueue;boolean doDispatch;int ANY_EVENT;ArrayList<EventFilter> eventFilters;setEventQueue(...)/* Must be called on EDT only, that's why no synchronization */detachDispatchThread(...)pumpEventsForFilter(...)new HierarchyEventFilter(...)pumpOneEventForFilters(...)ModalEventFilter newFilterEventFilter fModalEventFilter cfAWTEvent eventboolean eventOKEventQueue eqDelegate delegateObject handlegetNextEvent(...)EventFilter.FilterActionFilterAction acceptacceptEvent(...)EventFilter.FilterAction.REJECTEventFilter.FilterAction.ACCEPT_IMMEDIATELYcheckEvent(...)beforeDispatch(...)afterDispatch(...)ThreadDeath deathInterruptedException interruptedExceptionprocessException(...)uncaughtException(...)getUncaughtExceptionHandler(...)Component modalComponent;this.modalComponentint eventIDboolean mouseEventMouseEvent.MOUSE_FIRSTMouseEvent.MOUSE_LASTboolean actionEventActionEvent.ACTION_FIRSTActionEvent.ACTION_LASTboolean windowClosingEventFilterAction.REJECTFilterAction.ACCEPTboolean modalExcluded// EventQueue may change during the dispatching// AppContext.dispose() interrupts all// Threads in the AppContext/* filter out MouseEvent and ActionEvent that's outside ... *//* Modal internal frames are handled separately. If event is ... */// Exclude this object from modality and// continue to pump it's events.// 5.0u3 modal exclusion// Exclude this window and all its children from//  modality and continue to pump it's events./** Enumeration for possible values for <code>acceptEvent(AWTEvent ev)</code> method. ... */new FilterAction(...)FilterAction ACCEPT;/** ACCEPT means that this filter do not filter the event and allowes other ... */FilterAction REJECT;/** REJECT means that this filter filter the event. No other filters are queried, ... */FilterAction ACCEPT_IMMEDIATELY;/** ACCEPT_IMMEDIATELY means that this filter do not filter the event, no other ... */import EmptyStackExceptionimport sun.awt.*import Conditionimport Lockimport AtomicIntegerimport JavaSecurityAccess/** <code>EventQueue</code> is a platform-independent class ... */new Queue[]getAndIncrement(...)new AtomicInteger(...)setEventQueueAccessor(...)AWTAccessor.EventQueueAccessorisDispatchThreadImpl(...)noEvents(...)wakeup(...)invokeAndWait(...)setFwDispatcher(...)getMostRecentEventTimeImpl(...)AtomicInteger threadInitNumber;int LOW_PRIORITY;int NORM_PRIORITY;int HIGH_PRIORITY;int ULTIMATE_PRIORITY;int NUM_PRIORITIES;...[] queues;/* We maintain one Queue for each priority that the EventQueue supports. ... */EventQueue nextQueue;/* The next EventQueue on the stack, or null if this EventQueue is ... */EventQueue previousQueue;/* The previous EventQueue on the stack, or null if this is the ... */Lock pushPopLock;/* A single lock to synchronize the push()/pop() and related operations with ... */Condition pushPopCond;Runnable dummyRunnable;/* Dummy runnable to wake up EDT from getNextEvent() after ... */EventDispatchThread dispatchThread;ThreadGroup threadGroup;long mostRecentEventTime;/* The time stamp of the last dispatched InputEvent or ActionEvent. */long mostRecentKeyEventTime;/* The time stamp of the last KeyEvent . */WeakReference<AWTEvent> currentEvent;/** The modifiers field of the current event, if the current event is an ... */int waitForID;/* Non-zero if a thread is waiting in getNextEvent(int) for an event of ... *//* AppContext corresponding to the queue. */FwDispatcher fwDispatcher;new Queue(...)AppContext.EVENT_QUEUE_LOCK_KEYAppContext.EVENT_QUEUE_COND_KEY/** Posts a 1.1-style event to the <code>EventQueue</code>. ... */flushPendingEvents(...)postEventPrivate(...)theEvent.isPostedinitDispatchThread(...)getPriority(...)PeerEvent peerEventgetFlags(...)PeerEvent.ULTIMATE_PRIORITY_EVENTPeerEvent.LOW_PRIORITY_EVENTPaintEvent.PAINT_FIRSTPaintEvent.PAINT_LAST/** Posts the event to the internal Queue of specified priority, ... */EventQueueItem newItemnew EventQueueItem(...)boolean notifyIDthis.waitForIDcoalesceEvent(...)cacheEQItem(...)...[...].headboolean shouldNotify...[...].tailnotifyThreadBusy(...)signalAll(...)...[...].tail.nextComponentPeer sourcePeer(...).peerEventQueueItem[] cache(...).eventCacheeventToCacheIndex(...)coalescePaintEvent(...)PaintEvent mergedmergePaintEvents(...)...[...].eventRectangle aRectgetUpdateRect(...)Rectangle bRectcoalesceEvents(...)/* Should avoid of calling this method by any means ... */EventQueueItem entryentry.eventAWTEvent coalescedEventcoalescePeerEvent(...)isCoalescingEnabled(...)coalesceOtherEvent(...)coalesceMouseEvent(...)source.eventCachenew EventQueueItem[]int PAINT;int UPDATE;int MOVE;int DRAG;int PEER;int CACHE_LENGTH;PaintEvent.PAINT/** Returns whether an event is pending on any of the separate ... *//** Removes an event from the <code>EventQueue</code> and ... */getNextEventPrivate(...)notifyThreadFree(...)await(...)/* Must be called under the lock. Doesn't call flushPendingEvents() */uncacheEQItem(...)EventQueueItem prev/** Returns the first event on the <code>EventQueue</code> ... */...[...].head.event/** Returns the first event with the specified id, if any. ... */EventQueueItem qq.eventJavaSecurityAccess javaSecurityAccess;/** Dispatches an event. The manner in which the event is ... */scheduleDispatch(...)AccessControlContext srcAccgetAccessControlContextFrom(...)AccessControlContext eventAcc/** Called from dispatchEvent() under a correct AccessControlContext */event.isPostedsetCurrentEventAndMostRecentTimeImpl(...)dispatched(...)stopDispatching(...)getEventLog(...)/** Returns the timestamp of the most recent event that had a timestamp, and ... *//** Returns the the event currently being dispatched by the ... */getCurrentEventImpl(...)/** Replaces the existing <code>EventQueue</code> with the specified one. ... */EventQueue topQueuetopQueue.nextQueuetopQueue.fwDispatchertopQueue.dispatchThreadnewEventQueue.dispatchThreadpeekEvent(...)newEventQueue.previousQueue/** Stops dispatching events using this <code>EventQueue</code>. ... */EventQueue prevQueuetopQueue.previousQueuenew EmptyStackException(...)prevQueue.nextQueueprevQueue.dispatchThread/** Creates a new {@code secondary loop} associated with this ... */new WaitDispatchSupport(...)/** Returns true if the calling thread is ... */EventQueue nexteq.nextQueueeq.fwDispatchereq.dispatchThreadisDestroyed(...)EventDispatchThread tnew EventDispatchThread(...)EventQueue.this/* Gets the <code>EventDispatchThread</code> for this ... *//* Removes any pending events for the specified source object. ... */getInvocationEventAccessor(...)long mostRecentEventTime2Long.MIN_VALUEnew WeakReference<AWTEvent>(...)InputEvent ieInputMethodEvent imeInvocationEvent ie/** Causes <code>runnable</code> to have its <code>run</code> ... */Object locknew AWTInvocationLock(...)InvocationEvent eventThrowable eventThrowablegetThrowable(...)isDispatched(...)new InvocationTargetException(...)/* Called from PostEventQueue.postEvent to notify that a new event ... */// The method is used by AWTAccessor for javafx/AWT single threaded mode./** The Queue object holds pointers to the beginning and end of one internal ... */EventQueueItem head;EventQueueItem tail;/* Copyright (c) 1996, 2014, Oracle and/or its affiliates. All rights reserved. ... *//* NOTE: if you ever have to start the associated event dispatch ... */// Forward the event to the top of EventQueue stack// The event was not coalesced or has non-Component source.// Insert it at the end of the appropriate Queue.// Give Component.coalesceEvents a chance// The worst case// Return -1 for SunDropTargetEvent since they are usually synchronous// and we don't want to skip them by coalescing with MouseEvent or other drag events/* SunToolkit.flushPendingEvents must be called outside ... */// In case fwDispatcher is installed and we're already on the// dispatch thread (e.g. performing DefaultKeyboardFocusManager.sendMessage),// dispatch the event straight away.// This could become the sole method of dispatching in time.// Transfer all events forward to new EventQueue.// Use getNextEventPrivate() as it doesn't call flushPendingEvents()// Wake up EDT waiting in getNextEvent(), so it can// pick up a new EventQueue. Post the waking event before// topQueue.nextQueue is assigned, otherwise the event would// go newEventQueue// Transfer all events back to previous EventQueue.// pick up a new EventQueue// Forward the request to the top of EventQueue stack/* Minimize discard possibility for non-posted events *//* This synchronized block is to secure that the event dispatch ... *//* Event was posted after EDT events pumping had stopped, so start ... */// This series of 'instanceof' checks should be replaced with a// polymorphic type (for example, an interface which declares a// getWhen() method). However, this would require us to make such// a type public, or to place it in sun.awt. Both of these approaches// have been frowned upon. So for now, we hack.// In tiger, we will probably give timestamps to all events, so this// will no longer be an issue.// Forward call to the top of EventQueue stack.import FileDialogPeerimport FilenameFilter/** The <code>FileDialog</code> class displays a dialog window ... */setFileDialogAccessor(...)AWTAccessor.FileDialogAccessorsetFiles(...)fileDialog.filefileDialog.dirfileDialog.multipleModeint LOAD;/** This constant value indicates that the purpose of the file ... */int SAVE;/* There are two <code>FileDialog</code> modes: <code>LOAD</code> and ... */String dir;/* The string specifying the directory to display ... */String file;/* The string specifying the initial value of the ... */...[] files;/** Contains the File instances for all the files that the user selects. ... */boolean multipleMode;/** Represents whether the file dialog allows the multiple file selection. ... */FilenameFilter filter;/* The filter used as the file dialog's filename filter. ... *//** Creates a file dialog for loading a file.  The title of the ... *//** Creates a file dialog window with the specified title for loading ... *//** Constructs a name for this component. Called by <code>getName()</code> ... *//** Creates the file dialog's peer.  The peer allows us to change the look ... */createFileDialog(...)/** Indicates whether this file dialog box is for loading from a file ... *//** Sets the mode of the file dialog.  If <code>mode</code> is not ... */this.mode/** Gets the directory of this file dialog. ... *//** Sets the directory of this file dialog window to be the ... */FileDialogPeer peerthis.dir/** Gets the selected file of this file dialog.  If the user ... *//** Returns files that the user selects. ... *//** Stores the names of all the files that the user selects. ... */this.files/** Sets the selected file for this file dialog window to be the ... */setFile(...)/** Enables or disables multiple file selection for the file dialog. ... */this.multipleMode/** Returns whether the file dialog allows the multiple file selection. ... *//** Determines this file dialog's filename filter. A filename filter ... *//** Sets the filename filter for this file dialog window to the ... */setFilenameFilter(...)/** Reads the <code>ObjectInputStream</code> and performs ... *//** Returns a string representing the state of this <code>FileDialog</code> ... */// 1.1 Compatibility: "" is not converted to null in 1.1/** A flow layout arranges components in a directional flow, much ... *//** This value indicates that each row of components ... */int CENTER;int LEADING;int TRAILING;int align;/** <code>align</code> is the property that determines ... */int newAlign;/** <code>newAlign</code> is the property that determines ... */// This is for 1.1 serialization compatibility/** The flow layout manager allows a seperation of ... */// This is the one we actually useboolean alignOnBaseline;/** If true, components will be aligned on their baseline. *//** Constructs a new <code>FlowLayout</code> with a centered alignment and a ... *//** Constructs a new <code>FlowLayout</code> with the specified ... *//** Creates a new flow layout manager with the indicated alignment ... */setAlignment(...)/** Gets the alignment for this layout. ... *//** Sets the alignment for this layout. ... */this.newAlignthis.align/** Gets the horizontal gap between components ... *//** Sets the horizontal gap between components and ... *//** Gets the vertical gap between components and ... *//** Sets the vertical gap between components and between ... *//** Sets whether or not components should be vertically aligned along their ... */this.alignOnBaseline/** Returns true if components are to be vertically aligned along ... *//** Adds the specified component to the layout. ... *//** Returns the preferred dimensions for this layout given the ... */int nmembersboolean firstVisibleComponentboolean useBaselinegetAlignOnBaseline(...)int maxAscentint maxDescentComponent m/** Returns the minimum dimensions needed to layout the <i>visible</i> ... */m.visible/** Centers the elements in the specified row, if there is any slack. ... */int nonbaselineHeightint baselineOffsetm.heightm.width/** Lays out the container. This method lets each ... */int maxwidthint rowhint[] ascentint[] descentmoveComponents(...)int currentSerialVersion;// - 1 for version >= Java 2 platform v1.2, which includes "newAlign" field// - 0 (default) for versions before the Java 2 platform, v1.2// the internal serial version which says which version was writtenint serialVersionOnStream;/** This represent the <code>currentSerialVersion</code> ... *//** Reads this object out of a serialization stream, handling ... *//** Returns a string representation of this <code>FlowLayout</code> ... */// this.align is used only for serialization compatibility,// so set it to a value compatible with the 1.1 version// of the class// "newAlign" field wasn't present, so use the old "align" field./** A FocusTraversalPolicy defines the order in which Components with a ... *//** Returns the Component that should receive the focus when a Window is ... */Component defimport FontRenderContextimport GlyphVectorimport LineMetricsimport TextAttributeimport TextLayoutimport Point2Dimport FontPeerimport CharacterIteratorimport StringCharacterIteratorimport StandardGlyphVectorimport AttributeMapimport AttributeValuesimport CompositeFontimport CreatedFontTrackerimport Font2Dimport Font2DHandleimport FontAccessimport GlyphLayoutimport FontLineMetricsimport CoreMetricsimport static EAttribute.*/** The <code>Font</code> class represents fonts, which are used to ... */setFontAccess(...)new FontAccessImpl(...)new AffineTransform(...)AttributeValues.MASK_ALLgetMask(...)getFont2D(...)font.font2DHandlefont.createdFontHashtable<Object,Object> fRequestedAttributes;/** This is now only used during serialization.  Typically ... */String DIALOG;/** A String constant for the canonical family name of the ... *//* Constants to be used for logical font family names. */String DIALOG_INPUT;String SANS_SERIF;String SERIF;String MONOSPACED;/** The plain style constant. *//* Constants to be used for styles. Can be combined to mix ... */int BOLD;/** The bold style constant.  This can be combined with the other style ... */int ITALIC;/** The italicized style constant.  This can be combined with the other ... */int ROMAN_BASELINE;/** The baseline used in most Roman scripts when laying out text. */int CENTER_BASELINE;/** The baseline used in ideographic scripts like Chinese, Japanese, ... */int HANGING_BASELINE;/** The baseline used in Devanigiri and similar scripts when laying ... */int TRUETYPE_FONT;/** Identify a font resource of type TRUETYPE. ... */int TYPE1_FONT;/** Identify a font resource of type TYPE1. ... *//** The logical name of this <code>Font</code>, as passed to the ... *//** The style of this <code>Font</code>, as passed to the constructor. ... *//** The point size of this <code>Font</code>, rounded to integer. ... */float pointSize;/** The point size of this <code>Font</code> in <code>float</code>. ... */FontPeer peer;/** The platform specific font information. */Font2DHandle font2DHandle;// native JDK1.1 font pointerAttributeValues values;boolean hasLayoutAttributes;boolean createdFont;/* If the origin of a Font is a created font then this attribute ... */boolean nonIdentityTx;/* This is true if the font transform is not identity.  It ... */AffineTransform identityTx;/* A cached value used when a transform is required for internal ... *//** Gets the peer of this <code>Font</code>. ... */getPeer_NoClientCode(...)//       We implement this functionality in a package-private method// NOTE: This method is called by privileged threads.getFontPeer(...)/** Return the AttributeValues object associated with this ... */AttributeValues valuesTmpnew AttributeValues(...)setFamily(...)setWeight(...)setPosture(...)defineAll(...)isStdComposite(...)usingPerAppContextComposites(...)font2DHandle.font2DfindFont2D(...)FontManager.LOGICAL_FALLBACKfindFont2D(...).handle/** Creates a new <code>Font</code> from the specified name, style and ... */this.pointSize/* This constructor is used by deriveFont when attributes is null */this.createdFonthandle.font2Dthis.font2DHandlegetNewComposite(...)/* used to implement Font.createFont */createFont2D(...).handlecreateFont2D(...)getFontName(...)this.font2DHandle.font2D/* This constructor is used when one font is derived from another. ... */String newNameint newStylegetWeight(...)getPosture(...)initFromValues(...)/** Creates a new <code>Font</code> with the specified attributes. ... */fromMap(...)/** Creates a new <code>Font</code> from the specified <code>font</code>. ... */font.valuesgetAttributeValues(...)font.namefont.stylefont.sizefont.pointSizeint RECOGNIZED_MASK;/** Font recognizes all attributes except FONT. */int PRIMARY_MASK;/** These attributes are considered primary by the FONT attribute. */int SECONDARY_MASK;/** These attributes are considered secondary by the FONT attribute. */int LAYOUT_MASK;/** These attributes are handled by layout. */int EXTRA_MASK;/** Initialize the standard Font fields from the values object. */this.nonIdentityTxanyNonDefault(...)this.hasLayoutAttributes/** Returns a <code>Font</code> appropriate to the attributes. ... */TextAttribute.FONTAttributeValues valuesisNonDefault(...)anyDefined(...)merge(...)/** Used with the byte count tracker for fonts created from streams. ... */boolean hasPerm/** Returns a new <code>Font</code> using the specified font type ... */CreatedFontTracker trackergetTracker(...)boolean acquiredhasTempPermission(...)createFont0(...)acquirePermit(...)releasePermit(...)boolean copiedFontDataFont.TRUETYPE_FONTFont.TYPE1_FONTFile tFileOutputStream outStreamCreatedFontTracker.MAX_FILE_SIZECreatedFontTracker.MAX_TOTAL_BYTESgetNumBytes(...)subBytes(...)FilePermission filePermission/** Returns a copy of the transform associated with this ... */getSuperscript(...)int superscriptdouble transboolean upint signint ssint newnpreConcatenate(...)getTranslateInstance(...)...[] ssinfo;// assume ascent is 3/4 of point size// trans = 1/2 of ascent * x// scale ratio is 2/3// x = (1 - r^(n+1)) / (1 - r)// x = (r^0 - r^(n+1)) / (1 - r)// x (1 - r) = r^0 - r^(n+1)// x - rx = r^0 - r^(n+1)// rx = r^1 + r^2 + r^3... r^(n+1)// x = r^0 + r^1 + r^2... r^n/** Returns the family name of this <code>Font</code>. ... */getFamily_NoClientCode(...)//       subclasses.//       method to insure that it cannot be overridden by client//       We implement this functionality in a package-private/** Returns the family name of this <code>Font</code>, localized for ... */getFamilyName(...)/** Returns the postscript name of this <code>Font</code>. ... */getPostscriptName(...)/** Returns the logical name of this <code>Font</code>. ... *//** Returns the font face name of this <code>Font</code>.  For example, ... *//** Returns the font face name of the <code>Font</code>, localized ... *//** Returns the style of this <code>Font</code>.  The style can be ... *//** Returns the point size of this <code>Font</code>, rounded to ... *//** Returns the point size of this <code>Font</code> in ... *//** Indicates whether or not this <code>Font</code> object's style is ... *//** Indicates whether or not this <code>Font</code> object has a ... *//** Return true if this Font contains attributes that require extra ... *//** Returns a <code>Font</code> object from the system properties list. ... *//** Returns the <code>Font</code> that the <code>str</code> ... */String fontNameString styleNameint fontSizeint fontStyleint lastHyphenint lastSpacechar sepCharint sizeIndexint styleIndexint strlenint fontEnd/** Gets the specified <code>Font</code> from the system properties ... *//** Returns a hashcode for this <code>Font</code>. ... *//** Compares this <code>Font</code> object to the specified ... */font.nonIdentityTxfont.hasLayoutAttributes/** Converts this <code>Font</code> object to a <code>String</code> ... */String strStyleint fontSerializedDataVersion;/** The <code>Font</code> Serializable Data Form. ... *//** Serialization support.  A <code>readObject</code> ... */// toString()/** Writes default serializable fields to a stream. ... */toSerializableHashtable(...)/** Reads the <code>ObjectInputStream</code>. ... */AttributeValues extrasfromSerializableHashtable(...)is16Hashtable(...)unsetDefault(...)/** Returns the number of glyphs in this <code>Font</code>. Glyph codes ... */getNumGlyphs(...)/** Returns the glyphCode which is used when this <code>Font</code> ... */getMissingGlyphCode(...)/** Returns the baseline appropriate for displaying this character. ... */getBaselineFor(...)/** Returns a map of font attributes available in this ... */new AttributeMap(...)/** Returns the keys of all the attributes supported by this ... */Attribute[] attributesTextAttribute.FAMILYTextAttribute.WEIGHTTextAttribute.WIDTHTextAttribute.POSTURETextAttribute.SIZETextAttribute.TRANSFORMTextAttribute.SUPERSCRIPTTextAttribute.CHAR_REPLACEMENTTextAttribute.FOREGROUNDTextAttribute.BACKGROUNDTextAttribute.UNDERLINETextAttribute.STRIKETHROUGHTextAttribute.RUN_DIRECTIONTextAttribute.BIDI_EMBEDDINGTextAttribute.JUSTIFICATIONTextAttribute.INPUT_METHOD_HIGHLIGHTTextAttribute.INPUT_METHOD_UNDERLINETextAttribute.SWAP_COLORSTextAttribute.NUMERIC_SHAPINGTextAttribute.KERNINGTextAttribute.LIGATURESTextAttribute.TRACKING/** Creates a new <code>Font</code> object by replicating this ... */AttributeValues newValuesint oldStyleapplyStyle(...)applyTransform(...)/** Creates a new <code>Font</code> object by replicating the current ... *//** Checks if this <code>Font</code> has a glyph for the specified ... */canDisplay(...)isValidCodePoint(...)/** Indicates whether or not this <code>Font</code> can display a ... */Font2D font2disHighSurrogate(...)/** Indicates whether or not this <code>Font</code> can display ... *//** Indicates whether or not this <code>Font</code> can display the ... */isLowSurrogate(...)toCodePoint(...)/** Returns the italic angle of this <code>Font</code>.  The italic angle ... */getItalicAngle(...)/* The FRC hints don't affect the value of the italic angle but ... */Object aaObject fmRenderingHints.VALUE_TEXT_ANTIALIAS_OFFRenderingHints.VALUE_FRACTIONALMETRICS_OFFgetAntiAliasingHint(...)getFractionalMetricsHint(...)/** Checks whether or not this <code>Font</code> has uniform ... */SoftReference<FontLineMetrics> flmref;FontLineMetrics flmflm.frcfloat[] metricsfloat ascentfloat descentfloat leadingfloat ssOffsetint baselineIndexfloat[] baselineOffsetsfloat strikethroughOffsetfloat strikethroughThicknessfloat underlineOffsetfloat underlineThicknessfloat italicAngleCoreMetrics cmnew CoreMetrics(...)getTranslateY(...)isTransformed(...)AffineTransform ctxgetCharTransform(...)Point2D.FloatFloat ptdeltaTransform(...)new FontLineMetrics(...)new SoftReference<FontLineMetrics>(...)/** Returns a {@link LineMetrics} object created with the specified ... */defaultLineMetrics(...)flm.numchars/** Returns a <code>LineMetrics</code> object created with the ... */int numChars/** Returns the logical bounds of the specified <code>String</code> in ... */char[] arraygetStringBounds(...)String substr/** Returns the logical bounds of the specified array of characters ... */boolean simplegetKerning(...)getLigatures(...)getBaselineTransform(...)isComplexText(...)GlyphVector gvnew StandardGlyphVector(...)getLogicalBounds(...)TextLayout tlnew TextLayout(...)getAdvance(...)/** Returns the logical bounds of the characters indexed in the ... */getBeginIndex(...)getEndIndex(...)current(...)/** Returns the bounds for the character with the maximum ... *//** Creates a {@link java.awt.font.GlyphVector GlyphVector} by ... *//** Returns a new <code>GlyphVector</code> object, performing full ... */GlyphLayout glStandardGlyphVector gvint LAYOUT_LEFT_TO_RIGHT;/** A flag to layoutGlyphVector indicating that text is left-to-right as ... */int LAYOUT_RIGHT_TO_LEFT;/** A flag to layoutGlyphVector indicating that text is right-to-left as ... */int LAYOUT_NO_START_CONTEXT;/** A flag to layoutGlyphVector indicating that text in the char array ... */int LAYOUT_NO_LIMIT_CONTEXT;/* Initialize JNI field and method IDs */// expects the float value.// WEIGHT_BOLD// POSTURE_OBLIQUE// for streaming compatibility/* Do not cache the de-referenced font2D. It must be explicitly ... *//* Fonts created from a stream will use the same font2D instance ... *//* Font2D instances created by this method track their font file ... */// for 1.5 streaming compatibility// not == 2f// not  == .2f// optimize for two cases:// 1) FONT attribute, and nothing else// 2) attributes, but no FONT// avoid turning the attributemap into a regular map for no reason// merge// oh well, check for anything else/* inc. any kind of SecurityException */// Otherwise, be extra conscious of pending temp file creation and// resourcefully handle the temp file resources, among other things./* don't close the input stream *//* After all references to a Font2D are dropped, the file ... *//* The most common case is the identity transform.  Most callers ... */// can't get ascent and descent here, recursive call to this fn,// so use pointsize// let users combine super- and sub-scripting// note on placement and italics// We preconcatenate the transform because we don't want to translate along// the italic angle, but purely perpendicular to the baseline.  While this// looks ok for superscripts, it can lead subscripts to stack on each other// and bring the following text too close.  The way we deal with potential// collisions that can occur in the case of italics is by adjusting the// horizontal spacing of the adjacent glyphvectors.  Examine the italic// angle of both vectors, if one is non-zero, compute the minimum ascent// and descent, and then the x position at each for each vector along its// italic angle starting from its (offset) baseline.  Compute the difference// between the x positions and use the maximum difference to adjust the// position of the right gv./* It wasn't a valid size, if we didn't also find the ... *//* this string isn't any of the expected styles, so ... *//* It is possible many fonts differ only in transform. ... *//* 'values' is usually initialized lazily, except when ... */// transient// Handle fRequestedAttributes.// in 1.5, we always streamed out the font values plus// TRANSFORM, SUPERSCRIPT, and WIDTH, regardless of whether the// values were default or not.  In 1.6 we only stream out// defined values.  So, 1.6 streams in from a 1.5 stream,// it check each of these values and 'undefines' it if the// value is the default.// init// if legacy stream, undefine these// don't need it any more// FONT is not supported by Font// c2 could be CharacterIterator.DONE which is not a low surrogate.// REMIND always safe, but prevents caller optimize/* The device transform in the frc is not used in obtaining line ... */// need real index, assumes roman for everything// need real baselines eventually// extract rotation// this code should be in textlayout// quick check for simple text, assume GV ok to use if simple// need char array constructor on textlayout// !!! no custom layout engines// WEIGHT_BOLD, WEIGHT_REGULAR// POSTURE_OBLIQUE, POSTURE_REGULAR/** Thrown by method createFont in the <code>Font</code> class to indicate ... *//** Report a FontFormatException for the reason specified. ... *//** The <code>FontMetrics</code> class defines a font metrics object, which ... */new FontRenderContext(...)FontRenderContext DEFAULT_FRC;/** The actual {@link Font} from which the font metrics are ... *//** Creates a new <code>FontMetrics</code> object for finding out ... *//** Gets the <code>Font</code> described by this ... *//** Gets the <code>FontRenderContext</code> used by this ... *//** Determines the <em>standard leading</em> of the ... *//** Determines the <em>font ascent</em> of the <code>Font</code> ... *//** Determines the <em>font descent</em> of the <code>Font</code> ... *//** Gets the standard height of a line of text in this font.  This ... *//** Determines the maximum ascent of the <code>Font</code> ... *//** Determines the maximum descent of the <code>Font</code> ... *//** For backward compatibility only. ... */getMaxDescent(...)/** Gets the maximum advance width of any character in this ... *//** Returns the advance width of the specified character in this ... */getWidths(...)charsWidth(...)/** Returns the total advance width for showing the specified ... *//** Returns the total advance width for showing the specified array ... *//** Gets the advance widths of the first 256 characters in the ... */int[] widthscharWidth(...)/** Checks to see if the <code>Font</code> has uniform line metrics.  A ... */hasUniformLineMetrics(...)/** Returns the {@link LineMetrics} object for the specified ... */getLineMetrics(...)myFRC(...)/** Returns the bounds of the specified <code>String</code> in the ... *//** Returns the bounds of the specified array of characters ... *//** Returns the bounds of the characters indexed in the specified ... *//** Returns the bounds for the character with the maximum bounds ... */getMaxCharBounds(...)getFontRenderContext(...)/** Returns a representation of this <code>FontMetrics</code> ... */// substitute missing glyph widthimport FramePeer/** A <code>Frame</code> is a top-level window with a title and a border. ... */Cursor.CROSSHAIR_CURSORCursor.TEXT_CURSORCursor.WAIT_CURSORCursor.SW_RESIZE_CURSORCursor.SE_RESIZE_CURSORCursor.NW_RESIZE_CURSORCursor.NE_RESIZE_CURSORCursor.N_RESIZE_CURSORCursor.S_RESIZE_CURSORCursor.W_RESIZE_CURSORCursor.E_RESIZE_CURSORCursor.HAND_CURSORsetFrameAccessor(...)AWTAccessor.FrameAccessorframe.stateframe.maximizedBounds/* Note: These are being obsoleted;  programs should use the Cursor class ... *//** Frame is in the "normal" state.  This symbolic constant names a ... */int ICONIFIED;/** This state bit indicates that frame is iconified. ... */int MAXIMIZED_HORIZ;/** This state bit indicates that frame is maximized in the ... */int MAXIMIZED_VERT;int MAXIMIZED_BOTH;/** This state bit mask indicates that frame is fully maximized ... */Rectangle maximizedBounds;/** Maximized bounds for this frame. ... *//** This is the title of the frame.  It can be changed ... */MenuBar menuBar;/** The frames menubar.  If <code>menuBar</code> = null ... *//** This field indicates whether the frame is resizable. ... *//** This field indicates whether the frame is undecorated. ... */boolean mbManagement;/** <code>mbManagement</code> is only used by the Motif implementation. ... */// will need to take care of serialization// XXX: uwe: abuse old field for now/* used only by the Motif impl. */Vector<Window> ownedWindows;/* The Windows owned by the Frame. ... *//** Constructs a new instance of <code>Frame</code> that is ... *//** Constructs a new, initially invisible {@code Frame} with the ... *//** Constructs a new, initially invisible <code>Frame</code> object ... *//** Makes this Frame displayable by connecting it to ... */FramePeer pMenuBar menuBarthis.menuBarcreateFrame(...)setMenuBar(...)setMaximizedBounds(...)/** Gets the title of the frame.  The title is displayed in the ... *//** Sets the title for this frame to the specified string. ... */FramePeer peer/** Returns the image to be displayed as the icon for this frame. ... */List<Image> iconssetIconImage(...)/** Gets the menu bar for this frame. ... *//** Sets the menu bar for this frame to the specified menu bar. ... */mb.parentmenuBar.parent/** Indicates whether this frame is resizable by the user. ... *//** Sets whether this frame is resizable by the user. ... */boolean oldResizable/** Sets the state of this frame (obsolete). ... */getExtendedState(...)setExtendedState(...)/** Sets the state of this frame. The state is ... */isFrameStateSupported(...)/** Gets the state of this frame (obsolete). ... *//** Gets the state of this frame. The state is ... *//** Sets the maximized bounds for this frame. ... */this.maximizedBounds/** Gets maximized bounds for this frame. ... *//** Disables or enables decorations for this frame. ... *//** Indicates whether this frame is undecorated. ... *//** Removes the specified menu bar from this frame. ... */m.parent/** Makes this Frame undisplayable by removing its connection ... */handleShortcut(...)/** Returns a string representing the state of this <code>Frame</code>. ... *//** Returns an array of all {@code Frame}s created by this application. ... */Window[] allWindowsint frameCountFrame[] framesint frameSerializedDataVersion;/** <code>Frame</code>'s Serialized Data Version. ... *//* Serialization support.  If there's a MenuBar we restore ... */Image icon1/** Reads the <code>ObjectInputStream</code>.  Tries ... */Image iconnew ArrayList<Image>(...)connectOwnedWindow(...)/** Gets the AccessibleContext associated with this Frame. ... */new AccessibleAWTFrame(...)// the insets of the Frame. If we could, we'd call invalidate()// the Frame lock when we call invalidate().// peer.setState must be called outside of object lock// synchronization block to avoid possible deadlock// * Toolkit.isFrameStateSupported returns always false// on compound state even if all parts are supported;// * if part of state is not supported, state is not supported;// * MAXIMIZED_BOTH is not a compound state.// get the latest Frame state before disposing// HeadlessException is thrown by Window's readObject// pre-1.4 instances will not have this optional data.// 1.6 and later instances serialize icons in the Window class// might have been caused by unrelated reasons.// Ensure 1.1 serialized Frames can read & hook-up// owned windows properly// inner class AccessibleAWTFrame/** The <code>GradientPaint</code> class provides a way to fill ... */Point2D.Float p1;Point2D.Float p2;boolean cyclic;/** Constructs a simple acyclic <code>GradientPaint</code> object. ... */this.color1this.color2/** Constructs either a cyclic or acyclic <code>GradientPaint</code> ... */this.cyclic/** Returns a copy of the point P1 that anchors the first color. ... *//** Returns the color C1 anchored by the point P1. ... *//** Returns a copy of the point P2 which anchors the second color. ... */p2.xp2.y/** Returns the color C2 anchored by the point P2. ... *//** Returns <code>true</code> if the gradient cycles repeatedly ... */new GradientPaintContext(...)/** Returns the transparency mode for this <code>GradientPaint</code>. ... */import NoninvertibleTransformExceptionColorModel xrgbmodel;ColorModel xbgrmodel;ColorModel cachedModel;WeakReference<Raster> cached;Raster crasint cwint iwint ihnew WeakReference<Raster>(...)double x1;double y1;double dx;double dy;...[] interp;Raster saved;ColorModel model;Point2D xvecPoint2D.DoublePoint2D yvecdouble udxdouble udydouble ulenSqPoint2D dp1int rgb1int rgb2int daint drint dgint dbAffineTransform inversecreateInverse(...)NoninvertibleTransformException eDouble.MIN_VALUEPoint2D pgetAlphaMask(...)float rel/** Release the resources allocated for the operation. */putCachedRaster(...)/** Return the ColorModel of the output. *//** Return a Raster containing the colors generated for the graphics ... */double rowrelRaster rastIntegerComponentRaster irastgetCachedRaster(...)cycleFillRaster(...)clipFillRaster(...)int irowrelint idyint icolreldouble colrel// First calculate the distance moved in user space when// we move a single unit along the X & Y axes in device space.// Now calculate the (square of the) user space distance// between the anchor points. This value equals://     (UserVec . UserVec)// Now calculate the proportional distance moved along the// vector from p1 to p2 when we move a unit along X & Y in// device space.// The length of the projection of the Device Axis Vector is// its dot product with the Unit User Vector://     (DevAxisVec . (UserVec / Len(UserVec))// The "proportional" length is that length divided again// by the length of the User Vector://     (DevAxisVec . (UserVec / Len(UserVec))) / Len(UserVec)// which simplifies to://     ((DevAxisVec . UserVec) / Len(UserVec)) / Len(UserVec)//     (DevAxisVec . UserVec) / LenSquared(UserVec)// We are acyclic// If we are using the acyclic form below, we need// dx to be non-negative for simplicity of scanning// across the scan lines for the transition points.// To ensure that constraint, we negate the dx/dy// values and swap the points and colors.import AttributedCharacterIterator/** The <code>Graphics</code> class is the abstract base class for ... *//** Constructs a new <code>Graphics</code> object. ... *//** Creates a new <code>Graphics</code> object that is ... *//** Creates a new <code>Graphics</code> object based on this ... *//** Translates the origin of the graphics context to the point ... *//** Gets this graphics context's current color. ... *//** Sets this graphics context's current color to the specified ... *//** Sets the paint mode of this graphics context to overwrite the ... *//** Sets the paint mode of this graphics context to alternate between ... *//** Gets the current font. ... *//** Sets this graphics context's font to the specified font. ... *//** Gets the font metrics of the current font. ... *//** Returns the bounding rectangle of the current clipping area. ... *//** Intersects the current clip with the specified rectangle. ... *//** Sets the current clip to the rectangle specified by the given ... *//** Gets the current clipping area. ... *//** Sets the current clipping area to an arbitrary clip shape. ... *//** Copies an area of the component by a distance specified by ... *//** Draws a line, using the current color, between the points ... *//** Fills the specified rectangle. ... *//** Draws the outline of the specified rectangle. ... *//** Clears the specified rectangle by filling it with the background ... *//** Draws an outlined round-cornered rectangle using this graphics ... *//** Fills the specified rounded corner rectangle with the current color. ... *//** Draws a 3-D highlighted outline of the specified rectangle. ... */Color brighterColor darker/** Paints a 3-D highlighted rectangle filled with the current color. ... *//** Draws the outline of an oval. ... *//** Fills an oval bounded by the specified rectangle with the ... *//** Draws the outline of a circular or elliptical arc ... *//** Fills a circular or elliptical arc covering the specified rectangle. ... *//** Draws a sequence of connected lines defined by ... *//** Draws a closed polygon defined by ... *//** Draws the outline of a polygon defined by the specified ... */drawPolygon(...)p.xpointsp.ypointsp.npoints/** Fills a closed polygon defined by ... *//** Fills the polygon defined by the specified Polygon object with ... *//** Draws the text given by the specified string, using this ... *//** Renders the text of the specified iterator applying its attributes ... *//** Draws the text given by the specified character array, using this ... *//** Draws the text given by the specified byte array, using this ... *//** Draws as much of the specified image as is currently available. ... *//** Draws as much of the specified image as has already been scaled ... *//** Draws as much of the specified area of the specified image as is ... *//** Disposes of this graphics context and releases ... *//** Disposes of this graphics context once it is no longer referenced. ... *//** Returns a <code>String</code> object representing this ... *//** Returns true if the specified rectangular area might intersect ... */// Note, this implementation is not very efficient.// Subclasses should override this method and calculate// the results more directly.// Subclasses should override this method and avoid// the allocation overhead of getClipBounds().import BufferedImageOpimport RenderableImage/** This <code>Graphics2D</code> class extends the ... *//** Constructs a new <code>Graphics2D</code> object.  Since ... */Paint p/** Strokes the outline of a <code>Shape</code> using the settings of the ... *//** Renders an image, applying a transform from image space into user space ... *//** Renders a <code>BufferedImage</code> that is ... *//** Renders a {@link RenderedImage}, ... *//** Renders a ... *//** Renders the text of the specified <code>String</code>, using the ... *//** Renders the text specified by the specified <code>String</code>, ... *//** Renders the text of the specified ... *//** Fills the interior of a <code>Shape</code> using the settings of the ... *//** Checks whether or not the specified <code>Shape</code> intersects ... *//** Returns the device configuration associated with this ... *//** Sets the <code>Composite</code> for the <code>Graphics2D</code> context. ... *//** Sets the <code>Paint</code> attribute for the ... *//** Sets the <code>Stroke</code> for the <code>Graphics2D</code> context. ... *//** Sets the value of a single preference for the rendering algorithms. ... *//** Returns the value of a single preference for the rendering algorithms. ... *//** Replaces the values of all preferences for the rendering ... *//** Sets the values of an arbitrary number of preferences for the ... *//** Gets the preferences for the rendering algorithms.  Hint categories ... *//** Translates the origin of the <code>Graphics2D</code> context to the ... *//** Concatenates the current ... *//** Concatenates the current <code>Graphics2D</code> ... *//** Composes an <code>AffineTransform</code> object with the ... *//** Overwrites the Transform in the <code>Graphics2D</code> context. ... *//** Returns a copy of the current <code>Transform</code> in the ... *//** Returns the current <code>Paint</code> of the ... *//** Returns the current <code>Composite</code> in the ... *//** Sets the background color for the <code>Graphics2D</code> context. ... *//** Returns the background color used for clearing a region. ... *//** Returns the current <code>Stroke</code> in the ... *//** Intersects the current <code>Clip</code> with the interior of the ... *//** Get the rendering context of the <code>Font</code> within this ... *///drawLine(x, y, x, y + height);//drawLine(x + 1, y, x + width - 1, y);//drawLine(x + 1, y + height, x + width, y + height);//drawLine(x + width, y, x + width, y + height - 1);//drawLine(x, y, x, y + height - 1);//drawLine(x + 1, y, x + width - 2, y);//drawLine(x + 1, y + height - 1, x + width - 1, y + height - 1);//drawLine(x + width - 1, y, x + width - 1, y + height - 2);import SunGraphicsCallbacknew PaintCallback(...)PaintCallback instance;new PrintCallback(...)PrintCallback instance;new PaintAllCallback(...)PaintAllCallback instance;paintAll(...)new PrintAllCallback(...)PrintAllCallback instance;printAll(...)new PeerPaintCallback(...)PeerPaintCallback instance;new PeerPrintCallback(...)PeerPrintCallback instance;new PaintHeavyweightComponentsCallback(...)PaintHeavyweightComponentsCallback instance;new PrintHeavyweightComponentsCallback(...)PrintHeavyweightComponentsCallback instance;/** The <code>GraphicsConfigTemplate</code> class is used to obtain a valid ... *//** This class is an abstract class so only subclasses can be ... */int REQUIRED;/** Value used for "Enum" (Integer) type.  States that this ... */int PREFERRED;int UNNECESSARY;/** Returns the "best" configuration possible that passes the ... *//** Returns a <code>boolean</code> indicating whether or ... */import SunVolatileImage/* REMIND:  What to do about capabilities? ... *//** The <code>GraphicsConfiguration</code> class describes the ... */BufferCapabilities defaultBufferCaps;ImageCapabilities defaultImageCaps;/** This is an abstract class that cannot be instantiated directly. ... *//** Returns the {@link GraphicsDevice} associated with this ... *//** Returns a {@link BufferedImage} with a data layout and color model ... */ColorModel model/** Returns a <code>BufferedImage</code> that supports the specified ... */createCompatibleImage(...)/** Returns a {@link VolatileImage} with a data layout and color model ... */VolatileImage vicreateCompatibleVolatileImage(...)new SunVolatileImage(...)isAccelerated(...)getCapabilities(...)/** Returns the {@link ColorModel} associated with this ... *//** Returns the <code>ColorModel</code> associated with this ... *//** Returns the default {@link AffineTransform} for this ... *//** Returns a <code>AffineTransform</code> that can be concatenated ... *//** Returns the bounds of the <code>GraphicsConfiguration</code> ... *//** Returns the buffering capabilities of this ... */new DefaultBufferCapabilities(...)getImageCapabilities(...)/** Returns the image capabilities of this ... *//** Returns whether this {@code GraphicsConfiguration} supports ... */// shouldn't happen: we're passing in null caps// Overridden in subclasses/** The <code>GraphicsDevice</code> class describes the graphics devices ... */Window fullScreenWindow;AppContext fullScreenAppContext;Object fsAppContextLock;// current full screen window// this lock is used for making synchronous changes to the AppContext's// created the FS window// tracks which AppContextRectangle windowedModeBounds;int TYPE_RASTER_SCREEN;/** Device is a raster screen. */int TYPE_PRINTER;/** Device is a printer. */int TYPE_IMAGE_BUFFER;/** Device is an image buffer.  This buffer can reside in device ... */new WindowTranslucency(...)WindowTranslucency PERPIXEL_TRANSPARENT;WindowTranslucency TRANSLUCENT;WindowTranslucency PERPIXEL_TRANSLUCENT;/** Returns the type of this <code>GraphicsDevice</code>. ... *//** Returns the identification string associated with this ... *//** Returns all of the <code>GraphicsConfiguration</code> ... *//** Returns the default <code>GraphicsConfiguration</code> ... */getBestConfiguration(...)/** Returns <code>true</code> if this <code>GraphicsDevice</code> ... *//** Enter full-screen mode, or return to windowed mode.  The entered ... */getFullScreenWindow(...)setFullScreenWindow(...)windowedModeBounds.widthwindowedModeBounds.heightRectangle screenBoundsisDispatchThreadForAppContext(...)screenBounds.xscreenBounds.yscreenBounds.widthscreenBounds.height/** Returns the <code>Window</code> object representing the ... */Window returnWindow/** Sets the display mode of this graphics device. This is only allowed ... *//** Returns the current display mode of this ... */new DisplayMode(...)/** Returns all display modes available for this ... */new DisplayMode[]getDisplayMode(...)/** This method returns the number of bytes available in ... */isWindowPerpixelTranslucencySupported(...)getTranslucencyCapableGC(...)GraphicsConfiguration defaultGC// Check if this window is in fullscreen mode on another device.// if the window went into fs mode before it was realized it may// have (0,0) dimensions// Set the full screen window// Associate fullscreen window with current AppContext// Note that we use the graphics configuration of the device,// not the window's, because we're setting the fs window for// this device.// Update graphics configuration here directly and do not wait// asynchronous notification from the peer. Note that// setBounds() will reset a GC, if it was set incorrectly.// Only return a handle to the current fs window if we are in the// same AppContext that set the fs window// TODO: cache translucency capable GCimport HeadlessGraphicsEnvironment/** The <code>GraphicsEnvironment</code> class describes the collection ... */GraphicsEnvironment localEnv;Boolean headless;/** The headless state of the Toolkit and GraphicsEnvironment */Boolean defaultHeadless;/** The headless state assumed by default *//** This is an abstract class and cannot be instantiated directly. ... *//** Returns the local <code>GraphicsEnvironment</code>. ... */createGE(...)/** Creates and returns the GraphicsEnvironment, according to the ... */Class<GraphicsEnvironment> geClsnew HeadlessGraphicsEnvironment(...)/** Tests whether or not a display, keyboard, and mouse can be ... */getHeadlessProperty(...)String osNameString display/** Check for headless state and throw HeadlessException if headless ... *//** Returns whether or not a display, keyboard, and mouse can be ... *//** Returns an array of all of the screen <code>GraphicsDevice</code> ... *//** Returns the default screen <code>GraphicsDevice</code>. ... *//** Returns a <code>Graphics2D</code> object for rendering into the ... *//** Returns an array containing a one-point size instance of all fonts ... *//** Returns an array containing the names of all font families in this ... *//** Registers a <i>created</i> <code>Font</code>in this ... */registerFont(...)/** Indicates a preference for locale-specific fonts in the mapping of ... */preferLocaleFonts(...)/** Indicates a preference for proportional over non-proportional (e.g. ... */preferProportionalFonts(...)/** Returns the Point where Windows should be centered. ... */Rectangle usableBoundsgetUsableBounds(...)usableBounds.xusableBounds.widthusableBounds.yusableBounds.height/** Returns the maximum bounds for centered Windows. ... *///          long t0 = System.currentTimeMillis();// First we try if the bootclassloader finds the requested// class. This way we can avoid to run in a privileged block.// If the bootclassloader fails, we try again with the// application classloader.//          long t1 = System.currentTimeMillis();//          System.out.println("GE creation took " + (t1-t0)+ "ms.");// initialize the values/* No need to ask for DISPLAY when run in a browser */// By default (local graphics environment), simply check the// headless property.// Default implementation: return the center of the usable bounds of the// default screen device.// Default implementation: return the usable bounds of the default screen// device.  This is correct for Microsoft Windows and non-Xinerama X11./** The <code>GridBagConstraints</code> class specifies constraints ... */int RELATIVE;/** Specifies that this component is the next-to-last component in its ... */int REMAINDER;/** Specifies that this component is the ... *//** Do not resize the component. */int BOTH;/** Resize the component both horizontally and vertically. *//** Resize the component horizontally but not vertically. *//** Resize the component vertically but not horizontally. *//** Put the component in the center of its display area. */int NORTH;/** Put the component at the top of its display area, ... */int NORTHEAST;/** Put the component at the top-right corner of its display area. */int EAST;/** Put the component on the right side of its display area, ... */int SOUTHEAST;/** Put the component at the bottom-right corner of its display area. */int SOUTH;/** Put the component at the bottom of its display area, centered ... */int SOUTHWEST;/** Put the component at the bottom-left corner of its display area. */int WEST;/** Put the component on the left side of its display area, ... */int NORTHWEST;/** Put the component at the top-left corner of its display area. */int PAGE_START;/** Place the component centered along the edge of its display area ... */int PAGE_END;int LINE_START;/** Place the component centered along the edge of its display area where ... */int LINE_END;int FIRST_LINE_START;/** Place the component in the corner of its display area where ... */int FIRST_LINE_END;int LAST_LINE_START;int LAST_LINE_END;int BASELINE;/** Possible value for the <code>anchor</code> field.  Specifies ... */int BASELINE_LEADING;int BASELINE_TRAILING;int ABOVE_BASELINE;int ABOVE_BASELINE_LEADING;int ABOVE_BASELINE_TRAILING;int BELOW_BASELINE;int BELOW_BASELINE_LEADING;int BELOW_BASELINE_TRAILING;int gridx;/** Specifies the cell containing the leading edge of the component's ... */int gridy;/** Specifies the cell at the top of the component's display area, ... */int gridwidth;/** Specifies the number of cells in a row for the component's ... */int gridheight;/** Specifies the number of cells in a column for the component's ... */double weightx;/** Specifies how to distribute extra horizontal space. ... */double weighty;/** Specifies how to distribute extra vertical space. ... */int anchor;/** This field is used when the component is smaller than its ... */int fill;/** This field is used when the component's display area is larger ... *//** This field specifies the external padding of the component, the ... */int ipadx;/** This field specifies the internal padding of the component, how much ... */int ipady;/** This field specifies the internal padding, that is, how much ... */int tempX;/** Temporary place holder for the x coordinate. ... */int tempY;/** Temporary place holder for the y coordinate. ... */int tempWidth;/** Temporary place holder for the Width of the component. ... */int tempHeight;/** Temporary place holder for the Height of the component. ... */int minWidth;/** The minimum width of the component.  It is used to calculate ... */int minHeight;/** The minimum height of the component. It is used to calculate ... */int ascent;// ascent and descent include the insets and ipady values.// one of BASELINE, BASELINE_LEADING or BASELINE_TRAILING.// The following fields are only used if the anchor isint descent;Component.BaselineResizeBehavior baselineResizeBehavior;Component.BaselineResizeBehaviorint centerPadding;// baseline lands// the height needs to be padded by one when calculating where the// centerPadding is either 0 or 1 and indicates if// CENTER_OFFSET.// The folllowing two fields are used if the baseline type isint centerOffset;// Where the baseline lands relative to the center of the component./** Creates a <code>GridBagConstraint</code> object with ... *//** Creates a <code>GridBagConstraints</code> object with ... */this.gridxthis.gridythis.gridwidththis.gridheightthis.ipadxthis.ipadythis.anchorthis.weightxthis.weighty/** Creates a copy of this grid bag constraint. ... */GridBagConstraints cc.insets// this shouldn't happen, since we are Cloneable/** The <code>GridBagLayout</code> class is a flexible layout ... */int EMPIRICMULTIPLIER;int MAXGRIDSIZE;/** This field is no longer used to reserve arrays and kept for backward ... */int MINSIZE;/** The smallest grid that can be laid out by the grid bag layout. */int PREFERREDSIZE;/** The preferred grid size that can be laid out by the grid bag layout. */Hashtable<Component,GridBagConstraints> comptable;/** This hashtable maintains the association between ... */GridBagConstraints defaultConstraints;/** This field holds a gridbag constraints instance ... */GridBagLayoutInfo layoutInfo;/** This field holds the layout information ... */...[] columnWidths;/** This field holds the overrides to the column minimum ... */...[] rowHeights;/** This field holds the overrides to the row minimum ... */...[] columnWeights;/** This field holds the overrides to the column weights. ... */...[] rowWeights;/** This field holds the overrides to the row weights. ... */Component componentAdjusting;/** The component being positioned.  This is set before calling into ... *//** Creates a grid bag layout manager. */new Hashtable<Component,GridBagConstraints>(...)/** Sets the constraints for the specified component in this layout. ... *//** Gets the constraints for the specified component.  A copy of ... */GridBagConstraints constraintssetConstraints(...)/** Retrieves the constraints for the specified component. ... *//** Removes the constraints for the specified component in this layout ... *//** Determines the origin of the layout area, in the graphics coordinate ... */layoutInfo.startxlayoutInfo.starty/** Determines column widths and row heights for the layout grid. ... */int[][] dimlayoutInfo.widthlayoutInfo.heightlayoutInfo.minWidthlayoutInfo.minHeight/** Determines the weights of the layout grid's columns and rows. ... */double[][] weightslayoutInfo.weightXlayoutInfo.weightY/** Determines which cell in the layout grid contains the point ... */Point locloc.xloc.y/** Has no effect, since this layout manager does not use a per-component string. *//** Removes the specified component from this layout. ... */removeConstraints(...)/** Determines the preferred size of the <code>parent</code> ... */GridBagLayoutInfo infogetLayoutInfo(...)getMinSize(...)/** Determines the minimum size of the <code>parent</code> container ... *//** Lays out the specified container using this grid bag layout. ... */arrangeGrid(...)/** Returns a string representation of this grid bag layout's values. ... *//** Fills in an instance of <code>GridBagLayoutInfo</code> for the ... *//* DEBUG ... *//** Print the layout constraints.  Useful for debugging. *//** Print the layout information.  Useful for debugging. */GetLayoutInfo(...)/* Calculate maximum array sizes to allocate arrays without ensureCapacity ... */int curXint curYint curWidthint curHeightint preMaximumArrayXIndexint preMaximumArrayYIndexlong[] returnArrayint compIdlookupConstraints(...)constraints.gridxconstraints.gridyconstraints.gridwidthconstraints.gridheight/** This method is obsolete and supplied for backwards ... *///PreInitMaximumSizesGridBagLayoutInfo rint layoutWidthint layoutHeightint[] xMaxArrayint[] yMaxArrayint compindexint pixels_diffint nextSizeint curRowint curColdouble weight_diffdouble weightint maximumArrayXIndexint maximumArrayYIndexint anchorlong[] arraySizespreInitMaximumArraySizes(...)boolean hasBaselineint[] maxAscentint[] maxDescentshort[] baselineTyperowHeights.lengthcolumnWidths.lengthconstraints.minWidthconstraints.minHeightcalculateBaseline(...)new GridBagLayoutInfo(...)r.maxAscentr.maxDescentr.baselineTyper.hasBaselineconstraints.tempXconstraints.tempYconstraints.tempWidthconstraints.tempHeightconstraints.anchorGridBagConstraints.BASELINEGridBagConstraints.BASELINE_LEADINGGridBagConstraints.BASELINE_TRAILINGconstraints.ascentconstraints.descentconstraints.baselineResizeBehaviorComponent.BaselineResizeBehavior.CONSTANT_DESCENTGridBagConstraints.ABOVE_BASELINEGridBagConstraints.ABOVE_BASELINE_LEADINGGridBagConstraints.ABOVE_BASELINE_TRAILINGconstraints.ipadyconstraints.insets.topconstraints.insetsconstraints.insets.bottomGridBagConstraints.BELOW_BASELINEGridBagConstraints.BELOW_BASELINE_LEADINGGridBagConstraints.BELOW_BASELINE_TRAILINGr.weightXr.weightYr.minWidthr.minHeightr.weightX.lengthcolumnWeights.lengthr.weightY.lengthrowWeights.lengthconstraints.weightxdouble wtconstraints.insets.rightconstraints.insets.leftconstraints.ipadxconstraints.weightydouble dy/** Calculate the baseline for the specified component. ... *///getLayoutInfo()getBaselineResizeBehavior(...)constraints.centerPaddingComponent.BaselineResizeBehavior.CENTER_OFFSETint nextBaselineconstraints.centerOffset/** Adjusts the x, y, width, and height fields to the correct ... */AdjustForGravity(...)int diffxint diffyint cellYint cellHeightconstraints.fillGridBagConstraints.VERTICALalignOnBaseline(...)alignAboveBaseline(...)alignBelowBaseline(...)GridBagConstraints.PAGE_STARTGridBagConstraints.NORTHGridBagConstraints.NORTHEASTGridBagConstraints.SOUTHEASTGridBagConstraints.PAGE_ENDGridBagConstraints.SOUTHGridBagConstraints.SOUTHWESTGridBagConstraints.NORTHWESTGridBagConstraints.LINE_ENDGridBagConstraints.FIRST_LINE_STARTGridBagConstraints.LAST_LINE_STARTGridBagConstraints.LAST_LINE_END/** Positions on the baseline. ... */cons.ascentcons.baselineResizeBehaviorcons.insets.bottomcons.descentlayoutInfo.maxDescentcons.tempYcons.tempHeightcons.insetsisVerticallyResizable(...)cons.minHeightcons.insets.tophasConstantDescent(...)layoutInfo.maxAscentComponent.BaselineResizeBehavior.OTHERboolean fitsint ascent2cons.minWidthint upperint lowercons.centerOffsetcons.centerPaddingcenterVertically(...)/** Positions the specified component above the baseline. That is ... */hasBaseline(...)cons.ipady/** Positions below the baseline. *//** Figures out the minimum size of the ... */GetMinSize(...)info.widthinfo.minWidthinfo.heightinfo.minHeightboolean rightToLeft;/** Lays out the grid. ... */ArrangeGrid(...)int diffwint diffhinfo.weightXinfo.weightYinfo.startxinfo.startyadjustForGravity(...)// Added for serial backwards compatibility (4348425)// -1==RELATIVE, means that column|row equals to previously added component,// since each next Component with gridx|gridy == RELATIVE starts from// previous position, so we should start from previous component which// already used in maximumArray[X|Y]Index calculation. We could just increase// maximum by 1 to handle situation when component with gridx=-1 was added.// gridwidth|gridheight may be equal to RELATIVE (-1) or REMAINDER (0)// in any case using 1 instead of 0 or -1 should be sufficient to for// correct maximumArraySizes calculation//for (components) loop// Must specify index++ to allocate well-working arrays./* fix for 4623196. ... */// Code below will address index curX+curWidth in the case of yMaxArray, weightY// ( respectively curY+curHeight for xMaxArray, weightX ) where//  curX in 0 to preInitMaximumArraySizes.y// Thus, the maximum index that could// be calculated in the following code is curX+curX.// EmpericMultier equals 2 because of this.// constraints.gridx// constraints.gridy// constraints.gridwidth// constraints.gridheight/* Pass #1 ... *//* If x or y is negative, then use relative positioning: *//* Adjust the grid width and height ... *//* Adjust xMaxArray and yMaxArray *//* Cache the current slave's size. *//* Zero width and height must mean that this is the last item (or ... *//* Zero width starts a new row *//* Zero height starts a new column *//* Apply minimum row/column dimensions *//* Pass #2 ... *//* Make negative sizes start a new row/column *//* Assign the new values to the gridbag slave */// Component positioned above the baseline.// To make the bottom edge of the component aligned// with the baseline the bottom inset is// added to the descent, the rest to the ascent.// Component positioned below the baseline.// To make the top edge of the component aligned// with the baseline the top inset is// added to the ascent, the rest to the descent./* Apply minimum row/column dimensions and weights *//* Pass #3 ... *//* right column *//* Figure out if we should use this slave\'s weight.  If the weight ... *//* Assign the remainder to the rightmost cell *//* Calculate the minWidth array values. ... *//* Any leftovers go into the rightmost cell *//* bottom row *//* Figure out if we should use this slave's weight.  If the weight ... *//* Assign the remainder to the bottom cell *//* Calculate the minHeight array values. ... *//* Any leftovers go into the bottom cell */// Apply the padding to the component, then ask for the baseline.// Component has a baseline// Adjust the ascent and descent to include the insets.// Component has a baseline resize behavior of// CENTER_OFFSET, calculate centerPadding and// centerOffset (see the description of// CENTER_OFFSET in the enum for detais on this// algorithm).// Anchor to the bottom.// Baseline is at (cellY + cellHeight - maxDescent).// Bottom of component (maxY) is at baseline + descent// of component. We need to subtract the bottom inset here// as the descent in the constraints object includes the// bottom inset.// Component not resizable, calculate y location// from maxY - height.// Component is resizable. As brb is constant descent,// can expand component to fill region above baseline.// Subtract out the top inset so that components insets// are honored.// BRB is not constant_descent// baseline for the row, relative to cellY// Component baseline, includes insets.top// Mixed ascent/descent in same row, calculate position// off maxDescent// Only ascents/unknown in this row, anchor to top// BRB is other, which means we can only determine// the baseline by asking for it again giving the// size we plan on using for the component.// Component has a baseline, pad with top inset// (this follows from calculateBaseline which// does the same).// Components baseline fits within rows baseline.// Make sure the descent fits within the space as well.// It fits, we're good.// Doesn't fit, but it's resizable.  Try// again assuming we'll get ascent again.// It'll fit// Doesn't fit, use min size and original ascent// Reset the components y location based on// components ascent and baseline for row. Because ascent// includes the baseline// Off by 1// Handled above// Baseline for the row// Prefer descent// Prefer ascent// Component is resizable. Top edge is offset by top// inset, bottom edge on baseline.// Not resizable./* If the parent has no slaves anymore, then don't do anything ... *//* Pass #1: scan all the slaves to figure out the total amount ... *//* If the current dimensions of the window don't match the desired ... *//* Now do the actual layout of the slaves using the layout information ... *//* fix for 4408108 - components were being created outside of the container *//* fix for 4969409 "-" replaced by "+" *//* If the window is too small to be interesting then ... *//** The {@code GridBagLayoutInfo} is an utility class for ... */int startx, ...;/* number of  cells: horizontal and vertical */...[] minWidth;/* starting point for layout */...[] minHeight;/* largest minWidth in each column */...[] weightX;/* largest minHeight in each row */...[] weightY;/* largest weight in each column */boolean hasBaseline;/* largest weight in each row */...[] baselineType;// row.// These are only valid if hasBaseline is true and are indexed by/* Whether or not baseline layout has been ... */...[] maxAscent;/* The type of baseline for a particular ... */...[] maxDescent;/* Max ascent (baseline). *//** Creates an instance of GridBagLayoutInfo representing {@code GridBagLayout} ... *//* Max descent (height - baseline) *//** Returns true if the specified row has any component aligned on the ... *//** Returns true if there is a baseline for the specified row. *//** The <code>GridLayout</code> class is a layout manager that ... *//** This is the horizontal gap (in pixels) which specifies the space ... *//** This is the vertical gap (in pixels) which specifies the space ... */int rows;/** This is the number of rows specified for the grid.  The number ... *//** This is the number of columns specified for the grid.  The number ... *//** Creates a grid layout with a default of one column per component, ... *//** Creates a grid layout with the specified number of rows and ... */this.rowsthis.cols/** Gets the number of rows in this layout. ... *//** Sets the number of rows in this layout to the specified value. ... *//** Gets the number of columns in this layout. ... *//** Sets the number of columns in this layout to the specified value. ... *//** Sets the horizontal gap between components to the specified value. ... *//** Sets the vertical gap between components to the specified value. ... *//** Adds the specified component with the specified name to the layout. ... */int nrowsint ncols/** Determines the minimum size of the container argument using this ... *//** Lays out the specified container using this layout. ... */int totalGapsWidthint widthWOInsetsint widthOnComponentint extraWidthAvailableint totalGapsHeightint heightWOInsetsint heightOnComponentint extraHeightAvailable/** Returns the string representation of this grid layout's values. ... */// 4370316. To position components in the center we should:// 1. get an amount of extra space within Container// 2. incorporate half of that value to the left/top position// Note that we use trancating division for widthOnComponent// The reminder goes to extraWidthAvailable/** Thrown when code that is dependent on a keyboard, display, or mouse ... */String superMessageString headlessMessagegetHeadlessMessage(...)/** Signals that an AWT component is not in an appropriate state for ... *//** Constructs an IllegalComponentStateException with no detail message. ... *//** Constructs an IllegalComponentStateException with the specified detail ... *//* Copyright (c) 1996, 1997, Oracle and/or its affiliates. All rights reserved. ... */import AreaAveragingScaleFilterimport ReplicateScaleFilterimport SurfaceManager/** The abstract class <code>Image</code> is the superclass of all ... */setImageAccessor(...)SurfaceManager.ImageAccessorimg.surfaceManager/** convenience object; we can use this single static object for ... */float accelerationPriority;/** Priority for accelerating this image.  Subclasses are free to ... *//** Determines the width of the image. If the width is not yet known, ... *//** Determines the height of the image. If the height is not yet known, ... *//** Gets the object that produces the pixels for the image. ... *//** Creates a graphics context for drawing to an off-screen image. ... *//** Gets a property of this image by name. ... */Object UndefinedProperty;/** The <code>UndefinedProperty</code> object should be returned whenever a ... *//** Creates a scaled version of this image. ... */ImageProducer prodnew AreaAveragingScaleFilter(...)new ReplicateScaleFilter(...)int SCALE_DEFAULT;/** Use the default image-scaling algorithm. ... */int SCALE_FAST;/** Choose an image-scaling algorithm that gives higher priority ... */int SCALE_SMOOTH;int SCALE_REPLICATE;/** Use the image scaling algorithm embodied in the ... */int SCALE_AREA_AVERAGING;/** Use the Area Averaging image scaling algorithm.  The ... *//** Flushes all reconstructable resources being used by this Image object. ... *//** Returns an ImageCapabilities object which can be ... *//** Sets a hint for this image about how important acceleration is. ... */setAccelerationPriority(...)/** Returns the current value of the acceleration priority hint. ... */SurfaceManager surfaceManager;// Note: this is just a default object that gets returned in the// absence of any more specific information from a surfaceManager.// Subclasses of Image should either override this method or// make sure that they always have a non-null SurfaceManager// to return an ImageCapabilities object that is appropriate// for their given subclass type./** Capabilities and properties of images. ... */boolean accelerated;/** Creates a new object for specifying image capabilities. ... */this.accelerated/** Returns <code>true</code> if the object whose capabilities are ... *//** Returns <code>true</code> if the <code>VolatileImage</code> ... *//** An <code>Insets</code> object is a representation of the borders ... *//** The inset from the top. ... *//** The inset from the left. ... *//** The inset from the bottom. ... *//** The inset from the right. ... *//** Creates and initializes a new <code>Insets</code> object with the ... *//** Set top, left, bottom, and right to the specified values ... *//** Checks whether two insets objects are equal. Two instances ... *//** Returns the hash code for this Insets. ... */int sum1int sum2int val1int val2int sum3/** Returns a string representation of this <code>Insets</code> object. ... *//** Create a copy of this object. ... *//* Copyright (c) 1995, 2011, Oracle and/or its affiliates. All rights reserved. ... *//** The interface for objects which contain a set of items for ... *//** Returns the selected items or <code>null</code> if no ... *//** Adds a listener to receive item events when the state of an item is ... *//** Removes an item listener. ... *//* Copyright (c) 1996, 2000, Oracle and/or its affiliates. All rights reserved. ... *//** A set of attributes which control a print job. ... *//** A type-safe enumeration of possible default selection states. ... */new DefaultSelectionType(...)int I_ALL;int I_RANGE;int I_SELECTION;DefaultSelectionType ALL;/** The <code>DefaultSelectionType</code> instance to use for ... */DefaultSelectionType RANGE;DefaultSelectionType SELECTION;/** A type-safe enumeration of possible job destinations. ... */new DestinationType(...)int I_FILE;int I_PRINTER;DestinationType FILE;/** The <code>DestinationType</code> instance to use for ... */DestinationType PRINTER;/** A type-safe enumeration of possible dialogs to display to the user. ... */new DialogType(...)int I_COMMON;int I_NATIVE;int I_NONE;DialogType COMMON;/** The <code>DialogType</code> instance to use for ... */DialogType NATIVE;DialogType NONE;/** A type-safe enumeration of possible multiple copy handling states. ... */new MultipleDocumentHandlingType(...)int I_SEPARATE_DOCUMENTS_COLLATED_COPIES;int I_SEPARATE_DOCUMENTS_UNCOLLATED_COPIES;MultipleDocumentHandlingType SEPARATE_DOCUMENTS_COLLATED_COPIES;/** The <code>MultipleDocumentHandlingType</code> instance to use for specifying ... */MultipleDocumentHandlingType SEPARATE_DOCUMENTS_UNCOLLATED_COPIES;/** A type-safe enumeration of possible multi-page impositions. These ... */new SidesType(...)int I_ONE_SIDED;int I_TWO_SIDED_LONG_EDGE;int I_TWO_SIDED_SHORT_EDGE;SidesType ONE_SIDED;/** The <code>SidesType</code> instance to use for specifying that ... */SidesType TWO_SIDED_LONG_EDGE;SidesType TWO_SIDED_SHORT_EDGE;int copies;DefaultSelectionType defaultSelection;DestinationType destination;DialogType dialog;int fromPage;int maxPage;int minPage;MultipleDocumentHandlingType multipleDocumentHandling;...[] pageRanges;int prFirst;int prLast;String printer;SidesType sides;int toPage;/** Constructs a <code>JobAttributes</code> instance with default ... */setCopiesToDefault(...)setDefaultSelection(...)DefaultSelectionType.ALLDestinationType.PRINTERsetDialog(...)DialogType.NATIVEsetMaxPage(...)setMinPage(...)setMultipleDocumentHandlingToDefault(...)setSidesToDefault(...)/** Constructs a <code>JobAttributes</code> instance which is a copy ... *//** Constructs a <code>JobAttributes</code> instance with the ... */setCopies(...)setMultipleDocumentHandling(...)setPageRanges(...)setPrinter(...)setSides(...)/** Creates and returns a copy of this <code>JobAttributes</code>. ... *//** Sets all of the attributes of this <code>JobAttributes</code> to ... */obj.copiesobj.defaultSelectionobj.destinationobj.dialogobj.fileNameobj.fromPageobj.maxPageobj.minPageobj.multipleDocumentHandlingobj.pageRangesobj.prFirstobj.prLastobj.printerobj.sidesobj.toPage/** Returns the number of copies the application should render for jobs ... *//** Specifies the number of copies the application should render for jobs ... */this.copies/** Sets the number of copies the application should render for jobs using ... *//** Specifies whether, for jobs using these attributes, the application ... */this.defaultSelection/** Specifies whether output will be to a printer or a file for jobs using ... *//** Returns whether, for jobs using these attributes, the user should see ... *//** Specifies whether, for jobs using these attributes, the user should see ... */this.dialog/** Specifies the file name for the output file for jobs using these ... *//** Returns, for jobs using these attributes, the first page to be ... */getMinPage(...)/** Specifies, for jobs using these attributes, the first page to be ... */this.fromPage/** Specifies the maximum value the user can specify as the last page to ... */this.maxPage/** Specifies the minimum value the user can specify as the first page to ... */this.minPage/** Specifies the handling of multiple copies, including collation, for ... */this.multipleDocumentHandling/** Sets the handling of multiple copies, including collation, for jobs ... */MultipleDocumentHandlingType.SEPARATE_DOCUMENTS_UNCOLLATED_COPIES/** Specifies, for jobs using these attributes, the ranges of pages to be ... */int[][] copypageRanges.lengthint fromPagegetFromPage(...)int toPagegetToPage(...)int minPageString xcpint firstthis.pageRangesthis.prFirstthis.prLast/** Returns the destination printer for jobs using these attributes. This ... *//** Specifies the destination printer for jobs using these attributes. ... */this.printer/** Returns how consecutive pages should be imposed upon the sides of the ... *//** Specifies how consecutive pages should be imposed upon the sides of the ... */this.sides/** Sets how consecutive pages should be imposed upon the sides of the ... */SidesType.ONE_SIDED/** Returns, for jobs using these attributes, the last page (inclusive) ... *//** Specifies, for jobs using these attributes, the last page (inclusive) ... */this.toPage/** Determines whether two JobAttributes are equal to each other. ... */JobAttributes rhsrhs.fileNamerhs.pageRangesrhs.pageRanges.lengthrhs.printerrhs.copiesrhs.defaultSelectionrhs.destinationrhs.dialogrhs.fromPagerhs.maxPagerhs.minPagerhs.multipleDocumentHandlingrhs.prFirstrhs.prLastrhs.sidesrhs.toPage/** Returns a hash code value for this JobAttributes. ... *//** Returns a string representation of this JobAttributes. ... */int[][] pageRangesgetPageRanges(...)String prStrgetSides(...)getPrinter(...)getMultipleDocumentHandling(...)getMaxPage(...)getDialog(...)getDefaultSelection(...)getCopies(...)// okay because we never modify the contents of pageRanges// Return a copy because otherwise client code could circumvent the// the checks made in setPageRanges by modifying the returned// array.// Store a copy because otherwise client code could circumvent the// the checks made above by holding a reference to the array and// modifying it after calling setPageRanges./** A KeyEventDispatcher cooperates with the current KeyboardFocusManager in the ... *//** This method is called by the current KeyboardFocusManager requesting ... *//** A KeyEventPostProcessor cooperates with the current KeyboardFocusManager ... *//** This method is called by the current KeyboardFocusManager, requesting ... */import KeyboardFocusManagerPeerimport VetoableChangeSupportimport KeyboardFocusManagerPeerProvider/** The KeyboardFocusManager is responsible for managing the active and focused ... */new DefaultFocusTraversalPolicy(...)setKeyboardFocusManagerAccessor(...)AWTAccessor.KeyboardFocusManagerAccessorshouldNativelyFocusHeavyweight(...)processSynchronousLightweightTransfer(...)removeLastFocusRequest(...)KeyboardFocusManager.currentFocusCycleRootnew AWTKeyStroke[][]new WeakHashMap<Window,WeakReference<Component>>(...)new LinkedList<HeavyweightFocusRequest>(...)// Shared focus engine loggerKeyboardFocusManagerPeer peer;int FORWARD_TRAVERSAL_KEYS;/** The identifier for the Forward focus traversal keys. ... */int BACKWARD_TRAVERSAL_KEYS;/** The identifier for the Backward focus traversal keys. ... */int UP_CYCLE_TRAVERSAL_KEYS;/** The identifier for the Up Cycle focus traversal keys. ... */int DOWN_CYCLE_TRAVERSAL_KEYS;/** The identifier for the Down Cycle focus traversal keys. ... */int TRAVERSAL_KEY_LENGTH;/** Returns the current KeyboardFocusManager instance for the calling ... */new DefaultKeyboardFocusManager(...)/** Sets the current KeyboardFocusManager instance for the calling thread's ... */KeyboardFocusManager oldManagercheckReplaceKFMPermission(...)AppContext appcontextComponent focusOwner;/** The Component in an application that will typically receive all ... */Component permanentFocusOwner;/** The Component in an application that will regain focus when an ... */Window focusedWindow;/** The Window which is, or contains, the focus owner. */Window activeWindow;/** Only a Frame or a Dialog can be the active Window. The native windowing ... */FocusTraversalPolicy defaultPolicy;/** The default FocusTraversalPolicy for all Windows that have no policy of ... */...[] defaultFocusTraversalKeyPropertyNames;/** The bound property names of each focus traversal key. */...[] defaultFocusTraversalKeyStrokes;/** The default strokes for initializing the default focus traversal keys. */...[] defaultFocusTraversalKeys;/** The default focus traversal keys. Each array of traversal keys will be ... */Container currentFocusCycleRoot;/** The current focus cycle root. If the focus owner is itself a focus cycle ... */VetoableChangeSupport vetoableSupport;/** A description of any VetoableChangeListeners which have been registered. *//** A description of any PropertyChangeListeners which have been registered. */LinkedList<KeyEventDispatcher> keyEventDispatchers;/** This KeyboardFocusManager's KeyEventDispatcher chain. The List does not ... */LinkedList<KeyEventPostProcessor> keyEventPostProcessors;/** This KeyboardFocusManager's KeyEventPostProcessor chain. The List does ... */Map<Window,WeakReference<Component>> mostRecentFocusOwners;/** Maps Windows to those Windows' most recent focus owners. */AWTPermission replaceKeyboardFocusManagerPermission;/** We cache the permission used to verify that the calling thread is ... */SequencedEvent currentSequencedEvent;/* SequencedEvent which is currently dispatched in AppContext. */Collections.EMPTY_SET/** Initializes a KeyboardFocusManager. */Set<AWTKeyStroke> work_setinitPeer(...)KeyboardFocusManagerPeerProvider peerProvidergetKeyboardFocusManagerPeer(...)/** Returns the focus owner, if the focus owner is in the same context as ... */focusOwner.appContext/** Returns the focus owner, even if the calling thread is in a different ... */checkKFMSecurity(...)/** Sets the focus owner. The operation will be cancelled if the Component ... */boolean shouldFirefireVetoableChange(...)KeyboardFocusManager.focusOwner/** Clears the focus owner at both the Java and native levels if the ... */clearGlobalFocusOwner(...)/** Clears the global focus owner at both the Java and native levels. If ... */_clearGlobalFocusOwner(...)markClearGlobalFocusOwner(...)getCurrentFocusOwner(...)setCurrentFocusOwner(...)getCurrentFocusedWindow(...)/** Returns the permanent focus owner, if the permanent focus owner is in ... */permanentFocusOwner.appContext/** Returns the permanent focus owner, even if the calling thread is in a ... *//** Sets the permanent focus owner. The operation will be cancelled if the ... */Component oldPermanentFocusOwnerKeyboardFocusManager.permanentFocusOwner/** Returns the focused Window, if the focused Window is in the same context ... */focusedWindow.appContext/** Returns the focused Window, even if the calling thread is in a different ... *//** Sets the focused Window. The focused Window is the Window that is or ... */KeyboardFocusManager.focusedWindow/** Returns the active Window, if the active Window is in the same context ... */activeWindow.appContext/** Returns the active Window, even if the calling thread is in a different ... *//** Sets the active Window. Only a Frame or a Dialog can be the active ... */getActiveWindow(...)KeyboardFocusManager.activeWindow/** Returns the default FocusTraversalPolicy. Top-level components ... *//** Sets the default FocusTraversalPolicy. Top-level components ... */this.defaultPolicy/** Sets the default focus traversal keys for a given traversal operation. ... *//** Returns a Set of default focus traversal keys for a given traversal ... *//** Returns the current focus cycle root, if the current focus cycle root is ... */currentFocusCycleRoot.appContext/** Returns the current focus cycle root, even if the calling thread is in a ... *//** Sets the current focus cycle root. If the focus owner is itself a focus ... */Container oldFocusCycleRootsetGlobalCurrentFocusCycleRoot(...)/** Removes a PropertyChangeListener from the listener list for a specific ... *//** Returns an array of all the <code>PropertyChangeListener</code>s ... *//** Fires a PropertyChangeEvent in response to a change in a bound property. ... *//** Adds a VetoableChangeListener to the listener list. The listener is ... */new VetoableChangeSupport(...)/** Removes a VetoableChangeListener from the listener list. This method ... *//** Returns an array of all the vetoable change listeners ... */getVetoableChangeListeners(...)/** Adds a VetoableChangeListener to the listener list for a specific ... *//** Removes a VetoableChangeListener from the listener list for a specific ... *//** Returns an array of all the <code>VetoableChangeListener</code>s ... *//** Fires a PropertyChangeEvent in response to a change in a vetoable ... */VetoableChangeSupport vetoableSupportthis.vetoableSupport/** Adds a KeyEventDispatcher to this KeyboardFocusManager's dispatcher ... */new LinkedList<KeyEventDispatcher>(...)/** Removes a KeyEventDispatcher which was previously added to this ... *//** Returns this KeyboardFocusManager's KeyEventDispatcher chain as a List. ... *//** Adds a KeyEventPostProcessor to this KeyboardFocusManager's post- ... */new LinkedList<KeyEventPostProcessor>(...)/** Removes a previously added KeyEventPostProcessor from this ... *//** Returns this KeyboardFocusManager's KeyEventPostProcessor chain as a ... */WeakReference<Component> weakValueContainer windowWindow realWindow/* Please be careful changing this method! It is called from ... *//** Redispatches an AWTEvent in such a way that the AWT event dispatcher ... *//** Typically this method will be called by <code>dispatchEvent</code> if no ... *//** This method will be called by <code>dispatchKeyEvent</code>. ... *//** Called by the AWT to notify the KeyboardFocusManager that it should ... *//** Moves the focus down one focus traversal cycle. Typically, if ... *//** Focuses the Component after the current focus owner. *//** Focuses the Component before the current focus owner. *//** Moves the focus up one focus traversal cycle from the current focus ... *//** Moves the focus down one focus traversal cycle from the current focus ... *//** Dumps the list of focus requests to stderr */HeavyweightFocusRequest reqboolean temporary;CausedFocusEvent.Cause cause;this.temporarythis.causenew HeavyweightFocusRequest(...)Component heavyweight;LinkedList<LightweightFocusRequest> lightweightRequests;HeavyweightFocusRequest CLEAR_GLOBAL_FOCUS_OWNER;this.heavyweightthis.lightweightRequestsnew LinkedList<LightweightFocusRequest>(...)addLightweightRequest(...)Component lastDescendantgetLast(...).componentgetLast(...)HeavyweightFocusRequest.CLEAR_GLOBAL_FOCUS_OWNERnew LightweightFocusRequest(...)LightweightFocusRequest lwRequestLinkedList<HeavyweightFocusRequest> heavyweightRequests;/* heavyweightRequests is used as a monitor for synchronized changes of ... */LinkedList<LightweightFocusRequest> currentLightweightRequests;boolean clearingCurrentLightweightRequests;boolean allowSyncFocusRequests;Component newFocusOwner;boolean disableRestoreFocus;int SNFH_FAILURE;int SNFH_SUCCESS_HANDLED;int SNFH_SUCCESS_PROCEED;Window parentWindowFocusEvent currentFocusOwnerEventFocusEvent newFocusOwnerEventboolean clearingThrowable caughtExparentWindow.syncLWRequestsHeavyweightFocusRequest hwFocusRequestgetLastHWRequest(...)getNativeFocusOwner(...)Component.LOCKdispatchAndCatchException(...)/** Indicates whether the native implementation should proceed with a ... */KeyboardFocusManager thisManagerComponent nativeFocusOwnerWindow nativeFocusedWindowgetNativeFocusedWindow(...)currentFocusOwner.appContextdescendant.appContexthwFocusRequest.heavyweightfocusedWindowChanged(...)/** Returns the Window which will be active after processing this request, ... */Component nativeFocusedWindowComponent activeWindowgetFirstHWRequest(...)LightweightFocusRequest lwFocusRequesthwFocusRequest.lightweightRequestslwFocusRequest.componentisAutoFocusTransferOnDisposal(...)/* Used to process exceptions in dispatching focus event (in focusLost/focusGained callbacks). ... */Throwable retExLinkedList<LightweightFocusRequest> localLightweightRequestsComponent globalFocusOwnerglobalFocusOwner.appContextComponent lastFocusOwnerIterator<LightweightFocusRequest> iterKeyboardFocusManager.LightweightFocusRequestlwFocusRequest.temporarylwFocusRequest.causeComponent oppositeboolean temporaryremoveFirstRequest(...)CausedFocusEvent.Cause.NATIVE_SYSTEMComponent nativeSourceretargetUnexpectedFocusEvent(...)getFirstLightweightRequest(...).componentgetFirstLightweightRequest(...)Component newSourceprocessCurrentLightweightRequests(...)Component nativeOppositeCausedFocusEvent.Cause.CLEAR_GLOBAL_FOCUS_OWNERretargetFocusGained(...)retargetFocusLost(...)Iterator<LightweightFocusRequest> lwIternext(...).componentclearMarkers(...)removeLast(...)Window wtoWindow wfromField proxyActive;// Accessor to private field isProxyActive of KeyEventNoSuchFieldException nsf// Returns the value of this KeyEvent's field isProxyActiveisProxyActiveImpl(...)// for calling the secured methods from KFM instance which is not current.// the security concepts. In this case the trusted client code is responsible// permissions we can't throw SecurityException because it would contradict// If this KFM instance is not the current KFM but the client code has all// due to the system KFM is trusted (and so it does like "privileged").// but still it should be able to execute the methods protected by this check// "replaceKFM" permission when a client code is on the call stack beneath,// A system KFM instance (which is the current KFM by default) may have no// permission. Here's the reasoning to do so:// or otherwise checks if the calling thread has "replaceKeyboardFocusManager"// Checks if this KeyboardFocusManager instance is the current KFM,// rejected// Toolkit must be fully initialized, otherwise// _clearGlobalFocusOwner will crash or throw an exception// Check to see if key already maps to another traversal// operation// ATTN: component has a strong reference to window via chain// of Component.parent fields.  Since WeakHasMap refers to its// values strongly, we need to break the strong link from the// value (component) back to its key (window).// Also clear temporary lost component stored in Window// Not a duplicate request// Focus transfers from a lightweight child back to the// heavyweight Container should be treated like lightweight// focus transfers.// Redundant request.// 'heavyweight' owns the native focus and there are no pending// requests. 'heavyweight' must be a Container and// 'descendant' must not be the focus owner. Otherwise,// we would never have gotten this far.// Fix 5028014. Rolled out.// SunToolkit.postPriorityEvent(currentFocusOwnerEvent);// SunToolkit.postPriorityEvent(newFocusOwnerEvent);// 'heavyweight' doesn't have the native focus right now, but// if all pending requests were completed, it would. Add// descendant to the heavyweight's list of pending// lightweight focus transfers.// For purposes of computing oldFocusedWindow, we should look at// the second to last HeavyweightFocusRequest on the queue iff the// last HeavyweightFocusRequest is CLEAR_GLOBAL_FOCUS_OWNER. If// there is no second to last HeavyweightFocusRequest, null is an// acceptable value.// need to call this out of synchronized block to avoid possible deadlock// see 6454631.// duplicate request// The current app context differs from the app context of a focus// owner (and all pending lightweight requests), so we do nothing// now and wait for a next event./* WARNING: This is based on DKFM's logic solely! ... *//* We're not dispatching FOCUS_LOST while the current focus owner is null. ... */// Any other case represents a failure condition which we did// not expect. We need to clearFocusRequestList() and patch up// the event as best as possible.// if source w/o peer and// if source is equal to first lightweight// then we should correct source and nativeSource// source is heavuweight itself// Focus change as a result of a known call to requestFocus(),// or known click on a peer focusable heavyweight Component./* Since we receive FOCUS_GAINED when current focus ... */// 'opposite' will be fixed by// DefaultKeyboardFocusManager.realOppositeComponent// Special case for FOCUS_GAINED in top-levels// If it arrives as the result of activation we should skip it// This event will not have appropriate request record and// on arrival there will be already some focus owner set.// end synchronized(heavyweightRequests)// Call to KeyboardFocusManager.clearGlobalFocusOwner()// Otherwise, fall through to failure case below// Focus leaving application// or click on a peer focusable heavyweight Component.// If a focus transfer is made across top-levels, then the// FOCUS_LOST event is always temporary, and the FOCUS_GAINED// event is always permanent. Otherwise, the stored temporary// value is honored.// If top-level changed there might be no focus request in a list// But we know the opposite, we now it is temporary - dispatch the event.// Create copy of the event with only difference in temporary parameter./* This code handles FOCUS_LOST event which is generated by ... */// Fix for 4799136 - clear type-ahead markers if requests queue is empty// We do it here because this method is called only when problems happenimport LabelPeer/** A <code>Label</code> object is a component for placing text in a ... *//** Indicates that the label should be left justified. *//** Indicates that the label should be centered. *//** Indicates that the label should be right justified. ... */String text;/** The text of this label. ... */int alignment;/** The label's alignment.  The default alignment is set ... *//** Constructs an empty label. ... *//** Constructs a new label with the specified string of text, ... *//** Constructs a new label that presents the specified string of ... *//** Read a label from an object input stream. ... *//** Creates the peer for this label.  The peer allows us to ... */createLabel(...)/** Gets the current alignment of this label. Possible values are ... *//** Sets the alignment for this label to the specified alignment. ... */LabelPeer peerthis.alignment/** Gets the text of this label. ... *//** Sets the text for this label to the specified text. ... *//** Returns a string representing the state of this <code>Label</code>. ... */String align/** Gets the AccessibleContext associated with this Label. ... */new AccessibleAWTLabel(...)/* Copyright (c) 1995, 2014, Oracle and/or its affiliates. All rights reserved. ... */// inner class AccessibleAWTLabel/** Defines the interface for classes that know how to lay out ... *//** If the layout manager uses a per-component string, ... *//** Calculates the preferred size dimensions for the specified ... *//** Calculates the minimum size dimensions for the specified ... *//** Lays out the specified container. ... *//* Copyright (c) 1995, 2005, Oracle and/or its affiliates. All rights reserved. ... *//** Defines an interface for classes that know how to layout Containers ... *//** Calculates the maximum size dimensions for the specified container, ... *//* Copyright (c) 1996, 2001, Oracle and/or its affiliates. All rights reserved. ... *//** The {@code LinearGradientPaint} class provides a way to fill ... */Point2D start, ...;/** Gradient start and end points. *//** Constructs a {@code LinearGradientPaint} with a default ... */CycleMethod.NO_CYCLE/** Constructs a {@code LinearGradientPaint} with a default {@code SRGB} ... */ColorSpaceType.SRGB/** Constructs a {@code LinearGradientPaint}. ... */concatenate(...)fractions.lengthCycleMethod.REPEATboolean cyclicnew LinearGradientPaintContext(...)/** Returns a copy of the start point of the gradient axis. ... *//** Returns a copy of the end point of the gradient axis. ... */// check input parameters// copy the points...// avoid modifying the user's transform...// incorporate the gradient transform// faster to use the basic GradientPaintContext for this// common caseimport CycleMethodimport ColorSpaceType/** Provides the actual implementation for the LinearGradientPaint. ... */float dgdX, ...;/** The following invariants are used to process the gradient value from ... *//** Constructor for LinearGradientPaintContext. ... */float startxfloat startyfloat endxfloat endyfloat dxfloat dyfloat dSqfloat constXfloat constYint rowLimitfloat initConstindexIntoGradientsArrays(...)// A given point in the raster should take on the same color as its// projection onto the gradient vector.// Thus, we want the projection of the current position vector// onto the gradient vector, then normalized with respect to the// length of the gradient vector, giving a value which can be mapped// into the range 0-1.//    projection =//        currentVector dot gradientVector / length(gradientVector)//    normalized = projection / length(gradientVector)// change in x from start to end// change in y from start to end// total distance squared// avoid repeated calculations by doing these divides once// incremental change along gradient for +x// incremental change along gradient for +y// constant, incorporates the translation components from the matrix// current value for row gradients// used to end iteration on rows// constant which can be pulled out of the inner loop// for every row// initialize current value to be start// for every pixel in this row// get the color// incremental change in g// change in off from row to row//rowlimit is width + offsetimport ListPeer/** The <code>List</code> component presents the user with a ... */Vector<String> items;/** A vector created to contain items which will become ... *//** This field will represent the number of visible rows in the ... *//** <code>multipleMode</code> is a variable that will ... */...[] selected;/** <code>selected</code> is an array that will contain ... */int visibleIndex;/** This variable contains the value that will be used ... *//** Creates a new scrolling list. ... *//** Creates a new scrolling list initialized with the specified ... */int DEFAULT_VISIBLE_ROWS;/** The default number of visible rows is 4.  A list with ... *//** Creates a new scrolling list initialized to display the specified ... *//** Construct a name for this component.  Called by ... *//** Creates the peer for the list.  The peer allows us to modify the ... *//** Removes the peer for this list.  The peer allows us to modify the ... */ListPeer peer/** Gets the number of items in the list. ... *//** Gets the item associated with the specified index. ... *//** Gets the items in the list. ... */String[] itemCopies/** Adds the specified item to the end of scrolling list. ... *//** Adds the specified item to the the scrolling list ... *//** Replaces the item at the specified index in the scrolling list ... *//** Removes all items from this list. ... *//** Removes the first occurrence of an item from the list. ... *//** Removes the item at the specified position ... */delItem(...)delItems(...)/** Gets the index of the selected item on the list, ... */int[] selsel.length/** Gets the selected indexes on the list. ... *//** Gets the selected item on this scrolling list. ... *//** Gets the selected items on this scrolling list. ... */String[] str/** Gets the selected items on this scrolling list in an array of Objects. ... *//** Selects the item at the specified index in the scrolling list. ... */boolean alreadySelectedselected.lengthint[] newsel/** Deselects the item at the specified index. ... */deselect(...)/** Determines if the specified item in this scrolling list is ... *//** Gets the number of visible lines in this list.  Note that ... *//** Determines whether this list allows multiple selections. ... */allowsMultipleSelections(...)/** Sets the flag that determines whether this list ... */setMultipleSelections(...)setMultipleMode(...)/** Gets the index of the item that was last made visible by ... *//** Makes the item at the specified index visible. ... */makeVisible(...)/** Gets the preferred dimensions for a list with the specified ... *//** Gets the preferred size of this scrolling list. ... *//** Gets the minimum dimensions for a list with the specified ... *//** Determines the minimum size of this scrolling list. ... *//** Removes the specified item listener so that it no longer ... *//** Processes events on this scrolling list. If an event is ... *//** Processes item events occurring on this list by ... *//** Processes action events occurring on this component ... *//** Returns the parameter string representing the state of this ... */int listSerializedDataVersion;/** The <code>List</code> component's ... *//* Serialization support.  Since the value of the selected ... */new AccessibleAWTList(...)List.this/** Returns the Accessible child contained at the local coordinate ... */getItemCount(...)/** Return the nth Accessible child of the object. ... */new AccessibleAWTListChild(...)/** Get the AccessibleSelection associated with this object.  In the ... *//** Returns the number of items currently selected. ... */// AccessibleSelection methodsgetSelectedIndexes(...).length/** Returns an Accessible representing the specified selected item ... */getAccessibleSelectionCount(...)/** Returns true if the current child of this object is selected. ... */isIndexSelected(...)/** Adds the specified selected item in the object to the object's ... *//** Removes the specified selected item in the object from the object's ... *//** Clears the selection in the object, so that nothing in the ... */int[] selectedIndexesselectedIndexes.length/** Causes every selected item in the object to be selected ... *//** This class implements accessibility support for ... */List parent;// [[[FIXME]]] need to finish implementing this!!!int indexInParent;this.indexInParent/** Gets the AccessibleContext for this object.  In the ... */// required Accessible methods// required AccessibleContext methodsAccessibleRole.LIST_ITEM/** Get the state set of this object.  The AccessibleStateSet of an ... *//** Gets the locale of the component. If the component does not ... *//** Get the 0-based index of this object in its accessible parent. ... *//** Returns the number of accessible children of the object. ... *//** Return the specified Accessible child of the object.  The ... *//** Get the background color of this object. ... */// AccessibleComponent delegatation to parent List/** Set the background color of this object. ... *//** Get the foreground color of this object. ... *//** Set the foreground color of this object. ... *//** Get the Cursor of this object. ... *//** Set the Cursor of this object. ... *//** Get the Font of this object. ... *//** Set the Font of this object. ... *//** Get the FontMetrics of this object. ... *//** Determine if the object is enabled.  Objects that are enabled ... *//** Determine if the object is visible.  Note: this means that the ... *//** Determine if the object is showing.  This is determined by ... *//** Checks whether the specified point is within this object's ... *//** Gets the location of the object relative to the parent in the ... *//** Sets the bounds of this object in the form of a Rectangle ... *//** Returns the size of this object in the form of a Dimension ... *//** Returns whether this object can accept focus or not.   Objects ... *//** Requests focus for this object.  If this object cannot accept ... *//** Removes the specified focus listener so it no longer receives ... */// Bug #4059614: select can't be synchronized while calling the peer,// because it is called from the Window Thread.  It is sufficient to// synchronize the code that manipulates 'selected' except for the// case where the peer changes.  To handle this case, we simply// repeat the selection process.// fredxFIXME Not implemented yet// list elements can't have children// [[[FIXME]]] needs to work like isShowing() below// return parent.isVisible();// [[[FIXME]]] should scroll to item to make it show!// [[[FIXME]]] only if it's showing!!!// return parent.isShowing();// [[[FIXME]]] - only if p is within the list element!!!// return parent.contains(p);// [[[FIXME]]] sigh// [[[FIXME]]]// [[[FIXME]]] maybe - can simply return as no-op// no-op; not supported// not supported; no-op// object cannot have children!// list element cannot receive focus!// nothing to do; a no-op// inner class AccessibleAWTListChild// inner class AccessibleAWTListimport MultiResolutionToolkitImage/** The <code>MediaTracker</code> class is a utility class to track ... */Component target;/** A given <code>Component</code> that will be ... */MediaEntry head;/** The head of the list of <code>Images</code> that is being ... *//** Creates a media tracker to track images for a given component. ... *//** Adds an image to the list of images being tracked by this media ... */addImage(...)/** Adds a scaled image to the list of images being tracked ... */Image rvImagegetResolutionVariant(...)addImageImpl(...)new ImageMediaEntry(...)int LOADING;/** Flag indicating that media is currently being loaded. ... */int ABORTED;/** Flag indicating that the downloading of media was aborted. ... */int ERRORED;/** Flag indicating that the downloading of media encountered ... */int COMPLETE;/** Flag indicating that the downloading of media was completed ... */int DONE;/** Checks to see if all images being tracked by this media tracker ... */checkAll(...)MediaEntry curcur.next/** Checks the error status of all of the images. ... *//** Returns a list of all media that have encountered an error. ... */int numerrorsObject[] errorsgetMedia(...)/** Starts loading all images tracked by this media tracker. This ... */waitForAll(...)statusAll(...)long timeout/** Calculates and returns the bitwise inclusive <b>OR</b> of the ... *//** Checks to see if all images tracked by this media tracker that ... */checkID(...)/** Checks the error status of all of the images tracked by this ... *//** Returns a list of media with the specified ID that ... *//** Starts loading all images tracked by this media tracker with the ... */waitForID(...)statusID(...)/** Removes the specified image from this media tracker. ... */removeImageImpl(...)MediaEntry prevMediaEntry next/** Removes the specified image from the specified tracking ... *//** Removes the specified image with the specified ... */MediaTracker.LOADINGMediaTracker.ABORTEDMediaTracker.ERROREDMediaTracker.COMPLETEint ID;MediaEntry next;cur.IDme.IDme.nextint LOADSTARTED;startLoad(...)setDone(...)Image image;tracker.targetparseflags(...)// Notify in case remaining images are "done".import MenuPeer/** A <code>Menu</code> object is a pull-down menu component ... */new Vector<MenuComponent>(...)setMenuAccessor(...)AWTAccessor.MenuAccessormenu.itemsVector<MenuComponent> items;/** A vector of the items that will be part of the Menu. ... */boolean tearOff;/** This field indicates whether the menu has the ... */boolean isHelpMenu;/** This field will be set to <code>true</code> ... *//** Constructs a new menu with an empty label. This menu is not ... *//** Constructs a new menu with the specified label. This menu is not ... *//** Constructs a new menu with the specified label, ... */this.tearOff/** Creates the menu's peer.  The peer allows us to modify the ... */createMenu(...)MenuItem mimi.parent/** Removes the menu's peer.  The peer allows us to modify the appearance ... *//** Indicates whether this menu is a tear-off menu. ... *//** Get the number of items in this menu. ... */countItemsImpl(...)/** Gets the item located at the specified index of this menu. ... *//** Adds the specified menu item to this menu. If the ... */MenuPeer peer/** Adds an item with the specified label to this menu. ... */new MenuItem(...)/** Inserts a menu item into this menu ... */Vector<MenuItem> tempItemsnew Vector<MenuItem>(...)/** Inserts a menu item with the specified label into this menu ... *//** Adds a separator line, or a hypen, to the menu at the current position. ... *//** Inserts a separator at the specified position. ... */addSeparator(...)/** Removes the menu item at the specified index from this menu. ... *//** Removes the specified menu item from this menu. ... *//** Removes all items from this menu. ... *//* Post an ActionEvent to the target of the MenuPeer ... */getShortcutMenuItem(...)Vector<MenuShortcut> shortcutsnew Vector<MenuShortcut>(...)Enumeration<MenuShortcut> eshortcuts(...)MenuShortcut msgetShortcut(...)deleteShortcut(...)int menuSerializedDataVersion;/** The menu serialized Data Version. ... *//* Serialization support.  A MenuContainer is responsible for ... *//** Writes default serializable fields to stream. ... */MenuItem itemitem.parent/** Returns a string representing the state of this <code>Menu</code>. ... *//** Gets the AccessibleContext associated with this Menu. ... */new AccessibleAWTMenu(...)/** Defined in MenuComponent. Overridden here. *//** Inner class of Menu used to provide default support for ... */AccessibleRole.MENU/* Remove the item at index, nitems-index times ... *//* Add the removed items back to the menu, they are ... */// HeadlessException will be thrown from MenuComponent's readObject// class AccessibleAWTMenuimport MenuBarPeer/** The <code>MenuBar</code> class encapsulates the platform's ... */new Vector<Menu>(...)setMenuBarAccessor(...)AWTAccessor.MenuBarAccessormenuBar.helpMenumenuBar.menusVector<Menu> menus;/** This field represents a vector of the ... */Menu helpMenu;/** This menu is a special menu dedicated to ... *//** Creates a new menu bar. ... *//** Creates the menu bar's peer.  The peer allows us to change the ... */int nmenusgetMenuCount(...)createMenuBar(...)/** Removes the menu bar's peer.  The peer allows us to change the ... *//** Gets the help menu on the menu bar. ... *//** Sets the specified menu to be this menu bar's help menu. ... */MenuBarPeer peerm.isHelpMenum.peeraddHelpMenu(...)/** Adds the specified menu to the menu bar. ... */addMenu(...)/** Removes the menu located at the specified ... */Menu mdelMenu(...)/** Removes the specified menu component from this menu bar. ... *//** Gets the number of menus on the menu bar. ... */countMenus(...)getMenuCountImpl(...)/** Gets the specified menu. ... */getMenuImpl(...)/** Gets an enumeration of all menu shortcuts this menu bar ... *//** Gets the instance of <code>MenuItem</code> associated ... *//* Post an ACTION_EVENT to the target of the MenuPeer ... */int accelKeygetMenuShortcutKeyMask(...)/** Deletes the specified menu shortcut. ... */int menuBarSerializedDataVersion;/** The MenuBar's serialized data version. ... *//* Serialization support.  Restore the (transient) parent ... *//** Gets the AccessibleContext associated with this MenuBar. ... */new AccessibleAWTMenuBar(...)/** Inner class of MenuBar used to provide default support for ... */AccessibleRole.MENU_BAR// MenuShortcut wasn't found// Is it a key event?// Is the accelerator modifier key pressed?// Pass MenuShortcut on to child menus.// class AccessibleAWTMenuBarimport MenuComponentPeer/** The abstract class <code>MenuComponent</code> is the superclass ... */Component.actionListenerKComponent.itemListenerKsetMenuComponentAccessor(...)AWTAccessor.MenuComponentAccessormenuComp.appContextmenuComp.parentMenuComponentPeer peer;MenuContainer parent;/** The <code>AppContext</code> of the <code>MenuComponent</code>. ... *//** The menu component's font. This value can be ... *//** The menu component's name, which defaults to <code>null</code>. ... *//** A variable to indicate whether a name is explicitly set. ... *//** Defaults to <code>false</code>. ... *//* The menu's AccessControlContext. *//* Returns the acc this menu component was constructed with. *//* Internal constants for serialization. *//** Creates a <code>MenuComponent</code>. ... *//** Constructs a name for this <code>MenuComponent</code>. ... *//** Gets the name of the menu component. ... *//** Returns the parent container for this menu component. ... *//** Gets the font used for this menu component. ... */MenuContainer parentObject parent/** Sets the font to be used for this menu component to the specified ... */// getFont_NoClientCode()MenuComponentPeer peer/** Removes the menu component's peer.  The peer allows us to modify the ... */MenuComponentPeer p/** Posts the specified event to the menu. ... *//** Delivers an event to this component or one of its sub components. ... */(...).newEventsOnly/** Processes events occurring on this menu component. ... *//** Returns a representation of this menu component as a string. ... *//** Reads the menu component from an object input stream. ... *//** Initialize JNI field and method IDs. *//** Inner class of <code>MenuComponent</code> used to provide ... *//** Although the class is abstract, this should be called by ... *//** Gets the <code>AccessibleSelection</code> associated with this ... */MenuComponent.this/** Gets the <code>AccessibleComponent</code> associated with ... *//** Sets the location of the object relative to the parent. *//** Gets the bounds of this object in the form of a ... *//** Resizes this object. ... *//** Returns the number of <code>Accessible</code> children currently selected. ... *//** Returns an <code>Accessible</code> representing the specified ... *//** Determines if the current child of this object is selected. ... *//** Adds the specified <code>Accessible</code> child of the object ... *//** Removes the specified child of the object from the object's ... *//** Clears the selection in the object, so that no children in the ... *//** Causes every child of the object to be selected ... */MenuContainer localParentMenuComponent localParentMenugetAccessibleChildIndex(...)/** Gets the index of the child within this MenuComponent. ... */// For strict compliance with prior platform versions, a MenuComponent// The MenuContainer interface does not have getFont_NoClientCode()// and it cannot, because it must be package-private. Because of// this, we must manually cast classes that implement// MenuContainer.//Fixed 6312943: NullPointerException in method MenuComponent.setFont(Font)// Non-specific -- overridden in subclasses// MenuComponents don't have children// Not supported for MenuComponents// MenuComponents only have accessible index when inside MenuComponents// Overridden in subclasses./** The super class of all menu related containers. ... *//* Copyright (c) 1995, 2004, Oracle and/or its affiliates. All rights reserved. ... */import MenuItemPeer/** All items in a menu must belong to the class ... */setMenuItemAccessor(...)AWTAccessor.MenuItemAccessoritem.enableditem.labelitem.shortcutgetActionCommandImpl(...)isItemEnabled(...)/** A value to indicate whether a menu item is enabled ... *//** <code>label</code> is the label of a menu item. ... *//** This field indicates the command tha has been issued ... *//** The eventMask is ONLY set by subclasses via enableEvents. ... */MenuShortcut shortcut;/** A sequence of key stokes that ia associated with ... *//** Constructs a new MenuItem with an empty label and no keyboard ... *//** Constructs a new MenuItem with the specified label ... *//** Create a menu item with an associated keyboard shortcut. ... */this.shortcut/** Creates the menu item's peer.  The peer allows us to modify the ... */createMenuItem(...)/** Gets the label for this menu item. ... *//** Sets the label for this menu item to the specified label. ... */MenuItemPeer peer/** Checks whether this menu item is enabled. ... *//** Sets whether or not this menu item can be chosen. ... *//** Get the <code>MenuShortcut</code> object associated with this ... *//** Set the <code>MenuShortcut</code> object associated with this ... *//** Delete any <code>MenuShortcut</code> object associated ... *//* Delete a matching MenuShortcut associated with this MenuItem. ... *//* The main goal of this method is to post an appropriate event ... *//* Returns true if the item and all its ancestors are ... */MenuContainer containerMenu menu/* Post an ActionEvent to the target (on ... */MenuShortcut snew MenuShortcut(...)MenuShortcut sEgetExtendedKeyCode(...)doMenuEvent(...)/** Enables event delivery to this menu item for events ... *//** Disables event delivery to this menu item for events ... *//** Sets the command name of the action event that is fired ... *//** Gets the command name of the action event that is fired ... */// This is final so it can be called on the Toolkit thread./** Adds the specified action listener to receive action events ... *//** Removes the specified action listener so it no longer receives ... *//** Processes events on this menu item. If the event is an ... *//** Processes action events occurring on this menu item, ... *//** Returns a string representing the state of this <code>MenuItem</code>. ... */int menuItemSerializedDataVersion;/** Menu item serialized data version. ... *//** Gets the AccessibleContext associated with this MenuItem. ... */new AccessibleAWTMenuItem(...)/** Inner class of MenuItem used to provide default support for ... */AccessibleRole.MENU_ITEMMenuItem.thisgetMostRecentEventTime(...)// Fix For 6185151: Menu shortcuts of all menuitems within a menu// should be disabled when the menu itself is disabled// MenuShortcut match -- issue an event on keydown.// silently eat key release./** The <code>MenuShortcut</code>class represents a keyboard accelerator ... *//** The virtual keycode for the menu shortcut. ... */boolean usesShift;/** Indicates whether the shft key was pressed. ... *//** Constructs a new MenuShortcut for the specified virtual keycode. ... */this.usesShift/** Returns the raw keycode of this MenuShortcut. ... *//** Returns whether this MenuShortcut must be invoked using the SHIFT key. ... *//** Returns whether this MenuShortcut is the same as another: ... */usesShiftModifier(...)/** Returns the hashcode for this MenuShortcut. ... *//** Returns an internationalized description of the MenuShortcut. ... */Event.SHIFT_MASK/* Copyright (c) 1996, 2009, Oracle and/or its affiliates. All rights reserved. ... */Dialog modalDialog;boolean disabled;this.modalDialogacceptWindow(...)// with a new event pump and a new filter// the modalDialog is not enough, as it can be hidden and then shown again// as disabled to prevent it from working. Simple checking for visibility of// EventDispatchThread event filters immediately, so we need to mark the filter// When a modal dialog is hidden its modal filter may not be deleted fromDialog anotherDialoggetModalDialog(...)new DocumentModalEventFilter(...)new ApplicationModalEventFilter(...)new ToolkitModalEventFilter(...)modalDialog.appContextDialog.ModalExclusionType.TOOLKIT_EXCLUDEDialog.ModalExclusionTypeFilterAction.ACCEPT_IMMEDIATELYDialog.ModalExclusionType.APPLICATION_EXCLUDEWindow documentRoot;Window w1// check if modalDialog is from anotherDialog's hierarchy//   or vice versa// check if one dialog blocks (directly or indirectly) another// compare modality types// application- and toolkit-excluded windows are blocked by// document-modal dialogs from their child hierarchy/** <code>MouseInfo</code>  provides methods for getting information about the mouse, ... *//** Private constructor to prevent instantiation. *//** Returns a <code>PointerInfo</code> instance that represents the current ... */Point pointint deviceNumfillPointWithCoords(...)GraphicsDevice[] gdsPointerInfo retvalSecurityConstants.AWT.WATCH_MOUSE_PERMISSIONareScreenDevicesIndependent(...)new PointerInfo(...)gds.length/** Returns the number of buttons on the mouse. ... */// This should never happen./** This is the superclass for Paints which use a multiple color ... *//** The method to use when painting outside the gradient bounds. ... */new CycleMethod(...)CycleMethod NO_CYCLE;/** Use the terminal colors to fill the remaining area. */CycleMethod REFLECT;/** Cycle the gradient colors start-to-end, end-to-start ... */CycleMethod REPEAT;/** Cycle the gradient colors start-to-end, start-to-end ... *//** The color space in which to perform the gradient interpolation. ... */new ColorSpaceType(...)ColorSpaceType SRGB;/** Indicates that the color interpolation should occur in sRGB space. */ColorSpaceType LINEAR_RGB;/** Indicates that the color interpolation should occur in linearized ... *//** The transparency of this paint object. */...[] fractions;/** Gradient keyframe values in the range 0 to 1. *//** Gradient colors. */AffineTransform gradientTransform;/** Transform to apply to gradient. */CycleMethod cycleMethod;/** The method to use when painting outside the gradient bounds. */ColorSpaceType colorSpace;/** The color space in which to perform the gradient interpolation. *//** The following fields are used only by MultipleGradientPaintContext ... */...[] normalizedIntervals;boolean isSimpleLookup;SoftReference<int[][]> gradients;SoftReference<int[]> gradient;int fastGradientArraySize;/** Package-private constructor. ... */float previousFractionboolean fixFirstboolean fixLastboolean opaquefloat currentFractionthis.fractionsthis.colorsthis.colorSpacethis.cycleMethodthis.gradientTransform/** Returns a copy of the array of floats used by this gradient ... *//** Returns a copy of the array of colors used by this gradient. ... *//** Returns the enumerated type which specifies cycling behavior. ... *//** Returns the enumerated type which specifies color space for ... *//** Returns a copy of the transform applied to the gradient. ... *//** Returns the transparency mode for this {@code Paint} object. ... *//* Copyright (c) 2006, 2011, Oracle and/or its affiliates. All rights reserved. ... */// check that values are in the proper range and progress// in increasing order from 0 to 1// We have to deal with the cases where the first gradient stop is not// equal to 0 and/or the last gradient stop is not equal to 1.// In both cases, create a new point and replicate the previous// extreme point's color.// first stop is not equal to zero, fix this condition// last stop is not equal to one, fix this condition// copy some flags// copy the gradient transform// determine transparency/** This is the superclass for all PaintContexts which use a multiple color ... */convertSRGBtoLinearRGB(...)convertLinearRGBtoSRGB(...)/** The PaintContext's ColorModel.  This is ARGB if colors are not all ... *//** Color model used if gradient colors are all opaque. *//** The cached ColorModel. *//** The cached raster, which is reusable among instances. *//** Raster is reused whenever possible. *//** The method to use when painting out of the gradient bounds. *//** The ColorSpace in which to perform the interpolation */float a00, ...;/** Elements of the inverse transform matrix. *//** This boolean specifies whether we are in simple lookup mode, where an ... *//** Size of gradients array for scaling the 0-1 index when looking up ... */...[] gradient;/** Array which contains the interpolated color values for each interval, ... */...[] gradients;/** Array of gradient arrays, one array for each interval.  Used by ... *//** Normalized intervals array. *//** Fractions array. */int transparencyTest;/** Used to determine if gradient colors are all opaque. */...[] SRGBtoLinearRGB;/** Color space conversion lookup tables. */...[] LinearRGBtoSRGB;int GRADIENT_SIZE;/** Constant number of max colors between any 2 arbitrary colors. ... */int GRADIENT_SIZE_INDEX;int MAX_GRADIENT_ARRAY_SIZE;/** Maximum length of the fast single-array.  If the estimated array size ... *//** Constructor for MultipleGradientPaintContext superclass. */AffineTransform tInvdouble[] mint[] gradientmgp.gradientint[][] gradientsmgp.gradientsinvert(...)calculateLookupData(...)mgp.modelthis.modelmgp.normalizedIntervalsthis.normalizedIntervalsmgp.isSimpleLookupthis.isSimpleLookupmgp.fastGradientArraySizethis.fastGradientArraySizenew SoftReference<int[]>(...)this.gradientnew SoftReference<int[][]>(...)this.gradients/** This function is the meat of this class.  It calculates an array of ... */Color[] normalizedColorsfloat Iminint estimatedSizeColorSpaceType.LINEAR_RGBnormalizedIntervals.lengthcalculateMultipleArrayGradient(...)calculateSingleArrayGradient(...)/** FAST LOOKUP METHOD ... */int gradientsTotint curOffsetgradients.lengthint nGradientsgradient.lengthconvertEntireColorLinearRGBtoSRGB(...)/** SLOW LOOKUP METHOD ... *//** Yet another helper function.  This one linearly interpolates between ... */float stepSize/** Yet another helper function.  This one extracts the color components ... *//** Helper function to index into the gradients array.  This is necessary ... */int part/** Helper function to convert a color component in sRGB space to linear ... */float output/** Helper function to convert a color component in linear RGB space to ... */DataBufferInt rasterDBfillRaster(...)/** Took this cacheRaster code from GradientPaint. It appears to recycle ... */// build the tables// The inverse transform is needed to go from device to user space.// Get all the components of the inverse transform matrix.// the following assumes that the caller has copied the incoming// transform and is not concerned about it being modified// just use identity transform in this case; better to show// (incorrect) results than to throw an exception and/or no-op// we can avoid copying this array since we do not modify its values// note that only one of these values can ever be non-null (we either// store the fast gradient array or the slow one, but never both// at the same time)// we need to (re)create the appropriate values// now cache the calculated values in the// MultipleGradientPaint instance for future use// only cache the fast array// only cache the slow array// use the values cached in the MultipleGradientPaint instance// create a new colors array// convert the colors using the lookup table// we can just use this array by reference since we do not// modify its values in the case of SRGB// this will store the intervals (distances) between gradient stops// convert from fractions into intervals// interval distance is equal to the difference in positions// initialize to be fully opaque for ANDing with colors// array of interpolation arrays// find smallest interval// Estimate the size of the entire gradients array.// This is to prevent a tiny interval from causing the size of array// to explode.  If the estimated size is too large, break to using// separate arrays for each interval, and using an indexing scheme at// look-up time.// slow method// fast method// use the most "economical" model// set the flag so we know later it is a simple (fast) lookup// 2 colors to interpolate//the eventual size of the single array// for every interval (transition between 2 colors)// create an array whose size is based on the ratio to the// smallest interval// the 2 colors (keyframes) to interpolate between// fill this array with the colors in between rgb1 and rgb2// if the colors are opaque, transparency should still// be 0xff000000// put all gradients in a single array// if interpolation occurred in Linear RGB space, convert the// gradients back to sRGB using the lookup table// set the flag so we know later it is a non-simple lookup// create an array of the maximum theoretical size for// each interval// get the the 2 colors// gradients back to SRGB using the lookup table// color components// step between interpolated values// extract color components from packed integer// calculate the total change in alpha, red, green, blue// for each step in the interval calculate the in-between color by// multiplying the normalized current position by the total color// change (0.5 is added to prevent truncation round-off error)// extract red, green, blue components// use the lookup table// re-compact the components// first, manipulate position value depending on the cycle method// upper bound is 1// lower bound is 0// get the fractional part// (modulo behavior discards integer component)//position should now be between -1 and 1// force it to be in the range 0-1// cycleMethod == CycleMethod.REFLECT// take absolute value// get the integer part// integer part is odd, get reflected color instead// now, get the color based on this 0-1 position...// easy to compute: just scale index by array size// more complicated computation, to save space// for all the gradient interval arrays// this is the array we want// this is the interval we want// If working raster is big enough, reuse it. Otherwise,// build a large enough new one.// Access raster internal int array. Because we use a DirectColorModel,// we know the DataBuffer is of type DataBufferInt and the SampleModel// is SinglePixelPackedSampleModel.// Adjust for initial offset in DataBuffer and also for the scanline// stride.// These calls make the DataBuffer non-acceleratable, but the// Raster is never Stable long enough to accelerate anyway...// delegate to subclass/** A set of attributes which control the output of a printed page. ... *//** A type-safe enumeration of possible color states. ... */new ColorType(...)int I_COLOR;int I_MONOCHROME;ColorType COLOR;/** The ColorType instance to use for specifying color printing. */ColorType MONOCHROME;/** The ColorType instance to use for specifying monochrome printing. *//** A type-safe enumeration of possible paper sizes. These sizes are in ... */new MediaType(...)int I_ISO_4A0;int I_ISO_2A0;int I_ISO_A0;int I_ISO_A1;int I_ISO_A2;int I_ISO_A3;int I_ISO_A4;int I_ISO_A5;int I_ISO_A6;int I_ISO_A7;int I_ISO_A8;int I_ISO_A9;int I_ISO_A10;int I_ISO_B0;int I_ISO_B1;int I_ISO_B2;int I_ISO_B3;int I_ISO_B4;int I_ISO_B5;int I_ISO_B6;int I_ISO_B7;int I_ISO_B8;int I_ISO_B9;int I_ISO_B10;int I_JIS_B0;int I_JIS_B1;int I_JIS_B2;int I_JIS_B3;int I_JIS_B4;int I_JIS_B5;int I_JIS_B6;int I_JIS_B7;int I_JIS_B8;int I_JIS_B9;int I_JIS_B10;int I_ISO_C0;int I_ISO_C1;int I_ISO_C2;int I_ISO_C3;int I_ISO_C4;int I_ISO_C5;int I_ISO_C6;int I_ISO_C7;int I_ISO_C8;int I_ISO_C9;int I_ISO_C10;int I_ISO_DESIGNATED_LONG;int I_EXECUTIVE;int I_FOLIO;int I_INVOICE;int I_LEDGER;int I_NA_LETTER;int I_NA_LEGAL;int I_QUARTO;int I_A;int I_B;int I_C;int I_D;int I_E;int I_NA_10X15_ENVELOPE;int I_NA_10X14_ENVELOPE;int I_NA_10X13_ENVELOPE;int I_NA_9X12_ENVELOPE;int I_NA_9X11_ENVELOPE;int I_NA_7X9_ENVELOPE;int I_NA_6X9_ENVELOPE;int I_NA_NUMBER_9_ENVELOPE;int I_NA_NUMBER_10_ENVELOPE;int I_NA_NUMBER_11_ENVELOPE;int I_NA_NUMBER_12_ENVELOPE;int I_NA_NUMBER_14_ENVELOPE;int I_INVITE_ENVELOPE;int I_ITALY_ENVELOPE;int I_MONARCH_ENVELOPE;int I_PERSONAL_ENVELOPE;MediaType ISO_4A0;/** The MediaType instance for ISO/DIN and JIS 4A0, 1682 x 2378 mm. */MediaType ISO_2A0;/** The MediaType instance for ISO/DIN and JIS 2A0, 1189 x 1682 mm. */MediaType ISO_A0;/** The MediaType instance for ISO/DIN and JIS A0, 841 x 1189 mm. */MediaType ISO_A1;/** The MediaType instance for ISO/DIN and JIS A1, 594 x 841 mm. */MediaType ISO_A2;/** The MediaType instance for ISO/DIN and JIS A2, 420 x 594 mm. */MediaType ISO_A3;/** The MediaType instance for ISO/DIN and JIS A3, 297 x 420 mm. */MediaType ISO_A4;/** The MediaType instance for ISO/DIN and JIS A4, 210 x 297 mm. */MediaType ISO_A5;/** The MediaType instance for ISO/DIN and JIS A5, 148 x 210 mm. */MediaType ISO_A6;/** The MediaType instance for ISO/DIN and JIS A6, 105 x 148 mm. */MediaType ISO_A7;/** The MediaType instance for ISO/DIN and JIS A7, 74 x 105 mm. */MediaType ISO_A8;/** The MediaType instance for ISO/DIN and JIS A8, 52 x 74 mm. */MediaType ISO_A9;/** The MediaType instance for ISO/DIN and JIS A9, 37 x 52 mm. */MediaType ISO_A10;/** The MediaType instance for ISO/DIN and JIS A10, 26 x 37 mm. */MediaType ISO_B0;/** The MediaType instance for ISO/DIN B0, 1000 x 1414 mm. */MediaType ISO_B1;/** The MediaType instance for ISO/DIN B1, 707 x 1000 mm. */MediaType ISO_B2;/** The MediaType instance for ISO/DIN B2, 500 x 707 mm. */MediaType ISO_B3;/** The MediaType instance for ISO/DIN B3, 353 x 500 mm. */MediaType ISO_B4;/** The MediaType instance for ISO/DIN B4, 250 x 353 mm. */MediaType ISO_B5;/** The MediaType instance for ISO/DIN B5, 176 x 250 mm. */MediaType ISO_B6;/** The MediaType instance for ISO/DIN B6, 125 x 176 mm. */MediaType ISO_B7;/** The MediaType instance for ISO/DIN B7, 88 x 125 mm. */MediaType ISO_B8;/** The MediaType instance for ISO/DIN B8, 62 x 88 mm. */MediaType ISO_B9;/** The MediaType instance for ISO/DIN B9, 44 x 62 mm. */MediaType ISO_B10;/** The MediaType instance for ISO/DIN B10, 31 x 44 mm. */MediaType JIS_B0;/** The MediaType instance for JIS B0, 1030 x 1456 mm. */MediaType JIS_B1;/** The MediaType instance for JIS B1, 728 x 1030 mm. */MediaType JIS_B2;/** The MediaType instance for JIS B2, 515 x 728 mm. */MediaType JIS_B3;/** The MediaType instance for JIS B3, 364 x 515 mm. */MediaType JIS_B4;/** The MediaType instance for JIS B4, 257 x 364 mm. */MediaType JIS_B5;/** The MediaType instance for JIS B5, 182 x 257 mm. */MediaType JIS_B6;/** The MediaType instance for JIS B6, 128 x 182 mm. */MediaType JIS_B7;/** The MediaType instance for JIS B7, 91 x 128 mm. */MediaType JIS_B8;/** The MediaType instance for JIS B8, 64 x 91 mm. */MediaType JIS_B9;/** The MediaType instance for JIS B9, 45 x 64 mm. */MediaType JIS_B10;/** The MediaType instance for JIS B10, 32 x 45 mm. */MediaType ISO_C0;/** The MediaType instance for ISO/DIN C0, 917 x 1297 mm. */MediaType ISO_C1;/** The MediaType instance for ISO/DIN C1, 648 x 917 mm. */MediaType ISO_C2;/** The MediaType instance for ISO/DIN C2, 458 x 648 mm. */MediaType ISO_C3;/** The MediaType instance for ISO/DIN C3, 324 x 458 mm. */MediaType ISO_C4;/** The MediaType instance for ISO/DIN C4, 229 x 324 mm. */MediaType ISO_C5;/** The MediaType instance for ISO/DIN C5, 162 x 229 mm. */MediaType ISO_C6;/** The MediaType instance for ISO/DIN C6, 114 x 162 mm. */MediaType ISO_C7;/** The MediaType instance for ISO/DIN C7, 81 x 114 mm. */MediaType ISO_C8;/** The MediaType instance for ISO/DIN C8, 57 x 81 mm. */MediaType ISO_C9;/** The MediaType instance for ISO/DIN C9, 40 x 57 mm. */MediaType ISO_C10;/** The MediaType instance for ISO/DIN C10, 28 x 40 mm. */MediaType ISO_DESIGNATED_LONG;/** The MediaType instance for ISO Designated Long, 110 x 220 mm. */MediaType EXECUTIVE;/** The MediaType instance for Executive, 7 1/4 x 10 1/2 in. */MediaType FOLIO;/** The MediaType instance for Folio, 8 1/2 x 13 in. */MediaType INVOICE;/** The MediaType instance for Invoice, 5 1/2 x 8 1/2 in. */MediaType LEDGER;/** The MediaType instance for Ledger, 11 x 17 in. */MediaType NA_LETTER;/** The MediaType instance for North American Letter, 8 1/2 x 11 in. */MediaType NA_LEGAL;/** The MediaType instance for North American Legal, 8 1/2 x 14 in. */MediaType QUARTO;/** The MediaType instance for Quarto, 215 x 275 mm. */MediaType A;/** The MediaType instance for Engineering A, 8 1/2 x 11 in. */MediaType B;/** The MediaType instance for Engineering B, 11 x 17 in. */MediaType C;/** The MediaType instance for Engineering C, 17 x 22 in. */MediaType D;/** The MediaType instance for Engineering D, 22 x 34 in. */MediaType E;/** The MediaType instance for Engineering E, 34 x 44 in. */MediaType NA_10X15_ENVELOPE;/** The MediaType instance for North American 10 x 15 in. */MediaType NA_10X14_ENVELOPE;/** The MediaType instance for North American 10 x 14 in. */MediaType NA_10X13_ENVELOPE;/** The MediaType instance for North American 10 x 13 in. */MediaType NA_9X12_ENVELOPE;/** The MediaType instance for North American 9 x 12 in. */MediaType NA_9X11_ENVELOPE;/** The MediaType instance for North American 9 x 11 in. */MediaType NA_7X9_ENVELOPE;/** The MediaType instance for North American 7 x 9 in. */MediaType NA_6X9_ENVELOPE;/** The MediaType instance for North American 6 x 9 in. */MediaType NA_NUMBER_9_ENVELOPE;/** The MediaType instance for North American #9 Business Envelope, ... */MediaType NA_NUMBER_10_ENVELOPE;/** The MediaType instance for North American #10 Business Envelope, ... */MediaType NA_NUMBER_11_ENVELOPE;/** The MediaType instance for North American #11 Business Envelope, ... */MediaType NA_NUMBER_12_ENVELOPE;/** The MediaType instance for North American #12 Business Envelope, ... */MediaType NA_NUMBER_14_ENVELOPE;/** The MediaType instance for North American #14 Business Envelope, ... */MediaType INVITE_ENVELOPE;/** The MediaType instance for Invitation Envelope, 220 x 220 mm. */MediaType ITALY_ENVELOPE;/** The MediaType instance for Italy Envelope, 110 x 230 mm. */MediaType MONARCH_ENVELOPE;/** The MediaType instance for Monarch Envelope, 3 7/8 x 7 1/2 in. */MediaType PERSONAL_ENVELOPE;/** The MediaType instance for 6 3/4 envelope, 3 5/8 x 6 1/2 in. */MediaType A0;/** An alias for ISO_A0. */MediaType A1;/** An alias for ISO_A1. */MediaType A2;/** An alias for ISO_A2. */MediaType A3;/** An alias for ISO_A3. */MediaType A4;/** An alias for ISO_A4. */MediaType A5;/** An alias for ISO_A5. */MediaType A6;/** An alias for ISO_A6. */MediaType A7;/** An alias for ISO_A7. */MediaType A8;/** An alias for ISO_A8. */MediaType A9;/** An alias for ISO_A9. */MediaType A10;/** An alias for ISO_A10. */MediaType B0;/** An alias for ISO_B0. */MediaType B1;/** An alias for ISO_B1. */MediaType B2;/** An alias for ISO_B2. */MediaType B3;/** An alias for ISO_B3. */MediaType B4;/** An alias for ISO_B4. */MediaType ISO_B4_ENVELOPE;MediaType B5;/** An alias for ISO_B5. */MediaType ISO_B5_ENVELOPE;MediaType B6;/** An alias for ISO_B6. */MediaType B7;/** An alias for ISO_B7. */MediaType B8;/** An alias for ISO_B8. */MediaType B9;/** An alias for ISO_B9. */MediaType B10;/** An alias for ISO_B10. */MediaType C0;/** An alias for ISO_C0. */MediaType ISO_C0_ENVELOPE;MediaType C1;/** An alias for ISO_C1. */MediaType ISO_C1_ENVELOPE;MediaType C2;/** An alias for ISO_C2. */MediaType ISO_C2_ENVELOPE;MediaType C3;/** An alias for ISO_C3. */MediaType ISO_C3_ENVELOPE;MediaType C4;/** An alias for ISO_C4. */MediaType ISO_C4_ENVELOPE;MediaType C5;/** An alias for ISO_C5. */MediaType ISO_C5_ENVELOPE;MediaType C6;/** An alias for ISO_C6. */MediaType ISO_C6_ENVELOPE;MediaType C7;/** An alias for ISO_C7. */MediaType ISO_C7_ENVELOPE;MediaType C8;/** An alias for ISO_C8. */MediaType ISO_C8_ENVELOPE;MediaType C9;/** An alias for ISO_C9. */MediaType ISO_C9_ENVELOPE;MediaType C10;/** An alias for ISO_C10. */MediaType ISO_C10_ENVELOPE;MediaType ISO_DESIGNATED_LONG_ENVELOPE;/** An alias for ISO_DESIGNATED_LONG. */MediaType STATEMENT;/** An alias for INVOICE. */MediaType TABLOID;/** An alias for LEDGER. */MediaType LETTER;/** An alias for NA_LETTER. */MediaType NOTE;MediaType LEGAL;/** An alias for NA_LEGAL. */MediaType ENV_10X15;/** An alias for NA_10X15_ENVELOPE. */MediaType ENV_10X14;/** An alias for NA_10X14_ENVELOPE. */MediaType ENV_10X13;/** An alias for NA_10X13_ENVELOPE. */MediaType ENV_9X12;/** An alias for NA_9X12_ENVELOPE. */MediaType ENV_9X11;/** An alias for NA_9X11_ENVELOPE. */MediaType ENV_7X9;/** An alias for NA_7X9_ENVELOPE. */MediaType ENV_6X9;/** An alias for NA_6X9_ENVELOPE. */MediaType ENV_9;/** An alias for NA_NUMBER_9_ENVELOPE. */MediaType ENV_10;/** An alias for NA_NUMBER_10_ENVELOPE. */MediaType ENV_11;/** An alias for NA_NUMBER_11_ENVELOPE. */MediaType ENV_12;/** An alias for NA_NUMBER_12_ENVELOPE. */MediaType ENV_14;/** An alias for NA_NUMBER_14_ENVELOPE. */MediaType ENV_INVITE;/** An alias for INVITE_ENVELOPE. */MediaType ENV_ITALY;/** An alias for ITALY_ENVELOPE. */MediaType ENV_MONARCH;/** An alias for MONARCH_ENVELOPE. */MediaType ENV_PERSONAL;/** An alias for PERSONAL_ENVELOPE. */MediaType INVITE;MediaType ITALY;MediaType MONARCH;MediaType PERSONAL;/** A type-safe enumeration of possible orientations. These orientations ... */new OrientationRequestedType(...)int I_PORTRAIT;int I_LANDSCAPE;OrientationRequestedType PORTRAIT;/** The OrientationRequestedType instance to use for specifying a ... */OrientationRequestedType LANDSCAPE;/** A type-safe enumeration of possible origins. ... */new OriginType(...)int I_PHYSICAL;int I_PRINTABLE;OriginType PHYSICAL;/** The OriginType instance to use for specifying a physical origin. */OriginType PRINTABLE;/** The OriginType instance to use for specifying a printable origin. *//** A type-safe enumeration of possible print qualities. These print ... */new PrintQualityType(...)int I_HIGH;int I_NORMAL;int I_DRAFT;PrintQualityType HIGH;/** The PrintQualityType instance to use for specifying a high print ... */PrintQualityType NORMAL;/** The PrintQualityType instance to use for specifying a normal print ... */PrintQualityType DRAFT;/** The PrintQualityType instance to use for specifying a draft print ... */ColorType color;MediaType media;OrientationRequestedType orientationRequested;OriginType origin;PrintQualityType printQuality;...[] printerResolution;/** Constructs a PageAttributes instance with default values for every ... */ColorType.MONOCHROMEsetMediaToDefault(...)setOrientationRequestedToDefault(...)setOrigin(...)OriginType.PHYSICALsetPrintQualityToDefault(...)setPrinterResolutionToDefault(...)/** Constructs a PageAttributes instance which is a copy of the supplied ... *//** Constructs a PageAttributes instance with the specified values for ... */setMedia(...)setOrientationRequested(...)setPrintQuality(...)setPrinterResolution(...)/** Creates and returns a copy of this PageAttributes. ... *//** Sets all of the attributes of this PageAttributes to the same values as ... */obj.colorobj.mediaobj.orientationRequestedobj.originobj.printQualityobj.printerResolution/** Returns whether pages using these attributes will be rendered in ... *//** Specifies whether pages using these attributes will be rendered in ... *//** Returns the paper size for pages using these attributes. This ... *//** Specifies the desired paper size for pages using these attributes. The ... */this.media/** Sets the paper size for pages using these attributes to the default ... */String defaultCountrygetCountry(...)Locale.CANADAMediaType.NA_LETTERMediaType.ISO_A4/** Returns the print orientation for pages using these attributes. This ... *//** Specifies the print orientation for pages using these attributes. Not ... */this.orientationRequested/** Specifies the print orientation for pages using these attributes. ... */OrientationRequestedType.PORTRAITOrientationRequestedType.LANDSCAPE/** Sets the print orientation for pages using these attributes to the ... *//** Returns whether drawing at (0, 0) to pages using these attributes ... *//** Specifies whether drawing at (0, 0) to pages using these attributes ... *//** Returns the print quality for pages using these attributes. This ... *//** Specifies the print quality for pages using these attributes. Not ... */this.printQuality/** Specifies the print quality for pages using these attributes. ... */PrintQualityType.DRAFTPrintQualityType.NORMAL/** Sets the print quality for pages using these attributes to the default. ... *//** Returns the print resolution for pages using these attributes. ... */int[] copy/** Specifies the desired print resolution for pages using these attributes. ... */printerResolution.lengththis.printerResolution/** Specifies the desired cross feed and feed print resolutions in dots per ... *//** Sets the printer resolution for pages using these attributes to the ... *//** Determines whether two PageAttributes are equal to each other. ... */PageAttributes rhsrhs.colorrhs.mediarhs.orientationRequestedrhs.originrhs.printQualityrhs.printerResolution/** Returns a hash code value for this PageAttributes. ... *//** Returns a string representation of this PageAttributes. ... */getPrintQuality(...)getOrientationRequested(...)// okay because we never modify the contents of printerResolution// This will throw an IllegalArgumentException// the checks made in setPrinterResolution by modifying the// returned array.// modifying it after calling setPrinterResolution.// int[] printerResolution = getPrinterResolution();/** This <code>Paint</code> interface defines how color patterns ... *//** The <code>PaintContext</code> interface defines the encapsulated ... *//** Releases the resources allocated for the operation. *//** Returns the <code>ColorModel</code> of the output.  Note that ... *//** Returns a <code>Raster</code> containing the colors generated for ... *//** <code>Panel</code> is the simplest container class. A panel ... *//** Creates a new panel using the default layout manager. ... *//** Creates a new panel with the specified layout manager. ... *//** Creates the Panel's peer.  The peer allows you to modify the ... */createPanel(...)/** Gets the AccessibleContext associated with this Panel. ... */new AccessibleAWTPanel(...)AccessibleRole.PANEL/* Copyright (c) 1995, 2007, Oracle and/or its affiliates. All rights reserved. ... *//** A point representing a location in {@code (x,y)} coordinate space, ... *//** The X coordinate of this <code>Point</code>. ... *//** The Y coordinate of this <code>Point</code>. ... *//** Constructs and initializes a point at the origin ... *//** Constructs and initializes a point with the same location as ... *//** Constructs and initializes a point at the specified ... *//** Returns the location of this point. ... *//** Sets the location of the point to the specified location. ... *//** Changes the point to have the specified location. ... *//** Sets the location of this point to the specified double coordinates. ... *//** Moves this point to the specified location in the ... *//** Translates this point, at location {@code (x,y)}, ... *//** Determines whether or not two points are equal. Two instances of ... *//** Returns a string representation of this point and its location ... *//** A class that describes the pointer position. ... */GraphicsDevice device;Point location;/** Package-private constructor to prevent instantiation. *//** Returns the {@code GraphicsDevice} where the mouse pointer was at the ... *//** Returns the {@code Point} that represents the coordinates of the pointer ... */import PathIteratorimport Crossings/** The <code>Polygon</code> class encapsulates a description of a ... */int npoints;/** The total number of points.  The value of <code>npoints</code> ... */...[] xpoints;/** The array of X coordinates.  The number of elements in ... */...[] ypoints;/** The array of Y coordinates.  The number of elements in ... */Rectangle bounds;/** The bounds of this {@code Polygon}. ... */int MIN_LENGTH;/* Default length for xpoints and ypoints. *//** Creates an empty polygon. ... *//** Constructs and initializes a <code>Polygon</code> from the specified ... */xpoints.lengthypoints.lengthnew NegativeArraySizeException(...)this.npointsthis.xpointsthis.ypoints/** Resets this <code>Polygon</code> object to an empty polygon. ... *//** Invalidates or flushes any internally-cached data that depends ... *//** Translates the vertices of the <code>Polygon</code> by ... *//* Calculates the bounding box of the points passed to the constructor. ... */int boundsMinXint boundsMinYint boundsMaxXint boundsMaxY/* Resizes the bounding box to accommodate the specified coordinates. ... *//** Appends the specified coordinates to this <code>Polygon</code>. ... */int newLengthhighestOneBit(...)updateBounds(...)/** Gets the bounding box of this <code>Polygon</code>. ... */getBoundingBox(...)/** Returns the bounds of this <code>Polygon</code>. ... */calculateBounds(...)/** Determines whether the specified {@link Point} is inside this ... *//** Determines whether the specified coordinates are inside this ... *//** Determines whether the specified coordinates are contained in this ... */int hitsint lastxint lastyint curxint curyint leftxdouble test1double test2Crossings crossnew EvenOdd(...)Crossings.EvenOddaccumulateLine(...)getCrossings(...)covers(...)/** Returns an iterator object that iterates along the boundary of this ... */new PolygonPathIterator(...)/** Returns an iterator object that iterates along the boundary of ... */getPathIterator(...)Polygon poly;AffineTransform transform;pg.npoints/** Returns the winding rule for determining the interior of the ... *//** Tests if there are more points to read. ... */poly.npoints/** Moves the iterator forwards, along the primary direction of ... *//** Returns the coordinates and type of the current path segment in ... */poly.xpointspoly.ypoints// Fix 4489009: should throw IndexOutofBoundsException instead// of OutofMemoryException if npoints is huge and > {x,y}points.length// Fix 6191114: should throw NegativeArraySizeException with// negative npoints// Fix 6343431: Applet compatibility problems if arrays are not// exactly npoints in length// bounds.x = bounds.x;// bounds.y = bounds.y;// Make sure that newLength will be greater than MIN_LENGTH and// aligned to the power of 2// Walk the edges of the polygon// Prevent a spurious SEG_CLOSE segmentimport PopupMenuPeer/** A class that implements a menu which can be dynamically popped up ... */setPopupMenuAccessor(...)AWTAccessor.PopupMenuAccessorpopupMenu.isTrayIconPopupboolean isTrayIconPopup;/** Creates a new popup menu with an empty name. ... *//** Creates a new popup menu with the specified name. ... *//** Creates the popup menu's peer. ... */createPopupMenu(...)/** Shows the popup menu at the x, y position relative to an origin ... */Component compParentnew AccessibleAWTPopupMenu(...)/** Inner class of PopupMenu used to provide default support for ... */AccessibleRole.POPUP_MENU// If our parent is not a Component, then this PopupMenu is// really just a plain, old Menu.// Use localParent for thread safety.//Fixed 6278745: Incorrect exception throwing in PopupMenu.show() method//Exception was not thrown if compParent was not equal to origin and//was not Container// class AccessibleAWTPopupMenu/** An abstract class which provides a print graphics context for a page. ... *//** Returns the PrintJob object from which this PrintGraphics ... *//** An abstract class which initiates and executes a print job. ... *//** Gets a Graphics object that will draw to the next page. ... *//** Returns the dimensions of the page in pixels. ... *//** Returns the resolution of the page in pixels per inch. ... *//** Returns true if the last page will be printed first. *//** Ends the print job and does any necessary cleanup. *//** Ends this print job once it is no longer referenced. ... *//* Copyright (c) 1996, Oracle and/or its affiliates. All rights reserved. ... *//** The {@code RadialGradientPaint} class provides a way to fill a shape with ... */Point2D focus;/** Focus point which defines the 0% gradient stop X coordinate. */Point2D center;/** Center of the circle defining the 100% gradient stop X coordinate. */float radius;/** Radius of the outermost circle defining the 100% gradient stop. *//** Constructs a {@code RadialGradientPaint} with a default ... *//** Constructs a {@code RadialGradientPaint}. ... */this.centerthis.radiusgetCenterX(...)getCenterY(...)createGradientTransform(...)double cyAffineTransform xformnew RadialGradientPaintContext(...)/** Returns a copy of the center point of the radial gradient. ... *//** Returns a copy of the focus point of the radial gradient. ... *//** Returns the radius of the circle defining the radial gradient. ... */// check input arguments// copy parameters// gradient center/focal point is the center of the bounding box,// radius is set to 1.0, and then we set a scale transform// to achieve an elliptical gradient defined by the bounding box/** Provides the actual implementation for the RadialGradientPaint. ... */sqrtLut.lengthboolean isSimpleFocus;/** True when (focus == center). */boolean isNonCyclic;/** True when (cycleMethod == NO_CYCLE). */float centerX, ...;/** Variables representing center and focus points. */float radiusSq;/** Radius of the gradient circle squared. */float constA, ...;/** Constant part of X, Y user space coordinates. */float gDeltaDelta;/** Constant second order delta for simple loop. */float trivial;/** This value represents the solution when focusX == X.  It is called ... */float SCALEBACK;/** Amount for offset when clamping focus. *//** Constructor for RadialGradientPaintContext. ... */float dXfloat dYdouble distSqthis.isSimpleFocusthis.isNonCyclicfloat scalefactorsimpleNonCyclicFillRaster(...)cyclicCircularGradientFillRaster(...)/** This code works in the simplest of cases, where the focus == center ... */float rowXfloat rowYfloat gDeltaDeltathis.gDeltaDeltaint rgbclipfloat gRelfloat gDeltaint gIndexfloat fIndexint iIndexfloat s0float s1int SQRT_LUT_SIZE;// SQRT_LUT_SIZE must be a power of 2 for the test above to work....[] sqrtLut;/** Fill the raster, cycling the gradient colors when a point falls outside ... */double constCdouble Adouble Bdouble Cdouble slopedouble yintcptdouble solutionXdouble solutionYfloat precalc2float precalc3float detfloat currentToFocusSqfloat intersectToFocusSqfloat deltaXSqfloat deltaYSqint indexerint pixIncfloat Xfloat Y// copy some parameters// for use in the quadractic equation// test if distance from focus to center is greater than the radius// clamp focus to radius// calculate the solution to be used in the case where X == focusX// in cyclicCircularGradientFillRaster()// constant parts of X, Y user space coordinates// constant second order delta for simple loop/* We calculate sqrt(X^2 + Y^2) relative to the radius ... */// coordinates of UL corner in "user space" relative to center// second order delta calculated in constructor// adjust is (scan-w) of pixels array, we need (scan)// rgb of the 1.0 color used when the distance exceeds gradient radius// these values depend on the coordinates of the start of the row/* Use optimized loops for any cases where gRel >= 1. ... */// Quick fill for "out to the left"// Slow fill for "in the heart"// store the color at this point// incremental calculation// Quick fill to end of line for "out to the right"// constant part of the C factor of the quadratic equation// coefficients of the quadratic equation (Ax^2 + Bx + C = 0)// slope and y-intercept of the focus-perimeter line// intersection with circle X,Y coordinate// constant parts of X, Y coordinates// constants in inner loop quadratic formula// value between 0 and 1 specifying position in the gradient// determinant of quadratic formula (should always be > 0)// sq distance from the current point to focus// sq distance from the intersect point to focus// temp variables for change in X,Y squared// used to index pixels array// incremental index change for pixels array// user space point; these are constant from column to column// for every column (inner loop begins here)// special case to avoid divide by zero// use the quadratic formula to calculate the// intersection point// choose the positive or negative root depending// on where the X coord lies with respect to the focus// divisor// Calculate the square of the distance from the current point// to the focus and the square of the distance from the// intersection point to the focus. Want the squares so we can// do 1 square root after division instead of 2 before.// get the percentage (0-1) of the current point along the// focus-circumference line// incremental change in X, Y//end inner loop//end outer loop/** A <code>Rectangle</code> specifies an area in a coordinate space that is ... *//** The X coordinate of the upper-left corner of the <code>Rectangle</code>. ... *//** The Y coordinate of the upper-left corner of the <code>Rectangle</code>. ... *//** The width of the <code>Rectangle</code>. ... *//** The height of the <code>Rectangle</code>. ... *//** Constructs a new <code>Rectangle</code> whose upper-left corner ... *//** Constructs a new <code>Rectangle</code>, initialized to match ... *//** Constructs a new <code>Rectangle</code> whose upper-left corner is ... *//** Constructs a new <code>Rectangle</code> whose upper-left corner is the ... *//** Constructs a new <code>Rectangle</code> whose top left corner is ... *//** Returns the X coordinate of the bounding <code>Rectangle</code> in ... *//** Returns the Y coordinate of the bounding <code>Rectangle</code> in ... *//** Returns the width of the bounding <code>Rectangle</code> in ... *//** Returns the height of the bounding <code>Rectangle</code> in ... *//** Gets the bounding <code>Rectangle</code> of this <code>Rectangle</code>. ... *//** Sets the bounding <code>Rectangle</code> of this <code>Rectangle</code> ... *//** Sets the bounding <code>Rectangle</code> of this ... *//** Sets the bounds of this {@code Rectangle} to the integer bounds ... */int newxint newyint newwint newh// range and floor-ed or ceiling-ed, depending on the boolean.// Return best integer representation for v, clipped to integer/** Returns the location of this <code>Rectangle</code>. ... *//** Moves this <code>Rectangle</code> to the specified location. ... *//** Translates this <code>Rectangle</code> the indicated distance, ... */int oldvint newv/** Gets the size of this <code>Rectangle</code>, represented by ... *//** Sets the size of this <code>Rectangle</code> to match the ... *//** Sets the size of this <code>Rectangle</code> to the specified ... *//** Checks whether or not this <code>Rectangle</code> contains the ... *//** Checks whether or not this <code>Rectangle</code> entirely contains ... *//** Checks whether this <code>Rectangle</code> entirely contains ... *//** Determines whether or not this <code>Rectangle</code> and the specified ... */int rwint rhint txint tyint rxint ry/** Computes the intersection of this <code>Rectangle</code> with the ... */int tx1int ty1int rx1int ry1long tx2long ty2long rx2long ry2/** Computes the union of this <code>Rectangle</code> with the ... *//** Adds a point, specified by the integer arguments {@code newx,newy} ... */long x2long y2/** Adds the specified {@code Point} to the bounds of this ... *//** Adds a <code>Rectangle</code> to this <code>Rectangle</code>. ... *//** Resizes the <code>Rectangle</code> both horizontally and vertically. ... */long x0long y0long x1long y1Rectangle2D destRectangle2D.Doubleintersect(...)/** Checks whether two rectangles are equal. ... *//** Returns a <code>String</code> representing this ... */// Too far in positive X direction to represent...// We cannot even reach the left side of the specified// rectangle even with both x & width set to MAX_VALUE.// The intersection with the "maximal integer rectangle"// is non-existant so we should use a width < 0.// REMIND: Should we try to determine a more "meaningful"// adjusted value for neww than just "-1"?// Too far in positive Y direction to represent...// moving leftward// negative overflow// Only adjust width if it was valid (>= 0).// The right edge is now conceptually at// newv+width, but we may move newv to prevent// overflow.  But we want the right edge to// remain at its new location in spite of the// clipping.  Think of the following adjustment// conceptually the same as:// width += newv; newv = MIN_VALUE; width -= newv;// width may go negative if the right edge went past// MIN_VALUE, but it cannot overflow since it cannot// have moved more than MIN_VALUE and any non-negative// number + MIN_VALUE does not overflow.// moving rightward (or staying still)// positive overflow// Conceptually the same as:// width += newv; newv = MAX_VALUE; width -= newv;// With large widths and large displacements// we may overflow so we need to check it.// moving upward// See above comment about no overflow in this case// moving downward (or staying still)// At least one of the dimensions is negative...// Note: if any dimension is zero, tests below must return false...// X+W overflowed or W was zero, return false if...// either original w or W was zero or// x+w did not overflow or// the overflowed x+w is smaller than the overflowed X+W// X+W did not overflow and W was not zero, return false if...// original w was zero or// x+w did not overflow and x+w is smaller than X+W// Note: if either dimension is zero, tests below must return false...//    overflow || intersect//      overflow || intersect// tx2,ty2 will never overflow (they will never be// larger than the smallest of the two source w,h)// they might underflow, though...// This rectangle has negative dimensions...// If r has non-negative dimensions then it is the answer.// If r is non-existant (has a negative dimension), then both// are non-existant and we can return any non-existant rectangle// as an answer.  Thus, returning r meets that criterion.// Either way, r is our answer.// tx2,ty2 will never underflow since both original rectangles// were already proven to be non-empty// they might overflow, though...// tx2,ty2 will never underflow since both original// rectangles were non-empty// Non-existant in X direction// Final width must remain negative so subtract x0 before// it is clipped so that we avoid the risk that the clipping// of x0 will reverse the ordering of x0 and x1.// (x1 >= x0)// Clip x0 before we subtract it from x1 in case the clipping// affects the representable area of the rectangle.// The only way x1 can be negative now is if we clipped// x0 against MIN and x1 is less than MIN - in which case// we want to leave the width negative since the result// did not intersect the representable area.// Non-existant in Y direction// (y1 >= y0)/* Note on casts to double below.  If the arithmetic of ... */import SunHints/** The {@code RenderingHints} class defines and manages collections of ... */SunHints.KEY_ANTIALIASINGSunHints.VALUE_ANTIALIAS_ONSunHints.VALUE_ANTIALIAS_OFFSunHints.VALUE_ANTIALIAS_DEFAULTSunHints.KEY_RENDERINGSunHints.VALUE_RENDER_SPEEDSunHints.VALUE_RENDER_QUALITYSunHints.VALUE_RENDER_DEFAULTSunHints.KEY_DITHERINGSunHints.VALUE_DITHER_DISABLESunHints.VALUE_DITHER_ENABLESunHints.VALUE_DITHER_DEFAULTSunHints.KEY_TEXT_ANTIALIASINGSunHints.VALUE_TEXT_ANTIALIAS_ONSunHints.VALUE_TEXT_ANTIALIAS_OFFSunHints.VALUE_TEXT_ANTIALIAS_DEFAULTSunHints.VALUE_TEXT_ANTIALIAS_GASPSunHints.VALUE_TEXT_ANTIALIAS_LCD_HRGBSunHints.VALUE_TEXT_ANTIALIAS_LCD_HBGRSunHints.VALUE_TEXT_ANTIALIAS_LCD_VRGBSunHints.VALUE_TEXT_ANTIALIAS_LCD_VBGRSunHints.KEY_TEXT_ANTIALIAS_LCD_CONTRASTSunHints.KEY_FRACTIONALMETRICSSunHints.VALUE_FRACTIONALMETRICS_OFFSunHints.VALUE_FRACTIONALMETRICS_ONSunHints.VALUE_FRACTIONALMETRICS_DEFAULTSunHints.KEY_INTERPOLATIONSunHints.VALUE_INTERPOLATION_NEAREST_NEIGHBORSunHints.VALUE_INTERPOLATION_BILINEARSunHints.VALUE_INTERPOLATION_BICUBICSunHints.KEY_ALPHA_INTERPOLATIONSunHints.VALUE_ALPHA_INTERPOLATION_SPEEDSunHints.VALUE_ALPHA_INTERPOLATION_QUALITYSunHints.VALUE_ALPHA_INTERPOLATION_DEFAULTSunHints.KEY_COLOR_RENDERINGSunHints.VALUE_COLOR_RENDER_SPEEDSunHints.VALUE_COLOR_RENDER_QUALITYSunHints.VALUE_COLOR_RENDER_DEFAULTSunHints.KEY_STROKE_CONTROLSunHints.VALUE_STROKE_DEFAULTSunHints.VALUE_STROKE_NORMALIZESunHints.VALUE_STROKE_PURE/** Defines the base type of all keys used along with the ... */HashMap<Object,Object> identitymap;Object identitygetIdentity(...)Object otherrefKey otherkeynew WeakReference<Key>(...)int privatekey;/** Construct a key using the indicated private key.  Each ... */this.privatekeyrecordIdentity(...)/** Returns true if the specified object is a valid value ... *//** Returns the private integer key that the subclass ... *//** The hash code for all Key objects will be the same as the ... *//** The equals method for all Key objects will return the same ... */HashMap<Object,Object> hintmap;Key KEY_ANTIALIASING;/** Antialiasing hint key. ... */Object VALUE_ANTIALIAS_ON;/** Antialiasing hint value -- rendering is done with antialiasing. ... */Object VALUE_ANTIALIAS_OFF;/** Antialiasing hint value -- rendering is done without antialiasing. ... */Object VALUE_ANTIALIAS_DEFAULT;/** Antialiasing hint value -- rendering is done with a default ... */Key KEY_RENDERING;/** Rendering hint key. ... */Object VALUE_RENDER_SPEED;/** Rendering hint value -- rendering algorithms are chosen ... */Object VALUE_RENDER_QUALITY;Object VALUE_RENDER_DEFAULT;Key KEY_DITHERING;/** Dithering hint key. ... */Object VALUE_DITHER_DISABLE;/** Dithering hint value -- do not dither when rendering geometry. ... */Object VALUE_DITHER_ENABLE;/** Dithering hint value -- dither when rendering geometry, if needed. ... */Object VALUE_DITHER_DEFAULT;/** Dithering hint value -- use a default for dithering chosen by ... */Key KEY_TEXT_ANTIALIASING;/** Text antialiasing hint key. ... */Object VALUE_TEXT_ANTIALIAS_ON;/** Text antialiasing hint value -- text rendering is done with ... */Object VALUE_TEXT_ANTIALIAS_OFF;/** Text antialiasing hint value -- text rendering is done without ... */Object VALUE_TEXT_ANTIALIAS_DEFAULT;/** Text antialiasing hint value -- text rendering is done according ... */Object VALUE_TEXT_ANTIALIAS_GASP;/** Text antialiasing hint value -- text rendering is requested to ... */Object VALUE_TEXT_ANTIALIAS_LCD_HRGB;/** Text antialiasing hint value -- request that text be displayed ... */Object VALUE_TEXT_ANTIALIAS_LCD_HBGR;Object VALUE_TEXT_ANTIALIAS_LCD_VRGB;Object VALUE_TEXT_ANTIALIAS_LCD_VBGR;Key KEY_TEXT_LCD_CONTRAST;/** LCD text contrast rendering hint key. ... */Key KEY_FRACTIONALMETRICS;/** Font fractional metrics hint key. ... */Object VALUE_FRACTIONALMETRICS_OFF;/** Font fractional metrics hint value -- character glyphs are ... */Object VALUE_FRACTIONALMETRICS_ON;Object VALUE_FRACTIONALMETRICS_DEFAULT;Key KEY_INTERPOLATION;/** Interpolation hint key. ... */Object VALUE_INTERPOLATION_NEAREST_NEIGHBOR;/** Interpolation hint value -- the color sample of the nearest ... */Object VALUE_INTERPOLATION_BILINEAR;/** Interpolation hint value -- the color samples of the 4 nearest ... */Object VALUE_INTERPOLATION_BICUBIC;/** Interpolation hint value -- the color samples of 9 nearby ... */Key KEY_ALPHA_INTERPOLATION;/** Alpha interpolation hint key. ... */Object VALUE_ALPHA_INTERPOLATION_SPEED;/** Alpha interpolation hint value -- alpha blending algorithms ... */Object VALUE_ALPHA_INTERPOLATION_QUALITY;Object VALUE_ALPHA_INTERPOLATION_DEFAULT;Key KEY_COLOR_RENDERING;/** Color rendering hint key. ... */Object VALUE_COLOR_RENDER_SPEED;/** Color rendering hint value -- perform the fastest color ... */Object VALUE_COLOR_RENDER_QUALITY;/** Color rendering hint value -- perform the color conversion ... */Object VALUE_COLOR_RENDER_DEFAULT;/** Color rendering hint value -- perform color conversion ... */Key KEY_STROKE_CONTROL;/** Stroke normalization control hint key. ... */Object VALUE_STROKE_DEFAULT;/** Stroke normalization control hint value -- geometry may be ... */Object VALUE_STROKE_NORMALIZE;/** Stroke normalization control hint value -- geometry should ... */Object VALUE_STROKE_PURE;/** Constructs a new object with keys and values initialized ... *//** Constructs a new object with the specified key/value pair. ... *//** Returns the number of key-value mappings in this ... *//** Returns <code>true</code> if this ... *//** Returns {@code true} if this {@code RenderingHints} ... *//** Returns true if this RenderingHints maps one or more keys to the ... *//** Returns the value to which the specified key is mapped. ... *//** Maps the specified {@code key} to the specified ... */isCompatibleValue(...)/** Adds all of the keys and corresponding values from the specified ... */hints.hintmap/** Clears this <code>RenderingHints</code> object of all key/value ... *//** Removes the key and its corresponding value from this ... *//** Copies all of the mappings from the specified {@code Map} ... *//** Returns a <code>Set</code> view of the Keys contained in this ... *//** Returns a <code>Collection</code> view of the values ... *//** Returns a <code>Set</code> view of the mappings contained ... *//** Compares the specified <code>Object</code> with this ... */(...).hintmap/** Returns the hash code value for this <code>RenderingHints</code>. ... *//** Creates a clone of this <code>RenderingHints</code> object ... */RenderingHints rhrh.hintmap/** Returns a rather long string representation of the hashmap ... */// Note that the identity string is dependent on 3 variables://     - the name of the subclass of Key//     - the identityHashCode of the subclass of Key//     - the integer key of the Key// It is theoretically possible for 2 distinct keys to collide// along all 3 of those attributes in the context of multiple// class loaders, but that occurrence will be extremely rare and// we account for that possibility below in the recordIdentity// method by slightly relaxing our uniqueness guarantees if we// end up in that situation.// Note that this system can fail in a mostly harmless// way.  If we end up generating the same identity// String for 2 different classes (a very rare case)// then we correctly avoid throwing the exception above,// but we are about to drop through to a statement that// will replace the entry for the old Key subclass with// an entry for the new Key subclass.  At that time the// old subclass will be vulnerable to someone generating// a duplicate Key instance for it.  We could bail out// of the method here and let the old identity keep its// record in the map, but we are more likely to see a// duplicate key go by for the new class than the old// one since the new one is probably still in the// initialization stage.  In either case, the probability// of loading 2 classes in the same VM with the same name// and identityHashCode should be nearly impossible.// Note: Use a weak reference to avoid holding on to extra// objects and classes after they should be unloaded.// ## javac bug?//if (m instanceof RenderingHints) {//hintmap.putAll(((RenderingHints) m).hintmap);// Funnel each key/value pair through our protected put methodimport RobotPeerimport ComponentFactory/** This class is used to generate native system input events ... */int MAX_DELAY;RobotPeer peer;boolean isAutoWaitForIdle;int autoDelay;int LEGAL_BUTTON_MASK;DirectColorModel screenCapCM;/** Constructs a Robot object in the coordinate system of the primary screen. ... *//** Creates a Robot for the given screen device. Coordinates passed ... */checkIsScreenDevice(...)checkRobotAllowed(...)createRobot(...)new RobotDisposer(...)initLegalButtonMask(...)int tmpMaskareExtraMouseButtonsEnabled(...)int buttonsNumbergetNumberOfButtons(...)InputEvent.BUTTON3_MASKInputEvent.BUTTON2_MASK/* determine if the security policy allows Robot's to be created */SecurityConstants.AWT.CREATE_ROBOT_PERMISSION/* check if the given device is a screen device */GraphicsDevice.TYPE_RASTER_SCREENRobotDisposer disposer;/** Moves mouse pointer to given screen coordinates. ... */afterEvent(...)/** Presses one or more mouse buttons.  The mouse buttons should ... */checkButtonsArgument(...)mousePress(...)/** Releases one or more mouse buttons. ... */mouseRelease(...)/** Rotates the scroll wheel on wheel-equipped mice. ... */mouseWheel(...)/** Presses a given key.  The key should be released using the ... */checkKeycodeArgument(...)keyPress(...)/** Releases a given key. ... */keyRelease(...)/** Returns the color of a pixel at the given screen coordinates. ... */getRGBPixel(...)/** Creates an image containing pixels read from the screen.  This image does ... */DataBufferInt bufferint[] bandmaskscheckScreenCaptureAllowed(...)checkValidRect(...)sync(...)getRGBPixels(...)pixels.lengthscreenRect.widthscreenRect.heightmakeTrackable(...)SecurityConstants.AWT.READ_DISPLAY_PIXELS_PERMISSION/* Called after an event is generated */autoWaitForIdle(...)autoDelay(...)/** Returns whether this Robot automatically invokes <code>waitForIdle</code> ... *//** Sets whether this Robot automatically invokes <code>waitForIdle</code> ... *//* Calls waitForIdle after every event if so desired. */waitForIdle(...)/** Returns the number of milliseconds this Robot sleeps after generating an event. *//** Sets the number of milliseconds this Robot sleeps after generating an event. ... */checkDelayArgument(...)/* Automatically sleeps for the specified interval after event generated. */delay(...)/** Sleeps for the specified time. ... */InterruptedException ite/** Waits until all events currently on the event queue have been processed. ... */checkNotDispatchThread(...)InvocationTargetException ine/** Returns a string representation of this Robot. ... */String paramsisAutoWaitForIdle(...)getAutoDelay(...)// rather than build a big table or switch statement here, we'll// just check that the key isn't VK_UNDEFINED and assume that the// peer implementations will throw an exception for other bogus// values e.g. -1, 999999/* Fix for 4285201 ... *//* red mask *//* green mask *//* blue mask */// need to sync the toolkit prior to grabbing the pixels since in some// cases rendering to the screen may be delayed// post a dummy event to the queue so we know when// all the events before it have been processed// dummy implementationimport ScrollPanePeerimport ScrollPaneWheelScroller/** A container class which implements automatic horizontal and/or ... */int SCROLLBARS_AS_NEEDED;/** Specifies that horizontal/vertical scrollbar should be shown ... */int SCROLLBARS_ALWAYS;/** Specifies that horizontal/vertical scrollbars should always be ... */int SCROLLBARS_NEVER;/** Specifies that horizontal/vertical scrollbars should never be shown ... */int scrollbarDisplayPolicy;/** There are 3 ways in which a scroll bar can be displayed. ... */ScrollPaneAdjustable vAdjustable;/** An adjustable vertical scrollbar. ... */ScrollPaneAdjustable hAdjustable;/** An adjustable horizontal scrollbar. ... */boolean defaultWheelScroll;boolean wheelScrollingEnabled;/** Indicates whether or not scrolling should take place when a ... *//** Create a new scrollpane container with a scrollbar display ... *//** Create a new scrollpane container. ... */this.scrollbarDisplayPolicynew ScrollPaneAdjustable(...)new PeerFixer(...)Adjustable.VERTICALAdjustable.HORIZONTALsetWheelScrollingEnabled(...)// wrapped with a window.// it is moving a child window around so the windowless child is// The scrollpane won't work with a windowless child... it assumesPanel child/** Adds the specified component to this scroll pane container. ... */isLightweightOrUnknown(...)addToPanel(...)/** Returns the display policy for the scrollbars. ... *//** Returns the current size of the scroll pane's view port. ... *//** Returns the height that would be occupied by a horizontal ... */ScrollPanePeer peergetHScrollbarHeight(...)/** Returns the width that would be occupied by a vertical ... */getVScrollbarWidth(...)/** Returns the <code>ScrollPaneAdjustable</code> object which ... *//** Scrolls to the specified position within the child component. ... */setScrollPosition(...)/** Returns the current x,y position within the child which is displayed ... *//** Sets the layout manager for this container.  This method is ... */new AWTError(...)/** Lays out this container by resizing its child to its preferred size. ... *//** Determine the size to allocate the child component. ... */int viewWidthint viewHeightboolean vbarOnboolean hbarOnDimension childSizeint vbarWidthint hbarHeightchildSize.heightchildSize.widthgetScrollPosition(...)Dimension cscalculateChildSize(...)Dimension vsgetViewportSize(...)cs.widthcs.heightchildResized(...)setSpan(...)vs.widthvs.height/** Prints the component in this scroll pane. ... */Graphics cg/** Creates the scroll pane's peer. */int vAdjustableValueint hAdjustableValuecreateScrollPane(...)String sdpStrisWheelScrollingEnabled(...)/** Process mouse wheel events that are delivered to this ... */handleWheelScrolling(...)/** If wheel scrolling is enabled, we return true for MouseWheelEvents ... *//** Enables/disables scrolling in response to movement of the mouse wheel. ... *//** Indicates whether or not scrolling will take place in response to ... *//** Writes default serializable fields to stream. *//** Reads default serializable fields to stream. ... */this.scroller/** Invoked when the value of the adjustable has changed. */Adjustable adjgetAdjustable(...)scroller.peergetLocation(...).xgetLocation(...).yScrollPane scroller;/** Gets the AccessibleContext associated with this ScrollPane. ... */new AccessibleAWTScrollPane(...)AccessibleRole.SCROLL_PANE/* In JDK 1.1.1, the pkg private class java.awt.PeerFixer was moved to ... */// calculate the view size, accounting for border but not scrollbars// - don't use right/bottom insets since they vary depending//   on whether or not scrollbars were displayed on last resize// determine whether or not horz or vert scrollbars will be displayed// SCROLLBARS_NEVER// adjust predicted view size to account for scrollbars// if child is smaller than view, size it up// update adjustables... the viewport size may have changed// with the scrollbars coming or going so the viewport size// is updated before the adjustables.// Bug 4124460. Save the current adjustable values,// so they can be restored after addnotify. Set the// adjustables to 0, to prevent crashes for possible// negative values.// Bug 4124460. Restore the adjustable values.// 4352819: We only need this degenerate writeObject to make// it safe for future versions of this class to write optional// data to the stream.// 4352819: Gotcha!  Cannot use s.defaultReadObject here and// then continue with reading optional data.  Use GetField instead.// Old fields// Since 1.4//      // Note to future maintainers//      if (f.defaulted("wheelScrollingEnabled")) {//          // We are reading pre-1.4 stream that doesn't have//          // optional data, not even the TC_ENDBLOCKDATA marker.//          // Reading anything after this point is unsafe as we will//          // read unrelated objects further down the stream (4352819).//      else {//          // Reading data from 1.4 or later, it's ok to try to read//          // optional data as OptionalDataException with eof == true//          // will be correctly reported// class AccessibleAWTScrollPaneimport AdjustmentEventimport AdjustmentListener/** This class represents the state of a horizontal or vertical ... */setScrollPaneAdjustableAccessor(...)AWTAccessor.ScrollPaneAdjustableAccessorsetTypedValue(...)ScrollPane sp;/** The <code>ScrollPane</code> this object is a scrollbar of. ... *//** Orientation of this scrollbar. ... *//** The value of this scrollbar. ... */int minimum;/** The minimum value of this scrollbar. ... */int maximum;/** The maximum value of this scrollbar. ... */int visibleAmount;/** The size of the visible portion of this scrollbar. ... */boolean isAdjusting;/** The adjusting status of the <code>Scrollbar</code>. ... */int unitIncrement;/** The amount by which the scrollbar value will change when going ... */int blockIncrement;String SCROLLPANE_ONLY;/** Error message for <code>AWTError</code> reported when one of ... *//** Initialize JNI field and method ids. *//** JDK 1.1 serialVersionUID. *//** Constructs a new object to represent specified scrollabar ... */this.spthis.orientation/** This is called by the scrollpane itself to update the ... *//** Returns the orientation of this scrollbar. ... *//** This method should <strong>NOT</strong> be called by user code. ... */sp.peersetUnitIncrement(...)/** Sets the <code>valueIsAdjusting</code> property. ... */AdjustmentEvent enew AdjustmentEvent(...)/** Returns true if the value is in the process of changing as a ... *//** Sets the value of this scrollbar to the specified value. ... *//** Adds the specified adjustment listener to receive adjustment ... *//** Removes the specified adjustment listener so that it no longer ... *//** Returns an array of all the adjustment listeners ... *//** Returns a string representation of this scrollbar and its values. ... *//** Returns a string representing the state of this scrollbar. ... */// adjust the values to be reasonable// XXX: This relies on setSpan always being called with 0 for// the minimum (which is currently true).// Synchronously notify the listeners so that they are// guaranteed to be up-to-date with the Adjustable before// it is mutated again.import ScrollbarPeer/** The <code>Scrollbar</code> class embodies a scroll bar, a ... *//** A constant that indicates a horizontal scroll bar. *//** A constant that indicates a vertical scroll bar. *//** The value of the <code>Scrollbar</code>. ... *//** The maximum value of the <code>Scrollbar</code>. ... *//** The minimum value of the <code>Scrollbar</code>. ... *//** The size of the <code>Scrollbar</code>'s bubble. ... *//** The <code>Scrollbar</code>'s orientation--being either horizontal ... */int lineIncrement;int pageIncrement;/** Constructs a new vertical scroll bar. ... *//** Constructs a new scroll bar with the specified orientation. ... *//** Constructs a new scroll bar with the specified orientation, ... *//** Creates the <code>Scrollbar</code>'s peer.  The peer allows you to modify ... */createScrollbar(...)/** Returns the orientation of this scroll bar. ... *//** Sets the orientation for this scroll bar. ... */AccessibleState.HORIZONTALAccessibleState.VERTICAL/** Gets the current value of this scroll bar. ... *//** Sets the value of this scroll bar to the specified value. ... *//** Gets the minimum value of this scroll bar. ... *//** Sets the minimum value of this scroll bar. ... *//** Gets the maximum value of this scroll bar. ... *//** Sets the maximum value of this scroll bar. ... *//** Gets the visible amount of this scroll bar. ... */getVisible(...)/** Sets the visible amount of this scroll bar. ... *//** Sets the unit increment for this scroll bar. ... */setLineIncrement(...)ScrollbarPeer peer/** Gets the unit increment for this scrollbar. ... */getLineIncrement(...)/** Sets the block increment for this scroll bar. ... */setPageIncrement(...)/** Gets the block increment of this scroll bar. ... */getPageIncrement(...)/** Sets the values of four properties for this scroll bar: ... */int oldValuelong maxMinusMinthis.visibleAmountthis.minimumthis.maximumAccessibleContext.ACCESSIBLE_VALUE_PROPERTYboolean oldValueAccessibleState.BUSY/** Adds the specified adjustment listener to receive instances of ... *//** Processes events on this scroll bar. If the event is an ... */processAdjustmentEvent(...)/** Processes adjustment events occurring on this ... */AdjustmentListener listener/** Returns a string representing the state of this <code>Scrollbar</code>. ... */int scrollbarSerializedDataVersion;/** The scroll bar's serialized Data Version. ... */new AccessibleAWTScrollBar(...)AccessibleRole.SCROLL_BAR/** Get the <code>AccessibleValue</code> associated with this ... *//** Get the accessible value of this object. ... *//** Get the minimum accessible value of this object. ... *//** Get the maximum accessible value of this object. ... *//* Create a new peer with the specified orientation. */// Use setValues so that a consistent policy relating// minimum, maximum, visible amount, and value is enforced.// No checks are necessary in this method since minimum is// the first variable checked in the setValues function.// minimum is checked first in setValues, so we need to// enforce minimum and maximum checks here.// AccessibleAWTScrollBar/** A helper interface to run the nested event loop. ... *//** Blocks the execution of the current thread and enters a new ... *//** Unblocks the execution of the thread blocked by the {@link ... *//** A wrapping tag for a nested AWTEvent which indicates that the event was ... */FocusEvent.FOCUS_LASTboolean dispatched;AWTEvent nested;AppContext toNotify;this.nestedthis.toNotifynew SentEvent(...)/** A mechanism for ensuring that a series of AWTEvents are executed in a ... */new LinkedList<SequencedEvent>(...)setSequencedEventAccessor(...)AWTAccessor.SequencedEventAccessor(...).nestedLinkedList<SequencedEvent> list;/** Constructs a new SequencedEvent which will dispatch the specified ... */setSystemGenerated(...)/** Dispatches the nested event after all previous nested events have been ... */isFirstOrDisposed(...)SequencedEvent.thissetCurrentSequencedEvent(...)/** true only if event exists and nested source appContext is disposed. */se.nested(...).appContext/** Sequenced events are dispatched in order, so we cannot dispatch ... */getFirstWithContext(...)/* Disposes all events from disposed AppContext ... */SequencedEvent firstisOwnerAppContextDisposed(...)/** Disposes of this instance. This method is invoked once the nested event ... */SequencedEvent nextnext.appContext// All AWTEvents that are wrapped in SequencedEvents are (at// least currently) implicitly generated by the system// getFirstWithContext can dispose this// Wake myself up// Wake up waiting threads/** The <code>Shape</code> interface provides definitions for objects ... *//** Returns an integer {@link Rectangle} that completely encloses the ... *//** Returns a high precision and more accurate bounding box of ... *//** Tests if the specified coordinates are inside the boundary of the ... *//** Tests if a specified {@link Point2D} is inside the boundary ... *//** Tests if the interior of the <code>Shape</code> intersects the ... *//** Tests if the interior of the <code>Shape</code> entirely contains ... *//** Tests if the interior of the <code>Shape</code> entirely contains the ... *//** Returns an iterator object that iterates along the ... *//** Returns an iterator object that iterates along the <code>Shape</code> ... *//** The splash screen can be displayed at application startup, before the ... *//** Returns the {@code SplashScreen} object used for ... */long ptr_getInstance(...)_isVisible(...)new SplashScreen(...)/** Changes the splash screen image. The new image is loaded from the ... */URLConnection connectioncheckVisible(...)int availablebyte[] oldBuf_setImageData(...)this.imageURL/** Returns the current splash screen image. ... */_getImageFileName(...)_getImageJarName(...)/** Returns the bounds of the splash screen window as a {@link Rectangle}. ... */_getScaleFactor(...)_getBounds(...)/** Returns the size of the splash screen window as a {@link Dimension}. ... *//** Creates a graphics context (as a {@link Graphics2D} object) for the splash ... *//** Updates the splash window with current contents of the overlay image. ... */DataBuffer bufint numBanksgetNumBanks(...)SinglePixelPackedSampleModel smthis.image_update(...)/** Hides the splash screen, closes the window, and releases all associated ... */_close(...)markClosed(...)/** Determines whether the splash screen is visible. The splash screen may ... */long splashPtr;// overlay imageboolean wasClosed;// pointer to native Splash structureURL imageURL;SplashScreen theInstance;/** The instance reference for the singleton. ... */// non-public constructor// SplashScreen class is now a singleton// check for available data// no data available... well, let's try reading one byte// we'll see what happens then// check for enough room in buffer, realloc if needed// the buffer always grows in size 2x minimum// now read the data// get unscaled splash image size// Note that we steal the data array here, but just for reading// so we do not need to mark the DataBuffer dirty.../** The <code>Stroke</code> interface allows a ... *//** Returns an outline <code>Shape</code> which encloses the area that ... *//* Copyright (c) 1996, 1999, Oracle and/or its affiliates. All rights reserved. ... *//** A class to encapsulate symbolic colors representing the color of ... */new SystemColor(...)new SystemColor[]SystemColor.desktopSystemColor.activeCaptionSystemColor.activeCaptionTextSystemColor.activeCaptionBorderSystemColor.inactiveCaptionSystemColor.inactiveCaptionTextSystemColor.inactiveCaptionBorderSystemColor.windowSystemColor.windowBorderSystemColor.windowTextSystemColor.menuSystemColor.menuTextSystemColor.textSystemColor.textTextSystemColor.textHighlightSystemColor.textHighlightTextSystemColor.textInactiveTextSystemColor.controlSystemColor.controlTextSystemColor.controlHighlightSystemColor.controlLtHighlightSystemColor.controlShadowSystemColor.controlDkShadowSystemColor.scrollbarSystemColor.infoSystemColor.infoTextsetSystemColorAccessor(...)...::...new SystemColorAccessor(...) { ... }updateSystemColors(...)int DESKTOP;/** The array index for the ... */int ACTIVE_CAPTION;int ACTIVE_CAPTION_TEXT;int ACTIVE_CAPTION_BORDER;int INACTIVE_CAPTION;int INACTIVE_CAPTION_TEXT;int INACTIVE_CAPTION_BORDER;int WINDOW_BORDER;int WINDOW_TEXT;int MENU_TEXT;int TEXT_TEXT;int TEXT_HIGHLIGHT;int TEXT_HIGHLIGHT_TEXT;int TEXT_INACTIVE_TEXT;int CONTROL;int CONTROL_TEXT;int CONTROL_HIGHLIGHT;int CONTROL_LT_HIGHLIGHT;int CONTROL_SHADOW;int CONTROL_DK_SHADOW;int SCROLLBAR;int INFO;int INFO_TEXT;int NUM_COLORS;/** The number of system colors in the array. */...[] systemColors;/* System colors with default initial values, overwritten by toolkit if ... *//** *************************************************************************************** */SystemColor desktop;/** The color rendered for the background of the desktop. */SystemColor activeCaption;/** The color rendered for the window-title background of the currently active window. */SystemColor activeCaptionText;/** The color rendered for the window-title text of the currently active window. */SystemColor activeCaptionBorder;/** The color rendered for the border around the currently active window. */SystemColor inactiveCaption;/** The color rendered for the window-title background of inactive windows. */SystemColor inactiveCaptionText;/** The color rendered for the window-title text of inactive windows. */SystemColor inactiveCaptionBorder;/** The color rendered for the border around inactive windows. */SystemColor window;/** The color rendered for the background of interior regions inside windows. */SystemColor windowBorder;/** The color rendered for the border around interior regions inside windows. */SystemColor windowText;/** The color rendered for text of interior regions inside windows. */SystemColor menu;/** The color rendered for the background of menus. */SystemColor menuText;/** The color rendered for the text of menus. */SystemColor text;/** The color rendered for the background of text control objects, such as ... */SystemColor textText;/** The color rendered for the text of text control objects, such as textfields ... */SystemColor textHighlight;/** The color rendered for the background of selected items, such as in menus, ... */SystemColor textHighlightText;/** The color rendered for the text of selected items, such as in menus, comboboxes, ... */SystemColor textInactiveText;/** The color rendered for the text of inactive items, such as in menus. */SystemColor control;/** The color rendered for the background of control panels and control objects, ... */SystemColor controlText;/** The color rendered for the text of control panels and control objects, ... */SystemColor controlHighlight;/** The color rendered for light areas of 3D control objects, such as pushbuttons. ... */SystemColor controlLtHighlight;/** The color rendered for highlight areas of 3D control objects, such as pushbuttons. ... */SystemColor controlShadow;/** The color rendered for shadow areas of 3D control objects, such as pushbuttons. ... */SystemColor controlDkShadow;/** The color rendered for dark shadow areas on 3D control objects, such as pushbuttons. ... */SystemColor scrollbar;/** The color rendered for the background of scrollbars. */SystemColor info;/** The color rendered for the background of tooltips or spot help. */SystemColor infoText;/** The color rendered for the text of tooltips or spot help. *//* JDK 1.1 serialVersionUID. *//* An index into either array of SystemColor objects or values. */...[] systemColorObjects;/** Called from {@code <init>} and toolkit to update the above systemColors cache. */systemColors.length/** Creates a symbolic color that represents an indexed entry into system ... *//** Returns a string representation of this <code>Color</code>'s values. ... *//** The design of the {@code SystemColor} class assumes that ... *//** Returns a specialized version of the {@code SystemColor} ... */SystemColor colorcolor.value// desktop = new Color(0,92,92);// activeCaption = new Color(0,0,128);// activeCaptionText = Color.white;// activeCaptionBorder = Color.lightGray;// inactiveCaption = Color.gray;// inactiveCaptionText = Color.lightGray;// inactiveCaptionBorder = Color.lightGray;// window = Color.white;// windowBorder = Color.black;// windowText = Color.black;// menu = Color.lightGray;// menuText = Color.black;// text = Color.lightGray;// textText = Color.black;// textHighlight = new Color(0,0,128);// textHighlightText = Color.white;// textInactiveText = Color.gray;// control = Color.lightGray;// controlText = Color.black;// controlHighlight = Color.white;// controlLtHighlight = new Color(224,224,224);// controlShadow = Color.gray;// controlDkShadow = Color.black;// scrollbar = new Color(224,224,224);// info = new Color(224,224,0);// infoText = Color.black;// The instances of SystemColor are tightly controlled and// only the canonical instances appearing above as static// constants are allowed.  The serial form of SystemColor// objects stores the color index as the value.  Here we// map that index back into the canonical instance.// we put an array index in the SystemColor.value while serialize// to keep compatibility.import SystemTrayPeer/** The <code>SystemTray</code> class represents the system tray for a ... */new TrayIcon[]setSystemTrayAccessor(...)AWTAccessor.SystemTrayAccessorSystemTray systemTray;int currentIconID;SystemTrayPeer peer;// each TrayIcon added gets a unique ID...[] EMPTY_TRAY_ARRAY;/** Private <code>SystemTray</code> constructor. *//** Gets the <code>SystemTray</code> instance that represents the ... */checkSystemTrayAllowed(...)initializeSystemTrayIfNeeded(...)/** Returns whether the system tray is supported on the current ... */isTraySupported(...)/** Adds a <code>TrayIcon</code> to the <code>SystemTray</code>. ... */TrayIcon[] oldArrayTrayIcon[] newArrayVector<TrayIcon> iconsgetTrayIcons(...)new Vector<TrayIcon>(...)setID(...)/** Removes the specified <code>TrayIcon</code> from the ... *//** Returns an array of all icons added to the tray by this ... *//** Returns the size, in pixels, of the space that a tray icon will ... */getTrayIconSize(...)/** Adds a {@code PropertyChangeListener} to the list of listeners for the ... */getCurrentChangeSupport(...)/** Removes a {@code PropertyChangeListener} from the listener list ... *//** Returns an array of all the listeners that have been associated ... */// ***************************************************************/** Returns the current PropertyChangeSupport instance for the ... */createSystemTray(...)SecurityConstants.AWT.ACCESS_SYSTEM_TRAY_PERMISSIONnew SystemTray(...)// connecting tray to native resource// skip initialization as the init routine// throws HeadlessException// TrayIcon with no peer is not contained in the array.import TextAreaPeer/** A <code>TextArea</code> object is a multi-line region ... */initFocusTraversalKeysSet(...)/** The number of rows in the <code>TextArea</code>. ... */int columns;/** The number of columns in the <code>TextArea</code>. ... */int SCROLLBARS_BOTH;/** Create and display both vertical and horizontal scrollbars. ... */int SCROLLBARS_VERTICAL_ONLY;/** Create and display vertical scrollbar only. ... */int SCROLLBARS_HORIZONTAL_ONLY;/** Create and display horizontal scrollbar only. ... */int SCROLLBARS_NONE;/** Do not create or display any scrollbars for the text area. ... */int scrollbarVisibility;/** Determines which scrollbars are created for the ... */Set<AWTKeyStroke> forwardTraversalKeys, ...;/** Cache the Sets of forward and backward traversal keys so we need not ... *//** Constructs a new text area with the empty string as text. ... *//** Constructs a new text area with the specified text. ... *//** Constructs a new text area with the specified number of ... *//** Constructs a new text area with the specified text, ... */this.columnsthis.scrollbarVisibility/** Construct a name for this component.  Called by <code>getName</code> ... *//** Creates the <code>TextArea</code>'s peer.  The peer allows us to modify ... */createTextArea(...)/** Inserts the specified text at the specified position ... */insertText(...)TextAreaPeer peer/** Appends the given text to the text area's current text. ... */appendText(...)/** Replaces text between the indicated start and end positions ... */replaceText(...)replaceRange(...)/** Returns the number of rows in the text area. ... *//** Sets the number of rows for this text area. ... *//** Returns the number of columns in this text area. ... *//** Sets the number of columns for this text area. ... *//** Returns an enumerated value that indicates which scroll bars ... *//** Determines the preferred size of a text area with the specified ... *//** Determines the preferred size of this text area. ... *//** Determines the minimum size of a text area with the specified ... *//** Determines the minimum size of this text area. ... *//** Returns a string representing the state of this <code>TextArea</code>. ... */String sbVisStrint textAreaSerializedDataVersion;/** The textArea Serialized Data Version. ... *//** Read the ObjectInputStream. ... *//** Returns the <code>AccessibleContext</code> associated with ... */new AccessibleAWTTextArea(...)/** Gets the state set of this object. ... */AccessibleState.MULTI_LINE// HeadlessException will be thrown by TextComponent's readObject// Make sure the state we just read in for columns, rows,// and scrollbarVisibility has legal valuesimport TextComponentPeerimport InputMethodSupportimport BreakIteratorimport AttributeSet/** The <code>TextComponent</code> class is the superclass of ... *//** The value of the text. ... */boolean editable;/** A boolean indicating whether or not this ... */int selectionStart;/** The selection refers to the selected text, and the ... */int selectionEnd;boolean backgroundSetByClientCode;// the background color of non-editable TextComponents.// developer code (as opposed to AWT code).  Used to determine// A flag used to tell whether the background has been set by/** Constructs a new text component initialized with the ... */boolean shouldEnableenableInputMethodsForTextComponent(...)enableInputMethods(...)/** Enables or disables input method support for this text component. If input ... */enableInputMethodsIfNecessary(...)TextComponentPeer peergetInputMethodRequests(...)/** Makes this Component displayable by connecting it to a ... *//** Removes the <code>TextComponent</code>'s peer. ... */getSelectionStart(...)getSelectionEnd(...)/** Sets the text that is presented by this ... */boolean skipTextEvent/** Returns the text that is presented by this text component. ... *//** Returns the selected text from the text that is ... *//** Indicates whether or not this text component is editable. ... *//** Sets the flag that determines whether or not this ... */setEditable(...)/** Gets the background color of this text component. ... *//** Sets the background color of this text component. ... *//** Gets the start position of the selected text in ... *//** Sets the selection start for this text component to ... *//** Gets the end position of the selected text in ... *//** Sets the selection end for this text component to ... *//** Selects the text between the specified start and end positions. ... */this.selectionStartthis.selectionEnd/** Selects all the text in this text component. ... *//** Sets the position of the text insertion caret. ... */int maxpositionsetCaretPosition(...)/** Returns the position of the text insertion caret. ... *//** Adds the specified text event listener to receive text events ... *//** Removes the specified text event listener so that it no longer ... *//** Returns an array of all the text listeners ... *//** Processes events on this text component. If the event is a ... */processTextEvent(...)/** Processes text events occurring on this text component by ... */TextListener listener/** Assigns a valid value to the canAccessClipboard instance variable. */SecurityConstants.AWT.ACCESS_CLIPBOARD_PERMISSIONint textComponentSerializedDataVersion;/** The textComponent SerializedDataVersion. ... *//** Read the ObjectInputStream, and if it isn't null, ... */addTextListener(...)/** Gets the AccessibleContext associated with this TextComponent. ... */new AccessibleAWTTextComponent(...)/** Constructs an AccessibleAWTTextComponent.  Adds a listener to track ... */TextComponent.this/** TextListener notification of a text value change. */Integer cpos/** Gets the state set of the TextComponent. ... */AccessibleState.EDITABLE/** Get the AccessibleText associated with this object.  In the ... *//** Given a point in local coordinates, return the zero-based index ... *//** Many of these methods are just convenience methods; they ... */// --- interface AccessibleText methods ------------------------/** Determines the bounding box of the character at the given ... *//** Returns the number of characters (valid indicies) ... *//** Returns the zero-based offset of the caret. ... *//** Returns the AttributeSet for a given character (at a given index). ... *//** Returns the start offset within the selected text. ... *//** Returns the end offset within the selected text. ... *//** Returns the portion of the text that is selected. ... */String selTextgetSelectedText(...)/** Returns the String at a given index. ... */AccessibleText.CHARACTERAccessibleText.WORDBreakIterator wordsgetWordInstance(...)following(...)AccessibleText.SENTENCEBreakIterator sentencegetSentenceInstance(...)boolean NEXT;boolean PREVIOUS;/** Needed to unify forward and backward searching. ... */preceding(...)BreakIterator.DONEisLetter(...)/** Returns the String after a given index. ... */findWordLimit(...)/** Returns the String before a given index. ... */boolean checkForEnableIM;// end of AccessibleAWTTextComponent// if something bad happens, just don't enable input methods// moved from the constructor above to here and addNotify below,// this call will initialize the toolkit if not already initialized.// TextComponent handles key events without touching the eventMask or// having a key listener, so just check whether the flag is set// Please note that we do not want to post an event// if TextArea.setText() or TextField.setText() replaces an empty text// by an empty text, that is, if component's text remains unchanged./* Route through select method to enforce consistent policy ... */// Serialization support.  Since the value of the fields// selectionStart, selectionEnd, and text aren't necessarily// up to date, we sync them up with the peer before serializing.// Make sure the state we just read in for text,// selectionStart and selectionEnd has legal values// No attributes in TextComponent// Fix for 4256662// Fix for 4256660 and 4256661.// Words iterator is different from character and sentence iterators// in that end of one word is not necessarily start of another word.// Please see java.text.BreakIterator JavaDoc. The code below is// based on nextWordStartAfter example from BreakIterator.java.import TextFieldPeer/** A <code>TextField</code> object is a text component ... *//** The number of columns in the text field. ... */char echoChar;/** The echo character, which is used when ... *//** Constructs a new text field. ... *//** Constructs a new text field initialized with the specified text. ... *//** Constructs a new empty text field with the specified number ... *//** Constructs a new text field initialized with the specified text ... *//** Creates the TextField's peer.  The peer allows us to modify the ... */createTextField(...)/** Gets the character that is to be used for echoing. ... *//** Sets the echo character for this text field. ... */setEchoCharacter(...)TextFieldPeer peer/** Indicates whether or not this text field has a ... *//** Gets the number of columns in this text field. A column is an ... *//** Sets the number of columns in this text field. A column is an ... *//** Gets the preferred size of this text field ... *//** Gets the preferred size of this text field. ... *//** Gets the minimum dimensions for a text field with ... *//** Gets the minimum dimensions for this text field. ... *//** Adds the specified action listener to receive ... *//** Processes events on this text field. If the event ... *//** Processes action events occurring on this text field by ... *//** Returns a string representing the state of this <code>TextField</code>. ... */int textFieldSerializedDataVersion;/** The textField Serialized Data Version. ... *//** Read the ObjectInputStream and if it isn't null, ... *//** Gets the AccessibleContext associated with this TextField. ... */new AccessibleAWTTextField(...)AccessibleState.SINGLE_LINE// Make sure the state we just read in for columns has legal values// Read in listeners, if any/** The <code>TexturePaint</code> class provides a way to fill a ... */BufferedImage bufImg;double tx;double ty;double sx;double sy;/** Constructs a <code>TexturePaint</code> object. ... */this.bufImgthis.txthis.tythis.sxthis.sy/** Returns the <code>BufferedImage</code> texture used to ... *//** Returns a copy of the anchor rectangle which positions and ... *//** Returns the transparency mode for this <code>TexturePaint</code>. ... */import IntegerInterleavedRasterColorModel argbmodel;ColorModel colorModel;int bWidth;int bHeight;int maxWidth;WritableRaster outRas;double xOrg;double yOrg;double incXAcross;double incYAcross;double incXDown;double incYDown;int colincx;int colincy;int colincxerr;int colincyerr;int rowincx;int rowincy;int rowincxerr;int rowincyerr;int maxwdevBounds.widthRenderingHints.KEY_INTERPOLATIONboolean filterRenderingHints.VALUE_RENDER_QUALITYRenderingHints.KEY_RENDERINGRenderingHints.VALUE_INTERPOLATION_NEAREST_NEIGHBORisFilterableDCM(...)IntegerInterleavedRaster iirgetNumDataElements(...)new Int(...)ByteInterleavedRaster birisFilterableICM(...)new ByteFilter(...)new Any(...)isMaskOK(...)this.colorModelgetInternedColorModel(...)this.bWidththis.bHeightthis.maxWidthsetToScale(...)this.incXAcrossmod(...)this.incYAcrossgetShearY(...)this.incXDowngetShearX(...)this.incYDownthis.xOrggetTranslateX(...)this.yOrgthis.colincxthis.colincythis.colincxerrfractAsInt(...)this.colincyerrthis.rowincxthis.rowincythis.rowincxerrthis.rowincyerrdropRaster(...)double Xdouble YmakeRaster(...)setRaster(...)WeakReference<Raster> xrgbRasRef;WeakReference<Raster> argbRasRef;WeakReference<Raster> byteRasRef;/* Blends the four ARGB values in the rgbs array using the factors ... */int accumAint accumRint accumGint accumBIntegerInterleavedRaster srcRas;...[] inData;int inOff;int inSpan;...[] outData;int outOff;int outSpan;boolean filter;this.srcRasthis.inDatathis.inSpanthis.inOffIntegerInterleavedRaster iiRasint[] inDataint[] outDatathis.outDataint inSpanint inOffint outSpanthis.outSpanboolean normalxint rowxint rowyint rowxerrint rowyerrint[] rgbsint inint copywint nextxint nextyblend(...)ByteInterleavedRaster srcRas;makeByteRaster(...)ByteInterleavedRaster biRasdropByteRaster(...)byte[] inDatabyte[] outData...[] inPalette;this.inPalettegetRGBs(...)WritableRaster srcRas;Object dataWritableRaster srcRasWritableRaster outRasthis.outRas// For very small negative numerators, the answer might// be such a tiny bit less than den that the difference// is smaller than the mantissa of a double allows and// the result would then be rounded to den.  If that is// the case then we map that number to 0 as the nearest// modulus representation.// If h==1, we will probably get lots of "scanline" rects// If we are going to cache this Raster, make it non-tiny// xmul/ymul are 31 bits wide, (0 => 2^31-1)// shift them to 12 bits wide, (0 => 2^12-1)// The complement of the [xy]mul values (1-[xy]mul) can result// in new values in the range (1 => 2^12).  Thus for any given// loop iteration, the values could be anywhere in (0 => 2^12).// xmul and ymul are each 12 bits (0 => 2^12)// factor is thus 24 bits (0 => 2^24)// accum variables will accumulate 32 bits// bytes extracted from rgb fit in 8 bits (0 => 255)// byte * factor thus fits in 32 bits (0 => 255 * 2^24)// Note that we do not pass srcRas to makeRaster since it// is a Byte Raster and this colorModel needs an Int Rasterimport java.awt.peer.*import InputMethodHighlightimport Clipboardimport DragSourceimport DragGestureRecognizerimport DragGestureEventimport DragGestureListenerimport InvalidDnDOperationExceptionimport DragSourceContextPeerimport NullComponentPeerimport CoreResourceBundleControl/** This class is the abstract superclass of all actual ... */createPropertyChangeSupport(...)new WeakHashMap<AWTEventListener,SelectiveAWTEventListener>(...)setToolkitAccessor(...)AWTAccessor.ToolkitAccessorsetPlatformResources(...)getRBControlInstance(...)MissingResourceException einitAssistiveTechnologies(...)/** Creates this toolkit's implementation of the <code>Desktop</code> ... *//** Creates this toolkit's implementation of <code>Button</code> using ... *//** Creates this toolkit's implementation of <code>TextField</code> using ... *//** Creates this toolkit's implementation of <code>Label</code> using ... *//** Creates this toolkit's implementation of <code>List</code> using ... *//** Creates this toolkit's implementation of <code>Checkbox</code> using ... *//** Creates this toolkit's implementation of <code>Scrollbar</code> using ... *//** Creates this toolkit's implementation of <code>ScrollPane</code> using ... *//** Creates this toolkit's implementation of <code>TextArea</code> using ... *//** Creates this toolkit's implementation of <code>Choice</code> using ... *//** Creates this toolkit's implementation of <code>Frame</code> using ... *//** Creates this toolkit's implementation of <code>Canvas</code> using ... *//** Creates this toolkit's implementation of <code>Panel</code> using ... *//** Creates this toolkit's implementation of <code>Window</code> using ... *//** Creates this toolkit's implementation of <code>Dialog</code> using ... *//** Creates this toolkit's implementation of <code>MenuBar</code> using ... *//** Creates this toolkit's implementation of <code>Menu</code> using ... *//** Creates this toolkit's implementation of <code>PopupMenu</code> using ... *//** Creates this toolkit's implementation of <code>MenuItem</code> using ... *//** Creates this toolkit's implementation of <code>FileDialog</code> using ... *//** Creates this toolkit's implementation of <code>CheckboxMenuItem</code> using ... *//** Obtains this toolkit's implementation of helper class for ... */LightweightPeer lightweightMarker;/** Creates a peer for a component or container.  This peer is windowless ... */new NullComponentPeer(...)/** Creates this toolkit's implementation of <code>Font</code> using ... *//** Fills in the integer array that is supplied as an argument ... */// <code>updateSystemColors</code> in <code>SystemColor</code>.// The following method is called by the private method/** Controls whether the layout of Containers is validated dynamically ... */setDynamicLayout(...)/** Returns whether the layout of Containers is validated dynamically ... */isDynamicLayoutSet(...)/** Returns whether dynamic layout of Containers on resize is ... */isDynamicLayoutActive(...)/** Gets the size of the screen.  On systems with multiple displays, the ... *//** Returns the screen resolution in dots-per-inch. ... *//** Gets the insets of the screen. ... */getScreenInsets(...)/** Determines the color model of this toolkit's screen. ... *//** Returns the names of the available fonts in this toolkit.<p> ... *//** Gets the screen device metrics for rendering of the font. ... *//** Synchronizes this toolkit's graphics state. Some window systems ... *//** The default toolkit. */String atNames;/** Used internally by the assistive technologies functions; set at ... *//** Initializes properties related to assistive technologies. ... */Properties propertiesString magPresentString classNamesFile propsFileFileInputStream in/** Loads additional classes into the VM, using the property ... */String atName/** Gets the default toolkit. ... */new HeadlessToolkit(...)loadAssistiveTechnologies(...)/** Returns an image which gets pixel data from the specified file, ... *//** Returns an image which gets pixel data from the specified URL. ... *//** Returns an image which gets pixel data from the specified file. ... *//** Prepares an image for rendering. ... *//** Indicates the construction status of a specified image that is ... *//** Creates an image with the specified image producer. ... *//** Creates an image which decodes the image stored in the specified ... */imagedata.length/** Gets a <code>PrintJob</code> object which is the result of initiating ... */getPrintJob(...)/** Emits an audio beep depending on native system settings and hardware ... *//** Gets the singleton instance of the system Clipboard which interfaces ... *//** Gets the singleton instance of the system selection as a ... */getSystemSelection(...)/** Determines which modifier key is the appropriate accelerator ... */Event.CTRL_MASK/** Returns whether the given locking key on the keyboard is currently in ... */KeyEvent.VK_KANA_LOCK/** Sets the state of the given locking key on the keyboard. ... *//** Give native peers the ability to query the native container ... *//** Creates a new custom cursor object. ... *//** Returns the supported cursor dimension which is closest to the desired ... */getBestCursorSize(...)/** Returns the maximum number of colors the Toolkit supports in a custom cursor ... */getMaximumCursorColors(...)/** Returns whether Toolkit supports this state for ... */Frame.NORMALResourceBundle resources;/** Support for I18N: any visible strings should be stored in ... */ResourceBundle platformResources;// called by platform toolkitboolean loaded;/** WARNING: This is a temporary workaround for a problem in the ... *//** Gets a property with the specified key and default. ... *//** Get the application's or applet's EventQueue instance. ... */SecurityConstants.AWT.CHECK_AWT_EVENTQUEUE_PERMISSIONgetSystemEventQueueImpl(...)/** Gets the application's or applet's <code>EventQueue</code> ... *//* Accessor method for use by AWT package routines. *//** Creates the peer for a DragSourceContext. ... *//** Creates a concrete, platform dependent, subclass of the abstract ... *//** Obtains a value for the specified desktop property. ... */getUnderlyingToolkit(...)initializeDesktopProperties(...)lazilyLoadDesktopProperty(...)setDesktopProperty(...)/** Sets the named desktop property to the specified value and fires a ... *//** an opportunity to lazily evaluate desktop property values. *//** initializeDesktopProperties *//** Adds the specified property change listener for the named desktop ... *//** Removes the specified property change listener for the named ... *//** Returns an array of all property change listeners ... */Map<String,Object> desktopProperties;PropertyChangeSupport desktopPropsSupport;/** Returns whether the always-on-top mode is supported by this toolkit. ... *//** Returns whether the given modality type is supported by this toolkit. If ... *//** Returns whether the given modal exclusion type is supported by this ... */int LONG_BITS;// 8014718: logging has been removed from SunToolkit...[] calls;long enabledOnToolkitMask;AWTEventListener eventListener;WeakHashMap<AWTEventListener,SelectiveAWTEventListener> listener2SelectiveListener;/* Extracts a "pure" AWTEventListener from a AWTEventListenerProxy, ... */AWTEventListener localL/** Adds an AWTEventListener to receive all AWTEvents dispatched ... */deProxyAWTEventListener(...)SecurityConstants.AWT.ALL_AWT_EVENTS_PERMISSIONSelectiveAWTEventListener selectiveListenernew SelectiveAWTEventListener(...)orEventMasks(...)/** Removes an AWTEventListener from receiving dispatched AWTEvents. ... */int[] listenerCallsgetCalls(...)int ci/** Returns an array of all the <code>AWTEventListener</code>s ... */EventListener[] laAWTEventListener[] retnew AWTEventListener[]la.lengthSelectiveAWTEventListener saelAWTEventListener tempLnew AWTEventListenerProxy(...)getEventMask(...)List<AWTEventListenerProxy> listnew ArrayList<AWTEventListenerProxy>(...)/* This method notifies any AWTEventListeners that an event ... */AWTEventListener eventListenerthis.eventListenereventDispatched(...)// Implementation cloned from AWTEventMulticaster.new ToolkitEventMulticaster(...)// so its method signature must match AWTEventListener.remove().// Note: this method is called by AWTEventListener.removeInternal(),// ToolkitEventMulticaster instead of an AWTEventMulticaster.// instead of the static addInternal() so we allocate a// #4178589: must overload remove(EventListener) to call our add()AWTEventListener a2AWTEventListener b2Toolkit.LONG_BITSAWTEventListener listener;// for each event type.// This array contains the number of times to call the eventlistenerlong eventBitComponentEvent.COMPONENT_FIRSTComponentEvent.COMPONENT_LASTContainerEvent.CONTAINER_FIRSTContainerEvent.CONTAINER_LASTFocusEvent.FOCUS_FIRSTKeyEvent.KEY_FIRSTKeyEvent.KEY_LASTWindowEvent.WINDOW_FIRSTWindowEvent.WINDOW_LASTAdjustmentEvent.ADJUSTMENT_FIRSTAdjustmentEvent.ADJUSTMENT_LASTItemEvent.ITEM_FIRSTItemEvent.ITEM_LASTTextEvent.TEXT_FIRSTTextEvent.TEXT_LASTInputMethodEvent.INPUT_METHOD_FIRSTInputMethodEvent.INPUT_METHOD_LASTAWTEvent.PAINT_EVENT_MASKAWTEvent.INVOCATION_EVENT_MASKInvocationEvent.INVOCATION_FIRSTInvocationEvent.INVOCATION_LASTAWTEvent.WINDOW_STATE_EVENT_MASKWindowEvent.WINDOW_STATE_CHANGEDAWTEvent.WINDOW_FOCUS_EVENT_MASKSunToolkit.GRAB_EVENT_MASKlong eMask/** Returns a map of visual attributes for the abstract level description ... */new DesktopPropertyChangeSupport(...)StringBuilder PROP_CHANGE_SUPPORT_KEY;PropertyChangeSupport pcs/* we do expect that all other fireXXX() methods of java.beans.PropertyChangeSupport ... */Runnable updaterAppContext currentAppContextPeerEvent e/** Reports whether events from extra mouse buttons are allowed to be processed and posted into ... */// Get accessibility properties// Try loading the per-user accessibility properties file.// Inputstream has been buffered in Properties class// Per-user accessibility properties file does not exist// Try loading the system-wide accessibility properties// file only if a per-user accessibility properties// file does not exist or is empty.// System-wide accessibility properties file does// not exist;// Get whether a screen magnifier is present.  First check// the system property and then check the properties file.// Get the names of any assistive technolgies to load.  First// check the system property and then check the properties// file.// Load any assistive technologies// Override to add printing support with new job/page control classes// Override to implement custom cursor support.// others are not guaranteed// No resource file; defaults will be used.// ensure that the proper libraries are loaded// first try platform specific bundle// then shared one// This is a workaround for headless toolkits.  It would be// better to override this method but it is declared final.// "this instanceof" syntax defeats polymorphism.// --mm, 03/03/00// This property should never be cached/* for property "awt.font.desktophints" */// Don't fire change event if old and new values are null.// It helps to avoid recursive resending of WM_THEMECHANGED// if user passed in a AWTEventListenerProxy object, extract// the listener// Create a new selectiveListener.// OR the eventMask into the selectiveListener's event mask.// If no bits are set, break out of loop.// Always test bit 0.// Right shift, fill with zeros on left.//assert tempL is not an AWTEventListenerProxy - we should// have weeded them all out// don't want to wrap a proxy inside a proxy//AWTEventListener tempL = sael.getListener();// better to override this method but it is declared package private.// For each event bit set in mask, increment its call count.// Used to save the bit of the event type.// Get the index of the call count for this event type.// Instead of using Math.log(...) we will calculate it with// bit shifts. That's what previous implementation looked like:// int ci = (int) (Math.log(eventBit)/Math.log(2));// Call the listener as many times as it was added for this// event type./** The <code>Transparency</code> interface defines the common transparency ... */int OPAQUE;/** Represents image data that is guaranteed to be completely opaque, ... */int BITMASK;/** Represents image data that is guaranteed to be either completely ... */int TRANSLUCENT;/** Represents image data that contains or might contain arbitrary ... *//** Returns the type of this <code>Transparency</code>. ... */import TrayIconPeer/** A <code>TrayIcon</code> object represents a tray icon that can be ... */setTrayIconAccessor(...)AWTAccessor.TrayIconAccessorString tooltip;PopupMenu popup;boolean autosize;TrayIconPeer peer;/* The tray icon's AccessControlContext. ... *//* Returns the acc this tray icon was constructed with. */insertTargetMapping(...)/** Creates a <code>TrayIcon</code> with the specified image. ... *//** Creates a <code>TrayIcon</code> with the specified image and ... */setToolTip(...)/** Creates a <code>TrayIcon</code> with the specified image, ... */setPopupMenu(...)/** Sets the image for this <code>TrayIcon</code>.  The previous ... */TrayIconPeer peerupdateImage(...)/** Returns the current image used for this <code>TrayIcon</code>. ... *//** Sets the popup menu for this <code>TrayIcon</code>.  If ... */this.popuppopup.isTrayIconPopupthis.popup.isTrayIconPopup/** Returns the popup menu associated with this <code>TrayIcon</code>. ... *//** Sets the tooltip string for this <code>TrayIcon</code>. The ... */this.tooltip/** Returns the tooltip string associated with this ... *//** Sets the auto-size property.  Auto-size determines whether the ... */this.autosize/** Returns the value of the auto-size property. ... *//** Removes the specified mouse listener.  Calling this method with ... *//** Adds the specified mouse listener to receive mouse-motion ... *//** Removes the specified mouse-motion listener.  Calling this method with ... *//** Returns an array of all the mouse-motion listeners ... *//** Returns the command name of the action event fired by this tray icon. ... *//** Sets the command name for the action event fired by this tray ... *//** Removes the specified action listener.  Calling this method with ... *//** The message type determines which icon will be displayed in the ... */new MessageType(...)MessageType ERROR;/** An error message */MessageType WARNING;/** A warning message */MessageType INFO;/** An information message */MessageType NONE;/** Simple message *//** Displays a popup message near the tray icon.  The message will ... */displayMessage(...)/** Returns the size, in pixels, of the space that the tray icon ... */getSystemTray(...)// ****************************************************************createTrayIcon(...)TrayIconPeer pimport Timerimport TimerTaskimport AtomicBoolean/** This utility class is used to suspend execution on a thread ... */new AtomicBoolean(...)EventFilter filter;Conditional extCondition;Conditional condition;long interval;// Use a shared daemon timer to serve all the WaitDispatchSupportsTimerTask timerTask;// shared timer up and running// When this WDS expires, we cancel the timer task leaving theAtomicBoolean keepBlockingEDT;AtomicBoolean keepBlockingCT;/** Creates a {@code WaitDispatchSupport} instance to ... */this.dispatchThreadthis.extConditionthis.conditionboolean extEvaluatethis.intervalinitializeTimer(...)Runnable runThread currentThreadcompareAndSet(...)SequencedEvent currentSEschedule(...)wakeupEDT(...)Runnable wakingRunnable;// We have two mechanisms for blocking: if we're on the// dispatch thread, start a new event pump; if we're// on any other thread, call wait() on the treelock// Dispose SequencedEvent we are dispatching on the the current// AppContext, to prevent us from hang - see 4531693 for details// In case the exit() method is called before starting// new event pump it will post the waking event to EDT.// The event will be handled after the the new event pump// starts. Thus, the enter() method will not hang.// Event pump should be privileged. See 6300270.// If the waiting process has been stopped because of the// time interval passed or an exception occurred, the state// should be changedimport Path2Dimport WindowPeerimport OptionalDataException/** A {@code Window} object is a top-level window with no borders and no ... */new Vector<WeakReference<Window>>(...)Type.NORMALsetWindowAccessor(...)AWTAccessor.WindowAccessorwindow.opacityupdateWindow(...)window.securityWarningWidthwindow.securityWarningHeightwindow.securityWarningPointXwindow.securityWarningPointYwindow.securityWarningAlignmentXwindow.securityWarningAlignmentYWindowPeer peerrepositionSecurityWarning(...)calculateSecurityWarningPosition(...)changed.syncLWRequestsw.autoRequestFocusw.isTrayIconWindow/** Enumeration of available <i>window types</i>. ... */Type NORMAL;/** Represents a <i>normal</i> window. ... */Type UTILITY;/** Represents a <i>utility</i> window. ... */Type POPUP;/** Represents a <i>popup</i> window. ... */String warningString;/** This represents the warning message that is ... */List<Image> icons;/** {@code icons} is the graphical way we can ... */Component temporaryLostComponent;/** Holds the reference to the component which last had focus in this window ... */boolean systemSyncLWRequests;boolean syncLWRequests;boolean beforeFirstShow;boolean disposing;WindowDisposerRecord disposerRecord;int OPENED;/** An Integer value representing the Window State. ... */boolean alwaysOnTop;/** A boolean value representing Window always-on-top state ... */IdentityArrayList<Window> allWindows;/** Contains all the windows that have a peer object associated, ... */Vector<WeakReference<Window>> ownedWindowList;/** A vector containing all the windows this ... */WeakReference<Window> weakThis;/* We insert a weak reference into the Vector of all Windows in AppContext ... */boolean showWithParent;Dialog modalBlocker;/** Contains the modal dialog that blocks this window, or null ... */Dialog.ModalExclusionType modalExclusionType;WindowStateListener windowStateListener;WindowFocusListener windowFocusListener;InputContext inputContext;Object inputContextLock;FocusManager focusMgr;/** Unused. Maintained for serialization backward-compatibility. ... */boolean focusableWindowState;/** Indicates whether this Window can become the focused Window. ... */boolean autoRequestFocus;/** Indicates whether this window should receive focus on ... */boolean isInShow;/* Indicates that this window is being shown. This flag is set to true at ... */float opacity;/** The opacity level of the window ... */Shape shape;/** The shape assigned to this window. This field is set to {@code null} if ... */boolean locationByPlatformProp;boolean isTrayIconWindow;int securityWarningWidth;/** These fields are initialized in the native peer code ... */int securityWarningHeight;double securityWarningPointX;/** These fields represent the desired location for the security ... */double securityWarningPointY;float securityWarningAlignmentX;float securityWarningAlignmentY;/** Constructs a new, initially invisible window in default size with the ... */WeakReference<Window> owner;WeakReference<AppContext> context;victim.weakThisnew WeakReference<AppContext>(...)Window victimAppContext acWindow parentremoveOwnedWindow(...)removeFromWindowList(...)Insets screenInsetsscreenInsets.leftscreenInsets.topaddToWindowList(...)setWarningString(...)this.visibleinitGC(...)Dialog.ModalExclusionType.NO_EXCLUDEnew WindowDisposerRecord(...)/** Constructs a new, initially invisible window in the default size. ... *//** Constructs a new, initially invisible window with the specified ... */ownedInit(...)/** Constructs a new, initially invisible window with the specified owner ... */addOwnedWindow(...)isAlwaysOnTop(...)setAlwaysOnTop(...)SecurityException ignoreupdateOwner(...)/** Returns the sequence of images to be displayed as the icon for this window. ... *//** Sets the sequence of images to be displayed as the icon ... */updateIconImages(...)/** Sets the image to be displayed as the icon for this window. ... */ArrayList<Image> imageListsetIconImages(...)/** Makes this Window displayable by creating the connection to its ... */createWindow(...)/** Causes this Window to be sized to fit the preferred size ... */Dimension newSizesetClientSize(...)newSize.widthnewSize.height/** Sets the minimum size of this window to a constant ... */minimumSize.widthminimumSize.heightint nwupdateMinimumSize(...)Dimension minSizeminSize.widthminSize.heightComponentPeer.SET_CLIENT_SIZEAtomicBoolean beforeFirstWindowShown;getAndSet(...)/** Shows or hides this {@code Window} depending on the value of parameter ... *//** Makes the Window visible. If the Window and/or its owner ... */toFront_NoClientCode(...)updateFocusableWindowState(...)w.ownedWindowListWindowEvent e/** Hide this Window, its subcomponents, and all of its owned children. ... */child.visible/** Releases all of the native screen resources used by this ... *//* Fix for 4872170. ... */boolean fireWindowClosedEventDisposeAction actionnew DisposeAction(...)GraphicsDevice gdObject[] ownedWindowArrayWindow.thisownedWindowArray.length/** If this Window is visible, brings this Window to the front and may make ... */// to insure that it cannot be overridden by client subclasses.// This functionality is implemented in a final package-private method/** If this Window is visible, sends this Window to the back and may cause ... *//** Returns the toolkit of this frame. ... *//** Gets the warning string that is displayed with this window. ... */SecurityConstants.AWT.TOPLEVEL_WINDOW_PERMISSION/** Gets the {@code Locale} object that is associated ... *//** Gets the input context for this window. A window always has an input context, ... *//** Set the cursor image to a specified cursor. ... *//** Returns the owner of this window. ... *//** Return an array containing all the windows this ... */Window[] realCopyint fullSizeint realSizeWindow[] fullCopythis.modalBlocker/* Returns a list of all displayable Windows, i. e. all the ... */IdentityArrayList<Window> vIdentityArrayList<Window> unblockedVector<WeakReference<Window>> windowList/** Returns an array of all {@code Window}s, both owned and ownerless, ... *//** Returns an array of all {@code Window}s created by this application ... */int ownerlessCountWindow[] ownerless/** Specifies the modal exclusion type for this window. If a window is modal ... */isModalExclusionTypeSupported(...)/** Returns the modal exclusion type of this window. ... */Window ownerVector<Window> childHierarchynew Vector<Window>(...)Window[] wOwnedwOwned.length/** Adds the specified window listener to receive window events from ... *//** Adds the specified window state listener to receive window ... *//** Adds the specified window focus listener to receive window events ... *//** Removes the specified window listener so that it no longer ... *//** Removes the specified window state listener so that it no ... *//** Removes the specified window focus listener so that it no longer ... *//** Returns an array of all the window listeners ... *//** Returns an array of all the window focus listeners ... *//** Returns an array of all the window state listeners ... *//** Processes events on this window. If the event is an ... */processWindowEvent(...)processWindowFocusEvent(...)processWindowStateEvent(...)/** Processes window events occurring on this window by ... */WindowListener listener/** Processes window focus event occurring on this window by ... */WindowFocusListener listener/** Processes window state event occurring on this window by ... */WindowStateListener listener/** Implements a debugging hook -- checks to see if ... */isShiftDown(...)isControlDown(...)/** Sets whether this window should always be above other windows.  If ... */boolean oldAlwaysOnTopSecurityConstants.AWT.SET_WINDOW_ALWAYS_ON_TOP_PERMISSIONthis.alwaysOnTopisAlwaysOnTopSupported(...)updateAlwaysOnTopState(...)setOwnedWindowsAlwaysOnTop(...)WeakReference<Window>[] ownedWindowArraynew WeakReference<>[]WeakReference<Window> ref/** Returns whether the always-on-top mode is supported for this ... *//** Returns whether this window is an always-on-top window. ... *//** Returns the child Component of this Window that has focus if this Window ... *//** Returns the child Component of this Window that will receive the focus ... */Component mostRecent/** Returns whether this Window is active. Only a Frame or a Dialog may be ... *//** Returns whether this Window is focused. If there exists a focus owner, ... *//** Gets a focus traversal key for this Window. (See {@code ... */Set<> keystrokes/** Does nothing because Windows must always be roots of a focus traversal ... *//** Always returns {@code true} because all Windows must be roots of a ... *//** Always returns {@code null} because Windows have no ancestors; they ... *//** Returns whether this Window can become the focused Window, that is, ... */getFocusableWindowState(...)/** Returns whether this Window can become the focused Window if it meets ... *//** Sets whether this Window can become the focused Window if it meets ... */boolean oldFocusableWindowStatethis.focusableWindowState/** Sets whether this window should receive focus on ... */this.autoRequestFocus/** Returns whether this window should receive focus on subsequently being shown ... *//** Dispatches an event to this window or one of its sub components. ... *//** Checks if this Window is showing on screen. ... */applyResourceBundle(...)/* Support for tracking all windows owned by this window */child.parentchild.weakThischild.disposerRecordType type;/** Window type. ... *//** Sets the type of the window. ... *//** Returns the type of the window. ... */int windowSerializedDataVersion;/** The window serialized data version. ... */new FocusManager(...)focusMgr.focusRootfocusMgr.focusOwner// user's code.// Part of deserialization procedure to be called beforeaddWindowFocusListener(...)addWindowStateListener(...)/** Reads the {@code ObjectInputStream} and an optional ... */ModalExclusionType etboolean aotinitDeserializedWindow(...)setModalExclusionType(...)this.securityWarningWidththis.securityWarningHeightthis.securityWarningPointXthis.securityWarningPointYthis.securityWarningAlignmentXthis.securityWarningAlignmentYdeserializeResources(...)/** Gets the AccessibleContext associated with this Window. ... */new AccessibleAWTWindow(...)AccessibleRole.WINDOW// inner class AccessibleAWTWindow/** Sets the location of the window relative to the specified ... */Rectangle gcBoundsDimension windowSizeWindow componentWindowPoint centerPointgetCenterPoint(...)centerPoint.xwindowSize.widthcenterPoint.ywindowSize.heightgcBounds.xgcBounds.widthgcBounds.ygcBounds.heightDimension compSizePoint compLocationcompLocation.xcompSize.widthcompLocation.ycompSize.height/** Overridden from Component.  Top-level Windows should not propagate a ... *//** Overridden from Component.  Top-level Windows don't dispatch to ancestors *//** Returns the {@code BufferStrategy} used by this component.  This ... */Component previousComp/** Checks whether this window can contain focus owner. ... */boolean locationByPlatform;/** Sets whether this Window should appear at the default location for the ... */this.locationByPlatform/** Returns {@code true} if this Window will appear at the default location ... *//** Returns the opacity of the window. ... */// ******************** SHAPES & TRANSPARENCY CODE ********************/** Sets the opacity of the window. ... */GraphicsDevice.WindowTranslucency.TRANSLUCENTthis.opacity/** Returns the shape of the window. ... *//** Sets the shape of the window. ... */GraphicsDevice.WindowTranslucency.PERPIXEL_TRANSPARENTthis.shape/** Gets the background color of this window. ... *//** Sets the background color of this window. ... */Color oldBgint oldAlphaGraphicsConfiguration capableGCsetLayersOpaque(...)/** Indicates if the window is currently opaque. ... */Graphics ggAlphaComposite.SRCRootPaneContainer rpcJLayeredPane lpgetLayeredPane(...)Container cgetContentPane(...)JComponent contentint numChildren// A window has an owner, but it does NOT have a container/** Limit the given double value with the given range. *//** Calculate the position of the security warning. ... */double wxdouble wyGraphicsConfiguration graphicsConfigscreenInsets.rightscreenInsets.bottom// static/** This class is no longer used, but is maintained for Serialization ... */// class WindowContainer focusRoot;/* offset the initial location with the original of the screen *//* and any insets *//* reset after setLocation */// WindowDisposerRecord requires a proper value of parent field.// Always send a property change event// We don't use SplashScreen.getSplashScreen() to avoid instantiating// the object if it hasn't been requested by user code explicitly// fix for 6532736: after this window is shown, its blocker// should be raised to front// If first time shown, generate WindowOpened event// Check if this window is the fullscreen window for the// device. Exit the fullscreen mode prior to disposing// of the window if that's the case.// Execute outside the Runnable because postWindowEvent is// synchronized on (this). We don't need to synchronize the call// on the EventQueue anyways.// do nothing since parent == owner and we shouldn't// ajust counter on owner// make sure the privileged action is only// for getting the property! We don't want the// above checkPermission call to always succeed!// Recall that ownedWindowList is actually a Vector of// WeakReferences and calling get() on one of these references// may return null. Make two arrays-- one the size of the// Vector (fullCopy with size fullSize), and one the size of// all non-null get()s (realCopy with size realSize).// if we want on-fly changes, we need to uncomment the lines below//   and override the method in Dialog to use modalShow() instead//   of updateChildrenBlocking()/* if (isModalBlocked()) { ... */// Dump the list of child windows to System.out.// If a Window/Frame/Dialog was made non-focusable, then it is always// non-focusable.// All other tests apply only to Windows.// A Window must have at least one Component in its root focus// traversal cycle to be focusable.// A Window's nearest owning Frame or Dialog must be showing on the// screen.// this if statement should really be an assert, but we don't// have asserts...// synchronized block not required since removeElement is// already synchronized// Update old focusMgr fields so that our object stream can be read// by previous releases// Clear fields so that we don't keep extra references around//write icon array// Deserialized Windows are not yet visible.// Translate old-style focus tracking to new model. For 1.4 and// later releases, we'll rely on the Window's initial focusable// Component.// This field is non-transient and relies on default serialization.// However, the default value is insufficient, so we need to set// it explicitly for object data streams prior to 1.4.//read icons//Throws OptionalDataException//for pre1.6 objects.//Frame.readObject() assumes//pre1.6 version if icons is null.// 1.1 serialized form// ownedWindowList will be updated by Frame.readObject// Note: 1.4 (or later) doesn't use focusMgr// since 6.0// since 1.5; subject to permission check// target location// target GC// search a top-level of c// Adjust for bottom edge being offscreen// Avoid being placed off the edge of the screen:// Check that "component" is an acceptable focus owner and don't store it otherwise// - or later we will have problems with opposite while handling  WINDOW_GAINED_FOCUS// 5079694 fix: for a toplevel to be displayed, its parent doesn't have to be visible.// We're overriding isRecursivelyVisible to implement this policy.// non-opaque window// Shouldn't use instanceof to avoid loading Swing classes//    if it's a pure AWT application.// Iterate down one level to see whether we have a JApplet// (which is also a RootPaneContainer) which requires processing// It's OK to use instanceof here because we've// already loaded the RootPaneContainer class by now// The shape calculated by mixing code is not intended to be applied// to windows or frames// The position according to the spec of SecurityWarning.setPosition()// First, make sure the warning is not too far from the window bounds// Now make sure the warning window is visible on the screen// WindowAccessor/** This exception is thrown if the native CMM returns an error. *//** Constructs a CMMException with the specified detail message. ... *//* DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER. ... *//* Created by gbp, October 25, 1997 *//* ********************************************************************* ... */import PCMMimport CMSManager/** This abstract class is used to serve as a color space tag to identify the ... */...[] compName;ColorSpace sRGBspace;// Cache of singletons for the predefined color spaces.ColorSpace XYZspace;ColorSpace PYCCspace;ColorSpace GRAYspace;ColorSpace LINEAR_RGBspace;int TYPE_XYZ;/** Any of the family of XYZ color spaces. */int TYPE_Lab;/** Any of the family of Lab color spaces. */int TYPE_Luv;/** Any of the family of Luv color spaces. */int TYPE_YCbCr;/** Any of the family of YCbCr color spaces. */int TYPE_Yxy;/** Any of the family of Yxy color spaces. */int TYPE_RGB;/** Any of the family of RGB color spaces. */int TYPE_GRAY;/** Any of the family of GRAY color spaces. */int TYPE_HSV;/** Any of the family of HSV color spaces. */int TYPE_HLS;/** Any of the family of HLS color spaces. */int TYPE_CMYK;/** Any of the family of CMYK color spaces. */int TYPE_CMY;/** Any of the family of CMY color spaces. */int TYPE_2CLR;/** Generic 2 component color spaces. */int TYPE_3CLR;/** Generic 3 component color spaces. */int TYPE_4CLR;/** Generic 4 component color spaces. */int TYPE_5CLR;/** Generic 5 component color spaces. */int TYPE_6CLR;/** Generic 6 component color spaces. */int TYPE_7CLR;/** Generic 7 component color spaces. */int TYPE_8CLR;/** Generic 8 component color spaces. */int TYPE_9CLR;/** Generic 9 component color spaces. */int TYPE_ACLR;/** Generic 10 component color spaces. */int TYPE_BCLR;/** Generic 11 component color spaces. */int TYPE_CCLR;/** Generic 12 component color spaces. */int TYPE_DCLR;/** Generic 13 component color spaces. */int TYPE_ECLR;/** Generic 14 component color spaces. */int TYPE_FCLR;/** Generic 15 component color spaces. */int CS_sRGB;/** The sRGB color space defined at ... */int CS_LINEAR_RGB;/** A built-in linear RGB color space.  This space is based on the ... */int CS_CIEXYZ;/** The CIEXYZ conversion color space defined above. */int CS_PYCC;/** The Photo YCC conversion color space. */int CS_GRAY;/** The built-in linear gray scale color space. *//** Constructs a ColorSpace object given a color space type ... *//** Returns a ColorSpace representing one of the specific ... */ColorSpace theColorSpaceICC_Profile theProfileCMSManager.GRAYspaceCMSManager.LINEAR_RGBspace/** Returns true if the ColorSpace is CS_sRGB. ... *//** Transforms a color value assumed to be in this ColorSpace ... *//** Transforms a color value assumed to be in the default CS_sRGB ... *//** Transforms a color value assumed to be in the CS_CIEXYZ conversion ... *//** Returns the color space type of this ColorSpace (for example ... *//** Returns the number of components of this ColorSpace. ... *//** Returns the name of the component given the component index. ... */String[] tmpColorSpace.TYPE_XYZColorSpace.TYPE_LabColorSpace.TYPE_LuvColorSpace.TYPE_YxyColorSpace.TYPE_HSVColorSpace.TYPE_HLSColorSpace.TYPE_CMY/** Returns the minimum normalized color component value for the ... *//** Returns the maximum normalized color component value for the ... *//* Returns true if cspace is the XYZspace. *//* to allow access from java.awt.ColorModel *//* REMIND - make sure we know sRGBspace exists already *//* REMIND - handle common cases here */import ColorTransform/** The ICC_ColorSpace class is an implementation of the abstract ... */ICC_Profile thisProfile;...[] minVal;...[] maxVal;...[] diffMinMax;...[] invDiffMinMax;boolean needScaleInit;ColorTransform this2srgb;// {to,from}{RGB,CIEXYZ} methods create and cache these when neededColorTransform srgb2this;ColorTransform this2xyz;ColorTransform xyz2this;/** Constructs a new ICC_ColorSpace from an ICC_Profile object. ... */int profileClassgetProfileClass(...)getColorSpaceType(...)ICC_Profile.CLASS_INPUTICC_Profile.CLASS_DISPLAYICC_Profile.CLASS_OUTPUTICC_Profile.CLASS_COLORSPACECONVERSIONICC_Profile.CLASS_NAMEDCOLORICC_Profile.CLASS_ABSTRACTsetMinMax(...)/** Returns the ICC_Profile for this ICC_ColorSpace. ... */short[] tmpfloat[] resultColorTransform[] transformListnew ColorTransform[]ICC_ColorSpace srgbCSPCMM mdlgetModule(...)createTransform(...)ColorTransform.AnyColorTransform.InColorTransform.OutsetComponentScaling(...)colorConvert(...)float ALMOST_TWOICC_ColorSpace xyzCSICC_Profile.icRelativeColorimetricgetMinValue(...)getMaxValue(...)/* REMIND - is NAMEDCOLOR OK? */// For CIEXYZ, min = 0.0, max = ALMOST_TWO for all components// L// a// b// X, Y, Z// in case getMinVal is overridden// in case getMaxVal is overriddenimport Profileimport ProfileDataVerifierimport ProfileDeferralMgrimport ProfileDeferralInfoimport ProfileActivator/** A representation of color profile data for device independent and ... */Profile cmmProfile;ProfileDeferralInfo deferralInfo;ProfileActivator profileActivator;ICC_Profile sRGBprofile;// getInstance(int cspace) factory method.// defined in the ColorSpace class (e.g. CS_sRGB), see// Registry of singleton profile objects for specific color spacesICC_Profile XYZprofile;ICC_Profile PYCCprofile;ICC_Profile GRAYprofile;ICC_Profile LINEAR_RGBprofile;int CLASS_INPUT;/** Profile class is input. */int CLASS_DISPLAY;/** Profile class is display. */int CLASS_OUTPUT;/** Profile class is output. */int CLASS_DEVICELINK;/** Profile class is device link. */int CLASS_COLORSPACECONVERSION;/** Profile class is color space conversion. */int CLASS_ABSTRACT;/** Profile class is abstract. */int CLASS_NAMEDCOLOR;/** Profile class is named color. */int icSigXYZData;/** ICC Profile Color Space Type Signature: 'XYZ '. */int icSigLabData;/** ICC Profile Color Space Type Signature: 'Lab '. *//* 'XYZ ' */int icSigLuvData;/** ICC Profile Color Space Type Signature: 'Luv '. *//* 'Lab ' */int icSigYCbCrData;/** ICC Profile Color Space Type Signature: 'YCbr'. *//* 'Luv ' */int icSigYxyData;/** ICC Profile Color Space Type Signature: 'Yxy '. *//* 'YCbr' */int icSigRgbData;/** ICC Profile Color Space Type Signature: 'RGB '. *//* 'Yxy ' */int icSigGrayData;/** ICC Profile Color Space Type Signature: 'GRAY'. *//* 'RGB ' */int icSigHsvData;/** ICC Profile Color Space Type Signature: 'HSV'. *//* 'GRAY' */int icSigHlsData;/** ICC Profile Color Space Type Signature: 'HLS'. *//* 'HSV ' */int icSigCmykData;/** ICC Profile Color Space Type Signature: 'CMYK'. *//* 'HLS ' */int icSigCmyData;/** ICC Profile Color Space Type Signature: 'CMY '. *//* 'CMYK' */int icSigSpace2CLR;/** ICC Profile Color Space Type Signature: '2CLR'. *//* 'CMY ' */int icSigSpace3CLR;/** ICC Profile Color Space Type Signature: '3CLR'. *//* '2CLR' */int icSigSpace4CLR;/** ICC Profile Color Space Type Signature: '4CLR'. *//* '3CLR' */int icSigSpace5CLR;/** ICC Profile Color Space Type Signature: '5CLR'. *//* '4CLR' */int icSigSpace6CLR;/** ICC Profile Color Space Type Signature: '6CLR'. *//* '5CLR' */int icSigSpace7CLR;/** ICC Profile Color Space Type Signature: '7CLR'. *//* '6CLR' */int icSigSpace8CLR;/** ICC Profile Color Space Type Signature: '8CLR'. *//* '7CLR' */int icSigSpace9CLR;/** ICC Profile Color Space Type Signature: '9CLR'. *//* '8CLR' */int icSigSpaceACLR;/** ICC Profile Color Space Type Signature: 'ACLR'. *//* '9CLR' */int icSigSpaceBCLR;/** ICC Profile Color Space Type Signature: 'BCLR'. *//* 'ACLR' */int icSigSpaceCCLR;/** ICC Profile Color Space Type Signature: 'CCLR'. *//* 'BCLR' */int icSigSpaceDCLR;/** ICC Profile Color Space Type Signature: 'DCLR'. *//* 'CCLR' */int icSigSpaceECLR;/** ICC Profile Color Space Type Signature: 'ECLR'. *//* 'DCLR' */int icSigSpaceFCLR;/** ICC Profile Color Space Type Signature: 'FCLR'. *//* 'ECLR' */int icSigInputClass;/** ICC Profile Class Signature: 'scnr'. *//* 'FCLR' */int icSigDisplayClass;/** ICC Profile Class Signature: 'mntr'. *//* 'scnr' */int icSigOutputClass;/** ICC Profile Class Signature: 'prtr'. *//* 'mntr' */int icSigLinkClass;/** ICC Profile Class Signature: 'link'. *//* 'prtr' */int icSigAbstractClass;/** ICC Profile Class Signature: 'abst'. *//* 'link' */int icSigColorSpaceClass;/** ICC Profile Class Signature: 'spac'. *//* 'abst' */int icSigNamedColorClass;/** ICC Profile Class Signature: 'nmcl'. *//* 'spac' */int icPerceptual;/** ICC Profile Rendering Intent: Perceptual. *//* 'nmcl' */int icRelativeColorimetric;/** ICC Profile Rendering Intent: RelativeColorimetric. */int icMediaRelativeColorimetric;/** ICC Profile Rendering Intent: Media-RelativeColorimetric. ... */int icSaturation;/** ICC Profile Rendering Intent: Saturation. */int icAbsoluteColorimetric;/** ICC Profile Rendering Intent: AbsoluteColorimetric. */int icICCAbsoluteColorimetric;/** ICC Profile Rendering Intent: ICC-AbsoluteColorimetric. ... */int icSigHead;/** ICC Profile Tag Signature: 'head' - special. */int icSigAToB0Tag;/** ICC Profile Tag Signature: 'A2B0'. *//* 'head' - special */int icSigAToB1Tag;/** ICC Profile Tag Signature: 'A2B1'. *//* 'A2B0' */int icSigAToB2Tag;/** ICC Profile Tag Signature: 'A2B2'. *//* 'A2B1' */int icSigBlueColorantTag;/** ICC Profile Tag Signature: 'bXYZ'. *//* 'A2B2' */int icSigBlueMatrixColumnTag;/** ICC Profile Tag Signature: 'bXYZ'. ... *//* 'bXYZ' */int icSigBlueTRCTag;/** ICC Profile Tag Signature: 'bTRC'. */int icSigBToA0Tag;/** ICC Profile Tag Signature: 'B2A0'. *//* 'bTRC' */int icSigBToA1Tag;/** ICC Profile Tag Signature: 'B2A1'. *//* 'B2A0' */int icSigBToA2Tag;/** ICC Profile Tag Signature: 'B2A2'. *//* 'B2A1' */int icSigCalibrationDateTimeTag;/** ICC Profile Tag Signature: 'calt'. *//* 'B2A2' */int icSigCharTargetTag;/** ICC Profile Tag Signature: 'targ'. *//* 'calt' */int icSigCopyrightTag;/** ICC Profile Tag Signature: 'cprt'. *//* 'targ' */int icSigCrdInfoTag;/** ICC Profile Tag Signature: 'crdi'. *//* 'cprt' */int icSigDeviceMfgDescTag;/** ICC Profile Tag Signature: 'dmnd'. *//* 'crdi' */int icSigDeviceModelDescTag;/** ICC Profile Tag Signature: 'dmdd'. *//* 'dmnd' */int icSigDeviceSettingsTag;/** ICC Profile Tag Signature: 'devs'. *//* 'dmdd' */int icSigGamutTag;/** ICC Profile Tag Signature: 'gamt'. *//* 'devs' */int icSigGrayTRCTag;/** ICC Profile Tag Signature: 'kTRC'. *//* 'gamt' */int icSigGreenColorantTag;/** ICC Profile Tag Signature: 'gXYZ'. *//* 'kTRC' */int icSigGreenMatrixColumnTag;/** ICC Profile Tag Signature: 'gXYZ'. ... *//* 'gXYZ' */int icSigGreenTRCTag;/** ICC Profile Tag Signature: 'gTRC'. */int icSigLuminanceTag;/** ICC Profile Tag Signature: 'lumi'. *//* 'gTRC' */int icSigMeasurementTag;/** ICC Profile Tag Signature: 'meas'. *//* 'lumi' */int icSigMediaBlackPointTag;/** ICC Profile Tag Signature: 'bkpt'. *//* 'meas' */int icSigMediaWhitePointTag;/** ICC Profile Tag Signature: 'wtpt'. *//* 'bkpt' */int icSigNamedColor2Tag;/** ICC Profile Tag Signature: 'ncl2'. *//* 'wtpt' */int icSigOutputResponseTag;/** ICC Profile Tag Signature: 'resp'. *//* 'ncl2' */int icSigPreview0Tag;/** ICC Profile Tag Signature: 'pre0'. *//* 'resp' */int icSigPreview1Tag;/** ICC Profile Tag Signature: 'pre1'. *//* 'pre0' */int icSigPreview2Tag;/** ICC Profile Tag Signature: 'pre2'. *//* 'pre1' */int icSigProfileDescriptionTag;/** ICC Profile Tag Signature: 'desc'. *//* 'pre2' */int icSigProfileSequenceDescTag;/** ICC Profile Tag Signature: 'pseq'. *//* 'desc' */int icSigPs2CRD0Tag;/** ICC Profile Tag Signature: 'psd0'. *//* 'pseq' */int icSigPs2CRD1Tag;/** ICC Profile Tag Signature: 'psd1'. *//* 'psd0' */int icSigPs2CRD2Tag;/** ICC Profile Tag Signature: 'psd2'. *//* 'psd1' */int icSigPs2CRD3Tag;/** ICC Profile Tag Signature: 'psd3'. *//* 'psd2' */int icSigPs2CSATag;/** ICC Profile Tag Signature: 'ps2s'. *//* 'psd3' */int icSigPs2RenderingIntentTag;/** ICC Profile Tag Signature: 'ps2i'. *//* 'ps2s' */int icSigRedColorantTag;/** ICC Profile Tag Signature: 'rXYZ'. *//* 'ps2i' */int icSigRedMatrixColumnTag;/** ICC Profile Tag Signature: 'rXYZ'. ... *//* 'rXYZ' */int icSigRedTRCTag;/** ICC Profile Tag Signature: 'rTRC'. */int icSigScreeningDescTag;/** ICC Profile Tag Signature: 'scrd'. *//* 'rTRC' */int icSigScreeningTag;/** ICC Profile Tag Signature: 'scrn'. *//* 'scrd' */int icSigTechnologyTag;/** ICC Profile Tag Signature: 'tech'. *//* 'scrn' */int icSigUcrBgTag;/** ICC Profile Tag Signature: 'bfd '. *//* 'tech' */int icSigViewingCondDescTag;/** ICC Profile Tag Signature: 'vued'. *//* 'bfd ' */int icSigViewingConditionsTag;/** ICC Profile Tag Signature: 'view'. *//* 'vued' */int icSigChromaticityTag;/** ICC Profile Tag Signature: 'chrm'. *//* 'view' */int icSigChromaticAdaptationTag;/** ICC Profile Tag Signature: 'chad'. ... *//* 'chrm' */int icSigColorantOrderTag;/** ICC Profile Tag Signature: 'clro'. ... *//* 'chad' */int icSigColorantTableTag;/** ICC Profile Tag Signature: 'clrt'. ... *//* 'clro' */int icHdrSize;/** ICC Profile Header Location: profile size in bytes. *//* 'clrt' */int icHdrCmmId;/** ICC Profile Header Location: CMM for this profile. *//* Profile size in bytes */int icHdrVersion;/** ICC Profile Header Location: format version number. *//* CMM for this profile */int icHdrDeviceClass;/** ICC Profile Header Location: type of profile. *//* Format version number */int icHdrColorSpace;/** ICC Profile Header Location: color space of data. *//* Type of profile */int icHdrPcs;/** ICC Profile Header Location: PCS - XYZ or Lab only. *//* Color space of data */int icHdrDate;/** ICC Profile Header Location: date profile was created. *//* PCS - XYZ or Lab only */int icHdrMagic;/** ICC Profile Header Location: icMagicNumber. *//* Date profile was created */int icHdrPlatform;/** ICC Profile Header Location: primary platform. *//* icMagicNumber */int icHdrFlags;/** ICC Profile Header Location: various bit settings. *//* Primary Platform */int icHdrManufacturer;/** ICC Profile Header Location: device manufacturer. *//* Various bit settings */int icHdrModel;/** ICC Profile Header Location: device model number. *//* Device manufacturer */int icHdrAttributes;/** ICC Profile Header Location: device attributes. *//* Device model number */int icHdrRenderingIntent;/** ICC Profile Header Location: rendering intent. *//* Device attributes */int icHdrIlluminant;/** ICC Profile Header Location: profile illuminant. *//* Rendering intent */int icHdrCreator;/** ICC Profile Header Location: profile creator. *//* Profile illuminant */int icHdrProfileID;/** ICC Profile Header Location: profile's ID. ... *//* Profile creator */int icTagType;/** ICC Profile Constant: tag type signaturE. *//* Profile's ID */int icTagReserved;/** ICC Profile Constant: reserved. *//* tag type signature */int icCurveCount;/** ICC Profile Constant: curveType count. *//* reserved */int icCurveData;/** ICC Profile Constant: curveType data. *//* curveType count */int icXYZNumberX;/** ICC Profile Constant: XYZNumber X. *//* curveType data *//** Constructs an ICC_Profile object with a given ID. *//* XYZNumber X */this.cmmProfile/** Constructs an ICC_Profile object whose loading will be deferred. ... */this.deferralInfothis.profileActivatoractivateDeferredProfile(...)registerDeferral(...)/** Frees the resources associated with an ICC_Profile object. */freeProfile(...)unregisterDeferral(...)/** Constructs an ICC_Profile object corresponding to the data in ... */ICC_Profile thisProfileProfile pProfileDeferralMgr.deferringactivateProfiles(...)loadProfile(...)CMMException cnew ICC_ProfileGray(...)new ICC_ProfileRGB(...)new ICC_Profile(...)/** Constructs an ICC_Profile corresponding to one of the specific color ... */ProfileDeferralInfo pInfonew ProfileDeferralInfo(...)getDeferredInstance(...)standardProfileExists(...)/* This asserts system privileges, so is used only for the ... */ICC_Profile p/** Constructs an ICC_Profile corresponding to the data in a file. ... */getProfileFile(...)/** Constructs an ICC_Profile corresponding to the data in an InputStream. ... */getProfileDataFromStream(...)int bytestoread/** Constructs an ICC_Profile for which the actual loading of the ... */getStandardProfile(...)pdi.filenamepdi.colorSpaceTypedeferralInfo.filenamePrivilegedAction<FileInputStream> pagetStandardProfileFile(...)new ProfileDataException(...)ProfileDataException pde/** Returns profile major version. ... */byte[] theHeader/** Returns profile minor version. ... *//** Returns the profile class. ... */int theClassSigint theClassdeferralInfo.profileClassintFromBigEndian(...)/** Returns the color space type.  Returns one of the color space type ... */deferralInfo.colorSpaceTypeint theColorSpaceSigint theColorSpaceiccCStoJCS(...)/** Returns the color space type of the Profile Connection Space (PCS). ... */getPCSType(...)int thePCSSigint thePCS/** Write this ICC_Profile to a file. ... */FileOutputStream outputFile/** Write this ICC_Profile to an OutputStream. ... *//** Returns a byte array corresponding to the data of this ICC_Profile. ... */getProfileSize(...)getProfileData(...)/** Returns a particular tagged data element from the profile as ... */int tagSizebyte[] tagDatagetTagSize(...)getTagData(...)/** Sets a particular tagged data element in the profile from ... */setTagData(...)/** Sets the rendering intent of the profile. ... */intToBigEndian(...)/** Returns the rendering intent of the profile. ... */int renderingIntent/** Returns the number of color components in the "input" color ... */int theNumComponentsdeferralInfo.numComponents/** Returns a float array of length 3 containing the X, Y, and Z ... */getXYZTag(...)byte[] theDatafloat[] theXYZNumberint theS15Fixed16/** Returns a gamma value representing a tone reproduction ... */byte[] theTRCDatafloat theGammaint theU8Fixed8shortFromBigEndian(...)/** Returns the TRC as an array of shorts.  If the profile has ... */short[] theTRCint nElements/* convert an ICC color space signature into a Java color space type */ColorSpace.TYPE_2CLRColorSpace.TYPE_4CLRColorSpace.TYPE_5CLRColorSpace.TYPE_6CLRColorSpace.TYPE_7CLRColorSpace.TYPE_8CLRColorSpace.TYPE_9CLRColorSpace.TYPE_ACLRColorSpace.TYPE_BCLRColorSpace.TYPE_CCLRColorSpace.TYPE_DCLRColorSpace.TYPE_ECLRColorSpace.TYPE_FCLR/* fileName may be an absolute or a relative file specification. ... */String dirString fullPathisAbsolute(...)isChildOf(...)/** Returns a file object corresponding to a built-in profile ... *//** Checks whether given file resides inside give directory. */String canonicalDirNameString canonicalFileName/** Checks whether built-in profile specified by fileName exists. */int iccProfileSerializedDataVersion;/** Version of the format of additional serialized data in the ... *//* Serialization support. ... *//** Writes default serializable fields to the stream.  Writes a ... */ICC_Profile resolvedDeserializedProfile;// (obtained with getInstance) for readResolve to return.// Temporary storage used by readObject to store resolved profile/** Reads default serializable fields from the stream.  Reads from ... */int cspaceboolean isKnownPredefinedCS/** Resolves instances being deserialized into instances registered ... *//* Deferral is only used for standard profiles. ... *//* close the file *//* hack to detect profiles whose loading can be deferred *//* not a valid profile *//* getData will activate deferred ... *//* Need to have this info for ... *//* this will activate deferred ... *//* get the number of bytes needed for this profile *//* get the data for the profile *//* get the number of bytes needed for this tag *//* get an array for the tag *//* get the tag's data *//* set the rendering intent *//* According to ICC spec, only the least-significant 16 bits shall be ... *//* get the media white point tag *//* get the tag data *//* array to return *//* convert s15Fixed16Number to float *//* get the TRC *//* convert u8Fixed8 to float *//* make the short array *//* try absolute file name *//* Rest of code has little sense for an absolute pathname, ... *//* try relative to java.iccprofile.path *//* try relative to java.class.path *//* try the directory of built-in profiles *//* we do not expect the IOException here, because invocation ... */// Future versions may choose to write profile data for new// predefined color spaces as well, if any will be introduced,// so that old versions that don't recognize the new CS name// may fall back to constructing profile from the data.// getData will activate deferred profile if necessary// ColorSpace.CS_* constant if known/** A subclass of the ICC_Profile class which represents profiles ... *//** Constructs a new ICC_ProfileGray from a CMM ID. *//** Constructs a new ICC_ProfileGray from a ProfileDeferralInfo object. */getMediaWhitePoint(...)/** Returns a gamma value representing the tone reproduction ... */getGamma(...)ICC_Profile.icSigGrayTRCTaggetTRC(...)/** The ICC_ProfileRGB class is a subclass of the ICC_Profile class ... */int REDCOMPONENT;/** Used to get a gamma value or TRC for the red component. */int GREENCOMPONENT;/** Used to get a gamma value or TRC for the green component. */int BLUECOMPONENT;/** Used to get a gamma value or TRC for the blue component. *//** Constructs an new <code>ICC_ProfileRGB</code> from a CMM ID. ... *//** Constructs a new <code>ICC_ProfileRGB</code> from a ... *//** Returns an array that contains the components of the profile's ... *//** Returns a 3x3 <CODE>float</CODE> matrix constructed from the ... */float[][] theMatrixfloat[] tmpMatrixICC_Profile.icSigRedColorantTagICC_Profile.icSigGreenColorantTagICC_Profile.icSigBlueColorantTag/** Returns a gamma value representing the tone reproduction curve ... */int theSignatureICC_Profile.icSigRedTRCTagICC_Profile.icSigGreenTRCTagICC_Profile.icSigBlueTRCTag/** Returns the TRC for a particular component as an array. ... *//** This exception is thrown when an error occurs in accessing or ... *//** Constructs a ProfileDataException with the specified detail message. ... */import EventListenerAggregate/** A class that implements a mechanism to transfer data using ... */ClipboardOwner owner;Transferable contents;EventListenerAggregate flavorListeners;/** An aggregate of flavor listeners registered on this local clipboard. ... */Set<DataFlavor> currentDataFlavors;/** A set of <code>DataFlavor</code>s that is available on ... *//** Creates a clipboard object. ... *//** Returns the name of this clipboard object. ... *//** Sets the current contents of the clipboard to the specified ... */ClipboardOwner oldOwnerTransferable oldContentsthis.contentslostOwnership(...)Clipboard.thisfireFlavorsChanged(...)/** Returns a transferable object representing the current contents ... *//** Returns an array of <code>DataFlavor</code>s in which the current ... */Transferable cntntsnew DataFlavor[]getTransferDataFlavors(...)/** Returns whether or not the current contents of this clipboard can be ... */isDataFlavorSupported(...)/** Returns an object representing the current contents of this clipboard ... */new UnsupportedFlavorException(...)getTransferData(...)/** Registers the specified <code>FlavorListener</code> to receive ... */getAvailableDataFlavorSet(...)new EventListenerAggregate(...)/** Removes the specified <code>FlavorListener</code> so that it no longer ... *//** Returns an array of all the <code>FlavorListener</code>s currently ... */new FlavorListener[]getListenersCopy(...)/** Checks change of the <code>DataFlavor</code>s and, if necessary, ... */Set<DataFlavor> prevDataFlavorsFlavorListener[] flavorListenerArraygetListenersInternal(...)flavorListenerArray.lengthFlavorListener listenerflavorsChanged(...)new FlavorEvent(...)/** Returns a set of <code>DataFlavor</code>s currently available ... */Set<DataFlavor> setnew HashSet<DataFlavor>(...)Transferable contentsDataFlavor[] flavors/** Defines the interface for classes that will provide data to ... *//** Notifies this object that it is no longer the clipboard owner. ... *//* Copyright (c) 1996, 2002, Oracle and/or its affiliates. All rights reserved. ... */import DataTransfererimport CharArrayReaderimport Externalizableimport static SecurityConstants.GET_CLASSLOADER_PERMISSION/** A {@code DataFlavor} provides meta information about data. {@code DataFlavor} ... */createConstant(...)initHtmlDataFlavor(...)Class<InputStream> ioInputStreamClass;/** Tries to load a class from: the bootstrap loader, the system loader, ... *//* private initializer */new DataFlavor(...)DataFlavor stringFlavor;/** The <code>DataFlavor</code> representing a Java Unicode String class, ... */DataFlavor imageFlavor;/** The <code>DataFlavor</code> representing a Java Image class, ... */DataFlavor plainTextFlavor;/** The <code>DataFlavor</code> representing plain text with Unicode ... */String javaSerializedObjectMimeType;/** A MIME Content-Type of application/x-java-serialized-object represents ... */DataFlavor javaFileListFlavor;/** To transfer a list of files to/from Java (and the underlying ... */String javaJVMLocalObjectMimeType;/** To transfer a reference to an arbitrary Java object reference that ... */String javaRemoteObjectMimeType;/** In order to pass a live link to a Remote object via a Drag and Drop ... */DataFlavor selectionHtmlFlavor;/** Represents a piece of an HTML markup. The markup consists of the part ... */DataFlavor fragmentHtmlFlavor;/** Represents a piece of an HTML markup. If possible, the markup received ... */DataFlavor allHtmlFlavor;/** Represents a piece of an HTML markup. If possible, the markup ... *//** Constructs a new <code>DataFlavor</code>.  This constructor is ... *//** Constructs a fully specified <code>DataFlavor</code>. ... */new MimeTypeParameterList(...)new MimeType(...)MimeTypeParseException mtpethis.representationClassthis.humanPresentableNameremoveParameter(...)/** Constructs a <code>DataFlavor</code> that represents a Java class. ... *//** Constructs a <code>DataFlavor</code> that represents a ... *//** Constructs a <code>DataFlavor</code> from a <code>mimeType</code> string. ... *//** Common initialization code called from various constructors. ... */String rcngetBaseType(...)tryToLoadClass(...)getSubType(...)getPrimaryType(...)/** String representation of this <code>DataFlavor</code> and its ... */isFlavorCharsetTextType(...)isRepresentationClassInputStream(...)isRepresentationClassByteBuffer(...)getTextCharset(...)/** Returns a <code>DataFlavor</code> representing plain text with Unicode ... */String encodingDataTransferer transferergetDefaultUnicodeEncoding(...)/** Selects the best text <code>DataFlavor</code> from an array of <code> ... */DataFlavor bestFlavoravailableFlavors.lengthnew TextFlavorComparator(...)isFlavorTextType(...)Comparator<DataFlavor> textFlavorComparator;DataTransferer.DataFlavorComparator/** Compares two <code>DataFlavor</code> objects. Returns a negative ... */DataFlavor flavor1DataFlavor flavor2/** Gets a Reader for a text flavor, decoded, if necessary, for the expected ... */Object transferObjectCharBuffer buffernew CharArrayReader(...)ByteBuffer buffer/** Returns the MIME type string for this <code>DataFlavor</code>. ... *//** Returns the <code>Class</code> which objects supporting this ... *//** Returns the human presentable name for the data format that this ... *//** Returns the primary MIME type for this <code>DataFlavor</code>. ... *//** Returns the sub MIME type of this <code>DataFlavor</code>. ... *//** Returns the human presentable name for this <code>DataFlavor</code> ... *//** Sets the human presentable name for the data format that this ... *//** This method has the same behavior as {@link #equals(Object)}. ... */getRepresentationClass(...)that.mimeTypedoesSubtypeSupportCharset(...)isStandardTextRepresentationClass(...)String thisCharsetcanonicalName(...)String thatCharsetString thisDocumentString thatDocument/** Compares only the <code>mimeType</code> against the passed in ... */isMimeTypeEqual(...)/** Returns hash code for this <code>DataFlavor</code>. ... */String primaryTypeString charsetString document/** Identical to {@link #equals(DataFlavor)}. ... *//** Returns whether the string representation of the MIME type passed in ... *//** Compares the <code>mimeType</code> of two <code>DataFlavor</code> ... */dataFlavor.mimeType/** Checks if the representation class is one of the standard text ... */isRepresentationClassCharBuffer(...)isRepresentationClassReader(...)/** Does the <code>DataFlavor</code> represent a serialized object? */getDefaultRepresentationClass(...)/** Does the <code>DataFlavor</code> represent a ... *//** Returns whether the representation class for this ... *//** Returns true if the representation class can be serialized. ... *//** Returns true if the representation class is <code>Remote</code>. ... */isRemote(...)/** Returns true if the <code>DataFlavor</code> specified represents ... */isRepresentationClassSerializable(...)isRepresentationClassRemote(...)javaFileListFlavor.mimeType/** Returns whether this <code>DataFlavor</code> is a valid text flavor for ... */isFlavorNoncharsetTextType(...)/** Serializes this <code>DataFlavor</code>. *//** Restores this <code>DataFlavor</code> from a Serialized state. */OptionalDataException odeode.eofode.length/** Returns a clone of this <code>DataFlavor</code>. ... */Object newObj(...).mimeType/** Called on <code>DataFlavor</code> for every MIME Type parameter ... *//** Called for each MIME type string to give <code>DataFlavor</code> subtypes ... */int atom;/* placeholder for caching any platform-specific data for flavor *//* fields */MimeType mimeType;/* Mime Type of DataFlavor */String humanPresentableName;Class<?> representationClass;/** Java class of objects this DataFlavor represents * */// bootstrap class loader and system class loader if present// thread context class loader if and only if present// fallback to user's class loader// ignore secured class loaders// throws// got a class name// set it.// Do not add subType.hashCode() to the total. equals uses// MimeType.match which reports a match if one or both of the// subTypes is '*', regardless of the other subType.// JCK Test DataFlavor0117: if 'mimeType' is null, throw NPE// Ensure backward compatibility.// Old versions didn't write the representation class to the stream.// class DataFlavor/** <code>FlavorEvent</code> is used to notify interested parties ... *//** Constructs a <code>FlavorEvent</code> object. ... *//** Defines an object which listens for {@link FlavorEvent}s. ... *//** Invoked when the target {@link Clipboard} of the listener ... *//** A two-way Map between "natives" (Strings), which correspond to platform- ... *//** Returns a <code>Map</code> of the specified <code>DataFlavor</code>s to ... *//** Returns a <code>Map</code> of the specified <code>String</code> natives ... *//** A FlavorMap which relaxes the traditional 1-to-1 restriction of a Map. A ... *//** Returns a <code>List</code> of <code>String</code> natives to which the ... *//** Returns a <code>List</code> of <code>DataFlavor</code>s to which the ... *//** A Multipurpose Internet Mail Extension (MIME) type, as defined ... *//* serialization support *//** Constructor for externalization; this constructor should not be ... *//** Builds a <code>MimeType</code> from a <code>String</code>. ... *//** Builds a <code>MimeType</code> with the given primary and sub ... *//** Builds a <code>MimeType</code> with a pre-defined ... */isValidToken(...)new MimeTypeParseException(...)/** <code>MimeType</code>s are equal if their primary types, ... */// hashCode()MimeType thatboolean isItthis.primaryTypethat.primaryTypethis.subTypethat.subTypethis.parametersthat.parameters/** A routine for parsing the MIME type out of a String. ... */// equals()int slashIndexint semIndex/** Retrieve the primary type of this object. *//** Retrieve the sub type of this object. *//** Retrieve a copy of this object's parameter list. *//** Retrieve the value associated with the given name, or null if there ... *//** Set the value to be associated with the given name, replacing ... *//** Remove any value associated with the given name. ... *//** Return the String representation of this object. *//** Return a String representation of this object ... *//** Returns <code>true</code> if the primary type and the ... *//** The object implements the writeExternal method to save its contents ... *//** The object implements the readExternal method to restore its ... */byte[] baMimeTypeParseException e/** Returns a clone of this object. ... */MimeType newObjCloneNotSupportedException cannotHappennewObj.parametersString primaryType;String subType;MimeTypeParameterList parameters;/** Determines whether or not a given character belongs to a legal token. *///    below here be scary parsing related things/** Determines whether or not a given string is a legal token. ... */isTokenChar(...)String TSPECIALS;/** A string that holds all the special chars. *///    check to see if primary is valid//    check to see if sub is valid// We sum up the hash codes for all of the strings. This// way, the order of the strings is irrelevant//    neither character is present, so treat it//    as an error//    we have a ';' (and therefore a parameter list),//    but no '/' indicating a sub type is present//    we have a primary and sub type but no parameter list//    we have all three items in the proper sequence//    we have a ';' lexically before a '/' which means we have a primary type//    & a parameter list but no sub type//    now validate the primary and sub types// contains ASCII chars only// one-to-one correspondence between ASCII char and byte in UTF string// 65535 is max length of UTF string// long mime type// class MimeType/** An object that encapsulates the parameter list of a MimeType ... *//** Two parameter lists are considered equal if they have exactly ... */MimeTypeParameterList thatString thisValueString thatValueSet<Entry<String,String>> entriesIterator<Entry<String,String>> iterator/** A routine for parsing the parameter list out of a String. */char currentCharboolean founditunquote(...)/** return the number of name-value pairs in this list. *//** Determine whether or not this list is empty. *//** Remove any value associated with the given name. *//** Retrieve an enumeration of all the names in this list. */StringBuilder bufferEnumeration<String> keysMimeTypeParameterList newObjHashtable<String,String> parameters;/** Determine whether or not a given character belongs to a legal token. *//** return the index of the first non white space character in ... *//** A routine that knows how and when to quote and escape the given value. */boolean needsQuotes/** A routine that knows how to strip the quotes and escape sequences from the given value. */int valueLength//    now parse rawdata// "random" value for empty lists//System.out.println("MimeTypeParameterList.equals("+this+","+thatObject+")");// both null -> equal, only one null -> not equal// while iterator//    eat the ';'//    now parse the parameter name//    skip whitespace//    find the end of the token char run//    now parse the '=' that separates the name from the value//    eat it and parse the parameter value//    now find out whether or not we have a quoted value//    yup it's quoted so eat it and capture the quoted string//    find the next unescqped quote//    found an escape sequence so pass this and the next character//    foundit!//    eat the quote//    nope it's an ordinary token so it ends with a non-token char//    it ain't a value//    now put the data into the hashtable//    setup the next iteration// Heuristic: 8 characters per field//    check to see if we actually have to quote this thing//    add the initial quote//    add the properly escaped text//    add the closing quote/** A class to encapsulate MimeType parsing related exceptions ... */// use serialVersionUID from JDK 1.2.2 for interoperability/** Constructs a MimeTypeParseException with no specified detail message. *//** Constructs a MimeTypeParseException with the specified detail message. ... */// class MimeTypeParseException/** A <code>Transferable</code> which implements the capability required ... */DataFlavor.stringFlavorDataFlavor.plainTextFlavorint PLAIN_TEXT;...[] flavors;String data;/** Creates a <code>Transferable</code> capable of transferring ... *//** Returns an array of flavors in which this <code>Transferable</code> ... *//** Returns whether the requested flavor is supported by this ... */flavors.length/** Returns the <code>Transferable</code>'s data in the requested ... */// returning flavors itself would allow client code to modify// our internal behavior// JCK Test StringSelection0003: if 'flavor' is null, throw NPE// JCK Test StringSelection0007: if 'flavor' is null, throw NPE/** The SystemFlavorMap is a configurable map between "natives" (Strings), which ... */new HashMap<String,LinkedHashSet<DataFlavor>>(...)new HashMap<DataFlavor,LinkedHashSet<String>>(...)new HashMap<String,LinkedHashSet<String>>(...)new SoftCache<DataFlavor,String>(...)new SoftCache<String,DataFlavor>(...)new HashSet<Object>(...)String JavaMIME;/** Constant prefix used to tag Java types converted to native platform ... */Object FLAVOR_MAP_KEY;String keyValueSeparators;/** Copied from java.util.Properties. */String strictKeyValueSeparators;String whiteSpaceChars;...[] UNICODE_TEXT_CLASSES;/** The list of valid, decoded text flavor representation classes, in order ... */...[] ENCODED_TEXT_CLASSES;/** The list of valid, encoded text flavor representation classes, in order ... */String TEXT_PLAIN_BASE_TYPE;/** A String representing text/plain MIME type. */String HTML_TEXT_BASE_TYPE;/** A String representing text/html MIME type. */Map<String,LinkedHashSet<DataFlavor>> nativeToFlavor;/** Maps native Strings to Lists of DataFlavors (or base type Strings for ... *//** Accessor to nativeToFlavor map.  Since we use lazy initialization we must ... */initSystemFlavorMap(...)Map<DataFlavor,LinkedHashSet<String>> flavorToNative;/** Maps DataFlavors (or base type Strings for text DataFlavors) to Lists of ... *//** Accessor to flavorToNative map.  Since we use lazy initialization we must ... */Map<String,LinkedHashSet<String>> textTypeToNative;/** Maps a text DataFlavor primary mime-type to the native. Used only to store ... */boolean isMapInitialized;/** Shows if the object has been initialized. *//** An accessor to textTypeToNative map.  Since we use lazy initialization we ... */SoftCache<DataFlavor,String> nativesForFlavorCache;/** Caches the result of getNativesForFlavor(). Maps DataFlavors to ... */SoftCache<String,DataFlavor> flavorsForNativeCache;/** Caches the result getFlavorsForNative(). Maps String natives to ... */Set<Object> disabledMappingGenerationKeys;/** Dynamic mapping generation used for text mappings should not be applied ... *//** Returns the default FlavorMap for this thread's ClassLoader. */FlavorMap fmnew SystemFlavorMap(...)/** Initializes a SystemFlavorMap by reading flavormap.properties and ... */BufferedReader flavormapDotPropertiesBufferedReader flavormapURLparseAndStoreReader(...)/** Copied code from java.util.Properties. Parsing the data ourselves is the ... */char firstCharint separatorIndexint valueIndexDataFlavor flavorLinkedHashSet<DataFlavor> dfsnew LinkedHashSet<DataFlavor>(...)continueLine(...)String nextLineString loppedLineint startIndexloadConvert(...)MimeType mimeregisterTextFlavorProperties(...)convertMimeTypeToDataFlavors(...)store(...)getTextTypeToNative(...)flavor.mimeTypeDataFlavor dfgetFlavorToNative(...)getNativeToFlavor(...)int slashCountchar aCharStringBuilder outBuffer/** Stores the listed object under the specified hash key in map. Unlike a ... */LinkedHashSet<L> listnew LinkedHashSet<L>(...)/** Semantically equivalent to 'nativeToFlavor.get(nat)'. This method ... */LinkedHashSet<DataFlavor> flavorsLinkedHashSet<DataFlavor> platformFlavorsgetPlatformMappingsForNative(...)isJavaMIMEType(...)String decodeddecodeJavaMIMEType(...)LinkedHashSet<String> nativesnew LinkedHashSet<String>(...)/** Semantically equivalent to 'flavorToNative.get(flav)'. This method ... */LinkedHashSet<String> platformNativesgetPlatformMappingsForFlavor(...)String encodedencodeDataFlavor(...)LinkedHashSet<String> retvalflavorToNativeLookup(...)LinkedHashSet<String> textTypeNativesflav.mimeTypeLinkedHashSet<DataFlavor> returnValuenew ArrayList<DataFlavor>(...)getNativesForFlavor(...)getFlavorsForNative(...)nativeToFlavorLookup(...)LinkedHashSet<DataFlavor> flavorsWithSynthesizedString baseTypedf.mimeTypeSet<DataFlavor> returnValueString subTypeMimeType mimeTypeString unicodeClassNameLinkedHashSet<String> mimeTypeshandleHtmlMimeTypes(...)String mtDataFlavor toAddClassNotFoundException cannotHappenstandardEncodings(...)String encodedTextClassString encodedTextClassName...[] htmlDocumntTypes;LinkedHashSet<String> returnValuesString documentTypeMap<DataFlavor,String> retvalnew HashMap<DataFlavor,String>(...)List<DataFlavor> flavor_listList<String> nativesString natMap<String,DataFlavor> retvalnew HashMap<String,DataFlavor>(...)natives.lengthList<String> nativesListString aNativeList<DataFlavor> flavorsDataFlavor flav/** Adds a mapping from the specified <code>DataFlavor</code> (and all ... *//** Discards the current mappings for the specified <code>DataFlavor</code> ... */addUnencodedNativeForFlavor(...)/** Adds a mapping from a single <code>String</code> native to a single ... *//** Discards the current mappings for the specified <code>String</code> ... */addFlavorForUnencodedNative(...)/** Encodes a MIME type for use as a <code>String</code> native. The format ... *//** Encodes a <code>DataFlavor</code> for use as a <code>String</code> ... */encodeJavaMIMEType(...)/** Returns whether the specified <code>String</code> is an encoded Java ... *//** Decodes a <code>String</code> native for use as a Java MIME type. ... *//** Decodes a <code>String</code> native for use as a ... */String retval_strMap<K,SoftReference<LinkedHashSet<V>>> cache;new HashMap<K,SoftReference<LinkedHashSet<V>>>(...)new SoftReference<LinkedHashSet<V>>(...)SoftReference<LinkedHashSet<V>> ref// From this point the map should not be modified// ignored// Get next line// Continue lines that end in slashes if they are not comments// Advance beyond whitespace on new line// Find start of key// Blank lines are ignored// Find separation between key and value// Skip over whitespace after key if any// Skip over one non whitespace key value separators if any// Skip over white space after other separators if any// Convert then store key and value// We need to store the charset and eoln// parameters, if any, so that the// DataTransferer will have this information// for conversion into the native format.// But don't store any of these parameters in the// DataFlavor itself for any text natives (even// non-charset ones). The SystemFlavorMap will// synthesize the appropriate mappings later.// Read the xxxx// Prepending the platform-specific mappings ensures// that the flavors added with// addFlavorForUnencodedNative() are at the end of// list.// Prepend the platform-specific mappings to ensure// that the natives added with// addUnencodedNativeForFlavor() are at the end of// In this case we shouldn't synthesize a native for this flavor,// since its mappings were explicitly specified.// For text/* flavors, flavor-to-native mappings specified in// flavormap.properties are stored per flavor's base type.// Also include text/plain natives, but don't duplicate Strings// In this branch it is guaranteed that natives explicitly// listed for flav's MIME type were added with// addUnencodedNativeForFlavor(), so they have lower priority.// Create a copy, because client code can modify the returned list.// Cannot happen, since we checked all mappings// on load from flavormap.properties.// Check for equality to plainTextFlavor so// that we can ensure that the exact charset of// plainTextFlavor, not the canonical charset// or another equivalent charset with a// different name, is used.// Non-charset text natives should be treated as// opaque, 8-bit data in any of its various// representations.// Use getNativesForFlavor to generate extra natives for text flavors// and stringFlavor// Use getFlavorsForNative to generate extra flavors for text natives/** Defines the interface for classes that can be used to provide data ... *//** Returns an array of DataFlavor objects indicating the flavors the data ... *//** Returns whether or not the specified data flavor is supported for ... *//** Returns an object which represents the data to be transferred.  The class ... *//** Signals that the requested data is not supported in this flavor. ... *//** Constructs an UnsupportedFlavorException. ... */getHumanPresentableName(...)/** During DnD operations it is possible that a user may wish to drop the ... *//** This method returns the <code>Insets</code> describing ... *//** notify the <code>Component</code> to autoscroll ... *//** This class contains constant values representing ... */int ACTION_NONE;/** An <code>int</code> representing no action. */// define null private constructor.int ACTION_COPY;/** An <code>int</code> representing a &quot;copy&quot; action. */int ACTION_MOVE;/** An <code>int</code> representing a &quot;move&quot; action. */int ACTION_COPY_OR_MOVE;/** An <code>int</code> representing a &quot;copy&quot; or ... */int ACTION_LINK;/** An <code>int</code> representing a &quot;link&quot; action. ... */int ACTION_REFERENCE;/** An <code>int</code> representing a &quot;reference&quot; ... */import AWTEventMulticaster/** A class extends <code>AWTEventMulticaster</code> to implement efficient and ... *//** Handles the <code>DragSourceDragEvent</code> by invoking ... */dragEnter(...)dragOver(...)dropActionChanged(...)/** Handles the <code>DragSourceEvent</code> by invoking ... */dragExit(...)/** Handles the <code>DragSourceDropEvent</code> by invoking ... */dragDropEnd(...)dragMouseMoved(...)/** Adds drag-source-listener-a with drag-source-listener-b and ... *//** Adds drag-source-motion-listener-a with drag-source-motion-listener-b and ... *//** Removes the old drag-source-listener from drag-source-listener-l ... *//** Removes the old drag-source-motion-listener from ... */new DnDEventMulticaster(...)/** Removes a listener from this multicaster and returns the ... */import Cursorimport Transferable/** A <code>DragGestureEvent</code> is passed ... *//** Constructs a <code>DragGestureEvent</code> object given by the ... */getDragSource(...)DnDConstants.ACTION_COPYDnDConstants.ACTION_MOVEDnDConstants.ACTION_LINK/** Returns the source as a <code>DragGestureRecognizer</code>. ... *//** Returns the <code>Component</code> associated ... *//** Returns the <code>DragSource</code>. ... *//** Returns a <code>Point</code> in the coordinates ... *//** Returns an <code>Iterator</code> for the events ... *//** Returns an <code>Object</code> array of the ... *//** Returns an array of the events comprising the drag gesture. ... *//** Returns an <code>int</code> representing the ... *//** Returns the initial event that triggered the gesture. ... */getTriggerEvent(...)getSourceAsDragGestureRecognizer(...)/** Starts the drag operation given the <code>Cursor</code> for this drag ... */startDrag(...)/** Starts the drag given the initial <code>Cursor</code> to display, ... *//** Start the drag given the initial <code>Cursor</code> to display, ... *//** Serializes this <code>DragGestureEvent</code>. Performs default ... */test(...)/** Deserializes this <code>DragGestureEvent</code>. This method first ... */DragSource newDragSourceComponent newComponentint newActionList<> newEventsList<> events;DragSource dragSource;/** The DragSource associated with this DragGestureEvent. ... *//** The Component associated with this DragGestureEvent. ... */Point origin;/** The origin of the drag. ... */int action;/** The user's preferred action. ... */// Pre-1.4 support. 'events' was previously non-transient// 1.4-compatible byte stream. 'events' was written explicitly// Implementation assumes 'events' is never null.// Constructor treats empty events list as invalid value// Throw exception if serialized list is empty/** The listener interface for receiving drag gesture events. ... *//** This method is invoked by the {@code DragGestureRecognizer} ... */import TooManyListenersException/** The <code>DragGestureRecognizer</code> is an ... */new ArrayList<InputEvent>(...)/** Construct a new <code>DragGestureRecognizer</code> ... */DnDConstants.ACTION_COPY_OR_MOVEaddDragGestureListener(...)TooManyListenersException tmleDnDConstants.ACTION_NONE/** register this DragGestureRecognizer's Listeners with the Component ... *//** unregister this DragGestureRecognizer's Listeners with the Component ... *//** This method returns the <code>DragSource</code> ... *//** This method returns the <code>Component</code> ... *//** set the Component that the DragGestureRecognizer is associated with ... */unregisterListeners(...)registerListeners(...)/** This method returns an int representing the ... *//** This method sets the permitted source drag action(s) ... *//** This method returns the first event in the ... *//** Reset the Recognizer, if its currently recognizing a gesture, ignore ... *//** Register a new <code>DragGestureListener</code>. ... */new TooManyListenersException(...)/** unregister the current DragGestureListener ... *//** Notify the DragGestureListener that a Drag and Drop initiating ... */dragGestureRecognized(...)new DragGestureEvent(...)/** Listeners registered on the Component by this Recognizer shall record ... *//** Serializes this <code>DragGestureRecognizer</code>. This method first ... *//** Deserializes this <code>DragGestureRecognizer</code>. This method first ... *//** The <code>DragSource</code> ... *//** The <code>Component</code> ... */DragGestureListener dragGestureListener;/** The <code>DragGestureListener</code> ... */int sourceActions;/** An <code>int</code> representing ... */ArrayList<InputEvent> events;/** The list of events (in order) that ... */// cant happen ...import FlavorMapimport SystemFlavorMapimport GetIntegerAction/** The <code>DragSource</code> is the entity responsible ... */getDefaultFlavorMap(...)new DragSource(...)/* load a system default cursor */Cursor DefaultCopyDrop;/** The default <code>Cursor</code> to use with a copy operation indicating ... */Cursor DefaultMoveDrop;/** The default <code>Cursor</code> to use with a move operation indicating ... */Cursor DefaultLinkDrop;/** The default <code>Cursor</code> to use with a link operation indicating ... */Cursor DefaultCopyNoDrop;Cursor DefaultMoveNoDrop;Cursor DefaultLinkNoDrop;DragSource dflt;String dragSourceListenerK;/** Internal constants for serialization. */String dragSourceMotionListenerK;/** Gets the <code>DragSource</code> object associated with ... *//** Reports ... */Toolkit tBoolean supported/** Creates a new <code>DragSource</code>. ... *//** Start a drag, given the <code>DragGestureEvent</code> ... */setDragDropInProgress(...)DragSourceContextPeer dscpcreateDragSourceContextPeer(...)DragSourceContext dsccreateDragSourceContext(...)this.flavorMapnew InvalidDnDOperationException(...)/** Creates the {@code DragSourceContext} to handle the current drag ... */new DragSourceContext(...)/** This method returns the ... *//** Creates a new <code>DragGestureRecognizer</code> ... */createDragGestureRecognizer(...)/** Adds the specified <code>DragSourceListener</code> to this ... *//** Removes the specified <code>DragSourceListener</code> from this ... *//** Gets all the <code>DragSourceListener</code>s ... *//** Adds the specified <code>DragSourceMotionListener</code> to this ... *//** Removes the specified <code>DragSourceMotionListener</code> from this ... *//** Gets all of the  <code>DragSourceMotionListener</code>s ... *//** Gets all the objects currently registered as ... *//** This method calls <code>dragEnter</code> on the ... */DragSourceListener dsl/** This method calls <code>dragOver</code> on the ... *//** This method calls <code>dropActionChanged</code> on the ... *//** This method calls <code>dragExit</code> on the ... *//** This method calls <code>dragDropEnd</code> on the ... *//** This method calls <code>dragMouseMoved</code> on the ... */DragSourceMotionListener dsml/** Serializes this <code>DragSource</code>. This method first performs ... *//** Deserializes this <code>DragSource</code>. This method first performs ... */addDragSourceListener(...)addDragSourceMotionListener(...)/** Returns the drag gesture motion threshold. The drag gesture motion threshold ... */int tsnew GetIntegerAction(...)Integer tdFlavorMap flavorMap;DragSourceListener listener;DragSourceMotionListener motionListener;// may throw// 'flavorMap' was written explicitly// Implementation assumes 'flavorMap' is never null./** An abstract adapter class for receiving drag source events. The methods in ... *//** Called as the cursor's hotspot enters a platform-dependent drop site. ... *//** Called as the cursor's hotspot moves over a platform-dependent drop site. ... *//** Called whenever the mouse is moved during a drag operation. ... *//** Called when the user has modified the drop gesture. ... *//** Called as the cursor's hotspot exits a platform-dependent drop site. ... *//** This method is invoked to signify that the Drag and Drop ... */import DataFlavorimport UnsupportedFlavorException/** The <code>DragSourceContext</code> class is responsible for managing the ... *//** An <code>int</code> used by updateCurrentCursor() ... */// used by updateCurrentCursorint CHANGED;/** Called from <code>DragSource</code>, this constructor creates a new ... */getSourceActions(...)getDragAction(...)this.triggerupdateCurrentCursor(...)/** Returns the <code>DragSource</code> ... *//** Returns the <code>Component</code> associated with this ... *//** Returns the <code>DragGestureEvent</code> ... *//** Returns a bitwise mask of <code>DnDConstants</code> that ... *//** Sets the cursor for this drag operation to the specified ... */setCursorImpl(...)/** Returns the current drag <code>Cursor</code>. ... *//** Add a <code>DragSourceListener</code> to this ... *//** Removes the specified <code>DragSourceListener</code> ... *//** Notifies the peer that the <code>Transferable</code>'s ... */transferablesFlavorsChanged(...)/** Calls <code>dragEnter</code> on the ... */processDragEnter(...)getTargetActions(...)/** Calls <code>dragOver</code> on the ... */processDragOver(...)/** Calls <code>dragExit</code> on the ... */processDragExit(...)/** Calls <code>dropActionChanged</code> on the ... */processDropActionChanged(...)/** Calls <code>dragDropEnd</code> on the ... */processDragDropEnd(...)/** Calls <code>dragMouseMoved</code> on the ... */processDragMouseMoved(...)/** Returns the <code>Transferable</code> associated with ... *//** If the default drag cursor behavior is active, this method ... */int raDragSource.DefaultLinkNoDropDragSource.DefaultMoveNoDropDragSource.DefaultCopyNoDropDragSource.DefaultLinkDropDragSource.DefaultMoveDropDragSource.DefaultCopyDrop/** Serializes this <code>DragSourceContext</code>. This method first ... *//** Deserializes this <code>DragSourceContext</code>. This method first ... */DragGestureEvent newTriggerint newSourceActionsint triggerActionsTransferable emptyTransferable;DragSourceContextPeer peer;DragGestureEvent trigger;/** The event which triggered the start of the drag. ... *//** The current drag cursor. ... */Transferable transferable;boolean useCustomCursor;/** <code>true</code> if the custom drag cursor is used instead of the ... *//** A bitwise mask of <code>DnDConstants</code> that represents the set of ... */// if the cursor has been previously set then don't do any defaults// processing.// do defaults processing// no drop possible// drop possible// Implementation assumes 'transferable' is never null./** The <code>DragSourceDragEvent</code> is ... *//** Constructs a <code>DragSourceDragEvent</code>. ... */this.dropActiongetGestureModifiers(...)getGestureModifiersEx(...)setNewModifiers(...)setOldModifiers(...)/** Constructs a <code>DragSourceDragEvent</code> given the specified ... *//** This method returns the target drop action. ... */int JDK_1_3_MODIFIERS;int JDK_1_4_MODIFIERS;/** This method returns an <code>int</code> representing ... *//** This method returns the user drop action. ... *//** This method returns the logical intersection of ... */getDragSourceContext(...)int targetActions;/** The target drop action. ... */int dropAction;/** The user drop action. ... */int gestureModifiers;/** The state of the input device modifiers associated with the user ... */boolean invalidModifiers;/** Indicates whether the <code>gestureModifiers</code> are invalid. ... *//** Sets new modifiers by the old ones. ... *//** Sets old modifiers by the new ones. *//** The <code>DragSourceDropEvent</code> is delivered ... *//** Construct a <code>DragSourceDropEvent</code> for a drop, ... *//** Construct a <code>DragSourceDropEvent</code> for a drop, given the ... *//** Construct a <code>DragSourceDropEvent</code> ... *//** This method returns a <code>boolean</code> indicating ... */boolean dropSuccess;/** <code>true</code> if the drop was successful. ... *//** The drop action. ... *//** This class is the base class for ... */boolean locationSpecified;/** The <code>boolean</code> indicating whether the cursor location ... *//** The horizontal coordinate for the cursor location at the moment this ... *//** The vertical coordinate for the cursor location at the moment this event ... *//** Construct a <code>DragSourceEvent</code> ... *//** Construct a <code>DragSourceEvent</code> given a specified ... *//** This method returns the <code>DragSourceContext</code> that ... *//** This method returns a <code>Point</code> indicating the cursor ... *//** This method returns the horizontal coordinate of the cursor location in ... *//** This method returns the vertical coordinate of the cursor location in ... *//** The <code>DragSourceListener</code> defines the ... *//** A listener interface for receiving mouse motion events during a drag ... */import ActionListenerimport DropTargetPeer/** The <code>DropTarget</code> is associated ... */createDropTargetContext(...)/** Creates a new DropTarget given the <code>Component</code> ... */setDefaultActions(...)addDropTargetListener(...)setDropTarget(...)/** Creates a <code>DropTarget</code> given the <code>Component</code> ... *//** Creates a <code>DropTarget</code>. ... *//** Note: this interface is required to permit the safe association ... */Component oldComponentPeer oldPeerclearAutoscroll(...)/** Gets the <code>Component</code> associated ... *//** Sets the default acceptable actions for this <code>DropTarget</code> ... */setTargetActions(...)getDropTargetContext(...)DnDConstants.ACTION_REFERENCE/* Called by DropTargetContext.setTargetActions() ... *//** Gets an <code>int</code> representing the ... *//** Sets the DropTarget active if <code>true</code>, ... *//** Reports whether or not ... *//** Adds a new <code>DropTargetListener</code> (UNICAST SOURCE). ... *//** Removes the current <code>DropTargetListener</code> (UNICAST SOURCE). ... *//** Calls <code>dragEnter</code> on the registered ... */initializeAutoscrolling(...)/** Calls <code>dragOver</code> on the registered ... */updateAutoscroll(...)/** Calls <code>dropActionChanged</code> on the registered ... *//** Calls <code>dragExit</code> on the registered ... *//** Calls <code>drop</code> on the registered ... */drop(...)rejectDrop(...)/** Gets the <code>FlavorMap</code> ... *//** Sets the <code>FlavorMap</code> associated ... *//** Notify the DropTarget that it has been associated with a Component ... */addDropTarget(...)/** Notify the DropTarget that it has been disassociated from a Component ... */removeDropTarget(...)new DropTargetEvent(...)/** Gets the <code>DropTargetContext</code> associated ... *//** Creates the DropTargetContext associated with this DropTarget. ... */new DropTargetContext(...)/** Serializes this <code>DropTarget</code>. Performs default serialization, ... *//** Deserializes this <code>DropTarget</code>. This method first performs ... *//** this protected nested class implements autoscrolling *//** ****************************************************************** *//** construct a DropTargetAutoScroller ... */Integer initialInteger intervalsetInitialDelay(...)/** update the geometry of the autoscroll region */getAutoscrollInsets(...)int newWidthint newHeightouter.widthouter.heightinner.xinner.yinner.widthinner.height/** cause autoscroll to occur ... */locn.xprev.xlocn.yprev.y/** cause autoscrolling to stop */updateRegion(...)autoscroll(...)Autoscroll autoScroll;Point locn;Point prev;Rectangle outer;Rectangle inner;int hysteresis;/** create an embedded autoscroller ... */new DropTargetAutoScroller(...)/** initialize autoscrolling ... */createDropTargetAutoScroller(...)/** update autoscrolling with current cursor location ... */updateLocation(...)/** clear autoscrolling */DropTargetContext dropTargetContext;/** The DropTargetContext associated with this DropTarget. ... *//** The Component associated with this DropTarget. ... */ComponentPeer componentPeer;/* That Component's  Peer */ComponentPeer nativePeer;/* That Component's "native" Peer */int actions;/** Default permissible actions supported by this DropTarget. ... *//** <code>true</code> if the DropTarget is accepting Drag &amp; Drop operations. ... */DropTargetAutoScroller autoScroller;/* the auto scrolling object */DropTargetListener dtListener;/* The delegate *//* The FlavorMap */boolean isDraggingInside;/* If the dragging is currently inside this drop target */// do nothing!// undo the change// we should'nt get here ...// Pre-1.4 support. 'dropTargetContext' was previously transient// Pre-1.4 support. 'dtListener' was previously non-transient// 1.4-compatible byte stream. 'dtListener' was written explicitly/** An abstract adapter class for receiving drop target events. The methods in ... *//** Called while a drag operation is ongoing, when the mouse pointer enters ... *//** Called when a drag operation is ongoing, while the mouse pointer is still ... *//** Called if the user has modified ... *//** Called while a drag operation is ongoing, when the mouse pointer has ... */import DropTargetContextPeer/** A <code>DropTargetContext</code> is created ... *//** Construct a <code>DropTargetContext</code> ... *//** This method returns the <code>DropTarget</code> associated with this ... *//** This method returns the <code>Component</code> associated with ... *//** Called when associated with the <code>DropTargetContextPeer</code>. ... *//** Called when disassociated with the <code>DropTargetContextPeer</code>. *//** This method sets the current actions acceptable to ... */DropTargetContextPeer peergetDropTargetContextPeer(...)doSetDefaultActions(...)/** This method returns an <code>int</code> representing the ... */getDefaultActions(...)/** This method signals that the drop is completed and ... */dropComplete(...)/** accept the Drag. ... */acceptDrag(...)/** reject the Drag. */rejectDrag(...)/** called to signal that the drop is acceptable ... */acceptDrop(...)/** called to signal that the drop is unacceptable. ... *//** get the available DataFlavors of the ... *//** This method returns a the currently available DataFlavors ... */getCurrentDataFlavors(...)/** This method returns a <code>boolean</code> ... */getCurrentDataFlavorsAsList(...)/** get the Transferable (proxy) operand of this operation ... */Transferable tgetTransferable(...)boolean isLocalisTransferableJVMLocal(...)createTransferableProxy(...)/** Get the <code>DropTargetContextPeer</code> ... *//** Creates a TransferableProxy to proxy for the specified ... */new TransferableProxy(...)/** <code>TransferableProxy</code> is a helper inner class that implements ... *//** ************************************************************************* *//** Constructs a <code>TransferableProxy</code> given ... *//** Returns an array of DataFlavor objects indicating the flavors ... *//** Returns whether or not the specified data flavor is supported by ... *//** Returns an object which represents the data provided by ... *//** The encapsulated <code>Transferable</code> object. */// public constructor.// cannot be subclassed by client code because it does not have a// subclasses of DropTargetContext can access it. And DropTargetContext// these variables. Since TransferableProxy is a protected class, only// We don't need to worry about client code changing the values ofboolean isLocal;/** A <code>boolean</code> indicating if the encapsulated ... */TransferableProxy proxy;/** The DropTarget associated with this DropTargetContext. ... */DropTargetContextPeer dropTargetContextPeer;/** The <code>DropTargetDragEvent</code> is delivered to a ... *//** Construct a <code>DropTargetDragEvent</code> given the ... *//** This method returns a <code>Point</code> ... *//** This method returns the current <code>DataFlavor</code>s from the ... *//** This method returns the current <code>DataFlavor</code>s ... *//** This method returns the source drop actions. ... *//** This method returns the Transferable object that represents ... *//** Accepts the drag. ... *//** Rejects the drag as a result of examining either the ... *//** The location of the drag cursor's hotspot in Component coordinates. ... *//** The source drop actions. ... *//** The <code>DropTargetDropEvent</code> is delivered ... *//** Construct a <code>DropTargetDropEvent</code> given ... *//** Construct a <code>DropTargetEvent</code> given the ... *//** This method returns the current DataFlavors. ... *//** This method returns the currently available ... *//** This method returns a <code>boolean</code> indicating if the ... *//** This method returns the <code>Transferable</code> object ... *//** accept the drop, using the specified action. ... *//** reject the Drop. *//** This method notifies the <code>DragSource</code> ... *//** This method returns an <code>int</code> indicating if ... */Point zero;boolean isLocalTx;/** <code>true</code> if the source is in the same JVM as the target. ... */import DropTargetContext/** The <code>DropTargetEvent</code> is the base ... *//** Construct a <code>DropTargetEvent</code> object with ... *//** This method returns the <code>DropTargetContext</code> ... */DropTargetContext context;/** The <code>DropTargetContext</code> associated with this ... */import DropTargetDragEventimport DropTargetDropEvent/** The <code>DropTargetListener</code> interface ... *//** Called when the drag operation has terminated with a drop on ... *//** This exception is thrown by various methods in the java.awt.dnd package. ... */String dft_msg;/** Create a default Exception *//** Create an Exception with its own descriptive message ... */import MouseListenerimport MouseMotionListener/** This abstract subclass of <code>DragGestureRecognizer</code> ... *//** Construct a new <code>MouseDragGestureRecognizer</code> ... *//** register this DragGestureRecognizer's Listeners with the Component *//** Invoked when the mouse has been clicked on a component. ... *//** Invoked when a mouse button has been ... *//** Invoked when a mouse button has been released on a component. ... *//** Invoked when the mouse enters a component. ... *//** Invoked when the mouse exits a component. ... *//** Invoked when a mouse button is pressed on a component. ... *//** Invoked when the mouse button has been moved on a component ... *//** Tests if an object can truly be serialized by serializing it to a null ... */IOException cannotHappenObjectOutputStream stream;// Fix for 4503661.// Reset the stream so that it doesn't keep a reference to the// written object.// Ignore the exception.import DragSourceContext/** start a drag *//** return the current drag cursor *//** set the current drag cursor *//** notify the peer that the Transferables DataFlavors have changed *//** update the peer's notion of the Target's actions *//** get the current Target actions *//** get the DropTarget associated with this peer *//** get the (remote) DataFlavors from the peer *//** get an input stream to the remote data *//** accept the Drag *//** reject the Drag *//** accept the Drop *//** reject the Drop *//** signal complete *//** Add the DropTarget to the System ... *//** Remove the DropTarget from the system ... *//** The listener interface for receiving notification of events ... *//** Invoked when an event is dispatched in the AWT. */import EventListenerProxy/** A class which extends the {@code EventListenerProxy} ... *//** Constructor which binds the {@code AWTEventListener} ... */this.eventMask/** Forwards the AWT event to the listener delegate. ... *//** Returns the event mask associated with the listener. ... *//** A semantic event which indicates that a component-defined action occurred. ... */Event.META_MASKEvent.ALT_MASK/** The shift modifier. An indicator that the shift key was held ... *//** The control modifier. An indicator that the control key was held ... *//** The meta modifier. An indicator that the meta key was held ... *//** The alt modifier. An indicator that the alt key was held ... */int ACTION_FIRST;/** The first number in the range of ids used for action events. */int ACTION_LAST;/** The last number in the range of ids used for action events. */int ACTION_PERFORMED;/** This event id indicates that a meaningful action occurred. *//** The nonlocalized string that gives more details ... *///Event.ACTION_EVENT/** Timestamp of when this event occurred. Because an ActionEvent is a high- ... *//** This represents the key modifier that was selected, ... *//** Constructs an <code>ActionEvent</code> object. ... *//** Constructs an <code>ActionEvent</code> object with modifier keys. ... *//** Constructs an <code>ActionEvent</code> object with the specified ... */this.actionCommand/** Returns the command string associated with this action. ... *//** Returns the timestamp of when this event occurred. Because an ... *//** Returns the modifier keys held down during this action event. ... *//** Returns a parameter string identifying this action event. ... *//** The listener interface for receiving action events. ... *//** Invoked when an action occurs. */import Adjustable/** The adjustment event emitted by Adjustable objects like ... */int ADJUSTMENT_FIRST;/** Marks the first integer id for the range of adjustment event ids. */int ADJUSTMENT_LAST;/** Marks the last integer id for the range of adjustment event ids. */int ADJUSTMENT_VALUE_CHANGED;/** The adjustment value changed event. */int UNIT_INCREMENT;/** The unit increment adjustment type. *///Event.SCROLL_LINE_UPint UNIT_DECREMENT;/** The unit decrement adjustment type. */int BLOCK_DECREMENT;/** The block decrement adjustment type. */int BLOCK_INCREMENT;/** The block increment adjustment type. */int TRACK;/** The absolute tracking adjustment type. */Adjustable adjustable;/** The adjustable object that fired the event. ... *//** <code>value</code> will contain the new value of the ... */int adjustmentType;/** The <code>adjustmentType</code> describes how the adjustable ... *//** The <code>isAdjusting</code> is true if the event is one ... *//** Constructs an <code>AdjustmentEvent</code> object with the ... */this.adjustmentTypethis.isAdjusting/** Returns the <code>Adjustable</code> object where this event originated. ... *//** Returns the current value in the adjustment event. ... *//** Returns the type of adjustment which caused the value changed ... *//** Returns <code>true</code> if this is one of multiple ... */String adjTypeStr/** The listener interface for receiving adjustment events. ... *//** An abstract adapter class for receiving component events. ... *//** Invoked when the component's size changes. *//** Invoked when the component's position changes. *//** Invoked when the component has been made visible. *//** Invoked when the component has been made invisible. *//** A low-level event which indicates that a component moved, changed ... */int COMPONENT_FIRST;/** The first number in the range of ids used for component events. */int COMPONENT_LAST;/** The last number in the range of ids used for component events. */int COMPONENT_MOVED;/** This event indicates that the component's position changed. */int COMPONENT_RESIZED;/** This event indicates that the component's size changed. */int COMPONENT_SHOWN;/** This event indicates that the component was made visible. */int COMPONENT_HIDDEN;/** This event indicates that the component was rendered invisible. *//** Constructs a <code>ComponentEvent</code> object. ... *//** Returns the originator of the event. ... *//** Returns a parameter string identifying this event. ... *//** The listener interface for receiving component events. ... *//** An abstract adapter class for receiving container events. ... *//** Invoked when a component has been added to the container. *//** Invoked when a component has been removed from the container. *//** A low-level event which indicates that a container's contents ... */int CONTAINER_FIRST;/** The first number in the range of ids used for container events. */int CONTAINER_LAST;/** The last number in the range of ids used for container events. */int COMPONENT_ADDED;/** This event indicates that a component was added to the container. */int COMPONENT_REMOVED;/** This event indicates that a component was removed from the container. */Component child;/** The non-null component that is being added or ... *//** Constructs a <code>ContainerEvent</code> object. ... */this.child/** Returns the component that was affected by the event. ... *//** The listener interface for receiving container events. ... *//** An abstract adapter class for receiving keyboard focus events. ... *//** Invoked when a component gains the keyboard focus. *//** Invoked when a component loses the keyboard focus. *//** A low-level event which indicates that a Component has gained or lost the ... */int FOCUS_FIRST;/** The first number in the range of ids used for focus events. */int FOCUS_LAST;/** The last number in the range of ids used for focus events. */int FOCUS_GAINED;/** This event indicates that the Component is now the focus owner. */int FOCUS_LOST;/** This event indicates that the Component is no longer the focus owner. *///Event.GOT_FOCUS/** A focus event can have two different levels, permanent and temporary. ... *///Event.LOST_FOCUSComponent opposite;/** The other Component involved in this focus change. For a FOCUS_GAINED ... *//** Constructs a <code>FocusEvent</code> object with the ... */this.opposite/** Constructs a <code>FocusEvent</code> object and identifies ... *//** Constructs a <code>FocusEvent</code> object and identifies it ... *//** Identifies the focus change event as temporary or permanent. ... *//** Returns the other Component involved in this focus change. For a ... *//** The listener interface for receiving keyboard focus events on ... *//** An abstract adapter class for receiving ancestor moved and resized events. ... *//** Called when an ancestor of the source is moved. *//** Called when an ancestor of the source is resized. *//** The listener interface for receiving ancestor moved and resized events. ... *//** An event which indicates a change to the <code>Component</code> ... */int HIERARCHY_FIRST;/** Marks the first integer id for the range of hierarchy event ids. */int HIERARCHY_CHANGED;/** The event id indicating that modification was made to the ... */// 1300 used by sun.awt.windows.ModalityEventint ANCESTOR_MOVED;/** The event id indicating an ancestor-Container was moved. */int ANCESTOR_RESIZED;/** The event id indicating an ancestor-Container was resized. */int HIERARCHY_LAST;/** Marks the last integer id for the range of ancestor event ids. */int PARENT_CHANGED;/** A change flag indicates that the <code>HIERARCHY_CHANGED</code> event ... */int DISPLAYABILITY_CHANGED;int SHOWING_CHANGED;Component changed;Container changedParent;long changeFlags;/** Constructs an <code>HierarchyEvent</code> object to identify a ... */this.changedthis.changedParent/** Constructs an <code>HierarchyEvent</code> object to identify ... */this.changeFlags/** Returns the Component at the top of the hierarchy which was ... *//** Returns the parent of the Component returned by <code> ... *//** Returns a bitmask which indicates the type(s) of ... *//** The listener interface for receiving hierarchy changed events. ... *//** Called when the hierarchy has been changed. To discern the actual ... *//** The root event class for all component-level input events. ... */setInputEventAccessor(...)AWTAccessor.InputEventAccessorPlatformLogger logger;/** The Shift key modifier constant. ... *//** The Control key modifier constant. ... *//** The Meta key modifier constant. ... *//** The Alt key modifier constant. ... */int ALT_GRAPH_MASK;/** The AltGraph key modifier constant. */int BUTTON1_MASK;/** The Mouse Button1 modifier constant. ... */int BUTTON2_MASK;/** The Mouse Button2 modifier constant. ... */int BUTTON3_MASK;/** The Mouse Button3 modifier constant. ... */int SHIFT_DOWN_MASK;/** The Shift key extended modifier constant. ... */int CTRL_DOWN_MASK;/** The Control key extended modifier constant. ... */int META_DOWN_MASK;/** The Meta key extended modifier constant. ... */int ALT_DOWN_MASK;/** The Alt key extended modifier constant. ... */int BUTTON1_DOWN_MASK;/** The Mouse Button1 extended modifier constant. ... */int BUTTON2_DOWN_MASK;/** The Mouse Button2 extended modifier constant. ... */int BUTTON3_DOWN_MASK;/** The Mouse Button3 extended modifier constant. ... */int ALT_GRAPH_DOWN_MASK;/** The AltGraph key extended modifier constant. ... */...[] BUTTON_DOWN_MASK;/** An array of extended modifiers for additional buttons. ... *//** A method to access an array of extended modifiers for additional buttons. ... */BUTTON_DOWN_MASK.length/** A method to obtain a mask for any existing mouse button. ... */int FIRST_HIGH_BIT;// see bug# 5066958// to the same field as this may break applications// in fact, it is undesirable to add modifier bits// bits are to be added!// the constant below MUST be updated if any extra modifierint HIGH_MODIFIERS;/** The input event's Time stamp in UTC format.  The time stamp ... *//** The state of the modifier mask at the time the input ... */boolean canAccessSystemClipboard;/* A flag that indicates that this instance can be used to access ... *//** Constructs an InputEvent object with the specified source component, ... */canAccessSystemClipboard(...)/** Returns whether or not the Shift modifier is down on this event. *//** Returns whether or not the Control modifier is down on this event. *//** Returns whether or not the Meta modifier is down on this event. *//** Returns whether or not the Alt modifier is down on this event. *//** Returns whether or not the AltGraph modifier is down on this event. *//** Returns the difference in milliseconds between the timestamp of when this event occurred and ... *//** Returns the modifier mask for this event. *//** Returns the extended modifier mask for this event. ... *//** Consumes this event so that it will not be processed ... *//** Returns whether or not this event has been consumed. ... */// state serialization compatibility with JDK 1.1/** Returns a String describing the extended modifier keys and ... */int buttonNumberInputEvent.BUTTON_DOWN_MASK//4th phisical button (this is not a wheel!)//(this is not a wheel!)// remove trailing '+'import TextHitInfo/** Input method events contain information about text that is being ... *//** Serial Version ID. */int INPUT_METHOD_FIRST;/** Marks the first integer id for the range of input method event ids. */int INPUT_METHOD_TEXT_CHANGED;/** The event type indicating changed input method text. This event is ... */int CARET_POSITION_CHANGED;/** The event type indicating a changed insertion point in input method text. ... */int INPUT_METHOD_LAST;/** Marks the last integer id for the range of input method event ids. *//** The time stamp that indicates when the event was created. ... */AttributedCharacterIterator text;// Text objectint committedCharacterCount;TextHitInfo caret;TextHitInfo visiblePosition;/** Constructs an <code>InputMethodEvent</code> with the specified ... */int textLengththis.committedCharacterCountthis.caretthis.visiblePositiongetMostRecentEventTimeForSource(...)/** Constructs an <code>InputMethodEvent</code> with the ... *//** Gets the combined committed and composed text. ... *//** Gets the number of committed characters in the text. *//** Gets the caret. ... *//** Gets the position that's most important to be visible. ... *//** Returns the time stamp of when this event occurred. ... */String countStringString caretStringString visiblePositionStringStringBuilder textBufferint committedCharacterCountCharacterIterator.DONE/** Initializes the <code>when</code> field if it is not present in the ... *//** Get the most recent event time in the {@code EventQueue} which the {@code source} ... */getSystemEventQueueImplPP(...)getEventQueueAccessor(...)// Can't use getMostRecentEventTimeForSource because source is always null during deserialization// throw the IllegalArgumentException to conform to EventObject spec/** The listener interface for receiving input method events. A text editing ... *//** Invoked when the text entered through an input method has changed. *//** Invoked when the caret within composed text has changed. */import ActiveEvent/** An event which executes the <code>run()</code> method on a <code>Runnable ... */setInvocationEventAccessor(...)AWTAccessor.InvocationEventAccessorfinishedDispatching(...)int INVOCATION_FIRST;/** Marks the first integer id for the range of invocation event ids. */int INVOCATION_DEFAULT;/** The default id for all InvocationEvents. */int INVOCATION_LAST;/** Marks the last integer id for the range of invocation event ids. */Runnable runnable;/** The Runnable whose run() method will be called. */Object notifier;/** The (potentially null) Object whose notifyAll() method will be called ... */Runnable listener;/** The (potentially null) Runnable whose run() method will be called ... *//** Indicates whether the <code>run()</code> method of the <code>runnable</code> ... */boolean catchExceptions;/** Set to true if dispatch() catches Throwable and stores it in the ... */Exception exception;/** The (potentially null) Exception thrown during execution of the ... */Throwable throwable;/** The (potentially null) Throwable thrown during execution of the ... *//** The timestamp of when this event occurred. ... *//** Constructs an <code>InvocationEvent</code> with the specified ... */this.runnablethis.catchExceptions/** Executes the Runnable's <code>run()</code> method and notifies the ... *//** Returns any Exception caught while executing the Runnable's <code>run() ... *//** Returns any Throwable caught while executing the Runnable's <code>run() ... *//** Returns the timestamp of when this event occurred. ... *//** Returns {@code true} if the event is dispatched or any exception is ... *//** Called when the event was dispatched or disposed ... */this.dispatchedimport ItemSelectable/** A semantic event which indicates that an item was selected or deselected. ... */int ITEM_FIRST;/** The first number in the range of ids used for item events. */int ITEM_LAST;/** The last number in the range of ids used for item events. */int ITEM_STATE_CHANGED;/** This event id indicates that an item's state changed. */int SELECTED;/** This state-change value indicates that an item was selected. *///Event.LIST_SELECTint DESELECTED;/** This state-change-value indicates that a selected item was deselected. */Object item;/** The item whose selection state has changed. ... */int stateChange;/** <code>stateChange</code> indicates whether the <code>item</code> ... *//** Constructs an <code>ItemEvent</code> object. ... */this.itemthis.stateChange/** Returns the item affected by the event. ... *//** Returns the type of state change (selected or deselected). ... *//** Returns a parameter string identifying this item event. ... *//** The listener interface for receiving item events. ... *//** Invoked when an item has been selected or deselected by the user. ... *//** An abstract adapter class for receiving keyboard events. ... *//** Invoked when a key has been typed. ... *//** Invoked when a key has been pressed. *//** Invoked when a key has been released. *//** An event which indicates that a keystroke occurred in a component. ... */setKeyEventAccessor(...)AWTAccessor.KeyEventAccessorev.rawCodeev.primaryLevelUnicodeev.extendedKeyCodeev.originalSourceboolean isProxyActive;/** Stores the state of native event dispatching system ... */int KEY_FIRST;/** The first number in the range of ids used for key events. */int KEY_LAST;/** The last number in the range of ids used for key events. */int KEY_TYPED;/** The "key typed" event.  This event is generated when a character is ... */int KEY_PRESSED;/** The "key pressed" event. This event is generated when a key ... */int KEY_RELEASED;/** The "key released" event. This event is generated when a key ... *///Event.KEY_PRESSint VK_ENTER;/* Virtual key codes. *///Event.KEY_RELEASEint VK_BACK_SPACE;int VK_TAB;int VK_CANCEL;int VK_CLEAR;int VK_SHIFT;int VK_CONTROL;int VK_ALT;int VK_PAUSE;int VK_CAPS_LOCK;int VK_ESCAPE;int VK_SPACE;int VK_PAGE_UP;int VK_PAGE_DOWN;int VK_END;int VK_HOME;int VK_LEFT;/** Constant for the non-numpad <b>left</b> arrow key. ... */int VK_UP;/** Constant for the non-numpad <b>up</b> arrow key. ... */int VK_RIGHT;/** Constant for the non-numpad <b>right</b> arrow key. ... */int VK_DOWN;/** Constant for the non-numpad <b>down</b> arrow key. ... */int VK_COMMA;/** Constant for the comma key, "," */int VK_MINUS;/** Constant for the minus key, "-" ... */int VK_PERIOD;/** Constant for the period key, "." */int VK_SLASH;/** Constant for the forward slash key, "/" */int VK_0;/** VK_0 thru VK_9 are the same as ASCII '0' thru '9' (0x30 - 0x39) */int VK_1;int VK_2;int VK_3;int VK_4;int VK_5;int VK_6;int VK_7;int VK_8;int VK_9;int VK_SEMICOLON;/** Constant for the semicolon key, ";" */int VK_EQUALS;/** Constant for the equals key, "=" */int VK_A;/** VK_A thru VK_Z are the same as ASCII 'A' thru 'Z' (0x41 - 0x5A) */int VK_B;int VK_C;int VK_D;int VK_E;int VK_F;int VK_G;int VK_H;int VK_I;int VK_J;int VK_K;int VK_L;int VK_M;int VK_N;int VK_O;int VK_P;int VK_Q;int VK_R;int VK_S;int VK_T;int VK_U;int VK_V;int VK_W;int VK_X;int VK_Y;int VK_Z;int VK_OPEN_BRACKET;/** Constant for the open bracket key, "[" */int VK_BACK_SLASH;/** Constant for the back slash key, "\" */int VK_CLOSE_BRACKET;/** Constant for the close bracket key, "]" */int VK_NUMPAD0;int VK_NUMPAD1;int VK_NUMPAD2;int VK_NUMPAD3;int VK_NUMPAD4;int VK_NUMPAD5;int VK_NUMPAD6;int VK_NUMPAD7;int VK_NUMPAD8;int VK_NUMPAD9;int VK_MULTIPLY;int VK_ADD;int VK_SEPARATER;/** This constant is obsolete, and is included only for backwards ... */int VK_SEPARATOR;/** Constant for the Numpad Separator key. ... */int VK_SUBTRACT;int VK_DECIMAL;int VK_DIVIDE;int VK_DELETE;int VK_NUM_LOCK;/* ASCII DEL */int VK_SCROLL_LOCK;int VK_F1;/** Constant for the F1 function key. */int VK_F2;/** Constant for the F2 function key. */int VK_F3;/** Constant for the F3 function key. */int VK_F4;/** Constant for the F4 function key. */int VK_F5;/** Constant for the F5 function key. */int VK_F6;/** Constant for the F6 function key. */int VK_F7;/** Constant for the F7 function key. */int VK_F8;/** Constant for the F8 function key. */int VK_F9;/** Constant for the F9 function key. */int VK_F10;/** Constant for the F10 function key. */int VK_F11;/** Constant for the F11 function key. */int VK_F12;/** Constant for the F12 function key. */int VK_F13;/* F13 - F24 are used on IBM 3270 keyboard; use random range for constants. *//** Constant for the F13 function key. ... */int VK_F14;/** Constant for the F14 function key. ... */int VK_F15;/** Constant for the F15 function key. ... */int VK_F16;/** Constant for the F16 function key. ... */int VK_F17;/** Constant for the F17 function key. ... */int VK_F18;/** Constant for the F18 function key. ... */int VK_F19;/** Constant for the F19 function key. ... */int VK_F20;/** Constant for the F20 function key. ... */int VK_F21;/** Constant for the F21 function key. ... */int VK_F22;/** Constant for the F22 function key. ... */int VK_F23;/** Constant for the F23 function key. ... */int VK_F24;/** Constant for the F24 function key. ... */int VK_PRINTSCREEN;int VK_INSERT;int VK_HELP;int VK_META;int VK_BACK_QUOTE;int VK_QUOTE;int VK_KP_UP;/** Constant for the numeric keypad <b>up</b> arrow key. ... */int VK_KP_DOWN;/** Constant for the numeric keypad <b>down</b> arrow key. ... */int VK_KP_LEFT;/** Constant for the numeric keypad <b>left</b> arrow key. ... */int VK_KP_RIGHT;/** Constant for the numeric keypad <b>right</b> arrow key. ... */int VK_DEAD_GRAVE;/* For European keyboards */int VK_DEAD_ACUTE;int VK_DEAD_CIRCUMFLEX;int VK_DEAD_TILDE;int VK_DEAD_MACRON;int VK_DEAD_BREVE;int VK_DEAD_ABOVEDOT;int VK_DEAD_DIAERESIS;int VK_DEAD_ABOVERING;int VK_DEAD_DOUBLEACUTE;int VK_DEAD_CARON;int VK_DEAD_CEDILLA;int VK_DEAD_OGONEK;int VK_DEAD_IOTA;int VK_DEAD_VOICED_SOUND;int VK_DEAD_SEMIVOICED_SOUND;int VK_AMPERSAND;int VK_ASTERISK;int VK_QUOTEDBL;int VK_LESS;int VK_GREATER;int VK_BRACELEFT;int VK_BRACERIGHT;int VK_AT;/** Constant for the "@" key. ... */int VK_COLON;/** Constant for the ":" key. ... */int VK_CIRCUMFLEX;/** Constant for the "^" key. ... */int VK_DOLLAR;/** Constant for the "$" key. ... */int VK_EURO_SIGN;/** Constant for the Euro currency sign key. ... */int VK_EXCLAMATION_MARK;/** Constant for the "!" key. ... */int VK_INVERTED_EXCLAMATION_MARK;/** Constant for the inverted exclamation mark key. ... */int VK_LEFT_PARENTHESIS;/** Constant for the "(" key. ... */int VK_NUMBER_SIGN;/** Constant for the "#" key. ... */int VK_PLUS;/** Constant for the "+" key. ... */int VK_RIGHT_PARENTHESIS;/** Constant for the ")" key. ... */int VK_UNDERSCORE;/** Constant for the "_" key. ... */int VK_WINDOWS;/** Constant for the Microsoft Windows "Windows" key. ... */int VK_CONTEXT_MENU;/** Constant for the Microsoft Windows Context Menu key. ... */int VK_FINAL;/* not clear what this means - listed in Microsoft Windows API *//* for input method support on Asian Keyboards */int VK_CONVERT;/* Japanese PC 106 keyboard, Japanese Solaris keyboard: henkan *//** Constant for the Convert function key. */int VK_NONCONVERT;/* Japanese PC 106 keyboard: muhenkan *//** Constant for the Don't Convert function key. */int VK_ACCEPT;/* Japanese Solaris keyboard: kakutei *//** Constant for the Accept or Commit function key. */int VK_MODECHANGE;int VK_KANA;/* replaced by VK_KANA_LOCK for Microsoft Windows and Solaris; ... */int VK_KANJI;/* replaced by VK_INPUT_METHOD_ON_OFF for Microsoft Windows and Solaris; ... */int VK_ALPHANUMERIC;/* Japanese PC 106 keyboard: eisuu *//** Constant for the Alphanumeric function key. ... */int VK_KATAKANA;/* Japanese PC 106 keyboard: katakana *//** Constant for the Katakana function key. ... */int VK_HIRAGANA;/* Japanese PC 106 keyboard: hiragana *//** Constant for the Hiragana function key. ... */int VK_FULL_WIDTH;/* Japanese PC 106 keyboard: zenkaku *//** Constant for the Full-Width Characters function key. ... */int VK_HALF_WIDTH;/* Japanese PC 106 keyboard: hankaku *//** Constant for the Half-Width Characters function key. ... */int VK_ROMAN_CHARACTERS;/* Japanese PC 106 keyboard: roumaji *//** Constant for the Roman Characters function key. ... */int VK_ALL_CANDIDATES;/* Japanese PC 106 keyboard - VK_CONVERT + ALT: zenkouho *//** Constant for the All Candidates function key. ... */int VK_PREVIOUS_CANDIDATE;/* Japanese PC 106 keyboard - VK_CONVERT + SHIFT: maekouho *//** Constant for the Previous Candidate function key. ... */int VK_CODE_INPUT;/* Japanese PC 106 keyboard - VK_ALPHANUMERIC + ALT: kanji bangou *//** Constant for the Code Input function key. ... */int VK_JAPANESE_KATAKANA;/* Japanese Macintosh keyboard - VK_JAPANESE_HIRAGANA + SHIFT *//** Constant for the Japanese-Katakana function key. ... */int VK_JAPANESE_HIRAGANA;/* Japanese Macintosh keyboard *//** Constant for the Japanese-Hiragana function key. ... */int VK_JAPANESE_ROMAN;/** Constant for the Japanese-Roman function key. ... */int VK_KANA_LOCK;/* Japanese PC 106 keyboard with special Windows driver - eisuu + Control; Japanese Solaris keyboard: kana *//** Constant for the locking Kana function key. ... */int VK_INPUT_METHOD_ON_OFF;/* Japanese PC 106 keyboard: kanji. Japanese Solaris keyboard: nihongo *//** Constant for the input method on/off key. ... */int VK_CUT;/* for Sun keyboards */int VK_COPY;int VK_PASTE;int VK_UNDO;int VK_AGAIN;int VK_FIND;int VK_PROPS;int VK_STOP;int VK_COMPOSE;/** Constant for the Compose function key. ... */int VK_ALT_GRAPH;/** Constant for the AltGraph function key. ... */int VK_BEGIN;/** Constant for the Begin key. ... */int VK_UNDEFINED;/** This value is used to indicate that the keyCode is unknown. ... */char CHAR_UNDEFINED;/** KEY_PRESSED and KEY_RELEASED events which do not map to a ... */int KEY_LOCATION_UNKNOWN;/** A constant indicating that the keyLocation is indeterminate ... */int KEY_LOCATION_STANDARD;/** A constant indicating that the key pressed or released ... */int KEY_LOCATION_LEFT;/** A constant indicating that the key pressed or released is in ... */int KEY_LOCATION_RIGHT;int KEY_LOCATION_NUMPAD;/** A constant indicating that the key event originated on the ... *//** The unique value assigned to each of the keys on the ... *//** <code>keyChar</code> is a valid unicode character ... */int keyLocation;/** The location of the key on the keyboard. ... */long rawCode;//set from native code.long primaryLevelUnicode;long scancode;long extendedKeyCode;// for MS Windows onlyComponent originalSource;/** The original event source. ... */this.isProxyActive/** Constructs a <code>KeyEvent</code> object. ... */this.keyLocation/** Returns the integer keyCode associated with the key in this event. ... *//** Set the keyCode value to indicate a physical key. ... *//** Returns the character associated with the key in this event. ... *//** Set the keyChar value to indicate a logical character. ... *//** Set the modifiers to indicate additional keys that were held down ... *//** Returns the location of the key that originated this key event. ... *//** Returns a String describing the keyCode, such as "HOME", "F1" or "A". ... */String unknownString numpad/** Returns a <code>String</code> describing the modifier key(s), ... *//** Returns whether the key in this event is an "action" key. ... */StringBuilder strgetModifiersExText(...)/** Returns an extended key code for the event. ... *//** Returns an extended key code for a unicode character. ... */getExtendedKeyCodeForChar(...)/** Sets new modifiers by the old ones. The key modifiers ... */// modifiers// punctuation// numpad numeric keys handled below/* Some keychars don't print well, e.g. escape, backspace, ... */// Return a keycode (if any) associated with a character./** The listener interface for receiving keyboard events (keystrokes). ... *//** Invoked when a key has been pressed. ... *//** Invoked when a key has been released. ... *//** An abstract adapter class for receiving mouse events. ... */import IllegalComponentStateExceptionimport MouseInfo/** An event which indicates that a mouse action occurred in a component. ... */int MOUSE_FIRST;/** The first number in the range of ids used for mouse events. */int MOUSE_LAST;/** The last number in the range of ids used for mouse events. */int MOUSE_CLICKED;/** The "mouse clicked" event. This <code>MouseEvent</code> ... */int MOUSE_PRESSED;/** The "mouse pressed" event. This <code>MouseEvent</code> ... */int MOUSE_RELEASED;/** The "mouse released" event. This <code>MouseEvent</code> ... *///Event.MOUSE_DOWNint MOUSE_MOVED;/** The "mouse moved" event. This <code>MouseEvent</code> ... *///Event.MOUSE_UPint MOUSE_ENTERED;/** The "mouse entered" event. This <code>MouseEvent</code> ... *///Event.MOUSE_MOVEint MOUSE_EXITED;/** The "mouse exited" event. This <code>MouseEvent</code> ... *///Event.MOUSE_ENTERint MOUSE_DRAGGED;/** The "mouse dragged" event. This <code>MouseEvent</code> ... *///Event.MOUSE_EXITint MOUSE_WHEEL;/** The "mouse wheel" event.  This is the only <code>MouseWheelEvent</code>. ... *///Event.MOUSE_DRAGint NOBUTTON;/** Indicates no mouse buttons; used by {@link #getButton}. ... */int BUTTON1;/** Indicates mouse button #1; used by {@link #getButton}. ... */int BUTTON2;/** Indicates mouse button #2; used by {@link #getButton}. ... */int BUTTON3;/** Indicates mouse button #3; used by {@link #getButton}. ... *//** The mouse event's x coordinate. ... *//** The mouse event's y coordinate. ... */int xAbs;/** The mouse event's x absolute coordinate. ... */int yAbs;/** The mouse event's y absolute coordinate. ... *//** Indicates the number of quick consecutive clicks of ... */int button;/** Indicates which, if any, of the mouse buttons has changed state. ... */boolean popupTrigger;/** A property used to indicate whether a Popup Menu ... */int cachedNumberOfButtons;/** A number of buttons available on the mouse at the {@code Toolkit} machinery startup. *//** Returns the absolute x, y position of the event. ... *//** Returns the absolute horizontal x position of the event. ... *//** Returns the absolute vertical y position of the event. ... *//** Constructs a <code>MouseEvent</code> object with the ... */Point eventLocationOnScreenthis.xAbseventLocationOnScreen.xthis.yAbseventLocationOnScreen.yIllegalComponentStateException eboolean shouldExcludeButtonFromExtModifiers;/* if the button is an extra button and it is released or clicked then in Xsystem its state ... */int tmpModifiersthis.popupTriggerthis.button/** Returns the horizontal x position of the event relative to the ... *//** Returns the vertical y position of the event relative to the ... *//** Returns the x,y position of the event relative to the source component. ... *//** Translates the event's coordinates to a new position ... *//** Returns the number of mouse clicks associated with this event. ... *//** Returns which, if any, of the mouse buttons has changed state. ... *//** Returns whether or not this mouse event is the popup menu ... *//** Returns a <code>String</code> instance describing the modifier keys and ... */getMouseModifiersText(...)//It's expected that some toolkits (Headless,//whatever besides SunToolkit) could also operate.// XToolkit: extra buttons are not reporting about their state correctly.// Being pressed they report the state=0 both on the press and on the release.// For 1-3 buttons the state value equals zero on press and non-zero on release.// Other modifiers like Shift, ALT etc seem report well with extra buttons.// The problem reveals as follows: one button is pressed and then another button is pressed and released.// So, the getModifiersEx() would not be zero due to a first button and we will skip this modifier.// This may have to be moved into the peer code instead if possible.//There is at least one more button in a pressed state.// TODO: add a toolkit field that holds a number of button on the mouse.// As the method getMouseModifiersText() is static and obtain// an integer as a parameter then we may not restrict this with the number// of buttons installed on the mouse.// It's a temporary solution. We need to somehow hold the number of buttons somewhere else.//1,2,3 buttons may already be there; so don't duplicate it.// (x,y) coordinates//Using plain "modifiers" here does show an excluded extended buttons in the string event representation.//getModifiersEx() solves the problem./** The listener interface for receiving "interesting" mouse events ... *//** Invoked when the mouse button has been clicked (pressed ... *//** Invoked when a mouse button has been pressed on a component. *//** Invoked when a mouse button has been released on a component. *//** Invoked when the mouse enters a component. *//** Invoked when the mouse exits a component. *//** An abstract adapter class for receiving mouse motion events. ... *//** Invoked when a mouse button is pressed on a component and then ... *//** The listener interface for receiving mouse motion events on a component. ... *//** Invoked when the mouse cursor has been moved onto a component ... *//** An event which indicates that the mouse wheel was rotated in a component. ... */int WHEEL_UNIT_SCROLL;/** Constant representing scrolling by "units" (like scrolling with the ... */int WHEEL_BLOCK_SCROLL;/** Constant representing scrolling by a "block" (like scrolling ... */int scrollType;/** Indicates what sort of scrolling should take place in response to this ... */int scrollAmount;/** Only valid for scrollType WHEEL_UNIT_SCROLL. ... */int wheelRotation;/** Indicates how far the mouse wheel was rotated. ... */double preciseWheelRotation;/** Constructs a <code>MouseWheelEvent</code> object with the ... *//** Constructs a <code>MouseWheelEvent</code> object with the specified ... */this.scrollTypethis.scrollAmountthis.wheelRotationthis.preciseWheelRotation/** Returns the type of scrolling that should take place in response to this ... *//** Returns the number of units that should be scrolled per ... *//** Returns the number of "clicks" the mouse wheel was rotated, as an integer. ... *//** Returns the number of "clicks" the mouse wheel was rotated, as a double. ... *//** This is a convenience method to aid in the implementation of ... */String scrollTypeStr/** The listener interface for receiving mouse wheel events on a component. ... *//** Invoked when the mouse wheel is rotated. ... *//** This is copied from java.awt.Toolkit since we need the library ... *//** The component-level paint event. ... */int PAINT_FIRST;/** Marks the first integer id for the range of paint event ids. */int PAINT_LAST;/** Marks the last integer id for the range of paint event ids. *//** The paint event type. *//** The update event type. */Rectangle updateRect;/** This is the rectangle that represents the area on the source ... *///801/** Constructs a <code>PaintEvent</code> object with the specified ... */this.updateRect/** Returns the rectangle representing the area which needs to be ... *//** Sets the rectangle representing the area which needs to be ... *//* Copyright (c) 1996, 2008, Oracle and/or its affiliates. All rights reserved. ... *//** A semantic event which indicates that an object's text changed. ... */int TEXT_FIRST;/** The first number in the range of ids used for text events. */int TEXT_LAST;/** The last number in the range of ids used for text events. */int TEXT_VALUE_CHANGED;/** This event id indicates that object's text changed. *//** Constructs a <code>TextEvent</code> object. ... *//** Returns a parameter string identifying this text event. ... *//** The listener interface for receiving text events. ... *//** Invoked when the value of the text has changed. ... *//** An abstract adapter class for receiving window events. ... *//** Invoked when a window has been opened. *//** Invoked when a window is in the process of being closed. ... *//** Invoked when a window has been closed. *//** Invoked when a window is iconified. *//** Invoked when a window is de-iconified. *//** Invoked when a window is activated. *//** Invoked when a window is de-activated. *//** Invoked when a window state is changed. ... *//** Invoked when the Window is set to be the focused Window, which means ... *//** Invoked when the Window is no longer the focused Window, which means ... *//** A low-level event that indicates that a window has changed its status. This ... */int WINDOW_FIRST;/** The first number in the range of ids used for window events. */int WINDOW_OPENED;/** The window opened event.  This event is delivered only ... */int WINDOW_CLOSING;/** The "window is closing" event. This event is delivered when ... */// 200int WINDOW_CLOSED;/** The window closed event. This event is delivered after the displayable ... *///Event.WINDOW_DESTROYint WINDOW_ICONIFIED;/** The window iconified event. This event is delivered when ... */int WINDOW_DEICONIFIED;/** The window deiconified event type. This event is delivered when ... *///Event.WINDOW_ICONIFYint WINDOW_ACTIVATED;/** The window-activated event type. This event is delivered when the Window ... *///Event.WINDOW_DEICONIFYint WINDOW_DEACTIVATED;/** The window-deactivated event type. This event is delivered when the ... */int WINDOW_GAINED_FOCUS;/** The window-gained-focus event type. This event is delivered when the ... */int WINDOW_LOST_FOCUS;/** The window-lost-focus event type. This event is delivered when a Window ... */int WINDOW_STATE_CHANGED;/** The window-state-changed event type.  This event is delivered ... */int WINDOW_LAST;/** The last number in the range of ids used for window events. */Window opposite;/** The other Window involved in this focus or activation change. For a ... */int oldState;/** TBS */int newState;/** Constructs a <code>WindowEvent</code> object. ... */this.oldStatethis.newState/** Constructs a <code>WindowEvent</code> object with the ... *//** Constructs a <code>WindowEvent</code> object with the specified ... *//** Returns the other Window involved in this focus or activation change. ... *//** For <code>WINDOW_STATE_CHANGED</code> events returns the ... *//** The listener interface for receiving <code>WindowEvents</code>, including ... *//** The listener interface for receiving window events. ... *//** Invoked the first time a window is made visible. *//** Invoked when the user attempts to close the window ... *//** Invoked when a window has been closed as the result ... *//** Invoked when a window is changed from a normal to a ... *//** Invoked when a window is changed from a minimized ... *//** Invoked when the Window is set to be the active Window. Only a Frame or ... *//** Invoked when a Window is no longer the active Window. Only a Frame or a ... *//** The listener interface for receiving window state events. ... *//** Invoked when window state is changed. */int begin;/** Sets the position to getBeginIndex() and returns the character at that ... *//** Sets the position to getEndIndex()-1 (getEndIndex() if the text is empty) ... *//** Gets the character at the current position (as returned by getIndex()). ... *//** Increments the iterator's index by one and returns the character ... *//** Decrements the iterator's index by one and returns the character ... *//** Sets the position to the specified position in the text and returns that ... *//** Returns the start index of the text. ... *//** Returns the end index of the text.  This index is the index of the first ... *//** Returns the current index. ... *//** Create a copy of this iterator ... */CharArrayIterator cnew CharArrayIterator(...)c.posthis.posthis.charsthis.beginimport RenderingHintsimport static RenderingHints.*/** The <code>FontRenderContext</code> class is a container for the ... */AffineTransform tx;Object aaHintValue;Object fmHintValue;boolean defaulting;/** Constructs a new <code>FontRenderContext</code> ... *//** Constructs a <code>FontRenderContext</code> object from an ... *//** Indicates whether or not this <code>FontRenderContext</code> object ... *//** Returns the integer type of the affine transform for this ... */AffineTransform.TYPE_IDENTITY/** Gets the transform that is used to scale typographical points ... *//** Returns a boolean which indicates whether or not some form of ... *//** Returns a boolean which whether text fractional metrics mode ... *//** Return the text anti-aliasing rendering mode hint used in this ... */isAntiAliased(...)/** Return the text fractional metrics rendering mode hint used in this ... */usesFractionalMetrics(...)/** Return true if obj is an instance of FontRenderContext and has the same ... *//** Return true if rhs has the same transform, antialiasing, ... */rhs.defaultingrhs.aaHintValuerhs.fmHintValuerhs.tx/** Return a hashcode for this FontRenderContext. *//* @author Charlton Innovations, Inc. *//* if neither instance is a subclass, reference values directly. *//* SunHints value objects have identity hashcode, so we can rely on ... *//** The <code>GlyphJustificationInfo</code> class represents information ... *//** Constructs information about the justification properties of a ... */priorityIsValid(...)this.weightthis.growAbsorbthis.growPrioritythis.growLeftLimitthis.growRightLimitthis.shrinkAbsorbthis.shrinkPrioritythis.shrinkLeftLimitthis.shrinkRightLimitint PRIORITY_KASHIDA;/** The highest justification priority. */int PRIORITY_WHITESPACE;/** The second highest justification priority. */int PRIORITY_INTERCHAR;/** The second lowest justification priority. */int PRIORITY_NONE;/** The lowest justification priority. */float weight;/** The weight of this glyph. */int growPriority;/** The priority level of this glyph as it is growing. */boolean growAbsorb;/** If <code>true</code>, this glyph absorbs all extra ... */float growLeftLimit;/** The maximum amount by which the left side of this glyph can grow. */float growRightLimit;/** The maximum amount by which the right side of this glyph can grow. */int shrinkPriority;/** The priority level of this glyph as it is shrinking. */boolean shrinkAbsorb;/** If <code>true</code>,this glyph absorbs all remaining shrinkage at ... */float shrinkLeftLimit;/** The maximum amount by which the left side of this glyph can shrink ... */float shrinkRightLimit;/** The maximum amount by which the right side of this glyph can shrink ... *//* (C) Copyright Taligent, Inc. 1996 - 1997, All Rights Reserved ... *//** The <code>GlyphMetrics</code> class represents information for a ... */boolean horizontal;/** Indicates whether the metrics are for a horizontal or vertical baseline. */float advanceX;/** The x-component of the advance. */float advanceY;/** The y-component of the advance. */Rectangle2D.Float bounds;/** The bounds of the associated glyph. */byte glyphType;/** Additional information about the glyph encoded as a byte. */byte STANDARD;/** Indicates a glyph that represents a single standard ... */byte LIGATURE;/** Indicates a glyph that represents multiple characters ... */byte COMBINING;/** Indicates a glyph that represents a combining character, ... */byte COMPONENT;/** Indicates a glyph with no corresponding character in the ... */byte WHITESPACE;/** Indicates a glyph with no visual representation. It can ... *//** Constructs a <code>GlyphMetrics</code> object. ... */this.horizontalthis.advanceXthis.advanceYthis.boundsthis.glyphType/** Returns the advance of the glyph along the baseline (either ... *//** Returns the x-component of the advance of the glyph. ... *//** Returns the y-component of the advance of the glyph. ... *//** Returns the bounds of the glyph. This is the bounding box of the glyph outline. ... *//** Returns the left (top) side bearing of the glyph. ... *//** Returns the right (bottom) side bearing of the glyph. ... *//** Returns the raw glyph type code. ... *//** Returns <code>true</code> if this is a standard glyph. ... *//** Returns <code>true</code> if this is a ligature glyph. ... *//** Returns <code>true</code> if this is a combining glyph. ... *//** Returns <code>true</code> if this is a component glyph. ... *//** Returns <code>true</code> if this is a whitespace glyph. ... */import GlyphMetricsimport GlyphJustificationInfo/** A <code>GlyphVector</code> object is a collection of glyphs ... *//** Returns the <code>Font</code> associated with this ... */// methods associated with creation-time state/** Returns the {@link FontRenderContext} associated with this ... *//** Assigns default positions to each glyph in this ... */// methods associated with the GlyphVector as a whole/** Returns the number of glyphs in this <code>GlyphVector</code>. ... *//** Returns the glyphcode of the specified glyph. ... *//** Returns an array of glyphcodes for the specified glyphs. ... *//** Returns the character index of the specified glyph. ... *//** Returns the character indices of the specified glyphs. ... */getGlyphCharIndex(...)/** Returns the logical bounds of this <code>GlyphVector</code>. ... *//** Returns the visual bounds of this <code>GlyphVector</code> ... *//** Returns the pixel bounds of this <code>GlyphVector</code> when ... */Rectangle2D rectgetVisualBounds(...)getMaxX(...)getMaxY(...)/** Returns a <code>Shape</code> whose interior corresponds to the ... */Shape sgetGlyphOutline(...)createTransformedShape(...)/** Returns the position of the specified glyph relative to the ... *//** Sets the position of the specified glyph within this ... *//** Returns the transform of the specified glyph within this ... *//** Sets the transform of the specified glyph within this ... *//** Returns flags describing the global state of the GlyphVector. ... */int FLAG_HAS_TRANSFORMS;/** A flag used with getLayoutFlags that indicates that this <code>GlyphVector</code> has ... */int FLAG_HAS_POSITION_ADJUSTMENTS;int FLAG_RUN_RTL;int FLAG_COMPLEX_GLYPHS;int FLAG_MASK;/** A mask for supported flags from getLayoutFlags.  Only bits covered by the mask ... *//** Returns an array of glyph positions for the specified glyphs. ... *//** Returns the logical bounds of the specified glyph within this ... *//** Returns the visual bounds of the specified glyph within the ... *//** Returns the pixel bounds of the glyph at index when this ... */getGlyphVisualBounds(...)/** Returns the metrics of the glyph at the specified index into ... *//** Returns the justification information for the glyph at ... *//** Tests if the specified <code>GlyphVector</code> exactly ... */// general utility methods// remind - need a floating point version/** This class is used with the CHAR_REPLACEMENT attribute. ... */Font.ROMAN_BASELINEFont.CENTER_BASELINEFont.HANGING_BASELINEint fAlignment;int TOP_ALIGNMENT;/** Aligns top of graphic to top of line. */int BOTTOM_ALIGNMENT;/** Aligns bottom of graphic to bottom of line. *//** Aligns origin of graphic to roman baseline of line. *//** Aligns origin of graphic to center baseline of line. *//** Aligns origin of graphic to hanging baseline of line. *//** Constructs a <code>GraphicAttribute</code>. ... *//** Returns the ascent of this <code>GraphicAttribute</code>.  A ... *//** Returns the descent of this <code>GraphicAttribute</code>.  A ... *//** Returns the advance of this <code>GraphicAttribute</code>.  The ... *//** Returns a {@link Rectangle2D} that encloses all of the ... *//** Return a {@link java.awt.Shape} that represents the region that ... */Shape b/** Renders this <code>GraphicAttribute</code> at the specified ... *//** Returns the alignment of this <code>GraphicAttribute</code>. ... *//** Returns the justification information for this ... */float advancenew GlyphJustificationInfo(...)// should we cache this?// weight// growAbsorb// growPriority// growLeftLimit// growRightLimit// shrinkAbsorb// shrinkPriority// shrinkLeftLimit// shrinkRightLimit/** The <code>ImageGraphicAttribute</code> class is an implementation of ... */Image fImage;float fImageWidth, ...;float fOriginX, ...;/** Constucts an <code>ImageGraphicAttribute</code> from the specified ... *//** Constructs an <code>ImageGraphicAttribute</code> from the specified ... *//** Returns the ascent of this <code>ImageGraphicAttribute</code>.  The ... *//** Returns the descent of this <code>ImageGraphicAttribute</code>. ... *//** Returns the advance of this <code>ImageGraphicAttribute</code>. ... *//** Returns a hashcode for this <code>ImageGraphicAttribute</code>. ... *//** Compares this <code>ImageGraphicAttribute</code> to the specified ... */rhs.fOriginXrhs.fOriginYgetAlignment(...)rhs.fImage// Can't clone image// fImage = (Image) image.clone();// ensure origin is in Image?/** LayoutPath provides a mapping between locations relative to the ... *//** Convert a point in user space to a location relative to the ... *//** Convert a location relative to the path to a point in user ... *//* (C) Copyright IBM Corp. 2005, All Rights Reserved. *//** The <code>LineBreakMeasurer</code> class allows styled text to be ... */BreakIterator breakIter;TextMeasurer measurer;CharArrayIterator charIter;/** Constructs a <code>LineBreakMeasurer</code> for the specified text. ... */getLineInstance(...)this.breakIterthis.measurernew TextMeasurer(...)this.limit/** Returns the position at the end of the next layout.  Does NOT ... */nextOffset(...)int charAtMaxAdvancegetLineBreakIndex(...)int testPos/** Returns the next layout, and updates the current position. ... */nextLayout(...)int layoutLimitTextLayout result/** Returns the current position of this <code>LineBreakMeasurer</code>. ... *//** Sets the current position of this <code>LineBreakMeasurer</code>. ... *//** Updates this <code>LineBreakMeasurer</code> after a single ... */insertChar(...)deleteChar(...)// Break is in a word;  back up to previous break.// NOTE:  I think that breakIter.preceding(limit) should be// equivalent to breakIter.last(), breakIter.previous() but// the authors of BreakIterator thought otherwise...// If they were equivalent then the first branch would be// unnecessary.// first word doesn't fit on line/** The <code>LineMetrics</code> class allows access to the ... *//** Returns the number of characters (<code>char</code> values) in the text whose ... *//** Returns the ascent of the text.  The ascent ... *//** Returns the descent of the text.  The descent ... *//** Returns the leading of the text. The ... *//** Returns the height of the text.  The ... *//** Returns the baseline index of the text. ... *//** Returns the baseline offsets of the text, ... *//** Returns the position of the strike-through line ... *//** Returns the thickness of the strike-through line. ... *//** Returns the position of the underline relative to ... *//** Returns the thickness of the underline. ... *//** The <code>MultipleMaster</code> interface represents Type 1 ... *//** Returns the number of multiple master design controls. ... *//** Returns an array of design limits interleaved in the form [from&rarr;to] ... *//** Returns an array of default design values for each axis.  For example, ... *//** Returns the name for each design axis. This also determines the order in ... *//** Creates a new instance of a multiple master font based on the design ... *//** Creates a new instance of a multiple master font based on detailed metric ... */import EnumSet/** The <code>NumericShaper</code> class is used to convert Latin-1 (European) ... */Range.EUROPEANcontexts.length/** A {@code NumericShaper.Range} represents a Unicode range of a ... */new Range(...)/** The Ethiopic range with the Ethiopic digits. Ethiopic ... *//** The Myanmar range with the Myanmar digits. *//** The Tibetan range with the Tibetan digits. *//** The Lao range with the Lao digits. *//** The Thai range with the Thai digits. *//** The Malayalam range with the Malayalam digits. *//** The Kannada range with the Kannada digits. *//** The Telugu range with the Telugu digits. *//** The Tamil range with the Tamil digits. *//** The Oriya range with the Oriya digits. *//** The Gujarati range with the Gujarati digits. *//** The Gurmukhi range with the Gurmukhi digits. *//** The Bengali range with the Bengali digits. *//** The Devanagari range with the Devanagari digits. *//** The Arabic range with the Eastern Arabic-Indic digits. *//** The Arabic range with the Arabic-Indic digits. *//** The Latin (European) range with the Latin (ASCII) digits. */// with the bitmask-based constants.// The order of EUROPEAN to MOGOLIAN must be consistentRange EUROPEAN;Range ARABIC;Range EASTERN_ARABIC;Range DEVANAGARI;Range BENGALI;Range GURMUKHI;Range GUJARATI;Range ORIYA;Range TAMIL;Range TELUGU;Range KANNADA;Range MALAYALAM;Range THAI;Range LAO;Range TIBETAN;Range MYANMAR;Range ETHIOPIC;Range KHMER;/** The Khmer range with the Khmer digits. */Range MONGOLIAN;/** The Mongolian range with the Mongolian digits. */Range NKO;/** The N'Ko range with the N'Ko digits. */Range MYANMAR_SHAN;/** The Myanmar range with the Myanmar Shan digits. */Range LIMBU;/** The Limbu range with the Limbu digits. */Range NEW_TAI_LUE;/** The New Tai Lue range with the New Tai Lue digits. */Range BALINESE;/** The Balinese range with the Balinese digits. */Range SUNDANESE;/** The Sundanese range with the Sundanese digits. */Range LEPCHA;/** The Lepcha range with the Lepcha digits. */Range OL_CHIKI;/** The Ol Chiki range with the Ol Chiki digits. */Range VAI;/** The Vai range with the Vai digits. */Range SAURASHTRA;/** The Saurashtra range with the Saurashtra digits. */Range KAYAH_LI;/** The Kayah Li range with the Kayah Li digits. */Range CHAM;/** The Cham range with the Cham digits. */Range TAI_THAM_HORA;/** The Tai Tham Hora range with the Tai Tham Hora digits. */Range TAI_THAM_THAM;/** The Tai Tham Tham range with the Tai Tham Tham digits. */Range JAVANESE;/** The Javanese range with the Javanese digits. */Range MEETEI_MAYEK;/** The Meetei Mayek range with the Meetei Mayek digits. */Range rangeSet<Range> setnoneOf(...)Range.classRange[] aint base;// base character of range digits// Unicode range// exclusivethis.basegetNumericBase(...)/** index of context for contextual shaping - values range from 0 to 18 *//** flag indicating whether to shape contextually (high bit) and which ... */Range shapingRange;/** The context {@code Range} for contextual shaping or the {@code ... */Set<Range> rangeSet;/** {@code Set<Range>} indicating which Unicode ranges to ... */...[] rangeArray;/** rangeSet.toArray() value. Sorted by Range.base when the number ... */int BSEARCH_THRESHOLD;/** If more than BSEARCH_THRESHOLD ranges are specified, binary search is used. */int EUROPEAN;/** Identifies the Latin-1 (European) and extended range, and ... */int ARABIC;/** Identifies the ARABIC range and decimal base. */int EASTERN_ARABIC;/** Identifies the ARABIC range and ARABIC_EXTENDED decimal base. */int DEVANAGARI;/** Identifies the DEVANAGARI range and decimal base. */int BENGALI;/** Identifies the BENGALI range and decimal base. */int GURMUKHI;/** Identifies the GURMUKHI range and decimal base. */int GUJARATI;/** Identifies the GUJARATI range and decimal base. */int ORIYA;/** Identifies the ORIYA range and decimal base. */int TAMIL;// TAMIL DIGIT ZERO was added in Unicode 4.1/** Identifies the TAMIL range and decimal base. */int TELUGU;/** Identifies the TELUGU range and decimal base. */int KANNADA;/** Identifies the KANNADA range and decimal base. */int MALAYALAM;/** Identifies the MALAYALAM range and decimal base. */int THAI;/** Identifies the THAI range and decimal base. */int LAO;/** Identifies the LAO range and decimal base. */int TIBETAN;/** Identifies the TIBETAN range and decimal base. */int MYANMAR;/** Identifies the MYANMAR range and decimal base. */int ETHIOPIC;/** Identifies the ETHIOPIC range and decimal base. */int KHMER;/** Identifies the KHMER range and decimal base. */int MONGOLIAN;/** Identifies the MONGOLIAN range and decimal base. */int ALL_RANGES;/** Identifies all ranges, for full contextual shaping. ... */int EUROPEAN_KEY;int ARABIC_KEY;int EASTERN_ARABIC_KEY;int DEVANAGARI_KEY;int BENGALI_KEY;int GURMUKHI_KEY;int GUJARATI_KEY;int ORIYA_KEY;int TAMIL_KEY;int TELUGU_KEY;int KANNADA_KEY;int MALAYALAM_KEY;int THAI_KEY;int LAO_KEY;int TIBETAN_KEY;int MYANMAR_KEY;int ETHIOPIC_KEY;int KHMER_KEY;int MONGOLIAN_KEY;int NUM_KEYS;int CONTEXTUAL_MASK;// fixed...[] bases;...[] contexts;// some ranges adjoin or overlap, rethink if we want to do a binary search on thisint ctCache;// and a linear probe is ok.// assume most characters are near each other so probing the cache is infrequent,int ctCacheLimit;// warning, synchronize access to this as it modifies stateRange currentRange;// cache for the NumericShaper.Range versionRange[] rangesinRange(...)ranges.lengthrange.startrange.end...[] strongTable;/* A range table of strong directional characters (types L, R, AL). ... */int stCache;// use a binary search with a cacheint cachedIndexstrongTable.length/** Returns a shaper for the provided unicode range.  All ... */getKeyFromMask(...)new NumericShaper(...)/** Returns a shaper for the provided Unicode ... *//** Returns a contextual shaper for the provided unicode range(s). ... *//** Returns a contextual shaper for the provided Unicode ... */NumericShaper shapershaper.mask/** Returns a contextual shaper for the provided Unicode range(s). ... */this.maskRange.EASTERN_ARABICRange.ARABICRange.TAI_THAM_THAMRange.TAI_THAM_HORAnew Range[]rangeArray.lengths1.bases2.base/** Converts the digits in the text that occur between start and ... */checkParams(...)isContextual(...)shapeContextually(...)shapeNonContextually(...)int ctxKey/** Converts the digits in the text that occur between {@code ... */toRangeIndex(...)text.length/** Returns a <code>boolean</code> indicating whether or not ... *//** Returns an <code>int</code> that ORs together the values for ... *//** Returns a {@code Set} representing all the Unicode ranges in ... */maskToRangeSet(...)/** Perform non-contextual shaping. */char minDigitgetDigitBase(...)/** Perform contextual shaping. ... */int lastkeyisStrongDirectional(...)int newkeygetContextKey(...)Range lastKeyrangeForCodePoint(...)/** Returns a hash code for this shaper. ... *//** Returns {@code true} if the specified object is an instance of ... */NumericShaper rhsrhs.rangeSetrhs.shapingRangerhs.maskindexToRange(...)rhs.keySet<Range> rsetRange srange/** Returns a <code>String</code> that describes this shaper. This method ... */String[] keyNames/** Returns the index of the high bit in value (assuming le, actually ... *//** fast binary search over subrange of array. */int powergetHighBit(...)int extra/** Converts the {@code NumericShaper.Range} enum-based parameters, ... */toRangeMask(...)// inclusive// EUROPEAN// ARABIC-INDIC// EXTENDED ARABIC-INDIC (EASTERN_ARABIC)// DEVANAGARI// BENGALI// GURMUKHI// GUJARATI// ORIYA// TAMIL - zero was added in Unicode 4.1// TELUGU// KANNADA// MALAYALAM// THAI// LAO// TIBETAN// MYANMAR// ETHIOPIC - no zero// KHMER// MONGOLIAN// 'EUROPEAN' (really latin-1 and extended)// ARABIC// EASTERN_ARABIC -- note overlap with arabic// TAMIL// ETHIOPIC - note missing zero// if we're not in a known range, then return EUROPEAN as the range key// sentinel// throws NPE if ranges is null.// Give precedance to EASTERN_ARABIC if both ARABIC and// EASTERN_ARABIC are specified.// As well as the above case, give precedance to TAI_THAM_THAM if both// TAI_THAM_HORA and TAI_THAM_THAM are specified.// sort rangeArray for binary search// Ethiopic doesn't use decimal zero// if we don't support this context, then don't shape// if we don't support the specified context, then don't shape.// Use the CONTEXTUAL_MASK bit only for the enum-based// NumericShaper. A deserialized NumericShaper might have// bit masks./** The <code>OpenType</code> interface represents OpenType and ... */int TAG_CMAP;/** Character to glyph mapping.  Table tag "cmap" in the Open ... *//* 51 tag types so far */int TAG_HEAD;/** Font header.  Table tag "head" in the Open ... */int TAG_NAME;/** Naming table.  Table tag "name" in the Open ... */int TAG_GLYF;/** Glyph data.  Table tag "glyf" in the Open ... */int TAG_MAXP;/** Maximum profile.  Table tag "maxp" in the Open ... */int TAG_PREP;/** CVT preprogram.  Table tag "prep" in the Open ... */int TAG_HMTX;/** Horizontal metrics.  Table tag "hmtx" in the Open ... */int TAG_KERN;/** Kerning.  Table tag "kern" in the Open ... */int TAG_HDMX;/** Horizontal device metrics.  Table tag "hdmx" in the Open ... */int TAG_LOCA;/** Index to location.  Table tag "loca" in the Open ... */int TAG_POST;/** PostScript Information.  Table tag "post" in the Open ... */int TAG_OS2;/** OS/2 and Windows specific metrics.  Table tag "OS/2" ... */int TAG_CVT;/** Control value table.  Table tag "cvt " ... */int TAG_GASP;/** Grid-fitting and scan conversion procedure.  Table tag ... */int TAG_VDMX;/** Vertical device metrics.  Table tag "VDMX" in the Open ... */int TAG_VMTX;/** Vertical metrics.  Table tag "vmtx" in the Open ... */int TAG_VHEA;/** Vertical metrics header.  Table tag "vhea" in the Open ... */int TAG_HHEA;/** Horizontal metrics header.  Table tag "hhea" in the Open ... */int TAG_TYP1;/** Adobe Type 1 font data.  Table tag "typ1" in the Open ... */int TAG_BSLN;/** Baseline table.  Table tag "bsln" in the Open ... */int TAG_GSUB;/** Glyph substitution.  Table tag "GSUB" in the Open ... */int TAG_DSIG;/** Digital signature.  Table tag "DSIG" in the Open ... */int TAG_FPGM;/** Font program.   Table tag "fpgm" in the Open ... */int TAG_FVAR;/** Font variation.   Table tag "fvar" in the Open ... */int TAG_GVAR;/** Glyph variation.  Table tag "gvar" in the Open ... */int TAG_CFF;/** Compact font format (Type1 font).  Table tag ... */int TAG_MMSD;/** Multiple master supplementary data.  Table tag ... */int TAG_MMFX;/** Multiple master font metrics.  Table tag ... */int TAG_BASE;/** Baseline data.  Table tag "BASE" in the Open ... */int TAG_GDEF;/** Glyph definition.  Table tag "GDEF" in the Open ... */int TAG_GPOS;/** Glyph positioning.  Table tag "GPOS" in the Open ... */int TAG_JSTF;/** Justification.  Table tag "JSTF" in the Open ... */int TAG_EBDT;/** Embedded bitmap data.  Table tag "EBDT" in the Open ... */int TAG_EBLC;/** Embedded bitmap location.  Table tag "EBLC" in the Open ... */int TAG_EBSC;/** Embedded bitmap scaling.  Table tag "EBSC" in the Open ... */int TAG_LTSH;/** Linear threshold.  Table tag "LTSH" in the Open ... */int TAG_PCLT;/** PCL 5 data.  Table tag "PCLT" in the Open ... */int TAG_ACNT;/** Accent attachment.  Table tag "acnt" in the Open ... */int TAG_AVAR;/** Axis variation.  Table tag "avar" in the Open ... */int TAG_BDAT;/** Bitmap data.  Table tag "bdat" in the Open ... */int TAG_BLOC;/** Bitmap location.  Table tag "bloc" in the Open ... */int TAG_CVAR;/** CVT variation.  Table tag "cvar" in the Open ... */int TAG_FEAT;/** Feature name.  Table tag "feat" in the Open ... */int TAG_FDSC;/** Font descriptors.  Table tag "fdsc" in the Open ... */int TAG_FMTX;/** Font metrics.  Table tag "fmtx" in the Open ... */int TAG_JUST;/** Justification.  Table tag "just" in the Open ... */int TAG_LCAR;/** Ligature caret.   Table tag "lcar" in the Open ... */int TAG_MORT;/** Glyph metamorphosis.  Table tag "mort" in the Open ... */int TAG_OPBD;/** Optical bounds.  Table tag "opbd" in the Open ... */int TAG_PROP;/** Glyph properties.  Table tag "prop" in the Open ... */int TAG_TRAK;/** Tracking.  Table tag "trak" in the Open ... *//** Returns the version of the <code>OpenType</code> font. ... *//** Returns the table as an array of bytes for a specified tag. ... *//** Returns a subset of the table as an array of bytes ... *//** Returns the size of the table for a specified tag. Tags for sfnt ... *//** The <code>ShapeGraphicAttribute</code> class is an implementation of ... */Shape fShape;boolean fStroke;boolean STROKE;/** A key indicating the shape should be stroked with a 1-pixel wide stroke. */boolean FILL;/** A key indicating the shape should be filled. */Rectangle2D fShapeBounds;// cache shape bounds, since GeneralPath doesn't/** Constructs a <code>ShapeGraphicAttribute</code> for the specified ... *//** Returns the ascent of this <code>ShapeGraphicAttribute</code>.  The ... *//** Returns the descent of this <code>ShapeGraphicAttribute</code>. ... *//** Returns the advance of this <code>ShapeGraphicAttribute</code>. ... */Float bounds/** Returns a hashcode for this <code>ShapeGraphicAttribute</code>. ... *//** Compares this <code>ShapeGraphicAttribute</code> to the specified ... */rhs.fStrokerhs.fShape// translating graphics to draw Shape !!!// REMIND: set stroke to correct sizeimport Decorationimport FontResolverimport CodePointIterator/** This class stores Font, GraphicAttribute, and Decoration intervals ... */// the length of the paragraphDecoration decoration;// is stored here.  Otherwise this field is ignored.// If there is a single Decoration for the whole paragraph, itObject font;// paragraph, it is stored here.  Otherwise this field is ignored.// If there is a single Font or GraphicAttribute for the wholeVector<Decoration> decorations;// the decorationStarts array are null.// stored in this Vector, in order.  Otherwise this vector and// If there are multiple Decorations in the paragraph, they are...[] decorationStarts;// end of this array with the length of the paragraph.// starts.  For convenience, there is an extra entry at the// decorationStarts[i] contains the index where decoration i// If there are multiple Decorations in the paragraph,Vector<Object> fonts;// the fontStarts array are null.// they are// If there are multiple Fonts/GraphicAttributes in the paragraph,...[] fontStarts;// fontStarts[i] contains the index where decoration i/** Create a new StyledParagraph over the given styled text. ... */int nextRunStartgetRunLimit(...)int localIndexMap<? extends Attribute,?> attributesDecoration dgetDecoration(...)getGraphicOrFont(...)addInputMethodAttrs(...)addDecoration(...)addFonts(...)addFont(...)addToVector(...)/** Adjust indices in starts to reflect an insertion after pos. ... *//** Return a StyledParagraph reflecting the insertion of a single character ... */int relativePosgetDecorationAt(...)new StyledParagraph(...)FontResolver resolverint fontIndexgetFontIndex(...)getFontOrGraphicAt(...)oldParagraph.lengtholdParagraph.decorationsinsertInto(...)oldParagraph.decorationStartsoldParagraph.fontsoldParagraph.fontStarts/** Adjust indices in starts to reflect a deletion after deleteAt. ... */deleteFrom(...)/** Return the index at which there is a different Font, GraphicAttribute, or ... */int limit1int limit2int runfindRunContaining(...)/** Return the Decoration in effect at the given index. ... *//** Return the Font or GraphicAttribute in effect at the given index. ... *//** Return i such that starts[i] &lt;= index &lt; starts[i+1].  starts ... *//** Append the given Object to the given Vector.  Add ... */starts.length/** Add a new Decoration run with the given Decoration at the ... */new Vector<Decoration>(...)/** Add a new Font/GraphicAttribute run with the given object at the ... *//** Resolve the given chars into Fonts using FontResolver, then add ... */CodePointIterator iterint runStartcharIndex(...)nextFontRunIndex(...)/** Return a Map with entries from oldStyles, as well as input ... */InputMethodHighlight hlMap<? extends Attribute,?> imStylesmapInputMethodHighlight(...)HashMap<Attribute,Object> newStylesnew HashMap<Attribute,Object>(...)/** Extract a GraphicAttribute or Font from the given attributes. ... *//* (C) Copyright IBM Corp. 1999,  All rights reserved. */// Add extra entries to starts arrays with the length// of the paragraph.  'this' is used as a dummy value// in the Vector.// If the styles at insertPos match those at insertPos-1,// oldParagraph will be reused.  Otherwise we create a new// paragraph.// insert into existing paragraph// We will reuse oldParagraph unless there was a length-1 run// at deletePos.  We could do more work and check the individual// Font and Decoration runs, but we don't right now.../** The <code>TextAttribute</code> class defines attribute keys and ... */new HashMap<String,TextAttribute>(...)new TextAttribute(...)Map<String,TextAttribute> instanceMap;// table of all instances in this class, used by readResolve/** Constructs a <code>TextAttribute</code> with the specified name. ... *//** Resolves instances being deserialized to the predefined constants. */TextAttribute instance// This shouldn't happen in real life.// deserialize INPUT_METHOD_UNDERLINE.// 1.2 will throw an InvalidObjectException if ever asked to// Serialization compatibility with Java 2 platform v1.2.TextAttribute FAMILY;/** Attribute key for the font name.  Values are instances of ... */// For use with Font.TextAttribute WEIGHT;/** Attribute key for the weight of a font.  Values are instances ... */Float WEIGHT_EXTRA_LIGHT;/** The lightest predefined weight. ... */Float WEIGHT_LIGHT;/** The standard light weight. ... */Float WEIGHT_DEMILIGHT;/** An intermediate weight between <code>WEIGHT_LIGHT</code> and ... */Float WEIGHT_REGULAR;/** The standard weight. This is the default value for <code>WEIGHT</code>. ... */Float WEIGHT_SEMIBOLD;/** A moderately heavier weight than <code>WEIGHT_REGULAR</code>. ... */Float WEIGHT_MEDIUM;/** An intermediate weight between <code>WEIGHT_REGULAR</code> and ... */Float WEIGHT_DEMIBOLD;/** A moderately lighter weight than <code>WEIGHT_BOLD</code>. ... */Float WEIGHT_BOLD;/** The standard bold weight. ... */Float WEIGHT_HEAVY;/** A moderately heavier weight than <code>WEIGHT_BOLD</code>. ... */Float WEIGHT_EXTRABOLD;/** An extra heavy weight. ... */Float WEIGHT_ULTRABOLD;/** The heaviest predefined weight. ... */TextAttribute WIDTH;/** Attribute key for the width of a font.  Values are instances of ... */Float WIDTH_CONDENSED;/** The most condensed predefined width. ... */Float WIDTH_SEMI_CONDENSED;/** A moderately condensed width. ... */Float WIDTH_REGULAR;/** The standard width. This is the default value for ... */Float WIDTH_SEMI_EXTENDED;/** A moderately extended width. ... */Float WIDTH_EXTENDED;/** The most extended predefined width. ... */TextAttribute POSTURE;/** Attribute key for the posture of a font.  Values are instances ... */Float POSTURE_REGULAR;/** The standard posture, upright.  This is the default value for ... */Float POSTURE_OBLIQUE;/** The standard italic posture. ... */TextAttribute SIZE;/** Attribute key for the font size.  Values are instances of ... */TextAttribute TRANSFORM;/** Attribute key for the transform of a font.  Values are ... */TextAttribute SUPERSCRIPT;/** Attribute key for superscripting and subscripting.  Values are ... */Integer SUPERSCRIPT_SUPER;/** Standard superscript. ... */Integer SUPERSCRIPT_SUB;/** Standard subscript. ... */TextAttribute FONT;/** Attribute key used to provide the font to use to render text. ... */TextAttribute CHAR_REPLACEMENT;/** Attribute key for a user-defined glyph to display in lieu ... */TextAttribute FOREGROUND;/** Attribute key for the paint used to render the text.  Values are ... */// Adornments added to text.TextAttribute BACKGROUND;/** Attribute key for the paint used to render the background of ... */TextAttribute UNDERLINE;/** Attribute key for underline.  Values are instances of ... */Integer UNDERLINE_ON;/** Standard underline. ... */TextAttribute STRIKETHROUGH;/** Attribute key for strikethrough.  Values are instances of ... */Boolean STRIKETHROUGH_ON;/** A single strikethrough. ... */TextAttribute RUN_DIRECTION;/** Attribute key for the run direction of the line.  Values are ... */// Attributes use to control layout of text on a line.Boolean RUN_DIRECTION_LTR;/** Left-to-right run direction. ... */Boolean RUN_DIRECTION_RTL;/** Right-to-left run direction. ... */TextAttribute BIDI_EMBEDDING;/** Attribute key for the embedding level of the text.  Values are ... */TextAttribute JUSTIFICATION;/** Attribute key for the justification of a paragraph.  Values are ... */Float JUSTIFICATION_FULL;/** Justify the line to the full requested width.  This is the ... */Float JUSTIFICATION_NONE;/** Do not allow the line to be justified. ... */TextAttribute INPUT_METHOD_HIGHLIGHT;/** Attribute key for input method highlight styles. ... */// For use by input method.TextAttribute INPUT_METHOD_UNDERLINE;/** Attribute key for input method underlines.  Values ... */Integer UNDERLINE_LOW_ONE_PIXEL;/** Single pixel solid low underline. ... */Integer UNDERLINE_LOW_TWO_PIXEL;/** Double pixel solid low underline. ... */Integer UNDERLINE_LOW_DOTTED;/** Single pixel dotted low underline. ... */Integer UNDERLINE_LOW_GRAY;/** Double pixel gray low underline. ... */Integer UNDERLINE_LOW_DASHED;/** Single pixel dashed low underline. ... */TextAttribute SWAP_COLORS;/** Attribute key for swapping foreground and background ... */Boolean SWAP_COLORS_ON;/** Swap foreground and background. ... */TextAttribute NUMERIC_SHAPING;/** Attribute key for converting ASCII decimal digits to other ... */TextAttribute KERNING;/** Attribute key to request kerning. Values are instances of ... */Integer KERNING_ON;/** Request standard kerning. ... */TextAttribute LIGATURES;/** Attribute key for enabling optional ligatures. Values are ... */Integer LIGATURES_ON;/** Request standard optional ligatures. ... */TextAttribute TRACKING;/** Attribute key to control tracking.  Values are instances of ... */Float TRACKING_TIGHT;/** Perform tight tracking. ... */Float TRACKING_LOOSE;/** Perform loose tracking. ... */import String/** The <code>TextHitInfo</code> class represents a character position in a ... */int charIndex;boolean isLeadingEdge;/** Constructs a new <code>TextHitInfo</code>. ... */this.charIndexthis.isLeadingEdge/** Returns the index of the character hit. ... *//** Returns <code>true</code> if the leading edge of the character was ... *//** Returns the insertion index.  This is the character index if ... *//** Returns the hash code. ... *//** Returns <code>true</code> if the specified <code>Object</code> is a ... *//** Returns <code>true</code> if the specified <code>TextHitInfo</code> ... */hitInfo.charIndexhitInfo.isLeadingEdge/** Returns a <code>String</code> representing the hit for debugging ... *//** Creates a <code>TextHitInfo</code> on the leading edge of the ... */new TextHitInfo(...)/** Creates a hit on the trailing edge of the character at ... *//** Creates a <code>TextHitInfo</code> at the specified offset, ... *//** Creates a <code>TextHitInfo</code> on the other side of the ... */trailing(...)leading(...)/** Creates a <code>TextHitInfo</code> whose character index is offset ... *//* one info for each side of each glyph ... */...[] info;/** Initialize the justifier with an array of infos corresponding to each ... */GlyphJustificationInfo gjigji.growRightLimitgji.growLeftLimitgji.growPrioritygji.weightint MAX_PRIORITY;/** Return an array of deltas twice as long as the original info array, ... */float[] deltasinfo.lengthboolean growint fallbackPriorityboolean lastPassfloat weightfloat gslimitfloat absorbweightboolean hitLimitboolean absorbingfloat weightedDeltafloat weightedAbsorbGlyphJustificationInfo gigi.growPrioritygi.shrinkPrioritygi.weightgi.growLeftLimitgi.growAbsorbgi.shrinkLeftLimitgi.shrinkAbsorbgi.growRightLimitgi.shrinkRightLimitfloat total// make separate passes through glyphs in order of decreasing priority// until justifyDelta is zero or we run out of priorities./* special case 'fallback' iteration, set flag and recheck ... */// pass through glyphs, first collecting weights and limits// ignore left of first character// ignore right of last character// did we hit the limit?// negative for negative deltas// predivide delta by weight// not used if weight == 0// now allocate this based on ratio of weight to total weight// ignore left// factor in sign// sign factored in already// ignore right// stop iterationimport NumericShaperimport TextLineMetricsimport GeneralPathimport AttributedStringimport GraphicComponentimport LayoutPathImpl/** <code>TextLayout</code> is an immutable graphical representation of styled ... */new CaretPolicy(...)int characterCount;boolean isVerticalLine;byte baseline;...[] baselineOffsets;TextLine textLine;// why have these ?TextLine.TextLineMetrics lineMetrics;TextLine.TextLineMetrics// all are recomputed from scratch in buildCache()// cached values computed from GlyphSets and set info:float visibleAdvance;int hashCodeCache;boolean cacheIsValid;/* TextLayouts are supposedly immutable.  If you mutate a TextLayout under ... */float justifyRatio;// interval [0,1].  If 0, the layout cannot be justified.// This value is obtained from an attribute, and constrained to thefloat ALREADY_JUSTIFIED;// justifyRatio of the justified layout is set to this value.// cannot be justified.  To enforce this constraint the// If a layout is produced by justification, then that layoutfloat dx;// instances.// They are static now so they don't take up space in TextLayout// anyone who implements hanging punctuation or other similar stuff.// values right now.  They were left in as an aide and reminder to// and TextLayout is not guaranteed to work with non-zero dx, dy// which is no longer implemented.  Currently they are both always 0,// actually).  They were used for hanging punctuation support,// and the origin of the leftmost GlyphSet (TextLayoutComponent,// dx and dy specify the distance between the TextLayout's originfloat dy;Rectangle2D naturalBounds;/* Natural bounds is used internally.  It is built on demand in ... */Rectangle2D boundsRect;/* boundsRect encloses all of the bits this TextLayout can draw.  It ... */boolean caretsInLigaturesAreAllowed;/* flag to supress/allow carets inside of ligatures when hit testing or ... *//** Defines a policy for determining the strong caret location. ... *//** Constructs a <code>CaretPolicy</code>. *//** Chooses one of the specified <code>TextHitInfo</code> instances as ... */getStrongHit(...)CaretPolicy DEFAULT_CARET_POLICY;/** This <code>CaretPolicy</code> is used when a policy is not specified ... *//** Constructs a <code>TextLayout</code> from a <code>String</code> ... */char[] texthasLayoutAttributes(...)sameBaselineUpTo(...)fastInit(...)AttributedString asnew AttributedString(...)standardInit(...)singleFont(...)/* Determines a font for the attributes, and if a single font can render ... */canDisplayUpTo(...)/** Constructs a <code>TextLayout</code> from an iterator over styled text. ... *//** Creates a <code>TextLayout</code> from a {@link TextLine} and ... */this.characterCountcharacterCount(...)this.baselinethis.baselineOffsetsthis.textLinethis.justifyRatio/** Initialize the paragraph-specific data. */getNumericShaping(...)getNormalizedOffsets(...)lm.baselineOffsetsgetJustification(...)shape(...)/* the fast init generates a single glyph set.  This requires: ... */LineMetrics lmbyte glyphBaselinecm.baselineIndexcm.baselineOffsetsparagraphInit(...)fastCreateTextLine(...)/* the standard init generates multiple glyph sets based on style, ... */Map<? extends Attribute,?> paragraphAttrsboolean haveFontadvanceToFirstFont(...)getFontAtCurrentPos(...)int charsStartGraphicAttribute graphicbyte defaultBaselinegetBaselineFromGraphic(...)createCoreMetrics(...)standardCreateTextLine(...)/* A utility to rebuild the ascent/descent/leading/advance cache. ... */buildCache(...)isDirectionLTR(...)int lastNonSpaceint logIndexvisualToLogical(...)isCharSpace(...)lineMetrics.advancegetCharLinePosition(...)getCharAdvance(...)int leftmostNonSpacefloat pos/** The 'natural bounds' encloses all the carets the layout can draw. */ensureCache(...)getItalicBounds(...)/** Creates a copy of this <code>TextLayout</code>. *//* Utility to throw an expection if an invalid TextHitInfo is passed ... */getInsertionIndex(...)/** Creates a copy of this <code>TextLayout</code> justified to the ... */TextLine newLinegetJustifiedLine(...)/** Justify this layout.  Overridden by subclassers to control justification ... *//** Returns the baseline for this <code>TextLayout</code>. ... *//** Returns the offsets array for the baselines used for this ... */float[] offsetsbaselineOffsets.lengthoffsets.length/** Returns the advance of this <code>TextLayout</code>. ... *//** Returns the advance of this <code>TextLayout</code>, minus trailing ... *//** Returns the ascent of this <code>TextLayout</code>. ... */lineMetrics.ascent/** Returns the descent of this <code>TextLayout</code>. ... */lineMetrics.descent/** Returns the leading of the <code>TextLayout</code>. ... */lineMetrics.leading/** Returns the bounds of this <code>TextLayout</code>. ... */Rectangle2D vb/** Returns the pixel bounds of this <code>TextLayout</code> when ... */getPixelBounds(...)/** Returns <code>true</code> if this <code>TextLayout</code> has ... *//** Returns <code>true</code> if this <code>TextLayout</code> is vertical. ... *//** Returns the number of characters represented by this ... *//* carets and hit testing ... */float top1Xfloat top2Xfloat bottom1Xfloat bottom2Xfloat topXfloat bottomXfloat anglegetCharAngle(...)float shiftgetCharShift(...)getCharAscent(...)getCharDescent(...)float angle1float pos1float angle2float pos2/** Returns information about the caret corresponding to <code>hit</code>. ... */checkTextHit(...)getCaretInfoTestInternal(...)// but otherwise independent of it.// these  values are trimmed to the bounds where required to fit,// natural ascent and descent.// using the hit character's offset (baseline + ssoffset) and// the next four values are the endpoints of the caret, as computed// the first two values are as above// this version provides extra info in the float arrayfloat[] infodouble iangledouble ixbasedouble p1xdouble p1ydouble p2xdouble p2yint charixgetCharIndex(...)boolean leadisLeadingEdge(...)isVertical(...)getCaretInfo(...)hitToCaret(...)TextLineMetrics mboolean lowm.advancem.ascentm.descentCoreMetrics thiscmgetCoreMetricsAt(...)thiscm.italicAnglethiscm.baselineIndexGraphicAttribute.TOP_ALIGNMENTthiscm.heightfloat bothiscm.ssOffsetthiscm.ascentthiscm.descentgetNaturalBounds(...)/** Returns a caret index corresponding to <code>hit</code>. ... */int hitIndexint visIndexlogicalToVisual(...)isCharLTR(...)/** Given a caret index, return a hit whose caret is at the index. ... */int charIndexboolean leadingcaretAtOffsetIsValid(...)/** Returns the hit for the next caret to the right (bottom); if there ... */int caretcaretIsValid(...)caretToHit(...)/** Returns the hit for the next caret to the right (bottom); if no ... */TextHitInfo hit1afterOffset(...)TextHitInfo hit2getOtherHit(...)TextHitInfo nextHitgetNextRightHit(...)getStrongCaret(...)TextHitInfo otherHitgetVisualOtherHit(...)/** Returns the hit for the next caret to the left (top); if no such ... *//** Returns the hit for the next caret to the left (top); if no ... */getNextLeftHit(...)/** Returns the hit on the opposite side of the specified hit's caret. ... */int hitCharIndexboolean movedToRight/** Return an array of four floats corresponding the endpoints of the caret ... */double posdouble x0double y0double leftdouble rightdouble topdouble bottomboolean threePointsGeneralPath resultnew GeneralPath(...)GeneralPath.WIND_EVEN_ODDmapShape(...)/** Returns a {@link Shape} representing the caret at the specified ... */pathToShape(...)getCaretPath(...)getLayoutPath(...)/** Returns a <code>Shape</code> representing the caret at the specified ... */getCaretShape(...)/** Return the "stronger" of the TextHitInfos.  The TextHitInfos ... */byte hit1LevelgetCharacterLevel(...)byte hit2Level/** Returns the level of the character at <code>index</code>. ... */getCharLevel(...)/** Returns two paths corresponding to the strong and weak caret. ... */Shape[] resultnew Shape[]TextHitInfo hitint hitCaretLayoutPathImpl lpShape hitShapeint otherCaretShape otherShapeTextHitInfo strongHitboolean hitIsStronggetCaretShapes(...)// {jbr} no assumptions about size of path0, path1 anymore.// Path0 must be left or top of path1// A utility to return a path enclosing the given pathboolean sameDirectionint incrementpath0.lengthpath1.length// {jbr} Shape is never outside of bounds.// A utility to convert a pair of carets into a bounding pathboundingShape(...)/* A utility to return the path bounding the area to the left (top) of the ... */double[] path0double[] path1/* A utility to return the path bounding the area to the right (bottom) of ... *//** Returns the logical ranges of text corresponding to a visual selection. ... */boolean[] includedint limitIndexboolean inrun/** Returns a path enclosing the visual selection in the specified range, ... */int firstCaretint secondCaretcaretBoundingShape(...)GeneralPath lsleftShape(...)GeneralPath rsrightShape(...)/** Returns a <code>Shape</code> enclosing the visual selection in the ... */getVisualHighlightShape(...)/** Returns a <code>Shape</code> enclosing the logical selection in the ... */int[] caretsint hitChcarets.lengthgetLogicalHighlightShape(...)/** Returns the black box bounds of the characters in the specified range. ... */GeneralPath.WIND_NON_ZERORectangle2D rgetCharBounds(...)AffineTransform tx/** Returns the distance from the point (x,&nbsp;y) to the caret along ... */float lineDistancefloat distanceOffBaseline/** Returns a <code>TextHitInfo</code> corresponding to the ... */boolean prevdouble distanceDouble.MAX_VALUECoreMetrics lcmfloat icxfloat icyfloat iafloat cyfloat dyafloat ydsqboolean leftTextHitInfo resultpointToPath(...)float cxgetCharXPosition(...)float cadouble ndcm.descentcm.ascentcm.ssOffsetgetMetrics(...).ascentGraphicAttribute.BOTTOM_ALIGNMENTgetMetrics(...).descenteffectiveBaselineOffset(...)cm.italicAnglehitTestChar(...)/** Returns the hash code of this <code>TextLayout</code>. ... *//** Returns <code>true</code> if the two layouts are equal. ... */rhs.textLine/** Returns debugging information for this <code>TextLayout</code>. ... *//** Renders this <code>TextLayout</code> at the specified location in ... *//** Package-only method for testing ONLY.  Please don't abuse. *//** Return the index of the first character with a different baseline from the ... */byte alignmentGraphicAttribute.ROMAN_BASELINE/** Returns a <code>Shape</code> representing the outline of this ... */Shape resultgetOutline(...)/** Return the LayoutPath, or null if the layout path is the ... *//** Convert a hit to a point in standard coordinates.  The point is ... */float advfloat offLayoutPath lpgetCharYPosition(...)pathToPoint(...)// default implementation just calls private method on layout// normalize to current baseline// Object vf = attrs.get(TextAttribute.ORIENTATION);// isVerticalLine = TextAttribute.ORIENTATION_VERTICAL.equals(vf);// set paragraph attributes// If there's an embedded graphic at the start of the// paragraph, look for the first non-graphic character// and use it and its font to initialize the paragraph.// If not, use the first graphic to initialize.// hmmm what to do here?  Just try to supply reasonable// values I guess.// compute visibleAdvance// naturalBounds, boundsRect will be generated on demand// hashCode will be regenerated on demand/* !!! I think this is safe.  Once created, nothing mutates the ... */// make sure textLine is not null// default justification range to exclude trailing logical whitespace// never called// get old data first// then add our new data// !!! note: want non-shifted, baseline ascent and descent here!// TextLine should return appropriate line metrics object for these values// this is a graphic, no italics, use entire line height for caret// !!! top/bottom adjustment not implemented for vertical// At this point, the leading edge of the character// at offset is at the given caret.// at left end// at right end// values are there to make compiler happy// y0 <= y1, always// x0 <= x1, always// right now we're using the following rule for strong hits:// A hit on a character with a lower level// is stronger than one on a character with a higher level.// If this rule ties, the hit on the leading edge of a character wins.// If THIS rule ties, hit1 wins.  Both rules shouldn't tie, unless the// infos aren't counterparts of some sort.// hmm, allow indices at endpoints?  For now, yes.// more than one caret// then other is weak// {sfb} parameter checking is done in overloaded version// Really, we want the path to be a convex hull around all of the// points in path0 and path1.  But we can get by with less than// that.  We do need to prevent the two segments which// join path0 to path1 from crossing each other.  So, if we// traverse path0 from top to bottom, we'll traverse path1 from// bottom to top (and vice versa).// !!! probably want to optimize for all LTR text/* now we have the visual indexes of the glyphs at the start and limit ... *//* count how many runs we have, ought to be one or two, but perhaps ... */// dlf cast safe?// would this ever not handle all cases?// now create paths for pairs of carets/* return an area that consists of the bounding boxes of all the ... *///return new Highlight(result, false);// distanceOffBaseline is negative if you're 'above' baseline// check boundary conditions// revised hit test// the original seems too complex and fails miserably with italic offsets// the natural tendency is to move towards the character you want to hit// so we'll just measure distance to the center of each character's visual// bounds, pick the closest one, then see which side of the character's// center line (italic) the point is on.// this tends to make it easier to hit narrow characters, which can be a// bit odd if you're visually over an adjacent wide character. this makes// a difference with bidi, so perhaps i need to revisit this yet again.// just work around baseline mess for now// proximity in x (along baseline) is two times as important as proximity in y// current implementation doesn't support multiple baselines/* byte bl = font.getBaselineFor(text[start++]); ... */import Bidiimport BidiUtilsimport EmptyPathimport SegmentPathBuilderimport TextLabelFactoryimport TextLineComponentimport Line2DTextLineComponent tlcline.fComponentsint vigetComponentVisualIndex(...)getCharX(...)line.locsfloat charPosgetCharY(...)getComponentShift(...)float ascent;float descent;float leading;float advance;this.ascentthis.descentthis.leadingthis.advance...[] fComponents;...[] fBaselineOffsets;...[] fComponentVisualOrder;...[] locs;// if null, ltr...[] fChars;// x,y pairs for components in visual orderint fCharsStart;int fCharsLimit;...[] fCharVisualOrder;...[] fCharLogicalOrder;...[] fCharLevels;boolean fIsDirectionLTR;// if null, 0LayoutPathImpl lp;boolean isSimple;Rectangle pixelBounds;FontRenderContext frc;TextLineMetrics fMetrics;// built on demand in getMetricsint[] componentVisualOrdercomputeComponentOrder(...)this.frccheckCtorArgs(...)int checkCharCountfComponents.lengthgetNumCharacters(...)float maxGraphicHeightfloat maxGraphicHeightWithLeadingboolean fitTopAndBottomGraphicsCoreMetrics pcmboolean needPathgetCoreMetrics(...)byte baselineisSimple(...)float baselineOffsetfloat gdcm.leadingfloat graphicHeightfloat graphicHeightWithLeadinggetComponentLogicalIndex(...)pcm.italicAnglepcm.baselineIndexpcm.ssOffsetfloat pbfloat papcm.ascentfloat pdpcm.descentfloat cbfloat cdfloat paxfloat pdxfloat caxfloat cdxfloat daxfloat ddxlocs.lengthnew TextLineMetrics(...)Double ptdouble txdouble tySegmentPathBuilder buildernew SegmentPathBuilder(...)AffineTransform.TYPE_TRANSLATIONcomplete(...)new EmptyPath(...)Rectangle resultint iyfloat rxfloat ryboolean canCacheresult.xresult.yRectangle pbint MARGINRectangle2D r2dBufferedImage imcomputePixelBounds(...)Function fgPosAdvF;Function fgAdvanceF;Function fgXPositionF;Function fgYPositionF;createInverseMap(...)getCoreMetricsAt(...).italicAngleint currentTlcint tlcStartint tlcLimitgetCoreMetricsAt(...).ascentgetCoreMetricsAt(...).descentgetCoreMetricsAt(...).ssOffsetcomputeFunction(...)applyFunctionAtIndex(...)Function f/** map a component visual index to the logical index. *//** map a component logical index to the visual index. */fComponentVisualOrder.lengthint indexInTlcRectangle2D chBoundsgetCharVisualBounds(...)AffineTransform oldTx/** Return the union of the visual bounds of all the components. ... */Rectangle2D resultFloat.MAX_VALUEFloat.MIN_VALUEfloat leftfloat rightfloat topfloat bottomRectangle2D tlcBoundsGeneralPath dstShape/** Create a TextLine from the text.  The Font must be able to ... */boolean isDirectionLTRbyte[] levelsint[] charsLtoVBidi bidiint characterCountboolean requiresBidibyte[] embsDecoration decoratorint layoutFlagsTextLabelFactory factorynew TextLabelFactory(...)TextLineComponent[] componentsnew TextLineComponent[]getRunDirection(...)getBidiEmbedding(...)byte levelembs.lengthrequiresBidi(...)int bidiflagsBidi.DIRECTION_DEFAULT_LEFT_TO_RIGHTnew Bidi(...)int[] charsVtoLcreateVisualToLogicalMap(...)getLevels(...)baseIsLeftToRight(...)createComponentsOnRun(...)TextLineComponent[] tempnew TextLine(...)TextLineComponent[] newComponentsorig.length/** Returns an array in logical order of the TextLineComponents on ... */int chunkLimitfirstVisualChunk(...)int startPosint lmCountTextLineComponent nextComponentcreateExtended(...)LineMetrics lineMetricsgetNumChars(...)expandArray(...)/** Returns an array (in logical order) of the TextLineComponents representing ... */FontRenderContext frcTextLineComponent[] tempComponentsint runLimitObject graphicOrFontAffineTransform baseRotGraphicAttribute graphicAttributeGraphicComponent nextGraphicnew GraphicComponent(...)tempComponents.length/** Create a TextLine from the Font and character data over the ... */Bidi lineBidigetLineBidi(...)setLineContext(...)/** Compute the components order from the given components array and ... */int[] componentOrderint gStartcreateContiguousOrder(...)/** Create a TextLine from the text.  chars is just the text in the iterator. */StyledParagraph styledParagraphcreateLineFromText(...)/** When this returns, the ACI's current position will be at the start of the ... *//* A utility to get a range of text that is both logically and visually ... */float basefloat[] temptemp.lengthCodePointIterator.DONE/* The new version requires that chunks be at the same level. */byte dir/* create a new line with characters between charStart and charLimit ... */float leftHangfloat justifyDeltaboolean rejustifyfloat justifyAdvancegetAdvanceBetween(...)int[] infoPositionsnewComponents.lengthint infoCountGlyphJustificationInfo[] infosnew GlyphJustificationInfo[]int compStartint infoStartint infoLimitTextJustifier justifiernew TextJustifier(...)justify(...)boolean canRejustifyboolean wantRejustifyboolean[] flagsgetNumJustificationInfos(...)TextLineComponent compint compLengthint compLimitint rangeMinint rangeMaxgetJustificationInfos(...)applyJustificationDeltas(...)// return the sum of the advances of text between the logical start and limitint tlcLengthint measureStartint measureLimit/* (C) Copyright IBM Corp. 1998-2003, All Rights Reserved */// first, we need to check for graphic components on the TOP or BOTTOM baselines.  So// we perform the work that used to be in getMetrics here.// ascent + descent must not be less than this value// walk through EGA's// we now know enough to compute the locs, but we need the final loc// for the advance before we can create the metrics object// we have top or bottom baselines, so expand the baselines array// full offsets are needed by CoreMetrics.effectiveBaselineOffset// adjust because of italics// 1) compute the area of overlap - min effective ascent and min effective descent// 2) compute the x positions along italic angle of ascent and descent for left and right// 3) compute maximum left - right, adjust right position by this value// this is a crude form of kerning between textcomponents// note glyphvectors preposition glyphs based on offset,// so tl doesn't need to adjust glyphvector position// 1)// pb += pcm.ssOffset;// cb += cm.ssOffset;// 2)// 3)// no italic adjustment for x, but still need to compute y// + cm.ssOffset;// do we want italic padding at the right of the line?// locs[locs.length - 1] = 0; // final offset is always back on baseline// ok, build fMetrics since we have the final advance// build path if we need it// empty path// if we have a matching frc, set it to null so we don't have to test it// for each component// only cache integral locations with the default frc, this is a bit strict// couldn't use cache, or didn't have it, so compute// all glyphvectors with no decorations, no layout path// draw and test// get top// w ignored// get bottom// get left// get right// charPos is relative to the component - adjust for// baseline// dlf: get baseRot from font for now???// no extra info yet, bidi determines run and line direction// <= displayLimit// AffineTransform baseRot = styledParagraph.getBaselineRotationAt(pos);// !!! For now, let's assign runs of text with both fonts and graphic attributes// a null rotation (e.g. the baseline rotation goes away when a graphic// is applied./* Create a visual ordering for the glyph sets.  The important thing ... */// all characters outside the justification range must be in the base direction// of the layout, otherwise justification makes no sense.// get the actual justification delta// generate an array of GlyphJustificationInfo records to pass to// the justifier.  Array is visually ordered.// get positions that each component will be using// get justification infos// records are visually ordered, and contiguous, so start and end are// simply the places where we didn't fetch records// invoke justifier on the records// apply justification deltas// only make two passes/** The <code>TextMeasurer</code> class provides the primitive operations ... */float EST_LINES;// Number of lines to format to.FontRenderContext fFrc;int fStart;// characters in source textBidi fBidi;// Bidi for this paragraph...[] fLevels;// trailing counterdirectional whitespace// Levels array for chars in this paragraph - needed to reorder// line components in logical orderint fComponentStart;// index where components beginint fComponentLimit;// index where components endboolean haveLayoutWindow;BreakIterator fLineBreak;// used to find valid starting points for line componentsint layoutCount;int layoutCharCount;StyledParagraph fParagraph;// paragraph, with resolved fonts and styles// paragraph data - same across all layoutsbyte fBaseline;float fJustifyRatio;/** Constructs a <code>TextMeasurer</code> from the source text. ... */initAll(...)TextMeasurer otherother.fComponentsfChars.length/** Initialize state, including fChars array, direction, and ... */getBaselineIndex(...)getBaselineOffsets(...)Hashtable<Attribute,?> fmapnew Hashtable<Attribute,Object>(...)Font dummyFontinvalidateComponents(...)/** Generate components for the paragraph.  fChars, fBidi should have been ... */int tlcIndexint gaLimitint numCharsInGaint lineBreakgenerateComponents(...)calcLineBreak(...)/** According to the Unicode Bidirectional Behavior specification ... */byte baseLevelint cdWsStartgetDirectionality(...)Character.DIRECTIONALITY_WHITESPACEtrailingCdWhitespaceStart(...)int componentCountint newCompIndexint linePosint breakPtint subsetFlagboolean splitboolean contTextLineComponent.LEFT_TO_RIGHTTextLineComponent.RIGHT_TO_LEFTTextLineComponent.UNCHANGEDgetSubset(...)byte[] charLevelsmakeComponentsOnRange(...)createLineBidi(...)float avgLineLengthisBoundary(...)ensureComponents(...)/** Returns the index of the first character which will not fit on ... */int localStartmakeLayoutWindow(...)/** Returns the graphical width of a line beginning at <code>start</code> ... */int localLimitTextLine linemakeTextLineOnRange(...)getMetrics(...).advance/** Returns a <code>TextLayout</code> on the given character range. ... */TextLine textLineint formattedChars;boolean wantStats;boolean collectStats;/* "true".equals(System.getProperty("collectStats")); *//** Updates the <code>TextMeasurer</code> after a single character has ... */char[] newCharsint newCharIndexchar newCharprintStats(...)int changedIndex/** NOTE:  This method is only for LineBreakMeasurer's use.  It is package- ... */// extract chars//debugFormatCount += (endingAt-startingAt);// either of these statements removes the bug://generateComponents(0, fChars.length);//generateComponents(pos, fChars.length);// tlcStart is now the start of the tlc at tlcIndex// format more text and try again//if (haveLayoutWindow) {//    outOfWindow++;// Back up over counterdirectional whitespace// sigh I really hate to do this here since it's part of the// bidi algorithm.// cdWsStart is the start of the trailing counterdirectional// whitespace// If we've already gone past the layout window, format to end of paragraph// could cache line in case getLayout is called with same start, limit//formattedChars = 0;/** The <code>TransformAttribute</code> class provides an immutable ... */new TransformAttribute(...)/** The <code>AffineTransform</code> for this ... *//** Wraps the specified transform.  The transform is cloned and a ... *//** Returns a copy of the wrapped transform. ... *//** Returns <code>true</code> if the wrapped transform is ... */TransformAttribute IDENTITY;/** A <code>TransformAttribute</code> representing the identity transform. ... *//* @since 1.6 *//** Returns <code>true</code> if rhs is a <code>TransformAttribute</code> ... */TransformAttribute thatthat.transform// sigh -- 1.3 expects transform is never null, so we need to always write one out/** The <code>AffineTransform</code> class represents a 2D affine transform ... */int TYPE_UNKNOWN;/* This constant is only useful for the cached type field. ... */int TYPE_IDENTITY;/** This constant indicates that the transform defined by this object ... */int TYPE_TRANSLATION;/** This flag bit indicates that the transform defined by this object ... */int TYPE_UNIFORM_SCALE;int TYPE_GENERAL_SCALE;int TYPE_MASK_SCALE;/** This constant is a bit mask for any of the scale flag bits. ... */int TYPE_FLIP;int TYPE_QUADRANT_ROTATION;/* NOTE: TYPE_FLIP was added after GENERAL_TRANSFORM was in public ... */int TYPE_GENERAL_ROTATION;int TYPE_MASK_ROTATION;/** This constant is a bit mask for any of the rotation flag bits. ... */int TYPE_GENERAL_TRANSFORM;int APPLY_IDENTITY;/** This constant is used for the internal state variable to indicate ... */int APPLY_TRANSLATE;int APPLY_SCALE;int APPLY_SHEAR;int HI_SHIFT;/* For methods which combine together the state of two separate ... */int HI_IDENTITY;int HI_TRANSLATE;int HI_SCALE;int HI_SHEAR;double m00;/** The X coordinate scaling element of the 3x3 ... */double m10;/** The Y coordinate shearing element of the 3x3 ... */double m01;/** The X coordinate shearing element of the 3x3 ... */double m11;/** The Y coordinate scaling element of the 3x3 ... */double m02;/** The X coordinate of the translation element of the ... */double m12;/** The Y coordinate of the translation element of the ... *//** This field keeps track of which components of the matrix need to ... *//** This field caches the current transformation type of the matrix. ... */this.m00this.m10this.m01this.m11this.m02this.m12/** Constructs a new <code>AffineTransform</code> representing the ... *//** Constructs a new <code>AffineTransform</code> that is a copy of ... */Tx.m00Tx.m10Tx.m01Tx.m11Tx.m02Tx.m12Tx.stateTx.type/** Constructs a new <code>AffineTransform</code> from 6 floating point ... */updateState(...)/** Constructs a new <code>AffineTransform</code> from an array of ... */flatmatrix.length/** Constructs a new <code>AffineTransform</code> from 6 double ... *//** Returns a transform representing a translation transformation. ... */AffineTransform TxsetToTranslation(...)/** Returns a transform representing a rotation transformation. ... */setToRotation(...)/** Returns a transform that rotates coordinates around an anchor point. ... *//** Returns a transform that rotates coordinates according to ... *//** Returns a transform that rotates coordinates around an anchor ... *//** Returns a transform that rotates coordinates by the specified ... */setToQuadrantRotation(...)/** Returns a transform representing a scaling transformation. ... *//** Returns a transform representing a shearing transformation. ... */setToShear(...)/** Retrieves the flag bits describing the conversion properties of ... */calculateType(...)/** This is the utility function to calculate the flag bits when ... */boolean sgn0boolean sgn1double M0double M1double M2double M3stateError(...)/** Returns the determinant of the matrix representation of the transform. ... *//** Manually recalculates the state of the transform when the matrix ... *//* Convenience method used internally to throw exceptions when ... *//** Retrieves the 6 specifiable values in the 3x3 affine transformation ... *//** Returns the X coordinate scaling element (m00) of the 3x3 ... *//** Returns the Y coordinate scaling element (m11) of the 3x3 ... *//** Returns the X coordinate shearing element (m01) of the 3x3 ... *//** Returns the Y coordinate shearing element (m10) of the 3x3 ... *//** Returns the X coordinate of the translation element (m02) of the ... *//** Returns the Y coordinate of the translation element (m12) of the ... *//** Concatenates this transform with a translation transformation. ... */...[] rot90conversion;// rotations where the shear and scale values are swapped and negated.// These tables translate the flags during predictable quadrant// Utility methods to optimize rotate methods./** Concatenates this transform with a rotation transformation. ... */double sinrotate90(...)rotate270(...)double cosrotate180(...)/** Concatenates this transform with a transform that rotates ... *//** Concatenates this transform with a scaling transformation. ... *//** Concatenates this transform with a shearing transformation. ... *//** Resets this transform to the Identity transform. ... *//** Sets this transform to a translation transformation. ... *//** Sets this transform to a rotation transformation. ... *//** Sets this transform to a translated rotation transformation. ... */double oneMinusCos/** Sets this transform to a rotation transformation that rotates ... *//** Sets this transform to a translated rotation transformation ... *//** Sets this transform to a scaling transformation. ... *//** Sets this transform to a shearing transformation. ... *//** Sets this transform to a copy of the transform in the specified ... *//** Sets this transform to the matrix specified by the 6 ... *//** Concatenates an <code>AffineTransform</code> <code>Tx</code> to ... */double T00double T01double T1    H^    